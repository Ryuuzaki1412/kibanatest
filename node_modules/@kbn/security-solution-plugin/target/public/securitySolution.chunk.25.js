/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[25,6,8,11,12,13,17],Array(111).concat([function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return i(t,e),t},s=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;const o=r(a(631));t.z=o,s(a(631),t),t.default=o},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(48),i=a(136),r=a.n(i);const s=e=>Object(n.useSelector)(e,n.shallowEqual),o=e=>Object(n.useSelector)(e,r.a)},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"k",(function(){return A})),a.d(t,"d",(function(){return P})),a.d(t,"g",(function(){return N})),a.d(t,"l",(function(){return L})),a.d(t,"j",(function(){return q})),a.d(t,"e",(function(){return $})),a.d(t,"c",(function(){return U})),a.d(t,"m",(function(){return Q})),a.d(t,"i",(function(){return G})),a.d(t,"h",(function(){return W})),a.d(t,"f",(function(){return Z})),a.d(t,"n",(function(){return X})),a.d(t,"o",(function(){return te})),a.d(t,"b",(function(){return le}));var n=a(46),i=a(120),r=a(143),s=a(125);const o=Object(r.c)(n.array(n.string)),l=(n.intersection([n.type({eventId:n.string}),n.partial({pinnedEventId:Object(r.c)(n.string),timelineId:Object(r.c)(n.string)})]),n.intersection([n.type({timelineId:n.string,eventId:n.string}),n.partial({created:Object(r.c)(n.number),createdBy:Object(r.c)(n.string),updated:Object(r.c)(n.number),updatedBy:Object(r.c)(n.string)})])),c=n.intersection([n.type({pinnedEventId:n.string,version:n.string}),l,n.partial({timelineVersion:Object(r.c)(n.string)})]);var u=a(278);const d=n.exact(n.partial({id:n.string,rule_id:i.j,list_id:i.j,item_id:i.j})),p=n.exact(n.type({error:n.type({status_code:i.m,message:n.string})})),m=n.intersection([d,p]),f=n.intersection([n.type({timelineId:Object(r.c)(n.string)}),n.partial({eventId:Object(r.c)(n.string),note:Object(r.c)(n.string),created:Object(r.c)(n.number),createdBy:Object(r.c)(n.string),updated:Object(r.c)(n.number),updatedBy:Object(r.c)(n.string)})]),b=n.intersection([f,n.type({noteId:n.string,version:n.string}),n.partial({timelineVersion:Object(r.c)(n.string)})]),g=n.partial({aggregatable:Object(r.c)(n.boolean),category:Object(r.c)(n.string),columnHeaderType:Object(r.c)(n.string),description:Object(r.c)(n.string),example:Object(r.c)(n.string),indexes:Object(r.c)(n.array(n.string)),id:Object(r.c)(n.string),name:Object(r.c)(n.string),placeholder:Object(r.c)(n.string),searchable:Object(r.c)(n.boolean),type:Object(r.c)(n.string)}),y=n.partial({field:Object(r.c)(n.string),displayField:Object(r.c)(n.string),value:n.union([n.null,n.string,n.array(n.string)]),displayValue:Object(r.c)(n.string),operator:Object(r.c)(n.string)}),h=n.partial({id:Object(r.c)(n.string),name:Object(r.c)(n.string),enabled:Object(r.c)(n.boolean),excluded:Object(r.c)(n.boolean),kqlQuery:Object(r.c)(n.string),queryMatch:Object(r.c)(y)});let v;!function(e){e.default="default",e.template="template"}(v||(v={}));const E=n.union([n.literal(v.default),n.literal(v.template)]),x=n.partial({id:Object(r.c)(n.string),name:Object(r.c)(n.string),enabled:Object(r.c)(n.boolean),excluded:Object(r.c)(n.boolean),kqlQuery:Object(r.c)(n.string),queryMatch:Object(r.c)(y),and:Object(r.c)(n.array(h)),type:Object(r.c)(E)}),j=n.partial({alias:Object(r.c)(n.string),controlledBy:Object(r.c)(n.string),disabled:Object(r.c)(n.boolean),field:Object(r.c)(n.string),formattedValue:Object(r.c)(n.string),index:Object(r.c)(n.string),key:Object(r.c)(n.string),negate:Object(r.c)(n.boolean),params:Object(r.c)(n.string),type:Object(r.c)(n.string),value:Object(r.c)(n.string)}),S=n.partial({exists:Object(r.c)(n.string),meta:Object(r.c)(j),match_all:Object(r.c)(n.string),missing:Object(r.c)(n.string),query:Object(r.c)(n.string),range:Object(r.c)(n.string),script:Object(r.c)(n.string)}),O=n.partial({eventCategoryField:Object(r.c)(n.string),query:Object(r.c)(n.string),tiebreakerField:Object(r.c)(n.string),timestampField:Object(r.c)(n.string),size:Object(r.c)(n.union([n.string,n.number]))}),k=n.partial({kind:Object(r.c)(n.string),expression:Object(r.c)(n.string)}),w=n.partial({kuery:Object(r.c)(k),serializedQuery:Object(r.c)(n.string)}),T=n.partial({filterQuery:Object(r.c)(w)}),I=n.partial({start:Object(r.c)(n.union([n.string,n.number])),end:Object(r.c)(n.union([n.string,n.number]))}),C=n.partial({keySearch:Object(r.c)(n.string),favoriteDate:Object(r.c)(n.number),fullName:Object(r.c)(n.string),userName:Object(r.c)(n.string)}),M=n.partial({columnId:Object(r.c)(n.string),columnType:Object(r.c)(n.string),sortDirection:Object(r.c)(n.string)}),_=n.union([n.array(M),M]);let A;!function(e){e.active="active",e.draft="draft",e.immutable="immutable"}(A||(A={}));const F=n.union([n.literal(A.active),n.literal(A.draft),n.literal(A.immutable)]);let P;Object(r.c)(F),function(e){e.alert="alert",e.alerts="alerts",e.auditd="auditd",e.auditd_file="auditd_file",e.library="library",e.netflow="netflow",e.plain="plain",e.registry="registry",e.suricata="suricata",e.system="system",e.system_dns="system_dns",e.system_endgame_process="system_endgame_process",e.system_file="system_file",e.system_fim="system_fim",e.system_security_event="system_security_event",e.system_socket="system_socket",e.threat_match="threat_match",e.zeek="zeek"}(P||(P={}));const D=Object(r.b)(P,"RowRendererId");let N;!function(e){e.elastic="elastic",e.custom="custom"}(N||(N={}));const R=n.union([n.literal(N.elastic),n.literal(N.custom)]);let L;Object(r.c)(R),function(e){e.default="default",e.template="template"}(L||(L={}));const B=n.union([n.literal(L.template),n.literal(L.default)]),z=(Object(r.c)(B),n.partial({columns:Object(r.c)(n.array(g)),dataProviders:Object(r.c)(n.array(x)),dataViewId:Object(r.c)(n.string),description:Object(r.c)(n.string),eqlOptions:Object(r.c)(O),eventType:Object(r.c)(n.string),excludedRowRendererIds:Object(r.c)(n.array(D)),favorite:Object(r.c)(n.array(C)),filters:Object(r.c)(n.array(S)),indexNames:Object(r.c)(n.array(n.string)),kqlMode:Object(r.c)(n.string),kqlQuery:Object(r.c)(T),title:Object(r.c)(n.string),templateTimelineId:Object(r.c)(n.string),templateTimelineVersion:Object(r.c)(n.number),timelineType:Object(r.c)(B),dateRange:Object(r.c)(I),savedQueryId:Object(r.c)(n.string),sort:Object(r.c)(_),status:Object(r.c)(F),created:Object(r.c)(n.number),createdBy:Object(r.c)(n.string),updated:Object(r.c)(n.number),updatedBy:Object(r.c)(n.string),savedSearchId:Object(r.c)(n.string)})),q=n.intersection([z,n.type({savedObjectId:n.string,version:n.string}),n.partial({eventIdToNoteIds:n.array(b),noteIds:n.array(n.string),notes:n.array(b),pinnedEventIds:n.array(n.string),pinnedEventsSaveObject:n.array(c)})]),$=n.type({data:n.type({getOneTimeline:q})}),V=n.intersection([n.type({timeline:q,outcome:u.D}),n.partial({alias_target_id:u.C,alias_purpose:u.B})]),U=n.type({data:V}),H=n.type({timeline:n.array(q),totalCount:n.number}),Q=n.intersection([H,n.type({defaultTimelineCount:n.number,templateTimelineCount:n.number,elasticTemplateTimelineCount:n.number,customTemplateTimelineCount:n.number,favoriteCount:n.number})]),G=n.type({data:n.type({persistTimeline:n.intersection([n.partial({code:Object(r.c)(n.number),message:Object(r.c)(n.string)}),n.type({timeline:q})])})}),W=n.union([n.type({status_code:n.number,message:n.string}),n.type({statusCode:n.number,message:n.string})]);let Z;!function(e){e.title="title",e.description="description",e.updated="updated",e.created="created"}(Z||(Z={}));const K=n.union([n.literal(Z.title),n.literal(Z.description),n.literal(Z.updated),n.literal(Z.created)]),J=n.union([n.literal(s.b.asc),n.literal(s.b.desc)]),Y=n.type({sortField:K,sortOrder:J}),X=n.exact(n.type({success:n.boolean,success_count:i.m,timelines_installed:i.m,timelines_updated:i.m,errors:n.array(m)})),ee=n.partial({fullName:Object(r.c)(n.string),userName:Object(r.c)(n.string),favoriteDate:Object(r.c)(n.number)}),te=n.partial({savedObjectId:n.string,version:n.string,code:Object(r.c)(n.number),message:Object(r.c)(n.string),templateTimelineId:Object(r.c)(n.string),templateTimelineVersion:Object(r.c)(n.number),timelineType:Object(r.c)(B),favorite:Object(r.c)(n.array(ee))}),ae=n.type({pageIndex:n.number,pageSize:n.number}),ne=(n.partial({onlyUserFavorite:Object(r.c)(n.boolean),pageInfo:Object(r.c)(ae),search:Object(r.c)(n.string),sort:Object(r.c)(Y),status:Object(r.c)(F),timelineType:Object(r.c)(B)}),n.type({timelineType:B}),n.type({timelineType:B}),n.intersection([n.type({timeline:z}),n.partial({status:Object(r.c)(F),timelineId:Object(r.c)(n.string),templateTimelineId:Object(r.c)(n.string),templateTimelineVersion:Object(r.c)(n.number),timelineType:Object(r.c)(B),version:Object(r.c)(n.string)})]),n.partial({noteId:Object(r.c)(n.string)}),n.partial({searchIds:n.array(n.string)})),ie=n.type({savedObjectIds:n.array(n.string)}),re=(n.intersection([ie,ne]),n.type({file_name:n.string}),n.partial({ids:Object(r.c)(n.array(n.string))}),n.partial({template_timeline_id:n.string,id:n.string}),n.union([n.literal("true"),n.literal("false")])),se=(n.partial({only_user_favorite:Object(r.c)(re),page_index:Object(r.c)(n.string),page_size:Object(r.c)(n.string),search:Object(r.c)(n.string),sort_field:K,sort_order:J,status:Object(r.c)(F),timeline_type:Object(r.c)(B)}),Object(r.c)(n.array(f))),oe=Object(r.c)(n.array(f)),le=n.intersection([z,n.type({savedObjectId:Object(r.c)(n.string),version:Object(r.c)(n.string)}),n.type({globalNotes:oe,eventNotes:se,pinnedEventIds:o})]),ce=n.partial({_maxListeners:n.unknown,_readableState:n.unknown,_read:n.unknown,readable:n.boolean,_events:n.unknown,_eventsCount:n.number,_data:n.unknown,_position:n.number,_encoding:n.string}),ue=n.union([n.literal("true"),n.literal("false")]);n.intersection([n.type({file:n.intersection([ce,n.type({hapi:n.type({filename:n.string,headers:n.unknown})})])}),n.partial({isImmutable:ue})]),n.type({timeline:z,timelineId:Object(r.c)(n.string),version:Object(r.c)(n.string)}),n.type({timelineId:Object(r.c)(n.string),templateTimelineId:Object(r.c)(n.string),templateTimelineVersion:Object(r.c)(n.number),timelineType:Object(r.c)(B)}),n.intersection([n.type({note:f}),n.partial({overrideOwner:Object(r.c)(n.boolean),noteId:Object(r.c)(n.string),version:Object(r.c)(n.string)})]),n.type({timelinesToInstall:n.array(Object(r.c)(le)),timelinesToUpdate:n.array(Object(r.c)(le)),prepackagedTimelines:n.array(Object(r.c)(q))}),n.type({timeline:z,timelineIdToCopy:n.string})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const i=e=>Object(n.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},function(e,t,a){"use strict";a.r(t),a.d(t,"SourcererScopeName",(function(){return i})),a.d(t,"initSourcererScope",(function(){return r})),a.d(t,"initDataView",(function(){return s})),a.d(t,"initialSourcererState",(function(){return o}));var n=a(58);let i;!function(e){e.default="default",e.detections="detections",e.timeline="timeline"}(i||(i={}));const r={loading:!1,selectedDataViewId:null,selectedPatterns:[],missingPatterns:[]},s={browserFields:n.EMPTY_BROWSER_FIELDS,id:"",indexFields:n.EMPTY_INDEX_FIELDS,fields:void 0,loading:!1,patternList:[],runtimeMappings:{},title:"",dataView:void 0},o={defaultDataView:s,kibanaDataViews:[],signalIndexName:null,sourcererScopes:{[i.default]:{...r,id:i.default},[i.detections]:{...r,id:i.detections},[i.timeline]:{...r,id:i.timeline}}}},,function(e,t,a){"use strict";var n=a(14);a.d(t,"a",(function(){return n}));var i=a(353);a.d(t,"b",(function(){return i}))},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.global="global",e.timeline="timeline",e.socTrends="socTrends"}(n||(n={}))},,function(e,t,a){"use strict";a.d(t,"c",(function(){return S})),a.d(t,"d",(function(){return O})),a.d(t,"a",(function(){return w})),a.d(t,"b",(function(){return I}));var n=a(2),i=a(48),r=a(5),s=a(49),o=a(149),l=a(116),c=a(213),u=a(118),d=a(4),p=a(151),m=a(112),f=a(392),b=a(117),g=a(477),y=a(334),h=a(241),v=a(157),E=a(218),x=a(295),j=a(110);const S=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),{data:{dataViews:a}}=Object(j.i)().services,s=Object(n.useRef)(new AbortController),d=Object(n.useRef)(!0),h=Object(n.useRef)(!0),{loading:x,isSignalIndexExists:S,signalIndexName:k}=Object(c.c)(),w=Object(v.d)(E.a.sourcerer),T=Object(n.useMemo)((()=>o.d.getSourcererDataViewsSelector()),[]),{defaultDataView:I,signalIndexName:C}=Object(m.a)((e=>T(e))),{addError:M,addWarning:_}=Object(b.a)();Object(n.useEffect)((()=>{null!=I.error&&_({title:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[_,I.error]);const A=Object(n.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),F=Object(m.a)((e=>A(e,p.f.active))),P=Object(n.useMemo)((()=>o.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:D,selectedPatterns:N,missingPatterns:R}}=Object(m.a)((t=>P(t,e))),{selectedDataView:L,sourcererScope:{selectedDataViewId:B,selectedPatterns:z,missingPatterns:q}}=Object(m.a)((e=>P(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:$}=Object(y.b)(),V=Object(n.useCallback)((a=>{null!=a?Object.keys(a).forEach((n=>{var i,r,s,c;n===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(o.a.setSelectedDataView({id:n,selectedDataViewId:null!==(i=null===(r=a[n])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(s=null===(c=a[n])||void 0===c?void 0:c.selectedPatterns)&&void 0!==s?s:[]}))})):D&&w({[l.SourcererScopeName.default]:{id:D,selectedPatterns:N}})}),[t,D,e,N,w]);Object(v.b)(E.a.sourcerer,V);const U=Object(n.useRef)([]);Object(n.useEffect)((()=>{[...new Set([D,B])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!U.current.includes(e)){U.current=[...U.current,e];const a=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,n=e===D?0===N.length&&0===R.length:B===e&&0===q.length&&0===(null==L?void 0:L.patternList.length);$({dataViewId:e,scopeId:a,needToBeInit:n,...n&&a===l.SourcererScopeName.timeline?{skipScopeUpdate:z.length>0}:{}})}}))}),[$,R.length,D,N.length,B,q.length,L,z.length]),Object(n.useEffect)((()=>{!x&&null!=k&&null==C&&(null==F||null==F.savedObjectId)&&d.current&&I.id.length>0?(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.timeline,k,!0)}))):null!=C&&(null==F||null==F.savedObjectId)&&d.current&&I.id.length>0&&(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.timeline,C,!0)})))}),[F,I,t,x,k,C]);const{dataViewId:H}=O(e),Q=Object(n.useCallback)((e=>{-1===I.title.indexOf(e)&&(s.current.abort(),(async n=>{s.current=new AbortController,t(o.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(g.a)({body:{patternList:n},signal:s.current.signal,dataViewService:a,dataViewId:H});null!=i&&i.defaultDataView.patternList.includes(e)&&($({dataViewId:i.defaultDataView.id}),t(o.a.setSourcererDataViews(i))),t(o.a.setSourcererScopeLoading({loading:!1}))}catch(e){"AbortError"===e.name||M(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(o.a.setSourcererScopeLoading({loading:!1}))}})([...I.title.split(","),e]))}),[I.title,t,a,H,$,M]),G=Object(n.useCallback)((()=>{!x&&null!=k&&null==C&&I.id.length>0&&(Q(k),t(o.a.setSignalIndexName({signalIndexName:k})))}),[I.id.length,t,x,k,C,Q]);Object(n.useEffect)((()=>{G()}),[k]),Object(n.useEffect)((()=>{e===l.SourcererScopeName.detections&&S&&null!=k&&h.current&&I.id.length>0?(h.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=C&&d.current&&I.id.length>0&&(h.current=!1,o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.detections,C,!0)}))}),[I,t,S,e,k,C])},O=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:a,getScopeSelector:i}=Object(n.useMemo)((()=>({getDataViewsSelector:o.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:o.d.sourcererDataViewSelector(),getScopeSelector:o.d.scopeIdSelector()})),[]),{defaultDataView:r,signalIndexName:s,selectedDataView:c,sourcererScope:{missingPatterns:u,selectedPatterns:d,loading:p}}=Object(m.a)((n=>{const r=i(n,e);return{...t(n),selectedDataView:a(n,r.selectedDataViewId),sourcererScope:r}})),b=Object(n.useMemo)((()=>Object(x.b)(d)),[d]),[g,v]=Object(n.useState)([]),[E,j]=Object(h.b)(g),S=Object(n.useMemo)((()=>{var e,t,a,n,i,r,s;return{...j,dataView:j.dataView,runtimeMappings:null!==(e=null===(t=j.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(a=null===(n=j.dataView)||void 0===n?void 0:n.title)&&void 0!==a?a:"",id:null!==(i=null===(r=j.dataView)||void 0===r?void 0:r.id)&&void 0!==i?i:null,loading:E,patternList:j.indexes,indexFields:j.indexPatterns.fields,fields:null===(s=j.dataView)||void 0===s?void 0:s.fields}}),[j,E]);Object(n.useEffect)((()=>{null==c||u.length>0?v(b):v([])}),[u,c,b]);const O=Object(n.useMemo)((()=>null==c||u.length>0?S:c),[S,u.length,c]),k=Object(n.useMemo)((()=>!(!p&&!O.loading)||Object(f.a)({scopeId:e,signalIndexName:s,patternList:O.patternList,isDefaultDataViewSelected:O.id===r.id})),[r.id,p,e,s,O.id,O.loading,O.patternList]),w=Object(n.useCallback)((()=>{const{browserFields:e}=Object(y.a)(O.patternList.join(","),O.fields);return e}),[O.fields,O.patternList]);return Object(n.useMemo)((()=>({browserFields:w(),dataViewId:O.id,indexPattern:{fields:O.indexFields,title:b.join(","),getName:()=>b.join(",")},indicesExist:k,loading:p||O.loading,runtimeMappings:O.runtimeMappings,patternList:O.title.split(","),selectedPatterns:b,...g.length>0?{activePatterns:O.patternList}:{},sourcererDataView:O.dataView})),[w,O,b,k,p,g.length])},k=[d.d,`${d.oc}/id/:id`,`${d.s}/:detailName`],w=e=>null==Object(s.matchPath)(e,{path:k,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,T=[d.d,d.v,`${d.oc}/id/:id`,d.Ab,d.Lc,d.Ob,d.Wb],I=e=>null!=Object(s.matchPath)(e,{path:T,strict:!1})},function(e,t,a){"use strict";a.d(t,"b",(function(){return n.IS_OPERATOR})),a.d(t,"a",(function(){return n.EXISTS_OPERATOR})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r}));var n=a(58);let i,r;!function(e){e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session",e.securityAssistant="securityAssistant",e.esql="esql"}(i||(i={})),function(e){e.active="timeline-1",e.casePage="timeline-case",e.test="timeline-test"}(r||(r={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return y}));var n=a(45),i=a(2),r=a.n(i),s=a(704),o=a(168),l=a(492),c=a(249),u=a(250);const d=[{id:"default-system-prompt",content:u.b,name:u.a,promptType:"system"},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:u.d,name:u.c,promptType:"system"}],p={alerts:!1,assistantLangChain:!1,latestAlerts:20};var m=a(259),f=a(13);const b=r.a.createContext(void 0),g=({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:a,assistantStreamingEnabled:r=!1,assistantTelemetry:u,augmentMessageCodeBlocks:g,baseAllow:y,baseAllowReplacement:h,defaultAllow:v,defaultAllowReplacement:E,docLinks:x,basePath:j,basePromptContexts:S=[],baseQuickPrompts:O=[],baseSystemPrompts:k=d,children:w,getComments:T,http:I,getInitialConversations:C,modelEvaluatorEnabled:M=!1,nameSpace:_="elasticAssistantDefault",setConversations:A,setDefaultAllow:F,setDefaultAllowReplacement:P,title:D=c.c,toasts:N})=>{const[R,L]=Object(s.useLocalStorage)(`${_}.quickPrompts`,O),[B,z]=Object(s.useLocalStorage)(`${_}.systemPrompts`,k),[q,$]=Object(s.useLocalStorage)(`${_}.lastConversationId`),[V,U]=Object(s.useLocalStorage)(`${_}.knowledgeBase`,p),[H,Q]=Object(i.useState)({}),G=Object(i.useCallback)((e=>{Q((t=>null!=e&&null==t[e.id]?Object(l.b)({prevPromptContexts:t,promptContext:e}):t))}),[]),W=Object(i.useCallback)((e=>Q((t=>null==t[e]?t:Object(n.omit)(e,t)))),[]),[Z,K]=Object(i.useState)((e=>{})),[J,Y]=Object(i.useState)(m.b),[X,ee]=Object(i.useState)(C()),te=Object(i.useMemo)((()=>Object.keys(X).sort()),[X]);Object(i.useEffect)((()=>{ee(C())}),[C]);const ae=Object(i.useCallback)((e=>{if("function"==typeof e){const t=e;ee((e=>{const a=t(e);return A(a),a}))}else A(e),ee(e)}),[A]),ne=Object(i.useCallback)((e=>{var t;return null!==(t=null!=e?e:q)&&void 0!==t?t:o.d}),[q]),ie=Object(i.useMemo)((()=>({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:a,assistantStreamingEnabled:r,assistantTelemetry:u,augmentMessageCodeBlocks:g,allQuickPrompts:null!=R?R:[],allSystemPrompts:null!=B?B:[],baseAllow:Object(n.uniq)(y),baseAllowReplacement:Object(n.uniq)(h),basePath:j,basePromptContexts:S,baseQuickPrompts:O,baseSystemPrompts:k,conversationIds:te,conversations:X,defaultAllow:Object(n.uniq)(v),defaultAllowReplacement:Object(n.uniq)(E),docLinks:x,getComments:T,http:I,knowledgeBase:null!=V?V:p,modelEvaluatorEnabled:M,promptContexts:H,nameSpace:_,registerPromptContext:G,selectedSettingsTab:J,setAllQuickPrompts:L,setAllSystemPrompts:z,setConversations:ae,setDefaultAllow:F,setDefaultAllowReplacement:P,setKnowledgeBase:U,setSelectedSettingsTab:Y,setShowAssistantOverlay:K,showAssistantOverlay:Z,title:D,toasts:N,unRegisterPromptContext:W,getConversationId:ne,setLastConversationId:$})),[e,t,a,r,u,g,y,h,j,S,O,k,te,X,v,E,x,T,I,V,ne,R,B,M,_,ae,H,G,J,F,P,U,$,L,z,Z,D,N,W]);return Object(f.jsx)(b.Provider,{value:ie},w)},y=()=>{const e=r.a.useContext(b);if(null==e)throw new Error("useAssistantContext must be used within a AssistantProvider");return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return Me})),a.d(t,"h",(function(){return n})),a.d(t,"j",(function(){return i})),a.d(t,"o",(function(){return xe})),a.d(t,"i",(function(){return Ke})),a.d(t,"q",(function(){return M})),a.d(t,"k",(function(){return I})),a.d(t,"l",(function(){return C})),a.d(t,"b",(function(){return v.Direction})),a.d(t,"r",(function(){return S})),a.d(t,"c",(function(){return w})),a.d(t,"f",(function(){return k})),a.d(t,"e",(function(){return x})),a.d(t,"d",(function(){return j})),a.d(t,"m",(function(){return R})),a.d(t,"g",(function(){return q})),a.d(t,"p",(function(){return L})),a.d(t,"n",(function(){return Oe}));var n={};a.r(n),a.d(n,"createDataTable",(function(){return H})),a.d(n,"upsertColumn",(function(){return Q})),a.d(n,"applyDeltaToColumnWidth",(function(){return G})),a.d(n,"updateColumnOrder",(function(){return W})),a.d(n,"updateColumnWidth",(function(){return Z})),a.d(n,"toggleDetailPanel",(function(){return K})),a.d(n,"removeColumn",(function(){return J})),a.d(n,"updateIsLoading",(function(){return Y})),a.d(n,"updateColumns",(function(){return X})),a.d(n,"updateItemsPerPage",(function(){return ee})),a.d(n,"updateItemsPerPageOptions",(function(){return te})),a.d(n,"updateSort",(function(){return ae})),a.d(n,"setSelected",(function(){return ne})),a.d(n,"clearSelected",(function(){return ie})),a.d(n,"setEventsLoading",(function(){return re})),a.d(n,"clearEventsLoading",(function(){return se})),a.d(n,"setEventsDeleted",(function(){return oe})),a.d(n,"clearEventsDeleted",(function(){return le})),a.d(n,"initializeDataTableSettings",(function(){return ce})),a.d(n,"setDataTableSelectAll",(function(){return ue})),a.d(n,"updateGraphEventId",(function(){return de})),a.d(n,"updateSessionViewConfig",(function(){return pe})),a.d(n,"setTableUpdatedAt",(function(){return me})),a.d(n,"updateTotalCount",(function(){return fe})),a.d(n,"changeViewMode",(function(){return be})),a.d(n,"updateShowBuildingBlockAlertsFilter",(function(){return ge})),a.d(n,"updateShowThreatIndicatorAlertsFilter",(function(){return ye}));var i={};a.r(i),a.d(i,"tableByIdSelector",(function(){return ve})),a.d(i,"getTableByIdSelector",(function(){return xe})),a.d(i,"getManageDataTableById",(function(){return Se}));var r=a(23),s=a.n(r),o=a(17),l=a(45),c=a(234),u=a.n(c),d=a(2),p=a.n(d),m=a(48),f=a(44),b=a.n(f),g=a(5),y=a(320);const h=180;var v=a(58),E=a(46);let x,j;!function(e){e.usersPageEvents="users-page-events",e.hostsPageEvents="hosts-page-events",e.networkPageEvents="network-page-events",e.hostsPageSessions="hosts-page-sessions-v2",e.alertsOnRuleDetailsPage="alerts-rules-details-page",e.alertsOnAlertsPage="alerts-page",e.test="table-test",e.alternateTest="alternateTest",e.rulePreview="rule-preview",e.kubernetesPageSessions="kubernetes-page-sessions",e.alertsOnCasePage="alerts-case-page",e.alertsRiskInputs="alerts-risk-inputs",e.riskInputs="risk-inputs"}(x||(x={})),function(e){e.alert="alert",e.event="event",e.session="session"}(j||(j={}));const S={[x.alertsOnAlertsPage]:j.alert,[x.alertsOnCasePage]:j.alert,[x.alertsOnRuleDetailsPage]:j.alert,[x.hostsPageEvents]:j.event,[x.networkPageEvents]:j.event,[x.usersPageEvents]:j.event,[x.test]:j.event,[x.alternateTest]:j.event,[x.rulePreview]:j.event,[x.hostsPageSessions]:j.session,[x.kubernetesPageSessions]:j.session,[x.alertsRiskInputs]:j.alert,[x.riskInputs]:j.alert};let O,k;E.union([E.literal(x.usersPageEvents),E.literal(x.hostsPageEvents),E.literal(x.networkPageEvents),E.literal(x.hostsPageSessions),E.literal(x.alertsOnRuleDetailsPage),E.literal(x.alertsOnAlertsPage),E.literal(x.test),E.literal(x.rulePreview),E.literal(x.kubernetesPageSessions),E.literal(x.alertsOnCasePage),E.literal(x.alertsRiskInputs)]),function(e){e.destination="destination",e.source="source"}(O||(O={})),function(e){e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session"}(k||(k={}));const w="open",T=g.i18n.translate("securitySolutionPackages.dataTable.loadingEventsDataLabel",{defaultMessage:"Loading Events"}),I="not-filtered",C=[{columnHeaderType:I,id:"@timestamp",initialWidth:190,esTypes:["date"],type:"date"},{columnHeaderType:I,id:"message",initialWidth:h},{columnHeaderType:I,id:"event.category",initialWidth:h},{columnHeaderType:I,id:"event.action",initialWidth:h},{columnHeaderType:I,id:"host.name",initialWidth:h},{columnHeaderType:I,id:"source.ip",initialWidth:h},{columnHeaderType:I,id:"destination.ip",initialWidth:h},{columnHeaderType:I,id:"user.name",initialWidth:h}],M={defaultColumns:C,dataViewId:null,deletedEventIds:[],expandedDetail:{},filters:[],indexNames:[],isSelectAllChecked:!1,isLoading:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],loadingEventIds:[],selectedEventIds:{},showCheckboxes:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],selectAll:!1,graphEventId:"",sessionViewConfig:null,columns:C,queryFields:[],title:"",totalCount:0,viewMode:"gridView",additionalFilters:{showBuildingBlockAlerts:!1,showOnlyThreatIndicatorAlerts:!1}},_=e=>({defaultColumns:C,loadingText:T,documentType:"",selectAll:!1,id:e,isLoading:!1,queryFields:[],title:"",unit:e=>{return t=e,g.i18n.translate("securitySolutionPackages.dataTable.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {alert} other {alerts}}"});var t},graphEventId:""});var A=a(13);const F={showSortAsc:!0,showSortDesc:!0,showHide:!1},P=({browserField:e,fieldName:t})=>{var a;const n=null!==(a=null==e?void 0:e.aggregatable)&&void 0!==a&&a;return["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.reason","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(t)||n},D=e=>{switch(e){case"date":case"date_nanos":return"datetime";case"double":case"long":case"number":return"numeric";case"object":return"json";case"boolean":return"boolean";default:return}},N=[{columnHeaderType:I,id:"@timestamp",displayAsText:g.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.timestampTitle.column",{defaultMessage:"Timestamp"}),initialWidth:240,actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:I,displayAsText:g.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.ruleTitle.column",{defaultMessage:"Rule"}),id:"kibana.alert.rule.name",initialWidth:230,linkField:"kibana.alert.rule.uuid",actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:I,id:"eventSummary",displayAsText:g.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"}),actions:!1,isExpandable:!1,isResizable:!1}],R=(e,t,a,n)=>e.reduce(((e,i)=>({...e,...n&&t.includes(i._id)?{[i._id]:i.data.filter((e=>a.includes(e.field)))}:{}})),{}),L=e=>{var t,a;return!Object(l.isEmpty)(null===(t=e.kibana)||void 0===t||null===(a=t.alert)||void 0===a?void 0:a.building_block_type)},B=e=>{switch(e){case"asc":case"desc":return e;default:return"desc"}},z=({columns:e,columnHeaders:t})=>e.map((({id:e,direction:a})=>{var n,i;const r=t.find((t=>t.id===e)),s=null!==(n=null==r?void 0:r.type)&&void 0!==n?n:"",o=null!==(i=null==r?void 0:r.esTypes)&&void 0!==i?i:[];return{columnId:e,columnType:s,esTypes:o,sortDirection:a}})),q=(e,t,a,n)=>{const i=null!=n?n:{};L(e)?a({style:{...i,backgroundColor:`${t.eui.euiColorHighlight}`}}):a({style:{...i,backgroundColor:"inherit"}})},$=g.i18n.translate("securitySolutionPackages.dataTable.columnHeaders.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"});var V=a(26);const U=a.n(V)()("x-pack/security_solution/data-table"),H=U("CREATE_DATA_TABLE"),Q=U("UPSERT_COLUMN"),G=U("APPLY_DELTA_TO_COLUMN_WIDTH"),W=U("UPDATE_COLUMN_ORDER"),Z=U("UPDATE_COLUMN_WIDTH"),K=U("TOGGLE_DETAIL_PANEL"),J=U("REMOVE_COLUMN"),Y=U("UPDATE_LOADING"),X=U("UPDATE_COLUMNS"),ee=U("UPDATE_ITEMS_PER_PAGE"),te=U("UPDATE_ITEMS_PER_PAGE_OPTIONS"),ae=U("UPDATE_SORT"),ne=U("SET_DATA_TABLE_SELECTED"),ie=U("CLEAR_DATA_TABLE_SELECTED"),re=U("SET_DATA_TABLE_EVENTS_LOADING"),se=U("CLEAR_DATA_TABLE_EVENTS_LOADING"),oe=U("SET_DATA_TABLE_EVENTS_DELETED"),le=U("CLEAR_DATA_TABLE_EVENTS_DELETED"),ce=U("INITIALIZE_DATA_TABLE"),ue=U("SET_DATA_TABLE_SELECT_ALL"),de=U("UPDATE_DATA_TABLE_GRAPH_EVENT_ID"),pe=U("UPDATE_DATA_TABLE_SESSION_VIEW_CONFIG"),me=U("SET_TABLE_UPDATED_AT"),fe=U("UPDATE_TOTAL_COUNT"),be=U("CHANGE_ALERT_TABLE_VIEW_MODE"),ge=U("UPDATE_BUILDING_BLOCK_ALERTS_FILTER"),ye=U("UPDATE_SHOW_THREAT_INDICATOR_ALERTS_FILTER");var he=a(57);const ve=Object(he.createSelector)((e=>e.dataTable.tableById),(e=>e)),Ee=(e,t)=>e.dataTable.tableById[t],xe=()=>Object(he.createSelector)(Ee,(e=>e)),je=(e,t)=>{return Object(l.getOr)(Object(l.getOr)((a=t,{...M,..._(a)}),["tableById",t],e),["dataTable","tableById",t],e);var a},Se=()=>Object(he.createSelector)(je,(({dataViewId:e,defaultColumns:t,isLoading:a,loadingText:n,queryFields:i,title:r,selectAll:s,graphEventId:o})=>({dataViewId:e,defaultColumns:t,isLoading:a,loadingText:n,queryFields:i,title:r,selectAll:s,graphEventId:o}))),Oe=(e,t)=>e%t,ke=b.a.span`
  font-size: ${({theme:e})=>e.eui.euiFontSizeXS};
  font-weight: ${({theme:e})=>e.eui.euiFontWeightSemiBold};
  border-right: ${({theme:e})=>e.eui.euiBorderThin};
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
  padding-right: ${({theme:e})=>e.eui.euiSizeM};
`,we=g.i18n.translate("securitySolutionPackages.dataTable.ariaLabel",{defaultMessage:"Alerts"}),Te=(e=!1)=>({border:"none",fontSize:"s",header:"underline",stripes:!0===e}),Ie=b.a.div`
  ul.euiPagination__list {
    li.euiPagination__item:last-child {
      ${({hideLastPage:e})=>e?"display:none":""};
    }
  }
  div .euiDataGridRowCell__contentWrapper {
    display: flex;
    align-items: center;
  }
  div .euiDataGridRowCell--lastColumn .euiDataGridRowCell__content {
    flex-grow: 0;
    width: 100%;
  }
  div .siemEventsTable__trSupplement--summary {
    display: block;
  }
`,Ce=u()(((e,t,a)=>{const n=(e=>Object(l.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(t),i=a?N:e;return i?i.map((e=>{var t,a,i,r;const s=n[e.id],o={...e,...s,schema:null!==(t=e.schema)&&void 0!==t?t:D(null==s?void 0:s.type)},l=Object(A.jsx)(p.a.Fragment,null,null!==(a=null!==(i=e.display)&&void 0!==i?i:e.displayAsText)&&void 0!==a?a:e.id);return{...o,actions:null!==(r=e.actions)&&void 0!==r?r:F,defaultSortDirection:"desc",display:Object(A.jsx)(p.a.Fragment,null,l),isSortable:P({browserField:s,fieldName:e.id})}})):[]})),Me=p.a.memo((({additionalControls:e,browserFields:t,bulkActions:a=!0,data:r,fieldBrowserOptions:c,hasCrudPermissions:u,id:b,leadingControlColumns:g,loadPage:v,renderCellValue:E,rowRenderers:x,pagination:j,unitCountText:S,totalItems:O,rowHeightsOptions:k,isEventRenderedView:w=!1,getFieldBrowser:T,getFieldSpec:C,cellActionsTriggerId:_,...F})=>{const P=i.getTableByIdSelector(),D=(N=e=>{var t;return null!==(t=P(e,b))&&void 0!==t?t:M},Object(m.useSelector)(N,m.shallowEqual));var N;const{columns:R,selectedEventIds:L,showCheckboxes:V,sort:U,isLoading:H,defaultColumns:Q}=D,G=Ce(R,t,w),W=Object(d.useRef)(null),Z=Object(m.useDispatch)(),K=Object(d.useMemo)((()=>Object.keys(L).length),[L]),J=Object(d.useContext)(f.ThemeContext),Y=Object(d.useMemo)((()=>{var e,t;return!!u&&!(0===K||!V)&&("boolean"==typeof a?a:null===(e=(null==a||null===(t=a.customBulkActions)||void 0===t?void 0:t.length)||(null==a?void 0:a.alertStatusActions))||void 0===e||e)}),[u,K,V,a]),X=Object(d.useCallback)((()=>{Z(n.updateColumns({id:b,columns:Q}))}),[Q,Z,b]),ee=Object(d.useCallback)((e=>{var t,a,i;G.some((({id:t})=>e===t))?Z(n.removeColumn({columnId:e,id:b})):Z(n.upsertColumn({column:(t=e,a=Q,{columnHeaderType:I,id:t,initialWidth:h,...null!==(i=a.find((e=>e.id===t)))&&void 0!==i?i:{}}),id:b,index:1}))}),[G,Z,b,Q]),te=Object(d.useMemo)((()=>({additionalControls:{left:{append:Object(A.jsx)(p.a.Fragment,null,H&&Object(A.jsx)(o.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),Object(A.jsx)(ke,{"data-test-subj":"server-side-event-count"},S),null!=e?e:null,w?Object(A.jsx)(p.a.Fragment,null):T({browserFields:t,options:c,columnIds:G.map((({id:e})=>e)),onResetColumns:X,onToggleColumn:ee}))}},...Y||w?{showColumnSelector:!1,showSortSelector:!1,showFullScreenSelector:!1}:{showColumnSelector:{allowHide:!1,allowReorder:!0},showSortSelector:!0,showFullScreenSelector:!0},showDisplaySelector:!1})),[H,S,e,w,T,t,c,G,X,ee,Y]),ae=Object(d.useMemo)((()=>U.map((e=>({id:e.columnId,direction:B(e.sortDirection)})))),[U]),ne=Object(d.useCallback)((e=>{Z(n.updateSort({id:b,sort:z({columns:e,columnHeaders:G})})),setTimeout((()=>{null!=v&&v(0)}),0)}),[G,Z,b,v]),ie=Object(d.useMemo)((()=>G.map((({id:e})=>e))),[G]),re=Object(d.useCallback)((({columnId:e,width:t})=>{Z(n.updateColumnWidth({columnId:e,id:b,width:t}))}),[Z,b]),se=Object(d.useCallback)((e=>{Z(n.updateColumnOrder({columnIds:e,id:b}))}),[Z,b]),oe=Object(d.useMemo)((()=>({scopeId:b})),[b]),le=Object(d.useMemo)((()=>_?G.map((e=>{var t;return null!==(t=C(e.id))&&void 0!==t?t:{name:e.id,type:"",aggregatable:!1,searchable:!1}})):void 0),[_,G,C]),ce=Object(d.useCallback)(((e,t)=>{var a;const n=t%r.length;return null===(a=r[n].data.find((t=>t.field===e)))||void 0===a?void 0:a.value}),[r]),ue=Object(y.j)({triggerId:_,fields:le,getCellValue:ce,metadata:oe,dataGridRef:W}),de=Object(d.useMemo)((()=>G.map(((e,t)=>{var a;return{...e,actions:{...e.actions,additional:[{iconType:"cross",label:$,onClick:()=>{Z(n.removeColumn({id:b,columnId:e.id}))},size:"xs"}]},cellActions:null!==(a=ue[t])&&void 0!==a?a:[],visibleCellActions:3}}))),[G,ue,Z,b]),pe=Object(d.useMemo)((()=>({columnId:e,rowIndex:a,colIndex:n,setCellProps:i,isDetails:s})=>{var o;const c=Oe(a,j.pageSize),u=c<r.length?r[c].data:null,p=G.find((t=>t.id===e)),m=c<r.length?r[c]._id:null,f=c<r.length?r[c].ecs:null;return Object(d.useEffect)((()=>{const e={overflow:"hidden"};i({style:{...e}}),f&&u?q(f,J,i,e):i({style:{display:"none"}})}),[a,i,f,u]),null==u||null==p||null==m||null===f?null:E({asPlainText:!1,browserFields:t,columnId:p.id,data:u,ecsData:f,eventId:m,header:p,isDetails:s,isDraggable:!1,isExpandable:!0,isExpanded:!1,linkValues:Object(l.getOr)([],null!==(o=p.linkField)&&void 0!==o?o:"",f),rowIndex:a,colIndex:n,rowRenderers:x,setCellProps:i,scopeId:b,truncate:!s})}),[t,G,r,b,j.pageSize,E,x,J]);return Object(A.jsx)(p.a.Fragment,null,Object(A.jsx)(Ie,{hideLastPage:O>9999},Object(A.jsx)(o.EuiDataGrid,s()({},F,{id:"body-data-grid","data-test-subj":"body-data-grid","aria-label":we,columns:w?G:de,columnVisibility:{visibleColumns:ie,setVisibleColumns:se},gridStyle:Te(w),leadingControlColumns:g,toolbarVisibility:te,rowCount:O,renderCellValue:pe,sorting:{columns:ae,onSort:ne},onColumnResize:re,pagination:j,ref:W,rowHeightsOptions:k}))))}));var _e=a(187),Ae=a(9);const Fe=({id:e,tableById:t,...a})=>{const n=t[e];return{...t,[e]:{...n,...M,...a,isLoading:!1}}},Pe=({column:e,id:t,index:a,tableById:n})=>{const i=n[t];if(-1!==i.columns.findIndex((t=>t.id===e.id))){const r=i.columns.filter((t=>t.id!==e.id));return r.splice(a,0,e),{...n,[t]:{...i,columns:r}}}const r=[...i.columns];return r.splice(a,0,e),{...n,[t]:{...i,columns:r}}},De=({id:e,columnId:t,tableById:a})=>{const n=a[e],i=n.columns.filter((e=>e.id!==t));return{...a,[e]:{...n,columns:i}}},Ne=({id:e,tableById:t,dataTableSettingsProps:a})=>{var n;const i=t[e];return null!=i&&i.initialized?t:{...t,[e]:{...M,..._(e),...i,...a,...!i||Object(Ae.isEmpty)(i.columns)&&!Object(Ae.isEmpty)(a.defaultColumns)?{columns:a.defaultColumns}:{},sort:null!==(n=a.sort)&&void 0!==n?n:M.sort,loadingEventIds:M.loadingEventIds,initialized:!0}}},Re=({id:e,columnId:t,delta:a,tableById:n})=>{var i;const r=n[e],s=r.columns.findIndex((e=>e.id===t));if(-1===s)return{...n,[e]:{...r}};const o=(null!==(i=r.columns[s].initialWidth)&&void 0!==i?i:h)+a,l=Math.max(70,o),c={...r.columns[s],initialWidth:l},u=[...r.columns.slice(0,s),c,...r.columns.slice(s+1)];return{...n,[e]:{...r,columns:u}}},Le=({columnIds:e,id:t,tableById:a})=>{const n=a[t],i=e.reduce(((e,t)=>{const a=n.columns.findIndex((e=>e.id===t));return-1!==a?[...e,n.columns[a]]:e}),[]);return{...a,[t]:{...n,columns:i}}},Be=({columnId:e,id:t,tableById:a,width:n})=>{const i=a[t],r=i.columns.map((t=>({...t,initialWidth:t.id===e?n:t.initialWidth})));return{...a,[t]:{...i,columns:r}}},ze=({id:e,columns:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,columns:t}}},qe=({id:e,sort:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,sort:t}}},$e=({id:e,itemsPerPage:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,itemsPerPage:t}}},Ve=({id:e,itemsPerPageOptions:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,itemsPerPageOptions:t}}},Ue=({id:e,eventIds:t,isDeleted:a,tableById:n})=>{const i=n[e],r=a?Object(l.union)(i.deletedEventIds,t):i.deletedEventIds.filter((e=>!t.includes(e))),s=Object.fromEntries(Object.entries(i.selectedEventIds).filter((([e])=>!r.includes(e)))),o=Object.keys(s).length>0&&i.isSelectAllChecked;return{...n,[e]:{...i,deletedEventIds:r,selectedEventIds:s,isSelectAllChecked:o}}},He=({id:e,eventIds:t,isLoading:a,tableById:n})=>{const i=n[e],r=a?Object(l.union)(i.loadingEventIds,t):i.loadingEventIds.filter((e=>!t.includes(e)));return{...n,[e]:{...i,loadingEventIds:r}}},Qe=({id:e,eventIds:t,isSelectAllChecked:a=!1,isSelected:n,tableById:i})=>{const r=i[e],s=n?{...r.selectedEventIds,...t}:Object(l.omit)(Object.keys(t),r.selectedEventIds);return{...i,[e]:{...r,selectedEventIds:s,isSelectAllChecked:a}}},Ge=e=>{var t;const{tabType:a,id:n,...i}=e,r=new Set(["eventDetail","hostDetail","networkDetail","userDetail"]),s=null!=a?a:"query",o={params:i.params?{...i.params}:{},panelView:i.panelView};return{[s]:r.has(null!==(t=i.panelView)&&void 0!==t?t:"")?o:{}}},We=({id:e,graphEventId:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,graphEventId:t}}},Ze=({id:e,sessionViewConfig:t,tableById:a})=>{const n=a[e];return{...a,[e]:{...n,sessionViewConfig:t}}},Ke=Object(_e.reducerWithInitialState)({tableById:{}}).case(Q,((e,{column:t,id:a,index:n})=>({...e,tableById:Pe({column:t,id:a,index:n,tableById:e.tableById})}))).case(H,((e,t)=>({...e,tableById:Fe({...t,tableById:e.tableById})}))).case(ce,((e,{id:t,...a})=>({...e,tableById:Ne({id:t,tableById:e.tableById,dataTableSettingsProps:a})}))).case(K,((e,t)=>{var a;return{...e,tableById:{...e.tableById,[t.id]:{...e.tableById[t.id],expandedDetail:{...null===(a=e.tableById[t.id])||void 0===a?void 0:a.expandedDetail,...Ge(t)}}}}})).case(G,((e,{id:t,columnId:a,delta:n})=>({...e,tableById:Re({id:t,columnId:a,delta:n,tableById:e.tableById})}))).case(W,((e,{id:t,columnIds:a})=>({...e,tableById:Le({columnIds:a,id:t,tableById:e.tableById})}))).case(Z,((e,{id:t,columnId:a,width:n})=>({...e,tableById:Be({columnId:a,id:t,tableById:e.tableById,width:n})}))).case(J,((e,{id:t,columnId:a})=>({...e,tableById:De({id:t,columnId:a,tableById:e.tableById})}))).case(oe,((e,{id:t,eventIds:a,isDeleted:n})=>({...e,tableById:Ue({id:t,eventIds:a,tableById:e.tableById,isDeleted:n})}))).case(le,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],deletedEventIds:[]}}}))).case(re,((e,{id:t,eventIds:a,isLoading:n})=>({...e,tableById:He({id:t,eventIds:a,tableById:e.tableById,isLoading:n})}))).case(se,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],loadingEventIds:[]}}}))).case(ne,((e,{id:t,eventIds:a,isSelected:n,isSelectAllChecked:i})=>({...e,tableById:Qe({id:t,eventIds:a,tableById:e.tableById,isSelected:n,isSelectAllChecked:i})}))).case(ie,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],selectedEventIds:{},isSelectAllChecked:!1}}}))).case(Y,((e,{id:t,isLoading:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],isLoading:a}}}))).case(X,((e,{id:t,columns:a})=>({...e,tableById:ze({id:t,columns:a,tableById:e.tableById})}))).case(ae,((e,{id:t,sort:a})=>({...e,tableById:qe({id:t,sort:a,tableById:e.tableById})}))).case(ee,((e,{id:t,itemsPerPage:a})=>({...e,tableById:$e({id:t,itemsPerPage:a,tableById:e.tableById})}))).case(te,((e,{id:t,itemsPerPageOptions:a})=>({...e,tableById:Ve({id:t,itemsPerPageOptions:a,tableById:e.tableById})}))).case(ue,((e,{id:t,selectAll:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],selectAll:a}}}))).case(de,((e,{id:t,graphEventId:a})=>({...e,tableById:We({id:t,graphEventId:a,tableById:e.tableById})}))).case(pe,((e,{id:t,sessionViewConfig:a})=>({...e,tableById:Ze({id:t,sessionViewConfig:a,tableById:e.tableById})}))).case(me,((e,{id:t,updated:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],updated:a}}}))).case(fe,((e,{id:t,totalCount:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],totalCount:a}}}))).case(be,((e,{id:t,viewMode:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],viewMode:a}}}))).case(ge,((e,{id:t,showBuildingBlockAlerts:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],additionalFilters:{...e.tableById[t].additionalFilters,showBuildingBlockAlerts:a}}}}))).case(ye,((e,{id:t,showOnlyThreatIndicatorAlerts:a})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],additionalFilters:{...e.tableById[t].additionalFilters,showOnlyThreatIndicatorAlerts:a}}}}))).build()},function(e,t,a){"use strict";a.d(t,"b",(function(){return n.a})),a.d(t,"h",(function(){return i.f})),a.d(t,"i",(function(){return i.g})),a.d(t,"w",(function(){return i.v})),a.d(t,"x",(function(){return i.w})),a.d(t,"F",(function(){return i.D})),a.d(t,"c",(function(){return i.b})),a.d(t,"u",(function(){return i.t})),a.d(t,"D",(function(){return i.B})),a.d(t,"E",(function(){return i.C})),a.d(t,"B",(function(){return i.z})),a.d(t,"C",(function(){return i.A})),a.d(t,"A",(function(){return i.y})),a.d(t,"v",(function(){return i.u})),a.d(t,"k",(function(){return i.i})),a.d(t,"m",(function(){return i.l})),a.d(t,"s",(function(){return i.r})),a.d(t,"f",(function(){return i.d})),a.d(t,"g",(function(){return i.e})),a.d(t,"n",(function(){return i.m})),a.d(t,"o",(function(){return i.n})),a.d(t,"p",(function(){return i.o})),a.d(t,"r",(function(){return i.q})),a.d(t,"t",(function(){return i.s})),a.d(t,"q",(function(){return i.p})),a.d(t,"l",(function(){return i.k})),a.d(t,"a",(function(){return i.a})),a.d(t,"z",(function(){return i.x})),a.d(t,"d",(function(){return i.c})),a.d(t,"j",(function(){return r.b})),a.d(t,"y",(function(){return r.c})),a.d(t,"e",(function(){return r.a}));var n=a(445),i=a(294),r=a(573);a(58)},function(e,t,a){"use strict";a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(45),i=a(2),r=a.n(i),s=a(44),o=a.n(s);const l=a(5).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=o.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));c.displayName="EmptyWrapper";const u=()=>"â€”",d=()=>`(${l})`,p=()=>r.a.createElement(c,null,u()),m=()=>r.a.createElement(c,null,d()),f=e=>null==e?p():Object(n.isString)(e)&&""===e?m():r.a.createElement(r.a.Fragment,null,e),b=e=>null==e?p():""===e?m():r.a.createElement(r.a.Fragment,null,e)},function(e,t,a){"use strict";a.r(t),a.d(t,"parseRoute",(function(){return g})),a.d(t,"manageOldSiemRoutes",(function(){return y})),a.d(t,"getInspectResponse",(function(){return h})),a.d(t,"isDetectionsPath",(function(){return v})),a.d(t,"isDashboardViewPath",(function(){return E})),a.d(t,"isTourPath",(function(){return x})),a.d(t,"isThreatIntelligencePath",(function(){return j})),a.d(t,"getSubPluginRoutesByCapabilities",(function(){return S})),a.d(t,"isSubPluginAvailable",(function(){return O})),a.d(t,"getFieldKey",(function(){return T})),a.d(t,"getField",(function(){return I})),a.d(t,"isTimelineScope",(function(){return C})),a.d(t,"isInTableScope",(function(){return M})),a.d(t,"isAlertsPageScope",(function(){return _})),a.d(t,"getScopedActions",(function(){return A})),a.d(t,"getScopedSelectors",(function(){return F})),a.d(t,"isActiveTimeline",(function(){return P})),a.d(t,"getSourcererScopeId",(function(){return D}));var n=a(142),i=a(45),r=a(2),s=a.n(r),o=a(49),l=a(124),c=a(9),u=a(4),d=a(574),p=a(129),m=a(118),f=a(151),b=a(116);const g=e=>{if(!Object(i.isEmpty)(e.hash)){var t;const a=e.hash.split("?"),n=a.length>=1?`?${a[1]}`:"",i=a.length>0?a[0].split("/"):[];return{pageName:i.length>=1?i[1]:"",path:`/${null!==(t=i.slice(2).join("/"))&&void 0!==t?t:""}${n}`,search:n}}const a=e.search,n=e.pathname.split("/");return{pageName:n[3],path:`${n.length>4?`/${n.slice(4).join("/")}`:""}${a}`,search:a}},y=async e=>{const{application:t}=e,{pageName:a,path:n}=g(window.location);switch(a){case p.a.overview:t.navigateToApp(u.l,{deepLinkId:p.a.overview,replace:!0,path:n});break;case"ml-hosts":t.navigateToApp(u.l,{deepLinkId:p.a.hosts,replace:!0,path:`/ml-hosts${n}`});break;case p.a.hosts:t.navigateToApp(u.l,{deepLinkId:p.a.hosts,replace:!0,path:n});break;case"ml-network":t.navigateToApp(u.l,{deepLinkId:p.a.network,replace:!0,path:`/ml-network${n}`});break;case p.a.network:t.navigateToApp(u.l,{deepLinkId:p.a.network,replace:!0,path:n});break;case p.a.timelines:t.navigateToApp(u.l,{deepLinkId:p.a.timelines,replace:!0,path:n});break;case p.a.case:case"case":t.navigateToApp(u.l,{deepLinkId:p.a.case,replace:!0,path:n});break;case p.a.detections:case p.a.alerts:t.navigateToApp(u.l,{deepLinkId:p.a.alerts,replace:!0,path:n});break;case p.a.rules:t.navigateToApp(u.l,{deepLinkId:p.a.rules,replace:!0,path:n});break;case p.a.exceptions:t.navigateToApp(u.l,{deepLinkId:p.a.exceptions,replace:!0,path:n});break;default:t.navigateToApp(u.l,{deepLinkId:p.a.landing,replace:!0,path:n})}},h=(e,t)=>({dsl:Object(c.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),v=e=>!!Object(o.matchPath)(e,{path:`(${u.d}|${u.oc}|${u.vb})`,strict:!1}),E=e=>null!=Object(o.matchPath)(e,{path:`${u.u}/:detailName`,exact:!1,strict:!1}),x=e=>(e=>!!Object(o.matchPath)(e,{path:`${u.d}`,strict:!1}))(e)||(e=>!!Object(o.matchPath)(e,{path:`${u.s}/:detailName`,strict:!1}))(e),j=e=>!!Object(o.matchPath)(e,{path:`(${u.zc})`,strict:!1}),S=(e,t,a)=>Object.entries(e).reduce(((e,[n,i])=>{if(O(n,t))e.push(...i.routes);else{const t=e=>e.siem.privileges;e.push(...i.routes.map((e=>({path:e.path,component:()=>{const e=a.upselling.getPageUpselling(n);return e?s.a.createElement(e,null):s.a.createElement(d.b,{pageName:n,docLinkSelector:t})}}))))}return e}),[]),O=(e,t)=>"cases"===e?!0===t[u.r].read_cases:!0===t[u.vc].show,k={[n.V]:"signal.rule.id",[n.G]:"signal.rule.name",[`${n.J}.filters`]:"signal.rule.filters",[`${n.J}.language`]:"signal.rule.language",[`${n.J}.query`]:"signal.rule.query"},w={"signal.rule.id":n.V,"signal.rule.name":n.G,"signal.rule.filters":`${n.J}.filters`,"signal.rule.language":`${n.J}.language`,"signal.rule.query":`${n.J}.query`},T=(e,t)=>{var a,n;const r=(null!==(a=w[t])&&void 0!==a?a:t).replace("signal","kibana.alert"),s=(null!==(n=k[t])&&void 0!==n?n:t).replace("kibana.alert","signal");return Object(i.has)(r,e)?r:s},I=(e,t)=>{var a,n,r;const s=(null!==(a=w[t])&&void 0!==a?a:t).replace("signal","kibana.alert"),o=(null!==(n=k[t])&&void 0!==n?n:t).replace("kibana.alert","signal"),l=s.split(".");if(l.includes("parameters")&&"parameters"!==l[l.length-1]){const t=l.slice(0,l.length-1).join("."),a=Object(i.get)(t,e);return Object(i.get)(l[l.length-1],a)}return null!==(r=Object(i.get)(s,e))&&void 0!==r?r:Object(i.get)(o,e)},C=e=>Object.values(f.f).includes(e),M=e=>Object.values(l.e).includes(e),_=e=>[l.e.alertsOnAlertsPage,l.e.alertsOnRuleDetailsPage,l.e.alertsOnCasePage].includes(e),A=e=>C(e)?m.a:M(e)?l.h:void 0,F=e=>C(e)?m.a:M(e)?l.h:void 0,P=e=>e===f.f.active,D=e=>C(e)?b.SourcererScopeName.timeline:_(e)?b.SourcererScopeName.detections:b.SourcererScopeName.default},function(e,t,a){"use strict";a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b})),a.d(t,"d",(function(){return n.c})),a.d(t,"e",(function(){return n.d})),a.d(t,"c",(function(){return i.b})),a.d(t,"f",(function(){return r})),a(167),a(195),a(138),a(149),a(482);var n=a(582),i=a(342);const r=(e,t)=>a=>{const n={...a,getState:()=>e(a.getState())};return t(n)}},function(e,t,a){"use strict";var n=a(4);a.d(t,"a",(function(){return n.yc}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(48),i=a(16);const r=Object(i.b)(),s=e=>{const t=o();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},o=()=>Object(n.useSelector)((({app:{enableExperimental:e}})=>e))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=a(38).__importDefault(a(774));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"k",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"n",(function(){return m})),a.d(t,"o",(function(){return f})),a.d(t,"q",(function(){return b})),a.d(t,"p",(function(){return g})),a.d(t,"y",(function(){return y})),a.d(t,"A",(function(){return h})),a.d(t,"B",(function(){return v})),a.d(t,"C",(function(){return E})),a.d(t,"D",(function(){return x})),a.d(t,"d",(function(){return j})),a.d(t,"e",(function(){return S})),a.d(t,"f",(function(){return O})),a.d(t,"g",(function(){return k})),a.d(t,"E",(function(){return w})),a.d(t,"F",(function(){return T})),a.d(t,"G",(function(){return I})),a.d(t,"H",(function(){return C})),a.d(t,"J",(function(){return M})),a.d(t,"K",(function(){return _})),a.d(t,"L",(function(){return A})),a.d(t,"M",(function(){return F})),a.d(t,"Y",(function(){return P})),a.d(t,"Z",(function(){return D})),a.d(t,"ab",(function(){return N})),a.d(t,"bb",(function(){return R})),a.d(t,"z",(function(){return L})),a.d(t,"cb",(function(){return B})),a.d(t,"db",(function(){return z})),a.d(t,"N",(function(){return q})),a.d(t,"O",(function(){return $})),a.d(t,"Q",(function(){return V})),a.d(t,"T",(function(){return U})),a.d(t,"U",(function(){return H})),a.d(t,"R",(function(){return Q})),a.d(t,"S",(function(){return G})),a.d(t,"X",(function(){return W})),a.d(t,"W",(function(){return Z})),a.d(t,"s",(function(){return K})),a.d(t,"r",(function(){return J})),a.d(t,"w",(function(){return Y})),a.d(t,"P",(function(){return X})),a.d(t,"x",(function(){return ee})),a.d(t,"I",(function(){return te})),a.d(t,"V",(function(){return ae})),a.d(t,"t",(function(){return ne})),a.d(t,"v",(function(){return ie})),a.d(t,"u",(function(){return re}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=n.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),s=n.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=n.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=n.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),c=n.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),u=n.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=n.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=n.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=n.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=n.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),b=n.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),g=n.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=n.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),h=n.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),v=n.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=n.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=n.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),j=n.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),S=n.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),O=n.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),k=n.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=n.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),T=n.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),I=n.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timelineâ€¦"}),C=n.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),M=n.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),_=n.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),A=n.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),F=n.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),P=n.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),D=n.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),N=n.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),R=n.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),L=n.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),B=n.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),z=n.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>n.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),$=e=>n.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),V=n.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),U=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),Q=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),G=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),W=n.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),Z=n.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),K=n.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),J=n.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Y=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),X=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),ee=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),te=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ae=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ne=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ie=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Importâ€¦"}),re=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},,function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(122),i=a(113),r=a(196),s=a(335);const{from:o,to:l}=Object(s.a)({from:"",to:""},!1),c={activeTab:n.d.query,prevActiveTab:n.d.query,columns:r.b,documentType:"",defaultColumns:r.b,dataProviders:[],dataViewId:null,dateRange:{start:o,end:l},description:"",eqlOptions:{eventCategoryField:"event.category",tiebreakerField:"",timestampField:"@timestamp",query:"",size:100},eventType:"all",eventIdToNoteIds:{},excludedRowRendererIds:[],expandedDetail:{},highlightedDropAndProviderId:"",historyIds:[],indexNames:[],isFavorite:!1,isLive:!1,isLoading:!1,isSaving:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],kqlMode:"filter",kqlQuery:{filterQuery:null},loadingEventIds:[],resolveTimelineConfig:void 0,queryFields:[],title:"",timelineType:i.l.default,templateTimelineId:null,templateTimelineVersion:null,noteIds:[],pinnedEventIds:{},pinnedEventsSaveObject:{},savedObjectId:null,selectAll:!1,sessionViewConfig:null,show:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],status:i.k.draft,version:null,deletedEventIds:[],selectedEventIds:{},isSelectAllChecked:!1,filters:[],savedSearchId:null,savedSearch:null,isDiscoverSavedSearchLoaded:!1,isDataProviderVisible:!1},u=e=>({defaultColumns:r.b,documentType:"",selectAll:!1,id:e,isLoading:!1,queryFields:[],title:"",graphEventId:""})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(891);const r=()=>Object(n.useContext)(i.a)},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,i,r;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(i=n;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,r[i]))return!1;for(i=n;0!=i--;){var s=r[i];if(!e(t[s],a[s]))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){"use strict";a.d(t,"g",(function(){return x.d})),a.d(t,"f",(function(){return x.c})),a.d(t,"o",(function(){return w})),a.d(t,"m",(function(){return C})),a.d(t,"d",(function(){return _})),a.d(t,"h",(function(){return D})),a.d(t,"a",(function(){return R})),a.d(t,"c",(function(){return L})),a.d(t,"i",(function(){return B})),a.d(t,"e",(function(){return z})),a.d(t,"b",(function(){return q})),a.d(t,"j",(function(){return Q})),a.d(t,"n",(function(){return G})),a.d(t,"l",(function(){return W})),a.d(t,"k",(function(){return Z}));var n=a(17),i=a(2),r=a.n(i),s=a(45),o=a(470),l=a(266),c=a(526),u=a(4),d=a(563),p=a(164),m=a(245),f=a(110),b=a(226),g=a(5),y=a(397);const h=e=>g.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var v=a(129),E=a(527),x=a(284),j=a(23),S=a.n(j),O=a(462),k=a(486);const w=()=>{const e=Object(O.b)(),t=Object(k.a)();return Object(i.useCallback)((({deepLinkId:a,path:n,onClick:i})=>{const r=t(a);return e({id:a,path:n,urlState:r,onClick:i})}),[e,t])},T=e=>(e=>r.a.memo((function({deepLinkId:t,...a}){const n=Object(k.a)()(t);return r.a.createElement(e,S()({id:t,urlState:n},a))})))(Object(O.d)(e)),I=({children:e,Component:t,userName:a,isButton:n,onClick:s,title:o,userTab:l})=>{const c=encodeURIComponent(a),{formatUrl:d,search:m}=Object(p.l)(v.a.users),{application:{navigateToApp:b},telemetry:g}=Object(f.i)().services,y=Object(i.useCallback)((e=>{e.preventDefault(),b(u.l,{deepLinkId:v.a.users,path:l?Object(E.a)(c,l,m):Object(E.c)(c,m)})}),[c,b,m,l]),h=Object(i.useMemo)((()=>d(l?Object(E.a)(c,l):Object(E.c)(c))),[d,c,l]),j=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"user"}),(null!=s?s:y)(e)}),[y,s,g]);return n?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-user-details",href:h,onClick:j,title:null!=o?o:a},e||a):r.a.createElement(x.c,{"data-test-subj":"users-link-anchor",onClick:j,href:h},e||a)},C=r.a.memo(I),M=({children:e,Component:t,hostName:a,isButton:n,onClick:s,title:o,hostTab:l})=>{const{formatUrl:c,search:d}=Object(p.l)(v.a.hosts),{application:{navigateToApp:m},telemetry:b}=Object(f.i)().services,g=encodeURIComponent(a),y=Object(i.useCallback)((e=>{e.preventDefault(),m(u.l,{deepLinkId:v.a.hosts,path:l?Object(p.i)(g,l,d):Object(p.d)(g,d)})}),[g,m,d,l]),h=Object(i.useMemo)((()=>c(l?Object(p.i)(g,l):Object(p.d)(g))),[c,g,l]),E=Object(i.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"host"}),(null!=s?s:y)(e)}),[y,s,b]);return n?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-host-details",href:h,iconType:"expand",onClick:E,title:null!=o?o:a},e):r.a.createElement(x.c,{onClick:E,href:h,"data-test-subj":"host-details-button"},e||a)},_=r.a.memo(M),A=["http://","https://"],F=r.a.memo((({url:e,children:t,idx:a,overflowIndexStart:i=5,allItemsLimit:o=5})=>{const l=i-1,c=o-1,u=Math.max(0,Math.min(l,c)),d=A.some((t=>0===e.indexOf(t)));return e&&d&&!Object(b.c)(e)&&t?r.a.createElement(n.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(s.isNil)(a)&&a<u&&r.a.createElement(x.a,{"data-test-subj":"externalLinkComma"}))):null}));F.displayName="ExternalLink";const P=({Component:e,children:t,ip:a,flowTarget:n=m.a.source,isButton:o,onClick:l,title:c})=>{const u=w(),f=Object(i.useCallback)(((a,i)=>{const{onClick:s,href:m}=u({deepLinkId:v.a.network,path:Object(p.f)(encodeURIComponent(Object(d.c)(a)),n)}),f=null!=l?l:e=>s(e);return o?r.a.createElement(x.b,{Component:e,key:`${a}-${i}`,dataTestSubj:"data-grid-network-details",onClick:f,href:m,title:null!=c?c:a},t):r.a.createElement(x.c,{key:`${a}-${i}`,onClick:f,href:m,"data-test-subj":"network-details"},t||a)}),[t,e,n,u,l,o,c]);return Object(s.isArray)(a)?r.a.createElement(r.a.Fragment,null,a.map(f)):f(a,0)},D=r.a.memo(P),N=({index:e,children:t,detailName:a,title:n})=>{const{formatUrl:s,search:d}=Object(p.l)(v.a.case),{navigateToApp:m}=Object(f.i)().services.application,{activeStep:b,isTourShown:g}=Object(c.b)(),y=Object(i.useMemo)((()=>b===l.a.viewCase&&g(l.b.alertsCases)&&0===e),[b,e,g]),E=Object(i.useCallback)((async e=>(e&&e.preventDefault(),m(u.l,{deepLinkId:v.a.case,path:Object(p.a)({id:a,search:d})}))),[a,m,d]);return Object(i.useEffect)((()=>{var e;y&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[y]),r.a.createElement(o.a,{onClick:E,isTourAnchor:y,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(x.c,{onClick:E,href:s(Object(p.a)({id:a})),"data-test-subj":"case-details-link","aria-label":h(null!=n?n:a)},t||a))},R=r.a.memo(N);R.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:a}=Object(p.l)(v.a.case),{navigateToApp:n}=Object(f.i)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),n(u.l,{deepLinkId:v.a.case,path:Object(p.b)(a)}))),[n,a]);return r.a.createElement(x.c,{onClick:s,href:t(Object(p.b)())},e)})).displayName="CreateCaseLink";const L=r.a.memo((({children:e,link:t})=>{const a=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(F,{url:a},e||t)}));L.displayName="GoogleLink";const B=r.a.memo((({Component:e,title:t,children:a,portOrServiceName:s})=>{var o;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(s))}`),[s]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:a)&&void 0!==o?o:s):r.a.createElement(x.e,null,r.a.createElement(n.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},a||s))}));B.displayName="PortOrServiceNameLink";const z=r.a.memo((({children:e,ja3Fingerprint:t})=>{const a=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(n.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:a,target:"_blank"},e||t)}));z.displayName="Ja3FingerprintLink";const q=r.a.memo((({children:e,certificateFingerprint:t})=>{const a=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(n.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:a,target:"_blank"},e||t)}));var $;function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}q.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}($||($={}));const U={[$["virustotal.com"]]:y.m,[$["talosIntelligence.com"]]:y.l},H=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:a=!1,domain:o,direction:l="row"})=>{const[c]=Object(f.o)(u.Gb),d=Object(i.useMemo)((()=>null==c?void 0:c.slice(0,t).filter((({url_template:e,name:t})=>!Object(s.isNil)(e)&&!Object(s.isNil)(t)&&!Object(b.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(o))})))),[c,o,U,t]),p=Object(i.useCallback)((a=>{var n;return(e=>void 0!==e.url_template&&void 0!==e.name)(a)&&r.a.createElement(F,{url:a.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(n=a.name)&&void 0!==n?n:o))}),[t,o,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(n.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:n},i)=>r.a.createElement(F,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:n,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},r.a.createElement(r.a.Fragment,null,a?o:null!=t?t:o))))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(x.f,{rowItems:d,render:p,moreMaxHeight:"200px",overflowIndexStart:e})))):null};H.displayName="ReputationLinkComponent";const Q=r.a.memo(H),G=r.a.memo((({children:e,domain:t})=>{const a=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(F,{url:a},e||t)}));G.displayName="WhoIsLink";const W=T(x.d),Z=T(x.c)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return i}));var n=a(158),i=(a(579),a(580)),r=a(45),s=a(187),o=a(119),l=a(281),c=a(581);const{socTrends:u,...d}=Object(l.d)(!1),p={global:{timerange:{kind:"relative",...d},queries:[],policy:Object(l.c)(!1),linkTo:[o.a.timeline],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",...d},queries:[],policy:Object(l.c)(!1),linkTo:[o.a.global],query:{query:"",language:"kuery"},filters:[],fullScreen:!1}},m=e=>{const{from:t,fromStr:a,to:n,toStr:i,socTrends:r}=Object(l.d)(),{kind:s,duration:c}=Object(l.c)();return{global:{timerange:{kind:"relative",fromStr:a,toStr:i,from:t,to:n},queries:[],policy:{kind:s,duration:c},linkTo:[o.a.timeline,...e?[o.a.socTrends]:[]],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",fromStr:a,toStr:i,from:t,to:n},queries:[],policy:{kind:s,duration:c},linkTo:[o.a.global],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},...e?{socTrends:{timerange:r,linkTo:[o.a.global],policy:{kind:s,duration:c}}}:{}}},f=Object(s.reducerWithInitialState)(p).case(n.setTimelineRangeDatePicker,((e,{from:t,to:a})=>({...e,global:{...e.global,linkTo:e.global.linkTo.filter((e=>e!==o.a.timeline))},timeline:{...e.timeline,timerange:{kind:"absolute",fromStr:void 0,toStr:void 0,from:t,to:a},linkTo:[]}}))).case(n.setAbsoluteRangeDatePicker,((e,{id:t,from:a,to:n,fromStr:i,toStr:r})=>{const s={kind:"absolute",fromStr:i,toStr:r,from:a,to:n};return Object(c.i)(t,s,e)})).case(n.setRelativeRangeDatePicker,((e,{id:t,fromStr:a,from:n,to:i,toStr:r})=>{const s={kind:"relative",fromStr:a,toStr:r,from:n,to:i};return Object(c.i)(t,s,e)})).case(n.setFullScreen,((e,{id:t,fullScreen:a})=>Object(c.h)(t,a,e))).case(n.deleteAllQuery,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),queries:e.global.queries.slice(e.global.queries.length)}}))).case(n.setQuery,((e,{inputId:t,id:a,inspect:n,loading:i,refetch:r,searchSessionId:s})=>Object(c.j)({inputId:t,id:a,inspect:n,loading:i,refetch:r,state:e,searchSessionId:s}))).case(n.deleteOneQuery,((e,{inputId:t,id:a})=>Object(c.b)({inputId:t,id:a,state:e}))).case(n.setDuration,((e,{id:t,duration:a})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),duration:a}}}))).case(n.startAutoReload,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),kind:"interval"}}}))).case(n.stopAutoReload,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),kind:"manual"}}}))).case(n.toggleTimelineLinkTo,(e=>Object(c.g)(e))).case(n.toggleSocTrendsLinkTo,(e=>Object(c.f)(e))).case(n.setInspectionParameter,((e,{id:t,inputId:a,isInspected:n,selectedInspectIndex:i,searchSessionId:r})=>Object(c.e)({id:t,inputId:a,isInspected:n,selectedInspectIndex:i,state:e,searchSessionId:r}))).case(n.removeLinkTo,((e,t)=>Object(c.d)(t,e))).case(n.addLinkTo,((e,t)=>Object(c.a)(t,e))).case(n.setFilterQuery,((e,{id:t,query:a,language:n})=>({...e,[t]:{...Object(r.get)(t,e),query:{query:a,language:n}}}))).case(n.setSavedQuery,((e,{id:t,savedQuery:a})=>({...e,[t]:{...Object(r.get)(t,e),savedQuery:a}}))).case(n.setSearchBarFilter,((e,{id:t,filters:a})=>({...e,[t]:{...Object(r.get)(t,e),filters:a}}))).build()},,,function(e,t,a){"use strict";a.d(t,"m",(function(){return r})),a.d(t,"K",(function(){return s})),a.d(t,"N",(function(){return o})),a.d(t,"I",(function(){return l})),a.d(t,"z",(function(){return c})),a.d(t,"P",(function(){return u})),a.d(t,"k",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"D",(function(){return f})),a.d(t,"E",(function(){return b})),a.d(t,"F",(function(){return g})),a.d(t,"p",(function(){return y})),a.d(t,"q",(function(){return h})),a.d(t,"V",(function(){return v})),a.d(t,"W",(function(){return E})),a.d(t,"O",(function(){return x})),a.d(t,"H",(function(){return j})),a.d(t,"G",(function(){return S})),a.d(t,"y",(function(){return O})),a.d(t,"B",(function(){return k})),a.d(t,"M",(function(){return w})),a.d(t,"h",(function(){return T})),a.d(t,"U",(function(){return I})),a.d(t,"d",(function(){return C})),a.d(t,"b",(function(){return M})),a.d(t,"c",(function(){return _})),a.d(t,"l",(function(){return A})),a.d(t,"X",(function(){return R})),a.d(t,"f",(function(){return L})),a.d(t,"e",(function(){return B})),a.d(t,"T",(function(){return z})),a.d(t,"L",(function(){return q})),a.d(t,"C",(function(){return $})),a.d(t,"J",(function(){return V})),a.d(t,"ab",(function(){return U})),a.d(t,"bb",(function(){return H})),a.d(t,"o",(function(){return G})),a.d(t,"Y",(function(){return W})),a.d(t,"Z",(function(){return Z})),a.d(t,"S",(function(){return K})),a.d(t,"R",(function(){return J})),a.d(t,"Q",(function(){return Y})),a.d(t,"n",(function(){return ee})),a.d(t,"g",(function(){return te})),a.d(t,"x",(function(){return ae})),a.d(t,"t",(function(){return ie})),a.d(t,"s",(function(){return re})),a.d(t,"w",(function(){return se})),a.d(t,"u",(function(){return oe})),a.d(t,"v",(function(){return le})),a.d(t,"r",(function(){return ce})),a.d(t,"A",(function(){return de})),a.d(t,"a",(function(){return pe}));var n=a(111),i=a(182);const r=n.z.string().min(1).regex(/^(?! *$).+$/),s=n.z.string().uuid(),o=n.z.string(),l=n.z.string().min(1),c=n.z.string().min(1),u=n.z.number().int().min(1),d=(n.z.enum(["kuery","lucene","eql","esql"]).enum,n.z.enum(["kuery","lucene"])),p=(d.enum,n.z.boolean()),m=n.z.boolean(),f=n.z.string(),b=n.z.string().superRefine(i.c),g=n.z.string(),y=n.z.number().int().min(0).max(100),h=n.z.array(n.z.object({field:n.z.string(),operator:n.z.literal("equals"),value:n.z.string(),risk_score:y.optional()})),v=n.z.enum(["low","medium","high","critical"]),E=(v.enum,n.z.array(n.z.object({field:n.z.string(),operator:n.z.literal("equals"),severity:v,value:n.z.string()}))),x=n.z.array(n.z.string()),j=n.z.object({}).catchall(n.z.unknown()),S=n.z.string(),O=n.z.array(n.z.string()),k=n.z.array(n.z.string()),w=n.z.array(n.z.string()),T=n.z.string(),I=n.z.string(),C=n.z.string(),M=n.z.string(),_=n.z.string(),A=n.z.number().int().min(1),F=n.z.object({id:n.z.string(),name:n.z.string(),reference:n.z.string()}),P=n.z.object({id:n.z.string(),name:n.z.string(),reference:n.z.string(),subtechnique:n.z.array(F).optional()}),D=n.z.object({id:n.z.string(),name:n.z.string(),reference:n.z.string()}),N=n.z.object({framework:n.z.string(),tactic:D,technique:n.z.array(P).optional()}),R=n.z.array(N),L=n.z.array(n.z.string()),B=n.z.string(),z=n.z.string(),q=n.z.string(),$=n.z.array(n.z.unknown()),V=n.z.string(),U=n.z.string(),H=n.z.boolean(),Q=n.z.object({name:r,type:r,ecs:n.z.boolean()}),G=n.z.array(Q),W=n.z.string(),Z=n.z.string(),K=n.z.enum(["exactMatch","aliasMatch","conflict"]),J=(K.enum,n.z.string()),Y=n.z.enum(["savedObjectConversion","savedObjectImport"]),X=(Y.enum,n.z.object({package:r,version:r,integration:r.optional()})),ee=n.z.array(X),te=n.z.object({field_names:n.z.array(r).min(1)}),ae=n.z.union([n.z.enum(["no_actions","rule"]),n.z.string().regex(/^[1-9]\d*[smhd]$/)]),ne=n.z.enum(["onActiveAlert","onThrottleInterval","onActionGroupChange"]),ie=(ne.enum,n.z.object({summary:n.z.boolean(),notifyWhen:ne,throttle:ae.nullable()})),re=n.z.object({}).catchall(n.z.unknown()),se=n.z.object({}).catchall(n.z.unknown()),oe=n.z.string(),le=n.z.string(),ce=n.z.object({action_type_id:n.z.string(),group:oe,id:le,params:se,uuid:r.optional(),alerts_filter:re.optional(),frequency:ie.optional()}),ue=n.z.enum(["detection","rule_default","endpoint","endpoint_trusted_apps","endpoint_events","endpoint_host_isolation_exceptions","endpoint_blocklists"]),de=(ue.enum,n.z.object({id:r,list_id:r,type:ue,namespace_type:n.z.enum(["agnostic","single"])})),pe=n.z.object({value:n.z.number().int().min(1),unit:n.z.enum(["s","m","h"])})},function(e,t,a){"use strict";a.d(t,"r",(function(){return r})),a.d(t,"H",(function(){return s})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"q",(function(){return b})),a.d(t,"o",(function(){return g})),a.d(t,"p",(function(){return y})),a.d(t,"s",(function(){return h})),a.d(t,"v",(function(){return w})),a.d(t,"w",(function(){return T})),a.d(t,"C",(function(){return I})),a.d(t,"G",(function(){return C})),a.d(t,"J",(function(){return M})),a.d(t,"K",(function(){return _})),a.d(t,"M",(function(){return A})),a.d(t,"P",(function(){return F})),a.d(t,"S",(function(){return P})),a.d(t,"V",(function(){return N})),a.d(t,"Y",(function(){return v})),a.d(t,"Z",(function(){return E})),a.d(t,"jb",(function(){return x})),a.d(t,"kb",(function(){return D})),a.d(t,"lb",(function(){return j})),a.d(t,"mb",(function(){return k})),a.d(t,"ob",(function(){return S})),a.d(t,"qb",(function(){return O})),a.d(t,"wb",(function(){return o})),a.d(t,"yb",(function(){return n})),a.d(t,"zb",(function(){return l})),a.d(t,"t",(function(){return q})),a.d(t,"u",(function(){return $})),a.d(t,"x",(function(){return V})),a.d(t,"y",(function(){return U})),a.d(t,"z",(function(){return H})),a.d(t,"A",(function(){return Q})),a.d(t,"D",(function(){return G})),a.d(t,"E",(function(){return W})),a.d(t,"F",(function(){return Z})),a.d(t,"I",(function(){return K})),a.d(t,"L",(function(){return J})),a.d(t,"N",(function(){return Y})),a.d(t,"O",(function(){return X})),a.d(t,"Q",(function(){return ee})),a.d(t,"R",(function(){return te})),a.d(t,"T",(function(){return ae})),a.d(t,"U",(function(){return ne})),a.d(t,"W",(function(){return ie})),a.d(t,"X",(function(){return re})),a.d(t,"cb",(function(){return pe})),a.d(t,"db",(function(){return de})),a.d(t,"eb",(function(){return le})),a.d(t,"fb",(function(){return ue})),a.d(t,"gb",(function(){return oe})),a.d(t,"hb",(function(){return ce})),a.d(t,"ib",(function(){return me})),a.d(t,"nb",(function(){return fe})),a.d(t,"rb",(function(){return be})),a.d(t,"pb",(function(){return ge})),a.d(t,"tb",(function(){return R})),a.d(t,"ub",(function(){return L})),a.d(t,"vb",(function(){return B})),a.d(t,"xb",(function(){return z})),a.d(t,"b",(function(){return ye})),a.d(t,"g",(function(){return he})),a.d(t,"h",(function(){return ve})),a.d(t,"d",(function(){return Ee})),a.d(t,"i",(function(){return xe})),a.d(t,"l",(function(){return je})),a.d(t,"m",(function(){return Se})),a.d(t,"n",(function(){return Oe})),a.d(t,"B",(function(){return ke})),a.d(t,"sb",(function(){return we})),a.d(t,"ab",(function(){return Te})),a.d(t,"bb",(function(){return Ie}));const n="@timestamp",i="kibana",r=`${i}.alert`,s=`${r}.rule`,o=`${i}.space_ids`,l=`${i}.version`,c=`${r}.action_group`,u=`${r}.case_ids`,d=`${r}.duration.us`,p=`${r}.end`,m=`${r}.flapping`,f=`${r}.flapping_history`,b=`${r}.maintenance_window_ids`,g=`${r}.instance.id`,y=`${r}.last_detected`,h=`${r}.reason`,v=`${r}.start`,E=`${r}.status`,x=`${r}.time_range`,j=`${r}.uuid`,S=`${r}.workflow_status`,O=`${r}.workflow_tags`,k=`${r}.workflow_assignee_ids`,w=`${s}.category`,T=`${s}.consumer`,I=`${s}.execution.uuid`,C=`${s}.name`,M=`${s}.parameters`,_=`${s}.producer`,A=`${s}.revision`,F=`${s}.tags`,P=`${s}.rule_type_id`,D=`${r}.url`,N=`${s}.uuid`,R="ecs.version",L="event.action",B="event.kind",z="tags",q=`${r}.risk_score`,$=`${s}.author`,V=`${s}.created_at`,U=`${s}.created_by`,H=`${s}.description`,Q=`${s}.enabled`,G=`${s}.from`,W=`${s}.interval`,Z=`${s}.license`,K=`${s}.note`,J=`${s}.references`,Y=`${s}.rule_id`,X=`${s}.rule_name_override`,ee=`${s}.to`,te=`${s}.type`,ae=`${s}.updated_at`,ne=`${s}.updated_by`,ie=`${s}.version`,re=`${r}.severity`,se=`${r}.suppression`,oe=`${se}.terms`,le=`${oe}.field`,ce=`${oe}.value`,ue=`${se}.start`,de=`${se}.end`,pe=`${se}.docs_count`,me=`${r}.system_status`,fe=`${r}.workflow_reason`,be=`${r}.workflow_user`,ge=`${r}.workflow_status_updated_at`,ye=`${r}.building_block_type`,he=`${r}.evaluation.threshold`,ve=`${r}.evaluation.value`,Ee=`${r}.context`,xe=`${r}.evaluation.values`,je=`${r}.group`,Se=`${je}.field`,Oe=`${je}.value`,ke=`${s}.exceptions_list`,we={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml"},Te=(Object.values(we).map((e=>e)),"recovered"),Ie="untracked";let Ce;!function(e){e.ErrorCount="apm.error_rate",e.TransactionErrorRate="apm.transaction_error_rate",e.TransactionDuration="apm.transaction_duration",e.Anomaly="apm.anomaly"}(Ce||(Ce={}))},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(46);const i=e=>n.union([e,n.null]),r=(e,t="enum")=>new n.Type(t,(t=>Object.values(e).includes(t)),((t,a)=>Object.values(e).includes(t)?n.success(t):n.failure(t,a)),(e=>e)),s=(e,t="Unknown Field in switch statement")=>{throw new Error(`${t}: ${e}`)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return E})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return F})),a.d(t,"a",(function(){return T}));var n=a(23),i=a.n(n),r=a(2),s=a(17);const o=Object(r.createContext)(void 0),l=()=>{const e=Object(r.useContext)(o);if(!e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e};var c=a(13),u=a(9);const d="previewSection";var p=a(5);const m=p.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),f=p.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),b=e=>Object(u.has)(e,"title")||Object(u.has)(e,"backgroundColor")||Object(u.has)(e,"textColor"),g=({component:e,showBackButton:t,leftPosition:a,banner:n})=>{const{euiTheme:i}=Object(s.useEuiTheme)(),{closePreviewPanel:r,previousPreviewPanel:o}=l(),u=a+4,p=Object(c.jsx)(s.EuiFlexItem,{grow:!1},Object(c.jsx)(s.EuiButtonIcon,{iconType:"cross",onClick:()=>r(),"data-test-subj":"previewSectionCloseButton","aria-label":f})),g=t?Object(c.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(c.jsx)(s.EuiFlexItem,{grow:!1},Object(c.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>o(),"data-test-subj":"previewSectionBackButton","aria-label":m},m)),p):Object(c.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},p);return Object(c.jsx)("div",{css:Object(c.css)("position:absolute;top:4px;bottom:12px;right:4px;left:",u,"px;z-index:1000;","")},Object(c.jsx)(s.EuiSplitPanel.Outer,{css:Object(c.css)("margin:",i.size.xs,";box-shadow:0 0 4px 4px ",i.colors.darkShade,";",""),className:"eui-yScroll","data-test-subj":d},b(n)&&Object(c.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:n.backgroundColor,paddingSize:"none","data-test-subj":`${d}BannerPanel`},Object(c.jsx)(s.EuiText,{textAlign:"center",color:n.textColor,size:"s","data-test-subj":`${d}BannerText`},n.title)),Object(c.jsx)(s.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},g),Object(c.jsx)(s.EuiSplitPanel.Inner,{paddingSize:"none"},e)))};g.displayName="PreviewSection";const y=({component:e,width:t})=>{const a=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(c.jsx)(s.EuiFlexItem,{grow:!1,style:a,"data-test-subj":"rightSection"},e)};y.displayName="RightSection";const h=({component:e,width:t})=>{const a=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(c.jsx)(s.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:a},e)};h.displayName="LeftSection";const v={height:"100%"},E=({registeredPanels:e,...t})=>{var a,n;const o=(()=>{const[e,t]=Object(r.useState)(0);return Object(r.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{closeFlyout:u,panels:d}=l(),{left:p,right:m,preview:f}=d,E=Object(r.useMemo)((()=>e.find((e=>e.key===(null==p?void 0:p.id)))),[p,e]),x=Object(r.useMemo)((()=>e.find((e=>e.key===(null==m?void 0:m.id)))),[m,e]),j=f?f[f.length-1]:void 0,S=b(null==j||null===(a=j.params)||void 0===a?void 0:a.banner)?null==j||null===(n=j.params)||void 0===n?void 0:n.banner:void 0,O=!!f&&f.length>1,k=Object(r.useMemo)((()=>e.find((e=>e.key===(null==j?void 0:j.id)))),[j,e]),w=null!=x&&null!=m,T=null!=E&&null!=p,I=null!=k&&null!=f,{rightSectionWidth:C,leftSectionWidth:M,flyoutWidth:_,previewSectionLeft:A}=(({windowWidth:e,showRight:t,showLeft:a,showPreview:n})=>{let i=0;if(t)if(e<992)i=Math.min(380,e);else{const t=(e-992)/928*370;i=Math.min(380+t,750)}let r=0;a&&(r=e<=1600?e-i-48:Math.min(80*(e-i)/100,1500));let s=0;return n&&(s=r),{rightSectionWidth:i,leftSectionWidth:r,flyoutWidth:t&&a?`${i+r}px`:`${i}px`,previewSectionLeft:s}})({windowWidth:o,showRight:w,showLeft:T,showPreview:I});return p||m||null!=f&&f.length?Object(c.jsx)(s.EuiFlyout,i()({},t,{size:_,ownFocus:!1,onClose:u}),Object(c.jsx)(s.EuiFlexGroup,{direction:E?"row":"column",wrap:!1,gutterSize:"none",style:v,responsive:!1},T?Object(c.jsx)(h,{component:E.component({...p}),width:M}):null,w?Object(c.jsx)(y,{component:x.component({...m}),width:C}):null),I?Object(c.jsx)(g,{component:k.component({...j}),showBackButton:O,leftPosition:A,banner:S}):null):null};E.displayName="ExpandableFlyout";var x=a(60),j=a(310);const S={namespaces:{},timeoutHandle:0},O="url:update",k=["popstate",O],w=(e,t)=>{S.namespaces[e]||(S.namespaces[e]={});const[a,n]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{const a=()=>{const a=new URLSearchParams(window.location.search).get(e),i=a?Object(x.decode)(a):{},r=null==i?void 0:i[t];S.namespaces[e][t]=r,n(r)};return a(),k.forEach((e=>window.addEventListener(e,a))),()=>k.forEach((e=>window.removeEventListener(e,a)))}),[t,e]),[a,Object(r.useCallback)((a=>{const n=S.namespaces[e][t],i="object"==typeof a&&"object"==typeof n&&!Array.isArray(a)&&!Array.isArray(n);S.namespaces[e][t]=i?{...n,...a}:a,S.timeoutHandle&&window.clearTimeout(S.timeoutHandle),S.timeoutHandle=window.setTimeout((()=>{const e=Object(j.parse)(location.search);for(const t in S.namespaces)Object.prototype.hasOwnProperty.call(S.namespaces,t)&&(e[t]=encodeURIComponent(Object(x.encode)(S.namespaces[t])));const t=Object(j.stringify)(e,{encode:!1});if(window.location.search===t)return;const a=`${window.location.hash}?${t}`;window.history.pushState({},"",a),window.dispatchEvent(new Event(O))}),0)}),[t,e])]},T="eventFlyout",I=({children:e})=>{const{setRightPanelState:t,rightPanelState:a}=(()=>{const[e,t]=w(T,"rightPanel");return{rightPanelState:e,setRightPanelState:t}})(),{setLeftPanelState:n,leftPanelState:i}=(()=>{const[e,t]=w(T,"leftPanel");return{leftPanelState:e,setLeftPanelState:t}})(),{previewState:s,setPreviewState:l}=(()=>{const[e,t]=w(T,"preview");return{previewState:e,setPreviewState:t}})(),u=Object(r.useMemo)((()=>({left:i,right:a,preview:s||[]})),[i,s,a]),d=Object(r.useCallback)((({right:e,left:a,preview:i})=>{t(e),n(a),l(i?[i]:[])}),[t,n,l]),p=Object(r.useCallback)((e=>{t(e)}),[t]),m=Object(r.useCallback)((e=>n(e)),[n]),f=Object(r.useCallback)((e=>l([...null!=s?s:[],e])),[s,l]),b=Object(r.useCallback)((()=>t(void 0)),[t]),g=Object(r.useCallback)((()=>n(void 0)),[n]),y=Object(r.useCallback)((()=>l([])),[l]),h=Object(r.useCallback)((()=>l(null==s?void 0:s.slice(0,s.length-1))),[s,l]),v=Object(r.useCallback)((()=>{t(void 0),n(void 0),l([])}),[t,n,l]),E=Object(r.useMemo)((()=>({panels:u,openFlyout:d,openRightPanel:p,openLeftPanel:m,openPreviewPanel:f,closeRightPanel:b,closeLeftPanel:g,closePreviewPanel:y,closeFlyout:v,previousPreviewPanel:h})),[u,d,p,m,f,b,g,y,v,h]);return Object(c.jsx)(o.Provider,{value:E},e)};let C;!function(e){e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout"}(C||(C={}));const M={left:void 0,right:void 0,preview:[]};function _(e,t){switch(t.type){case C.openFlyout:{const{left:e,right:a,preview:n}=t.payload;return{left:e,right:a,preview:n?[n]:[]}}case C.openRightPanel:return{...e,right:t.payload};case C.openLeftPanel:return{...e,left:t.payload};case C.openPreviewPanel:return{...e,preview:[...e.preview,t.payload]};case C.closeRightPanel:return{...e,right:void 0};case C.closeLeftPanel:return{...e,left:void 0};case C.closePreviewPanel:return{...e,preview:[]};case C.previousPreviewPanel:{const t=[...e.preview];return t.pop(),{...e,preview:t}}case C.closeFlyout:return{left:void 0,right:void 0,preview:[]};default:return e}}const A=({children:e})=>{const[t,a]=Object(r.useReducer)(_,M),n=Object(r.useCallback)((({right:e,left:t,preview:n})=>a({type:C.openFlyout,payload:{left:t,right:e,preview:n}})),[a]),i=Object(r.useCallback)((e=>a({type:C.openRightPanel,payload:e})),[]),s=Object(r.useCallback)((e=>a({type:C.openLeftPanel,payload:e})),[]),l=Object(r.useCallback)((e=>a({type:C.openPreviewPanel,payload:e})),[]),u=Object(r.useCallback)((()=>a({type:C.closeRightPanel})),[]),d=Object(r.useCallback)((()=>a({type:C.closeLeftPanel})),[]),p=Object(r.useCallback)((()=>a({type:C.closePreviewPanel})),[]),m=Object(r.useCallback)((()=>a({type:C.previousPreviewPanel})),[]),f=Object(r.useCallback)((()=>{a({type:C.closeFlyout})}),[]),b=Object(r.useMemo)((()=>({panels:t,openFlyout:n,openRightPanel:i,openLeftPanel:s,openPreviewPanel:l,closeRightPanel:u,closeLeftPanel:d,closePreviewPanel:p,closeFlyout:f,previousPreviewPanel:m})),[t,n,i,s,l,u,d,p,f,m]);return Object(c.jsx)(o.Provider,{value:b},e)},F=({children:e,storage:t="url"})=>"memory"===t?Object(c.jsx)(A,null,e):Object(c.jsx)(I,null,e)},function(e,t,a){"use strict";a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"h",(function(){return g})),a.d(t,"l",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"e",(function(){return E})),a.d(t,"i",(function(){return x})),a.d(t,"j",(function(){return j})),a.d(t,"m",(function(){return S})),a.d(t,"k",(function(){return C}));var n=a(45),i=a(66),r=a(425),s=a(143),o=a(172),l=a(153),c=a(243);const u=(e,t)=>e.reduce(((e,a)=>{const n=[a,...a.and].filter((e=>e.enabled));if(!n.length)return e;const i=n.map((e=>((e,t)=>{const{excluded:a,type:n,queryMatch:{field:i,operator:r,value:c}}=e,u=Object(o.c)(i,t),d=a?"NOT ":"";switch(r){case l.d:return O({browserFields:t,field:i,isExcluded:d,isFieldTypeNested:u,type:n,value:c});case l.b:return`${d}${T({browserFields:t,field:i,isFieldTypeNested:u})}`;case l.c:return k({field:i,isExcluded:d,value:c});default:Object(s.a)(r)}})(e,t))),r=i.join(" and ");return[...e,r]}),[]).filter((e=>!Object(n.isEmpty)(e))).reduce(((e,t,a,n)=>n.length<=1?t:a?`${e} or (${t})`:`(${t})`),""),d="event-column-view",p=({globalFullScreen:e,graphEventId:t})=>!e||!(e=>null!=e&&""!==e)(t),m="1",f=2,b="local-events-count-button",g=({itemsCount:e,itemsPerPage:t})=>0===e||0===t?0:Math.ceil(e/t),y=e=>Object(i.elementOrChildrenHasFocus)(null==e?void 0:e.querySelector(`.${c.a}`)),h=({containerElement:e,keyboardEvent:t,onSkipFocusBeforeEventsTable:a,onSkipFocusAfterEventsTable:n})=>{const{shiftKey:r}=t,s=Object(i.getTableSkipFocus)({containerElement:e,getFocusedCell:i.getFocusedAriaColindexCell,shiftKey:r,tableHasFocus:y,tableClassName:c.a});"SKIP_FOCUS_NOOP"!==s&&(Object(i.stopPropagationAndPreventDefault)(t),Object(i.handleSkipFocus)({onSkipFocusBackwards:a,onSkipFocusForward:n,skipFocus:s}))},v="active-timeline-button",E="timeline-flyout-button-bar",x=()=>{setTimeout((()=>{var e;null===(e=document.querySelector(`div.${E} .${v}`))||void 0===e||e.focus()}),0)},j=e=>{var t;null==e||null===(t=e.querySelector("div.siemUtilityBar__action:last-of-type button"))||void 0===t||t.focus()},S=()=>{var e;null===(e=document.querySelector("header.headerGlobalNav a.chrHeaderLogo"))||void 0===e||e.focus()},O=({browserFields:e,field:t,isExcluded:a,isFieldTypeNested:n,type:i,value:r})=>C(r)?`${a}${t} : ${JSON.stringify(r)}`:`${a}${i!==l.a.template?w({browserFields:e,field:t,isFieldTypeNested:n,value:r}):T({browserFields:e,field:t,isFieldTypeNested:n})}`,k=({field:e,isExcluded:t,value:a})=>C(a)?`${t}${I({field:e,value:a})}`:`${t}${e} : ${JSON.stringify(a)}`,w=({browserFields:e,field:t,isFieldTypeNested:a,value:n})=>a?Object(o.h)(t,n,e):Object(o.b)(t,e)?Object(o.e)(t,n):`${t} : ${Object(r.a)(n)}`,T=({browserFields:e,field:t,isFieldTypeNested:a})=>a?Object(o.g)(t,e).trim():`${t} ${l.b}`.trim(),I=({field:e,value:t})=>{const a=e.trim();return t.length?`${a} : (${t.map((e=>Object(n.isNumber)(e)?e:Object(r.b)(String(e).trim()))).join(" OR ")})`:`${a} : ''`},C=e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"number"==typeof e)))},function(e,t,a){"use strict";var n=a(52);a.d(t,"j",(function(){return n.getUseField})),a.d(t,"i",(function(){return n.getFieldValidityAndErrorMessage})),a.d(t,"a",(function(){return n.FIELD_TYPES})),a.d(t,"c",(function(){return n.Form})),a.d(t,"e",(function(){return n.UseField})),a.d(t,"f",(function(){return n.UseMultiFields})),a.d(t,"k",(function(){return n.useForm})),a.d(t,"l",(function(){return n.useFormContext})),a.d(t,"m",(function(){return n.useFormData})),a.d(t,"g",(function(){return n.VALIDATION_TYPES}));var i=a(71);a.d(t,"b",(function(){return i.Field})),a.d(t,"d",(function(){return i.SelectField}));var r=a(81);a.d(t,"h",(function(){return r.fieldValidators}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(45),i=a(2),r=a(48),s=a(119),o=a(112),l=a(128),c=a(181);const u=()=>{const e=Object(r.useDispatch)(),{from:t,to:a}=Object(o.a)((e=>Object(n.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[u,d]=Object(i.useState)(!0),p=Object(i.useRef)([]),m=Object(i.useCallback)((({id:t,inspect:a,loading:n,refetch:i,searchSessionId:r})=>{p.current=[...p.current,t],e(c.c.setQuery({inputId:s.a.global,id:t,inspect:a,loading:n,refetch:i,searchSessionId:r}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(c.c.deleteOneQuery({inputId:s.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{p.current.length>0&&p.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:u,from:t,to:a,setQuery:m,deleteQuery:f})),[f,t,u,m,a])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return v})),a.d(t,"g",(function(){return E})),a.d(t,"h",(function(){return Ge})),a.d(t,"c",(function(){return We})),a.d(t,"f",(function(){return Ze})),a.d(t,"d",(function(){return Ke})),a.d(t,"e",(function(){return Je}));var n=a(111),i=a(141),r=a(363),s=a(365),o=a(362),l=a(323),c=a(366),u=a(367),d=a(368),p=a(369);const m=n.z.object({name:i.I,description:i.z,risk_score:i.p,severity:i.V}),f=n.z.object({rule_name_override:i.J.optional(),timestamp_override:i.ab.optional(),timestamp_override_fallback_disabled:i.bb.optional(),timeline_id:i.Y.optional(),timeline_title:i.Z.optional(),outcome:i.S.optional(),alias_target_id:i.R.optional(),alias_purpose:i.Q.optional(),license:i.G.optional(),note:i.h.optional(),building_block_type:i.d.optional(),output_index:i.b.optional(),namespace:i.c.optional(),meta:i.H.optional(),investigation_fields:i.g.optional(),throttle:i.x.optional()}),b=n.z.object({version:i.P.optional(),tags:i.O.optional(),enabled:i.i.optional(),risk_score_mapping:i.q.optional(),severity_mapping:i.W.optional(),interval:i.D.optional(),from:i.E.optional(),to:i.F.optional(),actions:n.z.array(i.r).optional(),exceptions_list:n.z.array(i.A).optional(),author:i.y.optional(),false_positives:i.B.optional(),references:i.M.optional(),max_signals:i.l.optional(),threat:i.X.optional()}),g=m.merge(f).merge(b),y=m.partial().merge(f).merge(b),h=m.merge(f).merge(b.required()),v=n.z.object({id:i.K,rule_id:i.N,immutable:i.j,updated_at:n.z.string().datetime(),updated_by:n.z.string(),created_at:n.z.string().datetime(),created_by:n.z.string(),revision:n.z.number().int().min(0),related_integrations:i.n,required_fields:i.o,setup:i.U,execution_summary:r.a.optional()}),E=g.merge(n.z.object({rule_id:i.N.optional()})),x=g.merge(n.z.object({id:i.K.optional(),rule_id:i.N.optional()})),j=y.merge(n.z.object({id:i.K.optional(),rule_id:i.N.optional()})),S=h.merge(v),O=n.z.literal("eql"),k=n.z.object({type:n.z.literal("eql"),query:i.L,language:O}),w=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),event_category_override:s.a.optional(),tiebreaker_field:s.b.optional(),timestamp_field:s.c.optional()}),T=k.merge(w),I=k.merge(w),C=k.partial().merge(w),M=S.merge(I),_=E.merge(T),A=x.merge(T),F=j.merge(C),P=n.z.object({type:n.z.literal("query")}),D=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),response_actions:n.z.array(o.a).optional(),alert_suppression:l.a.optional()}),N=n.z.object({query:i.L.optional(),language:i.k.optional()}),R=P.merge(D).merge(N),L=P.partial().merge(D).merge(N),B=P.merge(D).merge(N.required()),z=S.merge(B),q=E.merge(R),$=x.merge(R),V=j.merge(L),U=n.z.object({type:n.z.literal("saved_query"),saved_id:i.T}),H=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),response_actions:n.z.array(o.a).optional(),alert_suppression:l.a.optional(),query:i.L.optional()}),Q=n.z.object({language:i.k.optional()}),G=U.merge(H).merge(Q),W=U.partial().merge(H).merge(Q),Z=U.merge(H).merge(Q.required()),K=S.merge(Z),J=E.merge(G),Y=x.merge(G),X=j.merge(W),ee=n.z.object({type:n.z.literal("threshold"),query:i.L,threshold:c.a}),te=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),alert_suppression:c.b.optional()}),ae=n.z.object({language:i.k.optional()}),ne=ee.merge(te).merge(ae),ie=ee.partial().merge(te).merge(ae),re=ee.merge(te).merge(ae.required()),se=S.merge(re),oe=E.merge(ne),le=x.merge(ne),ce=j.merge(ie),ue=n.z.object({type:n.z.literal("threat_match"),query:i.L,threat_query:u.g,threat_mapping:u.f,threat_index:u.d}),de=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),threat_filters:u.c.optional(),threat_indicator_path:u.e.optional(),threat_language:i.k.optional(),concurrent_searches:u.a.optional(),items_per_search:u.b.optional()}),pe=n.z.object({language:i.k.optional()}),me=ue.merge(de).merge(pe),fe=ue.partial().merge(de).merge(pe),be=ue.merge(de).merge(pe.required()),ge=S.merge(be),ye=E.merge(me),he=x.merge(me),ve=j.merge(fe),Ee=n.z.object({type:n.z.literal("machine_learning"),anomaly_threshold:d.a,machine_learning_job_id:d.b}),xe=Ee.partial(),je=Ee,Se=Ee,Oe=S.merge(je),ke=E.merge(Se),we=x.merge(Se),Te=j.merge(xe),Ie=n.z.object({type:n.z.literal("new_terms"),query:i.L,new_terms_fields:p.b,history_window_start:p.a}),Ce=n.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional()}),Me=n.z.object({language:i.k.optional()}),_e=Ie.partial().merge(Ce).merge(Me),Ae=Ie.merge(Ce).merge(Me.required()),Fe=Ie.merge(Ce).merge(Me),Pe=S.merge(Ae),De=E.merge(Fe),Ne=x.merge(Fe),Re=j.merge(_e),Le=n.z.literal("esql"),Be=n.z.object({type:n.z.literal("esql"),language:Le,query:i.L}),ze=Be.partial(),qe=Be,$e=Be,Ve=S.merge(qe),Ue=E.merge($e),He=x.merge($e),Qe=j.merge(ze.partial()),Ge=n.z.discriminatedUnion("type",[T,R,G,ne,me,Se,Fe,$e]),We=(n.z.union([C,L,W,ie,fe,xe,_e,ze]),n.z.discriminatedUnion("type",[I,B,Z,re,be,je,Ae,qe]),n.z.discriminatedUnion("type",[_,q,J,oe,ye,ke,De,Ue])),Ze=n.z.discriminatedUnion("type",[A,$,Y,le,he,we,Ne,He]),Ke=n.z.union([F,V,X,ce,ve,Te,Re,Qe]),Je=n.z.discriminatedUnion("type",[M,z,K,se,ge,Oe,Pe,Ve])},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return g}));var n={};a.r(n),a.d(n,"setDataView",(function(){return s})),a.d(n,"setDataViewLoading",(function(){return o})),a.d(n,"setSignalIndexName",(function(){return l})),a.d(n,"setSourcererDataViews",(function(){return c})),a.d(n,"setSourcererScopeLoading",(function(){return u})),a.d(n,"setSelectedDataView",(function(){return d}));var i=a(26);const r=a.n(i)()("x-pack/security_solution/local/sourcerer"),s=r("SET_DATA_VIEW"),o=r("SET_DATA_VIEW_LOADING"),l=r("SET_SIGNAL_INDEX_NAME"),c=r("SET_SOURCERER_DATA_VIEWS"),u=r("SET_SOURCERER_SCOPE_LOADING"),d=r("SET_SELECTED_DATA_VIEW");var p=a(116),m=a(578),f=a(187),b=a(392);const g=Object(f.reducerWithInitialState)(p.initialSourcererState).case(l,((e,{signalIndexName:t})=>({...e,signalIndexName:t}))).case(o,((e,{id:t,loading:a})=>({...e,...t===e.defaultDataView.id?{defaultDataView:{...e.defaultDataView,loading:a}}:{},kibanaDataViews:e.kibanaDataViews.map((e=>e.id===t?{...e,loading:a}:e))}))).case(c,((e,{defaultDataView:t,kibanaDataViews:a})=>({...e,defaultDataView:{...e.defaultDataView,...t},kibanaDataViews:a.map((t=>{var a;return{...null!==(a=e.kibanaDataViews.find((({id:e})=>e===t.id)))&&void 0!==a?a:p.initDataView,...t}}))}))).case(u,((e,{id:t,loading:a})=>({...e,sourcererScopes:{...e.sourcererScopes,...null!=t?{[t]:{...e.sourcererScopes[t],loading:a}}:{[p.SourcererScopeName.default]:{...e.sourcererScopes[p.SourcererScopeName.default],loading:a},[p.SourcererScopeName.detections]:{...e.sourcererScopes[p.SourcererScopeName.detections],loading:a},[p.SourcererScopeName.timeline]:{...e.sourcererScopes[p.SourcererScopeName.timeline],loading:a}}}}))).case(d,((e,t)=>{const{shouldValidateSelectedPatterns:a=!0,...n}=t;return{...e,sourcererScopes:{...e.sourcererScopes,...Object(b.c)(e,n,a)}}})).case(s,((e,t)=>({...e,...t.id===e.defaultDataView.id?{defaultDataView:{...e.defaultDataView,...t}}:{},kibanaDataViews:e.kibanaDataViews.map((e=>e.id===t.id?{...e,...t}:e))}))).build()},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(111);let i,r,s,o,l,c,u;!function(e){e.details="hostDetails",e.hosts="hosts",e.overview="overviewHost",e.uncommonProcesses="uncommonProcesses"}(i||(i={})),function(e){e.dns="networkKpiDns",e.networkEvents="networkKpiNetworkEvents",e.tlsHandshakes="networkKpiTlsHandshakes",e.uniqueFlows="networkKpiUniqueFlows",e.uniquePrivateIps="networkKpiUniquePrivateIps"}(r||(r={})),function(e){e.kpiHosts="hostsKpiHosts",e.kpiUniqueIps="hostsKpiUniqueIps"}(s||(s={})),function(e){e.observedDetails="observedUserDetails",e.managedDetails="managedUserDetails",e.kpiTotalUsers="usersKpiTotalUsers",e.users="allUsers",e.authentications="authentications",e.kpiAuthentications="usersKpiAuthentications"}(o||(o={})),function(e){e.details="networkDetails",e.dns="dns",e.http="http",e.overview="overviewNetwork",e.tls="tls",e.topCountries="topCountries",e.topNFlow="topNFlow",e.users="users"}(l||(l={})),function(e){e.hostsRiskScore="hostsRiskScore",e.usersRiskScore="usersRiskScore",e.kpiRiskScore="kpiRiskScore"}(c||(c={})),function(e){e.eventEnrichment="eventEnrichment",e.dataSource="dataSource"}(u||(u={}));const d="matrixHistogram",p="firstlastseen";let m;!function(e){e.relatedHosts="relatedHosts",e.relatedUsers="relatedUsers"}(m||(m={}));const f=n.z.object({match:n.z.record(n.z.string(),n.z.object({query:n.z.string(),operator:n.z.string(),zero_terms_query:n.z.string()}))}),b=n.z.object({query_string:n.z.object({query:n.z.string(),analyze_wildcard:n.z.boolean()})}),g=n.z.object({term:n.z.record(n.z.string(),n.z.string())}),y=n.z.object({bool:n.z.object({filter:n.z.array(n.z.object({})),must:n.z.array(n.z.object({})),must_not:n.z.array(n.z.object({})),should:n.z.array(n.z.object({}))})}),h=n.z.object({range:n.z.record(n.z.string(),n.z.object({gte:n.z.number(),lte:n.z.number(),format:n.z.string()}))}),v=n.z.record(n.z.string(),n.z.any()),E=(n.z.union([h,b,f,g,y,v]),n.z.union([n.z.string(),n.z.any()]).optional()),x=n.z.object({interval:n.z.string(),from:n.z.string(),to:n.z.string()}),j=n.z.object({timerange:x.optional(),filterQuery:E,defaultIndex:n.z.array(n.z.string()).optional(),id:n.z.string().optional(),params:n.z.any().optional()}),S=j.extend({eventFields:n.z.record(n.z.unknown()),timerange:x,factoryQueryType:n.z.literal(u.eventEnrichment)}),O=j.extend({factoryQueryType:n.z.literal(u.dataSource)});var k=a(636);const w=n.z.union([n.z.object({dsl:n.z.array(n.z.string())}).nullable(),n.z.boolean()]).optional(),T=j.extend({order:k.b,field:n.z.string(),value:n.z.string(),factoryQueryType:n.z.literal(p)}),I=(n.z.object({firstSeen:n.z.string().nullable(),lastSeen:n.z.string().nullable(),inspect:w}).partial(),n.z.object({activePage:n.z.number(),cursorStart:n.z.number(),fakePossibleCount:n.z.number(),querySize:n.z.number()}).default({activePage:0,cursorStart:0,fakePossibleCount:0,querySize:0}));var C=a(227);const M=j.extend({sort:C.b,pagination:I,timerange:x,isNewRiskScoreModuleInstalled:n.z.boolean().default(!1),factoryQueryType:n.z.literal(i.hosts)}),_=j.extend({hostName:n.z.string(),skip:n.z.boolean().optional(),inspect:w,pagination:I.optional(),timerange:x,sort:C.b,factoryQueryType:n.z.literal(i.details)}),A=j.extend({factoryQueryType:n.z.literal(i.overview),timerange:x});var F=a(188);const P=j.extend({sort:F.a,pagination:I,timerange:x,factoryQueryType:n.z.literal(i.uncommonProcesses)}),D=j.extend({sort:C.b,pagination:I,timerange:x,factoryQueryType:n.z.literal(s.kpiHosts)}),N=j.extend({sort:C.b,pagination:I,timerange:x,factoryQueryType:n.z.literal(s.kpiUniqueIps)}),R=n.z.record(n.z.object({type:n.z.union([n.z.literal("boolean"),n.z.literal("date"),n.z.literal("double"),n.z.literal("geo_point"),n.z.literal("ip"),n.z.literal("keyword"),n.z.literal("long"),n.z.literal("lookup")]),script:n.z.union([n.z.string(),n.z.object({source:n.z.string()}),n.z.object({id:n.z.string(),params:n.z.record(n.z.any())})]).optional(),fetch_fields:n.z.array(n.z.string()).optional(),format:n.z.string().optional(),input_field:n.z.string().optional(),target_field:n.z.string().optional(),target_index:n.z.string().optional()})).optional();let L;!function(e){e.authentications="authentications",e.anomalies="anomalies",e.events="events",e.alerts="alerts",e.dns="dns",e.preview="preview"}(L||(L={}));const B=j.extend({histogramType:n.z.enum([L.alerts,L.anomalies,L.authentications,L.dns,L.events,L.preview]),stackByField:n.z.string().optional(),threshold:n.z.object({field:n.z.array(n.z.string()),value:n.z.string(),cardinality:n.z.object({field:n.z.array(n.z.string()),value:n.z.string()}).optional()}).optional(),inspect:w,isPtrIncluded:n.z.boolean().default(!1),includeMissingData:n.z.boolean().default(!0),runtimeMappings:R,timerange:x,factoryQueryType:n.z.literal(d)}),z=j.extend({ip:n.z.string().ip(),factoryQueryType:n.z.literal(l.details)}),q=j.extend({pagination:I,sort:C.b});let $;!function(e){e.dnsName="dnsName",e.queryCount="queryCount",e.uniqueDomains="uniqueDomains",e.dnsBytesIn="dnsBytesIn",e.dnsBytesOut="dnsBytesOut"}($||($={}));const V=q.extend({isPtrIncluded:n.z.boolean().default(!1),stackByField:n.z.string().optional(),sort:F.a,timerange:x,factoryQueryType:n.z.literal(l.dns)}),U=q.extend({ip:n.z.string().ip().optional(),defaultIndex:n.z.array(n.z.string()).min(1).optional(),timerange:x,sort:F.a,factoryQueryType:n.z.literal(l.http)}),H=j.extend({timerange:x,factoryQueryType:n.z.literal(r.dns)}),Q=j.extend({timerange:x,factoryQueryType:n.z.literal(r.networkEvents)}),G=j.extend({timerange:x,factoryQueryType:n.z.literal(r.tlsHandshakes)}),W=j.extend({timerange:x,factoryQueryType:n.z.literal(r.uniqueFlows)}),Z=j.extend({timerange:x,factoryQueryType:n.z.literal(r.uniquePrivateIps)}),K=j.extend({timerange:x,factoryQueryType:n.z.literal(l.overview)});let J;!function(e){e.destination="destination",e.source="source"}(J||(J={}));const Y=n.z.enum([J.destination,J.source]);let X;!function(e){e._id="_id"}(X||(X={}));const ee=q.extend({ip:n.z.string().optional(),flowTarget:Y,sort:F.a,timerange:x,factoryQueryType:n.z.literal(l.tls)}),te=q.extend({ip:n.z.string().ip().optional(),flowTarget:Y,sort:F.a,filterQuery:E,timerange:x,factoryQueryType:n.z.literal(l.topCountries)}),ae=q.extend({ip:n.z.string().ip().nullable().optional(),flowTarget:Y,sort:F.a,timerange:x,factoryQueryType:n.z.literal(l.topNFlow)});let ne;!function(e){e.name="name",e.count="count"}(ne||(ne={}));const ie=q.extend({ip:n.z.string().ip(),flowTarget:Y,sort:F.a,timerange:x,factoryQueryType:n.z.literal(l.users)}),re=j.extend({userName:n.z.string(),skip:n.z.boolean().optional(),from:n.z.string(),inspect:w,isNewRiskScoreModuleInstalled:n.z.boolean().default(!1),factoryQueryType:n.z.literal(m.relatedHosts)}),se=j.extend({hostName:n.z.string(),skip:n.z.boolean().optional(),from:n.z.string(),inspect:w,isNewRiskScoreModuleInstalled:n.z.boolean().default(!1),factoryQueryType:n.z.literal(m.relatedUsers)});let oe;!function(e){e.host="host",e.user="user"}(oe||(oe={}));const le=n.z.enum([oe.host,oe.user]);let ce;!function(e){e.timestamp="@timestamp",e.hostName="host.name",e.hostRiskScore="host.risk.calculated_score_norm",e.hostRisk="host.risk.calculated_level",e.userName="user.name",e.userRiskScore="user.risk.calculated_score_norm",e.userRisk="user.risk.calculated_level",e.alertsCount="alertsCount"}(ce||(ce={}));const ue=j.extend({alertsTimerange:x.optional(),riskScoreEntity:le,includeAlertsCount:n.z.boolean().optional(),onlyLatest:n.z.boolean().optional(),pagination:n.z.object({cursorStart:n.z.number(),querySize:n.z.number()}).optional(),sort:F.a.removeDefault().extend({field:n.z.enum([ce.timestamp,ce.hostName,ce.hostRiskScore,ce.hostRisk,ce.userName,ce.userRiskScore,ce.userRisk,ce.alertsCount])}).optional()}),de=ue.extend({factoryQueryType:n.z.literal(c.hostsRiskScore)}),pe=ue.extend({factoryQueryType:n.z.literal(c.usersRiskScore)}),me=(n.z.union([de,pe]),j.extend({entity:le,factoryQueryType:n.z.literal(c.kpiRiskScore)})),fe=j.extend({userName:n.z.string(),skip:n.z.boolean().optional(),timerange:x,inspect:w,factoryQueryType:n.z.literal(o.observedDetails)}),be=j.extend({userName:n.z.string(),userEmail:n.z.array(n.z.string()).optional(),factoryQueryType:n.z.literal(o.managedDetails)}),ge=j.extend({timerange:x,factoryQueryType:n.z.literal(o.kpiTotalUsers)}),ye=j.extend({timerange:x,factoryQueryType:n.z.literal(o.kpiAuthentications)});let he;!function(e){e.name="name",e.domain="domain",e.lastSeen="lastSeen"}(he||(he={}));const ve=q.extend({sort:F.a.removeDefault().extend({field:n.z.enum([he.name,he.lastSeen])}),timerange:x,isNewRiskScoreModuleInstalled:n.z.boolean().default(!1),factoryQueryType:n.z.literal(o.users)});let Ee;!function(e){e.userName="user.name",e.hostName="host.name"}(Ee||(Ee={}));const xe=q.extend({stackByField:n.z.enum([Ee.userName,Ee.hostName]),timerange:x,factoryQueryType:n.z.literal(o.authentications)});n.z.discriminatedUnion("factoryQueryType",[T,M,_,D,N,A,P,ve,fe,be,ge,ye,xe,de,pe,me,re,se,z,V,U,K,ee,te,ae,ie,H,Q,G,W,Z,B,O,S])},function(e,t,a){"use strict";a.d(t,"e",(function(){return n.b})),a.d(t,"a",(function(){return n.a})),a.d(t,"g",(function(){return n.d})),a.d(t,"f",(function(){return n.c})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(122);const i="open",r="closed",s="acknowledged"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l}));var n=a(2);const i=()=>{const e=Object(n.useRef)(!1),t=Object(n.useCallback)((()=>e.current),[]),a=Object(n.useCallback)((()=>{e.current=!1}),[]);return Object(n.useEffect)((()=>(e.current=!0,a)),[a]),t},r=e=>{const t=i(),[a,r]=Object(n.useState)(!1),[s,o]=Object(n.useState)(),[l,c]=Object(n.useState)();return{error:s,loading:a,result:l,start:Object(n.useCallback)(((...a)=>{r(!0),c(void 0),o(void 0),e(...a).then((e=>t()&&c(e))).catch((e=>t()&&o(e))).finally((()=>t()&&r(!1)))}),[e,t])}};function s(e,t){switch(t.type){case"setResult":return{...e,result:t.result,loading:!1};case"setError":return{...e,error:t.error,loading:!1};case"load":return{loading:!0,result:void 0,error:void 0}}}const o=e=>{const t=i(),a=Object(n.useRef)(),[r,o]=Object(n.useReducer)(s,{loading:!1,error:void 0,result:void 0}),l=Object(n.useCallback)(((...n)=>{a.current&&a.current.unsubscribe(),o({type:"load"}),a.current=e(...n).subscribe((e=>{t()&&o({type:"setResult",result:e})}),(e=>{t()&&o({type:"setError",error:e})}))}),[e,t]);return Object(n.useEffect)((()=>()=>{a.current&&a.current.unsubscribe()}),[]),{result:r.result,error:r.error,loading:r.loading,start:l}},l=e=>t=>{const a=null!=t.signal?t.signal:(new AbortController).signal;return e({...t,signal:a})}},function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s}));const n=":",i=":*",r="includes";let s;!function(e){e.default="default",e.template="template"}(s||(s={}))},function(e,t,a){"use strict";a.d(t,"cc",(function(){return i})),a.d(t,"Lb",(function(){return r})),a.d(t,"Nb",(function(){return s})),a.d(t,"ad",(function(){return o})),a.d(t,"Zc",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"bc",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"Bb",(function(){return p})),a.d(t,"dc",(function(){return m})),a.d(t,"f",(function(){return f})),a.d(t,"r",(function(){return b})),a.d(t,"p",(function(){return g})),a.d(t,"s",(function(){return y})),a.d(t,"q",(function(){return h})),a.d(t,"m",(function(){return v})),a.d(t,"t",(function(){return E})),a.d(t,"w",(function(){return x})),a.d(t,"g",(function(){return j})),a.d(t,"n",(function(){return S})),a.d(t,"i",(function(){return O})),a.d(t,"o",(function(){return k})),a.d(t,"j",(function(){return w})),a.d(t,"h",(function(){return T})),a.d(t,"v",(function(){return I})),a.d(t,"u",(function(){return C})),a.d(t,"W",(function(){return M})),a.d(t,"U",(function(){return _})),a.d(t,"V",(function(){return A})),a.d(t,"Y",(function(){return F})),a.d(t,"A",(function(){return P})),a.d(t,"l",(function(){return D})),a.d(t,"y",(function(){return N})),a.d(t,"k",(function(){return R})),a.d(t,"z",(function(){return L})),a.d(t,"X",(function(){return B})),a.d(t,"S",(function(){return z})),a.d(t,"K",(function(){return q})),a.d(t,"B",(function(){return $})),a.d(t,"M",(function(){return V})),a.d(t,"C",(function(){return U})),a.d(t,"E",(function(){return H})),a.d(t,"F",(function(){return Q})),a.d(t,"D",(function(){return G})),a.d(t,"L",(function(){return W})),a.d(t,"N",(function(){return Z})),a.d(t,"O",(function(){return K})),a.d(t,"G",(function(){return J})),a.d(t,"P",(function(){return Y})),a.d(t,"H",(function(){return X})),a.d(t,"T",(function(){return ee})),a.d(t,"J",(function(){return te})),a.d(t,"I",(function(){return ae})),a.d(t,"Q",(function(){return ne})),a.d(t,"R",(function(){return ie})),a.d(t,"Gb",(function(){return re})),a.d(t,"Pc",(function(){return se})),a.d(t,"Oc",(function(){return oe})),a.d(t,"Uc",(function(){return le})),a.d(t,"Sc",(function(){return ce})),a.d(t,"ab",(function(){return ue})),a.d(t,"Rc",(function(){return de})),a.d(t,"Cb",(function(){return pe})),a.d(t,"Qb",(function(){return me})),a.d(t,"Rb",(function(){return fe})),a.d(t,"Ab",(function(){return be})),a.d(t,"Hb",(function(){return ge})),a.d(t,"xb",(function(){return ye})),a.d(t,"mb",(function(){return he})),a.d(t,"lb",(function(){return ve})),a.d(t,"nb",(function(){return Ee})),a.d(t,"gb",(function(){return xe})),a.d(t,"ib",(function(){return je})),a.d(t,"hb",(function(){return Se})),a.d(t,"pb",(function(){return Oe})),a.d(t,"bb",(function(){return ke})),a.d(t,"ob",(function(){return we})),a.d(t,"eb",(function(){return Te})),a.d(t,"fb",(function(){return Ie})),a.d(t,"jb",(function(){return Ce})),a.d(t,"kb",(function(){return Me})),a.d(t,"cb",(function(){return _e})),a.d(t,"db",(function(){return Ae})),a.d(t,"Eb",(function(){return Fe})),a.d(t,"zb",(function(){return Pe})),a.d(t,"rb",(function(){return De})),a.d(t,"Db",(function(){return Ne})),a.d(t,"Xc",(function(){return Re})),a.d(t,"Qc",(function(){return Le})),a.d(t,"Fc",(function(){return Be})),a.d(t,"Yb",(function(){return ze})),a.d(t,"Hc",(function(){return qe})),a.d(t,"Sb",(function(){return $e})),a.d(t,"Xb",(function(){return Ve})),a.d(t,"Tb",(function(){return Ue})),a.d(t,"Ub",(function(){return He})),a.d(t,"Vb",(function(){return Qe})),a.d(t,"Wb",(function(){return Ge})),a.d(t,"sb",(function(){return We})),a.d(t,"b",(function(){return Ze})),a.d(t,"Nc",(function(){return Ke})),a.d(t,"Gc",(function(){return Je})),a.d(t,"tb",(function(){return Ye})),a.d(t,"a",(function(){return Xe})),a.d(t,"Mc",(function(){return et})),a.d(t,"c",(function(){return tt})),a.d(t,"Zb",(function(){return at})),a.d(t,"qb",(function(){return nt})),a.d(t,"ub",(function(){return it})),a.d(t,"Mb",(function(){return rt})),a.d(t,"Tc",(function(){return st})),a.d(t,"Ob",(function(){return ot})),a.d(t,"ac",(function(){return lt})),a.d(t,"Wc",(function(){return ct})),a.d(t,"Jb",(function(){return ut})),a.d(t,"Kb",(function(){return dt})),a.d(t,"x",(function(){return pt})),a.d(t,"Vc",(function(){return mt})),a.d(t,"wb",(function(){return ft})),a.d(t,"vb",(function(){return bt})),a.d(t,"ec",(function(){return gt})),a.d(t,"Z",(function(){return yt})),a.d(t,"Dc",(function(){return ht})),a.d(t,"Ec",(function(){return vt})),a.d(t,"Cc",(function(){return Et})),a.d(t,"Ac",(function(){return xt})),a.d(t,"Bc",(function(){return jt})),a.d(t,"pc",(function(){return St})),a.d(t,"qc",(function(){return Ot})),a.d(t,"nc",(function(){return kt})),a.d(t,"oc",(function(){return wt})),a.d(t,"hc",(function(){return Tt})),a.d(t,"ic",(function(){return It})),a.d(t,"fc",(function(){return Ct})),a.d(t,"gc",(function(){return Mt})),a.d(t,"yc",(function(){return _t})),a.d(t,"zc",(function(){return At})),a.d(t,"wc",(function(){return Ft})),a.d(t,"xc",(function(){return Pt})),a.d(t,"lc",(function(){return Dt})),a.d(t,"mc",(function(){return Nt})),a.d(t,"jc",(function(){return Rt})),a.d(t,"kc",(function(){return Lt})),a.d(t,"tc",(function(){return Bt})),a.d(t,"vc",(function(){return zt})),a.d(t,"uc",(function(){return qt})),a.d(t,"rc",(function(){return $t})),a.d(t,"sc",(function(){return Vt})),a.d(t,"Lc",(function(){return Ut})),a.d(t,"Ic",(function(){return Ht})),a.d(t,"Fb",(function(){return Qt})),a.d(t,"yb",(function(){return Gt})),a.d(t,"Jc",(function(){return Wt})),a.d(t,"Pb",(function(){return Zt})),a.d(t,"Yc",(function(){return Kt})),a.d(t,"Ib",(function(){return Jt})),a.d(t,"Kc",(function(){return Yt}));var n=a(5);const i=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),s=n.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),o=n.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=n.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),T=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),M=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),_=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),A=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),F=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),P=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),D=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),N=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),R=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),L=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),z=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),q=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),$=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),V=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),U=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),H=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),Q=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),G=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),W=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),Z=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),K=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),J=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),Y=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),X=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ee=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),te=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ae=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),ne=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),ie=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),re=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),se=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),oe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CKâ„¢ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),le=(e,t,a)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:a},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ce=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ue=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),de=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),pe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),me=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),fe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),be=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),ge=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),ye=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),he=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),ve=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Ee=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),xe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),je=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),Se=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Oe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),ke=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),we=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Te=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Ie=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Ce=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Me=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),_e=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Ae=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Fe=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),Pe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),De=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),Ne=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),Re=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),Le=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),Be=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),ze=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),qe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),$e=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),Ve=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),He=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),Qe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),Ge=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),We=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),Ze=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Ke=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Je=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),Ye=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Xe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),et=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),tt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),at=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),nt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),it=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),rt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),st=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),ot=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),lt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),ct=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ut=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),dt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),pt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),mt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),ft=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),bt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),gt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),yt=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),ht=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),vt=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),Et=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),xt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),jt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),St=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Ot=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),kt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),wt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Tt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),It=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ct=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Mt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),_t=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),At=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ft=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Pt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Dt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Nt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Rt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),Lt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),Bt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),zt=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),qt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),$t=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),Vt=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),Ut=(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),n.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),Ht=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),Qt=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),Gt=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),Wt=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),Zt=n.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),Kt=n.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),Jt=n.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Yt=n.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return b})),a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return y}));var n=a(78),i=a.n(n),r=a(2),s=a.n(r),o=a(47),l=a(110),c=a(126),u=a(715),d=a(586);const p=s.a.memo((({value:e,dateFormat:t=Object(l.g)()})=>s.a.createElement(s.a.Fragment,null,i.a.tz(e,Object(l.l)()).format(t))));p.displayName="PreferenceFormattedDate";const m=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const a=t.toDate();return s.a.createElement(p,{value:a})};m.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,b=s.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),a=Array.isArray(t)?t.find(f):null,n=Array.isArray(a)&&2===a.length?a[1]:"YYYY-MM-DD";return s.a.createElement(p,{dateFormat:n,value:e})}));b.displayName="PreferenceFormattedP1DTDate";const g=s.a.memo((({value:e,fieldName:t,className:a="",dateFormat:n})=>{if(null==e)return Object(c.f)(e);const i=Object(d.a)(e);return i.isValid()?s.a.createElement(u.a,{date:i.toDate(),fieldName:t,className:a},s.a.createElement(p,{value:i.toDate(),dateFormat:n})):Object(c.f)(e)}));g.displayName="FormattedDate";const y=s.a.memo((({value:e,dateFormat:t,tooltipFieldName:a,tooltipAnchorClassName:n,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const m=l.toDate(),f=i()(m).add(r,"hours").isBefore(new Date);return s.a.createElement(u.a,{date:m,fieldName:a,className:n},f?s.a.createElement(p,{"data-test-subj":"preference-time",value:m,dateFormat:t}):s.a.createElement(o.FormattedRelative,{"data-test-subj":"relative-time",value:m}))}));y.displayName="FormattedRelativePreferenceDate"},function(e,t,a){"use strict";e.exports=function(e){return e<-2}},function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"a",(function(){return g})),a.d(t,"c",(function(){return y}));var n=a(2),i=a(45),r=a(48),s=a(235),o=a.n(s),l=a(60),c=a(203),u=a(112),d=a(610),p=a(202),m=a(20);const f=(e,t)=>{const a=Object(r.useDispatch)(),i=Object(c.f)(e);Object(n.useEffect)((()=>{const n=i();return a(d.a.registerUrlParam({key:e,initialValue:n})),t(n),()=>{a(d.a.deregisterUrlParam({key:e}))}}),[])},b=e=>{const t=Object(r.useDispatch)();return Object(n.useCallback)((a=>{t(d.a.updateUrlParam({key:e,value:a}))}),[t,e])},g=()=>{const e=Object(u.b)(d.c.selectGlobalUrlParam);return Object(n.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((a=>{const n=e[a];if(n&&("object"!=typeof n||!Object(i.isEmpty)(n)))try{t[a]=Object(l.encode)(n)}catch{}})),Object(c.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},y=()=>{const[{pageName:e}]=Object(p.a)(),t=Object(u.b)(d.c.selectGlobalUrlParam),a=o()(t),r=Object(c.g)();Object(n.useEffect)((()=>{var n;const s=null!==(n=Object(m.b)(e))&&void 0!==n?n:{skipUrlState:!0},o={...t};s.skipUrlState&&Object.keys(o).forEach((e=>{o[e]=null})),Object(i.difference)(Object.keys(null!=a?a:{}),Object.keys(t)).forEach((e=>{o[e]=null})),Object.keys(o).length>0&&r(o)}),[a,t,e,r])}},function(e,t,a){"use strict";a.r(t),a.d(t,"setAbsoluteRangeDatePicker",(function(){return r})),a.d(t,"setTimelineRangeDatePicker",(function(){return s})),a.d(t,"setRelativeRangeDatePicker",(function(){return o})),a.d(t,"setDuration",(function(){return l})),a.d(t,"startAutoReload",(function(){return c})),a.d(t,"stopAutoReload",(function(){return u})),a.d(t,"setFullScreen",(function(){return d})),a.d(t,"setQuery",(function(){return p})),a.d(t,"deleteOneQuery",(function(){return m})),a.d(t,"setInspectionParameter",(function(){return f})),a.d(t,"deleteAllQuery",(function(){return b})),a.d(t,"toggleTimelineLinkTo",(function(){return g})),a.d(t,"toggleSocTrendsLinkTo",(function(){return y})),a.d(t,"removeLinkTo",(function(){return h})),a.d(t,"addLinkTo",(function(){return v})),a.d(t,"setFilterQuery",(function(){return E})),a.d(t,"setSavedQuery",(function(){return x})),a.d(t,"setSearchBarFilter",(function(){return j}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/local/inputs"),r=i("SET_ABSOLUTE_RANGE_DATE_PICKER"),s=i("SET_TIMELINE_RANGE_DATE_PICKER"),o=i("SET_RELATIVE_RANGE_DATE_PICKER"),l=i("SET_DURATION"),c=i("START_KQL_AUTO_RELOAD"),u=i("STOP_KQL_AUTO_RELOAD"),d=i("SET_FULL_SCREEN"),p=i("SET_QUERY"),m=i("DELETE_QUERY"),f=i("SET_INSPECTION_PARAMETER"),b=i("DELETE_ALL_QUERY"),g=i("TOGGLE_TIMELINE_LINK_TO"),y=i("TOGGLE_SOC_TRENDS_LINK_TO"),h=i("REMOVE_LINK_TO"),v=i("ADD_LINK_TO"),E=i("SET_FILTER_QUERY"),x=i("SET_SAVED_QUERY"),j=i("SET_SEARCH_BAR_FILTER")},function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return f}));var n=a(17),i=a(2),r=a.n(i),s=a(119),o=a(276),l=a(381),c=a(465),u=a(382);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>r.a.createElement(o.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=s.a.global,inspectIndex:a=0,isDisabled:i,multiple:o=!1,onCloseInspect:p,queryId:m="",showInspectButton:f=!0,title:b=""})=>{const{additionalRequests:g,additionalResponses:y,handleClick:h,handleCloseModal:v,isButtonDisabled:E,isShowingModal:x,loading:j,request:S,response:O}=Object(c.a)({inputId:t,inspectIndex:a,isDisabled:i,multiple:o,onCloseInspect:p,queryId:m});return r.a.createElement(r.a.Fragment,null,t===s.a.timeline&&!e&&f&&r.a.createElement(n.EuiButtonEmpty,{className:d,"aria-label":u.d,"data-test-subj":"inspect-empty-button",isDisabled:E,isLoading:j,onClick:h},u.d),(t===s.a.global||e)&&f&&r.a.createElement(n.EuiButtonIcon,{className:d,"aria-label":u.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:u.d,onClick:h}),x&&null!==S&&null!==O&&r.a.createElement(l.a,{additionalRequests:g,additionalResponses:y,closeModal:v,"data-test-subj":"inspect-modal",inputId:t,request:S,response:O,title:b}))};m.displayName="InspectButtonComponent";const f=r.a.memo(m)},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(110),r=a(202);const s=e=>{var t;const[{pageName:a}]=Object(r.a)(),{services:{storage:s}}=Object(i.i)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(a,e),[l,c]=Object(n.useState)(null==o||null===(t=s.get(o))||void 0===t||t);Object(n.useEffect)((()=>{var e;null!=o&&c(null===(e=s.get(o))||void 0===e||e)}),[s,o]);const u=Object(n.useCallback)((e=>{null!=o&&(s.set(o,e),c(e))}),[s,o]);return e?{toggleStatus:l,setToggleStatus:u}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"e",(function(){return k})),a.d(t,"d",(function(){return w})),a.d(t,"f",(function(){return T})),a.d(t,"g",(function(){return C})),a.d(t,"c",(function(){return $})),a.d(t,"h",(function(){return V})),a.d(t,"b",(function(){return U}));var n=a(448),i=a(45),r=a(51),s=a(324),o=a.n(s),l=a(119),c=a(122),u=a(113),d=a(208),p=a(158),m=a(14),f=a(134),b=a(196),g=a(204),y=a(590),h=a(153),v=a(335),E=a(149),x=a(116),j=a(281),S=a(193);const O="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,a)=>t+e[a].length),0):0)+(null!=t?t.length:0),T=({title:e})=>null==e||0===e.trim().length,I=(e,t)=>"__typename"===e?void 0:t,C=e=>JSON.parse(JSON.stringify(e),I),M=e=>{try{return JSON.parse(e)}catch{return e}},_=e=>Object.entries(e).reduce(((e,[t,a])=>"id"!==t&&null!=a?{...e,[t]:a}:e),{columnHeaderType:b.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?g.b:g.a}),A=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:M(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:M(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:M(e.meta.value)}:{}},...null!=e.exists?{exists:M(e.exists)}:{},...null!=e.match_all?{exists:M(e.match_all)}:{},...null!=e.missing?{exists:M(e.missing)}:{},...null!=e.query?{query:M(e.query)}:{},...null!=e.range?{range:M(e.range)}:{},...null!=e.script?{exists:M(e.script)}:{}}),F=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const a=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...a,t.noteId]}}return e}),{}):{},P=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},N=(e,t,a)=>a===u.l.default&&e.timelineType===u.l.template?e.templateTimelineId:t&&e.timelineType===u.l.template?Object(r.v4)():e.templateTimelineId,R=({and:e,...t})=>t.type===u.a.template?o()(t,{type:u.a.default,enabled:t.queryMatch.operator!==h.d,queryMatch:{value:t.queryMatch.operator===h.d?"":t.queryMatch.value}}):t,L=(e,t,a)=>e&&t&&a===u.l.default?t.map((e=>{var t,a;return{...R(e),and:null!==(t=null===(a=e.and)||void 0===a?void 0:a.map(R))&&void 0!==t?t:[]}})):t,B=(e,t,a)=>a&&e.timelineType!==a?"":t?`${e.title} - Duplicate`:e.title||"",z=(e,t,a)=>a&&e.timelineType!==a?u.k.draft:t?u.k.active:e.status,q=(e,t,a)=>{const i=e.timelineType===u.l.template,r={...e,columns:null!=e.columns?e.columns.map(_):b.b,defaultColumns:b.b,dateRange:e.status===u.k.immutable&&e.timelineType===u.l.template?{start:j.a.toISOString(),end:j.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,a),eventIdToNoteIds:F(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(A):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:D(t,e.pinnedEventIds),pinnedEventsSaveObject:P(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:z(e,t,a),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=a?a:e.timelineType,title:B(e,t,a),templateTimelineId:N(e,t,a),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(r).reduce(((e,[t,a])=>null!=a?Object(n.set)(t,a,e):e),{...f.b,id:""})},$=(e,t=!1,a)=>{const{notes:n,...i}=e;return{notes:n,timeline:q(i,t,a)}},V=({activeTimelineTab:e=c.d.query,duplicate:t=!1,graphEventId:a="",timelineId:n,timelineType:r,onError:s,onOpenTimeline:o,openTimeline:l=!0,updateIsLoading:u,updateTimeline:d,savedSearchId:p})=>{u({id:c.c.active,isLoading:!0}),null==n?(d({id:c.c.active,duplicate:!1,notes:[],from:j.a.toISOString(),to:j.b.toISOString(),timeline:{...f.b,id:c.c.active,activeTab:e,show:l,initialized:!0,savedSearchId:null!=p?p:null}})(),u({id:c.c.active,isLoading:!1})):Promise.resolve(Object(S.j)(n)).then((n=>{const s=Object(i.getOr)(null,"data",n);if(!s)return;const u=C(s.timeline),{timeline:p,notes:m}=$(u,t,r);if(null!=o)o(p);else if(d){const{from:n,to:r}=Object(v.a)({from:Object(i.getOr)(null,"dateRange.start",p),to:Object(i.getOr)(null,"dateRange.end",p)});d({duplicate:t,from:n,id:c.c.active,notes:m,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...p,activeTab:e,graphEventId:a,show:l,dateRange:{start:n,end:r},savedSearchId:p.savedSearchId},to:r,preventSettingQuery:!0})()}})).catch((e=>{null!=s&&s(e,n)})).finally((()=>{u({id:c.c.active,isLoading:!1})}))},U=e=>({duplicate:t,id:a,forceNotes:n=!1,from:r,notes:s,resolveTimelineConfig:o,timeline:c,to:f,ruleNote:b,ruleAuthor:g,preventSettingQuery:h})=>()=>{let v=c;var S;if(t&&(v={...c,updated:void 0,changed:void 0,version:null}),Object(i.isEmpty)(v.indexNames)||e(E.a.setSelectedDataView({id:x.SourcererScopeName.timeline,selectedDataViewId:v.dataViewId,selectedPatterns:v.indexNames})),v.status===u.k.immutable&&v.timelineType===u.l.template?e(Object(p.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:j.a.toISOString(),to:j.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:r,to:f})),e(Object(m.addTimeline)({id:a,timeline:v,resolveTimelineConfig:o,savedTimeline:t})),h||null==v.kqlQuery||null==v.kqlQuery.filterQuery||null==v.kqlQuery.filterQuery.kuery||""===v.kqlQuery.filterQuery.kuery.expression||e(Object(m.applyKqlFilterQuery)({id:a,filterQuery:{kuery:{kind:null!==(S=v.kqlQuery.filterQuery.kuery.kind)&&void 0!==S?S:"kuery",expression:v.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:v.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=b&&!Object(i.isEmpty)(b)){const t=Object(y.a)({newNote:b,user:g||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:a}))}t&&!n||e(Object(d.addNotes)({notes:null!=s?s.map((e=>{var t,a;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(a=e.timelineId)&&void 0!==a?a:null}})):[]}))}},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"y",(function(){return m})),a.d(t,"p",(function(){return f})),a.d(t,"v",(function(){return b})),a.d(t,"j",(function(){return g})),a.d(t,"h",(function(){return y})),a.d(t,"k",(function(){return h})),a.d(t,"f",(function(){return v})),a.d(t,"g",(function(){return E})),a.d(t,"e",(function(){return x})),a.d(t,"q",(function(){return j})),a.d(t,"b",(function(){return S})),a.d(t,"n",(function(){return O})),a.d(t,"i",(function(){return k})),a.d(t,"l",(function(){return w})),a.d(t,"a",(function(){return T})),a.d(t,"o",(function(){return I})),a.d(t,"c",(function(){return C})),a.d(t,"m",(function(){return M})),a.d(t,"x",(function(){return _})),a.d(t,"w",(function(){return A})),a.d(t,"r",(function(){return F})),a.d(t,"s",(function(){return P})),a.d(t,"t",(function(){return D})),a.d(t,"u",(function(){return N}));var n=a(29),i=a(72),r=a(70),s=a(663),o=a(191),l=a(4),c=a(341),u=a(389),d=a(110);a(154);const p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({rule:e,signal:t})=>d.b.get().http.fetch(l.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:a={page:1,perPage:20},signal:n})=>{const i=Object(s.a)(e),r={page:a.page,per_page:a.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.kb,{method:"GET",version:"2023-10-31",query:r,signal:n})},y=async({id:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),h=async({ids:e,signal:t})=>{var a;return null===(a=(await d.b.get().http.fetch(n.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===a?void 0:a.reduce(((e,{id:t,...a})=>{var n,i;return e[t]={muteAll:null!==(n=a.mute_all)&&void 0!==n&&n,activeSnoozes:null!==(i=a.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:a.is_snoozed_until?new Date(a.is_snoozed_until):void 0,snoozeSchedule:a.snooze_schedule},e}),{})},v=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),E=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),x=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function j({bulkAction:e,dryRun:t=!1}){const a={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(a),query:{dry_run:t}})}async function S(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const O=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:a=!1,overwriteActionConnectors:n=!1,signal:i})=>{const r=new FormData;return r.append("file",e),d.b.get().http.fetch(`${l.jb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:a,overwrite_action_connectors:n},body:r,signal:i})},k=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),w=async({lists:e,signal:t})=>{const a=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(u.a,{method:"GET",version:"1",query:a,signal:t})},T=async({ruleId:e,items:t,signal:a})=>d.b.get().http.fetch(`${l.jb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:a}),I=({packageName:e,packageVersion:t,prerelease:a=!1,force:n=!0})=>d.b.get().http.post(r.epmRouteService.getInstallPath(e,t),{query:{prerelease:a},version:"2023-10-31",body:JSON.stringify({force:n})}),C=({packages:e,prerelease:t=!1})=>d.b.get().http.post(r.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),M=async({signal:e})=>d.b.get().http.fetch(c.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(c.f,{method:"POST",version:"1",signal:e}),A=async({signal:e})=>d.b.get().http.fetch(c.e,{method:"POST",version:"1",signal:e}),F=async()=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),P=async e=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),D=async()=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),N=async e=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},function(e,t,a){"use strict";a.d(t,"c",(function(){return l.a})),a.d(t,"h",(function(){return l.d})),a.d(t,"d",(function(){return c.a})),a.d(t,"i",(function(){return c.b})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return p.b})),a.d(t,"f",(function(){return p.a})),a.d(t,"j",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"l",(function(){return y})),a.d(t,"m",(function(){return h}));var n=a(45),i=a(2),r=a(462),s=a(486),o=a(352),l=a(237),c=a(229),u=(a(4),a(185));const d=(e,t)=>`/${e}${Object(u.a)(t)}`;var p=a(346);const m=(e,t)=>`/${e}${Object(u.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(n.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,b=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(u.a)(null!=t?t:void 0)}`,g=e=>`/create${Object(u.a)(null!=e?e:void 0)}`,y=e=>{const{getAppUrl:t}=Object(o.a)(),a=Object(s.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:r=!1,skipSearch:s=!1}={})=>{const o=function(e,t,a){const[i,r]=e.split("?");return`${i}${a?Object(n.isEmpty)(r)?"":`?${r}`:Object(n.isEmpty)(r)?t:`?${r}${Object(n.isEmpty)(t)?"":`&${t}`}`}`}(i,a,s);return t({deepLinkId:e,path:o,absolute:r})}),[t,e,a]),search:a}},h=()=>{const e=Object(r.c)(),t=Object(s.a)();return Object(i.useCallback)((({deepLinkId:a,path:n="",absolute:i=!1,skipSearch:r=!1})=>{const s=r?"":t(a);return e({id:a,path:n,urlState:s,absolute:i})}),[e,t])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"u",(function(){return b})),a.d(t,"v",(function(){return g})),a.d(t,"l",(function(){return y})),a.d(t,"j",(function(){return h})),a.d(t,"m",(function(){return v})),a.d(t,"k",(function(){return E})),a.d(t,"d",(function(){return x})),a.d(t,"e",(function(){return j})),a.d(t,"h",(function(){return S})),a.d(t,"p",(function(){return O})),a.d(t,"q",(function(){return k})),a.d(t,"g",(function(){return w})),a.d(t,"n",(function(){return I})),a.d(t,"o",(function(){return C})),a.d(t,"r",(function(){return M})),a.d(t,"f",(function(){return _})),a.d(t,"i",(function(){return A})),a.d(t,"s",(function(){return F})),a.d(t,"t",(function(){return P})),a.d(t,"c",(function(){return D}));var n=a(761),i=a(280),r=a(437),s=a(139),o=a(175),l=a(240),c=a(180);const u=async e=>Object(l.pipe)(await e(),Object(c.fold)((e=>Promise.reject(e)),(e=>Promise.resolve(e)))),d=e=>e instanceof Error?e:new Error(String(e)),p="2023-10-31",m=async({http:e,list:t,signal:a})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,list:t,signal:a})=>e.fetch(o.s,{body:JSON.stringify(t),method:"POST",signal:a,version:p}))({http:e,list:t,signal:a})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(u))(),f=async({http:e,listItem:t,signal:a})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,listItem:t,signal:a})=>e.fetch(o.p,{body:JSON.stringify(t),method:"POST",signal:a,version:p}))({http:e,listItem:t,signal:a})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(u))(),b=async({http:e,list:t,signal:a})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,list:t,signal:a})=>e.fetch(o.s,{body:JSON.stringify(t),method:"PUT",signal:a,version:p}))({http:e,list:t,signal:a})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(u))(),g=async({http:e,listItem:t,signal:a})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,listItem:t,signal:a})=>e.fetch(o.p,{body:JSON.stringify(t),method:"PUT",signal:a,version:p}))({http:e,listItem:t,signal:a})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(u))(),y=async({filters:e,http:t,namespaceTypes:a,pagination:l,signal:c,sort:m})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,filters:t,namespaceTypes:a,pagination:n,signal:i,sort:r})=>{const s={filter:t||void 0,namespace_type:a,page:n.page?`${n.page}`:"1",per_page:n.perPage?`${n.perPage}`:"20",sort_field:null!=r&&r.field?null==r?void 0:r.field:"exception-list.created_at",sort_order:null!=r&&r.order?null==r?void 0:r.order:"desc"};return e.fetch(`${o.s}/_find`,{method:"GET",query:s,signal:i,version:p})})({filters:e,http:t,namespaceTypes:a,pagination:l,signal:c,sort:m})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.t,e)))),Object(i.flow)(u))(),h=async({http:e,id:t,namespaceType:a,signal:l})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,id:t,namespaceType:a,signal:n})=>e.fetch(o.s,{method:"GET",query:{id:t,namespace_type:a},signal:n,version:p}))({http:e,id:t,namespaceType:a,signal:l})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(u))(),v=async({filter:e,http:t,listIds:a,namespaceTypes:l,pagination:c,search:m,signal:f})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,listIds:t,namespaceTypes:a,filter:n,pagination:i,search:r,signal:s})=>{const l={list_id:t.join(","),namespace_type:a.join(","),page:i.page?`${i.page}`:"1",per_page:i.perPage?`${i.perPage}`:"20",search:r,sort_field:"exception-list.created_at",sort_order:"desc",filter:n};return e.fetch(`${o.p}/_find`,{method:"GET",query:l,signal:s,version:p})})({filter:e,http:t,listIds:a,namespaceTypes:l,pagination:c,search:m,signal:f})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.s,e)))),Object(i.flow)(u))(),E=async({http:e,id:t,namespaceType:a,signal:l})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,id:t,namespaceType:a,signal:n})=>e.fetch(o.p,{method:"GET",query:{id:t,namespace_type:a},signal:n,version:p}))({http:e,id:t,namespaceType:a,signal:l})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(u))(),x=async({http:e,id:t,namespaceType:a,signal:l})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,id:t,namespaceType:a,signal:n})=>e.fetch(o.s,{method:"DELETE",query:{id:t,namespace_type:a},signal:n,version:p}))({http:e,id:t,namespaceType:a,signal:l})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(u))(),j=async({http:e,id:t,namespaceType:a,signal:l})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,id:t,namespaceType:a,signal:n})=>e.fetch(o.p,{method:"DELETE",query:{id:t,namespace_type:a},signal:n,version:p}))({http:e,id:t,namespaceType:a,signal:l})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(u))(),S=async({http:e,id:t,includeExpiredExceptions:a,listId:n,namespaceType:i,signal:r})=>e.fetch(`${o.s}/_export`,{method:"POST",query:{id:t,list_id:n,namespace_type:i,include_expired_exceptions:a},signal:r,version:p}),O=async({alias:e,chunkSize:t,exceptionListIds:a,excludeExceptions:n,http:i,signal:r})=>i.fetch(o.u,{method:"POST",version:"1",body:JSON.stringify({exception_list_ids:a,type:"exception_list_ids",alias:e,exclude_exceptions:n,chunk_size:t}),signal:r}),k=async({exceptions:e,alias:t,excludeExceptions:a,http:n,chunkSize:i,signal:r})=>n.fetch(o.u,{method:"POST",version:"1",body:JSON.stringify({exceptions:e,type:"exception_items",alias:t,exclude_exceptions:a,chunk_size:i}),signal:r}),w=async({http:e,includeExpiredExceptions:t,listId:a,namespaceType:n,signal:i})=>e.fetch(`${o.s}/_duplicate`,{method:"POST",query:{list_id:a,namespace_type:n,include_expired_exceptions:t},signal:i,version:p}),T="2023-10-31",I=async({cursor:e,http:t,pageIndex:a,pageSize:c,signal:p,sortField:m,sortOrder:f})=>Object(l.pipe)({cursor:null!=e?e.toString():void 0,page:null!=a?a.toString():void 0,per_page:null!=c?c.toString():void 0,sort_field:null!=m?m.toString():void 0,sort_order:f},(e=>Object(n.fromEither)(Object(r.c)(s.r,e))),Object(n.chain)((e=>Object(n.tryCatch)((()=>(async({http:e,cursor:t,page:a,per_page:n,signal:i,sort_field:r,sort_order:s})=>e.fetch(`${o.z}/_find`,{method:"GET",query:{cursor:t,page:a,per_page:n,sort_field:r,sort_order:s},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.u,e)))),Object(i.flow)(u)),C=async({cursor:e,http:t,pageIndex:a,pageSize:c,signal:p})=>Object(l.pipe)({cursor:null!=e?e.toString():void 0,page:null!=a?a.toString():void 0,per_page:null!=c?c.toString():void 0},(e=>Object(n.fromEither)(Object(r.c)(s.r,e))),Object(n.chain)((e=>Object(n.tryCatch)((()=>(async({http:e,cursor:t,page:a,per_page:n,signal:i})=>e.fetch(`${o.v}`,{method:"GET",version:"1",query:{cursor:t,page:a,per_page:n},signal:i}))({http:t,signal:p,...e})),d))),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.v,e)))),Object(i.flow)(u)),M=async({file:e,http:t,listId:a,type:i,signal:c})=>Object(l.pipe)({list_id:a,type:i},(e=>Object(n.fromEither)(Object(r.c)(s.w,e))),Object(n.chain)((t=>Object(l.pipe)(Object(n.fromEither)(Object(r.c)(s.x,{file:e})),Object(n.map)((e=>({...e,...t})))))),Object(n.chain)((e=>Object(n.tryCatch)((()=>(async({file:e,http:t,list_id:a,type:n,signal:i})=>{const r=new FormData;return r.append("file",e),t.fetch(`${o.x}/_import`,{body:r,headers:{"Content-Type":void 0},method:"POST",query:{list_id:a,type:n},signal:i,version:T})})({http:t,signal:c,...e})),d))),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.A,e)))),u),_=async({deleteReferences:e,http:t,id:a,ignoreReferences:c,signal:p})=>Object(l.pipe)({deleteReferences:e,id:a,ignoreReferences:c},(e=>Object(n.fromEither)(Object(r.c)(s.j,e))),Object(n.chain)((e=>Object(n.tryCatch)((()=>(async({deleteReferences:e=!1,http:t,id:a,ignoreReferences:n=!1,signal:i})=>t.fetch(o.z,{method:"DELETE",query:{deleteReferences:e,id:a,ignoreReferences:n},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.A,e)))),Object(i.flow)(u)),A=async({http:e,listId:t,signal:a})=>Object(l.pipe)({list_id:t},(e=>Object(n.fromEither)(Object(r.c)(s.q,e))),Object(n.chain)((t=>Object(n.tryCatch)((()=>(async({http:e,list_id:t,signal:a})=>e.fetch(`${o.x}/_export`,{method:"POST",query:{list_id:t},signal:a,version:T}))({http:e,signal:a,...t})),d))),Object(i.flow)(u)),F=async({http:e,signal:t})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(o.w,{method:"GET",signal:t,version:T}))({http:e,signal:t})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.z,e)))),Object(i.flow)(u))(),P=async({http:e,signal:t})=>e.fetch(o.y,{method:"GET",signal:t,version:T}),D=async({http:e,signal:t})=>Object(i.flow)((()=>Object(n.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(o.w,{method:"POST",signal:t,version:T}))({http:e,signal:t})),d)),Object(n.chain)((e=>Object(n.fromEither)(Object(r.c)(s.e,e)))),Object(i.flow)(u))()},function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return h}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(544),c=a(174),u=a(126),d=a(153),p=a(564);const m=({field:e,tooltipContent:t})=>null!=t?t:e,f=r.a.memo((({children:e,field:t,tooltipContent:a,tooltipPosition:i,value:s})=>(e=>null===e)(a)?r.a.createElement(r.a.Fragment,null,e||s):r.a.createElement(n.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:m({tooltipContent:a,field:t})},r.a.createElement(r.a.Fragment,null,e||s))));f.displayName="Content";const b=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:a=!0,field:n,fieldType:s="",isAggregatable:o=!1,value:u,name:m,children:b,scopeId:g,tooltipContent:y,tooltipPosition:h,queryValue:v,truncate:E})=>{const x=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(c.i)(t),name:m||(null!==(e=null==u?void 0:u.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:n,value:v||(null!=u?u:""),operator:d.d}}}),[n,t,m,v,u]),j=Object(i.useCallback)(((e,t,a)=>a.isDragging?r.a.createElement(l.a,null,r.a.createElement(p.a,{dataProvider:e})):r.a.createElement(f,{field:n,tooltipContent:y,tooltipPosition:h,value:u},b)),[b,n,y,h,u]);return null==u?null:r.a.createElement(l.b,{dataProvider:x,fieldType:s,isAggregatable:o,hideTopN:e,isDraggable:a,render:j,scopeId:g,truncate:E})}));b.displayName="DefaultDraggable";const g=o()(n.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);g.displayName="Badge";const y=({contextId:e,eventId:t,field:a,value:n,iconType:i,isDraggable:s,isAggregatable:o,fieldType:l,name:c,color:d="hollow",children:p,scopeId:m,tooltipContent:f,queryValue:y})=>null!=n?r.a.createElement(b,{id:`draggable-badge-default-draggable-${e}-${t}-${a}-${n}`,isDraggable:s,isAggregatable:o,fieldType:l,field:a,name:c,value:n,scopeId:m,tooltipContent:f,queryValue:y},r.a.createElement(g,{iconType:i,color:d,title:""},p||(""!==n?n:Object(u.c)()))):null;y.displayName="DraggableBadgeComponent";const h=r.a.memo(y);h.displayName="DraggableBadge"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(208),i=a(422),r=a(187);const s={notesById:{},errors:[],enableExperimental:{...a(16).a}},o=({note:e,notesById:t})=>({...t,[e.id]:e}),l=Object(r.reducerWithInitialState)(s).case(n.addNotes,((e,{notes:t})=>({...e,notesById:t.reduce(((e,t)=>({...e,[t.id]:t})),{})}))).case(n.deleteNote,((e,{id:t})=>({...e,notesById:Object.fromEntries(Object.entries(e.notesById).filter((([e,a])=>a.id!==t&&a.saveObjectId!==t)))}))).case(n.updateNote,((e,{note:t})=>({...e,notesById:o({note:t,notesById:e.notesById})}))).case(n.addError,((e,{id:t,title:a,message:n})=>({...e,errors:e.errors.concat({id:t,title:a,message:n})}))).case(n.removeError,((e,{id:t})=>({...e,errors:e.errors.filter((e=>e.id!==t))}))).case(n.addErrorHash,((e,{id:t,hash:a,title:n,message:i})=>{const r=e.errors.findIndex((e=>e.id===t)),s=e.errors.find((e=>e.id===t))||{id:t,title:n,message:i};return-1===r?{...e,errors:e.errors.concat({...s,hash:a,displayError:!e.errors.some((e=>e.hash===a))})}:{...e,errors:[...e.errors.slice(0,r),{...s,hash:a,displayError:!e.errors.some((e=>e.hash===a))},...e.errors.slice(r+1)]}})).build()},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.welcomeConversationTitle",{defaultMessage:"Welcome"}),r=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.defaultConversationTitle",{defaultMessage:"Default"}),s=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),o=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantName",{defaultMessage:"Assistant"})},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"j",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"e",(function(){return g})),a.d(t,"f",(function(){return h})),a.d(t,"g",(function(){return v}));var n=a(51);const i=e=>null!=e.id?e:{...e,id:Object(n.v4)()},r=e=>{const t=e;if(null!=t.id){const{id:e,...a}=t;return a}return e};var s=a(5);let o,l,c;s.i18n.translate("utils.wildcardWarning",{defaultMessage:"Using wildcards can impact Endpoint performance"}),s.i18n.translate("utils.filename.pathWarning",{defaultMessage:"Path may be formed incorrectly; verify value"}),function(e){e.HASH="process.hash.*",e.PATH="process.executable.caseless",e.SIGNER="process.Ext.code_signature"}(o||(o={})),function(e){e.HASH=".hash.",e.EXECUTABLE=".executable.caseless",e.PATH=".path",e.SIGNER=".Ext.code_signature"}(l||(l={})),function(e){e.LINUX="linux",e.MAC="macos",e.WINDOWS="windows"}(c||(c={}));const u=({os:e,type:t,value:a})=>{const n=e===c.WINDOWS?"\\":"/",i=a.split(n).pop();if(i)return"wildcard"!==t||1===(i.split("*").length||i.split("?").length)},d=({os:e,field:t,type:a,value:n})=>!["process.executable.caseless","file.path","file.path.text"].includes(t)||("wildcard"===a?e===c.WINDOWS?m(n):f(n):p({value:n,os:e})),p=({os:e,value:t})=>e===c.WINDOWS?/^[a-z]:(?:|\\\\[^<>:"'/\\|?*]+\\[^<>:"'/\\|?*]+|%\w+%|)[\\](?:[^<>:"'/\\|?*]+[\\/])*([^<>:"'/\\|?*])+$/i.test(t):/^(\/|(\/[\w\-]+)+|\/[\w\-]+\.[\w]+|(\/[\w-]+)+\/[\w\-]+\.[\w]+)$/i.test(t),m=e=>{const t=e[0],a=e.slice(-1),n=e.trim(),i=/\//.test(n);return 0!==e.length&&!(i||n.length!==e.length||"^"===t||"\\"===a||!b({path:e,isWindowsPath:!0}))},f=e=>{const t=e[0],a=e.slice(-1),n=e.trim();return 0!==e.length&&!(n.length!==e.length||"/"!==t||"/"===a||e.length>1024==1||!0===e.includes("//")||!b({path:e,isWindowsPath:!1}))},b=({path:e,isWindowsPath:t})=>{for(const a of e.split(t?"\\":"/"))if(!0===/[\*|\?]+/.test(a))return!0;return!1},g=e=>/\|\s+stats\s/i.test(e);var y=a(53);const h=e=>{const t=Object(y.getIndexPatternFromESQLQuery)(e);return v(t)},v=e=>e?e.split(",").map((e=>e.trim())):[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(59),c=a.n(l),u=a(159),d=a(716),p=a(717);const m=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(s.css)(["height:","px;"],e)),(({border:e})=>e&&Object(s.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",b=({alignHeader:e,border:t,children:a,outerDirection:s="column",growLeftSplit:o=!0,headerFilters:l,height:b,hideSubtitle:g=!1,id:y,inspectMultiple:h=!1,inspectTitle:v,isInspectDisabled:E,showInspectButton:x=!0,split:j,stackHeader:S,subtitle:O,title:k,titleSize:w="l",toggleQuery:T,toggleStatus:I=!0,tooltip:C,tooltipTitle:M})=>{const _=Object(i.useCallback)((()=>{T&&T(!I)}),[T,I]),A=c()({"toggle-expand":I,siemHeaderSection:!0});return r.a.createElement(m,{"data-test-subj":"header-section",border:t,height:b,className:A,$hideSubtitle:g},r.a.createElement(n.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:s,gutterSize:"xs",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:o},r.a.createElement(n.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:S}),"data-test-subj":"headerSectionInnerFlexGroup",direction:S?"column":"row",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,{grow:o,className:I?"":"no-margin"},r.a.createElement(n.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},T&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(I),color:"text",display:"empty",iconType:I?"arrowDown":"arrowRight",onClick:_,size:"s",title:p.a(I)})),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiTitle,{size:w},r.a.createElement("h4",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},k),C&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiIconTip,{color:"subdued",title:M,content:C,size:"l",type:"iInCircle"}))))))),y&&I&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(u.b,{isDisabled:E,queryId:y,multiple:h,showInspectButton:x,title:null!=v?v:k})),l&&I&&r.a.createElement(n.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),a&&I&&r.a.createElement(n.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!j},a))),!g&&I&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:O}))))},g=r.a.memo(b)},function(e,t,a){"use strict";var n=a(258);e.exports=function(e,t,a,i){var r=i?i-1:1/0,s=0;return function(i){return n(i)?(e.enter(a),o(i)):t(i)};function o(i){return n(i)&&s++<r?(e.consume(i),o):(e.exit(a),t(i))}}},function(e,t,a){"use strict";a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return f})),a.d(t,"h",(function(){return b})),a.d(t,"g",(function(){return g})),a.d(t,"c",(function(){return y})),a.d(t,"a",(function(){return h})),a.d(t,"i",(function(){return E})),a.d(t,"d",(function(){return x}));var n=a(53),i=a(45),r=a(234),s=a.n(r),o=a(425),l=a(113),c=a(122);const u=(e,t)=>{try{return e?JSON.stringify(Object(n.toElasticsearchQuery)(Object(n.fromKueryExpression)(e),t)):""}catch(e){return""}},d=(e,t)=>`${e}: ${(e=>!isNaN(Number(e)))(t)?t:new Date(t.toString()).valueOf()}`,p=s()((e=>{const t=Object(i.get)("base",e);return null!=t&&null!=t.fields?Object.keys(t.fields):[]})),m=(e,t)=>{const a=e.split(".");return p(t).includes(e)?["base","fields",e]:[a[0],"fields",e]},f=(e,t)=>{const a=m(e,t),n=Object(i.get)(a,t);return null!=n&&"date"===n.type},b=(e,t,a)=>{const n=m(e,a),r=Object(i.get)(n,a),s=r.subType.nested.path;return`${s}: { ${e.replace(`${s}.`,"")}: ${"date"===r.type?`"${t}"`:t} }`},g=(e,t)=>{const a=m(e,t),n=Object(i.get)(a,t).subType.nested.path;return`${n}: { ${e.replace(`${n}.`,"")}: * }`},y=(e,t)=>{const a=m(e,t),n=Object(i.get)(a,t);return!(null==n||!n.subType||!n.subType.nested)},h=(e,t)=>({range:{"@timestamp":{gte:e,lt:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lt:t,format:"strict_date_optional_time"}},$state:{store:n.FilterStateStore.APP_STATE}}),v=e=>Object(i.isEmpty)(e)||Object(i.isEmpty)(e.filter((e=>!0===e.enabled))),E=({config:e,indexPattern:t,queries:a,filters:i})=>{try{return[JSON.stringify(Object(n.buildEsQuery)(t,a,i.filter((e=>!1===e.meta.disabled)),{nestedIgnoreUnmapped:!0,...e,dateFormatTZ:void 0})),void 0]}catch(e){return[void 0,e]}},x=({config:e,dataProviders:t=[],indexPattern:a,browserFields:n,filters:r=[],kqlQuery:s,kqlMode:u})=>{const p={query:"",language:s.language};if(v(t)&&Object(i.isEmpty)(s.query)&&Object(i.isEmpty)(r))return null;if(v(t)&&Object(i.isEmpty)(s.query)&&!Object(i.isEmpty)(r)){const[t,n]=E({config:e,queries:[p],indexPattern:a,filters:r});return{filterQuery:t,kqlError:n}}const m="filter"===u?"and":"or",h=((e,t)=>e.reduce(((e,a)=>{const n=[a,...a.and].filter((e=>e.enabled));if(!n.length)return e;const i=n.map((e=>((e,t)=>`${e.excluded?"NOT ":""}${e.queryMatch.operator!==c.a&&e.type!==l.a.template?y(e.queryMatch.field,t)?b(e.queryMatch.field,e.queryMatch.value,t):f(e.queryMatch.field,t)?d(e.queryMatch.field,e.queryMatch.value):`${e.queryMatch.field} : ${Array.isArray(e.queryMatch.value)?e.queryMatch.value:Object(o.a)(e.queryMatch.value)}`:y(e.queryMatch.field,t)?g(e.queryMatch.field,t):`${e.queryMatch.field} ${c.a}`}`.trim())(e,t))),r=i.join(" and ");return[...e,r]}),[]).filter((e=>!Object(i.isEmpty)(e))).reduce(((e,t,a,n)=>n.length<=1?t:a?`${e} or (${t})`:`(${t})`),""))(t,n),x=(j=s.query,Object(i.isEmpty)(j)?"":`(${j})`);var j;const S=h?`(${h})`:"",O=S&&x?m:"";p.query=`(${S} ${O} ${x})`;const[k,w]=E({config:e,queries:[p],indexPattern:a,filters:r});return{filterQuery:k,kqlError:w}}},function(e,t,a){const n=a(314),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=a(315),{safeRe:s,t:o}=a(316),l=a(412),{compareIdentifiers:c}=a(514);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const a=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!a)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const a=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,a,i),void 0===a&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===a)return-1;if(a!==i)return c(a,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const a=this.build[t],i=e.build[t];if(n("prerelease compare",t,a,i),void 0===a&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===a)return-1;if(a!==i)return c(a,i)}while(++t)}inc(e,t,a){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,a);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,a);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,a),this.inc("pre",t,a);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,a),this.inc("pre",t,a);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(a)?1:0;if(!t&&!1===a)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===a)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===a&&(n=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,a){"use strict";a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m})),a.d(t,"n",(function(){return f}));var n=a(45),i=a(114),r=a(124),s=a(204),o=a(127),l=a(181),c=a(424);a.d(t,"f",(function(){return i.g})),a.d(t,"h",(function(){return i.i})),a.d(t,"g",(function(){return i.h})),a.d(t,"l",(function(){return i.m})),a.d(t,"k",(function(){return i.l})),a.d(t,"p",(function(){return i.r})),a.d(t,"o",(function(){return i.q})),a.d(t,"m",(function(){return i.n})),a.d(t,"i",(function(){return i.j})),a.d(t,"q",(function(){return i.w})),a.d(t,"r",(function(){return i.x})),a.d(t,"j",(function(){return i.k})),a.d(t,"a",(function(){return i.b})),a.d(t,"b",(function(){return i.e}));const u=({activeTimelineDataProviders:e,dataProviders:t,dispatch:a,result:n,timelineId:r,noProviderFound:s=l.b.noProviderFound,onAddedToTimeline:o})=>{const u=Object(i.p)(n),d=t[u];d?Object(c.b)({dataProviders:e,destination:n.destination,dispatch:a,onAddedToTimeline:o,providerToAdd:d,timelineId:r}):a(s({id:u}))},d=({isAggregatable:e,fieldType:t,fieldName:a,hideTopN:n})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),r=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(a);return!n&&(r||e&&i)},p={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},m=({browserFields:e,dispatch:t,result:a,scopeId:l,defaultsHeader:c})=>{var u;const d=Object(i.o)(a),m=(e=>Object(n.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[d],f=l!==r.e.alertsOnAlertsPage&&l!==r.e.alertsOnRuleDetailsPage||null===(u=c.find((e=>e.id===d)))||void 0===u?{}:u,b=Object(o.getScopedActions)(l);var g;null!=m&&b?t(b.upsertColumn({column:{category:m.category,columnHeaderType:"not-filtered",description:Object(n.isString)(m.description)?m.description:void 0,example:Object(n.isString)(m.example)?m.example:void 0,id:d,linkField:null!==(g=p[d])&&void 0!==g?g:void 0,type:m.type,aggregatable:m.aggregatable,initialWidth:s.a,...f},id:l,index:null!=a.destination?a.destination.index:0})):b&&t(b.upsertColumn({column:{columnHeaderType:"not-filtered",id:d,initialWidth:s.a},id:l,index:null!=a.destination?a.destination.index:0}))},f=e=>e.slice(e.lastIndexOf(".")+1)},,function(e,t,a){"use strict";let n,i,r,s;a.r(t),a.d(t,"UsersType",(function(){return n})),a.d(t,"UsersTableType",(function(){return i})),a.d(t,"UsersDetailsTableType",(function(){return r})),a.d(t,"UserAssetTableType",(function(){return s})),function(e){e.page="page",e.details="details",e.flyout="flyout"}(n||(n={})),function(e){e.allUsers="allUsers",e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(i||(i={})),function(e){e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(r||(r={})),function(e){e.assetEntra="userAssetEntra",e.assetOkta="userAssetOkta"}(s||(s={}))},function(e,t,a){"use strict";a.d(t,"n",(function(){return i})),a.d(t,"o",(function(){return r})),a.d(t,"r",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"k",(function(){return b})),a.d(t,"j",(function(){return g})),a.d(t,"i",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"g",(function(){return v})),a.d(t,"p",(function(){return E})),a.d(t,"q",(function(){return x}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.connectors.useLoadActionTypes.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),r=n.i18n.translate("xpack.elasticAssistant.connectors.useLoadConnectors.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),s=(n.i18n.translate("xpack.elasticAssistant.content.prompts.welcome.welcomeSecurityPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into Elastic Security. "}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.preconfiguredTitle",{defaultMessage:"Preconfigured"})),o=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.ariaLabel",{defaultMessage:"Conversation Selector"}),l=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.newConnectorOptions",{defaultMessage:"Add new Connector..."}),c=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorLabel",{defaultMessage:"Connector:"}),u=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorPlaceholder",{defaultMessage:"Select a Connector"}),d=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.title",{defaultMessage:"Add Generative AI Connector"}),p=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.description",{defaultMessage:"Configure a connector to continue the conversation"}),m=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesTitle",{defaultMessage:"Generative AI Connector Required"}),f=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesDescription",{defaultMessage:"Please contact your administrator to enable a Generative AI Connector."}),b=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userYouTitle",{defaultMessage:"You"}),g=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userAssistantTitle",{defaultMessage:"Assistant"}),y=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.timestampAtTitle",{defaultMessage:"at"}),h=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.skipTitle",{defaultMessage:"Click to skip..."}),v=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.complete",{defaultMessage:"Connector setup complete!"}),E=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutTitle",{defaultMessage:"The current conversation is missing a connector configuration"}),x=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.conversationSettingsLink",{defaultMessage:"Conversation Settings"})},,function(e,t,a){"use strict";e.exports=a(611)},,function(e,t,a){"use strict";var n=a(167);a.d(t,"a",(function(){return n.a}));var i=a(195);a.d(t,"b",(function(){return i.a}));var r=a(138);a.d(t,"c",(function(){return r.b}));var s=a(149);a.d(t,"d",(function(){return s.a}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"f",(function(){return o}));var n=a(111);function i(e){return n.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),n.array(e))}const r=n.enum(["true","false"]).or(n.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e)),s=5;function o(e){const t=[],a=e.issues;for(;a.length>0;){const e=a.shift();"invalid_union"!==e.code?t.push(l(e)):a.push(...e.unionErrors.flatMap((e=>e.issues)))}const n=t.length-s;return n>0&&(t.splice(s),t.push(`and ${n} more`)),t.join(", ")}function l(e){return 0===e.path.length?e.message:`${e.path.join(".")}: ${e.message}`}var c=a(65),u=a.n(c);function d(e,t){var a;a=e,!isNaN(Date.parse(a))||a.trim().startsWith("now")&&Boolean(u.a.parse(a))||t.addIssue({code:n.ZodIssueCode.custom,message:"Failed to parse date-math expression"})}const p=e=>e;function m(e,t){const a=t.safeParse(e);if(a.success)return a.data}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(2),i=a(110);const r={managed:!0},s=()=>{const{services:{apm:e}}=Object(i.i)();return{startTransaction:Object(n.useCallback)((({name:t,type:a="user-interaction",options:n})=>e.startTransaction(t,a,null!=n?n:r)),[e])}},o=e=>`Timeline search ${e}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(45);const i=e=>Object(n.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},function(e,t,a){"use strict";let n,i,r,s,o,l,c;a.d(t,"e",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(n||(n={})),function(e){e.is="is",e.matches="matches"}(i||(i={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(r||(r={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(s||(s={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(o||(o={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(l||(l={})),function(e){e.ENROLLED_AT="enrolled_at",e.HOSTNAME="metadata.host.hostname",e.HOST_STATUS="host_status",e.POLICY_NAME="metadata.Endpoint.policy.applied.name",e.POLICY_STATUS="metadata.Endpoint.policy.applied.status",e.HOST_OS_NAME="metadata.host.os.name",e.HOST_IP="metadata.host.ip",e.AGENT_VERSION="metadata.agent.version",e.LAST_SEEN="last_checkin"}(c||(c={}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(111),i=a(636);const r=n.z.object({direction:i.b.default(i.a.desc),field:n.z.string().default("@timestamp")}).default({direction:i.a.desc,field:"@timestamp"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(2),i=a(48),r=a(119),s=a(4),o=a(112),l=a(128),c=a(181);const u=()=>{var e;const t=Object(i.useDispatch)(),a=null!==(e=Object(o.b)(l.d.globalFullScreenSelector))&&void 0!==e&&e,u=Object(n.useCallback)((e=>{const a=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(s.rc,"euiDataGrid__restrictBody"):!1!==a&&!1!==e||document.body.classList.remove(s.rc,"euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:r.a.global,fullScreen:e}))}),[t]);return Object(n.useMemo)((()=>({globalFullScreen:a,setGlobalFullScreen:u})),[a,u])},d=()=>{var e;const t=Object(i.useDispatch)(),a=null!==(e=Object(o.b)(l.d.timelineFullScreenSelector))&&void 0!==e&&e,s=Object(n.useCallback)((e=>{const a=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==a&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:r.a.timeline,fullScreen:e}))}),[t]);return Object(n.useMemo)((()=>({timelineFullScreen:a,setTimelineFullScreen:s})),[a,s])},p=()=>{const{globalFullScreen:e}=u(),{timelineFullScreen:t}=d(),a=(()=>{const[e,t]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const e=document.body,a=new MutationObserver((a=>{for(const n of a)"class"===n.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[]),e})();return e||t||a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return p}));var n=a(4);const i="histogram-actions-trigger",r={[n.yc.hosts]:"host",[n.yc.users]:"user"},s=(e,t)=>{const a=r[e];return a&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${a}.name`,params:{query:t}},query:{match_phrase:{[`${a}.name`]:t}}}]:[]},o=e=>{const t=r[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],c=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],u=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var a,n,i,r,s,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(a=null==t||null===(n=t.stats)||void 0===n||null===(i=n.indexFilter)||void 0===i?void 0:i.value)&&void 0!==a?a:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(s=t.response)||void 0===s||null===(o=s.json)||void 0===o?void 0:o.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]}),p=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"c",(function(){return N})),a.d(t,"d",(function(){return L})),a.d(t,"e",(function(){return G})),a.d(t,"g",(function(){return K.b})),a.d(t,"f",(function(){return K.a}));var n=a(111),i=a(182),r=a(148),s=a(141);const o=n.z.literal("RULE_NOT_MODIFIED"),l=n.z.object({id:n.z.string(),name:n.z.string().optional(),skip_reason:o}),c=n.z.object({id:n.z.string(),name:n.z.string().optional()}),u=n.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN"]),d=(u.enum,n.z.object({message:n.z.string(),status_code:n.z.number().int(),err_code:u.optional(),rules:n.z.array(c)})),p=n.z.object({updated:n.z.array(r.e),created:n.z.array(r.e),deleted:n.z.array(r.e),skipped:n.z.array(l)}),m=n.z.object({failed:n.z.number().int(),skipped:n.z.number().int(),succeeded:n.z.number().int(),total:n.z.number().int()}),f=n.z.object({success:n.z.boolean().optional(),status_code:n.z.number().int().optional(),message:n.z.string().optional(),rules_count:n.z.number().int().optional(),attributes:n.z.object({results:p,summary:m,errors:n.z.array(d).optional()})}),b=n.z.string(),g=n.z.object({query:n.z.string().optional(),ids:n.z.array(n.z.string()).min(1).optional()}),y=g.merge(n.z.object({action:n.z.literal("delete")})),h=g.merge(n.z.object({action:n.z.literal("disable")})),v=g.merge(n.z.object({action:n.z.literal("enable")})),E=g.merge(n.z.object({action:n.z.literal("export")})),x=g.merge(n.z.object({action:n.z.literal("duplicate"),duplicate:n.z.object({include_exceptions:n.z.boolean(),include_expired_exceptions:n.z.boolean()}).optional()})),j=n.z.enum(["rule","1h","1d","7d"]),S=(j.enum,n.z.enum(["enable","disable","export","delete","duplicate","edit"]).enum),O=n.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule"]).enum,k=n.z.object({group:s.u,id:s.v,params:s.w,frequency:s.t.optional(),alerts_filter:s.s.optional()}).strict(),w=n.z.object({type:n.z.enum(["add_rule_actions","set_rule_actions"]),value:n.z.object({throttle:j.optional(),actions:n.z.array(k)})}),T=n.z.object({type:n.z.literal("set_schedule"),value:n.z.object({interval:n.z.string().regex(/^[1-9]\d*[smh]$/),lookback:n.z.string().regex(/^[1-9]\d*[smh]$/)})}),I=n.z.object({type:n.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:s.f,overwrite_data_views:n.z.boolean().optional()}),C=n.z.object({type:n.z.enum(["add_tags","delete_tags","set_tags"]),value:s.O}),M=n.z.object({type:n.z.literal("set_timeline"),value:n.z.object({timeline_id:s.Y,timeline_title:s.Z})}),_=n.z.union([C,I,M,w,T]),A=g.merge(n.z.object({action:n.z.literal("edit"),edit:n.z.array(_).min(1)}));n.z.object({dry_run:i.b.optional()}),n.z.union([y,h,v,E,x,A]),n.z.union([f,b]);var F=a(299);n.z.array(n.z.union([r.e,F.a])),n.z.array(r.c),n.z.array(n.z.object({id:s.K.optional(),rule_id:s.N.optional()})),n.z.array(r.d),n.z.array(r.f);var P=a(46),D=a(120);let N;!function(e){e.Enabled="enabled",e.Disabled="disabled"}(N||(N={}));const R=Object(D.r)("CoverageOverviewRuleActivity",N);let L;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(L||(L={}));const B=Object(D.r)("CoverageOverviewRuleSource",L),z=P.partial({search_term:D.j,activity:Object(D.i)(R),source:Object(D.i)(B)}),q=(P.exact(P.partial({filter:z})),P.type({name:P.string,activity:R}));P.exact(P.type({coverage:P.record(P.string,Object(D.i)(P.string)),unmapped_rule_ids:P.array(P.string),rules_data:P.record(P.string,q)})),r.c,r.e,n.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.d,r.e,n.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.f,r.e;var $=a(139);const V={exported_count:P.number,exported_rules_count:P.number,missing_rules:P.array(P.exact(P.type({rule_id:D.j}))),missing_rules_count:P.number},U=P.intersection([P.exact(P.type({id:D.j,type:D.j})),P.exact(P.partial({reason:P.string}))]),H={exported_action_connector_count:P.number,missing_action_connection_count:P.number,missing_action_connections:P.array(P.exact(P.type({id:D.j,type:D.j}))),excluded_action_connection_count:P.number,excluded_action_connections:P.array(U)};P.intersection([P.exact(P.type(V)),P.exact(P.partial($.p)),P.exact(P.partial(H))]),n.z.object({exclude_export_details:i.b.optional().default(!1),file_name:n.z.string().optional().default("export.ndjson")}),n.z.object({objects:n.z.array(n.z.object({rule_id:s.N}))}).nullable();var Q=a(248);const G=n.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);G.enum,n.z.object({fields:Object(i.a)(n.z.string()).optional(),filter:n.z.string().optional(),sort_field:G.optional(),sort_order:Q.a.optional(),page:n.z.coerce.number().int().min(1).optional().default(1),per_page:n.z.coerce.number().int().min(0).optional().default(20)}),n.z.object({page:n.z.number().int(),perPage:n.z.number().int(),total:n.z.number().int(),data:n.z.array(r.e)}),P.exact(P.type({rules_summary:P.type({custom_count:D.m,prebuilt_installed_count:D.m}),aggregated_fields:P.type({tags:P.array(P.string)})}));var W=a(371);n.z.object({overwrite:i.b.optional().default(!1),overwrite_exceptions:i.b.optional().default(!1),overwrite_action_connectors:i.b.optional().default(!1),as_new_list:i.b.optional().default(!1)}),n.z.object({exceptions_success:n.z.boolean(),exceptions_success_count:n.z.number().int().min(0),exceptions_errors:n.z.array(F.a),rules_count:n.z.number().int().min(0),success:n.z.boolean(),success_count:n.z.number().int().min(0),errors:n.z.array(F.a),action_connectors_errors:n.z.array(F.a),action_connectors_warnings:n.z.array(W.a),action_connectors_success:n.z.boolean(),action_connectors_success_count:n.z.number().int().min(0)}).strict();var Z=a(247);Z.b.and(Z.f).and(Z.c.partial().extend({rule_id:Z.d,immutable:n.literal(!1).default(!1)})),s.O;var K=a(410)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>"string"==typeof e?e:Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e[0]:null!=t?t:null},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"i",(function(){return y})),a.d(t,"f",(function(){return h})),a.d(t,"c",(function(){return v})),a.d(t,"g",(function(){return x})),a.d(t,"j",(function(){return j})),a.d(t,"e",(function(){return S})),a.d(t,"d",(function(){return O})),a.d(t,"h",(function(){return k})),a.d(t,"b",(function(){return w}));var n=a(180),i=a(280),r=a(240),s=a(9),o=a(68),l=a(113),c=a(4),u=a(110),d=a(480);const p=e=>new d.c([e]),m=e=>Object(r.pipe)(l.i.decode(e),Object(n.fold)(Object(o.throwErrors)(p),i.identity)),f=e=>Object(r.pipe)(l.h.decode(e),Object(n.fold)(Object(o.throwErrors)(p),i.identity)),b=async({timelineId:e,timeline:t,version:a,savedSearch:n})=>{let i=null,r=null;try{r=JSON.stringify({timeline:t,timelineId:e,version:a})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}try{if(t.savedSearchId&&n){const{savedSearch:e}=u.b.get();await e.save(n,{onTitleDuplicate:()=>({}),copyOnSave:!1})}}catch(e){return Promise.reject(new Error(`Failed to copy saved search: ${t.savedSearchId}`))}try{i=await u.b.get().http.patch(c.Jc,{method:"PATCH",body:r,version:"2023-10-31"})}catch(e){return Promise.resolve(f(e.body))}return m(i)},g=async({timelineId:e,timeline:t,savedSearch:a})=>{let n=null,i=null,r=null;try{if(t.savedSearchId&&a){const{savedSearch:e}=u.b.get(),t={...a};delete t.id,r=await e.save(t,{onTitleDuplicate:()=>({}),copyOnSave:!1})}}catch(e){return Promise.reject(new Error(`Failed to copy saved search: ${t.savedSearchId}`))}try{i=JSON.stringify({timeline:{...t,savedSearchId:r||t.savedSearchId},timelineIdToCopy:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}try{n=await u.b.get().http.post(c.Cc,{method:"POST",body:i,version:"1"})}catch(e){return Promise.resolve(f(e.body))}return m(n)},y=async({timelineId:e,timeline:t,version:a,savedSearch:n})=>{try{if(Object(s.isEmpty)(e)&&t.status===l.k.draft&&t){var i,r,o,d,p;const e=await E({timelineType:t.timelineType,templateTimelineId:null!==(i=t.templateTimelineId)&&void 0!==i?i:void 0,templateTimelineVersion:null!==(r=t.templateTimelineVersion)&&void 0!==r?r:void 0}),a=m(e),s=t.timelineType===l.l.template?{templateTimelineId:null!==(o=a.data.persistTimeline.timeline.templateTimelineId)&&void 0!==o?o:t.templateTimelineId,templateTimelineVersion:null!==(d=a.data.persistTimeline.timeline.templateTimelineVersion)&&void 0!==d?d:t.templateTimelineVersion}:{};return b({timelineId:a.data.persistTimeline.timeline.savedObjectId,timeline:{...t,...s},version:null!==(p=a.data.persistTimeline.timeline.version)&&void 0!==p?p:"",savedSearch:n})}return Object(s.isEmpty)(e)?(async({timeline:e})=>{let t;try{t=JSON.stringify({timeline:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const a=await u.b.get().http.post(c.Jc,{method:"POST",body:t,version:"2023-10-31"});return m(a)})({timeline:t}):b({timelineId:null!=e?e:"-1",timeline:t,version:null!=a?a:"",savedSearch:n})}catch(e){return 403===e.status_code||403===e.body.status_code?Promise.resolve({data:{persistTimeline:{code:403,message:e.message||e.body.message,timeline:{...t,savedObjectId:"",version:""}}}}):Promise.resolve(e)}},h=async({fileToImport:e,signal:t})=>{const a=new FormData;return a.append("file",e),u.b.get().http.fetch(`${c.Gc}`,{method:"POST",headers:{"Content-Type":void 0},body:a,signal:t,version:"2023-10-31"})},v=({filename:e="timelines_export.ndjson",ids:t=[],signal:a})=>{let n;try{n=t.length>0?JSON.stringify({ids:t}):void 0}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return u.b.get().http.fetch(`${c.Ec}`,{method:"POST",body:n,query:{file_name:e},signal:a,version:"2023-10-31"})},E=async({timelineType:e,templateTimelineId:t,templateTimelineVersion:a})=>{let n;const i=e===l.l.template?{templateTimelineId:t,templateTimelineVersion:a}:{};try{n=JSON.stringify({timelineType:e,...i})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const r=await u.b.get().http.post(c.Dc,{body:n,version:"2023-10-31"});return m(r)},x=async()=>{return e=await u.b.get().http.post(c.Hc,{version:"2023-10-31"}),Object(r.pipe)(l.n.decode(e),Object(n.fold)(Object(o.throwErrors)(p),i.identity));var e},j=async e=>{return t=await u.b.get().http.get(c.Ic,{query:{id:e},version:"2023-10-31"}),Object(r.pipe)(l.c.decode(t),Object(n.fold)(Object(o.throwErrors)(p),i.identity));var t},S=async e=>{const t=await u.b.get().http.get(c.Jc,{query:{template_timeline_id:e},version:"2023-10-31"});return a=t,Object(r.pipe)(l.e.decode(a),Object(n.fold)(Object(o.throwErrors)(p),i.identity));var a},O=async(e,t)=>{var a,s,d,m,f,b;return g=await u.b.get().http.fetch(c.Bc,{method:"GET",query:{...e.onlyUserFavorite?{only_user_favorite:e.onlyUserFavorite}:{},...null!=e&&null!==(a=e.pageInfo)&&void 0!==a&&a.pageSize?{page_size:e.pageInfo.pageSize}:{},...null!=e&&null!==(s=e.pageInfo)&&void 0!==s&&s.pageIndex?{page_index:e.pageInfo.pageIndex}:{},...e.search?{search:e.search}:{},...null!=e&&null!==(d=e.sort)&&void 0!==d&&d.sortField?{sort_field:null==e||null===(m=e.sort)||void 0===m?void 0:m.sortField}:{},...null!=e&&null!==(f=e.sort)&&void 0!==f&&f.sortOrder?{sort_order:null==e||null===(b=e.sort)||void 0===b?void 0:b.sortOrder}:{},...e.status?{status:e.status}:{},...e.timelineType?{timeline_type:e.timelineType}:{}},signal:t,version:"2023-10-31"}),Object(r.pipe)(l.m.decode(g),Object(n.fold)(Object(o.throwErrors)(p),i.identity));var g},k=async({timelineId:e,templateTimelineId:t,templateTimelineVersion:a,timelineType:s})=>{let d;try{d=JSON.stringify({timelineId:e,templateTimelineId:t,templateTimelineVersion:a,timelineType:s})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return m=await u.b.get().http.patch(c.Fc,{method:"PATCH",body:d,version:"2023-10-31"}),Object(r.pipe)(l.o.decode(m),Object(n.fold)(Object(o.throwErrors)(p),i.identity));var m},w=async(e,t)=>{let a;try{a=t?JSON.stringify({savedObjectIds:e,searchIds:t}):JSON.stringify({savedObjectIds:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await u.b.get().http.delete(c.Jc,{method:"DELETE",body:a,version:"2023-10-31"})}},function(e,t,a){"use strict";a.d(t,"d",(function(){return n.a})),a.d(t,"j",(function(){return n.b})),a.d(t,"c",(function(){return Ot})),a.d(t,"a",(function(){return xt})),a.d(t,"f",(function(){return Ct})),a.d(t,"g",(function(){return At})),a.d(t,"k",(function(){return wt})),a.d(t,"i",(function(){return x.a})),a.d(t,"b",(function(){return K})),a.d(t,"e",(function(){return se.c})),a.d(t,"h",(function(){return se.d}));var n=a(123),i=a(2),r=a.n(i),s=a(17),o=a(302),l=a.n(o),c=a(44),u=a.n(c),d=a(67),p=a(13),m=a(253),f=a(221),b=a(388),g=a(250),y=a(45),h=a(51);const v=({currentReplacements:e,rawValue:t})=>{if(null!=e){const a=Object(y.invert)(e)[t];return null!=a?a:Object(h.v4)()}return Object(h.v4)()};var E=a(374),x=a(222);var j=a(249),S={name:"a4hmbt",styles:"position:absolute"};const O=({isDisabled:e,isLoading:t,onChatCleared:a,onSendMessage:n})=>Object(p.jsx)(s.EuiFlexGroup,{css:S,direction:"column",gutterSize:"xs"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{position:"right",content:j.b},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.b,color:"danger","data-test-subj":"clear-chat",display:"base",iconType:"cross",isDisabled:e,onClick:a}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{position:"right",content:j.g},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.g,"data-test-subj":"submit-chat",color:"primary",display:"base",iconType:"returnKey",isDisabled:e,isLoading:t,onClick:n}))));var k=a(5);const w=k.i18n.translate("xpack.elasticAssistant.assistant.promptPlaceholder",{defaultMessage:"Ask me anything from 'summarize this alert' to 'help me build a query...'"}),T=u()(s.EuiTextArea)`
  min-height: 125px;
  padding-right: 42px;
`,I=Object(i.forwardRef)((({isDisabled:e=!1,value:t,onPromptSubmit:a,handlePromptChange:n,...r},s)=>{const o=Object(i.useCallback)((e=>{n(e.target.value)}),[n]),l=Object(i.useCallback)((e=>{var i;"Enter"===e.key&&!e.shiftKey&&t.trim().length>0?(e.preventDefault(),a(null===(i=e.target.value)||void 0===i?void 0:i.trim()),n("")):"Enter"!==e.key||e.shiftKey||0!==t.trim().length||(e.preventDefault(),e.stopPropagation())}),[t,a,n]);return Object(i.useEffect)((()=>{n(t)}),[n,t]),Object(p.jsx)(T,{className:"eui-scrollBar",inputRef:s,id:"prompt-textarea","data-test-subj":"prompt-textarea",fullWidth:!0,autoFocus:!0,disabled:e,placeholder:w,value:t,onChange:o,onKeyDown:l})}));I.displayName="PromptTextArea";var C={name:"zyunh5",styles:"left:-34px;position:relative;top:11px"},M={name:"1d3w5wq",styles:"width:100%"};const _=({handleButtonSendMessage:e,handleOnChatCleared:t,handlePromptChange:a,handleSendMessage:n,isDisabled:r,isLoading:o,shouldRefocusPrompt:l,userPrompt:c})=>{const u=Object(i.useRef)(null);Object(i.useEffect)((()=>{l&&u.current&&(null==u||u.current.focus())}),[l]);const d=Object(i.useMemo)((()=>r?"":null!=c?c:""),[r,c]),m=Object(i.useCallback)((()=>{var t,a,n;e(null!==(t=null===(a=u.current)||void 0===a||null===(n=a.value)||void 0===n?void 0:n.trim())&&void 0!==t?t:"")}),[e,u]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none",css:M},Object(p.jsx)(s.EuiFlexItem,null,Object(p.jsx)(I,{onPromptSubmit:n,ref:u,handlePromptChange:a,value:d,isDisabled:r})),Object(p.jsx)(s.EuiFlexItem,{css:C,grow:!1},Object(p.jsx)(O,{onChatCleared:t,isDisabled:r,isLoading:o,onSendMessage:m})))},A=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeTitle",{defaultMessage:"Manage license"}),F=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),P=({basePath:e})=>Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"s",wrap:!0,"data-test-subj":"upgrade-buttons"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},F)),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButton,{href:`${e}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},A))),D=r.a.memo(P);D.displayName="UpgradeButtons";var N={name:"1d3w5wq",styles:"width:100%"},R={name:"1d3w5wq",styles:"width:100%"};const L=({connectorPrompt:e,http:t,isAssistantEnabled:a,isWelcomeSetup:n})=>{const i=t.basePath.get();return a?n?Object(p.jsx)(s.EuiFlexGroup,{css:N},Object(p.jsx)(s.EuiFlexItem,{"data-test-subj":"connector-prompt"},e)):null:Object(p.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround",css:R},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(D,{basePath:i})))};var B=a(47),z=a(179),q=a(496),$=a(220),V=a(177),U=a(252);const H=Object(z.css)({name:"1azv1pg",styles:"height:32px;.euiSuperSelect{width:400px;}.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}.euiFormControlLayoutIcons{right:14px;top:2px;}"}),Q=Object(z.css)({name:"94g3yr",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px"}),G=Object(z.css)({name:"gexgj1",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px;font-weight:normal;padding-bottom:5px;padding-left:0;padding-top:2px"}),W=r.a.memo((({isDisabled:e=!1,selectedConnectorId:t,selectedConversation:a})=>{var r,o;const[l,c]=Object(i.useState)(!1),{actionTypeRegistry:u,assistantAvailability:d,http:m}=Object(n.b)(),{setApiConfig:b}=Object(f.a)(),{data:g}=Object($.a)({http:m}),y=null!==(r=null===(o=Object(i.useMemo)((()=>g?g.map((e=>({...e,connectorTypeTitle:Object(U.a)(u.get(e.actionTypeId))}))):[]),[u,g]).find((e=>e.id===t)))||void 0===o?void 0:o.name)&&void 0!==r?r:V.m,h=e||!d.hasConnectorsReadPrivilege,v=Object(i.useCallback)((()=>{c(!l)}),[l]),E=Object(i.useCallback)((e=>{const t=e.id;if("ADD_NEW_CONNECTOR"===t)return;const n=Object(U.b)(e),i=null==n?void 0:n.apiProvider,r=null==n?void 0:n.defaultModel;c(!1),null!=a&&b({conversationId:a.id,apiConfig:{...a.apiConfig,connectorId:t,connectorTypeTitle:e.connectorTypeTitle,provider:null!=i?i:null==n?void 0:n.apiProvider,model:null!=r?r:null==n?void 0:n.defaultModel}})}),[a,b]);return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",className:H,direction:"row",gutterSize:"xs",justifyContent:"flexStart",responsive:!1},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiText,{size:"xs",color:"subdued"},V.l)),Object(p.jsx)(s.EuiFlexItem,null,l?Object(p.jsx)(q.a,{displayFancy:e=>Object(p.jsx)(s.EuiText,{className:Q,size:"xs"},e),isOpen:!0,isDisabled:h,selectedConnectorId:t,setIsOpen:c,onConnectorSelectionChange:E}):Object(p.jsx)("span",null,Object(p.jsx)(s.EuiButtonEmpty,{className:G,color:"text","data-test-subj":"connectorSelectorPlaceholderButton",iconSide:"right",iconType:"arrowDown",isDisabled:h,onClick:v,size:"xs"},y))))}));W.displayName="ConnectorSelectorInline";const Z={xl:64,l:48,m:32,s:24,xs:16},K=({size:e="s"})=>Object(p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:Z[e],height:Z[e],viewBox:"0 0 64 64",fill:"none"},Object(p.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(p.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(p.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(p.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}));var J={name:"1y0ex1",styles:"max-width:400px"};const Y=({isDisabled:e=!1,title:t,docLinks:a,selectedConversation:n})=>{var r;const o=null==n||null===(r=n.apiConfig)||void 0===r?void 0:r.connectorId,{ELASTIC_WEBSITE_URL:l,DOC_LINK_VERSION:c}=a,u=`${l}guide/en/security/${c}/security-assistant.html`,d=Object(i.useMemo)((()=>Object(p.jsx)(s.EuiLink,{"aria-label":j.h,"data-test-subj":"externalDocumentationLink",external:!0,href:u,target:"_blank"},j.d)),[u]),m=Object(i.useMemo)((()=>Object(p.jsx)(B.FormattedMessage,{defaultMessage:"Responses from AI systems may not always be entirely accurate. For more information on the assistant feature and its usage, please reference the {documentationLink}.",id:"xpack.elasticAssistant.assistant.technicalPreview.tooltipContent",values:{documentationLink:d}})),[d]),[f,b]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>b((e=>!e))),[]),y=Object(i.useCallback)((()=>b(!1)),[]);return Object(p.jsx)(s.EuiModalHeaderTitle,null,Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(K,{"data-test-subj":"titleIcon",size:"m"})),Object(p.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"center"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiTitle,{size:"s"},Object(p.jsx)("h3",null,t))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiPopover,{button:Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.h,"data-test-subj":"tooltipIcon",iconType:"iInCircle",onClick:g}),isOpen:f,closePopover:y,anchorPosition:"rightUp"},Object(p.jsx)(s.EuiText,{"data-test-subj":"tooltipContent",grow:!1,css:J},Object(p.jsx)(s.EuiText,{size:"s"},Object(p.jsx)("p",null,m))))))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(W,{isDisabled:e||void 0===n,selectedConnectorId:o,selectedConversation:n})))))},X=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),ee=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.ariaLabel",{defaultMessage:"Conversation selector"}),te=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.placeholderTitle",{defaultMessage:"Select or type to create new..."}),ae=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),ne=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.previousConversationTitle",{defaultMessage:"Previous conversation"}),ie=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"}),re=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.deleteConversationTitle",{defaultMessage:"Delete conversation"});var se=a(168);const oe=navigator.platform.toLowerCase().indexOf("mac")>=0,le=(e,t)=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1];var ce={name:"1v0pok0",styles:"min-width:300px"},ue={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},de={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},pe={name:"1e5733u",styles:"width:calc(100% - 60px)"};const me=r.a.memo((({selectedConversationId:e=se.a,defaultConnectorId:t,defaultProvider:a,onConversationSelected:r,shouldDisableKeyboardShortcut:o=(()=>!1),isDisabled:c=!1})=>{const{allSystemPrompts:u,conversations:d}=Object(n.b)(),{deleteConversation:m,setConversation:b}=Object(f.a)(),g=Object(i.useMemo)((()=>Object.keys(d)),[d]),y=Object(i.useMemo)((()=>Object.values(d).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id}}))),[d]),[h,v]=Object(i.useState)((()=>{var t;return null!==(t=y.filter((t=>t.label===e)))&&void 0!==t?t:[]})),E=Object(i.useCallback)(((e,n=[])=>{if(!e||!e.trim().toLowerCase())return;const i=e.trim().toLowerCase(),s=u.find((e=>e.isNewConversationDefault));if(-1===n.findIndex((e=>e.label.trim().toLowerCase()===i))){const n={id:e,messages:[],apiConfig:{connectorId:t,provider:a,defaultSystemPromptId:null==s?void 0:s.id}};b({conversation:n})}r(e)}),[u,t,a,b,r]),x=Object(i.useCallback)((t=>{e===t&&r(le(g,t)),setTimeout((()=>{m(t)}),0)}),[g,m,e,r]),j=Object(i.useCallback)((e=>{0===e.length?v([]):-1!==y.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&r(null==e?void 0:e[0].label)}),[y,r]),S=Object(i.useCallback)((()=>{const t=le(g,e);r(t)}),[g,e,r]),O=Object(i.useCallback)((()=>{const t=((e,t)=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(g,e);r(t)}),[g,e,r]),k=Object(i.useCallback)((e=>{c||g.length<=1||("ArrowLeft"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),S()),"ArrowRight"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),O()))}),[g.length,c,S,O,o]);return l()("keydown",k),Object(i.useEffect)((()=>{v(y.filter((t=>t.label===e)))}),[y,e]),Object(p.jsx)(s.EuiFormRow,{label:X,display:"rowCompressed",css:ce},Object(p.jsx)(s.EuiComboBox,{"data-test-subj":"conversation-selector","aria-label":ee,customOptionText:`${ae} {searchValue}`,placeholder:te,singleSelection:{asPlainText:!0},options:y,selectedOptions:h,onChange:j,onCreateOption:E,renderOption:(e,t,a)=>{const{label:n,value:i}=e;return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":`convo-option-${n}`},Object(p.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:pe},Object(p.jsx)(s.EuiHighlight,{search:t,css:de},n)),!(null!=i&&i.isDefault)&&Object(p.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(p.jsx)(s.EuiToolTip,{position:"right",content:re},Object(p.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":re,color:"danger",onClick:e=>{e.stopPropagation(),x(n)},"data-test-subj":"delete-option",css:ue}))))},compressed:!0,isDisabled:c,prepend:Object(p.jsx)(s.EuiToolTip,{content:`${ne} (âŒ˜ + â†)`,display:"block"},Object(p.jsx)(s.EuiButtonIcon,{iconType:"arrowLeft","aria-label":ne,onClick:S,disabled:c||g.length<=1})),append:Object(p.jsx)(s.EuiToolTip,{content:`${ie} (âŒ˜ + â†’)`,display:"block"},Object(p.jsx)(s.EuiButtonIcon,{iconType:"arrowRight","aria-label":ie,onClick:O,disabled:c||g.length<=1}))}))}));me.displayName="ConversationSelector";var fe=a(259),be=a(493);const ge=r.a.memo((({defaultConnectorId:e,defaultProvider:t,isDisabled:a=!1,isSettingsModalVisible:o,setIsSettingsModalVisible:l,selectedConversation:c,setSelectedConversationId:u})=>{const{toasts:d,setSelectedSettingsTab:m}=Object(n.b)(),f=Object(i.useCallback)((()=>{l(!1)}),[l]),b=Object(i.useCallback)((()=>{f()}),[f]),g=Object(i.useCallback)((()=>{f(),null==d||d.addSuccess({iconType:"check",title:be.j})}),[f,d]),y=Object(i.useCallback)((()=>{m(fe.b),l(!0)}),[l,m]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiToolTip,{position:"right",content:be.i},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":be.h,"data-test-subj":"settings",onClick:y,isDisabled:a,iconType:"gear",size:"xs"})),o&&Object(p.jsx)(fe.a,{defaultConnectorId:e,defaultProvider:t,selectedConversation:c,setSelectedConversationId:u,onClose:b,onSave:g}))}));ge.displayName="AssistantSettingsButton";var ye={name:"1h6p4mk",styles:"width:335px"},he={name:"1d3w5wq",styles:"width:100%"};const ve=({currentConversation:e,defaultConnectorId:t,defaultProvider:a,docLinks:n,isDisabled:o,isSettingsModalVisible:l,onConversationSelected:c,onToggleShowAnonymizedValues:u,selectedConversationId:d,setIsSettingsModalVisible:m,setSelectedConversationId:f,shouldDisableKeyboardShortcut:b,showAnonymizedValues:g,title:y})=>{const h=Object(i.useMemo)((()=>null!=e.replacements&&Object.keys(e.replacements).length>0&&g),[e.replacements,g]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiFlexGroup,{css:he,alignItems:"center",justifyContent:"spaceBetween"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(Y,{isDisabled:o,docLinks:n,selectedConversation:e,title:y})),Object(p.jsx)(s.EuiFlexItem,{grow:!1,css:ye},Object(p.jsx)(me,{defaultConnectorId:t,defaultProvider:a,selectedConversationId:d,onConversationSelected:c,shouldDisableKeyboardShortcut:b,isDisabled:o}),Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiSpacer,{size:"s"}),Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:j.f,position:"left",repositionOnScroll:!0},Object(p.jsx)(s.EuiSwitch,{"data-test-subj":"showAnonymizedValues",checked:h,compressed:!0,disabled:null==e.replacements,label:j.e,onChange:u}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(ge,{defaultConnectorId:t,defaultProvider:a,isDisabled:o,isSettingsModalVisible:l,selectedConversation:e,setIsSettingsModalVisible:m,setSelectedConversationId:f})))))),Object(p.jsx)(s.EuiHorizontalRule,{margin:"m"}))};async function Ee({defaultAllow:e,defaultAllowReplacement:t,promptContext:a}){const n=await a.getPromptContext();return"string"==typeof n?{allow:[],allowReplacement:[],promptContextId:a.id,rawData:n}:{allow:[...e],allowReplacement:[...t],promptContextId:a.id,rawData:n}}const xe=u()(s.EuiButton)`
  margin-right: ${({theme:e})=>e.eui.euiSizeXS};
`,je=({defaultAllow:e,defaultAllowReplacement:t,promptContexts:a,selectedPromptContexts:n,setSelectedPromptContexts:r})=>{const o=Object(i.useMemo)((()=>Object(y.sortBy)("description",Object.values(a))),[a]),l=Object(i.useCallback)((async i=>{if(null==n[i]&&null!=a[i]){const n=await Ee({defaultAllow:e,defaultAllowReplacement:t,promptContext:a[i]});r((e=>({...e,[i]:n})))}}),[e,t,a,n,r]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none",wrap:!0},o.map((({description:e,id:t,getPromptContext:a,tooltip:i})=>{const r=Object(p.jsx)(xe,{"data-test-subj":`pillButton-${t}`,disabled:null!=n[t],iconSide:"left",iconType:"plus",onClick:()=>l(t)},e);return Object(p.jsx)(s.EuiFlexItem,{grow:!1,key:t},null!=n[t]?r:Object(p.jsx)(s.EuiToolTip,{content:i},r))})))},Se=r.a.memo(je);var Oe=a(373),ke=a(551),we={name:"1m5oqbf",styles:"white-space:pre-line;&:hover{cursor:pointer;text-decoration:underline;}"};const Te=({conversation:e,editingSystemPromptId:t,isSettingsModalVisible:a,onSystemPromptSelectionChange:o,setIsSettingsModalVisible:l})=>{const{allSystemPrompts:c}=Object(n.b)(),u=Object(i.useMemo)((()=>{var a;return void 0!==t?null!==(a=null==c?void 0:c.find((e=>e.id===t)))&&void 0!==a?a:null==c?void 0:c.find((t=>t.id===(null==e?void 0:e.apiConfig.defaultSystemPromptId))):void 0}),[c,null==e?void 0:e.apiConfig.defaultSystemPromptId,t]),[d,m]=r.a.useState(!1),f=Object(i.useCallback)((()=>{e&&o(void 0)}),[e,o]),b=Object(i.useCallback)((()=>m(!0)),[]);return Object(p.jsx)("div",null,null==u||d?Object(p.jsx)(ke.a,{allSystemPrompts:c,clearSelectedSystemPrompt:f,conversation:e,"data-test-subj":"systemPrompt",isClearable:!0,isEditing:d,isOpen:d,isSettingsModalVisible:a,onSystemPromptSelectionChange:o,selectedPrompt:u,setIsEditing:m,setIsSettingsModalVisible:l}):Object(p.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none"},Object(p.jsx)(s.EuiFlexItem,{grow:!0},Object(p.jsx)(s.EuiText,{color:"subdued","data-test-subj":"systemPromptText",onClick:b,css:we},Object(y.isEmpty)(null==u?void 0:u.content)?Oe.d:null==u?void 0:u.content)),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:Oe.e},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":Oe.e,"data-test-subj":"edit",iconType:"documentEdit",onClick:b}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:Oe.c},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":Oe.c,"data-test-subj":"clear",iconType:"cross",onClick:f})))))))};Te.displayName="SystemPromptComponent";const Ie=r.a.memo(Te),Ce=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.commentsListAriaLabel",{defaultMessage:"List of comments"}),Me=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.editingPromptLabel",{defaultMessage:"editing prompt"}),_e=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.youLabel",{defaultMessage:"You"});var Ae=a(543),Fe=a(494);const Pe=({rawData:e})=>Object(p.jsx)(s.EuiCodeBlock,{"data-test-subj":"readOnlyContextViewer",isCopyable:!0},Object(g.e)(e));Pe.displayName="ReadOnlyContextViewerComponent";const De=r.a.memo(Pe);var Ne=a(552),Re=a(547),Le=a(372);const Be=k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),ze=({total:e})=>{const t=Object(i.useMemo)((()=>(e=>k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(p.jsx)(s.EuiToolTip,{content:t},Object(p.jsx)(s.EuiStat,{"data-test-subj":"availableStat",description:Be,reverse:!0,title:e,titleSize:Le.a}))};ze.displayName="AvailableStatComponent";const qe=r.a.memo(ze),$e=u()(s.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,Ve=({isDataAnonymizable:e,selectedPromptContext:t})=>{const{allowed:a,anonymized:n,total:r}=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:a})=>{const n={allowed:0,anonymized:0,denied:0,total:0};if("string"==typeof a)return n;{const i=Object.keys(a),r=new Set(t),s=new Set(e);return i.reduce(((e,t)=>({allowed:e.allowed+(Object(b.a)({allowSet:s,field:t})?1:0),anonymized:e.anonymized+(Object(b.a)({allowSet:s,field:t})&&Object(b.b)({allowReplacementSet:r,field:t})?1:0),denied:e.denied+(Object(b.c)({allowSet:s,field:t})?1:0),total:e.total+1})),n)}})(t)),[t]);return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(p.jsx)($e,{grow:!1},Object(p.jsx)(Ne.a,{allowed:a,total:r})),Object(p.jsx)($e,{grow:!1},Object(p.jsx)(Re.a,{anonymized:n,isDataAnonymizable:e})),e&&Object(p.jsx)($e,{grow:!1},Object(p.jsx)(qe,{total:r})))};Ve.displayName="StatsComponent";const Ue=r.a.memo(Ve),He=u.a.div`
  overflow-x: auto;
`,Qe=({selectedPromptContext:e,setSelectedPromptContexts:t})=>{const{defaultAllow:a,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l}=Object(n.b)(),c=Object(i.useMemo)((()=>Object(Fe.a)(e.rawData)),[e]),u=Object(i.useCallback)((n=>{const i=n.reduce(((e,{field:t,operation:a,update:n})=>Object(Fe.c)({field:t,operation:a,selectedPromptContext:e,update:n})),e);t((t=>({...t,[e.promptContextId]:i}))),Object(Fe.b)({defaultAllow:a,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l,updates:n})}),[a,r,e,o,l,t]);return Object(p.jsx)(He,{"data-test-subj":"dataAnonymizationEditor"},Object(p.jsx)(Ue,{isDataAnonymizable:c,selectedPromptContext:e}),Object(p.jsx)(s.EuiSpacer,{size:"s"}),"string"==typeof e.rawData?Object(p.jsx)(De,{rawData:e.rawData}):Object(p.jsx)(Ae.a,{allow:e.allow,allowReplacement:e.allowReplacement,onListUpdated:u,rawData:e.rawData}))},Ge=r.a.memo(Qe),We=k.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.selectedPromotContexts.removeContextTooltip",{defaultMessage:"Remove context"}),Ze=u.a.div`
  ${({$accordionState:e})=>"closed"===e?"height: 0px;":""}
  ${({$accordionState:e})=>"closed"===e?"overflow: hidden;":""}
  ${({$accordionState:e})=>"closed"===e?"position: absolute;":""}
`,Ke=({isNewConversation:e,promptContexts:t,selectedPromptContexts:a,setSelectedPromptContexts:n})=>{const[o,l]=r.a.useState("closed"),c=Object(i.useCallback)((()=>l((e=>"open"===e?"closed":"open"))),[]),u=Object(i.useCallback)((e=>{n((t=>Object(y.omit)(e,t)))}),[n]);return Object(y.isEmpty)(t)?null:Object(p.jsx)(s.EuiFlexGroup,{"data-test-subj":"selectedPromptContexts",direction:"column",gutterSize:"none"},Object.keys(a).sort().map((i=>{var r;return Object(p.jsx)(s.EuiFlexItem,{"data-test-subj":`selectedPromptContext-${i}`,grow:!1,key:i},e||Object.keys(a).length>1?Object(p.jsx)(s.EuiSpacer,{"data-test-subj":"spacer"}):null,Object(p.jsx)(s.EuiAccordion,{buttonContent:null===(r=t[i])||void 0===r?void 0:r.description,forceState:o,extraAction:Object(p.jsx)(s.EuiToolTip,{content:We},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":We,"data-test-subj":`removePromptContext-${i}`,iconType:"cross",onClick:()=>u(i)})),id:i,onToggle:c,paddingSize:"s"},Object(p.jsx)(Ze,{$accordionState:o},Object(p.jsx)(Ge,{selectedPromptContext:a[i],setSelectedPromptContexts:n}))))})))},Je=r.a.memo(Ke),Ye=u()(s.EuiText)`
  white-space: pre-line;
`,Xe=({conversation:e,editingSystemPromptId:t,isNewConversation:a,isSettingsModalVisible:n,promptContexts:o,promptTextPreview:l,onSystemPromptSelectionChange:c,selectedPromptContexts:u,setIsSettingsModalVisible:d,setSelectedPromptContexts:m})=>{const f=Object(i.useMemo)((()=>Object(p.jsx)(r.a.Fragment,null,a&&Object(p.jsx)(Ie,{conversation:e,editingSystemPromptId:t,onSystemPromptSelectionChange:c,isSettingsModalVisible:n,setIsSettingsModalVisible:d}),Object(p.jsx)(Je,{isNewConversation:a,promptContexts:o,selectedPromptContexts:u,setSelectedPromptContexts:m}),Object(p.jsx)(Ye,{color:"subdued","data-test-subj":"previewText"},l))),[e,t,a,n,c,o,l,u,d,m]),b=Object(i.useMemo)((()=>[{children:f,event:Object(p.jsx)(s.EuiText,{"data-test-subj":"eventText",size:"xs"},Object(p.jsx)("i",null,Me)),timelineAvatar:Object(p.jsx)(s.EuiAvatar,{"data-test-subj":"userAvatar",name:"user",size:"l",color:"subdued",iconType:"userAvatar"}),timelineAvatarAriaLabel:_e,username:_e}]),[f]);return Object(p.jsx)(s.EuiCommentList,{"aria-label":Ce,comments:b})};Xe.displayName="PromptEditorComponent";const et=r.a.memo(Xe),tt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.addQuickPromptTitle",{defaultMessage:"Add quick prompt..."}),at=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.overflowAriaTitle",{defaultMessage:"Show overflow Quick Prompts"}),nt=(k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),u()(s.EuiFlexGroup)`
  margin: 16px;
`),it=r.a.memo((({setInput:e,setIsSettingsModalVisible:t,trackPrompt:a})=>{const{allQuickPrompts:r,knowledgeBase:o,promptContexts:l,setSelectedSettingsTab:c}=Object(n.b)(),u=Object(i.useMemo)((()=>{const e=Object.values(l).map((e=>e.category));return o.assistantLangChain&&e.push("knowledge-base"),r.filter((t=>null==t.categories||0===t.categories.length||t.categories.some((t=>e.includes(t)))))}),[r,o.assistantLangChain,l]),[d,m]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>m(!d)),[d]),b=Object(i.useCallback)((()=>m(!1)),[]),g=Object(i.useCallback)((t=>{e(t.prompt),t.isDefault?a(t.title):a("Custom")}),[e,a]),y=Object(i.useCallback)((e=>{g(e),b()}),[b,g]),h=Object(i.useCallback)((()=>{t(!0),c(fe.c)}),[t,c]);return Object(p.jsx)(nt,{gutterSize:"s",alignItems:"center"},u.slice(0,5).map(((e,t)=>Object(p.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(p.jsx)(s.EuiBadge,{color:e.color,onClick:()=>g(e),onClickAriaLabel:e.title},e.title)))),u.length>5&&Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiPopover,{button:Object(p.jsx)(s.EuiBadge,{color:"hollow",iconType:"boxesHorizontal",onClick:f,onClickAriaLabel:at}),isOpen:d,closePopover:b,anchorPosition:"rightUp"},Object(p.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},u.slice(5).map(((e,t)=>Object(p.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(p.jsx)(s.EuiBadge,{color:e.color,onClick:()=>y(e),onClickAriaLabel:e.title},e.title))))))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButtonEmpty,{"data-test-subj":"addQuickPrompt",onClick:h,iconType:"plus",size:"xs"},tt)))}));it.displayName="QuickPrompts";var rt=a(548),st=a(549),ot=a(497);const lt=r.a.memo((({text:e,children:t,chunkSize:a=5,delay:n=100,onStreamingComplete:r})=>{const[s,o]=Object(i.useState)(n>0?"":e),[l,c]=Object(i.useState)(null==n||0===n);return Object(i.useEffect)((()=>{0===n&&(null==r||r())}),[]),Object(i.useEffect)((()=>{if(l||0===n)return void o(e);let t=0;c(!1);const i=setInterval((()=>{if(t>=e.length)return null==r||r(),c(!0),void clearInterval(i);const n=e.substring(t,t+a);o((e=>e+n)),t+=a}),n);return()=>{clearInterval(i)}}),[e,a,n,r,l]),t?Object(p.jsx)("div",null,t(s,l)):Object(p.jsx)("div",null,s)}));lt.displayName="StreamingText";var ct=a(73);const ut=r.a.memo((({setIsConnectorModalVisible:e})=>{const{assistantAvailability:t}=Object(n.b)(),a=t.hasConnectorsAllPrivilege?V.d:V.c,r=t.hasConnectorsAllPrivilege?V.a:V.b,o=Object(i.useCallback)((()=>{null==e||e(!0)}),[e]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceAround"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiCard,{"data-test-subj":"connectorButton",layout:"horizontal",icon:Object(p.jsx)(s.EuiIcon,{size:"xl",type:ct.OpenAILogo}),title:a,description:r,onClick:t.hasConnectorsAllPrivilege?o:void 0})))}));ut.displayName="ConnectorButton";const dt=e=>{const{messages:t,...a}=e;return{...a,messages:t.map((e=>{const{presentation:t,...a}=e;return{...a,presentation:void 0}}))}},pt=e=>!e.messages.some((e=>void 0!==e.presentation)),mt=u.a.div`
  margin-bottom: 10px;
`,ft=u()(s.EuiText)`
  margin-top: 20px;
`,bt=r.a.memo((({isConnectorConfigured:e,isSettingsModalVisible:t,setIsSettingsModalVisible:a})=>{const{assistantAvailability:o,setSelectedSettingsTab:l}=Object(n.b)(),c=Object(i.useCallback)((()=>{t||(a(!0),l(fe.b))}),[t,a,l]),u=o.hasConnectorsAllPrivilege||o.hasConnectorsReadPrivilege&&e;return Object(p.jsx)(r.a.Fragment,null,u?Object(p.jsx)(s.EuiCallOut,{"data-test-subj":"connectorMissingCallout",color:"danger",iconType:"controlsVertical",size:"m",title:V.p},Object(p.jsx)("p",null," ",Object(p.jsx)(B.FormattedMessage,{defaultMessage:"Select a connector above or from the {link} to continue",id:"xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutDescription",values:{link:Object(p.jsx)(s.EuiLink,{onClick:c},V.q)}}))):Object(p.jsx)(ut,null))}));bt.displayName="ConnectorMissingCallout";var gt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},yt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},ht={name:"r5hahk",styles:"margin-right:20px"},vt={name:"r5hahk",styles:"margin-right:20px"};const Et=({conversationId:e,embeddedLayout:t=!1,promptContextId:a="",shouldRefocusPrompt:o=!1,showTitle:l=!0,setConversationId:c})=>{var u,y;const{assistantTelemetry:h,augmentMessageCodeBlocks:j,assistantAvailability:{isAssistantEnabled:S},conversations:O,defaultAllow:k,defaultAllowReplacement:w,docLinks:T,getComments:I,http:C,promptContexts:M,setLastConversationId:A,getConversationId:F,title:P,allSystemPrompts:D}=Object(n.b)(),[N,R]=Object(i.useState)({}),B=Object(i.useMemo)((()=>Object.keys(N).length),[N]),{amendMessage:z,createConversation:q}=Object(f.a)(),{data:H,isSuccess:Q}=Object($.a)({http:C}),G=Object(i.useMemo)((()=>{var e;return null===(e=Object(E.b)(H))||void 0===e?void 0:e.id}),[H]),W=Object(i.useMemo)((()=>{var e,t;return null===(e=Object(E.b)(H))||void 0===e||null===(t=e.config)||void 0===t?void 0:t.apiProvider}),[H]),[Z,J]=Object(i.useState)(S?F(e):se.d);Object(i.useEffect)((()=>{c&&c(Z)}),[Z,c]);const Y=Object(i.useMemo)((()=>{var e;return null!==(e=O[Z])&&void 0!==e?e:q({conversationId:Z})}),[O,q,Z]),X=Object(i.useMemo)((()=>{var e;return!Object.keys(O).some((e=>null!=O[e].apiConfig.connectorId))&&0===(null!==(e=null==H?void 0:H.length)&&void 0!==e?e:0)}),[null==H?void 0:H.length,O]),ee=X||!S,te=Object(i.useMemo)((()=>Object(E.a)(Y,S)),[Y,S]),[ae,ne]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(Q&&(null==H||!H.length))return A(se.d);Y.excludeFromLastConversationStorage||A(Y.id)}),[Q,null==H?void 0:H.length,Y,A]);const{comments:ie,prompt:re}=(({conversation:e=st.a,onSetupComplete:t})=>{var a,r,o,l;const{appendMessage:c,setApiConfig:u,setConversation:d}=Object(f.a)(),m=Object(i.useRef)(null),{actionTypeRegistry:b,conversations:g,http:y}=Object(n.b)(),{data:h,isSuccess:v,refetch:E}=Object($.a)({http:y}),x=v&&!(null==h||!h.length),[j,S]=Object(i.useState)(!1),[O,k]=Object(i.useState)((()=>pt(e))),{data:w}=Object(ot.a)({http:y}),[T,I]=Object(i.useState)(null),C=Object(i.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=e.theme)||void 0===a||null===(n=a.user)||void 0===n?void 0:n.name)&&void 0!==t?t:V.k}),[null===(a=e.theme)||void 0===a||null===(r=a.user)||void 0===r?void 0:r.name]),M=Object(i.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=e.theme)||void 0===a||null===(n=a.assistant)||void 0===n?void 0:n.name)&&void 0!==t?t:V.j}),[null===(o=e.theme)||void 0===o||null===(l=o.assistant)||void 0===l?void 0:l.name]),_=Object(i.useMemo)((()=>e.messages.length-1),[e.messages.length]),[A,F]=Object(i.useState)(x||pt(e)?_:0),P=Object(i.useRef)(void 0),D=Object(i.useCallback)((()=>{var t,a,n;if(A!==_)return P.current=window.setTimeout((()=>{var e;return null===(e=m.current)||void 0===e||e.scrollIntoView({block:"end"}),F(A+1)}),null!==(t=null===(a=e.messages[A])||void 0===a||null===(n=a.presentation)||void 0===n?void 0:n.delay)&&void 0!==t?t:0),()=>clearTimeout(P.current);clearTimeout(P.current)}),[e.messages,A,_]),N=Object(i.useCallback)((()=>{var a;k(!0),null===(a=m.current)||void 0===a||a.scrollIntoView({block:"end"}),null==t||t(),d({conversation:dt(e)})}),[e,t,d]),R=Object(i.useCallback)((()=>{F(_)}),[_]),L=Object(i.useCallback)(((t,a,n)=>{var i,r,o;null!=e.messages[a].timestamp&&0!==e.messages[a].timestamp.length||(e.messages[a].timestamp=(new Date).toLocaleString());const l=a===n-1,c=null!==(i=null==t||null===(r=t.presentation)||void 0===r?void 0:r.stream)&&void 0!==i&&i&&A!==n-1;return Object(p.jsx)(lt,{text:null!==(o=t.content)&&void 0!==o?o:"",delay:c?50:0,onStreamingComplete:l?N:D},((e,t)=>Object(p.jsx)(s.EuiText,null,Object(p.jsx)(s.EuiMarkdownFormat,{className:`message-${a}`},e),Object(p.jsx)("span",{ref:m}))))}),[e.messages,A,N,D]),B=Object(i.useMemo)((()=>e.messages.slice(0,A+1).map(((t,a)=>({username:"user"===t.role?C:M,children:L(t,a,e.messages.length),timelineAvatar:Object(p.jsx)(s.EuiAvatar,{name:V.j,size:"l",color:"subdued",iconType:K}),timestamp:`${V.i}: ${t.timestamp}`})))),[M,L,e.messages,A,C]),z=Object(i.useCallback)((t=>{const a=Object(U.b)(t),n=Object(U.a)(b.get(t.actionTypeId));Object.values(g).forEach((e=>{u({conversationId:e.id,apiConfig:{...e.apiConfig,connectorId:t.id,connectorTypeTitle:n,provider:null==a?void 0:a.apiProvider,model:null==a?void 0:a.defaultModel}})})),null==E||E(),S(!1),c({conversationId:e.id,message:{role:"assistant",content:V.g,timestamp:(new Date).toLocaleString()}})}),[b,c,e.id,g,E,u]);return{comments:B,prompt:Object(p.jsx)("div",{"data-test-subj":"prompt"},O&&Object(p.jsx)(mt,null,Object(p.jsx)(ut,{setIsConnectorModalVisible:S})),!O&&Object(p.jsx)(ft,{color:"subdued",size:"xs"},Object(p.jsx)(s.EuiTextAlign,{textAlign:"center"},Object(p.jsx)(s.EuiBadge,{color:"hollow","data-test-subj":"skip-setup-button",onClick:R,onClickAriaLabel:V.h},V.h))),j&&Object(p.jsx)(rt.a,{actionTypeRegistry:b,actionTypes:w,onClose:()=>S(!1),onSaveConnector:z,onSelectActionType:e=>I(e),selectedActionType:T}))}})({conversation:te}),oe=X&&null!==(u=te.theme)&&void 0!==u&&u.title?null===(y=te.theme)||void 0===y?void 0:y.title:P,[le,ce]=Object(i.useState)(""),[ue,de]=Object(i.useState)(!1),[pe,me]=Object(i.useState)(null),[fe,be]=Object(i.useState)(!1),[ge,ye]=Object(i.useState)(!1),[he,xe]=Object(i.useState)(),[je,Oe]=Object(i.useState)(!1);Object(i.useLayoutEffect)((()=>{setTimeout((()=>{xe(j(Y))}),0)}),[j,Y]);const ke=Object(i.useMemo)((()=>ee||fe),[fe,ee]);Object(i.useEffect)((()=>{const e=()=>{const e=document.querySelectorAll(".euiCodeBlock__controls");Oe(e.length>0)};e();const t=new MutationObserver(e);return t.observe(document.body,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[]);const we=Object(i.useRef)(null);Object(i.useEffect)((()=>{var e;const t=null===(e=we.current)||void 0===e?void 0:e.parentElement;t&&(t.scrollTop=t.scrollHeight)}));const Te=(e,t)=>t?Object(p.jsx)("span",{ref:we},e):Object(p.jsx)(r.a.Fragment,null,e),Ie=Object(i.useMemo)((()=>Object(x.b)({allSystemPrompts:D,conversation:Y})),[D,Y]),[Ce,Me]=Object(i.useState)(null==Ie?void 0:Ie.id),_e=Object(i.useCallback)((e=>{var t;J(e),Me(null===(t=Object(x.b)({allSystemPrompts:D,conversation:O[e]}))||void 0===t?void 0:t.id)}),[D,O]),Ae=Object(i.useCallback)((e=>{Me(e)}),[]);[...document.getElementsByClassName("euiCodeBlock")].forEach((e=>e.style.minHeight="75px"));const Fe=Object(i.useCallback)((e=>{null!=ye&&ye(e.target.checked)}),[ye]);Object(i.useEffect)((()=>{if(Y.messages.length||e!==Z)return;if(ue)return;const t=M[a];null!=t&&(de(!0),Object.keys(N).includes(t.id)||(async()=>{const e=await Ee({defaultAllow:k,defaultAllowReplacement:w,promptContext:t});R((a=>({...a,[t.id]:e})))})(),null!=t.suggestedUserPrompt&&me(t.suggestedUserPrompt))}),[Y.messages,M,a,e,Z,N,ue,k,w]),Object(i.useEffect)((()=>{var e;const t=null!==(e=null==H?void 0:H.some((e=>{var t;return e.id===(null===(t=Y.apiConfig)||void 0===t?void 0:t.connectorId)})))&&void 0!==e&&e;be(!t)}),[H,Y]);const Pe=Object(i.useCallback)((()=>null==he?void 0:he.map(((e,t)=>Object(p.jsx)("span",{key:`${t}`},e.map(((e,a)=>{const n=e.getControlContainer,i=null==n?void 0:n();return Object(p.jsx)("span",{key:`${t}+${a}`},i?Object(d.createPortal)(e.button,i):Object(p.jsx)(r.a.Fragment,null))})))))),[he]),{handleButtonSendMessage:De,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:Le,handleRegenerateResponse:Be,isLoading:ze}=(({allSystemPrompts:e,currentConversation:t,editingSystemPromptId:a,http:r,selectedPromptContexts:s,setEditingSystemPromptId:o,setPromptTextPreview:l,setSelectedPromptContexts:c,setUserPrompt:u})=>{const{isLoading:d,sendMessages:p}=(()=>{const{alertsIndexPattern:e,assistantStreamingEnabled:t,defaultAllow:a,defaultAllowReplacement:r,knowledgeBase:s}=Object(n.b)(),[o,l]=Object(i.useState)(!1);return{isLoading:o,sendMessages:Object(i.useCallback)((async({apiConfig:n,http:i,messages:o,onNewReplacements:c,replacements:u})=>{l(!0);try{return await Object(m.b)({alerts:s.alerts,alertsIndexPattern:e,allow:a,allowReplacement:r,apiConfig:n,assistantLangChain:s.assistantLangChain,assistantStreamingEnabled:t,http:i,replacements:u,messages:o,size:s.latestAlerts,onNewReplacements:c})}finally{l(!1)}}),[e,t,a,r,s.alerts,s.assistantLangChain,s.latestAlerts])}})(),{appendMessage:y,appendReplacements:h,clearConversation:j,removeLastMessage:S}=Object(f.a)(),O=Object(i.useCallback)((async n=>{var i;const o=e=>h({conversationId:t.id,replacements:e}),u=e.find((e=>e.id===a)),d=await async function({currentReplacements:e,getAnonymizedValue:t=v,isNewChat:a,onNewReplacements:n,promptText:i,selectedPromptContexts:r,selectedSystemPrompt:s}){var o;const l=Object.keys(r).sort().map((a=>{const i=Object(b.d)({allow:r[a].allow,allowReplacement:r[a].allowReplacement,currentReplacements:e,getAnonymizedValue:t,onNewReplacements:n,rawData:r[a].rawData});return`${Object(g.e)(i)}`}));return{content:`${a?`${null!==(o=null==s?void 0:s.content)&&void 0!==o?o:""}\n\n`:""}${l}\n\n${i}`,role:"user",timestamp:(new Date).toLocaleString()}}({isNewChat:0===t.messages.length,currentReplacements:t.replacements,onNewReplacements:o,promptText:n,selectedPromptContexts:s,selectedSystemPrompt:u}),m=y({conversationId:t.id,message:d});c({}),l("");const f=await p({apiConfig:t.apiConfig,http:r,messages:m,onNewReplacements:o,replacements:null!==(i=t.replacements)&&void 0!==i?i:{}}),x=Object(E.d)(f);y({conversationId:t.id,message:x})}),[e,y,h,t.apiConfig,t.id,t.messages.length,t.replacements,a,r,s,p,l,c]),k=Object(i.useCallback)((async()=>{var e;const a=S(t.id),n=await p({apiConfig:t.apiConfig,http:r,messages:a,onNewReplacements:e=>h({conversationId:t.id,replacements:e}),replacements:null!==(e=t.replacements)&&void 0!==e?e:{}}),i=Object(E.d)(n);y({conversationId:t.id,message:i})}),[y,h,t.apiConfig,t.id,t.replacements,r,S,p]);return{handleButtonSendMessage:Object(i.useCallback)((e=>{O(e),u("")}),[O,u]),handleOnChatCleared:Object(i.useCallback)((()=>{var a;const n=null===(a=Object(x.b)({allSystemPrompts:e,conversation:t}))||void 0===a?void 0:a.id;l(""),u(""),c({}),j(t.id),o(n)}),[e,j,t,o,l,c,u]),handlePromptChange:e=>{l(e),u(e)},handleSendMessage:O,handleRegenerateResponse:k,isLoading:d}})({allSystemPrompts:D,currentConversation:Y,setPromptTextPreview:ce,setUserPrompt:me,editingSystemPromptId:Ce,http:C,setEditingSystemPromptId:Me,selectedPromptContexts:N,setSelectedPromptContexts:R}),qe=Object(i.useMemo)((()=>Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiCommentList,{comments:I({currentConversation:Y,showAnonymizedValues:ge,amendMessage:z,regenerateMessage:Be,isFetchingResponse:ze}),css:vt}),0!==Y.messages.length&&B>0&&Object(p.jsx)(s.EuiSpacer,{size:"m"}),(0===Y.messages.length||B>0)&&Object(p.jsx)(et,{conversation:Y,editingSystemPromptId:Ce,isNewConversation:0===Y.messages.length,isSettingsModalVisible:ae,promptContexts:M,promptTextPreview:le,onSystemPromptSelectionChange:Ae,selectedPromptContexts:N,setIsSettingsModalVisible:ne,setSelectedPromptContexts:R}))),[z,Y,Ce,I,Ae,Be,ze,ae,M,le,N,B,ge]),$e=Object(i.useMemo)((()=>ee?Object(p.jsx)(s.EuiCommentList,{comments:ie,css:ht}):qe),[ie,ee,qe]),Ve=Object(i.useCallback)((e=>{null==h||h.reportAssistantQuickPrompt({conversationId:Z,promptTitle:e})}),[h,Z]);return Te(Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiModalHeader,{css:yt},l&&Object(p.jsx)(ve,{currentConversation:Y,defaultConnectorId:G,defaultProvider:W,docLinks:T,isDisabled:ee,isSettingsModalVisible:ae,onConversationSelected:_e,onToggleShowAnonymizedValues:Fe,selectedConversationId:Z,setIsSettingsModalVisible:ne,setSelectedConversationId:J,showAnonymizedValues:ge,title:oe}),Pe(),!ee&&Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(Se,{defaultAllow:k,defaultAllowReplacement:w,promptContexts:M,selectedPromptContexts:N,setSelectedPromptContexts:R}),Object.keys(M).length>0&&Object(p.jsx)(s.EuiSpacer,{size:"s"}))),Object(p.jsx)(s.EuiModalBody,null,Te(Object(p.jsx)(r.a.Fragment,null,$e,!ee&&fe&&Q&&Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiSpacer,null),Object(p.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(bt,{isConnectorConfigured:(null==H?void 0:H.length)>0,isSettingsModalVisible:ae,setIsSettingsModalVisible:ne}))))),!t)),Object(p.jsx)(s.EuiModalFooter,{css:gt},Object(p.jsx)(L,{connectorPrompt:re,http:C,isAssistantEnabled:S,isWelcomeSetup:X}),Object(p.jsx)(_,{isDisabled:ke,shouldRefocusPrompt:o,userPrompt:pe,handleButtonSendMessage:De,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:Le,handleRegenerateResponse:Be,isLoading:ze}),!ee&&Object(p.jsx)(it,{setInput:me,setIsSettingsModalVisible:ne,trackPrompt:Ve}))),t)};Et.displayName="AssistantComponent";const xt=r.a.memo(Et),jt=navigator.platform.toLowerCase().indexOf("mac")>=0,St=u()(s.EuiModal)`
  ${({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`}
  min-width: 95vw;
  min-height: 25vh;
`,Ot=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),[a,s]=Object(i.useState)(se.d),[o,c]=Object(i.useState)(),{assistantTelemetry:u,setShowAssistantOverlay:d,getConversationId:m}=Object(n.b)(),f=Object(i.useCallback)((()=>({showOverlay:e,promptContextId:a,conversationId:n})=>{const i=m(n);e&&(null==u||u.reportAssistantInvoked({conversationId:i,invokedBy:"click"})),t(e),c(a),s(i)}),[u,m]);Object(i.useEffect)((()=>{d(f)}),[d,f]);const b=Object(i.useCallback)((()=>{e||(s(m()),null==u||u.reportAssistantInvoked({invokedBy:"shortcut",conversationId:m()})),t(!e)}),[u,e,m]),g=Object(i.useCallback)((e=>{";"===e.key&&(jt?e.metaKey:e.ctrlKey)&&(e.preventDefault(),b())}),[b]);l()("keydown",g);const y=Object(i.useCallback)((()=>{t(!1),c(void 0),s(a)}),[a]),h=Object(i.useCallback)((()=>{y()}),[y]);return Object(p.jsx)(r.a.Fragment,null,e&&Object(p.jsx)(St,{onClose:h,"data-test-subj":"ai-assistant-modal"},Object(p.jsx)(xt,{conversationId:a,promptContextId:o})))}));Ot.displayName="AssistantOverlay";var kt=a(492);const wt=(e,t,a,r,s,o,l)=>{const c=Object(i.useMemo)((()=>e),[e]),u=Object(i.useMemo)((()=>a),[a]),d=Object(i.useMemo)((()=>r),[r]),p=Object(i.useMemo)((()=>null!=s?s:Object(kt.a)()),[s]),m=Object(i.useMemo)((()=>null!=o?o:void 0),[o]),f=Object(i.useMemo)((()=>l),[l]),{registerPromptContext:b,showAssistantOverlay:g,unRegisterPromptContext:y}=Object(n.b)(),h=Object(i.useCallback)((e=>{null!=p&&g({showOverlay:e,promptContextId:p,conversationId:null!=t?t:void 0})}),[g,t,p]);return Object(i.useEffect)((()=>(y(p),b({category:c,description:u,getPromptContext:d,id:p,suggestedUserPrompt:m,tooltip:f}),()=>y(p))),[c,u,d,m,f,p,b,y]),{promptContextId:p,showAssistantOverlay:h}},Tt=k.i18n.translate("xpack.elasticAssistant.assistant.newChat.newChatButton",{defaultMessage:"Chat"}),It=({category:e,color:t="primary",children:a=Tt,conversationId:n,description:r,getPromptContext:o,iconType:l,promptContextId:c,suggestedUserPrompt:u,tooltip:d})=>{const{showAssistantOverlay:m}=wt(e,null!=n?n:null,r,o,null!=c?c:null,u,d),f=Object(i.useCallback)((()=>{m(!0)}),[m]),b=Object(i.useMemo)((()=>{if(null!==l)return null!=l?l:"discuss"}),[l]);return Object(i.useMemo)((()=>Object(p.jsx)(s.EuiButtonEmpty,{color:t,"data-test-subj":"newChat",onClick:f,iconType:b},a)),[a,b,f,t])};It.displayName="NewChatComponent";const Ct=r.a.memo(It),Mt=k.i18n.translate("xpack.elasticAssistant.assistant.newChatById.newChatByIdButton",{defaultMessage:"Chat"}),_t=({children:e=Mt,conversationId:t,iconType:a,promptContextId:r,iconOnly:o=!1})=>{const{showAssistantOverlay:l}=Object(n.b)(),c=Object(i.useCallback)((()=>l({conversationId:t,promptContextId:r,showOverlay:!0})),[t,r,l]),u=Object(i.useMemo)((()=>{if(null!==a)return null!=a?a:"discuss"}),[a]);return Object(i.useMemo)((()=>o?Object(p.jsx)(s.EuiToolTip,{content:Mt},Object(p.jsx)(s.EuiButtonIcon,{"data-test-subj":"newChatById",iconType:null!=u?u:"discuss",onClick:c,color:"text","aria-label":Mt})):Object(p.jsx)(s.EuiButtonEmpty,{"data-test-subj":"newChatById",iconType:u,onClick:c,"aria-label":Mt},e)),[e,u,c,o])};_t.displayName="NewChatByIdComponent";const At=r.a.memo(_t);k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."}),k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return b})),a.d(t,"b",(function(){return h}));var n={};a.r(n),a.d(n,"registerProvider",(function(){return o})),a.d(n,"unRegisterProvider",(function(){return l})),a.d(n,"noProviderFound",(function(){return c}));var i={};a.r(i),a.d(i,"getDataProvidersSelector",(function(){return p}));var r=a(26);const s=a.n(r)()("x-pack/security_solution/local/drag_and_drop"),o=s("REGISTER_PROVIDER"),l=s("UNREGISTER_PROVIDER"),c=s("NO_PROVIDER_FOUND");var u=a(57);const d=e=>e.dragAndDrop.dataProviders,p=()=>Object(u.createSelector)(d,(e=>e));var m=a(45),f=a(187);const b={dataProviders:{}},g=({provider:e,dataProviders:t})=>({...t,[e.id]:e}),y=({id:e,dataProviders:t})=>Object(m.omit)(e,t),h=Object(f.reducerWithInitialState)(b).case(o,((e,{provider:t})=>({...e,dataProviders:g({provider:t,dataProviders:e.dataProviders})}))).case(l,((e,{id:t})=>({...e,dataProviders:y({id:t,dataProviders:e.dataProviders})}))).build()},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(204);const i="not-filtered",r=[{columnHeaderType:i,id:"@timestamp",initialWidth:n.b,esTypes:["date"],type:"date"},{columnHeaderType:i,id:"message",initialWidth:n.a},{columnHeaderType:i,id:"event.category",initialWidth:n.a},{columnHeaderType:i,id:"event.action",initialWidth:n.a},{columnHeaderType:i,id:"host.name",initialWidth:n.a},{columnHeaderType:i,id:"source.ip",initialWidth:n.a},{columnHeaderType:i,id:"destination.ip",initialWidth:n.a},{columnHeaderType:i,id:"user.name",initialWidth:n.a}]},function(e,t,a){"use strict";a.d(t,"J",(function(){return i})),a.d(t,"A",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"W",(function(){return o})),a.d(t,"r",(function(){return l})),a.d(t,"t",(function(){return c})),a.d(t,"s",(function(){return u})),a.d(t,"u",(function(){return d})),a.d(t,"p",(function(){return p})),a.d(t,"q",(function(){return m})),a.d(t,"m",(function(){return f})),a.d(t,"w",(function(){return b})),a.d(t,"x",(function(){return g})),a.d(t,"v",(function(){return y})),a.d(t,"n",(function(){return h})),a.d(t,"o",(function(){return v})),a.d(t,"i",(function(){return E})),a.d(t,"h",(function(){return x})),a.d(t,"j",(function(){return j})),a.d(t,"g",(function(){return S})),a.d(t,"e",(function(){return O})),a.d(t,"f",(function(){return k})),a.d(t,"d",(function(){return w})),a.d(t,"C",(function(){return T})),a.d(t,"I",(function(){return I})),a.d(t,"c",(function(){return C})),a.d(t,"B",(function(){return M})),a.d(t,"H",(function(){return _})),a.d(t,"b",(function(){return A})),a.d(t,"G",(function(){return F})),a.d(t,"y",(function(){return P})),a.d(t,"z",(function(){return D})),a.d(t,"L",(function(){return N})),a.d(t,"k",(function(){return R})),a.d(t,"l",(function(){return L})),a.d(t,"F",(function(){return B})),a.d(t,"K",(function(){return z})),a.d(t,"M",(function(){return q})),a.d(t,"N",(function(){return $})),a.d(t,"V",(function(){return V})),a.d(t,"O",(function(){return U})),a.d(t,"P",(function(){return H})),a.d(t,"U",(function(){return Q})),a.d(t,"S",(function(){return G})),a.d(t,"R",(function(){return W})),a.d(t,"Q",(function(){return Z})),a.d(t,"T",(function(){return K})),a.d(t,"E",(function(){return J})),a.d(t,"D",(function(){return Y}));var n=a(5);n.i18n.translate("xpack.securitySolution.detectionEngine.pageTitle",{defaultMessage:"Detection engine"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.documentTypeTitle",{defaultMessage:"Alerts"});const i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openAlertsTitle",{defaultMessage:"Open"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertsTitle",{defaultMessage:"Closed"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertsTitle",{defaultMessage:"Acknowledged"}),o=(n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.loadingAlertsTitle",{defaultMessage:"Loading Alerts"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.totalCountOfAlertsTitle",{defaultMessage:"alerts"})),l=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleTitle",{defaultMessage:"Rule"}),c=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleNameTitle",{defaultMessage:"Rule name"}),u=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleDescriptionTitle",{defaultMessage:"Rule description"}),d=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.severityTitle",{defaultMessage:"Severity"}),p=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.reasonTitle",{defaultMessage:"Reason"}),m=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.riskScoreTitle",{defaultMessage:"Risk Score"}),f=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.assigneesTitle",{defaultMessage:"Assignees"}),b=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCount",{defaultMessage:"Event Count"}),g=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdTerms",{defaultMessage:"Threshold Terms"}),y=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCardinality",{defaultMessage:"Event Cardinality"}),h=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTerms",{defaultMessage:"New Terms"}),v=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTermsFields",{defaultMessage:"New Terms fields"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineTitle",{defaultMessage:"Investigate in timeline"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.cannotInvestigateInTimelineTitle",{defaultMessage:"Please navigate to a page with timeline to investigate"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineAriaLabel",{defaultMessage:"Send alert to timeline"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addException",{defaultMessage:"Add rule exception"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter",{defaultMessage:"Add Endpoint event filter"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter.disabled.tooltip",{defaultMessage:"Endpoint event filters can be created from the Events section of the Hosts page."}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEndpointException",{defaultMessage:"Add Endpoint exception"}),T=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),I=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.alertDurationTitle",{defaultMessage:"Alert duration"}),e=>n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."})),C=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),M=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),_=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),A=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),F=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.moreActionsAriaLabel",{defaultMessage:"More actions"}),P=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.statusTitle",{defaultMessage:"Status"}),n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.changeAlertStatus",{defaultMessage:"Change alert status"})),D=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.clickToChangeAlertStatus",{defaultMessage:"Click to change alert status"}),N=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overviewTable.signalStatusTitle",{defaultMessage:"Status"}),R=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.triggeredTitle",{defaultMessage:"Triggered"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCase",{defaultMessage:"Add to existing case"})),L=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),B=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addBulkToTimeline",{defaultMessage:"Investigate in timeline"}),z=n.i18n.translate("xpack.securitySolution.sessionsView.sessionsTitle",{defaultMessage:"Sessions"}),q=(n.i18n.translate("xpack.securitySolution.detectionEngine.groups.additionalActions.takeAction",{defaultMessage:"Take actions"}),n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.alertsCount",{defaultMessage:"Alerts:"})),$=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.hostsCount",{defaultMessage:"Hosts:"}),V=(n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.ipsCount",{defaultMessage:"IP's:"}),n.i18n.translate("xpack.securitySolution.detectionEngine.selectGroup.title",{defaultMessage:"Group alerts by"}),n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.usersCount",{defaultMessage:"Users:"})),U=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.rulesCount",{defaultMessage:"Rules:"}),H=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity",{defaultMessage:"Severity:"}),Q=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.multi",{defaultMessage:"Multi"}),G=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.low",{defaultMessage:"Low"}),W=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.high",{defaultMessage:"High"}),Z=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.critical",{defaultMessage:"Critical"}),K=n.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.medium",{defaultMessage:"Medium"}),J=n.i18n.translate("xpack.securitySolution.detectionsEngine.grouping.inspectTitle",{defaultMessage:"Grouping query"}),Y={timestamp:n.i18n.translate("xpack.securitySolution.EventRenderedView.timestampTitle.column",{defaultMessage:"Timestamp"}),rule:n.i18n.translate("xpack.securitySolution.EventRenderedView.ruleTitle.column",{defaultMessage:"Rule"}),eventSummary:n.i18n.translate("xpack.securitySolution.EventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"})}},function(e,t,a){"use strict";a.d(t,"l",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"m",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"n",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"o",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"j",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"q",(function(){return g})),a.d(t,"p",(function(){return y})),a.d(t,"g",(function(){return h})),a.d(t,"h",(function(){return v})),a.d(t,"a",(function(){return E}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=n.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),s=n.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=n.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=n.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),c=n.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),u=n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),b=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),g=e=>n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>n.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),h=n.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),v=e=>n.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),E=n.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(17),s=a(44);const o=a.n(s)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-s548fn-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),l=Object(n.memo)((({children:e,inline:t=!1,textColor:a="default",bold:n=!1})=>i.a.createElement(o,{size:"relative",color:a,className:t?"eui-displayInline":""},n?i.a.createElement("strong",null,e):e)));l.displayName="ConsoleCodeBlock"},function(e,t,a){"use strict";a.d(t,"B",(function(){return r})),a.d(t,"C",(function(){return s})),a.d(t,"D",(function(){return o})),a.d(t,"v",(function(){return l})),a.d(t,"r",(function(){return u})),a.d(t,"q",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"w",(function(){return f})),a.d(t,"x",(function(){return b})),a.d(t,"f",(function(){return g})),a.d(t,"s",(function(){return y})),a.d(t,"z",(function(){return h})),a.d(t,"p",(function(){return v})),a.d(t,"t",(function(){return E})),a.d(t,"y",(function(){return x})),a.d(t,"o",(function(){return j})),a.d(t,"n",(function(){return S})),a.d(t,"A",(function(){return O})),a.d(t,"e",(function(){return k})),a.d(t,"c",(function(){return w})),a.d(t,"b",(function(){return T})),a.d(t,"a",(function(){return I})),a.d(t,"d",(function(){return C})),a.d(t,"i",(function(){return M})),a.d(t,"h",(function(){return _})),a.d(t,"j",(function(){return A})),a.d(t,"k",(function(){return F})),a.d(t,"m",(function(){return P})),a.d(t,"l",(function(){return D}));var n=a(70),i=a(186);const r="logs-endpoint.events.*",s="metrics-endpoint.metadata_current_*",o="endpoint.metadata_current-default",l=".metrics-endpoint.metadata_united_default",c=(Object(n.getFileMetadataIndexName)("endpoint"),Object(n.getFileDataIndexName)("endpoint"),"/api/endpoint"),u=`${c}/metadata`,d=`${u}/{id}`,p=`${c}/metadata/transforms`,m=`${c}/policy_response`,f=`${c}/protection_updates_note/{package_policy_id}`,b=`${c}/suggestions/{suggestion_type}`,g=`${c}/action`,y=`${g}/isolate`,h=`${g}/unisolate`,v=`${g}/running_procs`,E=`${g}/kill_process`,x=`${g}/suspend_process`,j=`${g}/get_file`,S=`${g}/execute`,O=`${g}/upload`,k=`${c}/action_status`,w=`${g}/{action_id}`,T=`${g}/{action_id}/file/{file_id}`,I=`${g}/{action_id}/file/{file_id}/download`,C=`${g}/state`,M=i.a.ENROLLED_AT,_="desc",A={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},F="endpointFields",P="endpointSearchStrategy",D="endpointPackagePoliciesStatsStrategy"},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(2),i=a.n(n),r=a(124),s=a(901),o=a(491),l=a(394),c=a(211),u=a(428);const d=Object(n.createContext)(void 0),p=Object(n.memo)((({id:e,indexName:t,scopeId:a,children:p})=>{const{browserFields:m,dataAsNestedObject:f,dataFormattedForFieldBrowser:b,getFieldsData:g,loading:y,searchHit:h}=Object(s.a)({eventId:e,indexName:t}),{ruleId:v}=Object(c.b)(b),{rule:E}=Object(u.a)(v),x=Object(n.useMemo)((()=>{var n,i;return e&&t&&a&&f&&b&&h?{eventId:e,indexName:t,scopeId:a,browserFields:m,dataAsNestedObject:f,dataFormattedForFieldBrowser:b,searchHit:h,investigationFields:null!==(n=null==E||null===(i=E.investigation_fields)||void 0===i?void 0:i.field_names)&&void 0!==n?n:[],getFieldsData:g,isPreview:a===r.e.rulePreview}:void 0}),[e,t,a,m,f,b,h,null==E?void 0:E.investigation_fields,g]);return y?i.a.createElement(l.a,null):x?i.a.createElement(d.Provider,{value:x},p):i.a.createElement(o.a,null)}));p.displayName="LeftPanelProvider";const m=()=>{const e=Object(n.useContext)(d);if(!e)throw new Error("LeftPanelContext can only be used within LeftPanelContext provider");return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(698);const r=()=>Object(n.useContext)(i.a)},function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"g",(function(){return f})),a.d(t,"a",(function(){return b}));var n=a(60),i=a(310),r=a(15),s=a(49),o=a(2),l=a(129);const c=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,u=e=>e.substring(1),d=(e,t)=>{const a=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(a)?a[0]:a},p=e=>Object(o.useCallback)((()=>{const t=d(u(window.location.search),e);return Object(n.safeDecode)(null!=t?t:"")}),[e]),m=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),f=()=>{const e=Object(s.useHistory)();return Object(o.useCallback)((t=>{const a=window.location.search,r=Object(i.parse)(a,{sort:!1});Object.keys(t).forEach((e=>{const a=t[e];if(null!=a&&""!==a)try{r[e]=Object(n.encode)(a)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const s=m(r);u(a)!==s&&e.replace({search:s})}),[e])},b=()=>{window.history.pushState({},"",window.location.href)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r}));const n=180,i=70,r=190},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(23),i=a.n(n),r=a(59),s=a.n(r),o=a(2),l=a.n(o),c=a(44),u=a.n(c),d=a(189),p=a(214);const m=u.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);m.displayName="Wrapper";const f=({children:e,className:t,style:a,noPadding:n,noTimeline:r,...c})=>{const{globalFullScreen:u,setGlobalFullScreen:f}=Object(d.a)();Object(o.useEffect)((()=>{f(!1)}),[f]);const b=s()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":n,"securitySolutionWrapper--withTimeline":!r,"securitySolutionWrapper--fullHeight":u});return l.a.createElement(m,i()({className:b,style:a},c),e,l.a.createElement(p.a,null))},b=l.a.memo(f)},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,a){"use strict";a.r(t),a.d(t,"updateNote",(function(){return r})),a.d(t,"addNotes",(function(){return s})),a.d(t,"deleteNote",(function(){return o})),a.d(t,"addError",(function(){return l})),a.d(t,"removeError",(function(){return c})),a.d(t,"addErrorHash",(function(){return u}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/local/app"),r=i("UPDATE_NOTE"),s=i("ADD_NOTE"),o=i("DELETE_NOTE"),l=i("ADD_ERRORS"),c=i("REMOVE_ERRORS"),u=i("ADD_ERROR_HASH")},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(45);const i=e=>Object(n.isString)(e)?e:JSON.stringify(e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(749);const r=()=>Object(n.useContext)(i.a)},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(45),i=a(2),r=a.n(i),s=a(262),o=a(322);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},c=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},u=Object(i.createContext)([l,()=>n.noop]),d=()=>Object(i.useContext)(u),p=({children:e})=>r.a.createElement(u.Provider,{value:Object(i.useReducer)(c,l)},e),m=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:a,hasIndexMaintenance:n,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,loading:f,signalIndexName:b,signalIndexMappingOutdated:g},y]=d(),{loading:h,isAuthenticated:v,hasEncryptionKey:E,hasIndexManage:x,hasIndexMaintenance:j,hasIndexUpdateDelete:S,hasIndexWrite:O,hasIndexRead:k,hasKibanaCRUD:w,hasKibanaREAD:T}=Object(s.a)(),{loading:I,signalIndexExists:C,signalIndexName:M,signalIndexMappingOutdated:_,createDeSignalIndex:A}=Object(o.a)();return Object(i.useEffect)((()=>{f||e===w||y({type:"updateCanUserCRUD",canUserCRUD:w})}),[y,f,e,w]),Object(i.useEffect)((()=>{f||t===T||y({type:"updateCanUserREAD",canUserREAD:T})}),[y,f,t,T]),Object(i.useEffect)((()=>{f!==(h||I)&&y({type:"updateLoading",loading:h||I})}),[y,f,h,I]),Object(i.useEffect)((()=>{f||a===x||null==x||y({type:"updateHasIndexManage",hasIndexManage:x})}),[y,f,a,x]),Object(i.useEffect)((()=>{f||r===O||null==O||y({type:"updateHasIndexWrite",hasIndexWrite:O})}),[y,f,r,O]),Object(i.useEffect)((()=>{f||l===k||null==k||y({type:"updateHasIndexRead",hasIndexRead:k})}),[y,f,l,k]),Object(i.useEffect)((()=>{f||c===S||null==S||y({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:S})}),[y,f,c,S]),Object(i.useEffect)((()=>{f||n===j||null==j||y({type:"updateHasIndexMaintenance",hasIndexMaintenance:j})}),[y,f,n,j]),Object(i.useEffect)((()=>{f||u===C||null==C||y({type:"updateIsSignalIndexExists",isSignalIndexExists:C})}),[y,f,u,C]),Object(i.useEffect)((()=>{f||p===v||null==v||y({type:"updateIsAuthenticated",isAuthenticated:v})}),[y,f,p,v]),Object(i.useEffect)((()=>{f||m===E||null==E||y({type:"updateHasEncryptionKey",hasEncryptionKey:E})}),[y,f,m,E]),Object(i.useEffect)((()=>{f||b===M||null==M||y({type:"updateSignalIndexName",signalIndexName:M})}),[y,f,b,M]),Object(i.useEffect)((()=>{f||g===_||null==_||y({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:_})}),[y,f,g,_]),Object(i.useEffect)((()=>{p&&m&&a&&(null!=u&&!u||null!=g&&g)&&null!=A&&A()}),[A,p,m,u,a,g]),{loading:f,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,canUserCRUD:e,canUserREAD:t,hasIndexManage:a,hasIndexMaintenance:n,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,signalIndexName:b,signalIndexMappingOutdated:g}}},function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"g",(function(){return f}));var n=a(17),i=a(44),r=a.n(i);const s=r.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);s.displayName="SecuritySolutionAppWrapper";const o=()=>Object(i.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),l=Object(i.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),c=r()(n.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));c.displayName="DescriptionListStyled";const u=r()(n.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);u.displayName="CountBadge";const d=r.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const p=r()(n.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);p.displayName="Badge";const m=r()(n.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);m.displayName="MoreRowItems";const f=r()(n.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));f.displayName="OverviewWrapper"},function(e,t,a){"use strict";a.d(t,"C",(function(){return i})),a.d(t,"q",(function(){return r})),a.d(t,"v",(function(){return s})),a.d(t,"l",(function(){return o})),a.d(t,"o",(function(){return l})),a.d(t,"p",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"B",(function(){return p})),a.d(t,"r",(function(){return m})),a.d(t,"u",(function(){return f})),a.d(t,"y",(function(){return b})),a.d(t,"k",(function(){return g})),a.d(t,"E",(function(){return y})),a.d(t,"w",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"x",(function(){return E})),a.d(t,"z",(function(){return x})),a.d(t,"t",(function(){return j})),a.d(t,"s",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"c",(function(){return k})),a.d(t,"F",(function(){return w})),a.d(t,"g",(function(){return T})),a.d(t,"A",(function(){return I})),a.d(t,"D",(function(){return C})),a.d(t,"e",(function(){return M})),a.d(t,"d",(function(){return _})),a.d(t,"f",(function(){return A})),a.d(t,"i",(function(){return F})),a.d(t,"h",(function(){return P})),a.d(t,"j",(function(){return D}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=n.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),s=n.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),c=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),u=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=n.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=n.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=n.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),b=n.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),g=n.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),y=n.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),h=(n.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),n.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),v=n.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),E=n.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),x=n.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),j=n.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),S=n.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),O=n.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),k=n.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=n.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),T=Object.freeze({tried:e=>n.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>n.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>n.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>n.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),I=n.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),C=n.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),M=n.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>n.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),A=n.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),F=n.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),P=e=>n.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),D=n.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},,function(e,t,a){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!b(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&f))+":"+e,a=n.get(t);if(a)return a;const i=this.options.loose,o=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(o,I(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),s("comparator trim",e),e=e.replace(l[c.TILDETRIM],d),s("tilde trim",e),e=e.replace(l[c.CARETTRIM],p),s("caret trim",e);let g=e.split(" ").map((e=>h(e,this.options))).join(" ").split(/\s+/).map((e=>T(e,this.options)));i&&(g=g.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),s("range list",g);const y=new Map,v=g.map((e=>new r(e,this.options)));for(const e of v){if(b(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const E=[...y.values()];return n.set(t,E),E}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((a=>y(a,t)&&e.set.some((e=>y(e,t)&&a.every((a=>e.every((e=>a.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const n=new(a(1247))({max:1e3}),i=a(412),r=a(540),s=a(314),o=a(173),{safeRe:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=a(316),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:f}=a(315),b=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,y=(e,t)=>{let a=!0;const n=e.slice();let i=n.pop();for(;a&&n.length;)a=n.every((e=>i.intersects(e,t))),i=n.pop();return a},h=(e,t)=>(s("comp",e,t),e=j(e,t),s("caret",e),e=E(e,t),s("tildes",e),e=O(e,t),s("xrange",e),e=w(e,t),s("stars",e),e),v=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{const a=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(a,((t,a,n,i,r)=>{let o;return s("tilde",e,t,a,n,i,r),v(a)?o="":v(n)?o=`>=${a}.0.0 <${+a+1}.0.0-0`:v(i)?o=`>=${a}.${n}.0 <${a}.${+n+1}.0-0`:r?(s("replaceTilde pr",r),o=`>=${a}.${n}.${i}-${r} <${a}.${+n+1}.0-0`):o=`>=${a}.${n}.${i} <${a}.${+n+1}.0-0`,s("tilde return",o),o}))},j=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{s("caret",e,t);const a=t.loose?l[c.CARETLOOSE]:l[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(a,((t,a,i,r,o)=>{let l;return s("caret",e,t,a,i,r,o),v(a)?l="":v(i)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:v(r)?l="0"===a?`>=${a}.${i}.0${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.0${n} <${+a+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===a?"0"===i?`>=${a}.${i}.${r}-${o} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}-${o} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r}-${o} <${+a+1}.0.0-0`):(s("no pr"),l="0"===a?"0"===i?`>=${a}.${i}.${r}${n} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r} <${+a+1}.0.0-0`),s("caret return",l),l}))},O=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>k(e,t))).join(" ")),k=(e,t)=>{e=e.trim();const a=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(a,((a,n,i,r,o,l)=>{s("xRange",e,a,n,i,r,o,l);const c=v(i),u=c||v(r),d=u||v(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",c?a=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(r=0),o=0,">"===n?(n=">=",u?(i=+i+1,r=0,o=0):(r=+r+1,o=0)):"<="===n&&(n="<",u?i=+i+1:r=+r+1),"<"===n&&(l="-0"),a=`${n+i}.${r}.${o}${l}`):u?a=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(a=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),s("xRange return",a),a}))},w=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),T=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),I=e=>(t,a,n,i,r,s,o,l,c,u,d,p,m)=>`${a=v(n)?"":v(i)?`>=${n}.0.0${e?"-0":""}`:v(r)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${a}`:`>=${a}${e?"-0":""}`} ${l=v(c)?"":v(u)?`<${+c+1}.0.0-0`:v(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),C=(e,t,a)=>{for(let a=0;a<e.length;a++)if(!e[a].test(t))return!1;if(t.prerelease.length&&!a.includePrerelease){for(let a=0;a<e.length;a++)if(s(e[a].semver),e[a].semver!==r.ANY&&e[a].semver.prerelease.length>0){const n=e[a].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,a){"use strict";a.d(t,"b",(function(){return I})),a.d(t,"a",(function(){return C}));var n=a(144),i=a(157),r=a(48),s=a(2),o=a(119),l=a(110),c=a(128),u=a(138),d=a(45),p=a(130),m=a(335),f=a(360);var b=a(235),g=a.n(b),y=a(203),h=a(202);var v=a(60),E=a(151),x=a(162),j=a(118),S=a(112),O=a(49);const k=({search:e,urlKey:t})=>Object(y.c)(Object(y.d)(e),t);var w=a(124),T=a(4);const I=()=>{Object(i.c)(),(()=>{const e=Object(r.useDispatch)(),{filterManager:t,savedQueries:a}=Object(l.i)().services.data.query,n=Object(s.useMemo)((()=>c.d.globalFiltersQuerySelector()),[]),d=Object(r.useSelector)(n),p=Object(s.useCallback)((t=>{null!=t&&e(u.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),m=Object(s.useCallback)((a=>{null!=a?(t.setFilters(a),e(u.b.setSearchBarFilter({id:o.a.global,filters:a}))):(t.setAppFilters(d),e(u.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(s.useCallback)((n=>{null!=n&&""!==n&&a.getSavedQuery(n).then((a=>{const n=a.attributes.filters||[],i=a.attributes.query;t.setFilters(n),e(u.b.setSearchBarFilter({id:o.a.global,filters:n})),e(u.b.setFilterQuery({id:o.a.global,...i})),e(u.b.setSavedQuery({id:o.a.global,savedQuery:a}))}))}),[e,t,a]);Object(i.b)(C.appQuery,p),Object(i.b)(C.filters,m),Object(i.b)(C.savedQuery,f)})(),(()=>{const e=Object(r.useDispatch)(),t=Object(p.a)("socTrendsEnabled"),a=Object(s.useCallback)((a=>((e,t,a)=>{if(null!=e){const n={linkTo:Object(d.get)("global.linkTo",e)},i=Object(d.get)("global.timerange.kind",e),r={linkTo:Object(d.get)("timeline.linkTo",e)},s=Object(d.get)("timeline.timerange.kind",e),l={linkTo:Object(d.get)("socTrends.linkTo",e)},c=Object(d.get)("socTrends.timerange.kind",e);if(a&&(Object(d.isEmpty)(l.linkTo)?t(u.b.removeLinkTo([o.a.global,o.a.socTrends])):t(u.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(n.linkTo)?(t(u.b.removeLinkTo([o.a.global,o.a.timeline])),a&&t(u.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(u.b.addLinkTo([o.a.global,o.a.timeline])),a&&t(u.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(r.linkTo)?t(u.b.removeLinkTo([o.a.global,o.a.timeline])):t(u.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const a=Object(m.a)(Object(d.get)("timeline.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...a,id:o.a.timeline}))}if("relative"===s){const a=Object(m.a)(Object(d.get)("timeline.timerange",e));a.from=Object(f.c)(a.fromStr),a.to=Object(f.c)(a.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...a,id:o.a.timeline}))}}if(i){if("absolute"===i){const a=Object(m.a)(Object(d.get)("global.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...a,id:o.a.global}))}if("relative"===i){const a=Object(m.a)(Object(d.get)("global.timerange",e));a.from=Object(f.c)(a.fromStr),a.to=Object(f.c)(a.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...a,id:o.a.global}))}}if(a&&c){if("absolute"===c){const a=Object(m.a)(Object(d.get)("socTrends.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...a,id:o.a.socTrends}))}if("relative"===c){const a=Object(m.a)(Object(d.get)("socTrends.timerange",e));a.from=Object(f.c)(a.fromStr),a.to=Object(f.c)(a.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...a,id:o.a.socTrends}))}}}})(a,e,t)),[e,t]);Object(i.b)(C.timerange,a)})(),(()=>{const[{pageName:e}]=Object(h.a)(),t=Object(r.useDispatch)(),a=g()(e),n=Object(s.useMemo)((()=>c.d.inputsSelector()),[]),i=Object(r.useSelector)(n),{timerange:l}=i.global,{timerange:d}=i.timeline;Object(s.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(y.e)(e))(e,a)&&("relative"===d.kind&&t(u.b.setRelativeRangeDatePicker({...d,from:Object(f.c)(d.fromStr),to:Object(f.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===l.kind&&t(u.b.setRelativeRangeDatePicker({...l,from:Object(f.c)(l.fromStr),to:Object(f.c)(l.toStr,{roundUp:!0}),id:o.a.global})))}),[e,a,t,d,l])})(),(()=>{const e=Object(r.useDispatch)(),t=Object(p.a)("timelineEsqlTabDisabled"),a=Object(s.useCallback)((a=>{null!=a&&Object(x.h)({activeTimelineTab:a.activeTab===E.g.esql&&t?E.g.query:a.activeTab,duplicate:!1,graphEventId:a.graphEventId,timelineId:a.id,openTimeline:a.isOpen,updateIsLoading:t=>e(j.a.updateIsLoading(t)),updateTimeline:Object(x.b)(e),savedSearchId:a.savedSearchId})}),[e,t]);Object(s.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(C.timeline);if(!e)return;const t=Object(v.safeDecode)(e);a(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[a]),Object(i.b)(C.timeline,a)})(),(()=>{const e=Object(i.d)(C.timeline),t=Object(s.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),{activeTab:a,graphEventId:n,show:r,savedObjectId:o,savedSearchId:l}=Object(S.b)((e=>{var a;return null!==(a=t(e,E.f.active))&&void 0!==a?a:{}}));Object(s.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:r,activeTab:a,graphEventId:null!=n?n:"",savedSearchId:l||void 0};e(t)}),[a,n,o,r,e,l])})(),(()=>{var e;const t=Object(s.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),a=Object(S.b)((e=>t(e,E.f.active))),{search:n}=Object(O.useLocation)(),i=g()(n),o=null!==(e=null==a?void 0:a.savedObjectId)&&void 0!==e?e:"",l=Object(r.useDispatch)(),[c,u]=Object(s.useMemo)((()=>{const e=k({urlKey:C.timeline,search:null!=i?i:""}),t=k({urlKey:C.timeline,search:n});return null!=e&&null!=t?[Object(v.safeDecode)(e),Object(v.safeDecode)(t)]:[null,null]}),[i,n]),d=null==c?void 0:c.id,{id:p,activeTab:m,graphEventId:f}=u||{};Object(s.useEffect)((()=>{p&&p!==d&&p!==o&&Object(x.h)({activeTimelineTab:null!=m?m:E.g.query,duplicate:!1,graphEventId:f,timelineId:p,openTimeline:!0,updateIsLoading:e=>l(j.a.updateIsLoading(e)),updateTimeline:Object(x.b)(l)})}),[o,l,d,p,m,f])})(),(()=>{const[e]=Object(l.o)(T.nb),[t,a]=Object(s.useState)(null),[n,o]=Object(s.useState)(!1),c=Object(r.useDispatch)(),u=w.j.getTableByIdSelector(),d=Object(S.b)((e=>{var t;return null!==(t=u(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q})),p=Object(s.useCallback)((t=>{!e&&null!=t&&t.panelView&&a(t)}),[e]),m=Object(s.useCallback)((()=>{const{initialized:a,isLoading:n,totalCount:i,additionalFilters:r}=d,s=a&&!n&&i>0;!e&&t&&(r&&r.showBuildingBlockAlerts||c(w.h.updateShowBuildingBlockAlertsFilter({id:w.e.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),s&&(o(!0),c(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage,...t}))))}),[d,c,e,t]);Object(s.useEffect)((()=>{n||m()}),[n,m]);const f=e?"":C.eventFlyout;Object(i.b)(f,p)})(),(()=>{const e=Object(i.d)(C.eventFlyout),{pathname:t}=Object(O.useLocation)(),a=Object(r.useDispatch)(),n=w.j.getTableByIdSelector(),{expandedDetail:o}=Object(S.b)((e=>{var t;return null!==(t=n(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q}));Object(s.useEffect)((()=>{var n;const i=t===T.d;i&&null!=o&&null!=o&&o.query?e(o.query.panelView?o.query:null):!i&&null!=o&&null!==(n=o.query)&&void 0!==n&&n.panelView&&(a(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage})),e(null))}),[a,o,t,e])})()},C={appQuery:"query",eventFlyout:n.a,filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a(111);const i=n.z.enum(["going to run","running","partial failure","failed","succeeded"]),r=i.enum,s=n.z.number().int()},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(50),i=a(76),r=a(177);const s=["elastic-assistant, load-connectors"],o=({http:e,toasts:t})=>Object(n.useQuery)(s,(async()=>(await Object(i.loadAllActions)({http:e})).filter((e=>!e.isMissingSecrets&&[".bedrock",".gen-ai"].includes(e.actionTypeId)))),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.o}))}})},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a(123),r=a(168),s=a(222);const o={id:r.a,messages:[],apiConfig:{},theme:{title:r.c,titleIcon:"logoSecurity",assistant:{name:r.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}}},l=()=>{const{allSystemPrompts:e,assistantTelemetry:t,setConversations:a}=Object(i.b)(),r=Object(n.useCallback)((e=>{let t=[];return a((a=>{const n=a[e];if(null!=n){t=n.messages.slice(0,n.messages.length-1);const i={...n,messages:t};return{...a,[e]:i}}return a})),t}),[a]);return{amendMessage:Object(n.useCallback)((({conversationId:e,content:t})=>{a((a=>{const n=a[e];if(null!=n){const{messages:i,...r}=n,s=i[i.length-1],o={...r,messages:s?[...i.slice(0,-1),{...s,content:t}]:[...i]};return{...a,[e]:o}}return a}))}),[a]),appendMessage:Object(n.useCallback)((({conversationId:e,message:n})=>{null==t||t.reportAssistantMessageSent({conversationId:e,role:n.role});let i=[];return a((t=>{const a=t[e];if(null!=a){i=[...a.messages,n];const r={...a,messages:i};return{...t,[e]:r}}return t})),i}),[t,a]),appendReplacements:Object(n.useCallback)((({conversationId:e,replacements:t})=>{let n=t;return a((a=>{const i=a[e];if(null!=i){n={...i.replacements,...t};const r={...i,replacements:n};return{...a,[e]:r}}return a})),n}),[a]),clearConversation:Object(n.useCallback)((t=>{a((a=>{var n;const i=a[t],r=null===(n=Object(s.b)({allSystemPrompts:e,conversation:i}))||void 0===n?void 0:n.id;if(null!=i){const e={...i,apiConfig:{...i.apiConfig,defaultSystemPromptId:r},messages:[],replacements:void 0};return{...a,[t]:e}}return a}))}),[e,a]),createConversation:Object(n.useCallback)((({conversationId:t,messages:n})=>{var i;const r=null===(i=Object(s.b)({allSystemPrompts:e,conversation:void 0}))||void 0===i?void 0:i.id,l={...o,apiConfig:{...o.apiConfig,defaultSystemPromptId:r},id:t,messages:null!=n?n:[]};return a((e=>{if(null!=e[t])throw new Error("Conversation already exists!");return{...e,[t]:{...l}}})),l}),[e,a]),deleteConversation:Object(n.useCallback)((e=>{let t;return a((a=>{const{[e]:n,...i}=a;return t=n,null!=n?i:a})),t}),[a]),removeLastMessage:r,setApiConfig:Object(n.useCallback)((({conversationId:e,apiConfig:t})=>{a((a=>{const n=a[e];if(null!=n){const i={...n,apiConfig:t};return{...a,[e]:i}}return a}))}),[a]),setConversation:Object(n.useCallback)((({conversation:e})=>{a((t=>({...t,[e.id]:e})))}),[a])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));const n=e=>{const t=[...e.matchAll(/```(\w+)?\s([\s\S]*?)```/g)],a={eql:["Event Query Language","EQL sequence query","EQL"],esql:["Elasticsearch Query Language","ESQL","ES|QL","SQL"],kql:["Kibana Query Language","KQL Query","KQL"],dsl:["Elasticsearch QueryDSL","Elasticsearch Query DSL","Elasticsearch DSL","Query DSL","DSL"]};return t.map((t=>{let n=t[1]||"no-type";if("no-type"===n||"json"===n){const i=t.index||0,r=e.slice(0,i);for(const[e,t]of Object.entries(a))if(t.some((e=>r.toLowerCase().includes(e.toLowerCase())))){n=e;break}}const i=t[2].trim(),r=t.index||0;return{type:n,content:i,start:r,end:r+t[0].length}}))},i=({allSystemPrompts:e,conversation:t})=>{var a;const n=e.find((e=>{var a;return e.id===(null==t||null===(a=t.apiConfig)||void 0===a?void 0:a.defaultSystemPromptId)})),i=e.find((e=>e.isNewConversationDefault));return null!==(a=null!=n?n:i)&&void 0!==a?a:null==e?void 0:e[0]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return(e+1)%1e6};t.default=function(){return n.useReducer(i,0)[1]}},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(4);const i={ENABLE:`${n.l} singleRuleActions enable`,DISABLE:`${n.l} singleRuleActions disable`,DUPLICATE:`${n.l} singleRuleActions duplicate`,EXPORT:`${n.l} singleRuleActions export`,DELETE:`${n.l} singleRuleActions delete`,PREVIEW:`${n.l} singleRuleActions preview`,SAVE:`${n.l} singleRuleActions save`},r={ENABLE:`${n.l} bulkRuleActions enable`,DISABLE:`${n.l} bulkRuleActions disable`,DUPLICATE:`${n.l} bulkRuleActions duplicate`,EXPORT:`${n.l} bulkRuleActions export`,DELETE:`${n.l} bulkRuleActions delete`,EDIT:`${n.l} bulkRuleActions edit`},s={REFRESH:`${n.l} rulesTable refresh`,FILTER:`${n.l} rulesTable filter`,LOAD_PREBUILT:`${n.l} rulesTable loadPrebuilt`},o={SAVE:`${n.l} timeline save`,DUPLICATE:`${n.l} timeline duplicate`,DELETE:`${n.l} timeline delete`,BULK_DELETE:`${n.l} timeline bulkDelete`},l={OPEN_ANALYZER:`${n.l} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${n.l} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${n.l} alerts investigateInTimeline`},c={FIELD_SAVED:`${n.l} fieldBrowser fieldSaved`,FIELD_DELETED:`${n.l} fieldBrowser fieldDeleted`}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(45);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],s=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function o(e){return Object(n.isNumber)(e)||!Object(n.isEmpty)(e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(188);let i;!function(e){e.lastSeen="lastSeen",e.hostName="hostName",e.success="success"}(i||(i={}));const r=n.a},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(48),l=a(17),c=a(119),u=a(196),d=a(118),p=a(189),m=a(122),f=a(113),b=a(112),g=a(138),y=a(149),h=a(116),v=a(167),E=a(460);const x=({timelineId:e,timelineType:t,onClick:a})=>{const n=Object(o.useDispatch)(),i=Object(r.useMemo)((()=>y.d.defaultDataViewSelector()),[]),{id:s,patternList:l}=Object(b.a)(i),{timelineFullScreen:f,setTimelineFullScreen:x}=Object(p.c)(),j=Object(b.a)(g.d.globalTimeRangeSelector),{resetDiscoverAppState:S}=Object(E.a)(),O=Object(r.useCallback)((({id:e,show:a,timeRange:i})=>{const r=null!=i?i:j;e===m.c.active&&f&&x(!1),n(y.a.setSelectedDataView({id:h.SourcererScopeName.timeline,selectedDataViewId:s,selectedPatterns:l})),n(d.a.createTimeline({columns:u.b,dataViewId:s,id:e,indexNames:l,show:a,timelineType:t,updated:void 0})),n(g.b.addLinkTo([c.a.global,c.a.timeline])),n(v.a.addNotes({notes:[]})),i&&n(g.b.removeLinkTo([c.a.timeline,c.a.global])),"absolute"===r.kind?n(g.b.setAbsoluteRangeDatePicker({...r,id:c.a.timeline})):"relative"===r.kind&&n(g.b.setRelativeRangeDatePicker({...r,id:c.a.timeline}))}),[n,j,s,l,x,f,t]);return Object(r.useCallback)((n=>{O({id:e,show:!0,timelineType:t,timeRange:null==n?void 0:n.timeRange}),"function"==typeof a&&a(),S()}),[O,e,t,a,S])},j=({timelineId:e,timelineType:t,onClick:a})=>{const n=x({timelineId:e,timelineType:t,onClick:a});return{getButton:Object(r.useCallback)((({outline:e,title:a,iconType:r="plusInCircle",fill:o=!0})=>{const c={iconType:r,onClick:()=>n(),fill:o},u=t===f.l.template?"template-timeline-new":"timeline-new",{fill:d,...p}=c;return e?s.a.createElement(l.EuiButton,i()({"data-test-subj":`${u}-with-border`},c),a):s.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":u,color:"text"},p),a)}),[n,t])}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a(4);var n=a(185);const i=(e,t)=>`/${e}${Object(n.a)(t)}`,r=(e,t)=>`/name/${e}${Object(n.a)(t)}`,s=(e,t,a)=>`/name/${e}/${t}${Object(n.a)(a)}`},function(e,t,a){"use strict";let n,i;a.r(t),a.d(t,"HostsType",(function(){return n})),a.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const n=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],s=(e,t)=>n.includes(e)&&n.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),c=e=>"machine_learning"===e},function(e,t,a){"use strict";a.d(t,"a",(function(){return fe})),a.d(t,"f",(function(){return be})),a.d(t,"c",(function(){return ge})),a.d(t,"d",(function(){return ye})),a.d(t,"e",(function(){return he})),a.d(t,"b",(function(){return ve}));var n=a(2),i=a.n(n),r=a(144),s=a(44),o=a.n(s),l=a(17),c=(a(13),a(47)),u=a(5),d=a(201),p=a(427);const m=`${p.a}VisualizeTab`,f=`${m}ButtonGroup`,b=`${m}SessionViewButton`,g=`${m}GraphAnalyzerButton`,y=`${p.a}InsightsTab`,h=`${y}ButtonGroup`,v=`${y}EntitiesButton`,E=`${y}ThreatIntelligenceButton`,x=`${y}PrevalenceButton`,j=`${y}CorrelationsButton`,S=`${p.a}InvestigationsTabContent`,O=`${p.a}ResponseTabContent`;var k=a(183),w=a(906),T=a(866),I=a(127);const C="analyze_graph",M=()=>{const{eventId:e}=Object(d.b)(),t="flyout",{from:a,to:r,shouldUpdate:s,selectedPatterns:o}=Object(T.a)(Object(I.isActiveTimeline)(t)),l=Object(n.useMemo)((()=>({from:a,to:r})),[a,r]);return i.a.createElement("div",{"data-test-subj":k.a},i.a.createElement(w.a,{databaseDocumentID:e,resolverComponentInstanceID:t,indices:o,shouldUpdate:s,filters:l}))};M.displayName="AnalyzeGraph";var _=a(313),A=a(192),F=a(110);const P="session-view",D=()=>{const{sessionView:e}=Object(F.i)().services,{getFieldsData:t,indexName:a}=Object(d.b)(),n=Object(A.a)(t(_.b)),r=Object(A.a)(t(_.c))||"",s=Object(A.a)(t(_.d))||"",o=n||a;return i.a.createElement("div",{"data-test-subj":k.z},e.getSessionView({index:o,sessionEntityId:r,sessionStartTime:s,isFullScreen:!0}))};D.displayName="SessionView";var N=a(224),R=a(184);const L=[{id:P,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.sessionViewButtonLabel",defaultMessage:"Session View"}),"data-test-subj":b},{id:C,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.analyzerGraphButtonLabel",defaultMessage:"Analyzer Graph"}),"data-test-subj":g}],B=Object(n.memo)((()=>{var e,t,a,s,o;const{eventId:c,indexName:p,scopeId:m}=Object(d.b)(),{panels:b,openLeftPanel:g}=Object(r.d)(),[y,h]=Object(n.useState)(null!==(e=null===(t=b.left)||void 0===t||null===(a=t.path)||void 0===a?void 0:a.subTab)&&void 0!==e?e:P),{startTransaction:v}=Object(R.b)(),E=Object(n.useCallback)((e=>{h(e),e===C&&v({name:N.a.OPEN_ANALYZER}),g({id:fe,path:{tab:be,subTab:e},params:{id:c,indexName:p,scopeId:m}})}),[v,c,p,m,g]);return Object(n.useEffect)((()=>{var e,t,a,n;null!==(e=b.left)&&void 0!==e&&null!==(t=e.path)&&void 0!==t&&t.subTab&&h(null===(a=b.left)||void 0===a||null===(n=a.path)||void 0===n?void 0:n.subTab)}),[null===(s=b.left)||void 0===s||null===(o=s.path)||void 0===o?void 0:o.subTab]),i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiButtonGroup,{color:"primary",name:"coarsness",legend:u.i18n.translate("xpack.securitySolution.flyout.left.visualize.buttonGroupLegendLabel",{defaultMessage:"Visualize options"}),options:L,idSelected:y,onChange:e=>E(e),buttonSize:"compressed",isFullWidth:!0,"data-test-subj":f}),i.a.createElement(l.EuiSpacer,{size:"m"}),y===P&&i.a.createElement(D,null),y===C&&i.a.createElement(M,null))}));B.displayName="VisualizeTab";var z=a(907),q=a(404),$=a(394);const V=()=>{const{dataFormattedForFieldBrowser:e,isPreview:t}=Object(d.b)(),{loading:a,error:n,basicAlertData:r,ruleNote:s}=Object(z.a)({dataFormattedForFieldBrowser:e});return i.a.createElement("div",{"data-test-subj":k.m},t?i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):a?i.a.createElement($.a,{"data-test-subj":k.l}):!n&&r.ruleId&&s?i.a.createElement(q.b,{basicData:r,ruleNote:s,showTitle:!1,showFullView:!0}):i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataDescription",defaultMessage:"There's no investigation guide for this rule. {documentation} to add one.",values:{documentation:i.a.createElement(l.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-management.html#edit-rules-settings",target:"_blank"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataLinkText",defaultMessage:"Edit the rule's settings"}))}}))};V.displayName="InvestigationGuide";const U=Object(n.memo)((()=>i.a.createElement(l.EuiPanel,{"data-test-subj":S,hasShadow:!1},i.a.createElement(V,null))));U.displayName="InvestigationTab";var H=a(416),Q=a(965),G=a(909),W=a(959);const Z=[{id:H.a,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entitiesButtonLabel",defaultMessage:"Entities"}),"data-test-subj":v},{id:Q.a,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.threatIntelligenceButtonLabel",defaultMessage:"Threat intelligence"}),"data-test-subj":E},{id:G.a,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalenceButtonLabel",defaultMessage:"Prevalence"}),"data-test-subj":x},{id:W.a,label:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlationsButtonLabel",defaultMessage:"Correlations"}),"data-test-subj":j}],K=Object(n.memo)((()=>{var e,t,a;const{eventId:s,indexName:o,scopeId:c}=Object(d.b)(),{openLeftPanel:p,panels:m}=Object(r.d)(),f=null!==(e=null===(t=m.left)||void 0===t||null===(a=t.path)||void 0===a?void 0:a.subTab)&&void 0!==e?e:H.a,b=Object(n.useCallback)((e=>{p({id:fe,path:{tab:ge,subTab:e},params:{id:s,indexName:o,scopeId:c}})}),[s,o,c,p]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiButtonGroup,{color:"primary",name:"coarsness",legend:u.i18n.translate("xpack.securitySolution.flyout.left.insights.buttonGroupLegendLabel",{defaultMessage:"Insights options"}),options:Z,idSelected:f,onChange:b,buttonSize:"compressed",isFullWidth:!0,"data-test-subj":h}),i.a.createElement(l.EuiSpacer,{size:"m"}),f===H.a&&i.a.createElement(H.b,null),f===Q.a&&i.a.createElement(Q.b,null),f===G.a&&i.a.createElement(G.b,null),f===W.a&&i.a.createElement(W.b,null))}));K.displayName="InsightsTab";const J=`${p.a}VisualizeTab`,Y=`${p.a}InsightsTab`,X=`${p.a}InvestigationTab`,ee=`${p.a}ResponseTab`;var te=a(130),ae=a(1303),ne=a(1324);const ie=o.a.div.withConfig({displayName:"ExtendedFlyoutWrapper",componentId:"sc-qxbnld-0"})(["figure{background-color:white"]),re=()=>{const{searchHit:e,dataAsNestedObject:t,isPreview:a}=Object(d.b)(),n=Object(te.a)("endpointResponseActionsEnabled"),r=Object(ne.a)({rawEventData:e,ecsData:t}),s=Object(ae.a)({rawEventData:e,ecsData:t});return i.a.createElement("div",{"data-test-subj":k.x},a?i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiTitle,{size:"xxxs"},i.a.createElement("h5",null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.responseTitle",defaultMessage:"Responses"}))),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(ie,null,n?null==r?void 0:r.content:null==s?void 0:s.content)))};re.displayName="ResponseDetails";const se=Object(n.memo)((()=>i.a.createElement(l.EuiPanel,{"data-test-subj":O,hasShadow:!1},i.a.createElement(re,null))));se.displayName="ResponseTab";const oe=[{id:"visualize","data-test-subj":J,name:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.tabLabel",defaultMessage:"Visualize"}),content:i.a.createElement(B,null),visible:!1},{id:"insights","data-test-subj":Y,name:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.tabLabel",defaultMessage:"Insights"}),content:i.a.createElement(K,null),visible:!0},{id:"investigation","data-test-subj":X,name:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigations.tabLabel",defaultMessage:"Investigation"}),content:i.a.createElement(U,null),visible:!0},{id:"response","data-test-subj":ee,name:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.tabLabel",defaultMessage:"Response"}),content:i.a.createElement(se,null),visible:!0}];var le=a(1111);const ce=Object(n.memo)((({selectedTabId:e,setSelectedTabId:t})=>{const a=oe.filter((e=>e.visible)).map(((a,n)=>i.a.createElement(l.EuiTab,{onClick:()=>{return e=a.id,t(e);var e},isSelected:a.id===e,key:n,"data-test-subj":a["data-test-subj"]},a.name)));return i.a.createElement(ue,{$_css:Object(l.useEuiBackgroundColor)("subdued")},i.a.createElement(l.EuiTabs,{size:"l",expand:!0},a))}));ce.displayName="PanelHeader";var ue=o()(le.a).withConfig({displayName:"_StyledFlyoutHeader",componentId:"sc-1qgelk0-0"})(["background-color:",";padding-bottom:0 !important;border-block-end:none !important;"],(e=>e.$_css)),de=a(1067);const pe=({selectedTabId:e})=>{const t=Object(n.useMemo)((()=>{var t;return null===(t=oe.filter((e=>e.visible)).find((t=>t.id===e)))||void 0===t?void 0:t.content}),[e]);return i.a.createElement(me,{$_css:Object(l.useEuiBackgroundColor)("subdued")},t)};pe.displayName="PanelContent";var me=o()(de.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-1pfozwl-0"})(["background-color:",";"],(e=>e.$_css));const fe="document-details-left",be="visualize",ge="insights",ye="investigation",he="response",ve=Object(n.memo)((({path:e})=>{const{openLeftPanel:t}=Object(r.d)(),{eventId:a,indexName:s,scopeId:o}=Object(d.b)(),l=Object(n.useMemo)((()=>{var t;const a=oe.filter((e=>e.visible)),n=a[0].id;return e&&null!==(t=a.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:n}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(ce,{selectedTabId:l,setSelectedTabId:e=>{t({id:fe,path:{tab:e},params:{id:a,indexName:s,scopeId:o}})}}),i.a.createElement(pe,{selectedTabId:l}))}));ve.displayName="LeftPanel"},function(e,t,a){"use strict";var n=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function i(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(!((i=e[a])===(r=t[a])||n(i)&&n(r)))return!1;var i,r;return!0}e.exports=function(e,t){void 0===t&&(t=i);var a=null;function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(a&&a.lastThis===this&&t(n,a.lastArgs))return a.lastResult;var r=e.apply(this,n);return a={lastResult:r,lastArgs:n,lastThis:this},r}return n.clear=function(){a=null},n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){var t=n.useRef();return n.useEffect((function(){t.current=e})),t.current}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(17),i=a(5),r=a(47),s=a(2),o=a.n(s);const l=({count:e})=>{const[t,a,l]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const a=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),n={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,n.compactThousands],[1e6,n.compactMillions],[1e9,n.compactBillions],[1e12,n.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=r.get(a))&&void 0!==t?t:"";return[Math.floor(e/a),o,e/a%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(n.EuiI18nNumber,{value:t}),scale:a,hasRemainder:l}})},c=o.a.memo(l)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(185);const i=e=>`${Object(n.a)(e)}`,r=e=>`${Object(n.a)(e)}`,s=(e,t)=>`/id/${e}${Object(n.a)(t)}`,o=(e,t,a)=>`/id/${e}/${t}${Object(n.a)(a)}`,l=(e,t)=>`/id/${e}/edit${Object(n.a)(t)}`},,function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));const n="cellAction-filter",i="cellAction-copy";let r;!function(e){e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline"}(r||(r={}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return b}));var n=a(45),i=a(234),r=a.n(i),s=a(2),o=a(110),l=a(555),c=a(334),u=a(117);const d=e=>Object(n.keyBy)("name",function(e){const t=[];for(const a of Object.values(e))a.fields&&t.push(...Object.values(a.fields));return t}(e)),p=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(n.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),m={},f={fields:[],title:""},b=(e,t=!1,a="indexFields")=>{const{data:i}=Object(o.i)().services,r=Object(s.useRef)(new AbortController),d=Object(s.useRef)([]),[b,g]=Object(s.useState)({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:y}=Object(u.a)(),h=Object(s.useCallback)((t=>{(async()=>{try{g({...b,loading:!0}),r.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),a=e.toSpec(),{browserFields:n}=Object(c.a)(t,a.fields);d.current=e.getIndexPattern().split(","),g({loading:!1,dataView:a,browserFields:n,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:p(e.getIndexPattern(),e.fields)})}catch(t){g({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),y(null==t?void 0:t.message,{title:l.a})}})()}),[y,i.dataViews,e,b]);return Object(s.useEffect)((()=>(Object(n.isEmpty)(e)||Object(n.isEqual)(d.current,e)||h(e),()=>{r.current.abort()})),[e,d]),[b.loading,b]}},function(e,t,a){e.exports=a(24)(2967)},function(e,t,a){"use strict";a.d(t,"B",(function(){return u})),a.d(t,"A",(function(){return p})),a.d(t,"z",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"i",(function(){return b})),a.d(t,"s",(function(){return g})),a.d(t,"v",(function(){return y})),a.d(t,"q",(function(){return h})),a.d(t,"r",(function(){return v})),a.d(t,"o",(function(){return E})),a.d(t,"p",(function(){return x})),a.d(t,"j",(function(){return j})),a.d(t,"u",(function(){return S})),a.d(t,"t",(function(){return O})),a.d(t,"x",(function(){return k})),a.d(t,"w",(function(){return w})),a.d(t,"m",(function(){return T})),a.d(t,"n",(function(){return I})),a.d(t,"b",(function(){return C})),a.d(t,"k",(function(){return M})),a.d(t,"l",(function(){return _})),a.d(t,"c",(function(){return A})),a.d(t,"f",(function(){return F})),a.d(t,"g",(function(){return P})),a.d(t,"d",(function(){return D})),a.d(t,"e",(function(){return N})),a.d(t,"h",(function(){return R})),a.d(t,"y",(function(){return L}));var n=a(17),i=a(345),r=a(44),s=a.n(r),o=a(114),l=a(145),c=a(296);const u=s.a.div.attrs((({className:e=""})=>({className:`securitySolutionTimeline__container ${e}`}))).withConfig({displayName:"TimelineContainer",componentId:"sc-1fubmdc-0"})(["height:100%;display:flex;flex-direction:column;position:relative;"]),d="securitySolutionTimeline__body",p=Object(r.createGlobalStyle)(["body."," .","{overflow:hidden;}"],o.e,d),m=s.a.div.attrs((({className:e=""})=>({className:`${d} ${e}`}))).withConfig({displayName:"TimelineBody",componentId:"sc-1fubmdc-1"})(["height:auto;overflow:auto;scrollbar-width:thin;flex:1;display:block;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner));m.displayName="TimelineBody";const f="siemEventsTable",b=s.a.div.attrs((({className:e="",$columnCount:t,columnWidths:a,$activePage:n,$rowCount:i,$totalPages:r})=>({"aria-label":Object(c.c)({activePage:n+1,totalPages:r}),"aria-colcount":`${t}`,"aria-rowcount":`${i+1}`,className:`siemEventsTable ${e}`,role:"grid",style:{minWidth:`${a}px`},tabindex:"-1"}))).withConfig({displayName:"EventsTable",componentId:"sc-1fubmdc-2"})(["padding:3px;"]),g=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thead ${e}`,role:"rowgroup"}))).withConfig({displayName:"EventsThead",componentId:"sc-1fubmdc-3"})(["background-color:",";border-bottom:"," solid ",";position:sticky;top:0;z-index:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderWidthThick),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiZLevel1)),y=s.a.div.attrs((({className:e})=>({"aria-rowindex":"1",className:`siemEventsTable__trHeader ${e}`,role:"row"}))).withConfig({displayName:"EventsTrHeader",componentId:"sc-1fubmdc-4"})(["display:flex;"]),h=s.a.div.attrs((({className:e=""})=>({"aria-colindex":`${l.a}`,className:`siemEventsTable__thGroupActions ${e}`,role:"columnheader",tabIndex:"0"}))).withConfig({displayName:"EventsThGroupActions",componentId:"sc-1fubmdc-5"})(["display:flex;flex:0 0 ",";min-width:0;padding-left:",";"],(({actionsColumnWidth:e,isEventViewer:t})=>`${t?e:e+4}px`),(({isEventViewer:e})=>e?"0;":"4px;")),v=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thGroupData ${e}`}))).withConfig({displayName:"EventsThGroupData",componentId:"sc-1fubmdc-6"})(["display:flex;> div:hover .siemEventsHeading__handle{display:",";opacity:1;visibility:visible;}"],(({isDragging:e})=>e?"none":"block")),E=s.a.div.attrs((({className:e="",role:t="columnheader"})=>({className:`siemEventsTable__th ${e}`,role:t}))).withConfig({displayName:"EventsTh",componentId:"sc-1fubmdc-7"})(["align-items:center;display:flex;flex-shrink:0;min-width:0;.siemEventsTable__thGroupActions &:first-child:last-child{flex:1;}.siemEventsTable__thGroupData &:hover{background-color:",";cursor:move;cursor:grab;}> div:focus{outline:0;}[data-rbd-placeholder-context-id]{display:none !important;}"],(({theme:e})=>e.eui.euiTableHoverColor)),x=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thContent ${e}`}))).withConfig({displayName:"EventsThContent",componentId:"sc-1fubmdc-8"})(["font-size:",";font-weight:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";> button.euiButtonIcon,> .euiToolTipAnchor > button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),j=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__tbody ${e}`,role:"rowgroup"}))).withConfig({displayName:"EventsTbody",componentId:"sc-1fubmdc-9"})(["overflow-x:hidden;"]),S=s.a.div.attrs((({className:e="",$ariaRowindex:t})=>({"aria-rowindex":`${t}`,className:`siemEventsTable__trGroup ${e}`,role:"row"}))).withConfig({displayName:"EventsTrGroup",componentId:"sc-1fubmdc-10"})(["border-bottom:"," solid ",";",";",";",";&:hover{background-color:",";}",""],(({theme:e})=>e.eui.euiBorderWidthThin),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e,eventType:t,isEvenEqlSequence:a,showLeftBorder:n})=>n?`border-left: 4px solid\n    ${"raw"===t?e.eui.euiColorLightShade:"eql"===t&&a?e.eui.euiColorPrimary:"eql"!==t||a?e.eui.euiColorWarning:e.eui.euiColorAccent}`:""),(({isBuildingBlockType:e})=>e?"background: repeating-linear-gradient(127deg, rgba(245, 167, 0, 0.2), rgba(245, 167, 0, 0.2) 1px, rgba(245, 167, 0, 0.05) 2px, rgba(245, 167, 0, 0.05) 10px);":""),(({eventType:e,isEvenEqlSequence:t})=>"eql"===e?t?"background: repeating-linear-gradient(127deg, rgba(0, 107, 180, 0.2), rgba(0, 107, 180, 0.2) 1px, rgba(0, 107, 180, 0.05) 2px, rgba(0, 107, 180, 0.05) 10px);":"background: repeating-linear-gradient(127deg, rgba(221, 10, 115, 0.2), rgba(221, 10, 115, 0.2) 1px, rgba(221, 10, 115, 0.05) 2px, rgba(221, 10, 115, 0.05) 10px);":""),(({theme:e})=>e.eui.euiTableHoverColor),(({isExpanded:e,theme:t})=>e&&`\n    background: ${t.eui.euiTableSelectedColor};\n\n    &:hover {\n      ${t.eui.euiTableHoverSelectedColor}\n    }\n  `)),O=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__trData ${e}`}))).withConfig({displayName:"EventsTrData",componentId:"sc-1fubmdc-11"})(["display:flex;"]),k=s.a.div.attrs((({width:e})=>({role:"dialog",style:{width:e-40+"px"}}))).withConfig({displayName:"EventsTrSupplementContainer",componentId:"sc-1fubmdc-12"})([""]),w=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__trSupplement ${e}`}))).withConfig({displayName:"EventsTrSupplement",componentId:"sc-1fubmdc-13"})(["display:",";font-size:",";line-height:",";padding-left:",";.euiAccordion + div{background-color:",";padding:0 ",";border:1px solid ",";border-radius:",";}"],(({$display:e})=>null!=e?e:"inline-block"),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeXS)),T=s.a.div.attrs((({className:e=""})=>({"aria-colindex":`${l.a}`,className:`siemEventsTable__tdGroupActions ${e}`,role:"gridcell"}))).withConfig({displayName:"EventsTdGroupActions",componentId:"sc-1fubmdc-14"})(["align-items:center;display:flex;flex:0 0 ",";min-width:0;"],(({width:e})=>`${e}px`)),I=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__tdGroupData ${e}`}))).withConfig({displayName:"EventsTdGroupData",componentId:"sc-1fubmdc-15"})(["display:flex;"]),C="siemEventsTable__td",M=s.a.div.attrs((({className:e="",$ariaColumnIndex:t,width:a})=>{const n={className:`siemEventsTable__td ${e}`,role:"gridcell",style:{flexBasis:a?`${a}px`:"auto"}};return null!=t?{...n,"aria-colindex":`${t}`}:n})).withConfig({displayName:"EventsTd",componentId:"sc-1fubmdc-16"})(["align-items:center;display:flex;flex-shrink:0;min-width:0;.siemEventsTable__tdGroupActions &:first-child:last-child{flex:1;}"]),_=s.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-1fubmdc-17"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),A=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading ${e}`}))).withConfig({displayName:"EventsHeading",componentId:"sc-1fubmdc-18"})(["align-items:center;display:flex;&:hover{cursor:",";}"],(({isLoading:e})=>e?"wait":"grab")),F=s.a.button.attrs((({className:e=""})=>({className:`siemEventsHeading__title siemEventsHeading__title--aggregatable ${e}`,type:"button"}))).withConfig({displayName:"EventsHeadingTitleButton",componentId:"sc-1fubmdc-19"})(["align-items:center;display:flex;font-weight:inherit;min-width:0;&:hover,&:focus{color:",";text-decoration:underline;}&:hover{cursor:pointer;}& > * + *{margin-left:",";}"],(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiSizeXS)),P=s.a.span.attrs((({className:e})=>({className:`siemEventsHeading__title siemEventsHeading__title--notAggregatable ${e}`}))).withConfig({displayName:"EventsHeadingTitleSpan",componentId:"sc-1fubmdc-20"})(["min-width:0;"]),D=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading__extra ${e}`}))).withConfig({displayName:"EventsHeadingExtra",componentId:"sc-1fubmdc-21"})(["margin-left:auto;margin-right:2px;&.siemEventsHeading__extra--close{opacity:0;transition:all "," ease;visibility:hidden;.siemEventsTable__th:hover &{opacity:1;visibility:visible;}}"],(({theme:e})=>e.eui.euiAnimSpeedNormal)),N=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading__handle ${e}`}))).withConfig({displayName:"EventsHeadingHandle",componentId:"sc-1fubmdc-22"})(["background-color:",";height:100%;opacity:0;transition:all "," ease;visibility:hidden;width:",";&:hover{background-color:",";cursor:col-resize;}"],(({theme:e})=>e.eui.euiBorderColor),(({theme:e})=>e.eui.euiAnimSpeedNormal),(({theme:e})=>e.eui.euiBorderWidthThick),(({theme:e})=>e.eui.euiColorPrimary)),R=s()(n.EuiLoadingSpinner).withConfig({displayName:"EventsLoading",componentId:"sc-1fubmdc-23"})(["margin:0 2px;vertical-align:middle;"]),L=s.a.div.attrs((({$isVisible:e=!1})=>({style:{display:e?"block":"none"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fubmdc-24"})([""])},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"j",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"k",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"e",(function(){return f})),a.d(t,"d",(function(){return b}));var n=a(5);n.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=n.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),r=n.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),s=n.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),o=n.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=n.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),c=n.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),u=n.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new Timeline"}),d=n.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new Timeline template"}),p=n.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),m=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),f=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),b=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},function(e,t,a){"use strict";let n,i,r,s,o,l,c,u,d;a.d(t,"c",(function(){return n})),a.d(t,"i",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"g",(function(){return p.e})),function(e){e.inbound="inbound",e.outbound="outbound",e.internal="internal",e.external="external",e.incoming="incoming",e.outgoing="outgoing",e.listening="listening",e.unknown="unknown"}(n||(n={})),function(e){e.bytes_in="bytes_in",e.bytes_out="bytes_out",e.flows="flows",e.destination_ips="destination_ips",e.source_ips="source_ips"}(i||(i={})),function(e){e.client="client",e.destination="destination",e.server="server",e.source="source"}(r||(r={})),function(e){e.destination="destination",e.source="source"}(s||(s={})),function(e){e.dnsName="dnsName",e.queryCount="queryCount",e.uniqueDomains="uniqueDomains",e.dnsBytesIn="dnsBytesIn",e.dnsBytesOut="dnsBytesOut"}(o||(o={})),function(e){e.domains="domains",e.lastHost="lastHost",e.lastSourceIp="lastSourceIp",e.methods="methods",e.path="path",e.requestCount="requestCount",e.statuses="statuses"}(l||(l={})),function(e){e.dns="networkKpiDns",e.networkEvents="networkKpiNetworkEvents",e.tlsHandshakes="networkKpiTlsHandshakes",e.uniqueFlows="networkKpiUniqueFlows",e.uniquePrivateIps="networkKpiUniquePrivateIps"}(c||(c={})),function(e){e._id="_id"}(u||(u={})),function(e){e.name="name",e.count="count"}(d||(d={}));var p=a(150)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return h}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(49);const l={services:{}},c=Object(r.createContext)(l);var u=a(664),d=a.n(u),p=a(13);const m=({children:e,component:t,render:a,...n})=>{const l=Object(r.useMemo)((()=>{if(t)return e=>Object(p.jsx)(s.a.Fragment,null,Object(p.jsx)(f,null),Object(p.jsx)(t,e))}),[t]);if(l)return Object(p.jsx)(o.Route,i()({},n,{component:l}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(p.jsx)(o.Route,i()({},n,{render:e=>Object(p.jsx)(s.a.Fragment,null,Object(p.jsx)(f,null),t(e))}))}return Object(p.jsx)(o.Route,n,Object(p.jsx)(f,null),e)},f=()=>{const{executionContext:e}=Object(r.useContext)(c).services,t=Object(o.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var b=a(91);const g=({children:e,...t})=>Object(p.jsx)(o.Router,t,Object(p.jsx)(b.CompatRouter,null,e));var y=a(9);const h=({legacySwitch:e=!0,children:t})=>{const a=Object(o.useRouteMatch)();return e?Object(p.jsx)(o.Switch,null,t):Object(p.jsx)(b.Routes,null,r.Children.map(t,(e=>{if(s.a.isValidElement(e)&&e.type===m){var n;const i=Object(y.replace)(null==e?void 0:e.props.path,a.url+"/",""),r="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(p.jsx)(b.Route,{path:i,element:Object(p.jsx)(s.a.Fragment,null,Object(p.jsx)(f,null),(null==e||null===(n=e.props)||void 0===n?void 0:n.component)&&Object(p.jsx)(e.props.component,null)||r&&r()||t)})}return e})))}},function(e,t,a){"use strict";var n=a(141);a.d(t,"d",(function(){return n.N}));var i=a(148);a.d(t,"b",(function(){return i.a})),a.d(t,"c",(function(){return i.b})),a.d(t,"e",(function(){return i.g})),a.d(t,"f",(function(){return i.h})),a(365),a(368),a(369);var r=a(323);a.d(t,"a",(function(){return r.b})),a(367),a(366)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(111).z.enum(["asc","desc"]);n.enum},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"d",(function(){return d}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.assistant.clearChat",{defaultMessage:"Clear chat"}),r=n.i18n.translate("xpack.elasticAssistant.assistant.defaultAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),s=n.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleLabel",{defaultMessage:"Show anonymized"}),o=n.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedTooltip",{defaultMessage:"Show the anonymized values sent to and from the assistant"}),l=n.i18n.translate("xpack.elasticAssistant.assistant.submitMessage",{defaultMessage:"Submit message"}),c=n.i18n.translate("xpack.elasticAssistant.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),u=n.i18n.translate("xpack.elasticAssistant.documentationLinks.ariaLabel",{defaultMessage:"Click to open Elastic Assistant documentation in a new tab"}),d=n.i18n.translate("xpack.elasticAssistant.documentationLinks.documentation",{defaultMessage:"documentation"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"e",(function(){return p}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),r=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.useTheFollowingContextToAnswer",{defaultMessage:"Use the following context to answer questions:"}),s=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),o=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),l=`${i} ${s}\n${r}`,c=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),u=`${i} ${s}\n${o}\n${r}`,d=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),p=e=>`CONTEXT:\n"""\n${e}\n"""`},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=e=>{if(null==e||!e.isPreconfigured)return null==e?void 0:e.config},i=e=>{var t;return null!==(t=e.actionTypeTitle)&&void 0!==t?t:e.id}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return d}));var n=a(73),i=a(249),r=a(498),s=a(374);const o=async({alerts:e,alertsIndexPattern:t,allow:a,allowReplacement:o,assistantLangChain:l,assistantStreamingEnabled:c,http:u,messages:d,onNewReplacements:p,replacements:m,apiConfig:f,signal:b,size:g})=>{var y;const h=d.map((e=>({role:e.role,content:e.content}))),v=(null==f?void 0:f.provider)===n.OpenAiProviderType.OpenAi?{model:null!==(y=f.model)&&void 0!==y?y:r.a,messages:h,n:1,stop:null,temperature:.2}:{messages:h},E=c&&!l,x=Object(s.e)({alerts:e,alertsIndexPattern:t,allow:a,allowReplacement:o,replacements:m,size:g}),j=E?{params:{subActionParams:v,subAction:"invokeStream"},assistantLangChain:l,...x}:{params:{subActionParams:v,subAction:"invokeAI"},assistantLangChain:l,...x};try{var S,O,k,w,T;if(E){var I,C;const e=await u.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(j),signal:b,asResponse:E,rawResponse:E}),t=null==e||null===(I=e.response)||void 0===I||null===(C=I.body)||void 0===C?void 0:C.getReader();return t?{response:t,isStream:!0,isError:!1}:{response:`${i.a}\n\nCould not get reader from response`,isError:!0,isStream:!1}}const t=await u.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(j),headers:{"Content-Type":"application/json"},signal:b});if("ok"!==t.status||!t.data)return t.service_message?{response:`${i.a}\n\n${t.service_message}`,isError:!0,isStream:!1}:{response:i.a,isError:!0,isStream:!1};const a=null!=(null===(S=t.trace_data)||void 0===S?void 0:S.trace_id)&&null!=(null===(O=t.trace_data)||void 0===O?void 0:O.transaction_id)?{traceId:null===(k=t.trace_data)||void 0===k?void 0:k.trace_id,transactionId:null===(w=t.trace_data)||void 0===w?void 0:w.transaction_id}:void 0;return p(null!==(T=t.replacements)&&void 0!==T?T:{}),{response:Object(s.f)({alerts:e,assistantLangChain:l})?Object(s.c)(t.data):t.data,isError:!1,isStream:!1,traceData:a}}catch(e){var M,_;const t=null==e||null===(M=e.response)||void 0===M||null===(_=M.body)||void 0===_?void 0:_.getReader,a=E&&"function"==typeof t?t.call(e.response.body):null;var A,F;return a?{response:a,isStream:!0,isError:!0}:{response:`${i.a}\n\n${null!==(A=null==e||null===(F=e.body)||void 0===F?void 0:F.message)&&void 0!==A?A:null==e?void 0:e.message}`,isError:!0,isStream:!1}}},l=async({http:e,resource:t,signal:a})=>{try{const n=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(n,{method:"GET",signal:a})}catch(e){return e}},c=async({http:e,resource:t,signal:a})=>{try{const n=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(n,{method:"POST",signal:a})}catch(e){return e}},u=async({http:e,resource:t,signal:a})=>{try{const n=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(n,{method:"DELETE",signal:a})}catch(e){return e}},d=async({http:e,evalParams:t,signal:a})=>{try{var n,i,r,s,o,l;const c="/internal/elastic_assistant/evaluate",u={agents:null==t||null===(n=t.agents.sort())||void 0===n?void 0:n.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(i=t.evaluationType.sort())||void 0===i?void 0:i.join(","),evalModel:null==t||null===(r=t.evalModel.sort())||void 0===r?void 0:r.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(s=t.models.sort())||void 0===s?void 0:s.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.fetch(c,{method:"POST",body:JSON.stringify({dataset:JSON.parse(null!==(o=null==t?void 0:t.dataset)&&void 0!==o?o:"[]"),evalPrompt:null!==(l=null==t?void 0:t.evalPrompt)&&void 0!==l?l:""}),headers:{"Content-Type":"application/json"},query:u,signal:a})}catch(e){return e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(300);t.default=function(e,t){var a=i.useFirstMountState();n.useEffect((function(){if(!a)return e()}),t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){void 0===e&&(e={});var t=n.useState(e),a=t[0],i=t[1];return[a,n.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){n.useEffect(e,[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(303));t.default=function(e){var t=i.useRef(0),a=i.useState(e),n=a[0],s=a[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){s(e)}))}),[]);return r.default((function(){cancelAnimationFrame(t.current)})),[n,o]}},function(e,t,a){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,a){"use strict";a.d(t,"b",(function(){return sa})),a.d(t,"c",(function(){return oa})),a.d(t,"d",(function(){return la})),a.d(t,"a",(function(){return Ea}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(13),c=a(493),u=a(123),d=a(251),p=a(543),m=a(494),f=a(552),b=a(547),g=a(5);g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const y=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),h=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"When adding Prompt Context throughout the Security App that may contain sensitive information, you can choose which fields are sent, and whether to enable anonymization for these fields. This will replace the field's value with a random string before sending the conversation. Helpful defaults are provided below."}),v=o()(r.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,E=({defaultAllow:e,defaultAllowReplacement:t,pageSize:a,setUpdatedDefaultAllow:s,setUpdatedDefaultAllowReplacement:o})=>{const{baseAllow:c,baseAllowReplacement:d}=Object(u.b)(),g=Object(n.useCallback)((a=>{Object(m.b)({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:s,setDefaultAllowReplacement:o,updates:a})}),[e,t,s,o]),E=Object(n.useCallback)((()=>{s(c),o(d)}),[c,d,s,o]),x=Object(n.useMemo)((()=>{const a=new Set(e);return t.reduce(((e,t)=>a.has(t)?e+1:e),0)}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,y)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"xs"},h),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(l.jsx)(v,{grow:!1},Object(l.jsx)(f.a,{allowed:e.length,total:e.length})),Object(l.jsx)(v,{grow:!1},Object(l.jsx)(b.a,{anonymized:x,isDataAnonymizable:!0}))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(p.a,{allow:e,allowReplacement:t,onListUpdated:g,onReset:E,rawData:null,pageSize:a}))};E.displayName="AnonymizationSettingsComponent";const x=i.a.memo(E);var j=a(47),S=a(73),O=a(45);const k=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),w=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),T=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),I=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),C=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation"});var M=a(495),_=a(496),A=a(551),F=a(498);const P=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.defaultConversationTitle",{defaultMessage:"Conversations"}),D=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.ariaLabel",{defaultMessage:"Conversation selector"}),N=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.placeholderTitle",{defaultMessage:"Select or type to create new..."}),R=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),L=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.previousConversationTitle",{defaultMessage:"Previous conversation"}),B=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.nextConversationTitle",{defaultMessage:"Next conversation"}),z=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.deleteConversationTitle",{defaultMessage:"Delete conversation"});var q={name:"1v0pok0",styles:"min-width:300px"},$={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},V={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},U={name:"1e5733u",styles:"width:calc(100% - 60px)"};const H=i.a.memo((({conversations:e,onConversationDeleted:t,onConversationSelectionChange:a,selectedConversationId:i})=>{const s=Object(n.useMemo)((()=>Object.keys(e)),[e]),[o,c]=Object(n.useState)((()=>Object.values(e).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id,"data-test-subj":e.id}})))),u=Object(n.useMemo)((()=>{var e;return i&&null!==(e=o.filter((e=>e.label===i)))&&void 0!==e?e:[]}),[o,i]),d=Object(n.useCallback)((t=>{var n,i;const r=0===t.length?void 0:null!==(n=Object.values(e).find((e=>{var a;return e.id===(null===(a=t[0])||void 0===a?void 0:a.label)})))&&void 0!==n?n:null===(i=t[0])||void 0===i?void 0:i.label;a(r)}),[a,e]),p=Object(n.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const a=e.trim().toLowerCase(),n={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===a))||c([...o,n]),d([n])}),[o,d]),m=Object(n.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[o,d]),f=Object(n.useCallback)((e=>{var a;c(o.filter((t=>t.label!==e))),(null==u||null===(a=u[0])||void 0===a?void 0:a.label)===e&&d([]),t(e)}),[o,d,t,u]),b=Object(n.useCallback)((()=>{const e=((e,t="")=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]),g=Object(n.useCallback)((()=>{const e=((e,t="")=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]);return Object(l.jsx)(r.EuiFormRow,{label:P,display:"rowCompressed",css:q},Object(l.jsx)(r.EuiComboBox,{"aria-label":D,customOptionText:`${R} {searchValue}`,placeholder:N,singleSelection:{asPlainText:!0},options:o,selectedOptions:u,onChange:m,onCreateOption:p,renderOption:(e,t,a)=>{const{label:n,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:U},Object(l.jsx)(r.EuiHighlight,{search:t,css:V},n)),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:z},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":z,color:"danger","data-test-subj":"delete-conversation",onClick:e=>{e.stopPropagation(),f(n)},css:$}))))},compressed:!0,prepend:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowLeft","data-test-subj":"arrowLeft","aria-label":L,onClick:b,disabled:s.length<=1}),append:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowRight","data-test-subj":"arrowRight","aria-label":B,onClick:g,disabled:s.length<=1})}))}));H.displayName="ConversationSelectorSettings";var Q=a(222),G=a(220),W=a(252);const Z=i.a.memo((({allSystemPrompts:e,defaultConnectorId:t,defaultProvider:a,selectedConversation:s,onSelectedConversationChange:o,conversationSettings:c,http:u,setUpdatedConversationSettings:d,isDisabled:p=!1})=>{const m=Object(n.useMemo)((()=>Object(Q.b)({allSystemPrompts:e,conversation:void 0})),[e]),f=Object(n.useMemo)((()=>Object(Q.b)({allSystemPrompts:e,conversation:s})),[e,s]),{data:b,isSuccess:g}=Object(G.a)({http:u}),y=Object(n.useCallback)((e=>{const n="string"==typeof e?{id:null!=e?e:"",messages:[],apiConfig:{connectorId:t,provider:a,defaultSystemPromptId:null==m?void 0:m.id}}:e;null!=n&&d((e=>({...e,[n.id]:n}))),o(n)}),[t,a,null==m?void 0:m.id,o,d]),h=Object(n.useCallback)((e=>{d((t=>{const{[e]:a,...n}=t;return null!=a?n:t}))}),[d]),v=Object(n.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,defaultSystemPromptId:e}}})))}),[s,d]),E=Object(n.useMemo)((()=>{const e=null==s?void 0:s.apiConfig.connectorId;if(g)return null==b?void 0:b.find((t=>t.id===e))}),[g,b,null==s?void 0:s.apiConfig.connectorId]),x=Object(n.useMemo)((()=>null==s?void 0:s.apiConfig.provider),[null==s?void 0:s.apiConfig.provider]),P=Object(n.useCallback)((e=>{if(null!=s){const t=Object(W.b)(e);d((a=>({...a,[s.id]:{...s,apiConfig:{...s.apiConfig,connectorId:null==e?void 0:e.id,provider:null==t?void 0:t.apiProvider,model:null==t?void 0:t.defaultModel}}})))}}),[s,d]),D=Object(n.useMemo)((()=>{var e,t;const a=null===(e=Object(W.b)(E))||void 0===e?void 0:e.defaultModel;return null!==(t=null==s?void 0:s.apiConfig.model)&&void 0!==t?t:a}),[E,null==s?void 0:s.apiConfig.model]),N=Object(n.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,model:e}}})))}),[s,d]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,k)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},w),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(H,{selectedConversationId:null==s?void 0:s.id,conversations:c,onConversationDeleted:h,onConversationSelectionChange:y}),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:I,helpText:C},Object(l.jsx)(A.a,{allSystemPrompts:e,compressed:!0,conversation:s,isEditing:!0,isDisabled:p,onSystemPromptSelectionChange:v,selectedPrompt:f,showTitles:!0,isSettingsModalVisible:!0,setIsSettingsModalVisible:O.noop})),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:T,helpText:Object(l.jsx)(r.EuiLink,{href:`${u.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(l.jsx)(j.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"Kibana Connector to make requests with"}))},Object(l.jsx)(_.a,{isDisabled:p,onConnectorSelectionChange:P,selectedConnectorId:null==E?void 0:E.id})),!1===(null==E?void 0:E.isPreconfigured)&&x===S.OpenAiProviderType.OpenAi&&Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:M.c,helpText:M.b},Object(l.jsx)(F.b,{onModelSelectionChange:N,selectedModel:D})))}));Z.displayName="ConversationSettings";const K=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"}),J=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),Y=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"ðŸƒ Run Details"}),X=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index"}),ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"ðŸ”® Predictions"}),te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against"}),ae=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"ðŸ§® Evaluation (Optional)"}),ne=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion"}),ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),re=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to"}),se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),le=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run"}),ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),de=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select whichever models you want to evaluate the dataset against"}),pe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (i.e. RAG algos) to evaluate the dataset against"}),fe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),be=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model to perform the final evaluation with"}),ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom" and provide your own evaluation prompt'}),he=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),ve=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables"}),Ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-"'}),je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),Se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),Oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate"}),ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),we=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),Te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties'}),Ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),Ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),Me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var _e=a(177),Ae=a(50),Fe=a(253);const Pe=["elastic-assistant","perform-evaluation"],De=["DefaultAgentExecutor","OpenAIFunctionsExecutor"],Ne=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var Re={name:"1sl5m7u",styles:"min-height:330px"},Le={name:"vc763q",styles:"min-height:300px"},Be={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},ze={name:"yz1nei",styles:"margin-top:16px"};const qe=i.a.memo((({onEvaluationSettingsChange:e})=>{var t,a;const{actionTypeRegistry:s,basePath:o,http:c}=Object(u.b)(),{data:d}=Object(G.a)({http:c}),{data:p,mutate:m,isLoading:f}=(({http:e,toasts:t})=>Object(Ae.useMutation)(Pe,(t=>Object(Fe.d)({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:c}),[b,y]=Object(n.useState)(),h=Object(n.useCallback)((e=>{y(e.target.value)}),[y]),[v,E]=Object(n.useState)(),x=Object(n.useCallback)((e=>{E(e.target.value)}),[E]),[S,O]=Object(n.useState)(".kibana-elastic-ai-assistant-evaluation-results"),k=Object(n.useCallback)((e=>{O(e.target.value)}),[O]),[w,T]=Object(n.useState)(!0),I=Object(n.useMemo)((()=>Object(l.jsx)(r.EuiText,{size:"xs",css:ze},je," (",Object(l.jsx)(r.EuiLink,{color:w?"primary":"text",onClick:()=>T(!0)},Se)," / ",Object(l.jsx)(r.EuiLink,{color:w?"text":"primary",onClick:()=>T(!1)},we),")")),[w]),[C,M]=Object(n.useState)(),_=Object(n.useCallback)((e=>{M(e.target.value)}),[M]),[A,F]=Object(n.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),P=Object(n.useCallback)((e=>{F(e.target.value)}),[F]),[D,N]=Object(n.useState)([]),R=Object(n.useCallback)((e=>{N(e)}),[N]),L=Object(r.euiPaletteComplementary)(null!==(t=null==d?void 0:d.length)&&void 0!==t?t:0),B=Object(n.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.map(((e,t)=>{var a;const n=null===(a=Object(W.b)(e))||void 0===a?void 0:a.apiProvider,i=null!=n?n:Object(W.a)(s.get(e.actionTypeId)),r=e.isPreconfigured?_e.r:i;return{key:e.id,label:`${e.name} (${r})`,color:L[t]}})))&&void 0!==e?e:[]}),[s,d,L]),[z,q]=Object(n.useState)([]),$=Object(n.useCallback)((e=>{q(e)}),[q]),V=Object(n.useCallback)((e=>{const t=e.trim();t&&q([...z,{label:t}])}),[z]),U=Object(n.useMemo)((()=>De.map((e=>({label:e})))),[]),[H,Q]=Object(n.useState)([]),Z=Object(n.useCallback)((e=>{Q(e)}),[Q]),qe=Object(n.useCallback)((e=>{const t=e.trim();t&&Q([{label:t}])}),[Q]),$e=Object(n.useMemo)((()=>Ne),[]),[Ve,Ue]=Object(n.useState)([]),He=Object(n.useCallback)((e=>{Ue(e)}),[Ue]),[Qe,Ge]=Object(n.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),We=Object(n.useCallback)((e=>{Ge(e.target.value)}),[Ge]),Ze=0===D.length||0===z.length||0===S.length,Ke=Object(n.useCallback)((async()=>{const e={models:D.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:z.map((e=>e.label)),dataset:w?void 0:A,datasetName:w?C:void 0,evalModel:Ve.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:Qe,evaluationType:H.map((e=>e.label)),outputIndex:S,projectName:b,runName:v};m(e)}),[C,A,Qe,S,m,b,v,z,H,Ve,D,w]),Je=Object(n.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(o,null!==(e=null==p?void 0:p.evaluationId)&&void 0!==e?e:"")}),[o,p]),Ye=Object(n.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(o,null!==(e=null==p?void 0:p.evaluationId)&&void 0!==e?e:"")}),[o,p]),Xe=(e,t)=>Object(l.jsx)("div",null,Object(l.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiTitle,{size:"xs"},Object(l.jsx)("h3",null,e)))),Object(l.jsx)(r.EuiText,{size:"s"},Object(l.jsx)("p",null,Object(l.jsx)(r.EuiTextColor,{color:"subdued"},t)))),et=Object(n.useMemo)((()=>Xe(Y,X)),[]),tt=Object(n.useMemo)((()=>Xe(ee,te)),[]),at=Object(n.useMemo)((()=>Xe(ae,ne)),[]),nt=Be;return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,K)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},J),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:Y,arrowDisplay:"right",buttonContent:et,buttonProps:{paddingSize:"s",css:nt},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ie,helpText:re},Object(l.jsx)(r.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:h,placeholder:se,value:b}))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:oe,helpText:le},Object(l.jsx)(r.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:x,placeholder:ce,value:v})))),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:I,fullWidth:!0,helpText:w?Oe:Te},w?Object(l.jsx)(r.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:_,placeholder:ke,value:C}):Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:Le,fullWidth:!0,onChange:P,value:A})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Ee,fullWidth:!0,helpText:xe},Object(l.jsx)(r.EuiFieldText,{value:S,onChange:k,"aria-label":"evaluation-output-index-textfield"}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ee,arrowDisplay:"right",buttonContent:tt,buttonProps:{paddingSize:"s",css:nt},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ue,helpText:de},Object(l.jsx)(r.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:B,selectedOptions:D,onChange:R})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:pe,helpText:me},Object(l.jsx)(r.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:V,options:U,selectedOptions:z,onChange:$}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ae,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:nt},buttonContent:at,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:fe,helpText:be},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:B,selectedOptions:Ve,singleSelection:{asPlainText:!0},onChange:He})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ge,helpText:ye},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:Z,onCreateOption:qe,options:$e,selectedOptions:H,singleSelection:{asPlainText:!0}})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:he,fullWidth:!0,helpText:ve},Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:Re,disabled:"custom"!==(null===(a=H[0])||void 0===a?void 0:a.label),fullWidth:!0,onChange:We,value:Qe}))),Object(l.jsx)(r.EuiHorizontalRule,null),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButton,{size:"s",type:"submit",isDisabled:Ze,isLoading:f,onClick:Ke,fill:!0},Ie)),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)(j.FormattedMessage,{defaultMessage:"Fun Facts: Watch the Kibana server logs for progress, and view results in {discover} / {apm} once complete. Will take (many) minutes depending on dataset, and closing this dialog will cancel the evaluation!",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(l.jsx)(r.EuiLink,{external:!0,href:Je,target:"_blank"},Ce),apm:Object(l.jsx)(r.EuiLink,{external:!0,href:Ye,target:"_blank"},Me)}})))),Object(l.jsx)(r.EuiSpacer,{size:"s"}))}));qe.displayName="EvaluationSettings";const $e=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),Ve=(g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."})),Ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),He=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),Qe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),Ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),We=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"Powered by ELSER, the Knowledge Base enables the ability to recall documents and other relevant context within your conversation."}),Ze=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),Ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),Je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"}),Ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),Xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),et=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"}),tt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),at=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),nt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"}),it=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),rt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"}),st=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const a=Object(r.useGeneratedHtmlId)({prefix:"inputRangeSlider"}),s=Object(n.useCallback)((a=>{t({...e,alerts:a.target.checked})}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:$e,css:Object(l.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(l.jsx)(r.EuiSwitch,{checked:e.alerts,compressed:!0,"data-test-subj":"alertsSwitch",label:$e,onChange:s,showLabel:!1})),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(l.jsx)(r.EuiFlexItem,{css:Object(l.css)("width:",300,"px;",""),grow:!1},Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiRange,{"aria-label":He,compressed:!0,"data-test-subj":"alertsRange",disabled:!e.alerts,id:a,max:100,min:10,onChange:a=>t({...e,latestAlerts:Number(a.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(l.jsx)(r.EuiSpacer,{size:"s"})),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,(o=e.latestAlerts,g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:o}}))))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ve))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ue)))));var o},ot=i.a.memo(st),lt=["elastic-assistant","knowledge-base-status"],ct=()=>{const e=Object(Ae.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(lt,{refetchType:"active"})}),[e])},ut=["elastic-assistant","delete-knowledge-base"],dt=["elastic-assistant","post-knowledge-base"],pt="esql";var mt={name:"1tyyxc3",styles:"padding-left:20px"},ft={name:"1tyyxc3",styles:"padding-left:20px"},bt={name:"1tyyxc3",styles:"padding-left:20px"},gt={name:"nvudtm",styles:"padding-left:5px"},yt={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const ht=i.a.memo((({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{var a,s,o;const{http:c}=Object(u.b)(),{data:d,isLoading:p,isFetching:m}=(({http:e,resource:t,toasts:a})=>Object(Ae.useQuery)(lt,(async({signal:a})=>Object(Fe.c)({http:e,resource:t,signal:a})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==a||a.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}))({http:c,resource:pt}),{mutate:f,isLoading:b}=(({http:e,toasts:t})=>{const a=ct();return Object(Ae.useMutation)(dt,(t=>Object(Fe.e)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{a()}})})({http:c}),{mutate:y,isLoading:h}=(({http:e,toasts:t})=>{const a=ct();return Object(Ae.useMutation)(ut,(t=>Object(Fe.a)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.deleteError",{defaultMessage:"Error deleting Knowledge Base"})}))},onSettled:()=>{a()}})})({http:c}),v=null!==(a=null==d?void 0:d.elser_exists)&&void 0!==a&&a,E=null!==(s=(null==d?void 0:d.index_exists)&&(null==d?void 0:d.pipeline_exists))&&void 0!==s&&s,x=null!==(o=null==d?void 0:d.esql_exists)&&void 0!==o&&o,S=p||m||b||h,O=e.assistantLangChain&&(null==d?void 0:d.elser_exists),k=e.assistantLangChain&&O&&E,w=!(null!=d&&d.elser_exists||e.assistantLangChain),T=v?"success":"subdued",I=E?"success":"subdued",C=x?"success":"subdued",M=Object(n.useCallback)((a=>{t({...e,assistantLangChain:a.target.checked}),a.target.checked&&null!=d&&d.elser_exists&&f(pt)}),[null==d?void 0:d.elser_exists,e,t,f]),_=Object(n.useMemo)((()=>S?Object(l.jsx)(r.EuiLoadingSpinner,{size:"s"}):Object(l.jsx)(r.EuiToolTip,{content:w&&Ke,position:"right"},Object(l.jsx)(r.EuiSwitch,{showLabel:!1,"data-test-subj":"assistantLangChainSwitch",disabled:w,checked:e.assistantLangChain,onChange:M,label:Ze,compressed:!0}))),[S,w,e.assistantLangChain,M]),A=Object(n.useCallback)((e=>{e?f():y()}),[y,f]),F=Object(n.useMemo)((()=>S||!O?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:E?"danger":"primary",flush:"left","data-test-subj":"knowledgeBaseActionButton",onClick:()=>A(!E),size:"xs"},E?Xe:Ye)),[O,E,S,A]),P=Object(n.useMemo)((()=>E?Object(l.jsx)("span",{"data-test-subj":"kb-installed"},(".kibana-elastic-ai-assistant-kb",g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:".kibana-elastic-ai-assistant-kb"}}))," ",F):Object(l.jsx)("span",{"data-test-subj":"install-kb"},Je," ",F)),[E,F]),D=Object(n.useCallback)((e=>{e?f(pt):y(pt)}),[y,f]),N=Object(n.useMemo)((()=>S||!k?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:x?"danger":"primary",flush:"left","data-test-subj":"esqlEnableButton",onClick:()=>D(!x),size:"xs"},x?Xe:Ye)),[S,k,x,D]),R=Object(n.useMemo)((()=>x?Object(l.jsx)("span",{"data-test-subj":"esql-installed"},rt," ",N):Object(l.jsx)("span",{"data-test-subj":"install-esql"},it," ",N)),[N,x]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Qe," ",Object(l.jsx)(r.EuiBetaBadge,{iconType:"beaker",label:Ge,size:"s",color:"hollow"}))),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},We),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:Ze,css:yt},_),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s",css:gt},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:T},et),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:bt},Object(l.jsx)(j.FormattedMessage,{defaultMessage:"Configure ELSER within {machineLearning} to get started. {seeDocs}",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettings.knowledgeBaseDescription",values:{machineLearning:Object(l.jsx)(r.EuiLink,{external:!0,href:c.basePath.prepend("/app/ml/trained_models"),target:"_blank"},tt),seeDocs:Object(l.jsx)(r.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/machine-learning/current/ml-nlp-elser.html#download-deploy-elser",target:"_blank"},at)}})))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:I},Ze),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:ft},P))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)("span",null,Object(l.jsx)(r.EuiHealth,{color:C},nt),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:mt},R)))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(ot,{knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t}))}));ht.displayName="KnowledgeBaseSettings";const vt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),Et=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),xt=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),jt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),St=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),Ot=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),kt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),wt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select the Prompt Contexts that this Quick Prompt will be available for. Selecting none will make this Quick Prompt available at all times."}),Tt=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."})),It=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),Ct=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var Mt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},_t={name:"d3v9zr",styles:"overflow:hidden"},At={name:"1e5733u",styles:"width:calc(100% - 60px)"};const Ft=i.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:a,onQuickPromptSelectionChange:i,selectedQuickPrompt:s})=>{const[o,c]=Object(n.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.title,"data-test-subj":e.title,color:e.color}}))),u=Object(n.useMemo)((()=>s?[{value:{isDefault:!0},label:s.title,color:s.color}]:[]),[s]),d=Object(n.useCallback)((e=>{var a,n;const r=0===e.length?void 0:null!==(a=t.find((t=>{var a;return t.title===(null===(a=e[0])||void 0===a?void 0:a.label)})))&&void 0!==a?a:null===(n=e[0])||void 0===n?void 0:n.label;i(r)}),[i,t]),p=Object(n.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const a=e.trim().toLowerCase(),n={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===a))||c([...o,n]),d([n])}),[d,o]),m=Object(n.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,o]),f=Object(n.useCallback)((e=>{var t;c(o.filter((t=>t.label!==e))),(null==u||null===(t=u[0])||void 0===t?void 0:t.label)===e&&d([]),a(e)}),[d,a,o,u]);return Object(l.jsx)(r.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":Tt,compressed:!0,isDisabled:e,placeholder:Tt,customOptionText:`${Ct} {searchValue}`,singleSelection:!0,options:o,selectedOptions:u,onChange:m,onCreateOption:p,renderOption:(e,t,a)=>{const{color:n,label:i,value:s}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:At},Object(l.jsx)(r.EuiHealth,{color:n,css:_t},Object(l.jsx)(r.EuiHighlight,{search:t},i))),!(null!=s&&s.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiToolTip,{position:"right",content:It},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":It,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),f(i)},css:Mt}))))},fullWidth:!0})}));Ft.displayName="QuickPromptSelector";const Pt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),Dt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."}),Nt=i.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:a,selectedPromptContexts:i=[]})=>{const s=Object(n.useMemo)((()=>a.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[a]),o=Object(n.useMemo)((()=>null!=i?i.map((e=>({value:{category:e.category},label:e.description}))):[]),[i]),c=Object(n.useCallback)((e=>{const n=a.filter((t=>e.some((e=>t.description===e.label))));t(n)}),[t,a]),u=Object(n.useCallback)((e=>{0===e.length?c([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&c(e)}),[c,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Pt,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:Dt,options:s,selectedOptions:o,onChange:u,renderOption:(e,t,a)=>{const{label:n,value:i}=e;return Object(l.jsx)("span",{className:a},Object(l.jsx)(r.EuiHighlight,{search:t},n),Object(l.jsx)("span",null,` / (${null==i?void 0:i.category})`))}})}));Nt.displayName="PromptContextSelector";const Rt="#D36086";var Lt={name:"xpz1vu",styles:"min-height:150px"};const Bt=i.a.memo((({onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:a,setUpdatedQuickPromptSettings:s})=>{const{basePromptContexts:o}=Object(u.b)(),c=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.prompt)&&void 0!==e?e:""}),[null==a?void 0:a.prompt]),d=Object(n.useCallback)((e=>{null!=a&&s((t=>t.some((e=>e.title===a.title))?t.map((t=>t.title===a.title?{...t,prompt:e.target.value}:t)):t))}),[a,s]),p=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.color)&&void 0!==e?e:Rt}),[null==a?void 0:a.color]),m=Object(n.useCallback)(((e,{hex:t,isValid:n})=>{null!=a&&s((t=>t.some((e=>e.title===a.title))?t.map((t=>t.title===a.title?{...t,color:e}:t)):t))}),[a,s]),f=Object(n.useMemo)((()=>{var e;return null!==(e=o.filter((e=>{var t;return null==a||null===(t=a.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[o,null==a?void 0:a.categories]),b=Object(n.useCallback)((e=>{null!=a&&s((t=>t.some((e=>e.title===a.title))?t.map((t=>t.title===a.title?{...t,categories:e.map((e=>e.category))}:t)):t))}),[a,s]),g=Object(n.useCallback)((t=>{const a="string"==typeof t?{title:null!=t?t:"",prompt:"",color:Rt,categories:[]}:t;null!=a&&s((e=>e.some((e=>e.title===a.title))?e:[...e,a])),e(a)}),[e,s]),y=Object(n.useCallback)((e=>{s((t=>t.filter((t=>t.title!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,vt)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},Et),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{label:xt,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(Ft,{onQuickPromptDeleted:y,onQuickPromptSelectionChange:g,quickPrompts:t,selectedQuickPrompt:a})),Object(l.jsx)(r.EuiFormRow,{label:jt,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{compressed:!0,disabled:null==a,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:d,placeholder:St,value:c,css:Lt})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:kt,helpText:wt},Object(l.jsx)(Nt,{isDisabled:null==a,onPromptContextSelectionChange:b,promptContexts:o,selectedPromptContexts:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Ot},Object(l.jsx)(r.EuiColorPicker,{color:p,compressed:!0,disabled:null==a,onChange:m})))}));Bt.displayName="AddQuickPromptModal";const zt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),$t=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),Vt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),Ut=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),Ht=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),Qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),Gt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default"}),Wt=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),i.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:a,selectedConversations:i=[]})=>{const s=Object(n.useMemo)((()=>e.map((e=>({label:e.id,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.id)})))),[e]),o=Object(n.useMemo)((()=>null!=i?i.map((e=>({label:e.id}))):[]),[i]),c=Object(n.useCallback)((t=>{const n=e.filter((e=>t.some((t=>e.id===t.label))));a(n)}),[a,e]),u=Object(n.useCallback)((e=>{0===e.length?c([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&c(e)}),[c,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Ht,compressed:!0,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:s,selectedOptions:o,onChange:u})})));Wt.displayName="ConversationMultiSelector";const Zt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),Kt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),Jt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var Yt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},Xt={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},ea={name:"qhxz92",styles:"max-width:100%"},ta={name:"1e5733u",styles:"width:calc(100% - 60px)"};const aa=i.a.memo((({autoFocus:e=!1,systemPrompts:t,onSystemPromptDeleted:a,onSystemPromptSelectionChange:i,selectedSystemPrompt:s})=>{const[o,c]=Object(n.useState)(t.map((e=>{var t,a;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(a=e.isNewConversationDefault)&&void 0!==a&&a},label:e.name,"data-test-subj":`${d.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),u=Object(n.useMemo)((()=>{var e,t;return s?[{value:{isDefault:null!==(e=s.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=s.isNewConversationDefault)&&void 0!==t&&t},label:s.name}]:[]}),[s]),p=Object(n.useCallback)((e=>{var a,n;const r=0===e.length?void 0:null!==(a=t.find((t=>{var a;return t.name===(null===(a=e[0])||void 0===a?void 0:a.label)})))&&void 0!==a?a:null===(n=e[0])||void 0===n?void 0:n.label;i(r)}),[i,t]),m=Object(n.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const a=e.trim().toLowerCase(),n={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===a))||c([...o,n]),p([n])}),[p,o]),f=Object(n.useCallback)((e=>{0===e.length?p([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&p(e)}),[p,o]),b=Object(n.useCallback)((e=>{var t;c(o.filter((t=>t.label!==e))),(null==u||null===(t=u[0])||void 0===t?void 0:t.label)===e&&p([]),a(e)}),[p,a,o,u]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Zt,className:"systemPromptSelector",compressed:!0,"data-test-subj":d.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:Zt,customOptionText:`${Jt} {searchValue}`,singleSelection:{asPlainText:!0},options:o,selectedOptions:u,onChange:f,onCreateOption:m,renderOption:(e,t,a)=>{const{label:n,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span",css:ta},Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:ea},Object(l.jsx)(r.EuiHighlight,{search:t,css:Xt},n)),(null==i?void 0:i.isNewConversationDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Qt},Object(l.jsx)(r.EuiIcon,{type:"starFilled"}))))),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Kt},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":Kt,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),b(n)},css:Yt}))))},autoFocus:e})}));aa.displayName="SystemPromptSelector";var na={name:"xpz1vu",styles:"min-height:150px"};const ia=i.a.memo((({conversationSettings:e,onSelectedSystemPromptChange:t,selectedSystemPrompt:a,setUpdatedSystemPromptSettings:s,setUpdatedConversationSettings:o,systemPromptSettings:c})=>{const u=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.content)&&void 0!==e?e:""}),[null==a?void 0:a.content]),p=Object(n.useCallback)((e=>{null!=a&&s((t=>t.some((e=>e.id===a.id))?t.map((t=>t.id===a.id?{...t,content:e.target.value}:t)):t))}),[a,s]),m=Object(n.useMemo)((()=>Object.values(e)),[e]),f=Object(n.useMemo)((()=>null!=a?Object.values(e).filter((e=>e.apiConfig.defaultSystemPromptId===a.id)):[]),[e,a]),b=Object(n.useCallback)((e=>{const t=e.map((e=>e.id));null!=a&&o((e=>Object(O.keyBy)("id",Object.values(e).map((e=>({...e,apiConfig:{...e.apiConfig,defaultSystemPromptId:t.includes(e.id)?null==a?void 0:a.id:e.apiConfig.defaultSystemPromptId===(null==a?void 0:a.id)?void 0:e.apiConfig.defaultSystemPromptId}}))))))}),[a,o]),g=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.isNewConversationDefault)&&void 0!==e&&e}),[null==a?void 0:a.isNewConversationDefault]),y=Object(n.useCallback)((e=>{const t=e.target.checked;null!=a&&s((e=>e.map((e=>({...e,isNewConversationDefault:a.id===e.id&&t})))))}),[a,s]),h=Object(n.useCallback)((e=>{const a="string"==typeof e?{id:null!=e?e:"",content:"",name:null!=e?e:"",promptType:"system"}:e;null!=a&&s((e=>e.some((e=>e.id===a.id))?e:[...e,a])),t(a)}),[t,s]),v=Object(n.useCallback)((e=>{s((t=>t.filter((t=>t.id!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,zt)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},qt),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:$t,fullWidth:!0},Object(l.jsx)(aa,{onSystemPromptDeleted:v,onSystemPromptSelectionChange:h,systemPrompts:c,selectedSystemPrompt:a})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Vt,fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==a,onChange:p,placeholder:Ut,value:u,compressed:!0,fullWidth:!0,css:na})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:Gt,label:Ht},Object(l.jsx)(Wt,{conversations:m,isDisabled:null==a,onConversationSelectionChange:b,selectedConversations:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed"},Object(l.jsx)(r.EuiCheckbox,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==a,id:"defaultNewConversation",label:Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(l.jsx)(r.EuiFlexItem,null,Qt),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiIcon,{type:g?"starFilled":"starEmpty"}))),checked:g,onChange:y,compressed:!0})))}));ia.displayName="SystemPromptSettings";const ra=o()(r.EuiModal)`
  width: 800px;
  height: 575px;
`,sa="CONVERSATION_TAB",oa="QUICK_PROMPTS_TAB",la="SYSTEM_PROMPTS_TAB",ca="ANONYMIZATION_TAB",ua="KNOWLEDGE_BASE_TAB",da="EVALUATION_TAB";var pa={name:"1r962iv",styles:"padding:4px"},ma={name:"1tk8yx0",styles:"padding:8px"},fa={name:"zd35ug",styles:"max-height:550px;overflow-y:scroll"},ba={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},ga={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},ya={name:"57t0bw",styles:"position:relative;transform:rotateY(180deg);top:-7px"},ha={name:"15ag9ng",styles:"position:relative;top:-10px"},va={name:"18wygtw",styles:"min-inline-size:unset!important;max-width:104px"};const Ea=i.a.memo((({defaultConnectorId:e,defaultProvider:t,onClose:a,onSave:s,selectedConversation:o,setSelectedConversationId:p})=>{const{modelEvaluatorEnabled:m,http:f,selectedSettingsTab:b,setSelectedSettingsTab:g}=Object(u.b)(),{conversationSettings:y,defaultAllow:h,defaultAllowReplacement:v,knowledgeBase:E,quickPromptSettings:j,systemPromptSettings:S,setUpdatedConversationSettings:O,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w,setUpdatedKnowledgeBaseSettings:T,setUpdatedQuickPromptSettings:I,setUpdatedSystemPromptSettings:C,saveSettings:M}=(()=>{const{allQuickPrompts:e,allSystemPrompts:t,conversations:a,defaultAllow:i,defaultAllowReplacement:r,knowledgeBase:s,setAllQuickPrompts:o,setAllSystemPrompts:l,setConversations:c,setDefaultAllow:d,setDefaultAllowReplacement:p,setKnowledgeBase:m}=Object(u.b)(),[f,b]=Object(n.useState)(a),[g,y]=Object(n.useState)(e),[h,v]=Object(n.useState)(t),[E,x]=Object(n.useState)(i),[j,S]=Object(n.useState)(r),[O,k]=Object(n.useState)(s),w=Object(n.useCallback)((()=>{b(a),y(e),k(s),v(t),x(i),S(r)}),[e,t,a,i,r,s]),T=Object(n.useCallback)((()=>{o(g),l(h),c(f),m(O),d(E),p(j)}),[o,l,c,d,p,m,f,E,j,O,g,h]);return{conversationSettings:f,defaultAllow:E,defaultAllowReplacement:j,knowledgeBase:O,quickPromptSettings:g,resetSettings:w,systemPromptSettings:h,saveSettings:T,setUpdatedDefaultAllow:x,setUpdatedDefaultAllowReplacement:S,setUpdatedConversationSettings:b,setUpdatedKnowledgeBaseSettings:k,setUpdatedQuickPromptSettings:y,setUpdatedSystemPromptSettings:v}})(),[_,A]=Object(n.useState)((()=>y[o.id])),F=Object(n.useCallback)((e=>{A(e)}),[]);Object(n.useEffect)((()=>{null!=_&&A(y[_.id])}),[y,_]);const[P,D]=Object(n.useState)(),N=Object(n.useCallback)((e=>{D(e)}),[]);Object(n.useEffect)((()=>{null!=P&&D(j.find((e=>e.title===P.title)))}),[j,P]);const[R,L]=Object(n.useState)(),B=Object(n.useCallback)((e=>{L(e)}),[]);Object(n.useEffect)((()=>{null!=R&&L(S.find((e=>e.id===R.id)))}),[R,S]);const z=Object(n.useCallback)((()=>{const e=null==y[o.id],t=Object.keys(y)[0];e&&null!=t&&p(y[t].id),M(),s()}),[y,o.id,s,M,p]);return Object(l.jsx)(ra,{"data-test-subj":d.a.SETTINGS_MODAL,onClose:a},Object(l.jsx)(r.EuiPage,{paddingSize:"none"},Object(l.jsx)(r.EuiPageSidebar,{paddingSize:"xs",css:va},Object(l.jsx)(r.EuiKeyPadMenu,null,Object(l.jsx)(r.EuiKeyPadMenuItem,{id:sa,label:c.c,isSelected:b===sa,onClick:()=>g(sa),"data-test-subj":`${sa}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xl",css:ha}),Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"l",css:ya}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:oa,label:c.f,isSelected:b===oa,onClick:()=>g(oa),"data-test-subj":`${oa}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"bolt",size:"s",color:"warning",css:ga}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:la,label:c.k,isSelected:b===la,onClick:()=>g(la),"data-test-subj":`${la}-button`},Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"storage",size:"s",color:"success",css:ba})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:ca,label:c.a,isSelected:b===ca,onClick:()=>g(ca),"data-test-subj":`${ca}-button`},Object(l.jsx)(r.EuiIcon,{type:"eyeClosed",size:"l"})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:ua,label:c.e,isSelected:b===ua,onClick:()=>g(ua),"data-test-subj":`${ua}-button`},Object(l.jsx)(r.EuiIcon,{type:"notebookApp",size:"l"})),m&&Object(l.jsx)(r.EuiKeyPadMenuItem,{id:da,label:c.d,isSelected:b===da,onClick:()=>g(da),"data-test-subj":`${da}-button`},Object(l.jsx)(r.EuiIcon,{type:"crossClusterReplicationApp",size:"l"})))),Object(l.jsx)(r.EuiPageBody,{paddingSize:"none",panelled:!0},Object(l.jsx)(r.EuiSplitPanel.Outer,{grow:!0},Object(l.jsx)(r.EuiSplitPanel.Inner,{className:"eui-scrollBar",grow:!0,css:fa},b===sa&&Object(l.jsx)(Z,{defaultConnectorId:e,defaultProvider:t,conversationSettings:y,setUpdatedConversationSettings:O,allSystemPrompts:S,selectedConversation:_,isDisabled:null==_,onSelectedConversationChange:F,http:f}),b===oa&&Object(l.jsx)(Bt,{quickPromptSettings:j,onSelectedQuickPromptChange:N,selectedQuickPrompt:P,setUpdatedQuickPromptSettings:I}),b===la&&Object(l.jsx)(ia,{conversationSettings:y,systemPromptSettings:S,onSelectedSystemPromptChange:B,selectedSystemPrompt:R,setUpdatedConversationSettings:O,setUpdatedSystemPromptSettings:C}),b===ca&&Object(l.jsx)(x,{defaultAllow:h,defaultAllowReplacement:v,pageSize:5,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w}),b===ua&&Object(l.jsx)(ht,{knowledgeBase:E,setUpdatedKnowledgeBaseSettings:T}),b===da&&Object(l.jsx)(qe,null)),Object(l.jsx)(r.EuiSplitPanel.Inner,{grow:!1,color:"subdued",css:ma},Object(l.jsx)(r.EuiModalFooter,{css:pa},Object(l.jsx)(r.EuiButtonEmpty,{size:"s","data-test-subj":"cancel-button",onClick:a},c.b),Object(l.jsx)(r.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:z,fill:!0},c.g)))))))}));Ea.displayName="AssistantSettings"},function(e,t,a){"use strict";a.d(t,"a",(function(){return R})),a.d(t,"b",(function(){return L})),a.d(t,"c",(function(){return B})),a.d(t,"d",(function(){return z}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(5),l=a(17),c=a(47),u=a(44),d=a.n(u),p=a(59),m=a.n(p),f=a(115);const b=d()(l.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-n74boe-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),g=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:a,actions:n,headerHasBottomBorder:i,restrictWidth:o,paddingSize:c="l",scrollableBody:u=!1,headerBackComponent:d,children:p,"data-test-subj":g})=>{const y=!(e||t||n||d),h=Object(f.a)(g),v=Object(r.useMemo)((()=>Array.isArray(n)?n:n?[n]:void 0),[n]),E=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),x=Object(r.useMemo)((()=>m()({"is-scrollable":u,"is-not-scrollable":!u,"full-height":!0})),[u]),j=Object(r.useMemo)((()=>y?null:s.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},d&&s.a.createElement(l.EuiFlexItem,{grow:!1},d),s.a.createElement(l.EuiSpacer,{size:"m"}),s.a.createElement(l.EuiFlexItem,{grow:!1},s.a.createElement(l.EuiTitle,{size:"l"},s.a.createElement("span",{"data-test-subj":h("titleHolder")},e))))),[h,d,y,e]);return s.a.createElement(b,{hasShadow:!1,paddingSize:c,"data-test-subj":g,className:"full-height",color:"transparent"},s.a.createElement(l.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":h("root")},!y&&s.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":h("headerContainer")},s.a.createElement(l.EuiPageHeader,{pageTitle:j,description:t,bottomBorder:i,rightSideItems:v,rightSideGroupProps:E,restrictWidth:o,alignItems:"bottom","data-test-subj":h("header")}),s.a.createElement(l.EuiSpacer,{size:"l"})),s.a.createElement(l.EuiFlexItem,{grow:!1},a),s.a.createElement(l.EuiFlexItem,{grow:!0,className:x,"data-test-subj":h("consoleBody")},s.a.createElement("div",{role:"main",className:"full-height"},p))))}));g.displayName="PageLayout";var y=a(49),h=a(152),v=a(189),E=a(214);const x=d.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-vostrz-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:var(--euiFixedHeadersOffset,0);bottom:0;right:0;height:calc(100% - var(--euiFixedHeadersOffset,0));width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiZFlyout),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),j="securitySolution-pageOverlay",S=`${j}-isVisible`,O=`${j}-lock`,k=`${j}-fullScreen`,w=`${j}-overSecuritySolutionPageWrapper`,T=Object(u.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}"],O,k,E.e),I=()=>{document.body.classList.remove(S)},C=()=>{document.body.classList.remove(O)},M=()=>{document.body.classList.remove(k)},_=()=>{document.body.classList.remove(w)},A=Object(r.memo)((({children:e,onHide:t,isHidden:a=!1,enableScrolling:n=!0,hideOnUrlPathnameChange:i=!0,lockDocumentBody:o=!0,appendAsBodyLastNode:c=!0,paddingSize:u,zIndex:d,"data-test-subj":p})=>{const{pathname:f}=Object(y.useLocation)(),b=Object(h.b)(),g=Object(v.b)(),[E,A]=Object(r.useState)(null),F=Object(r.useRef)(),P=Object(r.useCallback)((e=>{F.current=e}),[]),D=Object(r.useMemo)((()=>{const e={};return d&&(e.zIndex=d),e}),[d]),N=Object(r.useMemo)((()=>m()({[j]:!0,scrolling:n,hidden:a,fullScreen:g,"eui-scrollBar":n,"padding-xs":"xs"===u,"padding-s":"s"===u,"padding-m":"m"===u,"padding-l":"l"===u,"padding-xl":"xl"===u})),[n,a,u,g]);return Object(r.useEffect)((()=>{b()&&A((e=>a?null:e||(c&&F.current&&document.body.appendChild(F.current),f)))}),[c,a,b,f]),Object(r.useEffect)((()=>{b()&&i&&!a&&E&&E!==f&&t()}),[i,a,b,t,E,f]),Object(r.useEffect)((()=>{if(b()){const e=Boolean(document.querySelector(".securitySolutionWrapper"));a?(I(),C(),M(),_()):(document.body.classList.add(S),o&&document.body.classList.add(O),g&&document.body.classList.add(k),e&&document.body.classList.add(w))}return()=>{C(),I(),M(),_()}}),[a,b,o,g]),s.a.createElement(l.EuiPortal,{portalRef:P},s.a.createElement(x,{"data-test-subj":p,className:N,style:D},s.a.createElement(l.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),s.a.createElement(T,null))}));A.displayName="PageOverlay";const F=o.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),P=Object(r.memo)((({console:e,onHide:t,isHidden:a,body:n,actions:i,pageTitle:o="",showCloseButton:u=!1})=>{const d=Object(f.a)("consolePageOverlay"),p=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),m=Object(r.useMemo)((()=>a?{}:{pageTitle:o,pageBody:n,headerHasBottomBorder:!1,"data-test-subj":d("layout"),headerBackComponent:s.a.createElement(l.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:p,"data-test-subj":d("header-back-link")},F),actions:u?[s.a.createElement(l.EuiButton,{fill:!0,onClick:p,minWidth:"auto","data-test-subj":d("doneButton")},s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=i?i:[]]:[...null!=i?i:[]]}),[i,n,d,p,a,o,u]);return s.a.createElement(A,{isHidden:a,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},s.a.createElement(g,m,e))}));P.displayName="ConsolePageOverlay";var D=a(685);const N=s.a.createContext(void 0),R=Object(r.memo)((({storage:e={},children:t})=>{const[a,n]=Object(r.useState)(e),[o]=Object(r.useState)(new Map),l=Object(r.useRef)();l.current=a;const c=Object(r.useCallback)((e=>{var t;if(null===(t=l.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),u=Object(r.useCallback)((e=>{c(e),n((t=>{const a={...t};return Object.entries(a).forEach((([e,t])=>{t.isOpen&&(a[e]={...t,isOpen:!1})})),a[e]={...a[e],isOpen:!0},a}))}),[c]),d=Object(r.useCallback)((e=>{c(e),n((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[c]),p=Object(r.useCallback)((e=>{c(e),n((t=>{const a={...t};return delete a[e],a}))}),[c]),m=Object(r.useCallback)((e=>{var t;if(null!==(t=l.current)&&void 0!==t&&t[e])return l.current[e].client}),[]),f=Object(r.useCallback)((()=>Object.values(a).map((e=>e.client))),[a]),b=Object(r.useCallback)((e=>{var t;return!(null===(t=l.current)||void 0===t||!t[e])&&l.current[e].isOpen}),[]),g=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...o})=>{if(a[e])throw new Error(`Console with id ${e} already registered`);const l=Symbol(e),c=u.bind(null,e),m=d.bind(null,e),f=p.bind(null,e),g=b.bind(null,e),y={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...o,client:{id:e,meta:t,show:()=>{setTimeout(c,0)},hide:()=>{setTimeout(m,0)},terminate:()=>{setTimeout(f,0)},isVisible:()=>g()},consoleProps:r,console:s.a.createElement(D.a,i()({},r,{managedKey:l,key:e})),isOpen:!1,key:l};return n((t=>({...t,[e]:y}))),y.client}),[a,d,b,u,p]),y=Object(r.useMemo)((()=>({register:g,show:u,hide:d,terminate:p,getOne:m,getList:f})),[f,m,d,g,u,p]),h=Object(r.useMemo)((()=>({client:y,internal:{getManagedConsole:e=>Object.values(a).find((t=>t.key===e)),getManagedConsoleState:e=>o.get(e),storeManagedConsoleState(e,t){o.set(e,t)}}})),[y,o,a]),v=Object(r.useMemo)((()=>Object.values(a).find((e=>e.isOpen))),[a]),E=Object(r.useMemo)((()=>{var e;return null!==(e=null==v?void 0:v.client.meta)&&void 0!==e?e:{}}),[null==v?void 0:v.client.meta]),x=Object(r.useCallback)((()=>{v&&y.hide(v.client.id)}),[y,v]);return s.a.createElement(N.Provider,{value:h},t,v&&s.a.createElement(P,{onHide:x,console:s.a.createElement(D.a,i()({},v.consoleProps,{managedKey:v.key,key:v.client.id})),isHidden:!v,pageTitle:v.PageTitleComponent&&s.a.createElement(v.PageTitleComponent,{meta:E}),body:v.PageBodyComponent&&s.a.createElement(v.PageBodyComponent,{meta:E}),actions:v.ActionComponents&&v.ActionComponents.map((e=>s.a.createElement(e,{meta:E}))),showCloseButton:v.showCloseButton}))}));R.displayName="ConsoleManager";const L=()=>{const e=Object(r.useContext)(N);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},B=e=>{const t=Object(r.useContext)(N);if(e&&t)return t.internal.getManagedConsole(e)},z=e=>{const t=Object(r.useContext)(N);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),a=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,a)}]:[void 0,void 0]),[t,e])}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(135);const r=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:a,kibanaSecuritySolutionsPrivileges:{crud:r,read:s}}=Object(i.a)();return Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:r,hasKibanaREAD:s})}),[a.error,r,s]),Object(n.useEffect)((()=>{if(null!=a.result){const e=a.result;if(null!=e.index&&Object.keys(e.index).length>0){const a=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[a].manage&&e.cluster.manage,hasIndexMaintenance:e.index[a].maintenance,hasIndexRead:e.index[a].read,hasIndexWrite:e.index[a].create||e.index[a].create_doc||e.index[a].index||e.index[a].write,hasIndexUpdateDelete:e.index[a].write,hasKibanaCRUD:r,hasKibanaREAD:s})}}}),[a.result,r,s]),{loading:a.loading,...e}}},,function(e,t,a){"use strict";var n=a(362);a.d(t,"a",(function(){return n.b})),a.d(t,"b",(function(){return n.c}))},function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"i",(function(){return g})),a.d(t,"e",(function(){return y})),a.d(t,"g",(function(){return h})),a.d(t,"h",(function(){return v})),a.d(t,"f",(function(){return E})),a.d(t,"d",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return S}));var n=a(62),i=a(17),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(4),u=a(110);const d="100%",p=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));p.displayName="WrappedByAutoSizer";const m=s.a.memo(p);let f;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(f||(f={}));const b={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},g=()=>({baseTheme:Object(u.n)(c.C)?n.DARK_THEME:n.LIGHT_THEME,theme:b}),y={rotation:0,rendering:"canvas",showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:n.Position.Bottom},h=(e,t)=>{const a=e||t;return a?`${a}px`:d},v=(e,t)=>{const a=e||t;return a?`${a}px`:"100%"},E=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),x=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),j=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),S=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"])},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(5);let i,r;!function(e){e.rules="rules",e.alertsCases="alertsCases"}(i||(i={})),function(e){e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase"}(r||(r={}));const s={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},o=(e,t)=>`tourStepAnchor-${t}-${e}`,l=[{...s,step:r.pointToAlertName,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:o(r.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...s,step:r.expandEvent,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:o(r.expandEvent,i.alertsCases)},{...s,step:r.reviewAlertDetailsFlyout,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${o(r.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:o(r.reviewAlertDetailsFlyout,i.alertsCases)},{...s,step:r.addAlertToCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:o(r.addAlertToCase,i.alertsCases)},{...s,step:r.createCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:o(r.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...s,step:r.submitCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:o(r.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...s,step:r.viewCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:o(r.viewCase,i.alertsCases)}],c={title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},u={[i.rules]:[],[i.alertsCases]:l}},,function(e,t,a){"use strict";e.exports=a(613)},function(e,t,a){"use strict";e.exports=a(619)},function(e,t,a){"use strict";const n=a(624);e.exports=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new n(t)}}},,function(e,t,a){"use strict";a.d(t,"k",(function(){return i})),a.d(t,"l",(function(){return r})),a.d(t,"m",(function(){return s})),a.d(t,"n",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"p",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"j",(function(){return f})),a.d(t,"c",(function(){return b})),a.d(t,"d",(function(){return g})),a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return h})),a.d(t,"o",(function(){return v}));var n=a(4);const i="matched.atomic",r="matched.field",s="matched.id",o="matched.type",l=[i,r,o],c=`${n.rb}.${r}`,u=`${n.rb}.${o}`,d="indicator.first_seen",p="indicator.reference",m="feed.name",f=`${n.rb}.${p}`;let b;!function(e){e.InvestigationTime="investigation_time",e.IndicatorMatchRule="indicator_match_rule"}(b||(b={}));const g={"file.hash.md5":`${n.J}.file.hash.md5`,"file.hash.sha1":`${n.J}.file.hash.sha1`,"file.hash.sha256":`${n.J}.file.hash.sha256`,"file.pe.imphash":`${n.J}.file.pe.imphash`,"file.elf.telfhash":`${n.J}.file.elf.telfhash`,"file.hash.ssdeep":`${n.J}.file.hash.ssdeep`,"source.ip":`${n.J}.ip`,"destination.ip":`${n.J}.ip`,"url.full":`${n.J}.url.full`,"registry.path":`${n.J}.registry.path`},y="now-30d",h="now",v="_others_ti_"},function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(46),i=a(120);n.string,n.boolean;const r=n.string,s=(n.union([r,n[void 0]]),i.m),o=n.keyof({open:null,closed:null,acknowledged:null,"in-progress":null}),l=n.keyof({abort:null,proceed:null}),c=n.array(n.string),u=n.object,d=n.array(n.string),p=n.record(n.string,n.type({all:n.boolean,maintenance:n.boolean,manage_ilm:n.boolean,read:n.boolean,create_index:n.boolean,read_cross_cluster:n.boolean,index:n.boolean,monitor:n.boolean,delete:n.boolean,manage:n.boolean,delete_index:n.boolean,create_doc:n.boolean,view_index_metadata:n.boolean,create:n.boolean,manage_follow_index:n.boolean,manage_leader_index:n.boolean,write:n.boolean})),m=(n.type({username:n.string,has_all_requested:n.boolean,cluster:n.type({monitor_ml:n.boolean,manage_ccr:n.boolean,manage_index_templates:n.boolean,monitor_watcher:n.boolean,monitor_transform:n.boolean,read_ilm:n.boolean,manage_security:n.boolean,manage_own_api_key:n.boolean,manage_saml:n.boolean,all:n.boolean,manage_ilm:n.boolean,manage_ingest_pipelines:n.boolean,read_ccr:n.boolean,manage_rollup:n.boolean,monitor:n.boolean,manage_watcher:n.boolean,manage:n.boolean,manage_transform:n.boolean,manage_token:n.boolean,manage_ml:n.boolean,manage_pipeline:n.boolean,monitor_rollup:n.boolean,transport_client:n.boolean,create_snapshot:n.boolean}),index:p,is_authenticated:n.boolean,has_encryption_key:n.boolean}),n.type({tags_to_add:n.array(n.string),tags_to_remove:n.array(n.string)}));n.string},function(e,t,a){e.exports=a(24)(288)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(45);const l=s.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),c=i.a.memo((({show:e=!0,targetClassNames:t,children:a})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},a):i.a.createElement(i.a.Fragment,null,a)));c.displayName="HoverVisibilityContainer"},function(e,t,a){"use strict";a.d(t,"c",(function(){return v})),a.d(t,"l",(function(){return K})),a.d(t,"m",(function(){return O})),a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return T})),a.d(t,"e",(function(){return J})),a.d(t,"f",(function(){return Y})),a.d(t,"g",(function(){return X})),a.d(t,"h",(function(){return I})),a.d(t,"i",(function(){return M})),a.d(t,"n",(function(){return Q})),a.d(t,"t",(function(){return ee})),a.d(t,"r",(function(){return te})),a.d(t,"p",(function(){return ae})),a.d(t,"o",(function(){return re})),a.d(t,"s",(function(){return se})),a.d(t,"q",(function(){return oe})),a.d(t,"j",(function(){return ce})),a.d(t,"k",(function(){return ue})),a.d(t,"d",(function(){return l}));var n=a(120),i=a(46);const r=i.recursion("saved_object_attribute_single",(()=>i.union([i.string,i.number,i.boolean,i.null,i[void 0],o]))),s=i.recursion("saved_object_attribute",(()=>i.union([r,i.array(r)]))),o=i.recursion("saved_object_attributes",(()=>i.record(i.string,s))),l=i.union([i.literal("no_actions"),i.literal("rule"),Object(n.p)({allowedUnits:["s","m","h","d"]})]),c=i.boolean,u=i.union([i.literal("onActionGroupChange"),i.literal("onActiveAlert"),i.literal("onThrottleInterval")]),d=i.type({summary:c,notifyWhen:u,throttle:i.union([l,i.null])}),p=i.string,m=i.string,f=i.string,b=n.j,g=o,y=i.partial({query:i.union([i[void 0],i.intersection([i.strict({kql:i.string,filters:i.array(i.intersection([i.type({meta:i.partial({alias:i.union([i.string,i.null]),disabled:i.boolean,negate:i.boolean,controlledBy:i.string,group:i.string,index:i.string,isMultiIndex:i.boolean,type:i.string,key:i.string,params:i.any,value:i.string})}),i.partial({$state:i.type({store:i.any}),query:i.record(i.string,i.any)})]))}),i.partial({dsl:i.string})])]),timeframe:i.union([i[void 0],i.strict({timezone:i.string,days:i.array(i.union([i.literal(1),i.literal(2),i.literal(3),i.literal(4),i.literal(5),i.literal(6),i.literal(7)])),hours:i.strict({start:i.string,end:i.string})})])}),h=i.exact(i.intersection([i.type({group:p,id:m,action_type_id:f,params:g}),i.partial({uuid:b,alerts_filter:y,frequency:d})])),v=i.array(h),E=i.exact(i.intersection([i.type({group:p,id:m,actionTypeId:f,params:g}),i.partial({uuid:b,alertsFilter:y,frequency:d})]));i.array(E),new i.Type("DefaultActionsArray",v.is,((e,t)=>null==e?i.success([]):v.validate(e,t)),i.identity),new i.Type("DefaultExportFileName",i.string.is,((e,t)=>null==e?i.success("export.ndjson"):i.string.validate(e,t)),i.identity);var x=a(437);const j=new i.Type("From",i.string.is,((e,t)=>(e=>"string"==typeof e)(e)&&null==Object(x.a)(e)?i.failure(e,t,'Failed to parse "from" on rule param'):i.string.validate(e,t)),i.identity),S=(new i.Type("DefaultFromString",i.string.is,((e,t)=>null==e?i.success("now-6m"):j.validate(e,t)),i.identity),new i.Type("DefaultIntervalString",i.string.is,((e,t)=>null==e?i.success("5m"):i.string.validate(e,t)),i.identity),i.keyof({eql:null,kuery:null,lucene:null,esql:null})),O=(i.union([S,i[void 0]]),new i.Type("DefaultLanguageString",i.string.is,((e,t)=>null==e?i.success("kuery"):S.validate(e,t)),i.identity),n.n),k=(i.union([O,i[void 0]]),new i.Type("DefaultMaxSignals",i.number.is,((e,t)=>null==e?i.success(100):O.validate(e,t)),i.identity),new i.Type("DefaultPerPage",i.number.is,((e,t)=>null==e?i.success(1):"string"==typeof e?n.n.validate(parseInt(e,10),t):n.n.validate(e,t)),i.identity),new i.Type("DefaultPerPage",i.number.is,((e,t)=>null==e?i.success(20):"string"==typeof e?n.n.validate(parseInt(e,10),t):n.n.validate(e,t)),i.identity),new i.Type("RiskScore",i.number.is,((e,t)=>"number"==typeof e&&Number.isSafeInteger(e)&&e>=0&&e<=100?i.success(e):i.failure(e,t)),i.identity)),w=i.exact(i.type({field:i.string,value:i.string,operator:n.t,risk_score:i.union([k,i[void 0]])})),T=i.array(w),I=(new i.Type("DefaultRiskScoreMappingArray",T.is,((e,t)=>null==e?i.success([]):T.validate(e,t)),i.identity),i.keyof({low:null,medium:null,high:null,critical:null})),C=i.exact(i.type({field:i.string,operator:n.t,value:i.string,severity:I})),M=i.array(C),_=(new i.Type("DefaultSeverityMappingArray",M.is,((e,t)=>null==e?i.success([]):M.validate(e,t)),i.identity),i.string),A=i.string,F=i.string,P=i.type({id:_,name:A,reference:F}),D=i.string,N=i.string,R=i.string,L=i.type({id:D,name:N,reference:R}),B=i.array(L),z=i.string,q=i.string,$=i.string,V=i.intersection([i.exact(i.type({id:z,name:q,reference:$})),i.exact(i.partial({subtechnique:B}))]),U=i.array(V),H=i.string,Q=i.intersection([i.exact(i.type({framework:H,tactic:P})),i.exact(i.partial({technique:U}))]),G=i.array(Q);i.union([G,i[void 0]]),new i.Type("DefaultThreatArray",G.is,((e,t)=>null==e?i.success([]):G.validate(e,t)),i.identity),new i.Type("DefaultToString",i.string.is,((e,t)=>null==e?i.success("now"):i.string.validate(e,t)),i.identity);var W=a(51);new i.Type("DefaultUuid",i.string.is,((e,t)=>null==e?i.success(Object(W.v4)()):n.j.validate(e,t)),i.identity);const Z=Object(n.i)(i.string),K=(i.union([Z,i[void 0]]),i.union([i.string,Z])),J=(i.union([K,i[void 0]]),new i.Type("referencesWithDefaultArray",i.array(i.string).is,((e,t)=>null==e?i.success([]):i.array(i.string).validate(e,t)),i.identity),i.string),Y=j,X=i.string,ee=i.string,te=(i.union([ee,i[void 0]]),i.string),ae=(i.union([te,i[void 0]]),i.array(i.unknown)),ne=(i.union([ae,i[void 0]]),i.exact(i.type({field:n.j,type:i.keyof({mapping:null}),value:n.j}))),ie=i.array(ne),re=i.exact(i.type({entries:ie})),se=Object(n.i)(re,"NonEmptyArray<ThreatMap>"),oe=(i.union([se,i[void 0]]),i.array(i.string)),le=(i.union([oe,i[void 0]]),i.union([S,i[void 0]])),ce=(i.union([le,i[void 0]]),n.n),ue=(i.union([ce,i[void 0]]),n.n),de=(i.union([ue,i[void 0]]),i.keyof({eql:null,machine_learning:null,query:null,saved_query:null,threshold:null,threat_match:null,new_terms:null,esql:null}));i.union([de,i[void 0]])},function(e,t,a){"use strict";a.d(t,"v",(function(){return o})),a.d(t,"y",(function(){return l})),a.d(t,"t",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"A",(function(){return d})),a.d(t,"z",(function(){return m})),a.d(t,"s",(function(){return f})),a.d(t,"r",(function(){return b})),a.d(t,"n",(function(){return g})),a.d(t,"p",(function(){return y})),a.d(t,"x",(function(){return h})),a.d(t,"h",(function(){return v})),a.d(t,"E",(function(){return E})),a.d(t,"b",(function(){return x})),a.d(t,"e",(function(){return O})),a.d(t,"j",(function(){return k})),a.d(t,"F",(function(){return w})),a.d(t,"g",(function(){return T})),a.d(t,"c",(function(){return I})),a.d(t,"w",(function(){return C})),a.d(t,"q",(function(){return M})),a.d(t,"u",(function(){return _})),a.d(t,"L",(function(){return A})),a.d(t,"M",(function(){return F})),a.d(t,"m",(function(){return D})),a.d(t,"I",(function(){return N})),a.d(t,"J",(function(){return R})),a.d(t,"D",(function(){return L})),a.d(t,"C",(function(){return B})),a.d(t,"B",(function(){return z})),a.d(t,"l",(function(){return $})),a.d(t,"d",(function(){return U})),a.d(t,"K",(function(){return H})),a.d(t,"H",(function(){return Q})),a.d(t,"k",(function(){return W})),a.d(t,"f",(function(){return Z})),a.d(t,"a",(function(){return ee})),a.d(t,"G",(function(){return ie})),a.d(t,"N",(function(){return Xe})),a.d(t,"i",(function(){return at}));var n=a(46),i=a(139),r=a(120),s=a(277);const o=r.q,l=n.string,c=r.j,u=r.j,d=r.w,p=(n.boolean,n.boolean),m=n.array(n.string),f=n.UnknownRecord,b=n.string,g=n.array(n.string),y=n.array(n.string),h=n.array(n.string),v=n.string,E=n.string,x=n.string,j=n.string,S=n.string,O=i.y,k=s.m,w=n.array(s.n),T=n.array(n.string),I=n.string,C=n.string,M=n.array(n.unknown),_=n.string,A=n.string,F=n.boolean,P=n.exact(n.type({name:r.j,type:r.j,ecs:n.boolean})),D=n.array(P),N=n.string,R=n.string,L=n.union([n.literal("exactMatch"),n.literal("aliasMatch"),n.literal("conflict")]),B=n.string,z=n.union([n.literal("savedObjectConversion"),n.literal("savedObjectImport")]),q=n.exact(n.intersection([n.type({package:r.j,version:r.j}),n.partial({integration:r.j})])),$=n.array(q),V=n.exact(n.type({field_names:Object(r.i)(r.j)})),U=n.string,H=n.string,Q=n.string;var G=a(4);const W=Object(r.h)({codec:n.string,minSize:1,maxSize:G.Mb}),Z=r.j;var K=a(323);const J=Object(r.r)("AlertSuppressionMissingFields",K.b),Y=Object(r.h)({codec:n.string,minSize:1,maxSize:3}),X=n.type({value:r.n,unit:n.keyof({s:null,m:null,h:null})}),ee=n.intersection([n.exact(n.type({group_by:Y})),n.exact(n.partial({duration:X,missing_fields_strategy:J}))]),te=(n.intersection([n.exact(n.type({groupBy:Y})),n.exact(n.partial({duration:X,missingFieldsStrategy:J}))]),n.exact(n.type({field:n.union([n.string,n.array(n.string)]),value:r.n}))),ae=n.exact(n.type({field:n.array(n.string),value:r.n})),ne=n.exact(n.type({field:n.string,value:r.m})),ie=n.intersection([te,n.exact(n.partial({cardinality:n.array(ne)}))]);n.intersection([ae,n.exact(n.partial({cardinality:n.array(ne)}))]),n.intersection([ae,n.exact(n.type({cardinality:n.array(ne)}))]),a(9);var re=a(180);const se=e=>""===e;n.brand(n.string,(e=>{return!se(t=e)&&!t.includes(" ")&&!t.split(",").some(se);var t}),"IndexPattern"),new n.Type("JSON",n.any.is,((e,t)=>re.either.chain(n.string.validate(e,t),(a=>{try{return n.success(JSON.parse(a))}catch(a){return n.failure(e,t)}}))),(e=>JSON.stringify(e))),new n.Type("isoToEpochRt",n.number.is,((e,t)=>re.either.chain(n.string.validate(e,t),(a=>{const i=new Date(a).getTime();return isNaN(i)?n.failure(e,t):n.success(i)}))),(e=>new Date(e).toISOString())),new n.Type("ToNumber",n.number.is,((e,t)=>{const a=Number(e);return isNaN(a)?n.failure(e,t):n.success(a)}),n.identity),new n.Type("ToBoolean",n.boolean.is,(e=>{let t;return t="string"==typeof e?"true"===e:!!e,n.success(t)}),n.identity),n.brand(n.string,(e=>e.length>0),"NonEmptyString");var oe=a(240);var le=a(56),ce=a.n(le);n.brand(n.string,(e=>ce()(e,!0).isValid()),"Date");var ue=a(65),de=a.n(ue);new n.Type("datemath",n.string.is,((e,t)=>Object(oe.pipe)(n.string.validate(e,t),Object(re.chain)((e=>(e=>{const t=de.a.parse(e);return!(!t||!t.isValid())})(e)?n.success(e):n.failure(e,t))))),String),a(280);const pe=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3,9}Z$/,me=new n.Type("DateFromStringOrNumber",(e=>"string"==typeof e),((e,t)=>"string"==typeof e?pe.test(e)?n.success(e):n.failure(e,t):Object(oe.pipe)(n.number.validate(e,t),Object(re.chain)((e=>{const a=ce()(e);return a.isValid()?n.success(a.toISOString()):n.failure(e,t)})))),String),fe=n.type({time:me,tiebreaker:n.number}),be=(n.intersection([fe,n.partial({gid:n.string,fromAutoReload:n.boolean})]),n.string),ge=(n.union([be,n[void 0]]),n.type({agents:n.array(n.string),allAgentsSelected:n.boolean,platformsSelected:n.array(n.string),policiesSelected:n.array(n.string)})),ye=(n.union([ge,n[void 0]]),n.string),he=(n.union([ye,n[void 0]]),n.string),ve=n.union([he,n[void 0]]),Ee=n.string,xe=(n.union([Ee,n[void 0]]),n.string),je=n.union([xe,n[void 0]]),Se=n.string,Oe=(n.union([Se,n[void 0]]),Re=60,Le=900,new n.Type("InRange",(e=>"number"==typeof e&&e>=Re&&e<=Le),((e,t)=>"number"==typeof e&&e>=Re&&e<=Le?n.success(e):n.failure(e,t)),n.identity)),ke=(n.union([Oe,n[void 0]]),n.boolean),we=n.union([ke,n[void 0]]),Te=n.boolean,Ie=n.union([Te,n[void 0]]),Ce=n.string,Me=n.union([Ce,n[void 0]]),_e=n.string,Ae=(n.union([_e,n[void 0]]),n.type({name:n.union([n.string,n[void 0]]),url:n.union([n.string,n[void 0]])})),Fe=(n.union([Ae,n[void 0]]),n.record(n.string,n.partial({field:n.string,value:n.union([n.string,n.array(n.string)])}))),Pe=n.union([Fe,n[void 0]]),De=(n.union([n.array(n.string),n[void 0]]),n.array(n.type({id:be,query:Ee,ecs_mapping:Pe,version:je,platform:ve,removed:Ie,snapshot:we}))),Ne=n.record(n.string,n.type({query:Ee,id:be,ecs_mapping:Pe,version:je,platform:ve,saved_query_id:Me,removed:Ie,snapshot:we}));var Re,Le;n.union([De,Ne]),n.union([De,n[void 0]]);var Be=a(420);const ze=n.type({command:n.keyof((qe=Be.a,Object.fromEntries(qe.map((e=>[e,null]))))),comment:n.union([n.string,n[void 0]])});var qe;const $e=n.type({query:n.union([n.string,n[void 0]]),ecs_mapping:n.union([Fe,n[void 0]]),queries:n.union([De,n[void 0]]),pack_id:n.union([n.string,n[void 0]]),saved_query_id:n.union([n.string,n[void 0]])}),Ve=n.type({query:n.union([n.string,n[void 0]]),ecsMapping:n.union([Fe,n[void 0]]),queries:n.union([De,n[void 0]]),packId:n.union([n.string,n[void 0]]),savedQueryId:n.union([n.string,n[void 0]])}),Ue=n.strict({actionTypeId:n.literal(".osquery"),params:Ve}),He=n.strict({actionTypeId:n.literal(".endpoint"),params:ze}),Qe=n.union([Ue,He]),Ge=(n.union([n.array(Qe),n[void 0]]),n.strict({action_type_id:n.literal(".osquery"),params:$e})),We=n.strict({action_type_id:n.literal(".endpoint"),params:ze}),Ze=n.union([Ge,We]),Ke=n.array(Ze);var Je=a(273);const Ye=({required:e,optional:t,defaultable:a})=>({create:n.intersection([n.exact(n.type(e)),n.exact(n.partial(t)),n.exact(n.partial(a))]),patch:n.intersection([n.partial(e),n.partial(t),n.partial(a)]),response:n.intersection([n.exact(n.type(e)),n.exact(n.type(Xe(t))),n.exact(n.type(a))])}),Xe=e=>Object.keys(e).reduce(((t,a)=>(t[a]=n.union([e[a],n[void 0]]),t)),{}),et=Ye({required:{name:c,description:u,risk_score:s.a,severity:s.h},optional:{rule_name_override:_,timestamp_override:A,timestamp_override_fallback_disabled:F,timeline_id:N,timeline_title:R,outcome:L,alias_target_id:B,alias_purpose:z,license:b,note:v,building_block_type:x,output_index:j,namespace:S,meta:f,investigation_fields:V,throttle:s.d},defaultable:{version:d,tags:m,enabled:p,risk_score_mapping:s.b,severity_mapping:s.i,interval:s.e,from:s.f,to:s.g,actions:s.c,exceptions_list:O,author:g,false_positives:y,references:h,max_signals:k,threat:w}}),tt=r.m,at=(n.partial({total_search_duration_ms:tt,total_indexing_duration_ms:tt,total_enrichment_duration_ms:tt,execution_gap_duration_s:tt}),et.create,n.intersection([et.create,n.exact(n.partial({rule_id:l}))]),n.keyof({kuery:null,lucene:null})),nt=n.literal("eql"),it=Ye({required:{type:n.literal("eql"),language:nt,query:C},optional:{index:T,data_view_id:I,filters:M,timestamp_field:H,event_category_override:U,tiebreaker_field:Q},defaultable:{}}),rt=n.literal("esql"),st=Ye({required:{type:n.literal("esql"),language:rt,query:C},optional:{},defaultable:{}}),ot=Ye({required:{type:n.literal("threat_match"),query:C,threat_query:s.t,threat_mapping:s.s,threat_index:s.q},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e,threat_filters:s.p,threat_indicator_path:s.r,threat_language:at,concurrent_searches:s.j,items_per_search:s.k},defaultable:{language:at}}),lt=Ye({required:{type:n.literal("query")},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e,response_actions:Ke,alert_suppression:ee},defaultable:{query:C,language:at}}),ct=Ye({required:{type:n.literal("saved_query"),saved_id:Je.e},optional:{index:T,data_view_id:I,query:C,filters:M,response_actions:Ke,alert_suppression:ee},defaultable:{language:at}}),ut=Ye({required:{type:n.literal("threshold"),query:C,threshold:ie},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e},defaultable:{language:at}}),dt=Ye({required:{type:n.literal("machine_learning"),anomaly_threshold:Je.c,machine_learning_job_id:s.l},optional:{},defaultable:{}}),pt=Ye({required:{type:n.literal("new_terms"),query:C,new_terms_fields:W,history_window_start:Z},optional:{index:T,data_view_id:I,filters:M},defaultable:{language:at}});n.union([it.create,st.create,ot.create,lt.create,ct.create,ut.create,dt.create,pt.create])},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"e",(function(){return b}));var n=a(65),i=a.n(n),r=a(56),s=a.n(r),o=a(45),l=a(634),c=a(4),u=a(110);const d=s()().subtract(24,"hours"),p=s()(),m=(e=!0)=>{const t=e?u.b.get().uiSettings.get(c.A):null,a=Object(o.isString)(null==t?void 0:t.from)&&(null==t?void 0:t.from)||c.H,n=Object(o.isString)(null==t?void 0:t.to)&&(null==t?void 0:t.to)||c.Y,i=b(a,d).toISOString(),r=b(n,p,!0).toISOString();return{from:i,fromStr:a,to:r,toStr:n,socTrends:Object(l.b)({to:r,from:i})}},f=(e=!0)=>{const t=e?u.b.get().uiSettings.get(c.z):null,a=Object(o.isNumber)(null==t?void 0:t.value)&&(null==t?void 0:t.value)||c.L;return{kind:!Object(o.isBoolean)(null==t?void 0:t.pause)||null!=t&&t.pause?c.K:"interval",duration:a}},b=(e,t,a=!1,n,r)=>{const s=i.a.parse(e,{roundUp:a,momentInstance:n,forceNow:r});return null!=s&&s.isValid()?s:t}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),i=a.n(n),r=a(122);const s=new class ActiveTimelineEvents{constructor(){i()(this,"_activePage",0),i()(this,"_expandedDetail",{}),i()(this,"_pageName",""),i()(this,"_request",null),i()(this,"_response",null),i()(this,"_eqlRequest",null),i()(this,"_eqlResponse",null)}getActivePage(){return this._activePage}setActivePage(e){this._activePage=e}getExpandedDetail(){return this._expandedDetail}toggleExpandedDetail(e){const t=r.d.query,a=this._expandedDetail[t];let n;var i,s;if("eventDetail"===(null==a?void 0:a.panelView))n="eventDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(i=e.params)||void 0===i?void 0:i.eventId)===(null==a||null===(s=a.params)||void 0===s?void 0:s.eventId);else if("hostDetail"===(null==a?void 0:a.panelView)){var o,l;n="hostDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(o=e.params)||void 0===o?void 0:o.hostName)===(null==a||null===(l=a.params)||void 0===l?void 0:l.hostName)}else if("networkDetail"===(null==a?void 0:a.panelView)){var c,u;n="networkDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(c=e.params)||void 0===c?void 0:c.ip)===(null==a||null===(u=a.params)||void 0===u?void 0:u.ip)}this._expandedDetail=n?{}:{[t]:{...e}}}setExpandedDetail(e){this._expandedDetail=e}getPageName(){return this._pageName}setPageName(e){this._pageName=e}getRequest(){return this._request}setRequest(e){this._request=e}getResponse(){return this._response}setResponse(e){this._response=e}getEqlRequest(){return this._eqlRequest}setEqlRequest(e){this._eqlRequest=e}getEqlResponse(){return this._eqlResponse}setEqlResponse(e){this._eqlResponse=e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return p}));var n=a(45),i=a(2),r=a(873),s=a.n(r),o=a(62),l=a(78),c=a.n(l);const u=(e,t)=>{const a=null!=t?t:((e,t)=>{const a=t.diff(e,"days");return a<=1&&!e.isSame(t)?2:a})(c()(e[0]),c()(e[1])),n=Object(o.niceTimeFormatByDay)(a);return Object(o.timeFormatter)(n)},d=(e=100)=>{const[t,a]=Object(i.useState)({width:0,height:0}),r=Object(i.useMemo)((()=>Object(n.throttle)(e,a)),[e]),{ref:o}=s()({onResize:r});return{ref:o,...t}},p=(e,t,a,n)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,a));i&&n(i)}()}),[e,t,a,n])}},function(e,t,a){"use strict";a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"f",(function(){return g}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(47),c=a(126);const u=({children:e,...t})=>i.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(r.EuiLink,t,e),p=o()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);p.displayName="Comma";const m=({children:e,Component:t,dataTestSubj:a,href:n,onClick:r,title:s,iconType:o="expand"})=>t?i.a.createElement(t,{"data-test-subj":a,href:n,iconType:o,onClick:r,title:s},null!=s?s:e):i.a.createElement(u,{"data-test-subj":a,href:n,onClick:r},null!=s?s:e),f=i.a.memo(m),b=o.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),g=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:a,rowItems:s})=>{const[o,c]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>c((e=>!e))),[]),d=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:u},`+${s.length-t} `,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,s.length]);return i.a.createElement(r.EuiFlexItem,{grow:!1},s.length>t&&i.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:o,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(y,{render:a,rowItems:s,moreMaxHeight:e,overflowIndexStart:t})))}));g.displayName="ReputationLinksOverflow";const y=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:a,rowItems:s})=>{const o=Object(n.useMemo)((()=>s.slice(t).map(((e,t)=>{var n;return i.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(n=a&&a(e))&&void 0!==n?n:Object(c.a)(e))}))),[t,a,s]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},o))}));y.displayName="MoreReputationLinksContainer"},,function(e,t,a){"use strict";var n=a(1183);e.exports=function(e,t,a,i){var r,s=e.length,o=0;if(t=t<0?-t>s?0:s+t:t>s?s:t,a=a>0?a:0,i.length<1e4)(r=Array.from(i)).unshift(t,a),n.apply(e,r);else for(a&&n.apply(e,[t,a]);o<i.length;)(r=i.slice(o,o+1e4)).unshift(t,0),n.apply(e,r),o+=1e4,t+=1e4}},function(e,t,a){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,a){"use strict";var n=a(533);e.exports=function(e){return function(t){return e.test(n(t))}}},function(e,t,a){"use strict";a.d(t,"g",(function(){return u.a})),a.d(t,"a",(function(){return d.b})),a.d(t,"b",(function(){return d.c})),a.d(t,"c",(function(){return d.d})),a.d(t,"d",(function(){return d.f})),a.d(t,"e",(function(){return p.f})),a.d(t,"f",(function(){return p.g}));var n=a(111),i=a(141);const r=n.z.object({add:n.z.array(i.m),remove:n.z.array(i.m)}),s=n.z.array(i.m).min(1);n.z.object({assignees:r,ids:s});var o=a(46),l=(a(264),a(247)),c=(a(299),a(370),a(273)),u=a(248);a(371),o.exact(o.type({tags:c.b,ids:c.a})),a(481),a(341),a(389);var d=a(191),p=a(290);l.e.and(l.f).and(n.object({invocationCount:n.number(),timeframeEnd:n.string()}));var m=a(120);o.exact(o.partial({query:o.object,aggs:o.object,size:m.m,track_total_hits:o.boolean,_source:o.union([o.boolean,o.string,o.array(o.string)]),fields:o.array(o.string),runtime_mappings:o.unknown,sort:o.object})),o.intersection([o.type({status:c.h}),o.partial({conflicts:c.d,signal_ids:c.f,query:c.g})]);const f=o.partial({requests_per_second:o.number,size:m.n,slices:m.m});o.intersection([o.exact(o.type({index:o.array(o.string)})),o.exact(f)]),o.exact(o.type({migration_ids:o.array(o.string)})),o.exact(o.type({migration_ids:o.array(o.string)}));var b=a(277);o.exact(o.type({from:b.f}))},function(e,t,a){"use strict";a.d(t,"h",(function(){return x})),a.d(t,"i",(function(){return j})),a.d(t,"j",(function(){return S})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"c",(function(){return O})),a.d(t,"f",(function(){return y.a})),a.d(t,"g",(function(){return y.b})),a.d(t,"a",(function(){return k}));var n=a(46),i=a(120);let r,s;!function(e){e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range"}(r||(r={})),function(e){e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month"}(s||(s={}));const o=n.union([n.exact(n.type({type:n.literal(r.last_hour),granularity:n.literal(s.minute)})),n.exact(n.type({type:n.literal(r.last_day),granularity:n.union([n.literal(s.minute),n.literal(s.hour)])})),n.exact(n.type({type:n.literal(r.last_week),granularity:n.union([n.literal(s.hour),n.literal(s.day)])})),n.exact(n.type({type:n.literal(r.last_month),granularity:n.union([n.literal(s.day),n.literal(s.week)])})),n.exact(n.type({type:n.literal(r.last_year),granularity:n.union([n.literal(s.week),n.literal(s.month)])})),n.exact(n.type({type:n.literal(r.custom_range),granularity:n.union([n.literal(s.minute),n.literal(s.hour),n.literal(s.day),n.literal(s.week),n.literal(s.month)]),from:i.g,to:i.g}))]);n.exact(n.partial({interval:o,debug:n.boolean})),n.exact(n.intersection([n.type({rule_id:i.j}),n.partial({interval:o,debug:n.boolean})])),n.exact(n.partial({interval:o,debug:n.boolean})),n.exact(n.type({}));var l=a(111),c=a(182);const u=l.z.enum(["trace","debug","info","warn","error"]),d=u.enum,p=l.z.enum(["message","status-change","execution-metrics"]),m=p.enum,f=l.z.object({timestamp:l.z.string().datetime(),sequence:l.z.number().int(),level:u,type:p,execution_id:l.z.string().min(1),message:l.z.string()});var b=a(248),g=a(370);l.z.object({search_term:l.z.string().optional(),event_types:Object(c.a)(p).optional().default([]),log_levels:Object(c.a)(u).optional().default([]),date_start:l.z.string().datetime().optional(),date_end:l.z.string().datetime().optional(),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(f),pagination:g.a});var y=a(219);const h=l.z.object({execution_uuid:l.z.string(),timestamp:l.z.string().datetime(),duration_ms:l.z.number().int(),status:l.z.string(),message:l.z.string(),num_active_alerts:l.z.number().int(),num_new_alerts:l.z.number().int(),num_recovered_alerts:l.z.number().int(),num_triggered_actions:l.z.number().int(),num_succeeded_actions:l.z.number().int(),num_errored_actions:l.z.number().int(),total_search_duration_ms:l.z.number().int(),es_search_duration_ms:l.z.number().int(),schedule_delay_ms:l.z.number().int(),timed_out:l.z.boolean(),indexing_duration_ms:l.z.number().int(),search_duration_ms:l.z.number().int(),gap_duration_s:l.z.number().int(),security_status:l.z.string(),security_message:l.z.string()}),v=l.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);v.enum,l.z.object({start:l.z.string().datetime(),end:l.z.string().datetime(),query_text:l.z.string().optional().default(""),status_filters:Object(c.a)(y.a).optional().default([]),sort_field:v.optional().default("timestamp"),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(h).optional(),total:l.z.number().int().optional()});var E=a(4);E.Db,E.Db,E.Db;const x=`${E.Db}/health/_setup`,j=(E.Db,e=>`${E.Db}/rules/${e}/execution/events`),S=(E.Db,e=>`${E.Db}/rules/${e}/execution/results`);let O;a(364),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off"}(O||(O={})),a(143),a(363);const k=u.options},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="row-renderer-example"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return p}));var n=a(17),i=a(2),r=a.n(i),s=a(47),o=a(113),l=a(151),c=a(516);const u={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:c.o,content:r.a.createElement(n.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:r.a.createElement(n.EuiCode,null,c.i),openButton:r.a.createElement(n.EuiCode,null,c.k)}})),anchor:u.ACTION_MENU},{title:c.a,content:r.a.createElement(n.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:u.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:c.b,content:r.a.createElement(n.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:r.a.createElement(n.EuiCode,null," ",c.e)}})),anchor:u.DATA_VIEW},{timelineType:o.l.default,timelineTab:l.g.query,title:c.d,content:r.a.createElement(n.EuiText,null,c.c),anchor:u.DATA_PROVIDER},{title:c.m,content:r.a.createElement(n.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:r.a.createElement(n.EuiCode,null,c.l),editButton:r.a.createElement(n.EuiCode,null,c.f)}})),anchor:u.SAVE_TIMELINE}],p={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:c.n}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=n.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),s=n.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,a){"use strict";a.d(t,"f",(function(){return n.b})),a.d(t,"g",(function(){return n.c})),a.d(t,"v",(function(){return i.d})),a.d(t,"w",(function(){return i.e})),a.d(t,"D",(function(){return i.k})),a.d(t,"b",(function(){return i.a})),a.d(t,"t",(function(){return i.b})),a.d(t,"B",(function(){return i.i})),a.d(t,"C",(function(){return i.j})),a.d(t,"z",(function(){return i.g})),a.d(t,"A",(function(){return i.h})),a.d(t,"y",(function(){return i.f})),a.d(t,"u",(function(){return i.c})),a.d(t,"h",(function(){return r.a})),a.d(t,"i",(function(){return r.b})),a.d(t,"j",(function(){return r.c})),a.d(t,"l",(function(){return s.c})),a.d(t,"r",(function(){return s.i})),a.d(t,"d",(function(){return s.a})),a.d(t,"e",(function(){return s.b})),a.d(t,"m",(function(){return s.d})),a.d(t,"n",(function(){return s.e})),a.d(t,"o",(function(){return s.f})),a.d(t,"q",(function(){return s.h})),a.d(t,"s",(function(){return s.j})),a.d(t,"p",(function(){return s.g})),a.d(t,"k",(function(){return o.b})),a.d(t,"a",(function(){return o.a})),a.d(t,"x",(function(){return o.c})),a.d(t,"c",(function(){return l.b})),a(490);var n=a(571),i=a(608),r=a(606),s=a(245),o=a(545),l=a(150);a(417)},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=e=>{const t=e.reduce(((e,t)=>t.trim().startsWith("-")?{includes:e.includes,excludes:[...e.excludes,t]}:{includes:[...e.includes,t],excludes:e.excludes}),{includes:[],excludes:[]});return[...t.includes.sort(),...t.excludes.sort()]},i=e=>n([...new Set(e.reduce(((e,t)=>[...t.split(","),...e]),[]))])},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u}));var n=a(5),i=a(113);const r=n.i18n.translate("xpack.securitySolution.timeline.defaultTimelineTitle",{defaultMessage:"None"}),s=n.i18n.translate("xpack.securitySolution.timeline.defaultTimelineDescription",{defaultMessage:"Timeline offered by default when creating new timeline."}),o=({activePage:e,totalPages:t})=>n.i18n.translate("xpack.securitySolution.timeline.eventsTableAriaLabel",{values:{activePage:e,totalPages:t},defaultMessage:"events; Page {activePage} of {totalPages}"}),l=e=>n.i18n.translate("xpack.securitySolution.timeline.searchBoxPlaceholder",{values:{timeline:e===i.l.template?"Timeline template":"Timeline"},defaultMessage:"e.g. {timeline} name or description"}),c=n.i18n.translate("xpack.securitySolution.timeline.flyoutTimelineTemplateLabel",{defaultMessage:"Timeline template"}),u=n.i18n.translate("xpack.securitySolution.timeline.participantsTitle",{defaultMessage:"Participants"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i={ADD_EXCEPTION_FLYOUT:`${n.l} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${n.l} fetchAlerts byRulebyCount`,ALERTS_GROUPING:`${n.l} fetchAlerts grouping`,BY_ID:`${n.l} fetchAlerts byId`,BY_RULE_BY_STATUS:`${n.l} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${n.l} fetchAlerts byRuleId`,BY_SEVERITY:`${n.l} fetchAlerts bySeverity`,BY_STATUS:`${n.l} fetchAlerts byStatus`,CASES:`${n.l} fetchAlerts cases`,COUNT:`${n.l} fetchAlerts count`,HISTOGRAM:`${n.l} fetchAlerts histogram`,PREVALENCE:`${n.l} fetchAlerts prevalence`,SOC_TRENDS:`${n.l} fetchAlerts socTrends`,TREE_MAP:`${n.l} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${n.l} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${n.l} fetchAlerts vulnerableUsers`}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(9),i=a(2),r=a(311),s=a(336);const o=({fetchMethod:e=r.e,query:t,indexName:a,skip:o,queryName:l})=>{const[c,u]=Object(i.useState)(t),[d,p]=Object(i.useState)({data:null,response:"",request:"",setQuery:u,refetch:null}),[m,f]=Object(i.useState)(!1),b=((e,t)=>{const{startTracking:a}=Object(s.a)();return Object(i.useMemo)((()=>async n=>{const{endTracking:i}=a({name:t});let r;try{r=await e(n),i("success")}catch(e){throw i(n.signal.aborted?"aborted":"error"),e}return r}),[e,t,a])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{f(!0);const r=await b({query:c,signal:t.signal});var n;e&&p({data:r,response:JSON.stringify(r,null,2),request:JSON.stringify({index:null!==(n=[a])&&void 0!==n?n:[""],body:c},null,2),setQuery:u,refetch:i})}catch(t){e&&p({data:null,response:"",request:"",setQuery:u,refetch:i})}e&&f(!1)};return Object(n.isEmpty)(c)||o||i(),o&&(f(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[c,a,o,b]),{loading:m,...d}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(111),i=a(141);const r=n.z.object({id:n.z.string().optional(),rule_id:i.N.optional(),list_id:n.z.string().min(1).optional(),item_id:n.z.string().min(1).optional(),error:n.z.object({status_code:n.z.number().int().min(400),message:n.z.string()})}).strict()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var n=a(2);t.useFirstMountState=function(){var e=n.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131).isClient?window:null,r=function(e){return!!e.addEventListener},s=function(e){return!!e.on};t.default=function(e,t,a,o){void 0===a&&(a=i),n.useEffect((function(){if(t&&a)return r(a)?a.addEventListener(e,t,o):s(a)&&a.on(e,t,o),function(){r(a)?a.removeEventListener(e,t,o):s(a)&&a.off(e,t,o)}}),[e,t,a,JSON.stringify(o)])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(256));t.default=function(e){var t=i.useRef(e);t.current=e,r.default((function(){return function(){return t.current()}}))}},function(e,t,a){const n=a(173);e.exports=(e,t,a=!1)=>{if(e instanceof n)return e;try{return new n(e,t)}catch(e){if(!a)return null;throw e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return y}));var n=a(2),i=a.n(n),r=a(11),s=a.n(r),o=a(3),l=a(49),c=a(692),u=a(127),d=a(110),p=a(266);const m={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{}},f=Object(n.createContext)(m),b=({children:e})=>{var t,a,r,l;const{guidedOnboarding:u}=Object(d.i)().services,m=s()(null!==(t=null==u||null===(a=u.guidedOnboardingApi)||void 0===a?void 0:a.isGuideStepActive$(c.a,p.b.rules).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==t?t:Object(o.of)(!1),!1),b=s()(null!==(r=null==u||null===(l=u.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(c.a,p.b.alertsCases).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==r?r:Object(o.of)(!1),!1),g=Object(n.useMemo)((()=>({[p.b.rules]:m,[p.b.alertsCases]:b})),[m,b]),y=Object(n.useCallback)((e=>g[e]),[g]),[h,v]=Object(n.useState)(1),E=Object(n.useCallback)((e=>{v((t=>(t>=p.e[e].length?0:t)+1))}),[]),x=Object(n.useCallback)(((e,t)=>{t<=p.e[e].length&&v(t)}),[]),[j,S]=Object(n.useState)(null);Object(n.useEffect)((()=>{if(!j||null==u||!u.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==u||null===(t=u.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(c.a,j)),e||(S(null),v(1))})(),()=>{e=!0}}),[j,u]);const O=Object(n.useCallback)((e=>{S(e)}),[]),k=Object(n.useMemo)((()=>({activeStep:h,endTourStep:O,incrementStep:E,isTourShown:y,setStep:x})),[h,O,E,y,x]);return i.a.createElement(f.Provider,{value:k},e)},g=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),a=Object(n.useMemo)((()=>Object(u.isTourPath)(t)?b:f.Provider),[t]);return i.a.createElement(a,{value:m},e)},y=()=>{const e=Object(n.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return b})),a.d(t,"d",(function(){return g}));var n={};a.r(n),a.d(n,"dnsSelector",(function(){return E})),a.d(n,"topNFlowSelector",(function(){return j})),a.d(n,"tlsSelector",(function(){return O})),a.d(n,"topCountriesSelector",(function(){return w})),a.d(n,"httpSelector",(function(){return I})),a.d(n,"usersSelector",(function(){return C})),a.d(n,"networkAnomaliesJobIdFilterSelector",(function(){return M})),a.d(n,"networkAnomaliesIntervalSelector",(function(){return _}));var i=a(950),r=a(338),s=a(57),o=a(45),l=a(245),c=a(187),u=a(448),d=a(125),p=a(409);const m=e=>({...e.page.queries,[r.NetworkTableType.topCountriesSource]:{...e.page.queries[r.NetworkTableType.topCountriesSource],activePage:p.a},[r.NetworkTableType.topCountriesDestination]:{...e.page.queries[r.NetworkTableType.topCountriesDestination],activePage:p.a},[r.NetworkTableType.topNFlowSource]:{...e.page.queries[r.NetworkTableType.topNFlowSource],activePage:p.a},[r.NetworkTableType.topNFlowDestination]:{...e.page.queries[r.NetworkTableType.topNFlowDestination],activePage:p.a},[r.NetworkTableType.dns]:{...e.page.queries[r.NetworkTableType.dns],activePage:p.a},[r.NetworkTableType.tls]:{...e.page.queries[r.NetworkTableType.tls],activePage:p.a},[r.NetworkTableType.http]:{...e.page.queries[r.NetworkTableType.http],activePage:p.a}}),f=e=>({...e.details.queries,[r.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesSource],activePage:p.a},[r.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesDestination],activePage:p.a},[r.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowSource],activePage:p.a},[r.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowDestination],activePage:p.a},[r.NetworkDetailsTableType.tls]:{...e.details.queries[r.NetworkDetailsTableType.tls],activePage:p.a},[r.NetworkDetailsTableType.users]:{...e.details.queries[r.NetworkDetailsTableType.users],activePage:p.a},[r.NetworkDetailsTableType.http]:{...e.details.queries[r.NetworkDetailsTableType.http],activePage:p.a}}),b={page:{queries:{[r.NetworkTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_out,direction:d.b.desc}},[r.NetworkTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_in,direction:d.b.desc}},[r.NetworkTableType.dns]:{activePage:p.a,limit:p.b,sort:{field:d.n.uniqueDomains,direction:d.b.desc},isPtrIncluded:!1},[r.NetworkTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:d.b.desc}},[r.NetworkTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:d.r._id,direction:d.b.desc}},[r.NetworkTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_out,direction:d.b.desc}},[r.NetworkTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_in,direction:d.b.desc}},[r.NetworkTableType.alerts]:{activePage:p.a,limit:p.b},[r.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[r.NetworkDetailsTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:d.b.desc}},[r.NetworkDetailsTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_out,direction:d.b.desc}},[r.NetworkDetailsTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_in,direction:d.b.desc}},[r.NetworkDetailsTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_out,direction:d.b.desc}},[r.NetworkDetailsTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:d.s.bytes_in,direction:d.b.desc}},[r.NetworkDetailsTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:d.r._id,direction:d.b.desc}},[r.NetworkDetailsTableType.users]:{activePage:p.a,limit:p.b,sort:{field:d.t.name,direction:d.b.asc}},[r.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:d.f.source}},g=Object(c.reducerWithInitialState)(b).case(i.updateNetworkTable,((e,{networkType:t,tableType:a,updates:n})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[a]:{...Object(o.get)([t,"queries",a],e),...n}}}}))).case(i.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:m(e)},details:{...e.details,queries:f(e)}}))).case(i.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:f(e)}}))).case(i.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:a})=>a===r.NetworkType.page?Object(u.set)("page.queries.anomalies.jobIdSelection",t,e):Object(u.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:a})=>a===r.NetworkType.page?Object(u.set)("page.queries.anomalies.intervalSelection",t,e):Object(u.set)("details.queries.anomalies.intervalSelection",t,e))).build(),y=(e,t)=>Object(o.get)(t,e.network),h=e=>e.network.page,v=e=>e.network.details,E=()=>Object(s.createSelector)(h,(e=>e.queries.dns)),x=(e,t,a)=>{const n=a===l.b.source?"topNFlowSource":"topNFlowDestination",i=t===r.NetworkType.page?r.NetworkTableType[n]:r.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],b)},j=()=>Object(s.createSelector)(x,(e=>e)),S=(e,t)=>{const a=t===r.NetworkType.page?r.NetworkTableType.tls:r.NetworkDetailsTableType.tls;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],b)},O=()=>Object(s.createSelector)(S,(e=>e)),k=(e,t,a)=>{const n=a===l.b.source?"topCountriesSource":"topCountriesDestination",i=t===r.NetworkType.page?r.NetworkTableType[n]:r.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],b)},w=()=>Object(s.createSelector)(k,(e=>e)),T=(e,t)=>{const a=t===r.NetworkType.page?r.NetworkTableType.http:r.NetworkDetailsTableType.http;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],b)},I=()=>Object(s.createSelector)(T,(e=>e)),C=()=>Object(s.createSelector)(v,(e=>e.queries.users)),M=()=>Object(s.createSelector)(y,(e=>e.queries[r.NetworkTableType.anomalies].jobIdSelection)),_=()=>Object(s.createSelector)(y,(e=>e.queries[r.NetworkTableType.anomalies].intervalSelection))},,function(e,t,a){"use strict";const n=a(968),i=a(969),r=a(970);function s(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function l(e,t){return t.decode?i(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){s((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=a):n[e]=a};case"bracket":return(e,a,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],a):n[e]=[a]:n[e]=a};case"comma":case"separator":return(t,a,n)=>{const i="string"==typeof a&&a.split("").indexOf(e.arrayFormatSeparator)>-1?a.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===a?a:l(a,e);n[t]=i};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const i of e.split("&")){let[e,s]=r(t.decode?i.replace(/\+/g," "):i,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:l(s,t),a(l(e,t),s,n)}for(const e of Object.keys(n)){const a=n[e];if("object"==typeof a&&null!==a)for(const e of Object.keys(a))a[e]=p(a[e],t);else n[e]=p(a,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const a=n[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=c(a):e[t]=a,e}),Object.create(null))}t.extract=d,t.parse=m,t.stringify=(e,t)=>{if(!e)return"";s((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>t.skipNull&&null==e[a]||t.skipEmptyString&&""===e[a],n=function(e){switch(e.arrayFormat){case"index":return t=>(a,n)=>{const i=a.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,[o(t,e),"[",i,"]"].join("")]:[...a,[o(t,e),"[",o(i,e),"]=",o(n,e)].join("")]};case"bracket":return t=>(a,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,[o(t,e),"[]"].join("")]:[...a,[o(t,e),"[]=",o(n,e)].join("")];case"comma":case"separator":return t=>(a,n)=>null==n||0===n.length?a:0===a.length?[[o(t,e),"=",o(n,e)].join("")]:[[a,o(n,e)].join(e.arrayFormatSeparator)];default:return t=>(a,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,o(t,e)]:[...a,[o(t,e),"=",o(n,e)].join("")]}}(t),i={};for(const t of Object.keys(e))a(t)||(i[t]=e[t]);const r=Object.keys(i);return!1!==t.sort&&r.sort(t.sort),r.map((a=>{const i=e[a];return void 0===i?"":null===i?o(a,t):Array.isArray(i)?i.reduce(n(a),[]).join("&"):o(a,t)+"="+o(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,n]=r(e,"#");return Object.assign({url:a.split("?")[0]||"",query:m(d(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:l(n,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0},a);const n=u(e.url).split("?")[0]||"",i=t.extract(e.url),r=t.parse(i,{sort:!1}),s=Object.assign(r,e.query);let l=t.stringify(s,a);l&&(l=`?${l}`);let c=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(c=`#${o(e.fragmentIdentifier,a)}`),`${n}${l}${c}`}},function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"i",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return y})),a.d(t,"f",(function(){return h})),a.d(t,"g",(function(){return v}));var n=a(68),i=a(4),r=a(200),s=a(110),o=a(621),l=a(488);const c=async({query:e,signal:t})=>s.b.get().http.fetch(i.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(e),signal:t}),u=async({query:e,status:t,signal:a})=>s.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,query:e}),signal:a}),d=async({signalIds:e,status:t,signal:a})=>s.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({status:t,signal_ids:e}),signal:a}),p=async({signal:e})=>s.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"GET",signal:e}),m=async({signal:e})=>s.b.get().http.fetch(i.ab,{version:"2023-10-31",method:"GET",signal:e}),f=async({signal:e})=>s.b.get().http.fetch(i.fb,{version:"2023-10-31",method:"GET",signal:e}),b=async({signal:e})=>s.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"POST",signal:e}),g=async({endpointId:e,comment:t="",caseIds:a})=>Object(o.a)({endpoint_ids:[e],comment:t,case_ids:a}),y=async({endpointId:e,comment:t="",caseIds:a})=>Object(o.b)({endpoint_ids:[e],comment:t,case_ids:a}),h=async({alertId:e,owner:t})=>s.b.get().http.fetch(Object(n.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}}),v=async({agentId:e,signal:t})=>s.b.get().http.fetch(Object(l.a)(r.q,{id:e}),{method:"GET",signal:t,version:"2023-10-31"})},function(e,t,a){e.exports=a(24)(1634)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return l}));const n="kibana.alert.ancestors.id",i="kibana.alert.rule.parameters.index",r="kibana.alert.rule.indices",s="process.entry_leader.entity_id",o="process.entry_leader.start",l="kibana.alert.ancestors.index"},function(e,t,a){(function(t){const a="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=a}).call(this,a(391))},function(e,t){const a=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:a,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,a){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=a(315),s=a(314),o=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let d=0;const p="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",r],[p,i]],f=(e,t,a)=>{const n=(e=>{for(const[t,a]of m)e=e.split(`${t}*`).join(`${t}{0,${a}}`).split(`${t}+`).join(`${t}{1,${a}}`);return e})(t),i=d++;s(e,i,t),u[e]=i,c[i]=t,o[i]=new RegExp(t,a?"g":void 0),l[i]=new RegExp(n,a?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),f("FULL",`^${c[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),f("LOOSE",`^${c[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),f("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),f("COERCERTL",c[u.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(2),i=a(11),r=a.n(i),s=a(438);const o=e=>{const t=Object(s.b)(),a=r()(t.sections$,t.getSectionsValue());return Object(n.useMemo)((()=>{var t;return null!==(t=null==a?void 0:a.get(e))&&void 0!==t?t:null}),[e,a])},l=e=>{const t=Object(s.b)(),a=r()(t.messages$,t.getMessagesValue());return Object(n.useMemo)((()=>{var t;return null!==(t=null==a?void 0:a.get(e))&&void 0!==t?t:null}),[e,a])},c=e=>{const t=Object(s.b)(),a=Object(n.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=a?a:null}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"b",(function(){return h}));var n=a(142),i=a(124),r=a(122),s=a(116),o=a(521);const l=[i.e.alertsOnAlertsPage,i.e.alertsOnRuleDetailsPage,i.e.alertsOnCasePage,r.c.casePage],c=[{value:"all",inputDisplay:o.b,"data-test-subj":"option-all"}],u=[{value:"raw",inputDisplay:o.d,"data-test-subj":"option-raw"}],d=[{value:"alert",inputDisplay:o.a,"data-test-subj":"option-alert"}],p=[...u,...d],m=e=>{switch(e){case"all":return c;case"raw":return u;case"alert":return d;default:return p}},f=e=>!!e&&l.includes(e),b=[n.a,n.b,n.e,n.f,n.g,n.h,n.o,n.r,n.H,n.w,n.K,n.s,n.t,n.Z,n.nb,n.ob,n.rb,n.u,n.x,n.y,n.z,n.A,n.D,n.E,n.F,n.G,n.I,n.J,n.L,n.N,n.O,n.P,n.Q,n.R,n.S,n.T,n.U,n.V,n.v,n.W,n.X,n.Y,n.ib,n.lb,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],g=({tableId:e,view:t})=>"raw"===t&&f(e),y=({filters:e,tableId:t,view:a})=>g({tableId:t,view:a})?e.filter((e=>!b.includes(`${e.meta.key}`))):e,h=({scopeId:e,view:t})=>g({tableId:e,view:t})?s.SourcererScopeName.default:f(e)?s.SourcererScopeName.detections:e===r.c.active?s.SourcererScopeName.timeline:s.SourcererScopeName.default},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a(48),r=a(128),s=a(167),o=a(117),l=a(112);const c=({id:e,filterQuery:t,kqlError:a,query:c,startDate:u,endDate:d})=>{const{addError:p}=Object(o.a)(),m=Object(i.useDispatch)(),f=Object(n.useMemo)((()=>r.a.errorsSelector()),[]),b=Object(l.a)(f),g=null==a?void 0:a.name,y=null==a?void 0:a.message;Object(n.useEffect)((()=>{if(!t&&y&&g){const t=y.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();m(s.a.addErrorHash({id:e,hash:t,title:g,message:[y]}))}}),[e,t,p,c,u,d,m,y,g]),Object(n.useEffect)((()=>{const t=b.find((t=>t.id===e));null!=t&&t.displayError&&null!=a&&(delete a.stack,p(a,{title:a.name}))}),[p,b,e,a])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n.b})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return B})),a.d(t,"j",(function(){return $})),a.d(t,"g",(function(){return ne})),a.d(t,"h",(function(){return ce})),a.d(t,"i",(function(){return pe})),a.d(t,"d",(function(){return ue})),a.d(t,"e",(function(){return me})),a.d(t,"f",(function(){return W}));var n=a(239),i=a(45),r=a(2),s=a.n(r),o=a(13);const l=Object(r.createContext)(null),c=({children:e,getTriggerCompatibleActions:t})=>{const a=Object(r.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(i.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(o.jsx)(l.Provider,{value:a},e)},u=()=>{const e=Object(r.useContext)(l);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e};var d=a(17),p=a(23),m=a.n(p);const f=({action:e,actionContext:t,showTooltip:a,onClick:n})=>{const i=Object(r.useMemo)((()=>({iconType:e.getIconType(t),onClick:()=>{e.execute(t),n&&n()},"data-test-subj":`actionItem-${e.id}`,"aria-label":e.getDisplayName(t)})),[e,t,n]);return i.iconType?a?Object(o.jsx)(d.EuiToolTip,{content:e.getDisplayNameTooltip?e.getDisplayNameTooltip(t):""},Object(o.jsx)(d.EuiButtonIcon,m()({},i,{iconSize:"s"}))):Object(o.jsx)(d.EuiButtonIcon,m()({},i,{iconSize:"s"})):null},b=(e,t)=>t<=1?{extraActions:e,visibleActions:[]}:e.length<=t?{extraActions:[],visibleActions:e}:{visibleActions:e.slice(0,t-1),extraActions:e.slice(t-1,e.length)};var g=a(55),y=a(5);const h=e=>y.i18n.translate("cellActions.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:e},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."}),v=y.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),E=y.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),x=y.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),j=Object(o.css)("color:",g.euiThemeVars.euiColorPrimaryText,";",""),S=({anchorPosition:e,actions:t,actionContext:a,isOpen:n,closePopOver:i,button:r})=>Object(o.jsx)(d.EuiPopover,{button:r,isOpen:n,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!0,repositionOnScroll:!0,ownFocus:!0,"data-test-subj":"extraActionsPopOver","aria-label":v},Object(o.jsx)(k,{actions:t,actionContext:a,closePopOver:i})),O=({anchorPosition:e,anchorRef:t,actionContext:a,isOpen:n,closePopOver:i,actions:r})=>t.current?Object(o.jsx)(d.EuiWrappingPopover,{"aria-label":v,button:t.current,isOpen:n,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1,"data-test-subj":"extraActionsPopOverWithAnchor"},Object(o.jsx)(k,{actions:r,actionContext:a,closePopOver:i})):null,k=({actionContext:e,actions:t,closePopOver:a})=>{const n=Object(r.useMemo)((()=>t.map((t=>Object(o.jsx)(d.EuiContextMenuItem,{css:j,key:t.id,icon:t.getIconType(e),"aria-label":t.getDisplayName(e),"data-test-subj":`actionItem-${t.id}`,onClick:()=>{a(),t.execute(e)}},t.getDisplayName(e))))),[e,t,a]);return Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(d.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,h(e.data.map((({field:e})=>e.name)).join(", ")))),Object(o.jsx)(d.EuiContextMenuPanel,{size:"s",items:n}))},w=({onClick:e,showTooltip:t})=>t?Object(o.jsx)(d.EuiToolTip,{content:E},Object(o.jsx)(d.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":E,iconType:"boxesHorizontal",onClick:e})):Object(o.jsx)(d.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":E,iconType:"boxesHorizontal",onClick:e});var T=a(407),I=a.n(T),C=a(419),M=a.n(C);const _=e=>{if(e)throw e},A=(e,t)=>Object(r.useMemo)((()=>F(e,t)),[e,t]),F=(e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0,P=({actionContext:e,anchorPosition:t,showActionTooltips:a,visibleCellActions:n,disabledActionTypes:i})=>{const{value:s}=((e,t={})=>{const{getActions:a}=u(),{error:n,value:i,loading:r}=I()((()=>a(e)),[]),s=A(i,t.disabledActionTypes);return _(n),{value:s,loading:r}})(e,{disabledActionTypes:i}),{extraActions:l,visibleActions:c}=((e,t)=>Object(r.useMemo)((()=>b(null!=e?e:[],t)),[e,t]))(null!=s?s:[],n),[p,m]=Object(r.useState)(!1),g=Object(r.useCallback)((()=>m((e=>!e))),[]),y=Object(r.useCallback)((()=>m(!1)),[]),h=Object(r.useMemo)((()=>Object(o.jsx)(w,{onClick:g,showTooltip:a})),[g,a]);return Object(o.jsx)(d.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"none","data-test-subj":"inlineActions",className:"inlineActions "+(p?"inlineActions-popoverOpen":"")},c.map((t=>Object(o.jsx)(d.EuiFlexItem,{grow:!1,key:`action-item-${t.id}`},Object(o.jsx)(f,{action:t,actionContext:e,showTooltip:a})))),l.length>0?Object(o.jsx)(d.EuiFlexItem,{grow:!1},Object(o.jsx)(S,{actions:l,actionContext:e,anchorPosition:t,button:h,closePopOver:y,isOpen:p})):null)};var D=a(9);const N={minWidth:"24px"},R=Object(o.css)("padding:0 ",g.euiThemeVars.euiSizeS,";",""),L=({anchorPosition:e,children:t,visibleCellActions:a,actionContext:n,showActionTooltips:i,disabledActionTypes:l})=>{const c=Object(r.useRef)(null),[p,m]=Object(r.useState)(!1),[y,v]=Object(r.useState)(!1),[{value:E},j]=((e={})=>{const{getActions:t}=u(),[{error:a,value:n,loading:i},r]=M()(t,[]),s=A(n,e.disabledActionTypes);return _(a),[{value:s,loading:i},r]})({disabledActionTypes:l}),{visibleActions:S,extraActions:k}=Object(r.useMemo)((()=>b(null!=E?E:[],a)),[E,a]),T=Object(r.useMemo)((()=>Object(D.debounce)((()=>{document.body.classList.contains("is-dragging")||v(!0)}),100)),[]);Object(r.useEffect)((()=>()=>{T.cancel()}),[T]);const I=Object(r.useCallback)((()=>{T.cancel(),v(!1)}),[T]),C=Object(r.useCallback)((()=>m(!1)),[m]),F=Object(r.useCallback)((()=>{m(!0),I()}),[I,m]),P=Object(r.useCallback)((async()=>{p||(void 0===E&&j(n),T())}),[p,E,T,j,n]),L=Object(r.useMemo)((()=>Object(o.jsx)("div",{ref:c,onMouseEnter:P,onClick:C},t)),[P,C,t]),B=Object(r.useMemo)((()=>"rightCenter"===e?{marginTop:g.euiThemeVars.euiSizeS}:{}),[e]);return Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)("div",{onMouseLeave:I},Object(o.jsx)(d.EuiPopover,{panelStyle:{...N,...B},anchorPosition:e,button:L,closePopover:I,hasArrow:!1,isOpen:y,panelPaddingSize:"none",repositionOnScroll:!0,ownFocus:!1,"data-test-subj":"hoverActionsPopover","aria-label":x},y&&Object(o.jsx)("div",{css:R},Object(o.jsx)(d.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,h(n.data.map((({field:e})=>e.name)).join(", ")))),S.map((e=>Object(o.jsx)(f,{key:e.id,action:e,actionContext:n,showTooltip:i,onClick:I}))),k.length>0&&Object(o.jsx)(w,{onClick:F,showTooltip:i})))),Object(o.jsx)(O,{anchorPosition:e,actions:k,anchorRef:c,actionContext:n,closePopOver:C,isOpen:p}))},B=({data:e,triggerId:t,children:a,mode:s,showActionTooltips:l=!0,visibleCellActions:c=3,disabledActionTypes:u=[],metadata:p,className:m})=>{const f=Object(r.useRef)(null),b=Object(r.useMemo)((()=>Object(i.isArray)(e)?e:[e]),[e]),g=Object(r.useMemo)((()=>({data:b,trigger:{id:t},nodeRef:f,metadata:p})),[b,t,p]),y=Object(r.useMemo)((()=>s===n.b.HOVER_DOWN?"downCenter":"rightCenter"),[s]),h=`cellActions-renderContent-${b.map((({field:e})=>e.name)).join("-")}`;return s===n.b.HOVER_DOWN||s===n.b.HOVER_RIGHT?Object(o.jsx)("div",{className:m,ref:f,"data-test-subj":h},Object(o.jsx)(L,{anchorPosition:y,actionContext:g,showActionTooltips:l,visibleCellActions:c,disabledActionTypes:u},a)):Object(o.jsx)(d.EuiFlexGroup,{responsive:!1,alignItems:"center",ref:f,gutterSize:"none",justifyContent:"flexStart",className:m,"data-test-subj":h},Object(o.jsx)(d.EuiFlexItem,{grow:!1},a),Object(o.jsx)(d.EuiFlexItem,{grow:!1},Object(o.jsx)(P,{anchorPosition:y,actionContext:g,showActionTooltips:l,visibleCellActions:c,disabledActionTypes:u})))},z=[()=>Object(o.jsx)(d.EuiLoadingSpinner,{size:"s","data-test-subj":"dataGridColumnCellAction-loading"})],q=[],$=({fields:e,getCellValue:t,triggerId:a,metadata:n,dataGridRef:i,disabledActionTypes:s=[]})=>{const o=Object(r.useMemo)((()=>{if(a&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:a},metadata:n})))}),[e,a,n]),{loading:l,value:c}=((e,t={})=>{const{getActions:a}=u(),{error:n,...i}=I()((()=>{var n;return Promise.all(null!==(n=null==e?void 0:e.map((e=>a(e).then((e=>{var a;return null!==(a=F(e,t.disabledActionTypes))&&void 0!==a?a:[]})))))&&void 0!==n?n:[])}),[e]);return _(n),i})(o,{disabledActionTypes:s});return Object(r.useMemo)((()=>l?null!=e&&e.length?e.map((()=>z)):q:a&&null!=c&&c.length&&null!=e&&e.length?c.length!==e.length?q:c.map(((r,s)=>r.map((r=>V({action:r,field:e[s],getCellValue:t,metadata:n,triggerId:a,dataGridRef:i}))))):q),[c,e,t,l,n,a,i])},V=({action:e,field:t,getCellValue:a,metadata:n,triggerId:i,dataGridRef:s})=>function({Component:l,rowIndex:c,isExpanded:u}){const d=Object(r.useRef)(null),p=Object(r.useRef)(null),m=Object(r.useMemo)((()=>{const{name:e}=t,r=a(e,c);return{data:[{field:t,value:r}],trigger:{id:i},nodeRef:d,metadata:n}}),[c]),f=Object(r.useCallback)((async()=>{m.nodeRef.current=await U({dataGrid:s.current,isExpanded:u,buttonRef:p}),e.execute(m)}),[m,u]);return Object(o.jsx)(l,{buttonRef:p,"aria-label":e.getDisplayName(m),title:e.getDisplayName(m),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:e.getIconType(m),onClick:f},e.getDisplayName(m))},U=({dataGrid:e,isExpanded:t,buttonRef:a})=>new Promise((n=>{const i=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):H(a.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;n(null!==(e=null==i?void 0:i.firstElementChild)&&void 0!==e?e:null)}))})),H=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:H(e.parentElement);var Q=a(487),G=a.n(Q);const W=e=>t=>{const a=e(t);return Z(a)},Z=e=>{const t=t=>J(e,t);return t.combine=t=>{const a=K(e,t);return Z(a)},t},K=(e,t)=>Y(e,t),J=(e,t)=>Y(e,t),Y=(e,t)=>{const{isCompatible:a,execute:n,...i}=t;let r=e.isCompatible;a&&(r=n?a:async t=>await e.isCompatible(t)&&await a(t));const s=null!=n?n:e.execute;return{...e,isCompatible:r,execute:s,...i}};var X=a(343),ee=a(344);const te=y.i18n.translate("cellActions.actions.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),ae=y.i18n.translate("cellActions.actions.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),ne=W((({notifications:e})=>({type:n.a,getIconType:()=>"copyClipboard",getDisplayName:()=>te,getDisplayNameTooltip:()=>te,isCompatible:async({data:e})=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&null!=a.name&&Object(X.b)(a.type)},execute:async({data:t})=>{var a,n;const r=null===(a=t[0])||void 0===a?void 0:a.field,s=null===(n=t[0])||void 0===n?void 0:n.value,o=Object(X.a)(Object(X.d)(s));if(!Object(X.c)(o))return void e.toasts.addWarning({title:ee.a});const l=o.map((e=>Object(i.isString)(e)?`"${(e=>e.replace(/"/g,'\\"'))(e)}"`:e)).join(" AND "),c=""!==l?`${r.name}: ${l}`:r.name;G()(c,{debug:!0})&&e.toasts.addSuccess({title:ae},{toastLifeTimeMs:800})}})));var ie=a(53);const re=e=>0===e.length||e.every((e=>""===e)),se=({key:e,negate:t,value:a})=>({meta:{key:e,negate:t,type:ie.FILTERS.PHRASE,params:{query:a.toString()}},query:{match_phrase:{[e]:{query:a.toString()}}}}),oe=({key:e,value:t,negate:a})=>0===t.length?(({key:e,negate:t})=>({meta:{key:e,negate:t,type:ie.FILTERS.EXISTS,value:"exists"},query:{exists:{field:e}}}))({key:e,negate:a}):t.length>1?(({values:e,key:t,negate:a})=>({meta:{key:t,negate:a,type:ie.FILTERS.COMBINED,relation:ie.BooleanRelation.AND,params:e.map((e=>se({key:t,value:e})))}}))({key:e,negate:a,values:t}):se({key:e,negate:a,value:t[0]}),le=y.i18n.translate("cellActions.actions.filterIn",{defaultMessage:"Filter In"}),ce=W((({filterManager:e,notifications:{toasts:t}})=>({type:n.c,getIconType:()=>"plusInCircle",getDisplayName:()=>le,getDisplayNameTooltip:()=>le,isCompatible:async({data:e})=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!a.name&&Object(X.b)(a.type)},execute:async({data:a})=>{var n,i;const r=null===(n=a[0])||void 0===n?void 0:n.field,s=null===(i=a[0])||void 0===i?void 0:i.value,o=Object(X.a)(Object(X.d)(s));Object(X.c)(o)?ue({filterManager:e,fieldName:r.name,value:o}):t.addWarning({title:ee.a})}}))),ue=({filterManager:e,fieldName:t,value:a})=>{if(null!=e){const n=oe({key:t,value:a,negate:re(a)});e.addFilters(n)}},de=y.i18n.translate("cellActions.actions.filterOut",{defaultMessage:"Filter Out"}),pe=W((({filterManager:e,notifications:{toasts:t}})=>({type:n.c,getIconType:()=>"minusInCircle",getDisplayName:()=>de,getDisplayNameTooltip:()=>de,isCompatible:async({data:e})=>{var t;const a=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!a.name&&Object(X.b)(a.type)},execute:async({data:a})=>{var n,i;const r=null===(n=a[0])||void 0===n?void 0:n.field,s=null===(i=a[0])||void 0===i?void 0:i.value,o=Object(X.a)(Object(X.d)(s));Object(X.c)(o)?me({filterManager:e,fieldName:r.name,value:o}):t.addWarning({title:ee.a})}}))),me=({filterManager:e,fieldName:t,value:a})=>{if(null!=e){const n=oe({key:t,value:a,negate:!re(a)});e.addFilters(n)}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a(114),r=a(117),s=a(311),o=a(553),l=a(262);const c=()=>{const[e,t]=Object(n.useState)(!0),[a,c]=Object(n.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:u}=Object(r.a)(),{hasIndexRead:d}=Object(l.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController,n=async()=>{try{t(!0);const n=await Object(s.h)({signal:a.signal});e&&null!=n&&c({signalIndexExists:!0,signalIndexName:n.name,signalIndexMappingOutdated:n.index_mapping_outdated,createDeSignalIndex:r})}catch(t){e&&(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),Object(i.v)(t)&&404!==t.body.status_code&&u(t,{title:o.c}))}e&&t(!1)},r=async()=>{let l=!1;try{t(!0),await Object(s.d)({signal:a.signal}),e&&(l=!0,n())}catch(t){e&&(Object(i.v)(t)&&409===t.body.status_code?n():(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),u(t,{title:o.d})))}e&&!l&&t(!1)};return d?n():t(!1),()=>{e=!1,a.abort()}}),[u,d]),{loading:e,...a}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(111),i=a(141);const r=n.z.enum(["doNotSuppress","suppress"]),s=r.enum,o=n.z.array(n.z.string()).min(1).max(3),l=n.z.object({group_by:o,duration:i.a.optional(),missing_fields_strategy:r.optional()});n.z.object({groupBy:o,duration:i.a.optional(),missingFieldsStrategy:r.optional()})},function(e,t,a){"use strict";var n=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((a=e,Array.isArray(a)?[]:{}),e,t):e;var a}function s(e,t,a){return e.concat(t).map((function(e){return r(e,a)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function c(e,t,a){(a=a||{}).arrayMerge=a.arrayMerge||s,a.isMergeableObject=a.isMergeableObject||n,a.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?a.arrayMerge(e,t,a):function(e,t,a){var n={};return a.isMergeableObject(e)&&o(e).forEach((function(t){n[t]=r(e[t],a)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&a.isMergeableObject(t[i])?n[i]=function(e,t){if(!t.customMerge)return c;var a=t.customMerge(e);return"function"==typeof a?a:c}(i,a)(e[i],t[i],a):n[i]=r(t[i],a))})),n}(e,t,a):r(t,a)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,a){return c(e,a,t)}),{})};var u=c;e.exports=u},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(9);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const a={};return Object.entries(e).forEach((([e,i])=>{const r=t&&Array.isArray(i)&&1===i.length;Object(n.merge)(a,Object(n.setWith)({},e,r?i[0]:i,Object))})),a}},function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(4);const i=`${n.jb}/prepackaged`,r=`${n.Db}/prebuilt_rules`,s=`${i}/_status`,o=`${r}/status`,l=`${r}/upgrade/_review`,c=`${r}/upgrade/_perform`,u=`${r}/installation/_review`,d=`${r}/installation/_perform`},function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"d",(function(){return x}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(48),c=a(113),u=a(118),d=a(112),p=a(244),m=a(228),f=a(134),b=a(292);o()(n.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-v4xtfs-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const g=({timelineId:e,compact:t})=>{const a=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),o=Object(d.b)((t=>{var a;return(null!==(a=s(t,e))&&void 0!==a?a:f.b).isFavorite})),m=Object(d.b)((t=>{var a;return(null!==(a=s(t,e))&&void 0!==a?a:f.b).status}))===c.k.immutable,g=Object(i.useCallback)((()=>a(u.a.updateIsFavorite({id:e,isFavorite:!o}))),[a,e,o]),y=o?p.j:p.b;return t?r.a.createElement(n.EuiButtonIcon,{id:b.a.ADD_TO_FAVORITES,iconType:o?"starFilled":"starEmpty",iconSize:"m",isSelected:o,onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:m,"aria-label":y,title:y}):r.a.createElement(n.EuiButton,{id:b.a.ADD_TO_FAVORITES,isSelected:o,fill:o,iconType:o?"starFilled":"starEmpty",onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:m,"aria-label":y,title:y},y)};g.displayName="AddToFavoritesButtonComponent";const y=r.a.memo(g),h=r.a.memo((({onClick:e,outline:t=!1,timelineId:a,title:n=p.h})=>{const{getButton:i}=Object(m.b)({timelineId:a,timelineType:c.l.default,onClick:e});return i({outline:t,title:n})}));h.displayName="NewTimeline";const v="notes-button",E=r.a.memo((({ariaLabel:e=p.i,isDisabled:t,toggleShowNotes:a,timelineType:i})=>{const s=i===c.l.template;return r.a.createElement(n.EuiButtonIcon,{"aria-label":e,className:v,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:a,size:"s",isDisabled:s})}));E.displayName="SmallNotesButton";const x=r.a.memo((({ariaLabel:e,isDisabled:t,showNotes:a,timelineType:i,toggleShowNotes:s,toolTip:o})=>a?r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}):r.a.createElement(n.EuiToolTip,{content:o||"","data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}))));x.displayName="NotesButton"},,function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return h}));var n=a(426),i=a(176),r=a(447),s=a(187),o=a(448),l=a(409);const c=e=>({...e.page.queries,[i.UsersTableType.allUsers]:{...e.page.queries[i.UsersTableType.allUsers],activePage:l.a}}),u=({tableById:e,tableId:t,fieldName:a})=>{const n=e[t];return n.fields.includes(a)?e:{...e,[t]:{...n,fields:[a,...n.fields]}}},d=({tableId:e,fieldName:t,tableById:a})=>{const n=a[e],i=n.fields.filter((e=>e!==t));return{...a,[e]:{...n,fields:i}}};var p=a(445),m=a(125),f=a(423);const b={[i.UserAssetTableType.assetOkta]:["user.id","user.profile.first_name","user.profile.last_name","user.profile.primaryPhone","user.profile.mobile_phone","user.profile.job_title","user.geo.city_name","user.geo.country_iso_code"],[i.UserAssetTableType.assetEntra]:["user.id","user.first_name","user.last_name","user.phone","user.job_title","user.work.location_name"]};var g=a(660);const y=e=>{var t,a;const n=Object(g.a)(e);return{page:{queries:{[i.UsersTableType.allUsers]:{activePage:l.a,limit:l.b,sort:{field:f.b.lastSeen,direction:p.a.desc}},[i.UsersTableType.authentications]:{activePage:l.a,limit:l.b},[i.UsersTableType.risk]:{activePage:l.a,limit:l.b,sort:{field:m.w.userRiskScore,direction:p.a.desc},severitySelection:[]},[i.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[i.UsersTableType.events]:{activePage:l.a,limit:l.b}}},details:{queries:{[i.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[i.UsersTableType.events]:{activePage:l.a,limit:l.b}}},flyout:{queries:{[i.UserAssetTableType.assetEntra]:null!==(t=n&&n[i.UserAssetTableType.assetEntra])&&void 0!==t?t:{fields:b[i.UserAssetTableType.assetEntra]},[i.UserAssetTableType.assetOkta]:null!==(a=n&&n[i.UserAssetTableType.assetOkta])&&void 0!==a?a:{fields:b[i.UserAssetTableType.assetOkta]}}}}},h=e=>Object(s.reducerWithInitialState)(y(e)).case(n.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:c(e)}}))).case(n.updateTableActivePage,((e,{activePage:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],activePage:t}}}}))).case(n.updateTableLimit,((e,{limit:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],limit:t}}}}))).case(n.updateTableSorting,((e,{sort:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],sort:t,activePage:l.a}}}}))).case(n.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[i.UsersTableType.risk]:{...e.page.queries[i.UsersTableType.risk],severitySelection:t,activePage:l.a}}}}))).case(n.updateUsersAnomaliesJobIdFilter,((e,{jobIds:t,usersType:a})=>"page"===a?Object(o.set)("page.queries.anomalies.jobIdSelection",t,e):Object(o.set)("details.queries.anomalies.jobIdSelection",t,e))).case(n.updateUsersAnomaliesInterval,((e,{interval:t,usersType:a})=>"page"===a?Object(o.set)("page.queries.anomalies.intervalSelection",t,e):Object(o.set)("details.queries.anomalies.intervalSelection",t,e))).case(n.addUserAssetTableField,((e,{fieldName:t,tableId:a})=>({...e,flyout:{...e.flyout,queries:u({fieldName:t,tableId:a,tableById:e.flyout.queries})}}))).case(n.removeUserAssetTableField,((e,{fieldName:t,tableId:a})=>({...e,flyout:{...e.flyout,queries:d({tableId:a,fieldName:t,tableById:e.flyout.queries})}}))).build()},function(e,t,a){"use strict";a.d(t,"a",(function(){return G}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(48),l=a(44),c=a.n(l),u=a(595),d=a(112),p=a(138),m=a(596),f=a(119),b=a(396),g=a(47),y=a(75),h=a(17),v=a(158),E=a(110),x=a(522),j=a(212),S=a(523),O=a(524),k=a(550),w=a(198),T=a(382);const I=({callback:e})=>({id:"openInLens",getDisplayName:e=>w.m,getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:0}),C=({callback:e,disabled:t})=>({id:"saveToLibrary",getDisplayName:e=>w.a,getIconType:e=>"save",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:1}),M=({callback:e,disabled:t})=>({id:"addToExistingCase",getDisplayName:e=>w.c,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:2}),_=({callback:e,disabled:t})=>({id:"addToNewCase",getDisplayName:e=>w.d,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:3}),A=({callback:e,disabled:t})=>({id:"inspect",getDisplayName:e=>T.d,getIconType:e=>"inspect",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:4});var F=a(128),P=a(381),D=a(190),N=a(116),R=a(339);const L=[y.ACTION_CUSTOMIZE_PANEL],B=c.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),z={requests:void 0,responses:void 0,isLoading:!0},q=({applyGlobalQueriesAndFilters:e=!0,extraActions:t,extraOptions:a,getLensAttributes:n,height:i,id:l,inputsModelId:c=f.a.global,inspectTitle:u,lensAttributes:p,onLoad:m,scopeId:b=N.SourcererScopeName.default,stackByField:w,timerange:T,width:q,withActions:V=!0,disableOnClickFilter:U=!1})=>{var H,Q,G,W;const Z=Object(r.useMemo)((()=>({height:null!=i?i:"100%",minWidth:"100px",width:null!=q?q:"100%"})),[i,q]),{lens:K,data:{actions:{createFiltersFromValueClickAction:J}}}=Object(E.i)().services,Y=Object(o.useDispatch)(),[X,ee]=Object(r.useState)(!1),[te,ae]=Object(r.useState)(z),ne=F.d.globalQueryByIdSelector(),{searchSessionId:ie}=Object(d.a)((e=>ne(e,l))),re=Object(x.a)({applyGlobalQueriesAndFilters:e,extraOptions:a,getLensAttributes:n,lensAttributes:p,scopeId:b,stackByField:w,title:""}),se=null==re||null===(H=re.state)||void 0===H||null===(Q=H.visualization)||void 0===Q?void 0:Q.preferredSeriesType,oe="lnsLegacyMetric"!==(null==re?void 0:re.visualizationType)&&"lnsPie"!==(null==re?void 0:re.visualizationType),le=K.EmbeddableComponent,ce=Object(r.useMemo)((()=>({onInspectActionClicked:()=>{ee(!0)},isDisabled:te.isLoading})),[te.isLoading]),ue=(({attributes:e,extraActions:t,inspectActionProps:a,timeRange:n,withActions:i})=>{const{lens:s}=Object(j.b)().services,{navigateToPrefilledEditor:o}=s,[l,c]=Object(r.useState)(["inspect","addToNewCase","addToExistingCase","saveToLibrary","openInLens"]);Object(r.useEffect)((()=>{!1===i&&c([])}),[i]);const u=Object(r.useCallback)((()=>{n&&e&&o({id:"",timeRange:n,attributes:e},{openInNewTab:!0})}),[e,o,n]),{disabled:d,onAddToExistingCaseClicked:p}=Object(S.a)({lensAttributes:e,timeRange:n}),{onAddToNewCaseClicked:m,disabled:f}=Object(O.a)({timeRange:n,lensAttributes:e}),{openSaveVisualizationFlyout:b,disableVisualizations:g}=Object(k.a)({attributes:e});return Object(r.useMemo)((()=>null==l?void 0:l.reduce(((e,t)=>"inspect"===t&&null!=a?[...e,A({callback:null==a?void 0:a.onInspectActionClicked,disabled:null==a?void 0:a.isDisabled})]:"addToExistingCase"===t?[...e,M({callback:p,disabled:d})]:"addToNewCase"===t?[...e,_({callback:m,disabled:f})]:"openInLens"===t?[...e,I({callback:u})]:"saveToLibrary"===t?[...e,C({callback:b,disabled:g})]:e),[])),[l,a,p,d,m,f,u,b,g]).concat(null!=t?t:[]).map(((e,t,a)=>({...e,order:Math.max(a.length-(1+t),0)})))})({attributes:re,extraActions:t,inspectActionProps:ce,timeRange:T,withActions:V}),de=Object(r.useCallback)((()=>{ee(!1)}),[]),pe=Object(r.useCallback)((({range:e})=>{const[t,a]=e;Y(Object(v.setAbsoluteRangeDatePicker)({id:c,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[Y,c]),me=Object(r.useMemo)((()=>{var e;const[t,...a]=null!==(e=te.requests)&&void 0!==e?e:[];return{request:t,additionalRequests:a}}),[te.requests]),fe=Object(r.useMemo)((()=>{var e;const[t,...a]=null!==(e=te.responses)&&void 0!==e?e:[];return{response:t,additionalResponses:a}}),[te.responses]),be=Object(r.useCallback)(((e,t)=>{var a;if(!t)return;const n=Object(D.f)(null==t||null===(a=t.requests)||void 0===a?void 0:a.getRequests());ae({requests:n.requests,responses:n.responses,isLoading:e}),null!=m&&m({requests:n.requests,responses:n.responses,isLoading:e})}),[m]),ge=Object(r.useCallback)((()=>async e=>{if(!$(e)||"area"!==se||U)return void e.preventDefault();const[{query:t}]=await J({data:e.data,negate:e.negate}),a=null==t?void 0:t.range["@timestamp"];null!=a&&a.gte&&null!=a&&a.lt&&pe({range:[a.gte,a.lt]})}),[J,pe,se,U]),ye=Object(r.useMemo)((()=>{var e,t;return null!=(null==re||null===(e=re.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==re||null===(t=re.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==re||null===(G=re.state)||void 0===G?void 0:G.adHocDataViews]);return ie?!re||null!=(null==te?void 0:te.responses)&&0===(null==te||null===(W=te.responses)||void 0===W?void 0:W.length)?s.a.createElement(h.EuiFlexGroup,null,s.a.createElement(h.EuiFlexItem,{grow:1},s.a.createElement(h.EuiEmptyPrompt,{body:s.a.createElement(h.EuiText,{size:"xs"},s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),s.a.createElement(h.EuiFlexItem,{grow:!1},s.a.createElement(R.a,{extraActions:t,getLensAttributes:n,inputId:c,isInspectButtonDisabled:!0,lensAttributes:re,queryId:l,stackByField:w,timerange:T,title:u,withDefaultActions:!1}))):s.a.createElement(s.a.Fragment,null,re&&ie&&s.a.createElement(B,{$height:i,width:q,$addHoverActionsPadding:oe},s.a.createElement(le,{id:l,style:Z,timeRange:T,attributes:re,disabledActions:L,onLoad:be,onBrushEnd:pe,onFilter:ge,viewMode:y.ViewMode.VIEW,withDefaultActions:!1,extraActions:ue,searchSessionId:ie,showInspector:!1,syncTooltips:!1,syncCursor:!1})),X&&null!=me.request&&null!=fe.response&&s.a.createElement(P.a,{adHocDataViews:ye,additionalRequests:me.additionalRequests,additionalResponses:fe.additionalResponses,closeModal:de,"data-test-subj":"inspect-modal",inputId:c,request:me.request,response:fe.response,title:u})):null},$=e=>Array.isArray(e.data)&&"column"in e.data[0],V=s.a.memo(q);var U=a(121),H=a(347);const Q=e=>{var t,a;const n=Object(o.useDispatch)(),{inputId:c=f.a.global,id:g,isDonut:y,label:h,donutTextWrapperClassName:v,onLoad:E,...x}=e,{session:j,refetchByRestartingSession:S,refetchByDeletingSession:O}=Object(b.a)({inputId:c,queryId:g}),{indicesExist:k}=Object(U.d)(x.scopeId),w=Object(r.useRef)(x.timerange),T=p.d.globalQueryByIdSelector(),{searchSessionId:I}=Object(d.a)((e=>T(e,g))),C=Object(H.a)({visualizationId:g}),M=null!=C&&0!==(null===(t=C[0])||void 0===t||null===(a=t.hits)||void 0===a?void 0:a.total),_=M?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),A=Object(r.useCallback)((({requests:e,responses:t,isLoading:a})=>{n(p.b.setQuery({inputId:c,id:g,searchSessionId:j.current.start(),refetch:S,loading:a,inspect:{dsl:e,response:t}})),"function"==typeof E&&E({requests:e,responses:t,isLoading:a})}),[n,c,g,j,S,E]);return Object(r.useEffect)((()=>{var e,t;(!k&&(null===(e=w.current)||void 0===e?void 0:e.from)!==x.timerange.from||(null===(t=w.current)||void 0===t?void 0:t.to)!==x.timerange.to)&&(w.current=x.timerange,n(p.b.deleteOneQuery({inputId:c,id:g})))}),[n,g,k,c,x.timerange]),Object(r.useEffect)((()=>{I||setTimeout((()=>{n(p.b.setQuery({inputId:c,id:g,searchSessionId:j.current.start(),refetch:M?S:O,loading:!1,inspect:null}))}),200)}),[n,c,g,j,M,S,I,O]),Object(r.useEffect)((()=>()=>{n(p.b.deleteOneQuery({inputId:c,id:g}))}),[n,g,c]),(x.getLensAttributes||x.lensAttributes)&&x.timerange?y?s.a.createElement(m.b,{isChartEmbeddablesEnabled:!0,dataExists:M,label:h,title:M?s.a.createElement(u.a,{count:null===(F=C[0])||void 0===F||null===(P=F.hits)||void 0===P?void 0:P.total}):null,donutTextWrapperClassName:v,donutTextWrapperStyles:_},s.a.createElement(V,i()({},x,{id:g,onLoad:A}))):s.a.createElement(V,i()({},x,{id:g,onLoad:A})):null;var F,P},G=s.a.memo(Q)},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b}));var n=a(2),i=a(48),r=a(234),s=a.n(r),o=a(83),l=a(110),c=a(149),u=a(116),d=a(554),p=a(555),m=a(117);const f=s()(((e,t)=>{if(null==t)return{browserFields:{}};{const e={};for(const[a,n]of Object.entries(t)){const t=Object(o.getCategory)(a);null==e[t]&&(e[t]={fields:{}});const i=e[t].fields;i&&(i[a]=n)}return{browserFields:e}}}),((e,t)=>{var a,n;return e[0]===t[0]&&(null===(a=e[1])||void 0===a?void 0:a.length)===(null===(n=t[1])||void 0===n?void 0:n.length)})),b=()=>{const{data:e}=Object(l.i)().services,t=Object(n.useRef)({}),a=Object(n.useRef)({}),r=Object(i.useDispatch)(),{addError:s}=Object(m.a)(),o=Object(n.useCallback)((({id:e,loading:t})=>{r(c.a.setDataViewLoading({id:e,loading:t}))}),[r]);return{indexFieldsSearch:Object(n.useCallback)((({dataViewId:n,scopeId:i=u.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:m=!1,skipScopeUpdate:f=!1})=>(a.current[n]&&a.current[n].unsubscribe(),t.current[n]&&t.current[n].abort(),(async()=>{try{t.current={...t.current,[n]:new AbortController},o({id:n,loading:!0});const a=await Object(d.a)(n,e.dataViews,m);l&&i&&!f&&r(c.a.setSelectedDataView({id:i,selectedDataViewId:n,selectedPatterns:a.patternList})),r(c.a.setDataView({...a,loading:!1}))}catch(e){s(null==e?void 0:e.message,{title:p.a})}})())),[o,e.dataViews,r,s])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(281),i=a(586);const r=(e,t=!0)=>{const a=Object(i.a)(e.to),r=Object(i.a)(e.from),{to:s,from:o}=Object(n.d)(t),l=a.isValid()?a.toISOString():s,c=r.isValid()?r.toISOString():o;return{...e,to:l,from:c}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(184);const r=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(n.useCallback)((({name:t,spanName:a="fetch"})=>{const n=e({name:t,type:"http-request",options:{managed:!1}}),i=null==n?void 0:n.startSpan(a,"http-request",{blocking:!0});return{endTracking:e=>{null==n||n.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,a){"use strict";let n,i,r;a.r(t),a.d(t,"NetworkType",(function(){return n})),a.d(t,"NetworkTableType",(function(){return i})),a.d(t,"NetworkDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(i||(i={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(r||(r={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(119),c=a(212),u=a(381),d=a(465),p=a(522),m=a(523),f=a(524),b=a(550),g=a(198),y=a(190),h=a(116),v=a(117);const E=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),x=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:a,extraOptions:s,getLensAttributes:o,inputId:x=l.a.global,inspectIndex:j=0,isInspectButtonDisabled:S,isMultipleQuery:O,lensAttributes:k,onCloseInspect:w,queryId:T,timerange:I,title:C,scopeId:M=h.SourcererScopeName.default,stackByField:_,withDefaultActions:A=!0})=>{const{lens:F}=Object(c.b)().services,{canUseEditor:P,navigateToPrefilledEditor:D,SaveModalComponent:N}=F,[R,L]=Object(i.useState)(!1),[B,z]=Object(i.useState)(!1),[q,$]=Object(i.useState)(!1),{addSuccess:V}=Object(v.a)(),U=Object(i.useCallback)((()=>{$(!1),V(g.a)}),[V]),H=Object(i.useCallback)((()=>{$(!1)}),[]),Q=P(),G=Object(i.useCallback)((()=>{L(!R)}),[R]),W=()=>{L(!1)},Z=Object(p.a)({applyGlobalQueriesAndFilters:e,extraOptions:s,getLensAttributes:o,lensAttributes:k,scopeId:M,stackByField:_,title:""}),K=`stat-${T}`,{disabled:J,onAddToExistingCaseClicked:Y}=Object(m.a)({onAddToCaseClicked:W,lensAttributes:Z,timeRange:I}),{onAddToNewCaseClicked:X,disabled:ee}=Object(f.a)({onClick:W,timeRange:I,lensAttributes:Z}),te=Object(i.useCallback)((()=>{W(),I&&Z&&D({id:"",timeRange:I,attributes:Z},{openInNewTab:!0})}),[Z,D,I]),{openSaveVisualizationFlyout:ae,disableVisualizations:ne}=Object(b.a)({attributes:Z}),ie=Object(i.useCallback)((()=>{W(),z(!0)}),[]),re=Object(i.useCallback)((()=>{z(!1),w&&w()}),[w]),{additionalRequests:se,additionalResponses:oe,handleClick:le,handleCloseModal:ce,isButtonDisabled:ue,request:de,response:pe}=Object(d.a)({inputId:x,inspectIndex:j,isDisabled:S,multiple:O,onCloseInspect:re,onClick:ie,queryId:T}),me=Object(i.useMemo)((()=>{var e;const t={};return[...(null!==(e=null==a?void 0:a.map((e=>r.a.createElement(n.EuiContextMenuItem,{icon:null==e?void 0:e.getIconType(t),key:e.id,onClick:()=>e.execute(t),"data-test-subj":`viz-actions-${e.id}`},e.getDisplayName(t)))))&&void 0!==e?e:[])||[],...A?[r.a.createElement(n.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:le,disabled:ue,"data-test-subj":"viz-actions-inspect"},g.k),r.a.createElement(n.EuiContextMenuItem,{disabled:ee,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:X,"data-test-subj":"viz-actions-add-to-new-case"},g.d),r.a.createElement(n.EuiContextMenuItem,{disabled:J,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:Y},g.c),...Q?[r.a.createElement(n.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsSaveVisualization","data-test-subj":"viz-actions-save-visualization",disabled:ne,onClick:ae},g.a)]:[],r.a.createElement(n.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:ne,onClick:te},g.m)]:[]]}),[Q,ue,ne,a,le,J,ee,Y,X,te,ae,A]),fe=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{"aria-label":g.l,className:y.a,"data-test-subj":K,iconType:"boxesHorizontal",onClick:G})),[K,G]);return r.a.createElement(E,{className:t},me.length>0&&r.a.createElement(n.EuiPopover,{button:fe,isOpen:R,closePopover:W,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},r.a.createElement(n.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:me})),B&&null!==de&&null!==pe&&r.a.createElement(u.a,{additionalRequests:se,additionalResponses:oe,closeModal:ce,inputId:x,request:de,response:pe,title:C}),q&&Q&&r.a.createElement(N,{initialInput:Z,onSave:U,onClose:H}))};x.displayName="VisualizationActionsComponent";const j=r.a.memo(x)},,function(e,t,a){"use strict";a.d(t,"d",(function(){return g.d})),a.d(t,"a",(function(){return g.a})),a.d(t,"f",(function(){return g.f})),a.d(t,"c",(function(){return g.c})),a.d(t,"e",(function(){return g.e})),a.d(t,"b",(function(){return g.b}));var n=a(111);n.z.object({rules_custom_installed:n.z.number().int().min(0),rules_installed:n.z.number().int().min(0),rules_not_installed:n.z.number().int().min(0),rules_not_updated:n.z.number().int().min(0),timelines_installed:n.z.number().int().min(0),timelines_not_installed:n.z.number().int().min(0),timelines_not_updated:n.z.number().int().min(0)}).strict(),n.z.object({rules_installed:n.z.number().int().min(0),rules_updated:n.z.number().int().min(0),timelines_installed:n.z.number().int().min(0),timelines_updated:n.z.number().int().min(0)}).strict();var i=a(46);const r=i.exact(i.type({rule_id:i.string,version:i.number})),s=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(r)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));let l;i.union([o,s]),function(e){e.ALREADY_INSTALLED="ALREADY_INSTALLED"}(l||(l={}));var c=a(120);let u;!function(e){e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET"}(u||(u={}));const d=Object(c.r)("PickVersionValues",u),p=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:d})])),m=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(p)}),i.partial({pick_version:d})])),f=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:d})]));let b;i.union([f,m]),function(e){e.RULE_UP_TO_DATE="RULE_UP_TO_DATE"}(b||(b={}));var g=a(326),y=a(278);const h=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(y.N)(e.optional)))]);var v=a(273);let E;!function(e){e.index_patterns="index_patterns",e.data_view="data_view"}(E||(E={}));const x=i.exact(i.type({type:i.literal(E.index_patterns),index_patterns:y.g})),j=i.exact(i.type({type:i.literal(E.data_view),data_view_id:y.c})),S=i.union([x,j]);let O;!function(e){e.inline_query="inline_query",e.saved_query="saved_query"}(O||(O={}));const k=i.exact(i.type({type:i.literal(O.inline_query),query:y.w,language:y.i,filters:y.q})),w=i.exact(i.type({type:i.literal(O.saved_query),saved_query_id:v.e})),T=i.union([k,w]),I=i.exact(i.type({query:y.w,language:i.literal("eql"),filters:y.q})),C=i.exact(i.type({query:y.w,language:i.literal("esql")})),M=i.exact(i.type({interval:Object(c.p)({allowedUnits:["s","m","h"]}),lookback:Object(c.p)({allowedUnits:["s","m","h"]})})),_=i.exact(i.type({field_name:y.u})),A=i.exact(i.type({field_name:y.L,fallback_disabled:y.M})),F=i.exact(i.type({timeline_id:y.I,timeline_title:y.J})),P=i.exact(i.type({type:y.b}));var D=a(277);const N=h({required:{rule_id:y.y,version:y.A,meta:y.s,name:y.t,tags:y.z,description:y.o,severity:D.h,severity_mapping:D.i,risk_score:D.a,risk_score_mapping:D.b,references:y.x,false_positives:y.p,threat:y.F,note:y.h,setup:y.E,related_integrations:y.l,required_fields:y.m,author:y.n,license:y.r,rule_schedule:M,actions:D.c,throttle:D.d,exceptions_list:y.e,max_signals:y.j},optional:{rule_name_override:_,timestamp_override:A,timeline_template:F,building_block:P}}),R=h({required:{type:i.literal("query"),kql_query:T},optional:{data_source:S,alert_suppression:y.a}}),L=h({required:{type:i.literal("saved_query"),kql_query:T},optional:{data_source:S,alert_suppression:y.a}}),B=h({required:{type:i.literal("eql"),eql_query:I},optional:{data_source:S,event_category_override:y.d,timestamp_field:y.K,tiebreaker_field:y.H}}),z=h({required:{type:i.literal("esql"),esql_query:C},optional:{}}),q=h({required:{type:i.literal("threat_match"),kql_query:T,threat_query:k,threat_index:D.q,threat_mapping:D.s},optional:{data_source:S,threat_indicator_path:D.r,concurrent_searches:D.j,items_per_search:D.k}}),$=h({required:{type:i.literal("threshold"),kql_query:T,threshold:y.G},optional:{data_source:S}}),V=h({required:{type:i.literal("machine_learning"),machine_learning_job_id:D.l,anomaly_threshold:v.c},optional:{}}),U=h({required:{type:i.literal("new_terms"),kql_query:k,new_terms_fields:y.k,history_window_start:y.f},optional:{data_source:S}});let H,Q;i.intersection([N,i.union([R,L,B,z,q,$,V,U])]),a(9),Symbol("MissingVersion"),function(e){e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C"}(H||(H={})),function(e){e.Current="CURRENT",e.Target="TARGET",e.Merged="MERGED",e.Conflict="CONFLICT"}(Q||(Q={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return ve})),a.d(t,"b",(function(){return we}));var n=a(80),i=a(1146),r=a(661),s=a(3),o=a(1145),l=a.n(o),c=a(124),u=a(635),d=a(4),p=a(21),m=a(167),f=a(118),b=a(14),g=a(138),y=a(482),h=a(45),v=a(53),E=a(64),x=a(113),j=a(208),S=a(193),O=a(393),k=a(585),w=a(0),T=a.n(w);const I=new class manage_timeline_id_ManageEpicTimelineId{constructor(){T()(this,"timelineId",null),T()(this,"version",null),T()(this,"templateTimelineId",null),T()(this,"templateVersion",null)}getTimelineId(){return this.timelineId}getTimelineVersion(){return this.version}getTemplateTimelineId(){return this.templateTimelineId}getTemplateTimelineVersion(){return this.templateVersion}setTimelineId(e){this.timelineId=e}setTimelineVersion(e){this.version=e}setTemplateTimelineId(e){this.templateTimelineId=e}setTemplateTimelineVersion(e){this.templateVersion=e}},C=new s.Subject;var M=a(110);const _=new Set([b.addNote.type,b.addNoteToEvent.type]);function A(e){return _.has(e.type)}const F=(e,t)=>null!=e?t[e].note:"",P=new Set([b.pinEvent.type,b.unPinEvent.type]);function D(e){return P.has(e.type)}const N=new Set([b.updateIsFavorite.type]);function R(e){return N.has(e.type)}var L=a(763);const B=e=>e&&e.toLowerCase().startsWith("timeline"),z=()=>(e,t,{selectAllTimelineQuery:a,selectNotesByIdSelector:n,timelineByIdSelector:i,timelineTimeRangeSelector:r,kibana$:o})=>{const l=t.pipe(Object(E.map)(i),Object(E.filter)(L.h)),c=t.pipe(Object(E.map)((e=>a()(e,O.a))),Object(E.filter)(L.h)),u=t.pipe(Object(E.map)(n),Object(E.filter)(L.h)),p=t.pipe(Object(E.map)(r),Object(E.filter)(L.h));return Object(s.merge)(e.pipe(Object(E.withLatestFrom)(l),Object(E.filter)((([e,t])=>{const a=Object(h.get)("payload.id",e),n=t[a];if(e.type===j.addError.type)return!0;if(B(a)&&null!=n&&null!=n.status&&x.k.immutable===n.status)return!1;if(e.type===b.createTimeline.type&&B(a))I.setTimelineVersion(null),I.setTimelineId(null),I.setTemplateTimelineId(null),I.setTemplateTimelineVersion(null);else{if(e.type===b.addTimeline.type&&B(a)){const t=Object(h.get)("payload.timeline",e);return I.setTimelineId(t.savedObjectId),I.setTimelineVersion(t.version),I.setTemplateTimelineId(t.templateTimelineId),I.setTemplateTimelineVersion(t.templateTimelineVersion),Object(h.getOr)(!1,"payload.savedTimeline",e)}if(e.type===b.saveTimeline.type&&!n.isSaving&&B(a))return!0}})),Object(E.mergeMap)((([e])=>(C.next({action:e}),s.EMPTY)))),C.pipe(Object(E.withLatestFrom)(l,u,p),Object(E.concatMap)((([t,a,n,i])=>{const r=Object(h.get)("action",t),p=I.getTimelineId(),m=I.getTimelineVersion(),f=I.getTemplateTimelineId(),g=I.getTemplateTimelineVersion();if(A(r))return((e,t,a,n,i,r)=>Object(s.from)((async({note:e,noteId:t,version:a,overrideOwner:n})=>{let i;try{i=JSON.stringify({noteId:t,version:a,note:e,overrideOwner:n})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await M.b.get().http.patch(d.Rb,{method:"PATCH",body:i,version:"2023-10-31"})})({noteId:null,version:null,note:{eventId:"eventId"in e.payload?e.payload.eventId:void 0,note:F(e.payload.noteId,t),timelineId:I.getTimelineId()}})).pipe(Object(E.withLatestFrom)(n,i,r),Object(E.mergeMap)((([t,a,n,i])=>{const r=e.payload.noteId,s=Object(h.get)("data.persistNote",t),o=403===s.code?[Object(b.showCallOutUnauthorizedMsg)()]:[];return null!=i.refetch&&i.refetch(),[...o,null==a[e.payload.id].savedObjectId?Object(b.updateTimeline)({id:e.payload.id,timeline:{...a[e.payload.id],savedObjectId:s.note.timelineId||null,version:s.note.timelineVersion||null}}):null,Object(j.updateNote)({note:{...n[r],created:null!=s.note.updated?new Date(s.note.updated):n[r].created,user:null!=s.note.updatedBy?s.note.updatedBy:n[r].user,saveObjectId:s.note.noteId,version:s.note.version}}),Object(b.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(b.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(a.pipe(Object(E.withLatestFrom)(n),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===b.endTimelineSaving.type&&null!=t[Object(h.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(h.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(h.get)("payload.id",e)].version),!0)))))))(r,n,e,l,u,c);if(D(r))return((e,t,a,n,i)=>Object(s.from)((async({eventId:e,pinnedEventId:t,timelineId:a})=>{let n;try{n=JSON.stringify({eventId:e,pinnedEventId:t,timelineId:a})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await M.b.get().http.patch(d.Xb,{method:"PATCH",body:n,version:"2023-10-31"})})({pinnedEventId:null!=t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId]?t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId].pinnedEventId:null,eventId:e.payload.eventId,timelineId:I.getTimelineId()})).pipe(Object(E.withLatestFrom)(n,i),Object(E.mergeMap)((([t,a,n])=>{const i=a[e.payload.id],r=Object(h.get)("data.persistPinnedEventOnTimeline",t),s=r&&403===r.code?[Object(b.showCallOutUnauthorizedMsg)()]:[];return null!=n.refetch&&n.refetch(),[null!=r?Object(b.updateTimeline)({id:e.payload.id,timeline:{...i,savedObjectId:null==i.savedObjectId&&null!=r.timelineId?r.timelineId:i.savedObjectId,version:null==i.version&&null!=r.timelineVersion?r.timelineVersion:i.version,pinnedEventIds:{...i.pinnedEventIds,[e.payload.eventId]:!0},pinnedEventsSaveObject:{...i.pinnedEventsSaveObject,[e.payload.eventId]:r}}}):Object(b.updateTimeline)({id:e.payload.id,timeline:{...i,pinnedEventIds:Object(h.omit)(e.payload.eventId,i.pinnedEventIds),pinnedEventsSaveObject:Object(h.omit)(e.payload.eventId,i.pinnedEventsSaveObject)}}),...s,Object(b.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(b.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(a.pipe(Object(E.withLatestFrom)(n),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===b.endTimelineSaving.type&&null!=t[Object(h.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(h.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(h.get)("payload.id",e)].version),!0)))))))(r,a,e,l,c);if(R(r))return((e,t,a,n,i)=>{var r;return Object(s.from)(Object(S.h)({timelineId:I.getTimelineId(),templateTimelineId:t[e.payload.id].templateTimelineId,templateTimelineVersion:t[e.payload.id].templateTimelineVersion,timelineType:null!==(r=t[e.payload.id].timelineType)&&void 0!==r?r:x.l.default})).pipe(Object(E.withLatestFrom)(n,i),Object(E.mergeMap)((([t,a,n])=>{const i=a[e.payload.id],r=Object(h.get)("data.persistFavorite",t),s=403===r.code?[Object(b.showCallOutUnauthorizedMsg)()]:[];return null!=n.refetch&&n.refetch(),[...s,Object(b.updateTimeline)({id:e.payload.id,timeline:{...i,isFavorite:null!=r.favorite&&r.favorite.length>0,savedObjectId:r.savedObjectId||null,version:r.version||null}}),Object(b.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(b.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(a.pipe(Object(E.withLatestFrom)(n),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===b.endTimelineSaving.type&&null!=t[Object(h.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(h.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(h.get)("payload.id",e)].version),I.setTemplateTimelineId(t[Object(h.get)("payload.id",e)].templateTimelineId),I.setTemplateTimelineVersion(t[Object(h.get)("payload.id",e)].templateTimelineVersion),!0))))))})(r,a,e,l,c);if(function(e){return e.type===b.saveTimeline.type}(r)){const t=r,n=a[r.payload.id].savedSearch;return Object(s.from)(t.payload.saveAsNew&&p?Object(S.a)({timelineId:p,timeline:{...$(a[r.payload.id],i),templateTimelineId:f,templateTimelineVersion:g},savedSearch:n}):Object(S.i)({timelineId:p,version:m,timeline:{...$(a[r.payload.id],i),templateTimelineId:f,templateTimelineVersion:g},savedSearch:n})).pipe(Object(E.withLatestFrom)(l,c,o),Object(E.mergeMap)((([e,t,a,n])=>{var i,s,o,l,c,u,d;if(function(e){return"status_code"in e||"statusCode"in e}(e)){const t=function(e){return"status_code"in e?{errorCode:e.status_code,message:e.message}:"statusCode"in e?{errorCode:e.statusCode,message:e.message}:void 0}(e);return 409===(null==t?void 0:t.errorCode)?n.notifications.toasts.addDanger({title:k.f,text:k.e}):n.notifications.toasts.addDanger({title:k.h,text:null!==(i=null==t?void 0:t.message)&&void 0!==i?i:k.g}),[Object(b.endTimelineSaving)({id:r.payload.id})]}const p=e.data.persistTimeline;return null==p?(n.notifications.toasts.addDanger({title:k.h,text:k.g}),[Object(b.endTimelineSaving)({id:r.payload.id})]):403===p.code?[Object(b.showCallOutUnauthorizedMsg)(),Object(b.endTimelineSaving)({id:r.payload.id})]:(null!=a.refetch&&a.refetch(),[Object(b.updateTimeline)({id:r.payload.id,timeline:{...t[r.payload.id],updated:null!==(s=p.timeline.updated)&&void 0!==s?s:void 0,savedObjectId:p.timeline.savedObjectId,version:p.timeline.version,status:null!==(o=p.timeline.status)&&void 0!==o?o:x.k.active,timelineType:null!==(l=p.timeline.timelineType)&&void 0!==l?l:x.l.default,templateTimelineId:null!==(c=p.timeline.templateTimelineId)&&void 0!==c?c:null,templateTimelineVersion:null!==(u=p.timeline.templateTimelineVersion)&&void 0!==u?u:null,savedSearchId:null!==(d=p.timeline.savedSearchId)&&void 0!==d?d:null,isSaving:!1}}),Object(b.setChanged)({id:r.payload.id,changed:!1}),Object(b.endTimelineSaving)({id:r.payload.id})])})),Object(E.startWith)(Object(b.startTimelineSaving)({id:r.payload.id})),Object(E.takeUntil)(e.pipe(Object(E.withLatestFrom)(l),Object(E.filter)((([e,t])=>e.type===b.endTimelineSaving.type&&null!=t[Object(h.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(h.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(h.get)("payload.id",e)].version),I.setTemplateTimelineId(t[Object(h.get)("payload.id",e)].templateTimelineId),I.setTemplateTimelineVersion(t[Object(h.get)("payload.id",e)].templateTimelineVersion),!0))))))}return s.EMPTY}))))},q={columns:null,dataProviders:null,dataViewId:null,description:null,eqlOptions:null,eventType:null,excludedRowRendererIds:null,filters:null,kqlMode:null,kqlQuery:null,indexNames:null,title:null,timelineType:x.l.default,templateTimelineVersion:null,templateTimelineId:null,dateRange:null,savedQueryId:null,sort:null,status:null,savedSearchId:null},$=(e,t)=>Object.keys(q).reduce(((a,n)=>{if(Object(h.has)(n,e)){if("kqlQuery"===n)return Object(h.set)(`${n}.filterQuery`,Object(h.get)(`${n}.filterQuery`,e),a);if("dateRange"===n)return Object(h.set)(`${n}`,{start:t.from,end:t.to},a);if("columns"===n&&null!=Object(h.get)(n,e))return Object(h.set)(n,Object(h.get)(n,e).map((e=>Object(h.omit)(["initialWidth","width","__typename","esTypes"],e))),a);if("filters"===n&&null!=Object(h.get)(n,e)){const t=Object(h.get)(n,e);return Object(h.set)(n,null!=t?t.map((e=>{const t=Object(h.omit)(["$state"],e);return{...t,meta:{...t.meta,field:(Object(v.isMatchAllFilter)(t)||Object(v.isPhraseFilter)(t)||Object(v.isPhrasesFilter)(t)||Object(v.isRangeFilter)(t))&&null!=t.meta.field?V(t.meta.field):null,value:null!=t.meta.value?V(t.meta.value):null,params:null!=t.meta.params?V(t.meta.params):null},...Object(v.isMatchAllFilter)(t)?{query:{match_all:V(t.query.match_all)}}:{match_all:null},...Object(v.isExistsFilter)(t)&&null!=t.query.exists?{query:{exists:V(t.query.exists)}}:{exists:null},...!Object(v.isQueryStringFilter)(t)&&null==Object(h.get)("query",t)||null==t.query?{query:null}:{query:V(t.query)},...Object(v.isRangeFilter)(t)&&null!=t.query.range?{query:{range:V(t.query.range)}}:{range:null},...Object(v.isScriptedRangeFilter)(t)&&null!=t.query.script?{query:{script:V(t.query.script)}}:{script:null}}})):[],a)}return Object(h.set)(n,Object(h.get)(n,e),a)}return a}),q),V=e=>{try{return Object(h.isObject)(e)?JSON.stringify(e):Object(h.toString)(e)}catch{return""}},U=new Set([b.applyKqlFilterQuery.type,b.addProvider.type,b.dataProviderEdited.type,b.removeProvider.type,b.setExcludedRowRendererIds.type,b.setFilters.type,b.setSavedQueryId.type,b.updateDataProviderEnabled.type,b.updateDataProviderExcluded.type,b.updateDataProviderType.type,b.updateEqlOptions.type,b.updateKqlMode.type,b.updateProviders.type,b.updateTitleAndDescription.type,b.updateDataView.type,b.removeColumn.type,b.updateColumns.type,b.updateSort.type,b.updateRange.type,b.upsertColumn.type,b.updateSavedSearch.type]);var H=a(587);const{applyDeltaToColumnWidth:Q,changeViewMode:G,removeColumn:W,toggleDetailPanel:Z,updateColumnOrder:K,updateColumns:J,updateColumnWidth:Y,updateIsLoading:X,updateItemsPerPage:ee,updateShowBuildingBlockAlertsFilter:te,updateSort:ae,upsertColumn:ne}=c.h,ie=e=>null!==e,re=new Set([W.type,ne.type,Q.type,J.type,K.type,Y.type,ee.type,ae.type,G.type,te.type,b.updateTotalCount.type,X.type,Z.type]);var se=a(329),oe=a(447),le=a(660);const ce=e=>null!==e,{removeUserAssetTableField:ue,addUserAssetTableField:de}=se.c,pe=new Set([ue.type,de.type]);var me=a(116),fe=a(477),be=a(1278);function ge(e){return e?{timeRange:{from:e.from,to:e.to}}:[]}var ye=a(149);let he=null;const ve=async(e,t,a,n,i)=>{var r,o,c,p,m;let f={name:null};try{!0===e.application.capabilities[d.vc].show&&(f=await e.http.fetch(d.eb,{version:"2023-10-31",method:"GET"}))}catch{f={name:null}}const b=e.uiSettings.get(d.I);let g,h;try{var v,E;const e=await Object(fe.a)({body:{patternList:[...b,...null!=f.name?[f.name]:[]]},dataViewService:t.data.dataViews,dataViewId:`${d.D}-${null===(v=await(null===(E=t.spaces)||void 0===E?void 0:E.getActiveSpace()))||void 0===v?void 0:v.id}`});if(void 0===e)throw new Error("");g={...me.initDataView,...e.defaultDataView},h=e.kibanaDataViews.map((e=>({...me.initDataView,...e})))}catch(e){g={...me.initDataView,error:e},h=[]}const x={kibana:e},j=new s.BehaviorSubject(x),S={timeline:{...a.timelines.store.initialState.timeline,timelineById:{...a.timelines.store.initialState.timeline.timelineById}}},O={dataTable:{tableById:{...a.alerts.storageDataTables.tableById,...a.rules.storageDataTables.tableById,...a.exceptions.storageDataTables.tableById,...a.explore.exploreDataTables.hosts.tableById,...a.explore.exploreDataTables.network.tableById,...a.explore.exploreDataTables.users.tableById}}},k={groups:u.b},w=l()(S.timeline,null!==(r=null===(o=t.timelines)||void 0===o?void 0:o.getTimelineReducer())&&void 0!==r?r:{},a.timelines.store.reducer.timeline),T=Object(y.a)({...a.explore.store.initialState,...S,...a.management.store.initialState},{defaultDataView:g,kibanaDataViews:h,signalIndexName:f.name,enableExperimental:i},O,k,{analyzer:{}}),I={...a.explore.store.reducer,timeline:w,...a.management.store.reducer};return ke(T,I,j.pipe(Object(s.pluck)("kibana")),n,[...null!==(c=a.management.store.middleware)&&void 0!==c?c:[],...null!==(p=a.explore.store.middleware)&&void 0!==p?p:[],null!==(m=Object(be.a)((C=e,{relatedEvents:async({entityID:e,timeRange:t,indexPatterns:a})=>({...await C.http.post("/api/endpoint/resolver/events",{query:{},body:JSON.stringify({indexPatterns:a,...ge(t),filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":e}},{bool:{must_not:{term:{"event.category":"process"}}}}]}})})}),entityID:e}),eventsWithEntityIDAndCategory({entityID:e,category:t,after:a,timeRange:n,indexPatterns:i}){const r={query:{afterEvent:a,limit:25},body:{...ge(n),indexPatterns:i}};return"alert"===t?C.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,entityType:"alerts",eventID:e})}):C.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":e}},{term:{"event.category":t}}]}})})})},async nodeData({ids:e,timeRange:t,indexPatterns:a,limit:n}){const i={query:{limit:n},body:JSON.stringify({indexPatterns:a,...ge(t),filter:JSON.stringify({bool:{filter:[{terms:{"process.entity_id":e}},{term:{"event.category":"process"}}]}})})};return(await C.http.post("/api/endpoint/resolver/events",i)).events},async event({nodeID:e,eventID:t,eventCategory:a,eventTimestamp:n,winlogRecordID:i,timeRange:r,indexPatterns:s}){const o=void 0===t?{bool:{filter:[{terms:{"event.category":a}},{term:{"process.entity_id":e}},{term:{"@timestamp":n}},{term:{"winlog.record_id":i}}]}}:{bool:{filter:[{term:{"event.id":t}}]}};if(!1===a.includes("alert")){const e=await C.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...ge(r),filter:JSON.stringify(o)})}),[t]=e.events;return null!=t?t:null}{const e=await C.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...ge(r),entityType:"alertDetail",eventID:t})}),[a]=e.events;return null!=a?a:null}},resolverTree:async({dataId:e,schema:t,timeRange:a,indices:n,ancestors:i,descendants:r})=>C.http.post("/api/endpoint/resolver/tree",{body:JSON.stringify({ancestors:i,descendants:r,timeRange:a,schema:t,nodes:[e],indexPatterns:n})}),entities:async({_id:e,indices:t,signal:a})=>C.http.get("/api/endpoint/resolver/entity",{signal:a,query:{_id:e,indices:t}})})))&&void 0!==m?m:[]]);var C},Ee=[b.updateTimeline.type,b.addTimeline.type,b.initializeTimelineSettings.type],xe=e=>{if(e.type===ye.a.setDataView.type)return{...e,payload:{...e.payload,dataView:"dataView",browserFields:"browserFields",indexFields:"indexFields",fields:"fields"}};if(Ee.includes(e.type)){const{type:t,payload:a}=e;if(t===b.addTimeline.type||t===b.updateTimeline.type)return{...e,payload:{...a,timeline:Se(a.timeline)}};if(t===b.initializeTimelineSettings.type)return{...e,payload:{...a,timeline:Se(a.timeline)}}}return e},je=e=>({...e,browserFields:"browserFields",indexFields:"indexFields",fields:"fields",dataView:"dataView"}),Se=e=>({...e,filterManager:"filterManager",footerText:"footerText",loadingText:"loadingText"}),Oe=e=>e.sourcerer?{...e,sourcerer:{...e.sourcerer,defaultDataView:je(e.sourcerer.defaultDataView),kibanaDataViews:e.sourcerer.kibanaDataViews.map(je)}}:e,ke=(e,t,a,o,l)=>{const u={name:"Kibana Security Solution",actionsBlacklist:["USER_MOVED_POINTER","USER_SET_RASTER_SIZE"],actionSanitizer:xe,stateSanitizer:Oe},d=Object(i.composeWithDevTools)(u),v={kibana$:a,selectAllTimelineQuery:g.d.globalQueryByIdSelector,selectNotesByIdSelector:m.c.selectNotesByIdSelector,timelineByIdSelector:f.b.timelineByIdSelector,timelineTimeRangeSelector:g.d.timelineTimeRangeSelector,tableByIdSelector:c.j.tableByIdSelector,storage:o},x=Object(r.createEpicMiddleware)({dependencies:v}),j=Object(n.applyMiddleware)(x,p.g,...null!=l?l:[]);return he=Object(n.createStore)(Object(y.b)(t),e,d(j)),x.run(Object(r.combineEpics)(z(),(e=>e.pipe(Object(E.filter)((e=>U.has(e.type))),Object(E.map)((e=>Object(b.setChanged)({id:Object(h.get)("payload.id",e),changed:!0}))))),(e=>e.pipe(Object(E.filter)(R),Object(E.mergeMap)((e=>(C.next({action:e}),s.EMPTY))))),(e=>e.pipe(Object(E.filter)(A),Object(E.switchMap)((e=>(C.next({action:e}),s.EMPTY))))),(e=>e.pipe(Object(E.filter)(D),Object(E.mergeMap)((e=>(C.next({action:e}),s.EMPTY))))),((e,t,{tableByIdSelector:a,storage:n})=>{const i=t.pipe(Object(E.map)(a),Object(E.filter)(ie));return e.pipe(Object(E.delay)(500),Object(E.withLatestFrom)(i),Object(E.tap)((([e,t])=>{if(re.has(e.type)&&n){const a=Object(h.get)("payload.id",e);Object(H.a)(n,a,t[a])}})),Object(E.ignoreElements)())}),((e,t,{storage:a})=>{const n=t.pipe(Object(E.map)(oe.selectUserAssetTables),Object(E.filter)(ce));return e.pipe(Object(E.delay)(500),Object(E.withLatestFrom)(n),Object(E.tap)((([e,t])=>{if(pe.has(e.type)){const n=Object(h.get)("payload.tableId",e);Object(le.b)(a,n,t[n])}})),Object(E.ignoreElements)())}))),he},we=()=>he},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(328),i=a(45);const r=[n.b.DATE,n.b.IP,n.b.STRING,n.b.NUMBER,n.b.BOOLEAN],s=e=>r.includes(e),o=e=>e.every((e=>Object(i.isString)(e)||Object(i.isNumber)(e)||Object(i.isBoolean)(e)))&&(e=>e.every((t=>typeof t==typeof e[0])))(e),l=e=>e.filter((e=>null!=e)),c=e=>Array.isArray(e)?e:[e]},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("cellActions.actions.incompatibility.warningMessage",{defaultMessage:"The action can not be executed because the value and type are incompatible"})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(23),i=a(991),r=a(992),s=a(993),o=a(994);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=l(n),u=l(i),d=l(r),p=l(s),m=l(o);function f(){var e;return(e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e]}var b={symbols:{"!":{postfix:{symbol:"!",f:function e(t){return t%1||!(+t>=0)?NaN:t>170?1/0:0===t?1:t*e(t-1)},notation:"postfix",precedence:6,rightToLeft:0,argCount:1},symbol:"!",regSymbol:"!"},"^":{infix:{symbol:"^",f:function(e,t){return Math.pow(e,t)},notation:"infix",precedence:5,rightToLeft:1,argCount:2},symbol:"^",regSymbol:"\\^"},"*":{infix:{symbol:"*",f:function(e,t){return e*t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"*",regSymbol:"\\*"},"/":{infix:{symbol:"/",f:function(e,t){return e/t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"/",regSymbol:"/"},"+":{infix:{symbol:"+",f:function(e,t){return e+t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"+",f:f,notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"+",regSymbol:"\\+"},"-":{infix:{symbol:"-",f:function(e,t){return e-t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"-",f:function(e){return-e},notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"-",regSymbol:"-"},",":{infix:{symbol:",",f:function(){return Array.of.apply(Array,arguments)},notation:"infix",precedence:1,rightToLeft:0,argCount:2},symbol:",",regSymbol:","},"(":{prefix:{symbol:"(",f:f,notation:"prefix",precedence:0,rightToLeft:0,argCount:1},symbol:"(",regSymbol:"\\("},")":{postfix:{symbol:")",f:void 0,notation:"postfix",precedence:0,rightToLeft:0,argCount:1},symbol:")",regSymbol:"\\)"},min:{func:{symbol:"min",f:function(){return Math.min.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"min",regSymbol:"min\\b"},max:{func:{symbol:"max",f:function(){return Math.max.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"max",regSymbol:"max\\b"},sqrt:{func:{symbol:"sqrt",f:function(e){return Math.sqrt(e)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"sqrt",regSymbol:"sqrt\\b"}}},g=function(e){function t(t){var a;return a=e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,u.default(a)}return d.default(t,e),t}(p.default(Error)),y=/((?!\w)a|na|hc|mc|dg|me[r]?|xe|ni(?![a-zA-Z])|mm|cp|tp|xp|q(?!s)|hv|xamv|nimv|wv|sm|s(?!\D|$)|ged|darg?|nrut)/g;function h(e,t){var a,n=e.pop();return t.push(n.f.apply(n,(a=[]).concat.apply(a,t.splice(-n.argCount)))),n.precedence}function v(e){return e.split("").reverse().join("")}var E=/--[\S]*/g;function x(e){return e.charAt(0).toUpperCase()+e.slice(1)}var j=["Top","Right","Bottom","Left"];function S(e,t){if(!e)return t.toLowerCase();var a=e.split("-");if(a.length>1)return a.splice(1,0,t),a.reduce((function(e,t){return""+e+x(t)}));var n=e.replace(/([a-z])([A-Z])/g,"$1"+t+"$2");return e===n?""+e+t:n}function O(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var i=a[0],r=a[1],s=void 0===r?i:r,o=a[2],l=void 0===o?i:o,c=a[3];return function(e,t){for(var a={},n=0;n<t.length;n+=1)(t[n]||0===t[n])&&(a[S(e,j[n])]=t[n]);return a}(e,[i,s,l,void 0===c?s:c])}function k(e,t){return e.substr(-t.length)===t}var w=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function T(e,t){if("string"!=typeof e)return t?[e,void 0]:e;var a=e.match(w);return t?(console.warn("stripUnit's unitReturn functionality has been marked for deprecation in polished 4.0. It's functionality has been been moved to getValueAndUnit."),a?[parseFloat(e),a[2]]:[e,void 0]):a?parseFloat(e):e}var I=function(e){return function(t,a){void 0===a&&(a="16px");var n=t,i=a;if("string"==typeof t){if(!k(t,"px"))throw new g(69,e,t);n=T(t)}if("string"==typeof a){if(!k(a,"px"))throw new g(70,e,a);i=T(a)}if("string"==typeof n)throw new g(71,t,e);if("string"==typeof i)throw new g(72,a,e);return""+n/i+e}},C=I("em"),M=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function _(e){if("string"!=typeof e)return[e,""];var t=e.match(M);return t?[parseFloat(e),t[2]]:[e,void 0]}var A={minorSecond:1.067,majorSecond:1.125,minorThird:1.2,majorThird:1.25,perfectFourth:1.333,augFourth:1.414,perfectFifth:1.5,minorSixth:1.6,goldenSection:1.618,majorSixth:1.667,minorSeventh:1.778,majorSeventh:1.875,octave:2,majorTenth:2.5,majorEleventh:2.667,majorTwelfth:3,doubleOctave:4},F=I("rem");function P(e,t,a,n){void 0===a&&(a="320px"),void 0===n&&(n="1200px");var i=_(e),r=i[0],s=i[1],o=_(t),l=o[0],c=o[1],u=_(a),d=u[0],p=u[1],m=_(n),f=m[0],b=m[1];if("number"!=typeof d||"number"!=typeof f||!p||!b||p!==b)throw new g(47);if("number"!=typeof r||"number"!=typeof l||s!==c)throw new g(48);if(s!==p||c!==b)throw new g(75);var y=(r-l)/(d-f);return"calc("+(l-y*f).toFixed(2)+(s||"")+" + "+(100*y).toFixed(2)+"vw)"}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var N,R,L=/^\s*data:([a-z]+\/[a-z-]+(;[a-z-]+=[a-z-]+)?)?(;charset=[a-z0-9-]+)?(;base64)?,[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,B={woff:"woff",woff2:"woff2",ttf:"truetype",otf:"opentype",eot:"embedded-opentype",svg:"svg",svgz:"svg"};function z(e,t){return t?' format("'+B[e]+'")':""}function q(e,t,a,n){var i=[];return t&&i.push(function(e){return e.map((function(e){return'local("'+e+'")'})).join(", ")}(t)),e&&i.push(function(e,t,a){return function(e){return!!e.replace(/\s+/g," ").match(L)}(e)?'url("'+e+'")'+z(t[0],a):t.map((function(t){return'url("'+e+"."+t+'")'+z(t,a)})).join(", ")}(e,a,n)),i.join(", ")}function $(e){return void 0===e&&(e=1.3),"\n    @media only screen and (-webkit-min-device-pixel-ratio: "+e+"),\n    only screen and (min--moz-device-pixel-ratio: "+e+"),\n    only screen and (-o-min-device-pixel-ratio: "+e+"/1),\n    only screen and (min-resolution: "+Math.round(96*e)+"dpi),\n    only screen and (min-resolution: "+e+"dppx)\n  "}function V(e){for(var t="",a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];for(var r=0;r<e.length;r+=1)if(t+=e[r],r===n.length-1&&n[r]){var s=n.filter((function(e){return!!e}));s.length>1?(t=t.slice(0,-1),t+=", "+n[r]):1===s.length&&(t+=""+n[r])}else n[r]&&(t+=n[r]+" ");return t.trim()}var U={easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeInCirc:"cubic-bezier(0.600,  0.040, 0.980, 0.335)",easeInCubic:"cubic-bezier(0.550,  0.055, 0.675, 0.190)",easeInExpo:"cubic-bezier(0.950,  0.050, 0.795, 0.035)",easeInQuad:"cubic-bezier(0.550,  0.085, 0.680, 0.530)",easeInQuart:"cubic-bezier(0.895,  0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755,  0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470,  0.000, 0.745, 0.715)",easeOutBack:"cubic-bezier(0.175,  0.885, 0.320, 1.275)",easeOutCubic:"cubic-bezier(0.215,  0.610, 0.355, 1.000)",easeOutCirc:"cubic-bezier(0.075,  0.820, 0.165, 1.000)",easeOutExpo:"cubic-bezier(0.190,  1.000, 0.220, 1.000)",easeOutQuad:"cubic-bezier(0.250,  0.460, 0.450, 0.940)",easeOutQuart:"cubic-bezier(0.165,  0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230,  1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390,  0.575, 0.565, 1.000)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)",easeInOutCirc:"cubic-bezier(0.785,  0.135, 0.150, 0.860)",easeInOutCubic:"cubic-bezier(0.645,  0.045, 0.355, 1.000)",easeInOutExpo:"cubic-bezier(1.000,  0.000, 0.000, 1.000)",easeInOutQuad:"cubic-bezier(0.455,  0.030, 0.515, 0.955)",easeInOutQuart:"cubic-bezier(0.770,  0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860,  0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445,  0.050, 0.550, 0.950)"},H=function(e,t,a){var n=""+a[0]+(a[1]||""),i=""+a[0]/2+(a[1]||""),r=""+t[0]+(t[1]||""),s=""+t[0]/2+(t[1]||"");switch(e){case"top":return"0 "+i+" "+r+" "+i;case"topLeft":return n+" "+r+" 0 0";case"left":return s+" "+n+" "+s+" 0";case"bottomLeft":return n+" 0 0 "+r;case"bottom":return r+" "+i+" 0 "+i;case"bottomRight":return"0 0 "+n+" "+r;case"right":return s+" 0 "+s+" "+n;default:return"0 "+n+" "+r+" 0"}};function Q(e){return Math.round(255*e)}function G(e,t,a){return Q(e)+","+Q(t)+","+Q(a)}function W(e,t,a,n){if(void 0===n&&(n=G),0===t)return n(a,a,a);var i=(e%360+360)%360/60,r=(1-Math.abs(2*a-1))*t,s=r*(1-Math.abs(i%2-1)),o=0,l=0,c=0;i>=0&&i<1?(o=r,l=s):i>=1&&i<2?(o=s,l=r):i>=2&&i<3?(l=r,c=s):i>=3&&i<4?(l=s,c=r):i>=4&&i<5?(o=s,c=r):i>=5&&i<6&&(o=r,c=s);var u=a-r/2;return n(o+u,l+u,c+u)}var Z={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=/^#[a-fA-F0-9]{6}$/,J=/^#[a-fA-F0-9]{8}$/,Y=/^#[a-fA-F0-9]{3}$/,X=/^#[a-fA-F0-9]{4}$/,ee=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,te=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,ae=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,ne=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i;function ie(e){if("string"!=typeof e)throw new g(3);var t=function(e){if("string"!=typeof e)return e;var t=e.toLowerCase();return Z[t]?"#"+Z[t]:e}(e);if(t.match(K))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(J)){var a=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:a}}if(t.match(Y))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(X)){var n=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:n}}var i=ee.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var r=te.exec(t.substring(0,50));if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10),alpha:parseFloat(""+r[4])};var s=ae.exec(t);if(s){var o="rgb("+W(parseInt(""+s[1],10),parseInt(""+s[2],10)/100,parseInt(""+s[3],10)/100)+")",l=ee.exec(o);if(!l)throw new g(4,t,o);return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var c=ne.exec(t.substring(0,50));if(c){var u="rgb("+W(parseInt(""+c[1],10),parseInt(""+c[2],10)/100,parseInt(""+c[3],10)/100)+")",d=ee.exec(u);if(!d)throw new g(4,t,u);return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10),alpha:parseFloat(""+c[4])}}throw new g(5)}function re(e){return function(e){var t,a=e.red/255,n=e.green/255,i=e.blue/255,r=Math.max(a,n,i),s=Math.min(a,n,i),o=(r+s)/2;if(r===s)return void 0!==e.alpha?{hue:0,saturation:0,lightness:o,alpha:e.alpha}:{hue:0,saturation:0,lightness:o};var l=r-s,c=o>.5?l/(2-r-s):l/(r+s);switch(r){case a:t=(n-i)/l+(n<i?6:0);break;case n:t=(i-a)/l+2;break;default:t=(a-n)/l+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:c,lightness:o,alpha:e.alpha}:{hue:t,saturation:c,lightness:o}}(ie(e))}var se=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function oe(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function le(e){return oe(Math.round(255*e))}function ce(e,t,a){return se("#"+le(e)+le(t)+le(a))}function ue(e,t,a){return W(e,t,a,ce)}function de(e,t,a){if("number"==typeof e&&"number"==typeof t&&"number"==typeof a)return ue(e,t,a);if("object"==typeof e&&void 0===t&&void 0===a)return ue(e.hue,e.saturation,e.lightness);throw new g(1)}function pe(e,t,a,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof a&&"number"==typeof n)return n>=1?ue(e,t,a):"rgba("+W(e,t,a)+","+n+")";if("object"==typeof e&&void 0===t&&void 0===a&&void 0===n)return e.alpha>=1?ue(e.hue,e.saturation,e.lightness):"rgba("+W(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new g(2)}function me(e,t,a){if("number"==typeof e&&"number"==typeof t&&"number"==typeof a)return se("#"+oe(e)+oe(t)+oe(a));if("object"==typeof e&&void 0===t&&void 0===a)return se("#"+oe(e.red)+oe(e.green)+oe(e.blue));throw new g(6)}function fe(e,t,a,n){if("string"==typeof e&&"number"==typeof t){var i=ie(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"==typeof e&&"number"==typeof t&&"number"==typeof a&&"number"==typeof n)return n>=1?me(e,t,a):"rgba("+e+","+t+","+a+","+n+")";if("object"==typeof e&&void 0===t&&void 0===a&&void 0===n)return e.alpha>=1?me(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new g(7)}var be=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&("number"!=typeof e.alpha||void 0===e.alpha)},ge=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&"number"==typeof e.alpha},ye=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&("number"!=typeof e.alpha||void 0===e.alpha)},he=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&"number"==typeof e.alpha};function ve(e){if("object"!=typeof e)throw new g(8);if(ge(e))return fe(e);if(be(e))return me(e);if(he(e))return pe(e);if(ye(e))return de(e);throw new g(8)}function Ee(e,t,a){return function(){var n=a.concat(Array.prototype.slice.call(arguments));return n.length>=t?e.apply(this,n):Ee(e,t,n)}}function xe(e){return Ee(e,e.length,[])}function je(e,t){if("transparent"===t)return t;var a=re(t);return ve(c.default({},a,{hue:a.hue+parseFloat(e)}))}var Se=xe(je);function Oe(e,t,a){return Math.max(e,Math.min(t,a))}function ke(e,t){if("transparent"===t)return t;var a=re(t);return ve(c.default({},a,{lightness:Oe(0,1,a.lightness-parseFloat(e))}))}var we=xe(ke);function Te(e,t){if("transparent"===t)return t;var a=re(t);return ve(c.default({},a,{saturation:Oe(0,1,a.saturation-parseFloat(e))}))}var Ie=xe(Te);function Ce(e){if("transparent"===e)return 0;var t=ie(e),a=Object.keys(t).map((function(e){var a=t[e]/255;return a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4)})),n=a[0],i=a[1],r=a[2];return parseFloat((.2126*n+.7152*i+.0722*r).toFixed(3))}function Me(e,t){var a=Ce(e),n=Ce(t);return parseFloat((a>n?(a+.05)/(n+.05):(n+.05)/(a+.05)).toFixed(2))}function _e(e,t){if("transparent"===t)return t;var a=re(t);return ve(c.default({},a,{lightness:Oe(0,1,a.lightness+parseFloat(e))}))}var Ae=xe(_e);function Fe(e,t,a){if("transparent"===t)return a;if("transparent"===a)return t;if(0===e)return a;var n=ie(t),i=c.default({},n,{alpha:"number"==typeof n.alpha?n.alpha:1}),r=ie(a),s=c.default({},r,{alpha:"number"==typeof r.alpha?r.alpha:1}),o=i.alpha-s.alpha,l=2*parseFloat(e)-1,u=((l*o==-1?l:l+o)/(1+l*o)+1)/2,d=1-u;return fe({red:Math.floor(i.red*u+s.red*d),green:Math.floor(i.green*u+s.green*d),blue:Math.floor(i.blue*u+s.blue*d),alpha:i.alpha*(parseFloat(e)/1)+s.alpha*(1-parseFloat(e)/1)})}var Pe=xe(Fe);function De(e,t){if("transparent"===t)return t;var a=ie(t),n="number"==typeof a.alpha?a.alpha:1;return fe(c.default({},a,{alpha:Oe(0,1,(100*n+100*parseFloat(e))/100)}))}var Ne=xe(De),Re="#000",Le="#fff";function Be(e,t){if("transparent"===t)return t;var a=re(t);return ve(c.default({},a,{saturation:Oe(0,1,a.saturation+parseFloat(e))}))}var ze=xe(Be);function qe(e,t){return"transparent"===t?t:ve(c.default({},re(t),{hue:parseFloat(e)}))}var $e=xe(qe);function Ve(e,t){return"transparent"===t?t:ve(c.default({},re(t),{lightness:parseFloat(e)}))}var Ue=xe(Ve);function He(e,t){return"transparent"===t?t:ve(c.default({},re(t),{saturation:parseFloat(e)}))}var Qe=xe(He);function Ge(e,t){return"transparent"===t?t:Pe(parseFloat(e),"rgb(0, 0, 0)",t)}var We=xe(Ge);function Ze(e,t){return"transparent"===t?t:Pe(parseFloat(e),"rgb(255, 255, 255)",t)}var Ke=xe(Ze);function Je(e,t){if("transparent"===t)return t;var a=ie(t),n="number"==typeof a.alpha?a.alpha:1;return fe(c.default({},a,{alpha:Oe(0,1,+(100*n-100*parseFloat(e)).toFixed(2)/100)}))}var Ye=xe(Je),Xe=["top","right","bottom","left"];function et(e,t){return e(t?":"+t:"")}function tt(e,t,a){if(!t)throw new g(67);if(0===e.length)return et(t,null);for(var n=[],i=0;i<e.length;i+=1){if(a&&a.indexOf(e[i])<0)throw new g(68);n.push(et(t,e[i]))}return n.join(",")}var at=[void 0,null,"active","focus","hover"];function nt(e){return"button"+e+',\n  input[type="button"]'+e+',\n  input[type="reset"]'+e+',\n  input[type="submit"]'+e}var it=["absolute","fixed","relative","static","sticky"],rt=[void 0,null,"active","focus","hover"];function st(e){return'input[type="color"]'+e+',\n    input[type="date"]'+e+',\n    input[type="datetime"]'+e+',\n    input[type="datetime-local"]'+e+',\n    input[type="email"]'+e+',\n    input[type="month"]'+e+',\n    input[type="number"]'+e+',\n    input[type="password"]'+e+',\n    input[type="search"]'+e+',\n    input[type="tel"]'+e+',\n    input[type="text"]'+e+',\n    input[type="time"]'+e+',\n    input[type="url"]'+e+',\n    input[type="week"]'+e+",\n    input:not([type])"+e+",\n    textarea"+e}t.adjustHue=Se,t.animation=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=Array.isArray(t[0]);if(!n&&t.length>8)throw new g(64);return{animation:t.map((function(e){if(n&&!Array.isArray(e)||!n&&Array.isArray(e))throw new g(65);if(Array.isArray(e)&&e.length>8)throw new g(66);return Array.isArray(e)?e.join(" "):e})).join(", ")}},t.backgroundImages=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return{backgroundImage:t.join(", ")}},t.backgrounds=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return{background:t.join(", ")}},t.between=P,t.border=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var i;return"string"==typeof e&&Xe.indexOf(e)>=0?((i={})["border"+x(e)+"Width"]=a[0],i["border"+x(e)+"Style"]=a[1],i["border"+x(e)+"Color"]=a[2],i):(a.unshift(e),{borderWidth:a[0],borderStyle:a[1],borderColor:a[2]})},t.borderColor=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return O.apply(void 0,["borderColor"].concat(t))},t.borderRadius=function(e,t){var a,n,i=x(e);if(!t&&0!==t)throw new g(62);if("Top"===i||"Bottom"===i)return(a={})["border"+i+"RightRadius"]=t,a["border"+i+"LeftRadius"]=t,a;if("Left"===i||"Right"===i)return(n={})["borderTop"+i+"Radius"]=t,n["borderBottom"+i+"Radius"]=t,n;throw new g(63)},t.borderStyle=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return O.apply(void 0,["borderStyle"].concat(t))},t.borderWidth=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return O.apply(void 0,["borderWidth"].concat(t))},t.buttons=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return tt(t,nt,at)},t.clearFix=function(e){var t;return void 0===e&&(e="&"),(t={})[e+"::after"]={clear:"both",content:'""',display:"table"},t},t.complement=function(e){if("transparent"===e)return e;var t=re(e);return ve(c.default({},t,{hue:(t.hue+180)%360}))},t.cover=function(e){return void 0===e&&(e=0),{position:"absolute",top:e,right:e,bottom:e,left:e}},t.cssVar=function(e,t){if(!e||!e.match(E)){if(t)return e;throw new g(73)}var a;if("undefined"!=typeof document&&null!==document.documentElement&&(a=getComputedStyle(document.documentElement).getPropertyValue(e)),a)return a.trim();throw new g(74)},t.darken=we,t.desaturate=Ie,t.directionalProperty=O,t.ellipsis=function(e){return void 0===e&&(e="100%"),{display:"inline-block",maxWidth:e,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal"}},t.em=C,t.fluidRange=function(e,t,a){if(void 0===t&&(t="320px"),void 0===a&&(a="1200px"),!Array.isArray(e)&&"object"!=typeof e||null===e)throw new g(49);if(Array.isArray(e)){for(var n,i={},r={},s=function(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return(a=a.call(e)).next.bind(a);if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return D(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(n=s()).done;){var o,l,u=n.value;if(!u.prop||!u.fromSize||!u.toSize)throw new g(50);r[u.prop]=u.fromSize,i["@media (min-width: "+t+")"]=c.default({},i["@media (min-width: "+t+")"],((o={})[u.prop]=P(u.fromSize,u.toSize,t,a),o)),i["@media (min-width: "+a+")"]=c.default({},i["@media (min-width: "+a+")"],((l={})[u.prop]=u.toSize,l))}return c.default({},r,i)}var d,p,m;if(!e.prop||!e.fromSize||!e.toSize)throw new g(51);return(m={})[e.prop]=e.fromSize,m["@media (min-width: "+t+")"]=((d={})[e.prop]=P(e.fromSize,e.toSize,t,a),d),m["@media (min-width: "+a+")"]=((p={})[e.prop]=e.toSize,p),m},t.fontFace=function(e){var t=e.fontFamily,a=e.fontFilePath,n=e.fontStretch,i=e.fontStyle,r=e.fontVariant,s=e.fontWeight,o=e.fileFormats,l=void 0===o?["eot","woff2","woff","ttf","svg"]:o,c=e.formatHint,u=void 0!==c&&c,d=e.localFonts,p=e.unicodeRange,m=e.fontDisplay,f=e.fontVariationSettings,b=e.fontFeatureSettings;if(!t)throw new g(55);if(!a&&!d)throw new g(52);if(d&&!Array.isArray(d))throw new g(53);if(!Array.isArray(l))throw new g(54);var y={"@font-face":{fontFamily:t,src:q(a,d,l,u),unicodeRange:p,fontStretch:n,fontStyle:i,fontVariant:r,fontWeight:s,fontDisplay:m,fontVariationSettings:f,fontFeatureSettings:b}};return JSON.parse(JSON.stringify(y))},t.getContrast=Me,t.getLuminance=Ce,t.getValueAndUnit=_,t.grayscale=function(e){return"transparent"===e?e:ve(c.default({},re(e),{saturation:0}))},t.hiDPI=$,t.hideText=function(){return{textIndent:"101%",overflow:"hidden",whiteSpace:"nowrap"}},t.hideVisually=function(){return{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",whiteSpace:"nowrap",width:"1px"}},t.hsl=de,t.hslToColorString=function(e){if("object"==typeof e&&"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness)return e.alpha&&"number"==typeof e.alpha?pe({hue:e.hue,saturation:e.saturation,lightness:e.lightness,alpha:e.alpha}):de({hue:e.hue,saturation:e.saturation,lightness:e.lightness});throw new g(45)},t.hsla=pe,t.invert=function(e){if("transparent"===e)return e;var t=ie(e);return ve(c.default({},t,{red:255-t.red,green:255-t.green,blue:255-t.blue}))},t.lighten=Ae,t.linearGradient=function(e){var t=e.colorStops,a=e.fallback,n=e.toDirection,i=void 0===n?"":n;if(!t||t.length<2)throw new g(56);return{backgroundColor:a||t[0].replace(/,\s+/g,",").split(" ")[0].replace(/,(?=\S)/g,", "),backgroundImage:V(N||(N=m.default(["linear-gradient(","",")"])),i,t.join(", ").replace(/,(?=\S)/g,", "))}},t.margin=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return O.apply(void 0,["margin"].concat(t))},t.math=function(e,t){var a=v(e),n=a.match(y);if(n&&!n.every((function(e){return e===n[0]})))throw new g(41);return""+function(e,t){var a,n=function(e){var t={};return t.symbols=e?c.default({},b.symbols,e.symbols):c.default({},b.symbols),t}(t),i=[n.symbols["("].prefix],r=[],s=new RegExp("\\d+(?:\\.\\d+)?|"+Object.keys(n.symbols).map((function(e){return n.symbols[e]})).sort((function(e,t){return t.symbol.length-e.symbol.length})).map((function(e){return e.regSymbol})).join("|")+"|(\\S)","g");s.lastIndex=0;var o=!1;do{var l=(a=s.exec(e))||[")",void 0],u=l[0],d=l[1],p=n.symbols[u],m=p&&!p.prefix&&!p.func,f=!p||!p.postfix&&!p.infix;if(d||(o?f:m))throw new g(37,a?a.index:e.length,e);if(o){var y=p.postfix||p.infix;do{var v=i[i.length-1];if((y.precedence-v.precedence||v.rightToLeft)>0)break}while(h(i,r));o="postfix"===y.notation,")"!==y.symbol&&(i.push(y),o&&h(i,r))}else if(p){if(i.push(p.prefix||p.func),p.func&&(!(a=s.exec(e))||"("!==a[0]))throw new g(38,a?a.index:e.length,e)}else r.push(+u),o=!0}while(a&&i.length);if(i.length)throw new g(39,a?a.index:e.length,e);if(a)throw new g(40,a?a.index:e.length,e);return r.pop()}(v(a.replace(y,"")),t)+(n?v(n[0]):"")},t.meetsContrastGuidelines=function(e,t){var a=Me(e,t);return{AA:a>=4.5,AALarge:a>=3,AAA:a>=7,AAALarge:a>=4.5}},t.mix=Pe,t.modularScale=function(e,t,a){if(void 0===t&&(t="1em"),void 0===a&&(a=1.333),"number"!=typeof e)throw new g(42);if("string"==typeof a&&!A[a])throw new g(43);var n="string"==typeof t?_(t):[t,""],i=n[0],r=n[1],s="string"==typeof a?A[a]:a;if("string"==typeof i)throw new g(44,t);return""+i*Math.pow(s,e)+(r||"")},t.normalize=function(){var e;return[(e={html:{lineHeight:"1.15",textSizeAdjust:"100%"},body:{margin:"0"},main:{display:"block"},h1:{fontSize:"2em",margin:"0.67em 0"},hr:{boxSizing:"content-box",height:"0",overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},a:{backgroundColor:"transparent"},"abbr[title]":{borderBottom:"none",textDecoration:"underline"}},e["b,\n    strong"]={fontWeight:"bolder"},e["code,\n    kbd,\n    samp"]={fontFamily:"monospace, monospace",fontSize:"1em"},e.small={fontSize:"80%"},e["sub,\n    sup"]={fontSize:"75%",lineHeight:"0",position:"relative",verticalAlign:"baseline"},e.sub={bottom:"-0.25em"},e.sup={top:"-0.5em"},e.img={borderStyle:"none"},e["button,\n    input,\n    optgroup,\n    select,\n    textarea"]={fontFamily:"inherit",fontSize:"100%",lineHeight:"1.15",margin:"0"},e["button,\n    input"]={overflow:"visible"},e["button,\n    select"]={textTransform:"none"},e['button,\n    html [type="button"],\n    [type="reset"],\n    [type="submit"]']={WebkitAppearance:"button"},e['button::-moz-focus-inner,\n    [type="button"]::-moz-focus-inner,\n    [type="reset"]::-moz-focus-inner,\n    [type="submit"]::-moz-focus-inner']={borderStyle:"none",padding:"0"},e['button:-moz-focusring,\n    [type="button"]:-moz-focusring,\n    [type="reset"]:-moz-focusring,\n    [type="submit"]:-moz-focusring']={outline:"1px dotted ButtonText"},e.fieldset={padding:"0.35em 0.625em 0.75em"},e.legend={boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:"0",whiteSpace:"normal"},e.progress={verticalAlign:"baseline"},e.textarea={overflow:"auto"},e['[type="checkbox"],\n    [type="radio"]']={boxSizing:"border-box",padding:"0"},e['[type="number"]::-webkit-inner-spin-button,\n    [type="number"]::-webkit-outer-spin-button']={height:"auto"},e['[type="search"]']={WebkitAppearance:"textfield",outlineOffset:"-2px"},e['[type="search"]::-webkit-search-decoration']={WebkitAppearance:"none"},e["::-webkit-file-upload-button"]={WebkitAppearance:"button",font:"inherit"},e.details={display:"block"},e.summary={display:"list-item"},e.template={display:"none"},e["[hidden]"]={display:"none"},e),{"abbr[title]":{textDecoration:"underline dotted"}}]},t.opacify=Ne,t.padding=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return O.apply(void 0,["padding"].concat(t))},t.parseToHsl=re,t.parseToRgb=ie,t.position=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return it.indexOf(e)>=0&&e?c.default({},O.apply(void 0,[""].concat(a)),{position:e}):O.apply(void 0,["",e].concat(a))},t.radialGradient=function(e){var t=e.colorStops,a=e.extent,n=void 0===a?"":a,i=e.fallback,r=e.position,s=void 0===r?"":r,o=e.shape,l=void 0===o?"":o;if(!t||t.length<2)throw new g(57);return{backgroundColor:i||t[0].split(" ")[0],backgroundImage:V(R||(R=m.default(["radial-gradient(","","","",")"])),s,l,n,t.join(", "))}},t.readableColor=function(e,t,a,n){void 0===t&&(t=Re),void 0===a&&(a=Le),void 0===n&&(n=!0);var i=Ce(e)>.179,r=i?t:a;return!n||Me(e,r)>=4.5?r:i?Re:Le},t.rem=F,t.retinaImage=function(e,t,a,n,i){var r;if(void 0===a&&(a="png"),void 0===i&&(i="_2x"),!e)throw new g(58);var s=a.replace(/^\./,""),o=n?n+"."+s:""+e+i+"."+s;return(r={backgroundImage:"url("+e+"."+s+")"})[$()]=c.default({backgroundImage:"url("+o+")"},t?{backgroundSize:t}:{}),r},t.rgb=me,t.rgbToColorString=function(e){if("object"==typeof e&&"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue)return"number"==typeof e.alpha?fe({red:e.red,green:e.green,blue:e.blue,alpha:e.alpha}):me({red:e.red,green:e.green,blue:e.blue});throw new g(46)},t.rgba=fe,t.saturate=ze,t.setHue=$e,t.setLightness=Ue,t.setSaturation=Qe,t.shade=We,t.size=function(e,t){return void 0===t&&(t=e),{height:e,width:t}},t.stripUnit=T,t.textInputs=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return tt(t,st,rt)},t.timingFunctions=function(e){return U[e]},t.tint=Ke,t.toColorString=ve,t.transitions=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(Array.isArray(t[0])&&2===t.length){var n=t[1];if("string"!=typeof n)throw new g(61);return{transition:t[0].map((function(e){return e+" "+n})).join(", ")}}return{transition:t.join(", ")}},t.transparentize=Ye,t.triangle=function(e){var t=e.pointingDirection,a=e.height,n=e.width,i=e.foregroundColor,r=e.backgroundColor,s=void 0===r?"transparent":r,o=_(n),l=_(a);if(isNaN(l[0])||isNaN(o[0]))throw new g(60);return c.default({width:"0",height:"0",borderColor:s},function(e,t){switch(e){case"top":case"bottomRight":return{borderBottomColor:t};case"right":case"bottomLeft":return{borderLeftColor:t};case"bottom":case"topLeft":return{borderTopColor:t};case"left":case"topRight":return{borderRightColor:t};default:throw new g(59)}}(t,i),{borderStyle:"solid",borderWidth:H(t,l,o)})},t.wordWrap=function(e){return void 0===e&&(e="break-word"),{overflowWrap:e,wordWrap:e,wordBreak:"break-word"===e?"break-all":e}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(245),i=a(558),r=a(185);const s=e=>`${Object(r.a)(e)}`,o=(e,t,a,s=i.a.flows)=>`/ip/${e}/${t||n.a.source}/${s}${Object(r.a)(a)}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(190),r=a(112),s=a(128);const o=({visualizationId:e})=>{const t=s.d.globalQueryByIdSelector(),{inspect:a}=Object(r.a)((a=>t(a,e)));return Object(n.useMemo)((()=>a?Object(i.g)(null==a?void 0:a.response):null),[a])}},,function(e,t,a){"use strict";var n=a(414);e.exports=function(e){return n({},e)}},function(e,t,a){"use strict";a.d(t,"q",(function(){return r})),a.d(t,"o",(function(){return s})),a.d(t,"p",(function(){return o})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return g})),a.d(t,"h",(function(){return S})),a.d(t,"i",(function(){return O})),a.d(t,"m",(function(){return j})),a.d(t,"n",(function(){return k})),a.d(t,"c",(function(){return I})),a.d(t,"k",(function(){return C})),a.d(t,"l",(function(){return M})),a.d(t,"d",(function(){return _})),a.d(t,"e",(function(){return A})),a.d(t,"j",(function(){return P}));var n=a(5),i=a(139);const r={message:n.i18n.translate("lists.exceptions.isOperatorLabel",{defaultMessage:"is"}),operator:i.c.INCLUDED,type:i.d.MATCH,value:"is"},s={message:n.i18n.translate("lists.exceptions.isNotOperatorLabel",{defaultMessage:"is not"}),operator:i.c.EXCLUDED,type:i.d.MATCH,value:"is_not"},o={message:n.i18n.translate("lists.exceptions.isOneOfOperatorLabel",{defaultMessage:"is one of"}),operator:i.c.INCLUDED,type:i.d.MATCH_ANY,value:"is_one_of"},l={message:n.i18n.translate("lists.exceptions.isNotOneOfOperatorLabel",{defaultMessage:"is not one of"}),operator:i.c.EXCLUDED,type:i.d.MATCH_ANY,value:"is_not_one_of"},c={message:n.i18n.translate("lists.exceptions.existsOperatorLabel",{defaultMessage:"exists"}),operator:i.c.INCLUDED,type:i.d.EXISTS,value:"exists"},u={message:n.i18n.translate("lists.exceptions.doesNotExistOperatorLabel",{defaultMessage:"does not exist"}),operator:i.c.EXCLUDED,type:i.d.EXISTS,value:"does_not_exist"},d={message:n.i18n.translate("lists.exceptions.isInListOperatorLabel",{defaultMessage:"is in list"}),operator:i.c.INCLUDED,type:i.d.LIST,value:"is_in_list"},p={message:n.i18n.translate("lists.exceptions.isNotInListOperatorLabel",{defaultMessage:"is not in list"}),operator:i.c.EXCLUDED,type:i.d.LIST,value:"is_not_in_list"},m={message:n.i18n.translate("lists.exceptions.matchesOperatorLabel",{defaultMessage:"matches"}),operator:i.c.INCLUDED,type:i.d.WILDCARD,value:"matches"},f={message:n.i18n.translate("lists.exceptions.doesNotMatchOperatorLabel",{defaultMessage:"does not match"}),operator:i.c.EXCLUDED,type:i.d.WILDCARD,value:"does_not_match"},b=[r,s,o,l,m,f],g=[r,s,o,l,c,u,d,p,m,f];var y=a(175);const h=y.q,v=y.r;var E=a(9),x=a(45);const j=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?v:h)({namespaceType:e}))),S=({filters:e,namespaceTypes:t,hideLists:a})=>{const n=j({namespaceType:t}),i=((e,t)=>Object.keys(e).map((a=>{const n=Object(x.get)(a,e);return Object(E.isArray)(n)||null!=n&&""!==n.trim()?`(${t.map((e=>{const t="name"===a?"name.text":"types"===a?"type":a;return Object(E.isArray)(n)?n.map((a=>`${e}.attributes.${t}:${a}`)).join(" OR "):`${e}.attributes.${t}:${n}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,n);return[i,...a.map((e=>`(${n.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")},O=({lists:e,showDetection:t,showEndpoint:a})=>e.filter((e=>t?"detection"===e.type:!a||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:a})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,a]})),{ids:[],namespaces:[]}),k=e=>e.filter((({type:e})=>"list"===e)).length>0;var w=a(51),T=a(169);a(437),a(53),a(328);const I=e=>e.map((e=>"nested"===e.type?Object(T.d)({...e,entries:e.entries.map((e=>Object(T.d)(e)))}):Object(T.d)(e))),C=({listId:e,namespaceType:t,name:a})=>({comments:[],description:"Exception list item",entries:I([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(w.v4)()},name:a,namespace_type:t,tags:[],type:"simple"}),M=e=>{switch(e.type){case"match":return i.d.MATCH;case"match_any":return i.d.MATCH_ANY;case"wildcard":return i.d.WILDCARD;case"list":return i.d.LIST;default:return i.d.EXISTS}},_=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},A=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},F=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},P=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[a,n]of Object.entries(e.conflictDescriptions)){const e=[],i={};n.forEach((e=>{const t=F(e);i[t]||(i[t]=0),i[t]++}));for(const[t,a]of Object.entries(i))e.push({name:t,count:a});e.sort(((e,t)=>t.count-e.count)),t.push({type:a,totalIndexCount:n.length,groupedIndices:e})}return t}},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(17),i=a(345),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(61),u=a.n(c),d=a(4),p=a(166),m=a(110),f=a(293),b=a(226);const g=l()(n.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=s.a.memo((({value:e})=>Object(b.a)(e)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));y.displayName="ValueWrapper";const h=({legendItem:e})=>{const[t]=Object(m.o)(d.P),{color:a,count:i,dataProviderId:r,field:o,scopeId:l,value:c}=e;return s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=a&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiHealth,{"data-test-subj":"legend-color",color:a})),s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(p.b,{"data-test-subj":`legend-item-${r}`,field:o,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:c},null==e.render?s.a.createElement(y,{value:c}):e.render({field:o,value:c}))),null!=i&&s.a.createElement(g,{"data-test-subj":"legendItemCount",grow:!1},u()(i).format(t))))))};h.displayName="DraggableLegendItemComponent";const v=s.a.memo(h),E=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t=0,legendItems:a,minWidth:i=165})=>0===a.length?null:s.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},a.map((e=>s.a.createElement(n.EuiFlexItem,{key:e.dataProviderId,grow:!1},s.a.createElement(v,{legendItem:e}),s.a.createElement(n.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const j=s.a.memo(x)},,function(e,t,a){"use strict";a.r(t),a.d(t,"selectTimeline",(function(){return r})),a.d(t,"selectInsertTimeline",(function(){return s})),a.d(t,"timelineByIdSelector",(function(){return o})),a.d(t,"getShowCallOutUnauthorizedMsg",(function(){return l})),a.d(t,"getTimelineByIdSelector",(function(){return c})),a.d(t,"getKqlFilterQuerySelector",(function(){return u})),a.d(t,"getKqlFilterKuerySelector",(function(){return d})),a.d(t,"dataProviderVisibilitySelector",(function(){return p}));var n=a(57);const i=e=>e.timeline.showCallOutUnauthorizedMsg,r=(e,t)=>e.timeline.timelineById[t],s=e=>e.timeline.insertTimeline,o=Object(n.createSelector)((e=>e.timeline.timelineById),(e=>e)),l=()=>Object(n.createSelector)(i,(e=>e)),c=()=>Object(n.createSelector)(r,(e=>e)),u=()=>Object(n.createSelector)(r,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery.expression:null)),d=()=>Object(n.createSelector)(r,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery:null)),p=()=>Object(n.createSelector)(r,(e=>e.isDataProviderVisible))},function(e,t,a){"use strict";const n=a(270),i={};e.exports=function(e,t,a){if(!1===t||null==t)return e;"string"==typeof(a=a||{})&&(a={separator:a});const r=Array.isArray(t);n(!r||!a.separator,"Separator option no valid for array-based chain");const s=r?t:t.split(a.separator||".");let o=e;for(let e=0;e<s.length;++e){let r=s[e];const l=a.iterables&&i.iterables(o);if(Array.isArray(o)||"set"===l){const e=Number(r);Number.isInteger(e)&&(r=e<0?o.length+e:e)}if(!o||"function"==typeof o&&!1===a.functions||!l&&void 0===o[r]){n(!a.strict||e+1===s.length,"Missing segment",r,"in reach path ",t),n("object"==typeof o||!0===a.functions||"function"!=typeof o,"Invalid segment",r,"in reach path ",t),o=a.default;break}o=l?"set"===l?[...o][r]:o.get(r):o[r]}return o},i.iterables=function(e){return e instanceof Set?"set":e instanceof Map?"map":void 0}},function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const a of e)t[a]=a;return t},e.getValidEnumValues=t=>{const a=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of a)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t},e.find=(e,t)=>{for(const a of e)if(t(a))return a},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(n=t.util||(t.util={})),(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(196),i=a(204),r=a(197),s=a(764);const o={columnHeaderType:n.a,displayAsText:r.m,id:"kibana.alert.workflow_assignee_ids",initialWidth:i.b},l=e=>{var t,a;const i=null!==(t=null==e||null===(a=e.isPlatinumPlus)||void 0===a?void 0:a.call(e))&&void 0!==t&&t;return[{columnHeaderType:n.a,displayAsText:r.u,id:"kibana.alert.severity",initialWidth:105},{columnHeaderType:n.a,displayAsText:r.q,id:"kibana.alert.risk_score",initialWidth:100},{columnHeaderType:n.a,displayAsText:r.p,id:"kibana.alert.reason",initialWidth:450},{columnHeaderType:n.a,id:"host.name"},i?{columnHeaderType:n.a,id:"host.risk.calculated_level"}:null,{columnHeaderType:n.a,id:"user.name"},i?{columnHeaderType:n.a,id:"user.risk.calculated_level"}:null,{columnHeaderType:n.a,id:"process.name"},{columnHeaderType:n.a,id:"file.name"},{columnHeaderType:n.a,id:"source.ip"},{columnHeaderType:n.a,id:"destination.ip"}].filter((e=>null!=e))},c=e=>[{columnHeaderType:n.a,id:"@timestamp",initialWidth:i.b+10},{columnHeaderType:n.a,displayAsText:r.r,id:"kibana.alert.rule.name",initialWidth:i.a,linkField:"kibana.alert.rule.uuid"},o,...l(e)],u=e=>[{columnHeaderType:n.a,id:"kibana.alert.original_time",initialWidth:i.b+10},...l(e)],d=[{columnHeaderType:n.a,id:"@timestamp",displayAsText:r.D.timestamp,initialWidth:s.b+50,actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:n.a,displayAsText:r.D.rule,id:"kibana.alert.rule.name",initialWidth:s.a+50,linkField:"kibana.alert.rule.uuid",actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:n.a,id:"eventSummary",displayAsText:r.D.eventSummary,actions:!1,isExpandable:!1,isResizable:!1}]},function(e,t,a){var n=a(450),i=a(451);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var a=n(e.prototype),r=e.apply(a,t);return i(r)?r:a}}},function(e,t,a){e.exports=a(24)(318)},function(e,t,a){"use strict";a.d(t,"c",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return S}));var n=a(65),i=a.n(n),r=a(17),s=a(45),o=a(2),l=a.n(o),c=a(48),u=a(136),d=a.n(u),p=a(581),m=a(4),f=a(118),b=a(110),g=a(181),y=a(119),h=a(361);const v={fill:!1},E=l.a.memo((({duration:e,end:t,fromStr:a,id:n,isLoading:i,kqlQuery:c,policy:u,queries:d,setDuration:p,showUpdateButton:f=!0,start:g,startAutoReload:y,stopAutoReload:h,timelineId:E,toStr:j,updateReduxTime:S,disabled:O,width:k="restricted",compressed:w=!1})=>{const[T,I]=Object(o.useState)([]),C=Object(o.useCallback)((({start:e,end:a})=>{const i=e.includes("now")||a.includes("now"),{kqlHaveBeenUpdated:r}=S({end:a,id:n,isInvalid:!1,isQuickSelection:i,kql:c,start:e,timelineId:E,hasRangeChanged:!1}),s=x(e),o=i?x(a,{roundUp:!0}):x(a);!d||r||i&&(g!==s||t!==o)||_(d)}),[t,n,c,d,g,E,S]),M=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=a&&a.includes("now")||null!=j&&j.includes("now");e!==i&&p({id:n,duration:i}),t&&"interval"===u?h({id:n}):t||"manual"!==u||y({id:n}),d&&!t&&(!r||r&&"now"!==j)&&_(d)}),[a,j,e,u,p,n,h,y,d]),_=e=>{e.forEach((e=>e.refetch&&e.refetch()))},A=Object(o.useCallback)((({start:e,end:t,isInvalid:a})=>{const i=e.includes("now")||t.includes("now");if(!a){S({end:t,id:n,isInvalid:a,isQuickSelection:i,kql:c,start:e,timelineId:E,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(s.take)(9,T.filter((a=>!(a.start===e&&a.end===t))))];I(r)}}),[S,n,c,E,T]),F=null!=j?j:new Date(t).toISOString(),P=null!=a?a:new Date(g).toISOString(),[D]=Object(b.o)(m.W),N=Object(s.isEmpty)(D)?[]:D.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:N,end:F,isLoading:i,isPaused:"manual"===u,onRefresh:C,onRefreshChange:M,onTimeChange:A,recentlyUsedRanges:T,refreshInterval:e,showUpdateButton:f,start:P,isDisabled:O,width:k,compressed:w,updateButtonProps:v})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),x=(e,t)=>{const a=i.a.parse(e,t);return null!=a&&a.isValid()?a.toISOString():""},j=e=>({end:t,id:a,isQuickSelection:n,kql:i,start:r,timelineId:s,hasRangeChanged:o})=>{const l=x(r);let c=x(t,{roundUp:!0});var u;return n?e(t===r?g.c.setAbsoluteRangeDatePicker({id:a,fromStr:r,toStr:t,from:l,to:c}):g.c.setRelativeRangeDatePicker({id:a,fromStr:r,toStr:t,from:l,to:c})):(c=x(t),e(g.c.setAbsoluteRangeDatePicker({id:a,from:x(r),to:x(t)}))),null!=s&&o&&e(f.a.updateRange({id:s,start:l,end:c})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(u=i.refetch(e))&&void 0!==u&&u}:{kqlHaveBeenUpdated:!1}};E.displayName="SuperDatePickerComponent";const S=Object(c.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),a=Object(h.c)(),n=Object(h.d)(),i=Object(h.e)(),r=Object(h.f)(),o=Object(h.g)(),l=Object(h.h)(),c=Object(h.i)(),u=Object(h.j)();return(d,{id:m})=>{const f=Object(s.getOr)({},`inputs.${m}`,d);return{duration:e(f),end:t(f),fromStr:a(f),kind:i(f),policy:o(f),start:c(f),toStr:u(f),isLoading:!1,...Object(p.c)(f)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:n(f),kqlQuery:r(f),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(g.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(g.c.stopAutoReload({id:t})),setDuration:({id:t,duration:a})=>e(g.c.setDuration({id:t,duration:a})),updateReduxTime:j(e)})))(E)},function(e,t,a){"use strict";a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return b})),a.d(t,"j",(function(){return g})),a.d(t,"d",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"f",(function(){return v}));var n=a(9),i=a(57),r=a(119);const s=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,c=(e,t)=>{const a=e.inputs[t];return Object(n.isEmpty)(a.linkTo)?a.queries:a.linkTo.reduce(((t,a)=>{if(a===r.a.socTrends)return t;const n=e.inputs[a];return[...t,...n.queries]}),a.queries)},u=()=>Object(i.createSelector)(s,(e=>e.kind)),d=()=>Object(i.createSelector)(s,(e=>e.duration)),p=()=>Object(i.createSelector)(o,(e=>e.kind)),m=()=>Object(i.createSelector)(o,(e=>e.from)),f=()=>Object(i.createSelector)(o,(e=>e.to)),b=()=>Object(i.createSelector)(o,(e=>e.fromStr)),g=()=>Object(i.createSelector)(o,(e=>e.toStr)),y=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(i.createSelector)(c,(e=>e.filter((e=>"kql"!==e.id)))),v=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return b}));var n=a(111);const i=n.z.enum([".osquery",".endpoint"]),r=i.enum,s=n.z.object({}).catchall(n.z.object({field:n.z.string().optional(),value:n.z.union([n.z.string(),n.z.array(n.z.string())]).optional()})),o=n.z.object({id:n.z.string(),query:n.z.string(),ecs_mapping:s.optional(),version:n.z.string().optional(),platform:n.z.string().optional(),removed:n.z.boolean().optional(),snapshot:n.z.boolean().optional()}),l=n.z.object({query:n.z.string().optional(),ecs_mapping:s.optional(),queries:n.z.array(o).optional(),pack_id:n.z.string().optional(),saved_query_id:n.z.string().optional(),timeout:n.z.number().optional()}),c=n.z.object({query:n.z.string().optional(),ecsMapping:s.optional(),queries:n.z.array(o).optional(),packId:n.z.string().optional(),savedQueryId:n.z.string().optional(),timeout:n.z.number().optional()}),u=n.z.object({action_type_id:n.z.literal(".osquery"),params:l}),d=n.z.object({actionTypeId:n.z.literal(".osquery"),params:c}),p=n.z.object({command:n.z.literal("isolate"),comment:n.z.string().optional()}),m=n.z.object({action_type_id:n.z.literal(".endpoint"),params:p}),f=n.z.object({actionTypeId:n.z.literal(".endpoint"),params:p}),b=n.z.union([u,m]);n.z.union([d,f])},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(111),i=a(219),r=a(364);const s=n.z.object({last_execution:n.z.object({date:n.z.string().datetime(),status:i.a,status_order:i.c,message:n.z.string(),metrics:r.a})})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(111);const i=n.z.object({total_search_duration_ms:n.z.number().int().min(0).optional(),total_indexing_duration_ms:n.z.number().int().min(0).optional(),total_enrichment_duration_ms:n.z.number().int().min(0).optional(),execution_gap_duration_s:n.z.number().int().min(0).optional()})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(111);const i=n.z.string(),r=n.z.string(),s=n.z.string()},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(111),i=a(141);const r=n.z.array(n.z.object({field:n.z.string(),value:n.z.number().int().min(0)})),s=n.z.number().int().min(1),o=n.z.union([n.z.string(),n.z.array(n.z.string())]),l=n.z.array(n.z.string()),c=n.z.object({field:o,value:s,cardinality:r.optional()}),u=(n.z.object({field:l,value:s,cardinality:r.optional()}),n.z.object({field:l,value:s,cardinality:r}),n.z.object({duration:i.a}))},function(e,t,a){"use strict";a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(111),i=a(141);const r=n.z.string(),s=n.z.array(n.z.object({entries:n.z.array(n.z.object({field:i.m,type:n.z.literal("mapping"),value:i.m}))})).min(1),o=n.z.array(n.z.string()),l=n.z.array(n.z.unknown()),c=n.z.string(),u=n.z.number().int().min(1),d=n.z.number().int().min(1)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(111);const i=n.z.number().int().min(0),r=n.z.union([n.z.string(),n.z.array(n.z.string()).min(1)])},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(111),i=a(141);const r=n.z.array(n.z.string()).min(1).max(3),s=i.m},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(111);const i=n.z.number().int().min(1),r=n.z.number().int().min(0),s=n.z.object({page:i,per_page:r,total:n.z.number().int().min(0)})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(111);const i=n.z.object({type:n.z.string(),message:n.z.string(),actionPath:n.z.string(),buttonLabel:n.z.string().optional()})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="xs"},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return l}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"}),r=n.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),s=n.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),o=n.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),l=n.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"})},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c}));var n=a(549);const i=e=>{const{response:t,isStream:a,isError:n}=e,i=(new Date).toLocaleString();return e?{role:"assistant",...a?{reader:t}:{content:t},timestamp:i,isError:n,traceData:e.traceData}:{role:"assistant",content:"Error: Response from LLM API is empty or undefined.",timestamp:i,isError:!0}},r=(e,t)=>t?{...e,messages:[...e.messages,...n.a.messages]}:0===e.messages.length||e.messages[e.messages.length-1].content!==n.b[0].content?{...e,messages:[...e.messages,...n.b]}:e,s=e=>1===(null==e?void 0:e.length)?e[0]:void 0,o=e=>{const t=e.match(/```json\n([\s\S]+)\n```/);if(t)try{var a;return null!==(a=JSON.parse(t[1]).action_input)&&void 0!==a?a:e}catch{}return e},l=({alerts:e,alertsIndexPattern:t,allow:a,allowReplacement:n,replacements:i,size:r})=>e?{...t?{alertsIndexPattern:t}:void 0,...a?{allow:a}:void 0,...n?{allowReplacement:n}:void 0,...i?{replacements:i}:void 0,...r?{size:r}:void 0}:{},c=({alerts:e,assistantLangChain:t})=>t||e},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t,a){var i=n.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),n.useEffect(e,i.current)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef(!1),i=n.useRef(),r=n.useRef(e),s=n.useCallback((function(){return a.current}),[]),o=n.useCallback((function(){a.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){a.current=!0,r.current()}),t)}),[t]),l=n.useCallback((function(){a.current=null,i.current&&clearTimeout(i.current)}),[]);return n.useEffect((function(){r.current=e}),[e]),n.useEffect((function(){return o(),l}),[t]),[s,l,o]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(18),i=a(110),r=a(4);const s=()=>{var e,t,a,s,o;const l=Object(n.b)().isEnterprise(),c=Object(i.i)().services.application.capabilities,u=!0===(null===(e=c[r.n])||void 0===e?void 0:e["ai-assistant"]),d=!0===(null===(t=c.actions)||void 0===t?void 0:t.show)&&!0===(null===(a=c.actions)||void 0===a?void 0:a.execute);return{hasAssistantPrivilege:u,hasConnectorsAllPrivilege:d&&!0===(null===(s=c.actions)||void 0===s?void 0:s.delete)&&!0===(null===(o=c.actions)||void 0===o?void 0:o.save),hasConnectorsReadPrivilege:d,isAssistantEnabled:l}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=a(2))&&"object"==typeof n&&"default"in n?n:{default:n},r=e=>"checkbox"===e.type,s=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var c=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!s(e),u=e=>c(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function m(e){let t;const a=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(p&&(e instanceof Blob||e instanceof FileList)||!a&&!c(e))return e;if(t=a?[]:{},a||(e=>{const t=e.constructor&&e.constructor.prototype;return c(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const a in e)e.hasOwnProperty(a)&&(t[a]=m(e[a]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],b=e=>void 0===e,g=(e,t,a)=>{if(!t||!c(e))return a;const n=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return b(n)||n===e?b(e[t])?a:e[t]:n};const y="blur",h="focusout",v="change",E="onChange",x="onSubmit",j="all",S="pattern",O="required",k=i.default.createContext(null),w=()=>i.default.useContext(k);var T=(e,t,a,n=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==j&&(t._proxyFormState[i]=!n||j),a&&(a[i]=!0),e[i]}});return i},I=e=>c(e)&&!Object.keys(e).length,C=(e,t,a,n)=>{a(e);const{name:i,...r}=e;return I(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!n||j)))},M=e=>Array.isArray(e)?e:[e],_=(e,t,a)=>a&&t?e===t:!e||!t||e===t||M(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function A(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const a=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{a&&a.unsubscribe()}}),[e.disabled])}function F(e){const t=w(),{control:a=t.control,disabled:n,name:r,exact:s}=e||{},[o,l]=i.default.useState(a._formState),c=i.default.useRef(!0),u=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,A({disabled:n,next:e=>c.current&&_(d.current,e.name,s)&&C(e,u.current,a._updateFormState)&&l({...a._formState,...e}),subject:a._subjects.state}),i.default.useEffect((()=>(c.current=!0,u.current.isValid&&a._updateValid(!0),()=>{c.current=!1})),[a]),T(o,a,u.current,!1)}var P=e=>"string"==typeof e,D=(e,t,a,n,i)=>P(e)?(n&&t.watch.add(e),g(a,e,i)):Array.isArray(e)?e.map((e=>(n&&t.watch.add(e),g(a,e)))):(n&&(t.watchAll=!0),a);function N(e){const t=w(),{control:a=t.control,name:n,defaultValue:r,disabled:s,exact:o}=e||{},l=i.default.useRef(n);l.current=n,A({disabled:s,subject:a._subjects.values,next:e=>{_(l.current,e.name,o)&&u(m(D(l.current,a._names,e.values||a._formValues,!1,r)))}});const[c,u]=i.default.useState(a._getWatch(n,r));return i.default.useEffect((()=>a._removeUnmounted())),c}var R=e=>/^\w*$/.test(e),L=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function B(e,t,a){let n=-1;const i=R(t)?[t]:L(t),r=i.length,s=r-1;for(;++n<r;){const t=i[n];let r=a;if(n!==s){const a=e[t];r=c(a)||Array.isArray(a)?a:isNaN(+i[n+1])?{}:[]}e[t]=r,e=e[t]}return e}function z(e){const t=w(),{name:a,control:n=t.control,shouldUnregister:r}=e,s=d(n._names.array,a),o=N({control:n,name:a,defaultValue:g(n._formValues,a,g(n._defaultValues,a,e.defaultValue)),exact:!0}),l=F({control:n,name:a}),c=i.default.useRef(n.register(a,{...e.rules,value:o}));return c.current=n.register(a,e.rules),i.default.useEffect((()=>{const e=n._options.shouldUnregister||r,t=(e,t)=>{const a=g(n._fields,e);a&&(a._f.mount=t)};if(t(a,!0),e){const e=m(g(n._options.defaultValues,a));B(n._defaultValues,a,e),b(g(n._formValues,a))&&B(n._formValues,a,e)}return()=>{(s?e&&!n._state.action:e)?n.unregister(a):t(a,!1)}}),[a,n,s,r]),{field:{name:a,value:o,onChange:i.default.useCallback((e=>c.current.onChange({target:{value:u(e),name:a},type:v})),[a]),onBlur:i.default.useCallback((()=>c.current.onBlur({target:{value:g(n._formValues,a),name:a},type:y})),[a,n]),ref:e=>{const t=g(n._fields,a);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,a)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,a)},error:{enumerable:!0,get:()=>g(l.errors,a)}})}}const q="post";var $=(e,t,a,n,i)=>t?{...a[e],types:{...a[e]&&a[e].types?a[e].types:{},[n]:i||!0}}:{};const V=(e,t,a)=>{for(const n of a||Object.keys(e)){const a=g(e,n);if(a){const{_f:e,...n}=a;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else c(n)&&V(n,t)}}};var U=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const a=(16*Math.random()+e)%16|0;return("x"==t?a:3&a|8).toString(16)}))},H=(e,t,a={})=>a.shouldFocus||b(a.shouldFocus)?a.focusName||`${e}.${b(a.focusIndex)?t:a.focusIndex}.`:"",Q=e=>({isOnSubmit:!e||e===x,isOnBlur:"onBlur"===e,isOnChange:e===E,isOnAll:e===j,isOnTouch:"onTouched"===e}),G=(e,t,a)=>!a&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),W=(e,t,a)=>{const n=f(g(e,a));return B(n,"root",t[a]),B(e,a,n),e},Z=e=>"boolean"==typeof e,K=e=>"file"===e.type,J=e=>"function"==typeof e,Y=e=>{if(!p)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},X=e=>P(e),ee=e=>"radio"===e.type,te=e=>e instanceof RegExp;const ae={value:!1,isValid:!1},ne={value:!0,isValid:!0};var ie=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!b(e[0].attributes.value)?b(e[0].value)||""===e[0].value?ne:{value:e[0].value,isValid:!0}:ne:ae}return ae};const re={isValid:!1,value:null};var se=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),re):re;function oe(e,t,a="validate"){if(X(e)||Array.isArray(e)&&e.every(X)||Z(e)&&!e)return{type:a,message:X(e)?e:"",ref:t}}var le=e=>c(e)&&!te(e)?e:{value:e,message:""},ce=async(e,t,a,n,i)=>{const{ref:s,refs:l,required:u,maxLength:d,minLength:p,min:m,max:f,pattern:y,validate:h,name:v,valueAsNumber:E,mount:x,disabled:j}=e._f,k=g(t,v);if(!x||j)return{};const w=l?l[0]:s,T=e=>{n&&w.reportValidity&&(w.setCustomValidity(Z(e)?"":e||""),w.reportValidity())},C={},M=ee(s),_=r(s),A=M||_,F=(E||K(s))&&b(s.value)&&b(k)||Y(s)&&""===s.value||""===k||Array.isArray(k)&&!k.length,D=$.bind(null,v,a,C),N=(e,t,a,n="maxLength",i="minLength")=>{const r=e?t:a;C[v]={type:e?n:i,message:r,ref:s,...D(e?n:i,r)}};if(i?!Array.isArray(k)||!k.length:u&&(!A&&(F||o(k))||Z(k)&&!k||_&&!ie(l).isValid||M&&!se(l).isValid)){const{value:e,message:t}=X(u)?{value:!!u,message:u}:le(u);if(e&&(C[v]={type:O,message:t,ref:w,...D(O,t)},!a))return T(t),C}if(!(F||o(m)&&o(f))){let e,t;const n=le(f),i=le(m);if(o(k)||isNaN(k)){const a=s.valueAsDate||new Date(k),r=e=>new Date((new Date).toDateString()+" "+e),o="time"==s.type,l="week"==s.type;P(n.value)&&k&&(e=o?r(k)>r(n.value):l?k>n.value:a>new Date(n.value)),P(i.value)&&k&&(t=o?r(k)<r(i.value):l?k<i.value:a<new Date(i.value))}else{const a=s.valueAsNumber||(k?+k:k);o(n.value)||(e=a>n.value),o(i.value)||(t=a<i.value)}if((e||t)&&(N(!!e,n.message,i.message,"max","min"),!a))return T(C[v].message),C}if((d||p)&&!F&&(P(k)||i&&Array.isArray(k))){const e=le(d),t=le(p),n=!o(e.value)&&k.length>+e.value,i=!o(t.value)&&k.length<+t.value;if((n||i)&&(N(n,e.message,t.message),!a))return T(C[v].message),C}if(y&&!F&&P(k)){const{value:e,message:t}=le(y);if(te(e)&&!k.match(e)&&(C[v]={type:S,message:t,ref:s,...D(S,t)},!a))return T(t),C}if(h)if(J(h)){const e=oe(await h(k,t),w);if(e&&(C[v]={...e,...D("validate",e.message)},!a))return T(e.message),C}else if(c(h)){let e={};for(const n in h){if(!I(e)&&!a)break;const i=oe(await h[n](k,t),w,n);i&&(e={...i,...D(n,i.message)},T(i.message),a&&(C[v]=e))}if(!I(e)&&(C[v]={ref:w,...e},!a))return C}return T(!0),C};function ue(e,t){return[...e,...M(t)]}var de=e=>Array.isArray(e)?e.map((()=>{})):void 0;function pe(e,t,a){return[...e.slice(0,t),...M(a),...e.slice(t)]}var me=(e,t,a)=>Array.isArray(e)?(b(e[a])&&(e[a]=void 0),e.splice(a,0,e.splice(t,1)[0]),e):[];function fe(e,t){return[...M(t),...M(e)]}var be=(e,t)=>b(t)?[]:function(e,t){let a=0;const n=[...e];for(const e of t)n.splice(e-a,1),a++;return f(n).length?n:[]}(e,M(t).sort(((e,t)=>e-t))),ge=(e,t,a)=>{e[t]=[e[a],e[a]=e[t]][0]};function ye(e,t){const a=Array.isArray(t)?t:R(t)?[t]:L(t),n=1===a.length?e:function(e,t){const a=t.slice(0,-1).length;let n=0;for(;n<a;)e=b(e)?n++:e[t[n++]];return e}(e,a),i=a.length-1,r=a[i];return n&&delete n[r],0!==i&&(c(n)&&I(n)||Array.isArray(n)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!b(e[t]))return!1;return!0}(n))&&ye(e,a.slice(0,-1)),e}var he=(e,t,a)=>(e[t]=a,e);function ve(){let e=[];return{get observers(){return e},next:t=>{for(const a of e)a.next&&a.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var Ee=e=>o(e)||!l(e);function xe(e,t){if(Ee(e)||Ee(t))return e===t;if(s(e)&&s(t))return e.getTime()===t.getTime();const a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(const i of a){const a=e[i];if(!n.includes(i))return!1;if("ref"!==i){const e=t[i];if(s(a)&&s(e)||c(a)&&c(e)||Array.isArray(a)&&Array.isArray(e)?!xe(a,e):a!==e)return!1}}return!0}var je=e=>"select-multiple"===e.type,Se=e=>Y(e)&&e.isConnected,Oe=e=>{for(const t in e)if(J(e[t]))return!0;return!1};function ke(e,t={}){const a=Array.isArray(e);if(c(e)||a)for(const a in e)Array.isArray(e[a])||c(e[a])&&!Oe(e[a])?(t[a]=Array.isArray(e[a])?[]:{},ke(e[a],t[a])):o(e[a])||(t[a]=!0);return t}function we(e,t,a){const n=Array.isArray(e);if(c(e)||n)for(const n in e)Array.isArray(e[n])||c(e[n])&&!Oe(e[n])?b(t)||Ee(a[n])?a[n]=Array.isArray(e[n])?ke(e[n],[]):{...ke(e[n])}:we(e[n],o(t)?{}:t[n],a[n]):a[n]=!xe(e[n],t[n]);return a}var Te=(e,t)=>we(e,t,ke(t)),Ie=(e,{valueAsNumber:t,valueAsDate:a,setValueAs:n})=>b(e)?e:t?""===e?NaN:e?+e:e:a&&P(e)?new Date(e):n?n(e):e;function Ce(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return K(t)?t.files:ee(t)?se(e.refs).value:je(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?ie(e.refs).value:Ie(b(t.value)?e.ref.value:t.value,e)}var Me=e=>b(e)?e:te(e)?e.source:c(e)?te(e.value)?e.value.source:e.value:e;function _e(e,t,a){const n=g(e,a);if(n||R(a))return{error:n,name:a};const i=a.split(".");for(;i.length;){const n=i.join("."),r=g(t,n),s=g(e,n);if(r&&!Array.isArray(r)&&a!==n)return{name:a};if(s&&s.type)return{name:n,error:s};i.pop()}return{name:a}}const Ae={mode:x,reValidateMode:E,shouldFocusError:!0};function Fe(e={},t){let a,n={...Ae,...e},i={submitCount:0,isDirty:!1,isLoading:J(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},v=(c(n.defaultValues)||c(n.values))&&m(n.defaultValues||n.values)||{},E=n.shouldUnregister?{}:m(v),x={action:!1,mount:!1,watch:!1},S={mount:new Set,unMount:new Set,array:new Set,watch:new Set},O=0;const k={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:ve(),array:ve(),state:ve()},T=e.resetOptions&&e.resetOptions.keepDirtyValues,C=Q(n.mode),_=Q(n.reValidateMode),A=n.criteriaMode===j,F=async e=>{if(k.isValid||e){const e=n.resolver?I((await q()).errors):await $(l,!0);e!==i.isValid&&w.state.next({isValid:e})}},N=e=>k.isValidating&&w.state.next({isValidating:e}),R=(e,t,a,n)=>{const i=g(l,e);if(i){const r=g(E,e,b(a)?g(v,e):a);b(r)||n&&n.defaultChecked||t?B(E,e,t?r:Ce(i._f)):X(e,r),x.mount&&F()}},L=(e,t,a,n,r)=>{let s=!1,o=!1;const l={name:e};if(!a||n){k.isDirty&&(o=i.isDirty,i.isDirty=l.isDirty=U(),s=o!==l.isDirty);const a=xe(g(v,e),t);o=g(i.dirtyFields,e),a?ye(i.dirtyFields,e):B(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,s=s||k.dirtyFields&&o!==!a}if(a){const t=g(i.touchedFields,e);t||(B(i.touchedFields,e,a),l.touchedFields=i.touchedFields,s=s||k.touchedFields&&t!==a)}return s&&r&&w.state.next(l),s?l:{}},z=(t,n,r,s)=>{const o=g(i.errors,t),l=k.isValid&&Z(n)&&i.isValid!==n;var c;if(e.delayError&&r?(c=()=>((e,t)=>{B(i.errors,e,t),w.state.next({errors:i.errors})})(t,r),a=e=>{clearTimeout(O),O=setTimeout(c,e)},a(e.delayError)):(clearTimeout(O),a=null,r?B(i.errors,t,r):ye(i.errors,t)),(r?!xe(o,r):o)||!I(s)||l){const e={...s,...l&&Z(n)?{isValid:n}:{},errors:i.errors,name:t};i={...i,...e},w.state.next(e)}N(!1)},q=async e=>n.resolver(E,n.context,((e,t,a,n)=>{const i={};for(const a of e){const e=g(t,a);e&&B(i,a,e._f)}return{criteriaMode:a,names:[...e],fields:i,shouldUseNativeValidation:n}})(e||S.mount,l,n.criteriaMode,n.shouldUseNativeValidation)),$=async(e,t,a={valid:!0})=>{for(const r in e){const s=e[r];if(s){const{_f:e,...r}=s;if(e){const r=S.array.has(e.name),o=await ce(s,E,A,n.shouldUseNativeValidation&&!t,r);if(o[e.name]&&(a.valid=!1,t))break;!t&&(g(o,e.name)?r?W(i.errors,o,e.name):B(i.errors,e.name,o[e.name]):ye(i.errors,e.name))}r&&await $(r,t,a)}}return a.valid},U=(e,t)=>(e&&t&&B(E,e,t),!xe(re(),v)),H=(e,t,a)=>D(e,S,{...x.mount?E:b(t)?v:P(e)?{[e]:t}:t},a,t),X=(e,t,a={})=>{const n=g(l,e);let i=t;if(n){const a=n._f;a&&(!a.disabled&&B(E,e,Ie(t,a)),i=Y(a.ref)&&o(t)?"":t,je(a.ref)?[...a.ref.options].forEach((e=>e.selected=i.includes(e.value))):a.refs?r(a.ref)?a.refs.length>1?a.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):a.refs[0]&&(a.refs[0].checked=!!i):a.refs.forEach((e=>e.checked=e.value===i)):K(a.ref)?a.ref.value="":(a.ref.value=i,a.ref.type||w.values.next({name:e,values:{...E}})))}(a.shouldDirty||a.shouldTouch)&&L(e,i,a.shouldTouch,a.shouldDirty,!0),a.shouldValidate&&ie(e)},te=(e,t,a)=>{for(const n in t){const i=t[n],r=`${e}.${n}`,o=g(l,r);!S.array.has(e)&&Ee(i)&&(!o||o._f)||s(i)?X(r,i,a):te(r,i,a)}},ae=(e,a,n={})=>{const r=g(l,e),s=S.array.has(e),c=m(a);B(E,e,c),s?(w.array.next({name:e,values:{...E}}),(k.isDirty||k.dirtyFields)&&n.shouldDirty&&w.state.next({name:e,dirtyFields:Te(v,E),isDirty:U(e,c)})):!r||r._f||o(c)?X(e,c,n):te(e,c,n),G(e,S)&&w.state.next({...i}),w.values.next({name:e,values:{...E}}),!x.mount&&t()},ne=async e=>{const t=e.target;let r=t.name,s=!0;const o=g(l,r);if(o){let d,p;const m=t.type?Ce(o._f):u(e),f=e.type===y||e.type===h,b=!((c=o._f).mount&&(c.required||c.min||c.max||c.maxLength||c.minLength||c.pattern||c.validate)||n.resolver||g(i.errors,r)||o._f.deps)||((e,t,a,n,i)=>!i.isOnAll&&(!a&&i.isOnTouch?!(t||e):(a?n.isOnBlur:i.isOnBlur)?!e:!(a?n.isOnChange:i.isOnChange)||e))(f,g(i.touchedFields,r),i.isSubmitted,_,C),v=G(r,S,f);B(E,r,m),f?(o._f.onBlur&&o._f.onBlur(e),a&&a(0)):o._f.onChange&&o._f.onChange(e);const x=L(r,m,f,!1),j=!I(x)||v;if(!f&&w.values.next({name:r,type:e.type,values:{...E}}),b)return k.isValid&&F(),j&&w.state.next({name:r,...v?{}:x});if(!f&&v&&w.state.next({...i}),N(!0),n.resolver){const{errors:e}=await q([r]),t=_e(i.errors,l,r),a=_e(e,l,t.name||r);d=a.error,r=a.name,p=I(e)}else d=(await ce(o,E,A,n.shouldUseNativeValidation))[r],s=isNaN(m)||m===g(E,r,m),s&&(d?p=!1:k.isValid&&(p=await $(l,!0)));s&&(o._f.deps&&ie(o._f.deps),z(r,p,d,x))}var c},ie=async(e,t={})=>{let a,r;const s=M(e);if(N(!0),n.resolver){const t=await(async e=>{const{errors:t}=await q();if(e)for(const a of e){const e=g(t,a);e?B(i.errors,a,e):ye(i.errors,a)}else i.errors=t;return t})(b(e)?e:s);a=I(t),r=e?!s.some((e=>g(t,e))):a}else e?(r=(await Promise.all(s.map((async e=>{const t=g(l,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(r||i.isValid)&&F()):r=a=await $(l);return w.state.next({...!P(e)||k.isValid&&a!==i.isValid?{}:{name:e},...n.resolver||!e?{isValid:a}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!r&&V(l,(e=>e&&g(i.errors,e)),e?s:S.mount),r},re=e=>{const t={...v,...x.mount?E:{}};return b(e)?t:P(e)?g(t,e):e.map((e=>g(t,e)))},se=(e,t)=>({invalid:!!g((t||i).errors,e),isDirty:!!g((t||i).dirtyFields,e),isTouched:!!g((t||i).touchedFields,e),error:g((t||i).errors,e)}),oe=(e,t,a)=>{const n=(g(l,e,{_f:{}})._f||{}).ref;B(i.errors,e,{...t,ref:n}),w.state.next({name:e,errors:i.errors,isValid:!1}),a&&a.shouldFocus&&n&&n.focus&&n.focus()},le=(e,t={})=>{for(const a of e?M(e):S.mount)S.mount.delete(a),S.array.delete(a),t.keepValue||(ye(l,a),ye(E,a)),!t.keepError&&ye(i.errors,a),!t.keepDirty&&ye(i.dirtyFields,a),!t.keepTouched&&ye(i.touchedFields,a),!n.shouldUnregister&&!t.keepDefaultValue&&ye(v,a);w.values.next({values:{...E}}),w.state.next({...i,...t.keepDirty?{isDirty:U()}:{}}),!t.keepIsValid&&F()},ue=(e,t={})=>{let a=g(l,e);const i=Z(t.disabled);return B(l,e,{...a||{},_f:{...a&&a._f?a._f:{ref:{name:e}},name:e,mount:!0,...t}}),S.mount.add(e),a?i&&B(E,e,t.disabled?void 0:g(E,e,Ce(a._f))):R(e,!0,t.value),{...i?{disabled:t.disabled}:{},...n.progressive?{required:!!t.required,min:Me(t.min),max:Me(t.max),minLength:Me(t.minLength),maxLength:Me(t.maxLength),pattern:Me(t.pattern)}:{},name:e,onChange:ne,onBlur:ne,ref:i=>{if(i){ue(e,t),a=g(l,e);const n=b(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,s=(e=>ee(e)||r(e))(n),o=a._f.refs||[];if(s?o.find((e=>e===n)):n===a._f.ref)return;B(l,e,{_f:{...a._f,...s?{refs:[...o.filter(Se),n,...Array.isArray(g(v,e))?[{}]:[]],ref:{type:n.type,name:e}}:{ref:n}}}),R(e,!1,void 0,n)}else a=g(l,e,{}),a._f&&(a._f.mount=!1),(n.shouldUnregister||t.shouldUnregister)&&(!d(S.array,e)||!x.action)&&S.unMount.add(e)}}},de=()=>n.shouldFocusError&&V(l,(e=>e&&g(i.errors,e)),S.mount),pe=(e,t)=>async a=>{a&&(a.preventDefault&&a.preventDefault(),a.persist&&a.persist());let r=m(E);if(w.state.next({isSubmitting:!0}),n.resolver){const{errors:e,values:t}=await q();i.errors=e,r=t}else await $(l);ye(i.errors,"root"),I(i.errors)?(w.state.next({errors:{}}),await e(r,a)):(t&&await t({...i.errors},a),de(),setTimeout(de)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:I(i.errors),submitCount:i.submitCount+1,errors:i.errors})},me=(a,n={})=>{const r=a||v,s=m(r),o=a&&!I(a)?s:v;if(n.keepDefaultValues||(v=r),!n.keepValues){if(n.keepDirtyValues||T)for(const e of S.mount)g(i.dirtyFields,e)?B(o,e,g(E,e)):ae(e,g(o,e));else{if(p&&b(a))for(const e of S.mount){const t=g(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(Y(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}E=e.shouldUnregister?n.keepDefaultValues?m(v):{}:m(o),w.array.next({values:{...o}}),w.values.next({values:{...o}})}S={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!x.mount&&t(),x.mount=!k.isValid||!!n.keepIsValid,x.watch=!!e.shouldUnregister,w.state.next({submitCount:n.keepSubmitCount?i.submitCount:0,isDirty:n.keepDirty?i.isDirty:!(!n.keepDefaultValues||xe(a,v)),isSubmitted:!!n.keepIsSubmitted&&i.isSubmitted,dirtyFields:n.keepDirtyValues?i.dirtyFields:n.keepDefaultValues&&a?Te(v,a):{},touchedFields:n.keepTouched?i.touchedFields:{},errors:n.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},fe=(e,t)=>me(J(e)?e(E):e,t);return{control:{register:ue,unregister:le,getFieldState:se,handleSubmit:pe,setError:oe,_executeSchema:q,_getWatch:H,_getDirty:U,_updateValid:F,_removeUnmounted:()=>{for(const e of S.unMount){const t=g(l,e);t&&(t._f.refs?t._f.refs.every((e=>!Se(e))):!Se(t._f.ref))&&le(e)}S.unMount=new Set},_updateFieldArray:(e,t=[],a,n,r=!0,s=!0)=>{if(n&&a){if(x.action=!0,s&&Array.isArray(g(l,e))){const t=a(g(l,e),n.argA,n.argB);r&&B(l,e,t)}if(s&&Array.isArray(g(i.errors,e))){const t=a(g(i.errors,e),n.argA,n.argB);r&&B(i.errors,e,t),((e,t)=>{!f(g(e,t)).length&&ye(e,t)})(i.errors,e)}if(k.touchedFields&&s&&Array.isArray(g(i.touchedFields,e))){const t=a(g(i.touchedFields,e),n.argA,n.argB);r&&B(i.touchedFields,e,t)}k.dirtyFields&&(i.dirtyFields=Te(v,E)),w.state.next({name:e,isDirty:U(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else B(E,e,t)},_getFieldArray:t=>f(g(x.mount?E:v,t,e.shouldUnregister?g(v,t,[]):[])),_reset:me,_resetDefaultValues:()=>J(n.defaultValues)&&n.defaultValues().then((e=>{fe(e,n.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:w,_proxyFormState:k,get _fields(){return l},get _formValues(){return E},get _state(){return x},set _state(e){x=e},get _defaultValues(){return v},get _names(){return S},set _names(e){S=e},get _formState(){return i},set _formState(e){i=e},get _options(){return n},set _options(e){n={...n,...e}}},trigger:ie,register:ue,handleSubmit:pe,watch:(e,t)=>J(e)?w.values.subscribe({next:a=>e(H(void 0,t),a)}):H(e,t,!0),setValue:ae,getValues:re,reset:fe,resetField:(e,t={})=>{g(l,e)&&(b(t.defaultValue)?ae(e,g(v,e)):(ae(e,t.defaultValue),B(v,e,t.defaultValue)),t.keepTouched||ye(i.touchedFields,e),t.keepDirty||(ye(i.dirtyFields,e),i.isDirty=t.defaultValue?U(e,g(v,e)):U()),t.keepError||(ye(i.errors,e),k.isValid&&F()),w.state.next({...i}))},clearErrors:e=>{e&&M(e).forEach((e=>ye(i.errors,e))),w.state.next({errors:e?i.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const a=g(l,e),n=a&&a._f;if(n){const e=n.refs?n.refs[0]:n.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:se}}t.Controller=e=>e.render(z(e)),t.Form=function(e){const t=w(),[a,n]=i.default.useState(!1),{control:r=t.control,onSubmit:s,children:o,action:l,method:c=q,headers:u,encType:d,onError:p,render:m,onSuccess:f,validateStatus:b,...y}=e,h=async t=>{let a=!1,n="";await r.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of r._names.mount)i.append(t,g(e,t));if(s&&s({data:e,event:t,method:c,formData:i,formDataJson:o}),l)try{const e=[u&&u["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:c,headers:{...u,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(b?!b(t.status):t.status<200||t.status>=300)?(a=!0,p&&p({response:t}),n=String(t.status)):f&&f({response:t})}catch(e){a=!0,p&&p({error:e})}}))(t),a&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:n}))};return i.default.useEffect((()=>{n(!0)}),[]),m?i.default.createElement(i.default.Fragment,null,m({submit:h})):i.default.createElement("form",{noValidate:a,action:l,method:c,encType:d,onSubmit:h,...y},o)},t.FormProvider=e=>{const{children:t,...a}=e;return i.default.createElement(k.Provider,{value:a},t)},t.appendErrors=$,t.get=g,t.set=B,t.useController=z,t.useFieldArray=function(e){const t=w(),{control:a=t.control,name:n,keyName:r="id",shouldUnregister:s}=e,[o,l]=i.default.useState(a._getFieldArray(n)),c=i.default.useRef(a._getFieldArray(n).map(U)),u=i.default.useRef(o),d=i.default.useRef(n),p=i.default.useRef(!1);d.current=n,u.current=o,a._names.array.add(n),e.rules&&a.register(n,e.rules),A({next:({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),c.current=t.map(U))}},subject:a._subjects.array});const f=i.default.useCallback((e=>{p.current=!0,a._updateFieldArray(n,e)}),[a,n]);return i.default.useEffect((()=>{if(a._state.action=!1,G(n,a._names)&&a._subjects.state.next({...a._formState}),p.current&&(!Q(a._options.mode).isOnSubmit||a._formState.isSubmitted))if(a._options.resolver)a._executeSchema([n]).then((e=>{const t=g(e.errors,n),i=g(a._formState.errors,n);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?B(a._formState.errors,n,t):ye(a._formState.errors,n),a._subjects.state.next({errors:a._formState.errors}))}));else{const e=g(a._fields,n);e&&e._f&&ce(e,a._formValues,a._options.criteriaMode===j,a._options.shouldUseNativeValidation,!0).then((e=>!I(e)&&a._subjects.state.next({errors:W(a._formState.errors,e,n)})))}a._subjects.values.next({name:n,values:{...a._formValues}}),a._names.focus&&V(a._fields,(e=>!!e&&e.startsWith(a._names.focus||""))),a._names.focus="",a._updateValid()}),[o,n,a]),i.default.useEffect((()=>(!g(a._formValues,n)&&a._updateFieldArray(n),()=>{(a._options.shouldUnregister||s)&&a.unregister(n)})),[n,a,r,s]),{swap:i.default.useCallback(((e,t)=>{const i=a._getFieldArray(n);ge(i,e,t),ge(c.current,e,t),f(i),l(i),a._updateFieldArray(n,i,ge,{argA:e,argB:t},!1)}),[f,n,a]),move:i.default.useCallback(((e,t)=>{const i=a._getFieldArray(n);me(i,e,t),me(c.current,e,t),f(i),l(i),a._updateFieldArray(n,i,me,{argA:e,argB:t},!1)}),[f,n,a]),prepend:i.default.useCallback(((e,t)=>{const i=M(m(e)),r=fe(a._getFieldArray(n),i);a._names.focus=H(n,0,t),c.current=fe(c.current,i.map(U)),f(r),l(r),a._updateFieldArray(n,r,fe,{argA:de(e)})}),[f,n,a]),append:i.default.useCallback(((e,t)=>{const i=M(m(e)),r=ue(a._getFieldArray(n),i);a._names.focus=H(n,r.length-1,t),c.current=ue(c.current,i.map(U)),f(r),l(r),a._updateFieldArray(n,r,ue,{argA:de(e)})}),[f,n,a]),remove:i.default.useCallback((e=>{const t=be(a._getFieldArray(n),e);c.current=be(c.current,e),f(t),l(t),a._updateFieldArray(n,t,be,{argA:e})}),[f,n,a]),insert:i.default.useCallback(((e,t,i)=>{const r=M(m(t)),s=pe(a._getFieldArray(n),e,r);a._names.focus=H(n,e,i),c.current=pe(c.current,e,r.map(U)),f(s),l(s),a._updateFieldArray(n,s,pe,{argA:e,argB:de(t)})}),[f,n,a]),update:i.default.useCallback(((e,t)=>{const i=m(t),r=he(a._getFieldArray(n),e,i);c.current=[...r].map(((t,a)=>t&&a!==e?c.current[a]:U())),f(r),l([...r]),a._updateFieldArray(n,r,he,{argA:e,argB:i},!0,!1)}),[f,n,a]),replace:i.default.useCallback((e=>{const t=M(m(e));c.current=t.map(U),f([...t]),l([...t]),a._updateFieldArray(n,[...t],(e=>e),{},!0,!1)}),[f,n,a]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[r]:c.current[t]||U()})))),[o,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[a,n]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:J(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:J(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...Fe(e,(()=>n((e=>({...e}))))),formState:a});const r=t.current.control;return r._options=e,A({subject:r._subjects.state,next:e=>{C(e,r._proxyFormState,r._updateFormState,!0)&&n({...r._formState})}}),i.default.useEffect((()=>{e.values&&!xe(e.values,r._defaultValues)?r._reset(e.values,r._options.resetOptions):r._resetDefaultValues()}),[e.values,r]),i.default.useEffect((()=>{r._state.mount||(r._updateValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()})),t.current.formState=T(a,r),t.current},t.useFormContext=w,t.useFormState=F,t.useWatch=N},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(48),c=a(128),u=a(119),d=a(138),p=a(14),m=a(181),f=a(116),b=a(122),g=a(113),y=a(228),h=a(197),v=a(112);const E=({asEmptyButton:e,children:t,dataProviders:a,filters:n,timeRange:E,keepDataView:x,iconType:j,...S})=>{const O=Object(l.useDispatch)(),k=Object(r.useMemo)((()=>c.e.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:T}=Object(v.a)((e=>k(e))),I=a&&a.find((e=>"template"===e.type)),C=Object(y.a)({timelineId:b.c.active,timelineType:I?g.l.template:g.l.default}),M=Object(r.useCallback)((()=>{(a||n)&&(E?C({timeRange:E}):C(),a&&O(Object(p.updateProviders)({id:b.c.active,providers:a})),n&&O(Object(p.setFilters)({id:b.c.active,filters:n})),x||O(m.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[T||""]})),O(d.b.removeLinkTo([u.a.timeline,u.a.global])))}),[a,C,O,w.id,T,n,E,x]);return e?s.a.createElement(o.EuiButtonEmpty,{"aria-label":h.i,onClick:M,flush:"right",size:"xs",iconType:j},t):s.a.createElement(o.EuiButton,i()({"aria-label":h.i,onClick:M},S),t)};E.displayName="InvestigateInTimelineButton"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(17),s=a(542),o=a(317);const l=Object(n.forwardRef)((({onChange:e,value:t,ariaLabel:a,editorId:l,dataTestSubj:c,height:u,autoFocusDisabled:d,setIsMarkdownInvalid:p},m)=>{const[f,b]=Object(n.useState)([]),g=Object(n.useCallback)(((e,{messages:t})=>{b(e?[e]:t),p(!!e)}),[p]),y=Object(n.useRef)(null);Object(n.useEffect)((()=>{var e,t;d||null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const h=Object(o.b)("investigation_guide"),v=Object(n.useMemo)((()=>Object(s.d)({insightsUpsellingMessage:h})),[h]);return Object(n.useImperativeHandle)(m,(()=>{var e,t;if(!y.current)return null;const a=null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...y.current,toolbar:null==a?void 0:a.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:y,"aria-label":a,editorId:l,onChange:e,value:t,uiPlugins:v,parsingPluginList:s.a,processingPluginList:s.c,onParse:g,errors:f,"data-test-subj":c,height:u})}));l.displayName="MarkdownEditorComponent";const c=Object(n.memo)(l)},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(17),i=a(61),r=a.n(i),s=a(2),o=a.n(s),l=a(44),c=a.n(l),u=a(49),d=a(4),p=a(382),m=a(121),f=a(116);const b=c()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);b.displayName="MyEuiModal";const g=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},y=(e=[])=>1===e.length&&e[0]===d.Vb?o.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.Vb)).join(", "):p.k,h=({adHocDataViews:e,additionalRequests:t,additionalResponses:a,closeModal:i,inputId:l,request:c,response:d,title:h})=>{var v,E,x,j;const{pathname:S}=Object(u.useLocation)(),{selectedPatterns:O}=Object(m.d)("timeline"===l?f.SourcererScopeName.timeline:Object(m.a)(S)),k=[c,...null!=t?t:[]],w=[d,...null!=a?a:[]],T=g(k),I=g(w),C=Object(s.useMemo)((()=>{var e,t;return(null!==(e=null===(t=T[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>O.includes(e.trim())))}),[T,O]),M=[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,y(null!=e&&e.length>0?e:null!==(v=null===(E=T[0])||void 0===E?void 0:E.index)&&void 0!==v?v:[])),!C&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(x=I[0])||void 0===x?void 0:x.took)?"0ms":null!==(j=I[0])&&void 0!==j&&j.took?`${r()(I[0].took).format("0,0")}ms`:p.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],_=[{id:"statistics",name:"Statistics",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiSpacer,null),o.a.createElement(n.EuiDescriptionList,{listItems:M,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request",content:T.length>0?T.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(n.EuiSpacer,null),o.a.createElement(n.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):o.a.createElement(n.EuiCodeBlock,null,p.k)},{id:"response",name:"Response",content:I.length>0?w.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(n.EuiSpacer,null),o.a.createElement(n.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):o.a.createElement(n.EuiCodeBlock,null,p.k)}];return o.a.createElement(b,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,p.d," ",h)),o.a.createElement(n.EuiModalBody,null,o.a.createElement(n.EuiTabbedContent,{tabs:_,initialSelectedTab:_[0],autoFocus:"selected"})),o.a.createElement(n.EuiModalFooter,null,o.a.createElement(n.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"k",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"f",(function(){return f}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=n.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),s=n.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=n.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=n.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),c=n.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),u=n.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=n.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=n.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=n.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=n.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u}));var n=a(62),i=a(45),r=a(283);const s=e=>e.toLocaleString(),o=({chartHeight:e,from:t,legendPosition:a,to:i,onBrushEnd:o,yTickFormatter:l,showLegend:c})=>({series:{xScaleType:n.ScaleType.Time,yScaleType:n.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([t,i]),yTickFormatter:null!=l?l:s,tickSize:8},settings:{legendPosition:null!=a?a:n.Position.Right,onBrushEnd:o,showLegend:null==c||c,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],c=([e,t])=>({key:e,value:t}),u=(e,t)=>{if(!e)return[];const a=Object(i.groupBy)("g",e),n=Object(i.toPairs)(a);return Object(i.map)(c,n).map(((e,a)=>{var n;const r=Object(i.get)(e.key,t);return{...e,color:null!==(n=null==r?void 0:r.color)&&void 0!==n?n:l[a]}}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"k",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"l",(function(){return f})),a.d(t,"m",(function(){return b})),a.d(t,"n",(function(){return g})),a.d(t,"o",(function(){return y})),a.d(t,"p",(function(){return h})),a.d(t,"f",(function(){return v}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.dataQualityDashboard.addToCaseSuccessToast",{defaultMessage:"Successfully added data quality results to the case"}),r=(n.i18n.translate("xpack.securitySolution.dataQualityDashboard.betaBadge",{defaultMessage:"Beta"}),n.i18n.translate("xpack.securitySolution.overview.ilmPhaseCold",{defaultMessage:"cold"})),s=n.i18n.translate("xpack.securitySolution.dataQualityDashboard.pageTitle",{defaultMessage:"Data Quality"}),o=n.i18n.translate("xpack.securitySolution.dataQualityDashboard.datePicker.tooltip",{defaultMessage:"Data quality checks are ran on data that was ingested during the Search Boost window. The default window range is 7 days."}),l=n.i18n.translate("xpack.securitySolution.dataQualityDashboard.elasticCommonSchemaReferenceLink",{defaultMessage:"Elastic Common Schema (ECS)"}),c=(n.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"}),n.i18n.translate("xpack.securitySolution.overview.ilmPhaseFrozen",{defaultMessage:"frozen"})),u=n.i18n.translate("xpack.securitySolution.overview.ilmPhaseHot",{defaultMessage:"hot"}),d=n.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),p=n.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),m=n.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),f=e=>n.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),b=n.i18n.translate("xpack.securitySolution.overview.ilmPhaseUnmanaged",{defaultMessage:"unmanaged"}),g=n.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),y=n.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),h=n.i18n.translate("xpack.securitySolution.overview.ilmPhaseWarm",{defaultMessage:"warm"}),v=n.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"});n.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return b})),a.d(t,"e",(function(){return y})),a.d(t,"f",(function(){return v})),a.d(t,"g",(function(){return j})),a.d(t,"h",(function(){return O})),a.d(t,"i",(function(){return w})),a.d(t,"j",(function(){return I})),a.d(t,"k",(function(){return M})),a.d(t,"l",(function(){return A}));var n=a(280),i=a(169);const r=e=>Object(n.flow)(s)(e),s=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.d)({...e,entries:e.entries.map((e=>Object(i.d)(e)))}):Object(i.d)(e)));return{...e,entries:t}},o=e=>{const{entries:t}=e,a=t.map((e=>"nested"===e.type?Object(i.j)({...e,entries:e.entries.map((e=>Object(i.j)(e)))}):Object(i.j)(e)));return{...e,entries:a}},l=e=>{const{comments:t}=e;if(!t||!t.length)return e;const a=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:a}};var c=a(2),u=a(165),d=a(350);const p=e=>Object(c.useMemo)((()=>({async addExceptionListItem({listItem:t}){const a=new AbortController,i=(r=t,Object(n.flow)(o)(r));var r;return u.b({http:e,listItem:i,signal:a.signal})},async deleteExceptionItem({id:t,namespaceType:a,onSuccess:n,onError:i}){const r=new AbortController;try{await u.e({http:e,id:t,namespaceType:a,signal:r.signal}),n()}catch(e){i(e)}},async deleteExceptionList({id:t,namespaceType:a,onSuccess:n,onError:i}){const r=new AbortController;try{await u.d({http:e,id:t,namespaceType:a,signal:r.signal}),n()}catch(e){i(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:a,namespaceType:n,onError:i,onSuccess:r}){const s=new AbortController;try{r(await u.g({http:e,includeExpiredExceptions:t,listId:a,namespaceType:n,signal:s.signal}))}catch(e){i(e)}},async exportExceptionList({id:t,includeExpiredExceptions:a,listId:n,namespaceType:i,onError:r,onSuccess:s}){const o=new AbortController;try{s(await u.h({http:e,id:t,includeExpiredExceptions:a,listId:n,namespaceType:i,signal:o.signal}))}catch(e){r(e)}},async getExceptionItem({id:t,namespaceType:a,onSuccess:n,onError:i}){const s=new AbortController;try{n(r(await u.k({http:e,id:t,namespaceType:a,signal:s.signal})))}catch(e){i(e)}},async getExceptionList({id:t,namespaceType:a,onSuccess:n,onError:i}){const r=new AbortController;try{n(await u.j({http:e,id:t,namespaceType:a,signal:r.signal}))}catch(e){i(e)}},async getExceptionListsItems({lists:t,filter:a,pagination:n,showDetectionsListsOnly:i,showEndpointListsOnly:s,onSuccess:o,onError:l}){const c=new AbortController,{ids:p,namespaces:m}=Object(d.i)({lists:t,showDetection:i,showEndpoint:s});try{if(p.length>0&&m.length>0){const{data:t,page:i,per_page:s,total:l}=await u.m({filter:a,http:e,listIds:p,namespaceTypes:m,pagination:n,signal:c.signal});o({exceptions:t.map((e=>r(e))),pagination:{page:i,perPage:s,total:l}})}else o({exceptions:[],pagination:{page:0,perPage:null!=n.perPage?n.perPage:0,total:0}})}catch(e){l(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:a,alias:n,excludeExceptions:i,onSuccess:r,onError:s}){const o=new AbortController;try{const{filter:s}=await u.p({http:e,exceptionListIds:t,signal:o.signal,chunkSize:a,alias:n,excludeExceptions:i});r(s)}catch(e){s(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:a,alias:n,excludeExceptions:i,onSuccess:r,onError:s}){const o=new AbortController;try{const{filter:s}=await u.q({http:e,exceptions:t,signal:o.signal,chunkSize:a,alias:n,excludeExceptions:i});r(s)}catch(e){s(e)}},async updateExceptionListItem({listItem:t}){const a=new AbortController,i=(r=t,Object(n.flow)(l,o)(r));var r;return u.v({http:e,listItem:i,signal:a.signal})}})),[e]);var m=a(152);const f=Object(m.d)(u.c),b=()=>Object(m.a)(f),g=e=>JSON.stringify(e),y=({pageIndex:e,pageSize:t})=>{const[a,n]=Object(c.useState)({}),i=Object(c.useCallback)((i=>{n({...a,[g({pageIndex:e+1,pageSize:t})]:i})}),[e,t]);let r;for(let n=e;n>=0&&(r=a[g({pageIndex:n,pageSize:t})],!r);n--);return[r,i]},h=Object(m.d)(u.f),v=()=>Object(m.a)(h),E={page:1,perPage:20,total:0},x={field:"created_at",order:"desc"},j=({errorMessage:e,http:t,initialPagination:a=E,filterOptions:n={},namespaceTypes:i,notifications:r,hideLists:s=[],initialSort:o=x})=>{const[l,p]=Object(c.useState)([]),[m,f]=Object(c.useState)(a),[b,g]=Object(c.useState)(o),[y,h]=Object(c.useState)(!0),v=Object(c.useRef)(),j=Object(c.useMemo)((()=>i.join(",")),[i]),S=Object(c.useMemo)((()=>Object(d.h)({filters:n,namespaceTypes:i,hideLists:s})),[i,n,s]),O=Object(c.useCallback)((async()=>{try{h(!0),v.current=new AbortController;const{page:e,per_page:a,total:n,data:i}=await Object(u.l)({filters:S,http:t,namespaceTypes:j,pagination:{page:m.page,perPage:m.perPage},sort:b,signal:v.current.signal});f({page:e,perPage:a,total:n}),p(i),h(!1)}catch(t){"AbortError"!==t.name&&(r.toasts.addError(t,{title:e}),p([]),f(E),h(!1))}}),[e,S,t,j,r.toasts,m.page,m.perPage,b]);return Object(c.useEffect)((()=>(O(),()=>{var e;null===(e=v.current)||void 0===e||e.abort()})),[O]),[y,l,m,f,O,b,g]},S=(Object(m.d)(u.i),Object(m.d)(u.n)),O=()=>Object(m.a)(S),k=Object(m.d)(u.o),w=()=>Object(m.a)(k),T=Object(m.d)(u.r),I=()=>Object(m.a)(T),C=Object(m.d)(u.s),M=()=>Object(m.a)(C),_=Object(m.d)(u.t),A=()=>Object(m.a)(_)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a(45),a(51);const n=({allowSet:e,field:t})=>e.has(t),i=({allowSet:e,field:t})=>!e.has(t),r=({allowReplacementSet:e,field:t})=>e.has(t),s=({allowSet:e,allowReplacementSet:t,currentReplacements:a,field:i,getAnonymizedValue:s,rawData:o})=>{var l;return(null!==(l=o[i])&&void 0!==l?l:[]).reduce(((o,l)=>{const c=`${l}`;if(n({allowSet:e,field:i})&&r({allowReplacementSet:t,field:i})){const e=`${s({currentReplacements:a,rawValue:c})}`;return{anonymizedValues:[...o.anonymizedValues,e],replacements:{...o.replacements,[e]:c}}}return n({allowSet:e,field:i})?{anonymizedValues:[...o.anonymizedValues,c],replacements:{...o.replacements}}:o}),{anonymizedValues:[],replacements:{}})},o=({allow:e,allowReplacement:t,currentReplacements:a,getAnonymizedValue:i,onNewReplacements:r,rawData:o})=>{if("string"==typeof o)return o;const l=(({allow:e,allowReplacement:t,currentReplacements:a,getAnonymizedValue:i,getAnonymizedValues:r,rawData:s})=>Object.keys(s).reduce(((o,l)=>{const c=new Set(t),u=new Set(e);if(n({allowSet:u,field:l})){const{anonymizedValues:e,replacements:t}=r({allowReplacementSet:c,allowSet:u,currentReplacements:a,field:l,getAnonymizedValue:i,rawData:s});return{anonymizedData:{...o.anonymizedData,[l]:e},replacements:{...o.replacements,...t}}}return o}),{anonymizedData:{},replacements:{}}))({allow:e,allowReplacement:t,currentReplacements:a,rawData:o,getAnonymizedValue:i,getAnonymizedValues:s});return null!=r&&r(l.replacements),c=l.anonymizedData,Object.keys(c).sort().map((e=>`${e},${c[e].join(",")}`)).join("\n");var c}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(46),i=a(139),r=a(120);n.exact(n.type({id:r.q})),n.exact(n.type({items:n.array(i.i)})),n.exact(n.type({name:n.string,description:n.string}));var s=a(278);n.intersection([n.exact(n.type({namespace_types:i.a})),n.exact(n.partial({ids:r.k,list_ids:r.k}))]);const o=n.exact(n.type({name:s.t,id:s.v,rule_id:s.y,exception_lists:i.y})),l=n.intersection([i.o,n.exact(n.type({referenced_rules:n.array(o)}))]),c=n.record(i.B,l);n.exact(n.type({references:n.array(c)}));var u=a(4);const d=`${u.Db}/rules`,p=(u.jb,`${d}/exceptions/_find_references`)},function(e,t,a){"use strict";a.d(t,"b",(function(){return x})),a.d(t,"a",(function(){return j.a}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(45),l=a(17),c=a(461),u=a.n(c),d=a(47),p=a(542);const m=({disableLinks:e,href:t,target:a,children:n,...i})=>s.a.createElement(l.EuiToolTip,{content:t},s.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},n)),f=Object(r.memo)(m);var b=a(110),g=a(18),y=a(5);const h=y.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),v=y.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),E=({children:e,disableLinks:t,textSize:a="m"})=>{const n=Object(r.useMemo)((()=>e=>s.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),c=Object(o.cloneDeep)(p.c);c[1][1].components.a=n;const m=Object(g.b)().isAtLeast("platinum"),{application:y}=Object(b.i)().services,E=Object(r.useMemo)((()=>{if(!1===m){const t=String(e);return p.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,m]),x=Object(r.useMemo)((()=>u()().use(p.a).use(c)),[c]),j=Object(r.useMemo)((()=>{try{return x.processSync(e),null}catch(e){return String(e.message)}}),[e,x]);return s.a.createElement(s.a.Fragment,null,E&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:h,color:"primary",iconType:"lock"},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:s.a.createElement(l.EuiLink,{href:y.getUrlForApp("management",{path:"stack/license_management/home"})},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),s.a.createElement(l.EuiSpacer,{size:"s"})),null!==j&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:v,color:"danger",iconType:"error"},j),s.a.createElement(l.EuiSpacer,{size:"s"})),s.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:p.a,processingPluginList:c,textSize:a},e))};E.displayName="MarkdownRendererComponent";const x=Object(r.memo)(E);var j=a(380);a(463)},function(e,t,a){e.exports=a(24)(652)},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(9),i=a(116),r=a(295);const s=(e,t,a)=>{switch(e){case i.SourcererScopeName.default:return Object(r.b)(t.filter((e=>e!==a)));case i.SourcererScopeName.detections:return null!=a?[a]:[];case i.SourcererScopeName.timeline:return Object(r.b)(t)}},o=(e,t,a,n)=>{const i=null!=e&&null!==e.id?e.patternList:[];return n?s(t,i,a):Object(r.b)(i)},l=(e,t,a)=>{var l;const{id:c,...u}=t,d=e.kibanaDataViews.find((e=>e.id===u.selectedDataViewId)),p=Object(r.a)(u.selectedPatterns);let m=[];if(null==d||d.id===e.defaultDataView.id){const t=Object(r.a)((null!=d?d:e.defaultDataView).title.split(","));m=p.filter((e=>!t.includes(e)))}let f=a&&null!=d&&0===m.length&&d.id!==e.defaultDataView.id&&d.patternList.length>0?p.filter((t=>null!=d&&d.patternList.includes(t)||null==e.signalIndexName||e.signalIndexName===t)):p;const b=e.signalIndexName;return f=s(c,f,b),{[c]:{...e.sourcererScopes[c],...u,selectedDataViewId:null!==(l=null==d?void 0:d.id)&&void 0!==l?l:null,selectedPatterns:f,missingPatterns:m,...Object(n.isEmpty)(f)&&c!==i.SourcererScopeName.timeline?{selectedPatterns:o(null!=d?d:e.defaultDataView,c,e.signalIndexName,(null!=d?d:e.defaultDataView).id===e.defaultDataView.id)}:{},loading:!1}}},c=({patternList:e,scopeId:t,signalIndexName:a,isDefaultDataViewSelected:n})=>t===i.SourcererScopeName.detections?e.includes(`${a}`):t===i.SourcererScopeName.default&&n?e.filter((e=>e!==a)).length>0:e.length>0},function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return y}));var n=a(45),i=a(234),r=a.n(i),s=a(2),o=a(48),l=a(446),c=a(119),u=a(480),d=a(138),p=a(585),m=a(113),f=a(193);const b="FETCH_ALL_TIMELINES",g=r()(((e,t)=>t.map((e=>{var t;return{created:e.created,description:e.description,eventIdToNoteIds:null!=e.eventIdToNoteIds?e.eventIdToNoteIds.reduce(((e,t)=>{if(null!=t.eventId){const a=Object(n.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...a,t.noteId]}}return e}),{}):null,excludedRowRendererIds:e.excludedRowRendererIds,favorite:e.favorite,noteIds:e.noteIds,notes:null!=e.notes?e.notes.map((e=>({...e,savedObjectId:e.noteId}))):null,pinnedEventIds:null!=e.pinnedEventIds?e.pinnedEventIds.reduce(((e,t)=>({...e,[t]:!0})),{}):null,savedObjectId:e.savedObjectId,savedSearchId:e.savedSearchId,status:e.status,title:e.title,updated:e.updated,updatedBy:e.updatedBy,timelineType:null!==(t=e.timelineType)&&void 0!==t?t:m.l.default,templateTimelineId:e.templateTimelineId,queryType:Object(l.b)(e)}})))),y=()=>{const e=Object(o.useDispatch)(),[,t]=Object(u.f)(),[a,n]=Object(s.useState)({loading:!1,totalCount:0,timelines:null,customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}),i=Object(s.useCallback)((async({onlyUserFavorite:a,pageInfo:i,search:r,sort:s,status:o,timelineType:l})=>{let m=!1;const y=new AbortController,h=async()=>{try{var v,E,x,j,S,O,k;n((e=>({...e,loading:!0})));const t={onlyUserFavorite:a,pageInfo:i,search:r,sort:s,status:o,timelineType:l},u=await Object(f.d)(t,y.signal),p=null!==(v=null==u?void 0:u.totalCount)&&void 0!==v?v:0,w=null!==(E=null==u?void 0:u.timeline)&&void 0!==E?E:[],T=null!==(x=null==u?void 0:u.customTemplateTimelineCount)&&void 0!==x?x:0,I=null!==(j=null==u?void 0:u.defaultTimelineCount)&&void 0!==j?j:0,C=null!==(S=null==u?void 0:u.elasticTemplateTimelineCount)&&void 0!==S?S:0,M=null!==(O=null==u?void 0:u.templateTimelineCount)&&void 0!==O?O:0,_=null!==(k=null==u?void 0:u.favoriteCount)&&void 0!==k?k:0;m||(e(d.b.setQuery({inputId:c.a.global,id:b,loading:!1,refetch:h,inspect:null})),n({loading:!1,totalCount:p,timelines:g(JSON.stringify(t),w),customTemplateTimelineCount:T,defaultTimelineCount:I,elasticTemplateTimelineCount:C,templateTimelineCount:M,favoriteCount:_}))}catch(e){m||(Object(u.e)({title:p.c,error:e.body&&e.body.message?new Error(e.body.message):e,dispatchToaster:t}),n({loading:!1,totalCount:0,timelines:[],customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}))}};return h(),()=>{m=!0,y.abort()}}),[e,t]);return Object(s.useEffect)((()=>()=>{e(d.b.deleteOneQuery({inputId:c.a.global,id:b}))}),[e]),{...a,fetchAllTimeline:i}}},,function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n,i=a(2),r=a(67),s=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},n(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),o="html",l="svg",c=function(e,t){var a,n,i,r={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var s=0,c=Object.entries(t.attributes);s<c.length;s++){var u=c[s],d=u[0],p=u[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==n){if(m.unmount(),t!==a&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),a=t,n=i}},unmount:function(e){e&&e!==n||a&&n&&(a.replaceChild(n,m.element),a=void 0,n=void 0)}};return m},u=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return r.createPortal(i.Children.map(a,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),n.element)},t}(i.PureComponent),d=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=i.createRef(),a.passPropsThroughPortal(),a}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=c.bind(null,o);c.bind(null,l)},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),i=a(48),r=a(112),s=a(110),o=a(128),l=a(181),c=a(119);const u=({inputId:e,queryId:t,skip:a})=>{const u=Object(i.useDispatch)(),{data:d}=Object(s.i)().services,p=Object(n.useRef)(d.search.session),m=o.d.globalQueryByIdSelector(),f=o.d.timelineQueryByIdSelector(),{selectedInspectIndex:b}=Object(r.a)((a=>e===c.a.global?m(a,t):f(a,t))),g=Object(n.useCallback)((()=>{const e=p.current.start();u(l.c.setInspectionParameter({id:t,selectedInspectIndex:b,isInspected:!1,inputId:c.a.global,searchSessionId:a?void 0:e}))}),[u,t,b,a]),y=Object(n.useCallback)((()=>{u(l.c.deleteOneQuery({inputId:c.a.global,id:t}))}),[u,t]);return{session:p,refetchByRestartingSession:g,refetchByDeletingSession:y}}},function(e,t,a){"use strict";a.d(t,"i",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"j",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"o",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"m",(function(){return f})),a.d(t,"l",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return y})),a.d(t,"g",(function(){return h}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),s=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),o=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),p=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),m=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),b=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),g=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),y=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),h=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return p}));var n=a(2),i=a(49),r=a(5),s=a(117),o=a(121),l=a(241),c=a(728);const u=({setQuery:e,response:t,request:a,refetch:i,uniqueQueryId:r,deleteQuery:s,loading:o,searchSessionId:l})=>{Object(n.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[a],response:[t]},loading:o,refetch:i,searchSessionId:l}),()=>{s&&s({id:r})})),[e,o,t,a,i,r,s,l])};function d(e){var t;const a=null==e?void 0:e.subType;return!(null==a||null===(t=a.nested)||void 0===t||!t.path)}const p=e=>{const{pathname:t}=Object(i.useLocation)(),{addError:a}=Object(s.a)(),{browserFields:u}=Object(o.d)(Object(o.a)(t));return Object(n.useCallback)((()=>{try{return function(e,t){const a=[];for(const[n,i]of Object.entries(e))t?i.aggregatable&&Object(c.a)(i.type)&&!d(i)&&a.push({label:n,value:n}):!0===i.aggregatable&&a.push({label:n,value:n});return a}(Object(l.a)(u),e)}catch(e){return a(e,{title:r.i18n.translate("xpack.securitySolution.useStackByFields.error.title",{defaultMessage:"Error fetching fields"}),toastMessage:r.i18n.translate("xpack.securitySolution.useStackByFields.error.toastMessage",{defaultMessage:"This error indicates an exceedingly large number of fields in an index"})}),[]}}),[a,u,e])}},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"i",(function(){return f}));var n=a(142),i=a(124),r=a(357);const s=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[n.ob]:e}},{term:{[n.ob]:"in-progress"}}]}}:{term:{[n.ob]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:n.ob,params:{query:e}},query:t}]},o=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[n.ob]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:n.N,params:{query:e}},query:{match_phrase:{[n.N]:e}}}]:[],c=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:n.b,value:"exists"},query:{exists:{field:n.b}}}],u=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>e.length?[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>e?{term:{[n.mb]:e}}:{bool:{must_not:{exists:{field:n.mb}}}}))}}}]:[],p=e=>({...i.q,columns:Object(r.c)(e),showCheckboxes:!0}),m=e=>({...p(e),columns:Object(r.d)(e),defaultColumns:Object(r.d)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}],showCheckboxes:!1}),f=["@timestamp","kibana.alert.workflow_status","kibana.alert.workflow_tags","kibana.alert.workflow_assignee_ids","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"n",(function(){return f})),a.d(t,"p",(function(){return b})),a.d(t,"q",(function(){return g})),a.d(t,"r",(function(){return y})),a.d(t,"u",(function(){return h})),a.d(t,"t",(function(){return v})),a.d(t,"v",(function(){return E})),a.d(t,"x",(function(){return x})),a.d(t,"a",(function(){return j})),a.d(t,"b",(function(){return S})),a.d(t,"w",(function(){return O})),a.d(t,"s",(function(){return k})),a.d(t,"m",(function(){return w})),a.d(t,"l",(function(){return T}));var n=a(5);n.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=n.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=n.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),s=(n.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),n.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=n.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=n.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),c=n.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),u=(n.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),n.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=n.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=n.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=n.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=n.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),b=n.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),g=n.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(n.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),n.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),h=(n.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),n.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),v=n.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>n.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=n.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),j=(n.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),n.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),S=n.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),O=n.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),k=n.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>n.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),T=n.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(317);const i=()=>Object(n.a)("endpointPolicyProtections")},function(e,t,a){"use strict";a.d(t,"e",(function(){return o.b})),a.d(t,"d",(function(){return o.a})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(46);const i=n.record(n.string,n.string);let r,s;n.exact(n.partial({host:i,user:i})),function(e){e.global="global_identifier",e.riskCategory="risk_category"}(r||(r={})),function(e){e.category_1="category_1"}(s||(s={})),n.keyof({user:null,host:null}),n.type({start:n.string,end:n.string});var o=a(583);const l="risk-score",c=(e="default")=>`${l}.risk-score-latest-${e}`,u=(e="default")=>`${l}.risk-score-${e}`,d=1,p=["manage_index_templates","manage_transform"],m=Object.freeze({"risk-score.risk-score-*":["read","write"]})},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return x}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(215),c=a(390),u=a(5);const d=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),p=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),m=o()(n.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),b=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),g=({children:e,lineClampHeight:t=5.5})=>{const[a,n]=Object(i.useState)(null),[s,o]=(e=>{const[t,a]=Object(i.useState)(null),n=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,r,s,o,l,c,u;null!=(null===(e=n.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==n||null===(i=n.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==n||null===(s=n.current)||void 0===s?void 0:s.clientHeight)&&void 0!==r?r:0)&&a(!0),(null!==(o=null===(l=n.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(c=null==n||null===(u=n.current)||void 0===u?void 0:u.clientHeight)&&void 0!==c?c:0)&&a(!1))}),[n,e]),[t,n]})(e),l=Object(i.useCallback)((()=>{n((e=>!e))}),[]);return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},r.a.createElement("p",null,e)),s&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},p)):r.a.createElement(r.a.Fragment,null,null==s||!0===s?r.a.createElement(b,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,s&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},y=r.a.memo(g),h=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),v=Object(i.createContext)({}),E=({basicData:e,ruleNote:t,showFullView:a=!1,showTitle:i=!0})=>r.a.createElement(v.Provider,{value:e},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},r.a.createElement("h5",null,l.q)),r.a.createElement(n.EuiSpacer,{size:"s"})),r.a.createElement(h,null,a?r.a.createElement(n.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},r.a.createElement(c.b,null,t)):r.a.createElement(n.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},r.a.createElement(y,{lineClampHeight:4.5},r.a.createElement(c.b,null,t))))),x=r.a.memo(E)},function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"d",(function(){return w})),a.d(t,"e",(function(){return T})),a.d(t,"c",(function(){return C})),a.d(t,"b",(function(){return M}));var n=a(17),i=a(194),r=a(2),s=a.n(r),o=a(23),l=a.n(o),c=a(48),u=a(112),d=a(128),p=a(181),m=a(138),f=a(119),b=a(116),g=a(122),y=a(113),h=a(197),v=a(228),E=a(14),x=a(460),j=a(665),S=a(130);const O=({asEmptyButton:e,children:t,dataProviders:a,filters:o,timeRange:O,keepDataView:k,...w})=>{var T,I;const C=Object(c.useDispatch)(),{showAssistantOverlay:M}=Object(i.j)(),[_]=Object(j.a)(),{discoverStateContainer:A}=Object(x.a)(),F=Object(S.a)("timelineEsqlTabDisabled"),P=Object(r.useMemo)((()=>d.e.getSourcererDataViewsSelector()),[]),{defaultDataView:D,signalIndexName:N}=Object(u.a)((e=>P(e))),R=a&&a.find((e=>"template"===e.type)),L=Object(v.a)({timelineId:g.c.active,timelineType:R?y.l.template:y.l.default}),B=Object(r.useCallback)((()=>{if(M({showOverlay:!1}),a||o){var e,t,n;if("esql"===(null==a||null===(e=a[0])||void 0===e?void 0:e.queryType)||"sql"===(null==a||null===(t=a[0])||void 0===t?void 0:t.queryType))return null===(n=A.current)||void 0===n||n.appState.update({query:{esql:a[0].kqlQuery}}),C(Object(E.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.esql})),void C(Object(E.showTimeline)({id:g.c.active,show:!0}));if(O?L({timeRange:O}):L(),a)switch(C(Object(E.updateDataView)({id:g.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),a[0].queryType){case"eql":C(Object(E.updateEqlOptions)({id:g.c.active,field:"query",value:a[0].kqlQuery})),C(Object(E.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.eql}));break;case"kql":C(Object(E.applyKqlFilterQuery)({id:g.c.active,filterQuery:{kuery:{kind:"kuery",expression:a[0].kqlQuery},serializedQuery:a[0].kqlQuery}})),C(Object(E.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:a[0].name,key:"query",value:a[0].kqlQuery},query:JSON.parse(a[0].kqlQuery)};C(Object(E.setFilters)({id:g.c.active,filters:[e]})),C(Object(E.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}))}o&&C(Object(E.setFilters)({id:g.c.active,filters:o})),k||C(p.d.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:D.id,selectedPatterns:[N||""]})),C(m.b.removeLinkTo([f.a.timeline,f.a.global]))}}),[M,a,o,O,k,C,L,A,D.id,N]),z=_?h.i:h.h,q=!_;return"esql"!==(null==a||null===(T=a[0])||void 0===T?void 0:T.queryType)&&"sql"!==(null==a||null===(I=a[0])||void 0===I?void 0:I.queryType)||!F?e?s.a.createElement(n.EuiButtonEmpty,{"aria-label":z,onClick:B,isDisabled:q,color:"text",flush:"both",size:"xs"},s.a.createElement(n.EuiToolTip,{position:"right",content:z},s.a.createElement(s.a.Fragment,null,t))):s.a.createElement(n.EuiButton,l()({"aria-label":z,isDisabled:q,onClick:B},w),s.a.createElement(n.EuiToolTip,{position:"right",content:z},s.a.createElement(s.a.Fragment,null,t))):null};O.displayName="SendToTimelineButton";const k="securityAssistant",w=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),T=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:a})=>({...e,[t]:null!=a?a:[]})),{}),I=["kql","dsl","eql","esql","sql"],C=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,a)=>e.replaceAll(a,t[a])),e):e,M=e=>e.messages.map((({content:t})=>Object(i.i)(C({messageContent:null!=t?t:"",replacements:e.replacements})))).map(((t,a)=>t.map(((t,i)=>{var r;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${a} .euiCodeBlock__controls`)[i],button:I.includes(t.type)?s.a.createElement(O,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(r=t.content)&&void 0!==r?r:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},s.a.createElement(n.EuiIcon,{type:"timeline"})):null}}))))},function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"c",(function(){return E}));var n=a(9),i=a(2),r=a.n(i),s=a(474),o=a(4),l=a(735),c=a(218),u=a(110),d=a(203),p=a(1292),m=a(602),f=a(1115),b=a(881),g=a(182);const y=Object(i.createContext)(null),h=({children:e})=>{var t,a,n,l,h,v,E,j,S;const[O]=Object(u.o)(o.S),{sessionStorage:k}=Object(u.i)().services,{filter:w,sorting:T,pagination:I}=function(){const e=Object(d.f)(c.a.rulesTable),{services:{sessionStorage:t}}=Object(u.i)(),a=e(),n=function(e){try{return e.get(m.c)}catch{return null}}(t);if(!a&&!n)return{};const[i,r,s]=function(e,t){var a,n,i,r,s,l,c,u;const d=Object(g.e)(e,b.b),p=Object(g.e)(t,b.b),m={searchTerm:null!==(a=null==d?void 0:d.searchTerm)&&void 0!==a?a:null==p?void 0:p.searchTerm,source:null!==(n=null==d?void 0:d.source)&&void 0!==n?n:null==p?void 0:p.source,tags:null!==(i=null==d?void 0:d.tags)&&void 0!==i?i:null==p?void 0:p.tags,enabled:null!==(r=null==d?void 0:d.enabled)&&void 0!==r?r:null==p?void 0:p.enabled,ruleExecutionStatus:null!==(s=null==d?void 0:d.ruleExecutionStatus)&&void 0!==s?s:null==p?void 0:p.ruleExecutionStatus},f=Object(g.e)(e,b.c),y=Object(g.e)(t,b.c),h={field:null!==(l=null==f?void 0:f.field)&&void 0!==l?l:null==y?void 0:y.field,order:null!==(c=null==f?void 0:f.order)&&void 0!==c?c:null==y?void 0:y.order},v=Object(g.e)(e,b.e),E=Object(g.e)(t,b.d),x={page:null==v?void 0:v.page,perPage:null!==(u=null==v?void 0:v.perPage)&&void 0!==u?u:null==E?void 0:E.perPage};return x.perPage&&(x.perPage<0||x.perPage>o.pc)&&delete x.perPage,[m,h,x]}(a,n);return{filter:i,sorting:r,pagination:s}}(),[C,M]=Object(i.useState)({filter:null!==(t=null==w?void 0:w.searchTerm)&&void 0!==t?t:f.a.filter,tags:null!==(a=null==w?void 0:w.tags)&&void 0!==a?a:f.a.tags,showCustomRules:null!==(n=(null==w?void 0:w.source)===b.a.Custom)&&void 0!==n?n:f.a.showCustomRules,showElasticRules:null!==(l=(null==w?void 0:w.source)===b.a.Prebuilt)&&void 0!==l?l:f.a.showElasticRules,enabled:null==w?void 0:w.enabled,ruleExecutionStatus:null!==(h=null==w?void 0:w.ruleExecutionStatus)&&void 0!==h?h:f.a.ruleExecutionStatus}),[_,A]=Object(i.useState)({field:null!==(v=null==T?void 0:T.field)&&void 0!==v?v:f.d.field,order:null!==(E=null==T?void 0:T.order)&&void 0!==E?E:f.d.order}),[F,P]=Object(i.useState)(!1),[D,N]=Object(i.useState)(O.on),[R,L]=Object(i.useState)({ids:[],action:null}),[B,z]=Object(i.useState)(!1),[q,$]=Object(i.useState)(null!==(j=null==I?void 0:I.page)&&void 0!==j?j:f.b),[V,U]=Object(i.useState)(null!==(S=null==I?void 0:I.perPage)&&void 0!==S?S:f.c),[H,Q]=Object(i.useState)([]),G=Object(i.useRef)(null),W=R.ids.length>0,Z=Object(i.useMemo)((()=>({page:q,perPage:V})),[q,V]),K=Object(i.useCallback)((e=>{M((t=>({...t,...e}))),$(1),Q([]),P(!1)}),[]),J=Object(i.useCallback)((()=>{Q([]),P(!1)}),[]),Y=Object(d.g)(),X=Object(i.useCallback)((()=>{M({filter:f.a.filter,showElasticRules:f.a.showElasticRules,showCustomRules:f.a.showCustomRules,tags:f.a.tags,enabled:void 0,ruleExecutionStatus:f.a.ruleExecutionStatus}),A({field:f.d.field,order:f.d.order}),$(f.b),U(f.c),Y({[c.a.rulesTable]:null}),k.remove(m.c)}),[M,A,$,U,Y,k]);Object(i.useEffect)((()=>{var e;H.length>0?(N(!1),null==G.current&&(G.current=D)):(N(null!==(e=G.current)&&void 0!==e?e:D),G.current=null)}),[H,D]);const{data:{rules:ee,total:te}={rules:[],total:0},refetch:ae,dataUpdatedAt:ne,isFetched:ie,isFetching:re,isLoading:se,isRefetching:oe}=Object(p.a)({filterOptions:C,sortingOptions:_,pagination:Z},{refetchOnWindowFocus:D&&!W,refetchOnReconnect:D&&!W,refetchInterval:D&&!W&&O.value,keepPreviousData:!0}),{data:le,isLoading:ce,isFetching:ue,isError:de,refetch:pe}=Object(s.a)(ee.map((e=>e.id)),{enabled:ee.length>0}),me=Object(i.useCallback)((async()=>{const e=await ae();return await pe(),e}),[ae,pe]),fe=Object(i.useMemo)((()=>({reFetchRules:me,setFilterOptions:K,setIsAllSelected:P,setIsRefreshOn:N,setLoadingRules:L,setPage:$,setPerPage:U,setSelectedRuleIds:Q,setSortingOptions:A,clearRulesSelection:J,setIsPreflightInProgress:z,clearFilters:X})),[me,K,P,N,L,$,U,Q,A,J,z,X]),be=Object(i.useMemo)((()=>({state:{rules:ee,rulesSnoozeSettings:{data:null!=le?le:{},isLoading:ce,isFetching:ue,isError:de},pagination:{page:q,perPage:V,total:te},filterOptions:C,isPreflightInProgress:B,isActionInProgress:W,isAllSelected:F,isFetched:ie,isFetching:re,isLoading:se,isRefetching:oe,isRefreshOn:D,lastUpdated:ne,loadingRuleIds:R.ids,loadingRulesAction:R.action,selectedRuleIds:H,sortingOptions:_,isDefault:x(C,_,{page:q,perPage:V,total:te})},actions:fe})),[ee,le,ce,ue,de,q,V,te,C,B,W,F,ie,re,se,oe,D,ne,R.ids,R.action,H,_,fe]);return r.a.createElement(y.Provider,{value:be},e)},v=()=>{const e=Object(i.useContext)(y);return Object(l.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},E=()=>Object(i.useContext)(y);function x(e,t,a){return Object(n.isEqual)(e,f.a)&&Object(n.isEqual)(t,f.d)&&a.page===f.b&&a.perPage===f.c}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(419));t.default=function(e,t){void 0===t&&(t=[]);var a=r.default(e,t,{loading:!0}),n=a[0],s=a[1];return i.useEffect((function(){s()}),[s]),n}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=10,i=0},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(4);const i=`${n.Db}/rules/_rule_management_filters`,r=`${n.Db}/rules/_coverage_overview`},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=function(){const e=this.Parser,t=e.prototype.blockTokenizers,a=e.prototype.blockMethods;t.osquery=function(e,t,a){if(!1===t.startsWith("!{osquery"))return!1;const n=t[9];if("{"!==n&&"}"!==n)return!1;if(a)return!0;let i="!{osquery",r={};if("{"===n){let a="",n=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)n++,a+=i;else if("}"===i){if(n--,-1===n)break;a+=i}else a+=i}i+=a;try{r=JSON.parse(a)}catch(t){const a=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:a.line,column:a.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},a.splice(a.indexOf("text"),0,"osquery")}},function(e,t){const a=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?a:e:n},,function(e,t,a){"use strict";var n=Object.assign;e.exports=n},function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(154),i=a(232),r=a(923);const s=e=>"boolean"==typeof e,o=(e,t)=>{var a;return null==e||!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&s(t))||t},l=e=>null==e||e,c=(e,t,a,s)=>null==e?void 0:Object(i.d)(e.type)&&!t?r.d:o(e,a)?l(s)?void 0:n.Rb:n.Qb},function(e,t,a){"use strict";a.d(t,"a",(function(){return J})),a.d(t,"b",(function(){return Y}));var n=a(2),i=a.n(n),r=a(17),s=a(47),o=a(201),l=a(192),c=a(48),u=a(51),d=a(216),p=a(1095),m=a(565),f=a(159),b=a(137),g=a(125),y=a(306),h=a(464),v=a(127),E=a(211),x=a(321),j=a(275);const S=({field:e,value:t,isObjectArray:a,children:r})=>{const{dataFormattedForFieldBrowser:s,scopeId:l,isPreview:c}=Object(o.b)(),{isAlert:u}=Object(E.b)(s),d=u?j.d.DETAILS_FLYOUT:j.d.DEFAULT,p=Object(n.useMemo)((()=>({field:e,value:t})),[e,t]),m=Object(n.useMemo)((()=>({scopeId:l,isObjectArray:a})),[l,a]),f=Object(n.useMemo)((()=>c?[x.d.FILTER,x.d.TOGGLE_COLUMN]:[]),[c]);return i.a.createElement(j.c,{data:p,mode:j.a.HOVER_RIGHT,triggerId:d,visibleCellActions:6,sourcererScopeId:Object(v.getSourcererScopeId)(l),metadata:m,disabledActionTypes:f},r)};S.displayName="CellActions";var O=a(119),k=a(147),w=a(121),T=a(433),I=a(158),C=a(874),M=a(206),_=a(693),A=a(417),F=a(279),P=a(5);const D=P.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedHostsDescription",{defaultMessage:"Failed to run search on related hosts"});var N=a(386),R=a(210),L=a(126),B=a(183),z=a(348),q=a(413);const $=Object(M.a)(p.a),V=Object(M.a)(f.c),U=({userName:e,timestamp:t,scopeId:a})=>{const{to:o,from:l,deleteQuery:p,setQuery:v,isInitializing:E}=Object(k.a)(),{selectedPatterns:x}=Object(w.d)(),j=Object(c.useDispatch)(),M=Object(n.useMemo)((()=>`entities-users-details-${Object(u.v4)()}`),[]),P=Object(n.useMemo)((()=>`entities-users-related-hosts-${Object(u.v4)()}`),[]),U=Object(q.a)("entity-analytics"),H=Object(R.a)().isPlatinumOrTrialLicense&&U,Q=Object(n.useCallback)(((e,t)=>{const a=Object(T.a)(e,t);j(Object(I.setAbsoluteRangeDatePicker)({id:O.a.global,from:a.from,to:a.to}))}),[j]),[G,{inspect:W,userDetails:Z,refetch:K}]=Object(_.b)({id:M,startDate:l,endDate:o,userName:e,indexNames:x,skip:0===x.length}),{loading:J,inspect:Y,relatedHosts:X,totalCount:ee,refetch:te}=(({userName:e,indexNames:t,from:a,skip:i=!1})=>{const{loading:r,result:s,search:o,refetch:l,inspect:c}=Object(F.a)({factoryQueryType:A.a.relatedHosts,initialResult:{totalCount:0,relatedHosts:[]},errorMessage:D,abort:i}),u=Object(N.b)(),d=Object(n.useMemo)((()=>({inspect:c,totalCount:s.totalCount,relatedHosts:s.relatedHosts,refetch:l,loading:r})),[c,l,s.totalCount,s.relatedHosts,r]),p=Object(n.useMemo)((()=>({defaultIndex:t,factoryQueryType:A.a.relatedHosts,userName:e,from:a,isNewRiskScoreModuleInstalled:u})),[t,a,e,u]);return Object(n.useEffect)((()=>{i||o(p)}),[p,o,i]),d})({userName:e,indexNames:x,from:t,skip:0===x.length}),ae=Object(n.useMemo)((()=>[{field:"host",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(S,{field:"host.name",value:e},e))},{field:"ip",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(h.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(b.h,{ip:e}):Object(L.d)()})},...H?[{field:"risk",name:Object(z.b)(g.v.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(y.a,{severity:e}):Object(L.d)()}]:[]]),[H]),ne=Object(n.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"storage"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsCountLabel",defaultMessage:"Related hosts: {count}",values:{count:ee}})))))),[ee]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsTitle",defaultMessage:"User"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{header:{title:e,iconType:"user",headerContent:ne},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.D},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsInfoTitle",defaultMessage:"User information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(m.a,{criteriaFields:Object(C.a)(Z),startDate:l,endDate:o,skip:E},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>i.a.createElement($,{id:M,isInDetailsSidePanel:!1,data:Z,anomaliesData:a,isLoadingAnomaliesData:t,loading:G,startDate:l,endDate:o,narrowDateRange:Q,setQuery:v,refetch:K,inspect:W,userName:e,indexPatterns:x,jobNameById:n}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTitle",defaultMessage:"Related hosts"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTooltip",defaultMessage:"After this alert was generated, {userName} logged into these hosts. Check if this activity is normal.",values:{userName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(V,{id:P,inspect:Y,loading:J,setQuery:v,deleteQuery:p,refetch:te},i.a.createElement(r.EuiInMemoryTable,{columns:ae,items:X,loading:J,"data-test-subj":B.C,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNoDataDescription",defaultMessage:"No hosts identified"})}),i.a.createElement(f.b,{queryId:P,title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsInspectButtonTitle",defaultMessage:"Related hosts"}),inspectIndex:0})))))};var H=a(1133),Q=a(896);const G=P.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedUsersDescription",{defaultMessage:"Failed to run search on related users"}),W=Object(M.a)(H.a),Z=Object(M.a)(f.c),K=({hostName:e,timestamp:t,scopeId:a})=>{const{to:o,from:l,deleteQuery:p,setQuery:v,isInitializing:E}=Object(k.a)(),{selectedPatterns:x}=Object(w.d)(),j=Object(c.useDispatch)(),M=Object(n.useMemo)((()=>`entities-hosts-details-${Object(u.v4)()}`),[]),_=Object(n.useMemo)((()=>`entities-hosts-related-users-${Object(u.v4)()}`),[]),P=Object(q.a)("entity-analytics"),D=Object(R.a)().isPlatinumOrTrialLicense&&P,$=Object(n.useCallback)(((e,t)=>{const a=Object(T.a)(e,t);j(Object(I.setAbsoluteRangeDatePicker)({id:O.a.global,from:a.from,to:a.to}))}),[j]),[V,{inspect:U,hostDetails:H,refetch:K}]=Object(Q.b)({id:M,startDate:l,endDate:o,hostName:e,indexNames:x,skip:0===x.length}),{loading:J,inspect:Y,relatedUsers:X,totalCount:ee,refetch:te}=(({hostName:e,indexNames:t,from:a,skip:i=!1})=>{const r=Object(N.b)(),{loading:s,result:o,search:l,refetch:c,inspect:u}=Object(F.a)({factoryQueryType:A.a.relatedUsers,initialResult:{totalCount:0,relatedUsers:[]},errorMessage:G,abort:i}),d=Object(n.useMemo)((()=>({inspect:u,totalCount:o.totalCount,relatedUsers:o.relatedUsers,refetch:c,loading:s})),[u,c,o.totalCount,o.relatedUsers,s]),p=Object(n.useMemo)((()=>({defaultIndex:t,factoryQueryType:A.a.relatedUsers,hostName:e,from:a,isNewRiskScoreModuleInstalled:r})),[t,a,e,r]);return Object(n.useEffect)((()=>{i||l(p)}),[p,l,i]),d})({hostName:e,indexNames:x,from:t,skip:0===x.length}),ae=Object(n.useMemo)((()=>[{field:"user",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(S,{field:"user.name",value:e},e))},{field:"ip",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(h.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(b.h,{ip:e}):Object(L.d)()})},...D?[{field:"risk",name:Object(z.b)(g.v.user),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(y.a,{severity:e}):Object(L.d)()}]:[]]),[D]),ne=Object(n.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"user"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersCountLabel",defaultMessage:"Related users: {count}",values:{count:ee}})))))),[ee]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsTitle",defaultMessage:"Host"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{header:{title:e,iconType:"storage",headerContent:ne},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.k},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsInfoTitle",defaultMessage:"Host information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(m.a,{criteriaFields:Object(C.a)(H),startDate:l,endDate:o,skip:E},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>i.a.createElement(W,{id:M,hostName:e,data:H,indexNames:x,jobNameById:n,anomaliesData:a,isLoadingAnomaliesData:t,isInDetailsSidePanel:!1,loading:V,startDate:l,endDate:o,narrowDateRange:$,setQuery:v,refetch:K,inspect:U,deleteQuery:p}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTitle",defaultMessage:"Related users"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTooltip",defaultMessage:"After this alert was generated, these users logged into {hostName}. Check if this activity is normal.",values:{hostName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Z,{id:_,inspect:Y,loading:J,setQuery:v,deleteQuery:p,refetch:te},i.a.createElement(r.EuiInMemoryTable,{columns:ae,items:X,loading:J,"data-test-subj":B.j,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNoDataDescription",defaultMessage:"No users identified"})}),i.a.createElement(f.b,{queryId:_,title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersInspectButtonTitle",defaultMessage:"Related users"}),inspectIndex:0})))))};K.displayName="HostDetails";const J="entities-details",Y=()=>{const{getFieldsData:e,scopeId:t}=Object(o.b)(),a=Object(l.a)(e("host.name")),n=Object(l.a)(e("user.name")),c=Object(l.a)(e("@timestamp")),u=c&&(a||n),d=n&&c,p=a&&c;return i.a.createElement(i.a.Fragment,null,u?i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":B.i},d&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(U,{userName:n,timestamp:c,scopeId:t})),p&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(K,{hostName:a,timestamp:c,scopeId:t}))):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."}))};Y.displayName="EntitiesDetails"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n.f}));var n=a(150)},function(e,t,a){"use strict";e.exports=a(618)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(207));t.default=function(e,t,a){void 0===t&&(t=[]),void 0===a&&(a={loading:!1});var s=i.useRef(0),o=r.default(),l=i.useState(a),c=l[0],u=l[1],d=i.useCallback((function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var i=++s.current;return u((function(e){return n.__assign(n.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return o()&&i===s.current&&u({value:e,loading:!1}),e}),(function(e){return o()&&i===s.current&&u({error:e,loading:!1}),e}))}),t);return[c,d]}},,function(e,t,a){"use strict";a.r(t),a.d(t,"registerUrlParam",(function(){return r})),a.d(t,"deregisterUrlParam",(function(){return s})),a.d(t,"updateUrlParam",(function(){return o}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/local/global_url_param"),r=i("REGISTER_URL_PARAM"),s=i("DEREGISTER_URL_PARAM"),o=i("UPDATE_URL_PARAM")},function(e,t,a){"use strict";a.r(t),a.d(t,"selectNotesById",(function(){return o})),a.d(t,"getNotes",(function(){return c})),a.d(t,"getNotesAsCommentsList",(function(){return u})),a.d(t,"selectNotesByIdSelector",(function(){return d})),a.d(t,"notesByIdsSelector",(function(){return p})),a.d(t,"selectNotesAsCommentsListSelector",(function(){return m})),a.d(t,"errorsSelector",(function(){return f}));var n=a(45),i=a(234),r=a.n(i),s=a(57);const o=e=>e.app.notesById,l=e=>e.app.errors,c=r()(((e,t)=>Object(n.keys)(e).reduce(((a,n)=>{if(t.includes(n)){const t=e[n];return[...a,t]}return a}),[]))),u=e=>Object(n.values)(e).map((e=>{var t;return{eventId:e.eventId,savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}})),d=Object(s.createSelector)(o,(e=>e)),p=()=>Object(s.createSelector)(o,(e=>e)),m=()=>Object(s.createSelector)(o,u),f=()=>Object(s.createSelector)(l,(e=>e))},function(e,t,a){"use strict";let n;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),function(e){e.name="name",e.domain="domain",e.lastSeen="lastSeen"}(n||(n={}));const i={bool:{must_not:[{term:{"event.kind":"asset"}}]}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return b}));var n=a(45),i=a(14),r=a(145);const s=e=>Object(n.omit)("and",e),o=e=>null!=e,l=e=>e.reduce(((e,t)=>[...e,[s(t),...t.and]]),[]),c=e=>Number(e.substring(e.lastIndexOf(".")+1)),u=({index:e,dataProviderGroups:t})=>e>=0&&e<t.length,d=e=>e.reduce(((e,t)=>[...e,{...t[0],and:t.slice(1)}]),[]),p=[[]],m=({dataProviders:e,destination:t,dispatch:a,source:n,timelineId:r})=>{if(!o(t))return;const s=[...l(e),...p];(({destination:e,source:t})=>t.droppableId===e.droppableId)({source:n,destination:t})?(({dataProviderGroups:e,destination:t,dispatch:a,source:n,timelineId:r})=>{const s=c(n.droppableId);if(u({index:s,dataProviderGroups:e})){const o=(({endIndex:e,group:t,startIndex:a})=>{const n=[...t],[i]=n.splice(a,1);return n.splice(e,0,i),n})({group:e[s],startIndex:n.index,endIndex:t.index}),l=e.reduce(((e,t,a)=>[...e,a===s?[...o]:[...t]]),[]);a(Object(i.updateProviders)({id:r,providers:d(l.filter((e=>e.length)))}))}})({dataProviderGroups:s,destination:t,dispatch:a,source:n,timelineId:r}):(({dataProviderGroups:e,destination:t,dispatch:a,source:n,timelineId:r})=>{const s=c(n.droppableId),o=c(t.droppableId);if(u({index:s,dataProviderGroups:e})&&u({index:o,dataProviderGroups:e})){const l=e[s],c=e[o],u=n.index,p=t.index,{updatedDestinationGroup:m,updatedSourcererScope:f}=(({destinationGroup:e,moveProviderFromSourceIndex:t,moveProviderToDestinationIndex:a,sourceGroup:n})=>{const i=[...n],r=[...e],[s]=i.splice(t,1);return r.splice(a,0,s),{updatedDestinationGroup:r.filter(((e,t)=>e.id!==s.id||t===a)),updatedSourcererScope:i}})({destinationGroup:c,moveProviderFromSourceIndex:u,moveProviderToDestinationIndex:p,sourceGroup:l}),b=e.reduce(((e,t,a)=>[...e,a===s?[...f]:a===o?[...m]:[...t]]),[]);a(Object(i.updateProviders)({id:r,providers:d(b.filter((e=>e.length)))}))}})({dataProviderGroups:s,destination:t,dispatch:a,source:n,timelineId:r})},f=({dataProviders:e,destination:t,dispatch:a,onAddedToTimeline:n,providerToAdd:r,timelineId:m})=>{0===e.length?(({dispatch:e,onAddedToTimeline:t,providerToAdd:a,timelineId:n})=>{e(Object(i.updateProviders)({id:n,providers:[a]})),t(a.name)})({dispatch:a,onAddedToTimeline:n,providerToAdd:r,timelineId:m}):(({dataProviders:e,destination:t,dispatch:a,onAddedToTimeline:n,providerToAdd:r,timelineId:m})=>{const f=[...l(e),...p];if(!o(t))return;const b=c(t.droppableId);if(u({index:b,dataProviderGroups:f})){const e=[...f[b]];e.splice(t.index,0,s(r));const o=e.filter(((e,a)=>e.id!==r.id||a===t.index)),l=f.reduce(((e,t,a)=>[...e,a===b?[...o]:[...t]]),[]);a(Object(i.updateProviders)({id:m,providers:d(l.filter((e=>e.length)))})),n(r.name)}})({dataProviders:e,destination:t,dispatch:a,onAddedToTimeline:n,providerToAdd:r,timelineId:m})},b=e=>Object(r.k)(e)?e.length?`( ${e.join(" OR ")} )`:"":e},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(45);function i(e){return Object(n.isString)(e)?r(e):`${e}`}function r(e){return`"${function(e=""){return s(e)}(e)}"`}const s=Object(n.flow)((e=>e.replace(/["]/g,"\\$&")),(e=>e.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")))},function(e,t,a){"use strict";a.r(t),a.d(t,"setUsersTablesActivePageToZero",(function(){return r})),a.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return s})),a.d(t,"updateTableLimit",(function(){return o})),a.d(t,"updateTableActivePage",(function(){return l})),a.d(t,"updateTableSorting",(function(){return c})),a.d(t,"updateUserRiskScoreSeverityFilter",(function(){return u})),a.d(t,"updateUsersAnomaliesJobIdFilter",(function(){return d})),a.d(t,"updateUsersAnomaliesInterval",(function(){return p})),a.d(t,"addUserAssetTableField",(function(){return m})),a.d(t,"removeUserAssetTableField",(function(){return f}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/local/users"),r=i("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("UPDATE_USERS_TABLE_LIMIT"),l=i("UPDATE_USERS_ACTIVE_PAGE"),c=i("UPDATE_USERS_SORTING"),u=i("UPDATE_USERS_RISK_SEVERITY_FILTER"),d=i("UPDATE_USERS_ANOMALIES_JOB_ID_FILTER"),p=i("UPDATE_USERS_ANOMALIES_INTERVAL"),m=i("ADD_USER_ASSET_TABLE_FIELD"),f=i("REMOVE_USER_ASSET_TABLE_FIELD")},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.incompatibleTab.dataQualityDashboardConversationId",{defaultMessage:"Data Quality dashboard"})},function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(395);const s=Object(r.c)(),o=Object(r.c)(),l=()=>{const[e]=Object(n.useState)(s);return{portalNode:e}},c=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(n.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=u();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(23),i=a.n(n),r=a(44),s=a.n(r),o=a(2),l=a.n(o),c=a(17);const u=s()((({loading:e,...t})=>l.a.createElement(c.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-h09jgf-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));u.displayName="Panel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s}));const n="kibana.alert.rule.name",i="host.name",r=300,s=500},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(47),s=a(17),o=a(205);const l=i.a.memo((()=>i.a.createElement(o.a,null,i.a.createElement(s.EuiPageTemplate,null,i.a.createElement(s.EuiPageTemplate.EmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:i.a.createElement("p",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(121),s=a(1312);const o=Object(n.memo)((()=>{const{GetStarted:e}=Object(s.a)(),{indicesExist:t}=Object(r.d)();return e?i.a.createElement(e,{indicesExist:t}):null}));o.displayName="LandingPageComponent"},function(e,t,a){"use strict";a.r(t),a.d(t,"listData",(function(){return p})),a.d(t,"pageIndex",(function(){return m})),a.d(t,"pageSize",(function(){return f})),a.d(t,"sortField",(function(){return b})),a.d(t,"sortDirection",(function(){return g})),a.d(t,"totalHits",(function(){return y})),a.d(t,"listLoading",(function(){return h})),a.d(t,"listError",(function(){return v})),a.d(t,"policyItems",(function(){return E})),a.d(t,"policyItemsLoading",(function(){return x})),a.d(t,"selectedPolicyId",(function(){return j})),a.d(t,"endpointPackageInfo",(function(){return S})),a.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return O})),a.d(t,"isAutoRefreshEnabled",(function(){return k})),a.d(t,"autoRefreshInterval",(function(){return w})),a.d(t,"endpointPackageVersion",(function(){return T})),a.d(t,"patterns",(function(){return I})),a.d(t,"patternsError",(function(){return C})),a.d(t,"isOnEndpointPage",(function(){return M})),a.d(t,"uiQueryParams",(function(){return _})),a.d(t,"hasSelectedEndpoint",(function(){return A})),a.d(t,"showView",(function(){return F})),a.d(t,"nonExistingPolicies",(function(){return P})),a.d(t,"agentPolicies",(function(){return D})),a.d(t,"endpointsExist",(function(){return N})),a.d(t,"searchBarQuery",(function(){return R})),a.d(t,"getCurrentIsolationRequestState",(function(){return L})),a.d(t,"getIsIsolationRequestPending",(function(){return B})),a.d(t,"getWasIsolationRequestSuccessful",(function(){return z})),a.d(t,"getIsolationRequestError",(function(){return q})),a.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return $})),a.d(t,"getEndpointPendingActionsState",(function(){return V})),a.d(t,"getMetadataTransformStats",(function(){return U})),a.d(t,"metadataTransformStats",(function(){return H})),a.d(t,"isMetadataTransformStatsLoading",(function(){return Q})),a.d(t,"getEndpointPendingActionsCallback",(function(){return G}));var n=a(734),i=a.n(n),r=a(57),s=a(49),o=a(60),l=a(238),c=a(178),u=a(894),d=a(1317);const p=e=>e.hosts,m=e=>e.pageIndex,f=e=>e.pageSize,b=e=>e.sortField,g=e=>e.sortDirection,y=e=>e.total,h=e=>e.loading,v=e=>e.error,E=e=>e.policyItems,x=e=>e.policyItemsLoading,j=e=>e.selectedPolicyId,S=e=>e.endpointPackageInfo,O=Object(r.createSelector)(S,(e=>Object(u.i)(e))),k=e=>e.isAutoRefreshEnabled,w=e=>e.autoRefreshInterval,T=Object(r.createSelector)(S,(e=>Object(u.g)(e)?e.data.version:void 0)),I=e=>e.patterns,C=e=>e.patternsError,M=e=>{var t,a;return null!==Object(s.matchPath)(null!==(t=null===(a=e.location)||void 0===a?void 0:a.pathname)&&void 0!==t?t:"",{path:c.h,exact:!0})},_=Object(r.createSelector)((e=>e.location),(e=>{const t={page_index:String(c.b),page_size:String(c.c)};if(e){const a=i.a.parse(e.search.slice(1)),n=Object(l.a)(a),r=["selected_endpoint","show","admin_query","sort_field","sort_direction"],s=["policy_response","details","isolate","unisolate","activity_log"];for(const e of r){const n="string"==typeof a[e]?a[e]:Array.isArray(a[e])?a[e][a[e].length-1]:void 0;void 0!==n&&("show"===e?s.includes(n)&&(t[e]=n):"sort_direction"===e?["asc","desc"].includes(n)&&(t[e]=n):t[e]=n)}t.page_size=String(n.page_size),t.page_index=String(n.page_index)}return t})),A=Object(r.createSelector)(_,(({selected_endpoint:e})=>void 0!==e)),F=Object(r.createSelector)(_,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),P=e=>e.nonExistingPolicies,D=e=>e.agentPolicies,N=e=>e.endpointsExist,R=Object(r.createSelector)(_,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const a=Object(o.decode)(e);a&&"string"==typeof a.query&&(t.query=a.query),!a||"string"!=typeof a.language||"kuery"!==a.language&&"lucene"!==a.language||(t.language=a.language)}return t})),L=e=>e.isolationRequestState,B=Object(r.createSelector)(L,(e=>Object(u.h)(e))),z=Object(r.createSelector)(L,(e=>Object(u.g)(e))),q=Object(r.createSelector)(L,(e=>{if(Object(u.f)(e))return e.error})),$=Object(r.createSelector)(_,(e=>e.show===d.b.activityLog)),V=e=>e.endpointPendingActions,U=e=>e.metadataTransformStats,H=e=>Object(u.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],Q=e=>Object(u.h)(e.metadataTransformStats),G=Object(r.createSelector)(V,(e=>t=>{let a={};var n;return Object(u.g)(e)&&(a=null!==(n=e.data.get(t))&&void 0!==n?n:{}),a}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(2),i=a.n(n);const r=i.a.createContext(null),s=Object(n.memo)((({upsellingService:e,children:t})=>i.a.createElement(r.Provider,{value:e},t)));s.displayName="UpsellingProvider";const o=()=>{const e=Object(n.useContext)(r);if(!e)throw new Error("UpsellingProviderContext not found");return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(17);const u=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:a,...n}){return e?s.a.createElement(c.EuiToolTip,{display:"block",content:e},s.a.createElement(u,i()({"data-test-subj":a},n),t)):s.a.createElement(u,i()({"data-test-subj":a},n),t)}u.displayName="EllipsisText"},function(e,t,a){"use strict";(function(t){const n=a(354),i=a(626),r=a(441),s={needsProtoHack:new Set([i.set,i.map,i.weakSet,i.weakMap])};e.exports=s.clone=function(e,a={},n=null){if("object"!=typeof e||null===e)return e;let o=s.clone,l=n;if(a.shallow){if(!0!==a.shallow)return s.cloneWithShallow(e,a);o=e=>e}else if(l){const t=l.get(e);if(t)return t}else l=new Map;const c=i.getInternalProto(e);if(c===i.buffer)return t&&t.from(e);if(c===i.date)return new Date(e.getTime());if(c===i.regex)return new RegExp(e);const u=s.base(e,c,a);if(u===e)return e;if(l&&l.set(e,u),c===i.set)for(const t of e)u.add(o(t,a,l));else if(c===i.map)for(const[t,n]of e)u.set(t,o(n,a,l));const d=r.keys(e,a);for(const t of d){if("__proto__"===t)continue;if(c===i.array&&"length"===t){u.length=e.length;continue}const n=Object.getOwnPropertyDescriptor(e,t);n?n.get||n.set?Object.defineProperty(u,t,n):n.enumerable?u[t]=o(e[t],a,l):Object.defineProperty(u,t,{enumerable:!1,writable:!0,configurable:!0,value:o(e[t],a,l)}):Object.defineProperty(u,t,{enumerable:!0,writable:!0,configurable:!0,value:o(e[t],a,l)})}return u},s.cloneWithShallow=function(e,t){const a=t.shallow;(t=Object.assign({},t)).shallow=!1;const i=new Map;for(const t of a){const a=n(e,t);"object"!=typeof a&&"function"!=typeof a||i.set(a,a)}return s.clone(e,t,i)},s.base=function(e,t,a){if(!1===a.prototype)return s.needsProtoHack.has(t)?new t.constructor:t===i.array?[]:{};const n=Object.getPrototypeOf(e);if(n&&n.isImmutable)return e;if(t===i.array){const e=[];return n!==t&&Object.setPrototypeOf(e,n),e}if(s.needsProtoHack.has(t)){const e=new n.constructor;return n!==t&&Object.setPrototypeOf(e,n),e}return Object.create(n)}}).call(this,a(242).Buffer)},function(e,t,a){"use strict";t.keys=function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;const i=n(a(632));t.defaultErrorMap=i.default;let r=i.default;t.setErrorMap=function(e){r=e},t.getErrorMap=function(){return r}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;const n=a(355);t.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},a={_errors:[]},n=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)a._errors.push(t(i));else{let e=a,n=0;for(;n<i.path.length;){const a=i.path[n];n===i.path.length-1?(e[a]=e[a]||{_errors:[]},e[a]._errors.push(t(i))):e[a]=e[a]||{_errors:[]},e=e[a],n++}}};return n(this),a}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},a=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):a.push(e(n));return{formErrors:a,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=ZodError,ZodError.create=e=>new ZodError(e)},,function(e,t,a){"use strict";var n=a(58);a.d(t,"a",(function(){return n.Direction}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(124);a(4);const i=e=>({hasQuery:null!=e.kqlQuery&&null!=e.kqlQuery.filterQuery&&null!=e.kqlQuery.filterQuery.kuery&&""!==e.kqlQuery.filterQuery.kuery.expression||null!=e.dataProviders&&e.dataProviders.length>0||null!=e.filters&&e.filters.length>0,hasEql:null!=e.eqlOptions&&null!=e.eqlOptions.query&&e.eqlOptions.query.length>0}),r=[n.e.alertsOnAlertsPage,n.e.alertsOnRuleDetailsPage]},function(e,t,a){"use strict";a.r(t),a.d(t,"allUsersSelector",(function(){return o})),a.d(t,"userRiskScoreSelector",(function(){return l})),a.d(t,"userRiskScoreSeverityFilterSelector",(function(){return c})),a.d(t,"authenticationsSelector",(function(){return u})),a.d(t,"usersAnomaliesJobIdFilterSelector",(function(){return d})),a.d(t,"usersAnomaliesIntervalSelector",(function(){return p})),a.d(t,"selectUserAssetTableById",(function(){return m})),a.d(t,"selectUserAssetTables",(function(){return f}));var n=a(57),i=a(176);const r=e=>e.users.page,s=(e,t)=>t===i.UsersType.details||t===i.UsersType.page?e.users[t]:null,o=()=>Object(n.createSelector)(r,(e=>e.queries[i.UsersTableType.allUsers])),l=()=>Object(n.createSelector)(r,(e=>e.queries[i.UsersTableType.risk])),c=()=>Object(n.createSelector)(r,(e=>e.queries[i.UsersTableType.risk].severitySelection)),u=()=>Object(n.createSelector)(r,(e=>e.queries[i.UsersTableType.authentications])),d=()=>Object(n.createSelector)(s,(e=>{var t;return null!==(t=null==e?void 0:e.queries[i.UsersTableType.anomalies].jobIdSelection)&&void 0!==t?t:[]})),p=()=>Object(n.createSelector)(s,(e=>{var t;return null!==(t=null==e?void 0:e.queries[i.UsersTableType.anomalies].intervalSelection)&&void 0!==t?t:"auto"})),m=(e,t)=>e.users.flyout.queries[t],f=e=>e.users.flyout.queries},function(e,t,a){t.set=t.assoc=t.assocPath=a(995),t.setWith=a(1053)},function(e,t,a){var n=a(637),i=a(1e3),r=a(1001),s=a(641),o=a(1019),l=a(645),c=a(1020),u=a(647),d=a(648),p=a(651),m=Math.max;e.exports=function(e,t,a,f,b,g,y,h){var v=2&t;if(!v&&"function"!=typeof e)throw new TypeError("Expected a function");var E=f?f.length:0;if(E||(t&=-97,f=b=void 0),y=void 0===y?y:m(p(y),0),h=void 0===h?h:p(h),E-=b?b.length:0,64&t){var x=f,j=b;f=b=void 0}var S=v?void 0:l(e),O=[e,t,a,f,b,x,j,g,y,h];if(S&&c(O,S),e=O[0],t=O[1],a=O[2],f=O[3],b=O[4],!(h=O[9]=void 0===O[9]?v?0:e.length:m(O[9]-E,0))&&24&t&&(t&=-25),t&&1!=t)k=8==t||16==t?r(e,t,h):32!=t&&33!=t||b.length?s.apply(void 0,O):o(e,t,a,f);else var k=i(e,t,a);return d((S?n:u)(k,O),e,t)}},function(e,t,a){e.exports=a(24)(3390)},function(e,t,a){e.exports=a(24)(363)},function(e,t,a){var n=a(450),i=a(453),r=4294967295;function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=r,this.__views__=[]}s.prototype=n(i.prototype),s.prototype.constructor=s,e.exports=s},function(e,t){e.exports=function(){}},function(e,t,a){e.exports=a(24)(286)},function(e,t,a){e.exports=a(24)(3380)},function(e,t,a){e.exports=a(24)(1620)},function(e,t){var a="__lodash_placeholder__";e.exports=function(e,t){for(var n=-1,i=e.length,r=0,s=[];++n<i;){var o=e[n];o!==t&&o!==a||(e[n]=a,s[r++]=n)}return s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warn=t.deprecate=t.resetDeprecationsSeen=void 0;var n={};t.resetDeprecationsSeen=function(){n={}};var i="object"==typeof console&&"function"==typeof console.warn?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.warn.apply(console,e)}:function(){};t.deprecate=function(e){n[e]||(n[e]=!0,i("redux-observable | DEPRECATION: "+e))},t.warn=function(e){i("redux-observable | WARNING: "+e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=n.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),s=n.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=n.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=n.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),c=n.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>n.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=n.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(706);const r=()=>{const e=Object(n.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,a){e.exports=a(24)(1069)},function(e,t,a){"use strict";var n=a(25);a.d(t,"c",(function(){return n.e})),a.d(t,"b",(function(){return n.d})),a.d(t,"d",(function(){return n.f})),a.d(t,"a",(function(){return n.a}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17),l=a(146),c=a(380);const u=s()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(n.forwardRef)((({id:e,field:t,dataTestSubj:a,idAria:r,bottomRightContent:s},d)=>{const{isInvalid:p,errorMessage:m}=Object(l.i)(t),[f,b]=Object(n.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":a,describedByIds:r?[r]:void 0,error:m,fullWidth:!0,helpText:t.helpText,isInvalid:p||f,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{ref:d,ariaLabel:r,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${a}-markdown-editor`,setIsMarkdownInvalid:b}),s&&i.a.createElement(u,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},s))))})));d.displayName="MarkdownEditorForm"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a(48),r=a(119),s=a(112),o=a(128),l=a(181);const c=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:a,multiple:c=!1,onClick:u,onCloseInspect:d,queryId:p})=>{const m=Object(i.useDispatch)(),f=o.d.globalQueryByIdSelector(),b=o.d.timelineQueryByIdSelector(),{loading:g,inspect:y,selectedInspectIndex:h,isInspected:v}=Object(s.a)((t=>e===r.a.global?f(t,p):b(t,p))),E=Object(n.useCallback)((()=>{u&&u(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[u,m,p,e,t]),x=Object(n.useCallback)((()=>{null!=d&&d(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,m,p,e,t]);let j=null,S=null;null!=y&&y.dsl.length>0&&(c?[j,...S]=y.dsl:j=y.dsl[t]);let O=null,k=null;null!=y&&y.response.length>0&&(c?[O,...k]=y.response:O=y.response[t]);const w=Object(n.useMemo)((()=>!g&&h===t&&v),[t,v,g,h]);return{additionalRequests:S,additionalResponses:k,handleClick:E,handleCloseModal:x,isButtonDisabled:Object(n.useMemo)((()=>g||a||null==j||null==O||null==p),[a,g,p,j,O]),isShowingModal:w,loading:g,request:j,response:O}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(122),s=a(113),o=a(228);const l=({onClick:e,outline:t,title:a,timelineId:n=r.c.active})=>{const{getButton:i}=Object(o.b)({timelineId:n,timelineType:s.l.template,onClick:e});return i({outline:t,title:a})},c=i.a.memo(l);c.displayName="NewTemplateTimeline"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(17),i=a(2),r=a.n(i),s=a(132),o=a(739);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:a,onOpen:i})=>r.a.createElement(n.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:a},r.a.createElement(o.a,{closeModalTimeline:a,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:s.H}))));l.displayName="OpenTimelineModal"},function(e,t,a){"use strict";a.d(t,"i",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"a",(function(){return f}));var n=a(45),i=a(113),r=a(592);const s=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(n.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:a,timelineType:n})=>n===i.l.template?r.b(e):t&&a?r.d(e):t?r.c(e):r.g(e),c=({eventId:e,pinnedEventIds:t})=>!0===t[e],u=({allowUnpinning:e,eventId:t,onPinEvent:a,onUnPinEvent:n,isEventPinned:i})=>{e&&(i?n(t):a(t))},d=(e,t,a)=>e.reduce(((e,n)=>({...e,...t.includes(n._id)?{[n._id]:n.data.filter((e=>a.includes(e.field)))}:{}})),{}),p=e=>{var t;if(!Object(n.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var a,i;const t=(null!==(a=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==a?a:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},m=e=>{var t,a,i,r;return Object(n.isEmpty)(null===(t=e.kibana)||void 0===t||null===(a=t.alert)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.uuid)?Object(n.isEmpty)(null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},f="note-content"},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(47),c=a(44),u=a.n(c),d=a(112),p=a(151),m=a(134),f=a(118),b=a(305),g=a(266);const y=(e,t)=>(t===g.a.createCase||t===g.a.submitCase)&&e===g.b.alertsCases,h=u()(o.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>y(t,e)?"9000 !important":"1000 !important")),v=({children:e,onClick:t,step:a,tourId:n})=>{const{activeStep:c,incrementStep:u,isTourShown:v}=Object(b.b)(),E=Object(r.useMemo)((()=>g.e[n].find((e=>e.step===a))),[a,n]),x=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),j=Object(d.b)((e=>{var t;return(null!==(t=x(e,p.f.active))&&void 0!==t?t:m.b).show})),S=Object(r.useCallback)((()=>t?t():u(n)),[u,t,n]),O=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),k=y(n,a);if(null==E||(a!==c||!v(n))&&!k||j)return e||null;const{anchor:w,content:T,imageConfig:I,dataTestSubj:C,hideNextButton:M=!1,..._}=E,A=M?s.a.createElement(s.a.Fragment,null):s.a.createElement(o.EuiButtonEmpty,{onClick:S,onKeyDown:O,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),F={..._,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,T)),I&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiImage,{alt:I.altText,src:I.src,size:"fullWidth"}))),footerAction:A,isStepOpen:!0,onFinish:()=>null,stepsTotal:g.e[n].length,panelProps:{"data-test-subj":C}};return null!=w?s.a.createElement(s.a.Fragment,null,s.a.createElement(h,i()({tourId:n},F,{anchor:w})),s.a.createElement(s.a.Fragment,null,e)):null!=e?s.a.createElement(h,i()({tourId:n},F),e):null},E=({children:e,isTourAnchor:t=!0,...a})=>t?s.a.createElement(v,a,e):s.a.createElement(s.a.Fragment,null,e)},function(e,t,a){"use strict";a.d(t,"g",(function(){return g})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return v})),a.d(t,"f",(function(){return E})),a.d(t,"e",(function(){return j})),a.d(t,"d",(function(){return k})),a.d(t,"c",(function(){return w}));var n=a(45),i=a(56),r=a.n(i),s=a(324),o=a.n(s),l=a(1171),c=a.n(l),u=a(175),d=a(143),p=a(1156),m=a(307),f=a(686),b=a(27);const g=e=>{const t={unit:"ms",value:0},a=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(n.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(n.isEmpty)(i)&&null!=i&&["s","m","h","d"].includes(i[0])&&(t.unit=i[0]),t},y=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:i,threatQueryBar:r,threatMapping:s,eqlOptions:o,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:f,threatMapping:b,eqlOptions:g,newTermsFields:y,historyWindowSize:h,...v}=e;return v;case"threat_match":const{anomalyThreshold:E,machineLearningJobId:x,threshold:j,eqlOptions:S,newTermsFields:O,historyWindowSize:k,...w}=e;return w;case"query":case"saved_query":const{anomalyThreshold:T,machineLearningJobId:I,threshold:C,threatIndex:M,threatQueryBar:_,threatMapping:A,eqlOptions:F,newTermsFields:P,historyWindowSize:D,...N}=e;return N;case"eql":const{anomalyThreshold:R,machineLearningJobId:L,threshold:B,threatIndex:z,threatQueryBar:q,threatMapping:$,newTermsFields:V,historyWindowSize:U,...H}=e;return H;case"new_terms":const{anomalyThreshold:Q,machineLearningJobId:G,threshold:W,threatIndex:Z,threatQueryBar:K,threatMapping:J,eqlOptions:Y,...X}=e;return X;case"esql":const{anomalyThreshold:ee,machineLearningJobId:te,threshold:ae,threatIndex:ne,threatQueryBar:ie,threatMapping:re,newTermsFields:se,historyWindowSize:oe,eqlOptions:le,index:ce,dataViewId:ue,...de}=e;return de}Object(d.a)(t)};function h(e){return e.filter((e=>"none"!==e.name))}const v=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:h(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?h(e.subtechnique):[]})))}})),E=e=>{const t={...e};return e.dataSourceType===m.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===m.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},x=e=>{var t,a,i,r,s,o,l,c,u,d,p,f,g,h,v,x,j,S,O,k,w,T,I,C,M,_,A,F,P,D,N,R,L,B,z,q,$,V,U,H,Q,G,W,Z,K,J,Y,X,ee,te;const ae=E(e),ne=y(ae,ae.ruleType),{ruleType:ie,timeline:re}=ne;var se;return{...{type:ie,...null!=re.id&&null!=re.title&&{timeline_id:re.id,timeline_title:re.title}},...(se=ne,Object(n.has)("anomalyThreshold",se)?{anomaly_threshold:ne.anomalyThreshold,machine_learning_job_id:ne.machineLearningJobId}:(e=>Object(n.has)("threshold",e))(ne)?{index:ne.index,filters:null===(t=ne.queryBar)||void 0===t?void 0:t.filters,language:null===(a=ne.queryBar)||void 0===a||null===(i=a.query)||void 0===i?void 0:i.language,query:null===(r=ne.queryBar)||void 0===r||null===(s=r.query)||void 0===s?void 0:s.query,saved_id:null!==(o=null===(l=ne.queryBar)||void 0===l?void 0:l.saved_id)&&void 0!==o?o:void 0,..."threshold"===ie&&{threshold:{field:null!==(c=null===(u=ne.threshold)||void 0===u?void 0:u.field)&&void 0!==c?c:[],value:null!==(d=parseInt(null===(p=ne.threshold)||void 0===p?void 0:p.value,10))&&void 0!==d?d:0,cardinality:Object(n.isEmpty)(null===(f=ne.threshold.cardinality)||void 0===f?void 0:f.field)||null==(null===(g=ne.threshold.cardinality)||void 0===g?void 0:g.value)?[]:[{field:ne.threshold.cardinality.field[0],value:parseInt(ne.threshold.cardinality.value,10)}]},...ne.enableThresholdSuppression&&{alert_suppression:{duration:ne.groupByDuration}}}}:(e=>Object(n.has)("threatIndex",e))(ne)?{index:ne.index,filters:null===(h=ne.queryBar)||void 0===h?void 0:h.filters,language:null===(v=ne.queryBar)||void 0===v||null===(x=v.query)||void 0===x?void 0:x.language,query:null===(j=ne.queryBar)||void 0===j||null===(S=j.query)||void 0===S?void 0:S.query,saved_id:null!==(O=null===(k=ne.queryBar)||void 0===k?void 0:k.saved_id)&&void 0!==O?O:void 0,threat_index:ne.threatIndex,threat_query:null===(w=ne.threatQueryBar)||void 0===w||null===(T=w.query)||void 0===T?void 0:T.query,threat_filters:null===(I=ne.threatQueryBar)||void 0===I?void 0:I.filters,threat_mapping:ne.threatMapping,threat_language:null===(C=ne.threatQueryBar)||void 0===C||null===(M=C.query)||void 0===M?void 0:M.language}:(e=>Object(n.has)("eqlOptions",e))(ne)?{index:ne.index,filters:null===(_=ne.queryBar)||void 0===_?void 0:_.filters,language:null===(A=ne.queryBar)||void 0===A||null===(F=A.query)||void 0===F?void 0:F.language,query:null===(P=ne.queryBar)||void 0===P||null===(D=P.query)||void 0===D?void 0:D.query,saved_id:null!==(N=null===(R=ne.queryBar)||void 0===R?void 0:R.saved_id)&&void 0!==N?N:void 0,timestamp_field:null===(L=ne.eqlOptions)||void 0===L?void 0:L.timestampField,event_category_override:null===(B=ne.eqlOptions)||void 0===B?void 0:B.eventCategoryField,tiebreaker_field:null===(z=ne.eqlOptions)||void 0===z?void 0:z.tiebreakerField}:(e=>Object(n.has)("newTermsFields",e))(ne)?{index:ne.index,filters:null===(q=ne.queryBar)||void 0===q?void 0:q.filters,language:null===($=ne.queryBar)||void 0===$||null===(V=$.query)||void 0===V?void 0:V.language,query:null===(U=ne.queryBar)||void 0===U||null===(H=U.query)||void 0===H?void 0:H.query,new_terms_fields:ne.newTermsFields,history_window_start:`now-${ne.historyWindowSize}`}:(e=>"esql"===Object(n.get)("queryBar.query.language",e))(ne)&&!("index"in ne)?{language:null===(Q=ne.queryBar)||void 0===Q||null===(G=Q.query)||void 0===G?void 0:G.language,query:null===(W=ne.queryBar)||void 0===W||null===(Z=W.query)||void 0===Z?void 0:Z.query}:{...ne.groupByFields.length>0?{alert_suppression:{group_by:ne.groupByFields,duration:ne.groupByRadioSelection===m.b.PerTimePeriod?ne.groupByDuration:void 0,missing_fields_strategy:ne.suppressionMissingFields||b.a}}:{},index:ne.index,filters:null===(K=ne.queryBar)||void 0===K?void 0:K.filters,language:null===(J=ne.queryBar)||void 0===J||null===(Y=J.query)||void 0===Y?void 0:Y.language,query:null===(X=ne.queryBar)||void 0===X||null===(ee=X.query)||void 0===ee?void 0:ee.query,saved_id:void 0,type:"query",...["query","saved_query"].includes(ie)&&(null===(te=ne.queryBar)||void 0===te?void 0:te.saved_id)&&ne.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:ne.queryBar.saved_id}}),..."dataViewId"in ne?{data_view_id:ne.dataViewId}:{}}},j=e=>{const{...t}=e;if(!Object(n.isEmpty)(t.interval)&&!Object(n.isEmpty)(t.from)){const{unit:e,value:a}=g(t.interval),{unit:n,value:i}=g(t.from),s=r.a.duration(a,e);s.add(i,n),t.from=`now-${s.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},S=(e,t)=>{const{author:a,falsePositives:i,investigationFields:r,references:s,riskScore:o,severity:l,threat:c,isAssociatedToEndpointList:d,isBuildingBlock:p,note:m,ruleNameOverride:f,threatIndicatorPath:b,timestampOverride:g,timestampOverrideFallbackDisabled:y,...h}=e,E=null!=t?t.filter((e=>"endpoint"!==e.type)):[],x=r.every((e=>Object(n.isEmpty)(e.trim())));return{author:a.filter((e=>!Object(n.isEmpty)(e))),...p?{building_block_type:"default"}:{},...d?{exceptions_list:[{id:u.k,list_id:u.k,namespace_type:"agnostic",type:"endpoint"},...E]}:null!=t?{exceptions_list:[...E]}:{},false_positives:i.filter((e=>!Object(n.isEmpty)(e))),references:s.filter((e=>!Object(n.isEmpty)(e))),investigation_fields:x?void 0:{field_names:r},risk_score:o.value,risk_score_mapping:o.isMappingChecked?o.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==f?f:void 0,severity:l.value,severity_mapping:l.isMappingChecked?l.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:v(c).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:b,timestamp_override:""!==g?g:void 0,timestamp_override_fallback_disabled:y,...Object(n.isEmpty)(m)?{}:{note:m},...h}},O=e=>{const{actions:t=[],responseActions:a,enabled:n,kibanaSiemAppUrl:i}=e;return{actions:t.map((e=>Object(p.b)(e))),response_actions:null==a?void 0:a.map(p.c),enabled:n,meta:{kibana_siem_app_url:i}}},k=(e,t,a,n,i)=>o.a.all([x(e),S(t,i),j(a),O(n)]),w=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...k(e,i,a,f.c,n)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),i=a(50),r=a(410),s=a(163),o=a(337);const l=["GET",r.b],c=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(s.i)({signal:e})),{...o.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"x",(function(){return s})),a.d(t,"t",(function(){return o})),a.d(t,"v",(function(){return l})),a.d(t,"y",(function(){return c})),a.d(t,"w",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"s",(function(){return m})),a.d(t,"u",(function(){return f})),a.d(t,"o",(function(){return b})),a.d(t,"n",(function(){return g})),a.d(t,"m",(function(){return y})),a.d(t,"j",(function(){return h})),a.d(t,"h",(function(){return v})),a.d(t,"i",(function(){return E})),a.d(t,"f",(function(){return x})),a.d(t,"p",(function(){return j})),a.d(t,"q",(function(){return S})),a.d(t,"r",(function(){return O})),a.d(t,"l",(function(){return k})),a.d(t,"k",(function(){return w})),a.d(t,"g",(function(){return T})),a.d(t,"c",(function(){return I}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.pageTitle",{defaultMessage:"MITRE ATT&CKÂ® coverage"}),r=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.collapseCellsButton",{defaultMessage:"Collapse cells"}),s=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.expandCellsButton",{defaultMessage:"Expand cells"}),o=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesMetadataLabel",{defaultMessage:"Disabled Rules:"}),l=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesMetadataLabel",{defaultMessage:"Enabled Rules:"}),c=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.subtechniques",{defaultMessage:"Sub-techniques"}),u=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enableAllDisabledButtonLabel",{defaultMessage:"Enable all disabled"}),d=(e,t)=>n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreTechniques",{values:{enabledTechniques:e,totalTechniques:t},defaultMessage:"{enabledTechniques}/{totalTechniques} techniques"}),p=(e,t)=>n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreSubtechniques",{values:{enabledSubtechniques:e,totalSubtechniques:t},defaultMessage:"Sub-techniques {enabledSubtechniques}/{totalSubtechniques}"}),m=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesListLabel",{defaultMessage:"Disabled rules"}),f=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesListLabel",{defaultMessage:"Enabled rules"}),b=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendTitle",{defaultMessage:"Legend"}),g=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendSubtitle",{defaultMessage:"(count will include all rules selected)"}),y=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendRulesLabel",{defaultMessage:"rules"}),h=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRuleActivity",{defaultMessage:"Enabled rules"}),v=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRuleActivity",{defaultMessage:"Disabled rules"}),E=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.elasticRuleSource",{defaultMessage:"Elastic rules"}),x=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.customRuleSource",{defaultMessage:"Custom rules"}),j=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleActivityFilterLabel",{defaultMessage:"Installed rule status"}),S=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleSourceFilterLabel",{defaultMessage:"Installed rule type"}),O=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.searchBarPlaceholder",{defaultMessage:'Search for the tactic, technique (e.g.,"defense evasion" or "TA0005") or rule name'}),k=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverTitle",{defaultMessage:"Select to view on framework"}),w=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverClearAll",{defaultMessage:"Clear all"}),T=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.dashboardInformation",{defaultMessage:"Your current coverage of MITRE ATT&CKÂ® tactics and techniques, based on installed rules. Click a cell to view and enable a technique's rules. Rules must be mapped to the MITRE ATT&CKÂ® framework to be displayed."}),I=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.fetchErrorTitle",{defaultMessage:"Failed to fetch coverage overview data"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(29),i=a(50),r=a(2),s=a(163),o=a(337);const l=["GET",n.INTERNAL_ALERTING_API_FIND_RULES_PATH],c=(e,t)=>Object(i.useQuery)([...l,...e],(({signal:t})=>Object(s.k)({ids:e,signal:t})),{...o.a,...t}),u=()=>{const e=Object(i.useQueryClient)();return Object(r.useCallback)((()=>e.invalidateQueries(l,{refetchType:"active"})),[e])}},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return b})),a.d(t,"e",(function(){return g}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),function(e){e.updateActiveGroups="UPDATE_ACTIVE_GROUPS",e.updateGroupOptions="UPDATE_GROUP_OPTIONS"}(n||(n={}));const i={},r={activeGroups:["none"],options:[]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));class BadRequestError extends Error{}a(622),a(623);var n=a(973),i=a.n(n),r=a(182),s=a(111),o=a(295),l=a(4),c=a(554);const u=async({body:e,dataViewService:t,dataViewId:a})=>{if(null===a)return;let n=await t.getIdsWithTitle();const u=n.find((e=>e.id===a)),{patternList:d}=e,p=Object(o.a)(d).join();let m;if(void 0===u)try{m=await t.createAndSave({allowNoIndex:!0,id:a,title:p,timeFieldName:l.X},!0)}catch(e){const n=(e=>i.a.isBoom(e)?{message:e.output.payload.message,statusCode:e.output.statusCode}:e instanceof s.ZodError?{message:Object(r.f)(e),statusCode:500}:null!=e.statusCode?null!=e.body&&null!=e.body.error?{statusCode:e.statusCode,message:`${e.body.error.type}: ${e.body.error.reason}`}:{statusCode:e.statusCode,message:e.message}:e instanceof BadRequestError?{message:e.message,statusCode:400}:{message:null!=e.message?e.message:"(unknown error message)",statusCode:500})(e);if("DuplicateDataViewError"!==e.name&&409!==n.statusCode)throw n;m=await t.get(a)}else{const e=u?Object(o.a)(u.title.split(",")).join():"";m=await t.get(a),p!==e&&(m.title=p,await t.updateSavedObject(m))}if(n.some((e=>e.id===a)))n=n.map((e=>e.id===a?{...e,title:p}:e));else if(null!==m){var f,b;n.push({id:null!==(f=m.id)&&void 0!==f?f:a,title:null===(b=m)||void 0===b?void 0:b.title})}const g=await Object(c.a)(a,t);return{defaultDataView:g,kibanaDataViews:n.map((e=>e.id===a?g:{id:e.id,patternList:e.title.split(","),title:e.title}))}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return v})),a.d(t,"d",(function(){return E})),a.d(t,"e",(function(){return x}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r);const o=s.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=s.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const c=s.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));c.displayName="BarGroup";const u=s.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));u.displayName="BarText";const d=s.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const p=s.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));p.displayName="BarSpacer";const m=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));m.displayName="UtilityBar";var f=a(17),b=a(713);const g=s()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:a,iconSize:r,iconType:s,popoverContent:o,disabled:l,ownFocus:c,dataTestSubj:u,popoverPanelPaddingSize:d,onClick:p})=>{const[m,g]=Object(n.useState)(!1),y=Object(n.useCallback)((()=>g(!1)),[g]),h=Object(n.useCallback)((()=>{null==p||p(),g(!m)}),[m,p]);return i.a.createElement(f.EuiPopover,{ownFocus:c,panelPaddingSize:d,button:i.a.createElement(b.a,{dataTestSubj:u,color:t,iconSide:a,iconSize:r,iconType:s,disabled:l,onClick:h},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==o?void 0:o(y))}));y.displayName="Popover";const h=i.a.memo((({children:e,color:t,dataTestSubj:a,disabled:n,href:r,iconSide:s,iconSize:o,iconType:l,ownFocus:c,onClick:u,popoverContent:p,popoverPanelPaddingSize:m,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(g,{"data-test-subj":`${a}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":a},p?i.a.createElement(y,{dataTestSubj:`${a}-popover`,disabled:n,color:t,iconSide:s,iconSize:o,iconType:l,ownFocus:c,popoverPanelPaddingSize:m,popoverContent:p,onClick:u},e):i.a.createElement(b.a,{color:t,dataTestSubj:`${a}-linkIcon`,disabled:n,href:r,iconSide:s,iconSize:o,iconType:l,onClick:u},e))));h.displayName="UtilityBarAction";const v=i.a.memo((({grow:e,children:t})=>i.a.createElement(c,{grow:e},t)));v.displayName="UtilityBarGroup";const E=i.a.memo((({grow:e,children:t,dataTestSubj:a})=>i.a.createElement(l,{grow:e,"data-test-subj":a},t)));E.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:a=!1,className:n})=>i.a.createElement(u,{"data-test-subj":t,shouldWrap:a,className:n},e)));x.displayName="UtilityBarText"},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=`${a(4).Db}/fleet/integrations/installed`},function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v}));var n=a(80),i=a(124),r=a(89),s=a(167),o=a(195),l=a(138),c=a(149),u=a(116),d=a(392),p=a(610),m=a(635),f=a(1274),b=a(187),g=a(903);const y=Object(b.reducerWithInitialState)({app:void 0,internal:void 0,savedSearch:void 0}).case(g.a,((e,{newState:t})=>({...e,app:{...e.app,...t}}))).case(g.b,((e,{newState:t})=>({...e,internal:t}))).case(g.c,((e,{newState:t})=>({...e,savedSearch:t})));Object(r.enableMapSet)();const h=(e,{defaultDataView:t,kibanaDataViews:a,signalIndexName:n,enableExperimental:i},r,m,f)=>{const b={[u.SourcererScopeName.default]:Object(d.b)(t,u.SourcererScopeName.default,n,!0),[u.SourcererScopeName.detections]:Object(d.b)(t,u.SourcererScopeName.detections,n,!0),[u.SourcererScopeName.timeline]:Object(d.b)(t,u.SourcererScopeName.timeline,n,!0)};return{...e,app:{...s.d,enableExperimental:i},dragAndDrop:o.d,inputs:Object(l.a)(i.socTrendsEnabled),sourcerer:{...c.b.initialSourcererState,sourcererScopes:{...c.b.initialSourcererState.sourcererScopes,[u.SourcererScopeName.default]:{...c.b.initialSourcererState.sourcererScopes.default,selectedDataViewId:t.id,selectedPatterns:b[u.SourcererScopeName.default]},[u.SourcererScopeName.detections]:{...c.b.initialSourcererState.sourcererScopes.detections,selectedDataViewId:t.id,selectedPatterns:b[u.SourcererScopeName.detections]},[u.SourcererScopeName.timeline]:{...c.b.initialSourcererState.sourcererScopes.timeline,selectedDataViewId:t.id,selectedPatterns:b[u.SourcererScopeName.timeline]}},defaultDataView:t,kibanaDataViews:a.map((e=>({...u.initDataView,...e}))),signalIndexName:n},globalUrlParam:p.d,dataTable:r.dataTable,groups:m.groups,analyzer:f.analyzer,discover:{app:void 0,internal:void 0,savedSearch:void 0}}},v=e=>Object(n.combineReducers)({app:s.b,dragAndDrop:o.b,inputs:l.c,sourcerer:c.c,globalUrlParam:p.b,dataTable:i.i,groups:m.a,analyzer:f.a,discover:y,...e})},function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return h}));var n=a(50),i=a(2),r=a(473),s=a(289),o=a(163),l=a(9);const c=["TA0043","TA0042","TA0001","TA0002","TA0003","TA0004","TA0005","TA0006","TA0007","TA0008","TA0009","TA0011","TA0010","TA0040"],u=()=>a.e(20).then(a.bind(null,1695));function d(e){const t={totalRulesCount:Object.keys(e).length,totalEnabledRulesCount:0};for(const a of Object.keys(e))e[a].activity===s.b.Enabled&&t.totalEnabledRulesCount++;return t}function p(e){const t={enabledRules:[],disabledRules:[],availableRules:[]};for(const a of e.unmapped_rule_ids)m(t,a,e.rules_data[a]);return t}function m(e,t,a){a&&(a.activity===s.b.Enabled?e.enabledRules.push({id:t,name:a.name}):a.activity===s.b.Disabled&&e.disabledRules.push({id:t,name:a.name}))}var f=a(337),b=a(117);const g=["POST",s.d],y=(e={},t)=>{const{addError:a}=Object(b.a)();return Object(n.useQuery)([...g,e],(async({signal:t})=>async function(e){const t=await u(),{tactics:a,techniques:n,subtechniques:i}=t,r=function(e,t,a){const n=new Map;for(const e of a){const t={id:e.id,name:e.name,reference:e.reference,enabledRules:[],disabledRules:[],availableRules:[]},a=n.get(e.techniqueId);a?a.push(t):n.set(e.techniqueId,[t])}const i=new Map;for(const e of t){var r;const t=null!==(r=n.get(e.id))&&void 0!==r?r:[];for(const a of e.tactics){const n={id:e.id,name:e.name,reference:e.reference,subtechniques:t,enabledRules:[],disabledRules:[],availableRules:[]},r=i.get(a);r?r.push(n):i.set(a,[n])}}const s=e.sort(((e,t)=>c.indexOf(e.id)-c.indexOf(t.id))),o=[];for(const e of s){var u;o.push({id:e.id,name:e.name,reference:e.reference,techniques:null!==(u=i.get(Object(l.kebabCase)(e.name)))&&void 0!==u?u:[],enabledRules:[],disabledRules:[],availableRules:[]})}return o}(a,n,i);for(const t of r){for(const a of null!==(s=e.coverage[t.id])&&void 0!==s?s:[]){var s;m(t,a,e.rules_data[a])}for(const a of t.techniques){for(const n of null!==(o=e.coverage[a.id])&&void 0!==o?o:[]){var o,f;null!==(f=e.coverage[t.id])&&void 0!==f&&f.includes(n)&&m(a,n,e.rules_data[n])}for(const n of a.subtechniques)for(const a of null!==(b=e.coverage[n.id])&&void 0!==b?b:[]){var b,g;null!==(g=e.coverage[t.id])&&void 0!==g&&g.includes(a)&&m(n,a,e.rules_data[a])}}}return{mitreTactics:r,unmappedRules:p(e),metrics:d(e.rules_data)}}(await Object(o.g)({signal:t,filter:e}))),{...f.a,...t,onError:e=>{a(e,{title:r.c})}})},h=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(g,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return g}));var n=a(61),i=a.n(n),r=a(294),s=a(198),o=a(51);const l=Object(o.v4)();var c,u,d=a(725);const p=(e,t)=>a=>`${d.g}: ${i()(a).format(e)} ${t?d.f(a):d.e(a)}`,m=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],f={defaultStackByOption:null!==(c=m.find((e=>"event.action"===e.text)))&&void 0!==c?c:m[0],errorMessage:d.c,histogramType:r.i.events,stackByOptions:m,subtitle:void 0,title:d.d,getLensAttributes:(e="event.action",t={})=>{var a;return{title:"Events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:l,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!==(a=t.filters)&&void 0!==a?a:[],datasourceStates:{formBased:{layers:{[l]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${l}`}]}}},b=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],g={defaultStackByOption:null!==(u=b.find((e=>"event.module"===e.text)))&&void 0!==u?u:b[0],errorMessage:d.b,histogramType:r.i.alerts,stackByOptions:b,subtitle:void 0,title:d.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:s.g,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(s.p)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(45),i=a(429),r=a(2),s=a(561),o=a(405),l=a(194),c=a(154),u=a(215),d=a(720),p=a(520);const m={[u.e]:{id:u.e,isDefault:!0,messages:[],apiConfig:{}},[i.a]:{id:i.a,isDefault:!0,messages:[],apiConfig:{}},[c.yb]:{id:c.yb,isDefault:!0,messages:[],apiConfig:{}},[u.i]:{id:u.i,isDefault:!0,messages:[],apiConfig:{}},[p.a]:{excludeFromLastConversationStorage:!0,id:p.a,isDefault:!0,messages:[],apiConfig:{}},[l.h]:{id:l.h,isDefault:!0,theme:{title:l.e,titleIcon:"logoSecurity",assistant:{name:d.f,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[],apiConfig:{}}};var f=a(20),b=a(39);const g=()=>{const e=Object(f.f)(b.SecurityPageName.dataQuality),t=Object(r.useMemo)((()=>e?m:Object(n.unset)(i.a,m)),[e]),[a,l]=Object(s.a)({defaultValue:t,key:o.a,isInvalidDefault:e=>!e});return{conversations:a,setConversations:l}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(2),i=a(157),r=a(20);const s=e=>{const t=o();return Object(n.useMemo)((()=>t(e)),[t,e])},o=()=>{const e=Object(i.a)();return Object(n.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},function(e,t,a){"use strict";var n=a(971),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var a,r,s,o,l,c,u=!1;t||(t={}),a=t.debug||!1;try{if(s=n(),o=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(c),o.selectNodeContents(c),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(n){a&&console.error("unable to copy using execCommand: ",n),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(n){a&&console.error("unable to copy using clipboardData: ",n),a&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),c&&document.body.removeChild(c),s()}return u}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>Object.keys(t).reduce(((e,a)=>e.replace(new RegExp(`\\{${a}\\}`,"g"),String(t[a]))),e)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return s}));var n=a(272),i=a(150);a.d(t,"a",(function(){return i.a}));const r=Object.keys(n.d),s=e=>r.includes(e)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(51);const i=()=>Object(n.v4)(),r=({prevPromptContexts:e,promptContext:t})=>({...e,[t.id]:{...t}})},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"i",(function(){return r})),a.d(t,"j",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"k",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"g",(function(){return f}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),r=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),s=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),o=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),l=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),c=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),u=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),d=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),p=n.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),m=(n.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),n.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),f=n.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o}));const n=e=>"string"!=typeof e,i=({field:e,list:t,operation:a})=>"add"===a?t.includes(e)?t:[...t,e]:t.filter((t=>t!==e)),r=({field:e,operation:t,selectedPromptContext:a,update:n})=>{const{allow:r,allowReplacement:s}=a;switch(n){case"allow":return{...a,allow:i({field:e,list:r,operation:t})};case"allowReplacement":return{...a,allowReplacement:i({field:e,list:s,operation:t})};default:return a}},s=({currentList:e,setDefaultList:t,update:a,updates:n})=>{const r=n.filter((e=>e.update===a));r.length>0&&t(r.reduce(((e,{field:t,operation:a})=>i({field:t,list:e,operation:a})),e))},o=({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:a,setDefaultAllowReplacement:n,updates:i})=>{s({currentList:e,setDefaultList:a,update:"defaultAllow",updates:i}),s({currentList:t,setDefaultList:n,update:"defaultAllowReplacement",updates:i})}},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),r=n.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),s=n.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),o=n.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(17),i=a(2),r=a.n(i),s=a(220),o=a(177),l=a(497),c=a(123),u=a(252),d=a(548),p=a(13);const m="ADD_NEW_CONNECTOR",f=r.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:a,selectedConnectorId:f,onConnectorSelectionChange:b,setIsOpen:g})=>{const{actionTypeRegistry:y,http:h,assistantAvailability:v}=Object(c.b)(),[E,x]=Object(i.useState)(!1),{data:j}=Object(l.a)({http:h}),[S,O]=Object(i.useState)(null),{data:k,isLoading:w,isFetching:T,refetch:I}=Object(s.a)({http:h}),C=Object(i.useMemo)((()=>k?k.map((e=>({...e,connectorTypeTitle:Object(u.a)(y.get(e.actionTypeId))}))):[]),[y,k]),M=w||T,_=e||!v.hasConnectorsReadPrivilege,A=Object(i.useMemo)((()=>({value:m,inputDisplay:o.e,dropdownDisplay:Object(p.jsx)(n.EuiFlexGroup,{gutterSize:"none",key:m},Object(p.jsx)(n.EuiFlexItem,{grow:!0},Object(p.jsx)(n.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},o.e)),Object(p.jsx)(n.EuiFlexItem,{grow:!1},Object(p.jsx)("div",{style:{width:"24px"}})))})),[]),F=Object(i.useMemo)((()=>C.map((e=>{var t,i;const s=null!==(t=null===(i=Object(u.b)(e))||void 0===i?void 0:i.apiProvider)&&void 0!==t?t:e.connectorTypeTitle,l=e.isPreconfigured?o.r:s;return{value:e.id,"data-test-subj":e.id,inputDisplay:a?a(e.name):e.name,dropdownDisplay:Object(p.jsx)(r.a.Fragment,{key:e.id},Object(p.jsx)("strong",null,e.name),l&&Object(p.jsx)(n.EuiText,{size:"xs",color:"subdued"},Object(p.jsx)("p",null,l)))}}))),[C,a]),P=Object(i.useMemo)((()=>v.hasConnectorsAllPrivilege?[...F,A]:[...F]),[A,v.hasConnectorsAllPrivilege,F]),D=Object(i.useCallback)((()=>{null==g||g(!1),x(!1),O(null)}),[g]),[N,R]=Object(i.useState)(t),L=Object(i.useCallback)((e=>{if(e===m)return R(!1),void x(!0);const t=C.find((t=>t.id===e));t&&b(t)}),[C,b]),B=Object(i.useCallback)((e=>{b({...e,connectorTypeTitle:Object(u.a)(y.get(e.actionTypeId))}),null==I||I(),D()}),[y,D,b,I]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(n.EuiSuperSelect,{"aria-label":o.f,compressed:!0,"data-test-subj":"connector-selector",disabled:_,hasDividers:!0,isLoading:M,isOpen:N,onChange:L,options:P,valueOfSelected:null!=f?f:""}),E&&Object(p.jsx)(d.a,{actionTypeRegistry:y,actionTypes:j,onClose:()=>x(!1),onSaveConnector:B,onSelectActionType:e=>O(e),selectedActionType:S}))}));f.displayName="ConnectorSelector"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(50),i=a(76),r=a(72),s=a(177);const o=["elastic-assistant, load-action-types"],l=({http:e,toasts:t})=>Object(n.useQuery)(o,(async()=>(await Object(i.loadActionTypes)({http:e,featureId:r.GenerativeAIConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.n}))}})},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return u}));var n=a(2),i=a.n(n),r=a(17),s=a(495),o=a(13);const l="gpt-3.5-turbo",c=[l,"gpt-4"],u=i.a.memo((({models:e=c,onModelSelectionChange:t,selectedModel:a=c[0]})=>{const[i,l]=Object(n.useState)(e.map((e=>({"data-test-subj":e,label:e})))),u=Object(n.useMemo)((()=>a?[{label:a}]:[]),[a]),d=Object(n.useCallback)((a=>{var n,i;const r=0===a.length?void 0:null!==(n=e.find((e=>{var t;return e===(null===(t=a[0])||void 0===t?void 0:t.label)})))&&void 0!==n?n:null===(i=a[0])||void 0===i?void 0:i.label;null==t||t(r)}),[t,e]),p=Object(n.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const a=e.trim().toLowerCase(),n={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===a))||l([...i,n]),d([n])}),[d,i]),m=Object(n.useCallback)((e=>{0===e.length?d([]):-1!==i.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,i]);return Object(o.jsx)(r.EuiComboBox,{"aria-label":s.b,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:s.d,customOptionText:`${s.a} {searchValue}`,singleSelection:{asPlainText:!0},options:i,selectedOptions:u,onChange:m,onCreateOption:p,fullWidth:!0})}));u.displayName="ModelSelector"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importStar(a(2)),r=a(2),s=n.__importDefault(a(255)),o=n.__importDefault(a(772));t.default=function(e){return function(t){var a,l;l=i.isValidElement(t)?(a=t).props:t;var c=s.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),u=c[0],d=c[1],p=r.useRef(null),m=function(e,t){return function(a){try{t&&t(a)}finally{e&&e(a)}}},f=function(){return d({paused:!1})},b=function(){return d({paused:!0})},g=function(){var e=p.current;e&&d({muted:e.muted,volume:e.volume})},y=function(){var e=p.current;if(e){var t=e.duration,a=e.buffered;d({duration:t,buffered:o.default(a)})}},h=function(){var e=p.current;e&&d({time:e.currentTime})},v=function(){var e=p.current;e&&d({buffered:o.default(e.buffered)})};a=a?i.cloneElement(a,n.__assign(n.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,b),onVolumeChange:m(l.onVolumeChange,g),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)})):i.createElement(e,n.__assign(n.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,b),onVolumeChange:m(l.onVolumeChange,g),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)}));var E=!1,x={play:function(){var e=p.current;if(e&&!E){var t=e.play();if("object"==typeof t){E=!0;var a=function(){E=!1};t.then(a,a)}return t}},pause:function(){var e=p.current;if(e&&!E)return e.pause()},seek:function(e){var t=p.current;t&&void 0!==u.duration&&(e=Math.min(u.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=p.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=p.current;e&&(e.muted=!0)},unmute:function(){var e=p.current;e&&(e.muted=!1)}};return r.useEffect((function(){var e=p.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&x.play())}),[l.src]),[a,u,x,p]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return n.useReducer(i,e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(502)),s=a(301);t.default=function(e,t,a){void 0===e&&(e=0),void 0===t&&(t=null),void 0===a&&(a=null);var n=s.resolveHookState(e);"number"!=typeof n&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof a?n=Math.max(n,a):null!==a&&console.error("min has to be a number, got "+typeof a),"number"==typeof t?n=Math.min(n,t):null!==t&&console.error("max has to be a number, got "+typeof t);var o=r.default(n),l=o[0],c=o[1];return[l(),i.useMemo((function(){var e=function(e){var n=l(),i=s.resolveHookState(e,n);n!==i&&("number"==typeof a&&(i=Math.max(i,a)),"number"==typeof t&&(i=Math.min(i,t)),n!==i&&c(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var a=s.resolveHookState(t,l());"number"!=typeof a&&console.error("delta has to be a number or function returning a number, got "+typeof a),e((function(e){return e+a}))},dec:function(t){void 0===t&&(t=1);var a=s.resolveHookState(t,l());"number"!=typeof a&&console.error("delta has to be a number or function returning a number, got "+typeof a),e((function(e){return e-a}))},reset:function(t){void 0===t&&(t=n);var a=s.resolveHookState(t,l());"number"!=typeof a&&console.error("value has to be a number or function returning a number, got "+typeof a),n=a,e(a)}}}),[n,a,t])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(223)),s=a(301);t.default=function(e){var t=i.useRef(s.resolveHookState(e)),a=r.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=s.resolveHookState(e,t.current),a()}]}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=!0);var a=n.useState(!1),i=a[0],r=a[1];return n.useEffect((function(){var a=function(){return r(!0)},n=function(){return r(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",a),e.current.addEventListener("mouseout",n));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",a),i.removeEventListener("mouseout",n))}}),[t,e]),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(302)),s=function(){};t.default=function(e,t,a,n){void 0===t&&(t=s),void 0===a&&(a={}),void 0===n&&(n=[e]);var o=a.event,l=void 0===o?"keydown":o,c=a.target,u=a.options,d=i.useMemo((function(){var a,n="function"==typeof(a=e)?a:"string"==typeof a?function(e){return e.key===a}:a?function(){return!0}:function(){return!1};return function(e){if(n(e))return t(e)}}),n);r.default(l,d,c,u)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(504));t.default=function(e){var t=i.useState([!1,null]),a=t[0],n=t[1];return r.default(e,(function(e){return n([!0,e])}),{event:"keydown"},[a]),r.default(e,(function(e){return n([!1,e])}),{event:"keyup"},[a]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){var t=n.useRef(e);return t.current=e,t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){n.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(223)),s=a(301);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(s.resolveHookState(e)),a=r.default(),n=i.useMemo((function(){var i={set:function(e){t.current=s.resolveHookState(e,t.current),a()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&n.set((function(t){return t.concat(e)}))},updateAt:function(e,t){n.set((function(a){var n=a.slice();return n[e]=t,n}))},insertAt:function(e,t){n.set((function(a){var n=a.slice();return e>n.length?n[e]=t:n.splice(e,0,t),n}))},update:function(e,t){n.set((function(a){return a.map((function(a){return e(a,t)?t:a}))}))},updateFirst:function(e,a){var i=t.current.findIndex((function(t){return e(t,a)}));i>=0&&n.updateAt(i,a)},upsert:function(e,a){var i=t.current.findIndex((function(t){return e(t,a)}));i>=0?n.updateAt(i,a):n.push(a)},sort:function(e){n.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){n.set((function(a){return a.slice().filter(e,t)}))},removeAt:function(e){n.set((function(t){var a=t.slice();return a.splice(e,1),a}))},clear:function(){n.set([])},reset:function(){n.set(s.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,n]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(256));t.default=function(e){n.default((function(){e()}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(257));t.default=function(e){var t=r.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),a=t[0],n=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var a=e.current.getBoundingClientRect(),i=a.left,r=a.top,s=a.width,o=a.height,l=i+window.pageXOffset,c=r+window.pageYOffset,u=t.pageX-l,d=t.pageY-c;n({docX:t.pageX,docY:t.pageY,posX:l,posY:c,elX:u,elY:d,elH:o,elW:s})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(40));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var a=i.useState(0),n=a[0],s=a[1];return r.default((function(){var a,n,i,r=function(){var t=Math.min(1,(Date.now()-i)/e);s(t),o()},o=function(){a=requestAnimationFrame(r)},l=setTimeout((function(){n=setTimeout((function(){cancelAnimationFrame(a),s(1)}),e),i=Date.now(),o()}),t);return function(){clearTimeout(n),clearTimeout(l),cancelAnimationFrame(a)}}),[e,t]),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=parseInt(i.version.substr(0,i.version.indexOf(".")))>15,s=function(e){return"function"==typeof e};t.default=function(e,t){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];var l=e.render,c=e.children,u=void 0===c?l:c,d=e.component,p=e.comp,m=void 0===p?d:p;return s(u)?u.apply(void 0,n.__spreadArrays([t],a)):m?i.createElement(m,t):u instanceof Array?r?u:i.createElement.apply(void 0,n.__spreadArrays(["div",null],u)):u&&u instanceof Object?"string"==typeof u.type?u:i.cloneElement(u,Object.assign({},u.props,t)):u||null}},function(e,t,a){!function(e){"use strict";var t,a=[],n="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var i,r=function(e){return Object.freeze(e)},s=function(e,t){this.inlineSize=e,this.blockSize=t,r(this)},o=function(){function e(e,t,a,n){return this.x=e,this.y=t,this.width=a,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,r(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},c=function(e){if(l(e)){var t=e.getBBox(),a=t.width,n=t.height;return!a&&!n}var i=e,r=i.offsetWidth,s=i.offsetHeight;return!(r||s||e.getClientRects().length)},u=function(e){var t;if(e instanceof Element)return!0;var a=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(a&&e instanceof a.Element)},d="undefined"!=typeof window?window:{},p=new WeakMap,m=/auto|scroll/,f=/^tb|vertical/,b=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),g=function(e){return parseFloat(e||"0")},y=function(e,t,a){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===a&&(a=!1),new s((a?t:e)||0,(a?e:t)||0)},h=r({devicePixelContentBoxSize:y(),borderBoxSize:y(),contentBoxSize:y(),contentRect:new o(0,0,0,0)}),v=function(e,t){if(void 0===t&&(t=!1),p.has(e)&&!t)return p.get(e);if(c(e))return p.set(e,h),h;var a=getComputedStyle(e),n=l(e)&&e.ownerSVGElement&&e.getBBox(),i=!b&&"border-box"===a.boxSizing,s=f.test(a.writingMode||""),u=!n&&m.test(a.overflowY||""),d=!n&&m.test(a.overflowX||""),v=n?0:g(a.paddingTop),E=n?0:g(a.paddingRight),x=n?0:g(a.paddingBottom),j=n?0:g(a.paddingLeft),S=n?0:g(a.borderTopWidth),O=n?0:g(a.borderRightWidth),k=n?0:g(a.borderBottomWidth),w=j+E,T=v+x,I=(n?0:g(a.borderLeftWidth))+O,C=S+k,M=d?e.offsetHeight-C-e.clientHeight:0,_=u?e.offsetWidth-I-e.clientWidth:0,A=i?w+I:0,F=i?T+C:0,P=n?n.width:g(a.width)-A-_,D=n?n.height:g(a.height)-F-M,N=P+w+_+I,R=D+T+M+C,L=r({devicePixelContentBoxSize:y(Math.round(P*devicePixelRatio),Math.round(D*devicePixelRatio),s),borderBoxSize:y(N,R,s),contentBoxSize:y(P,D,s),contentRect:new o(j,v,P,D)});return p.set(e,L),L},E=function(e,a,n){var i=v(e,n),r=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(a){case t.DEVICE_PIXEL_CONTENT_BOX:return o;case t.BORDER_BOX:return r;default:return s}},x=function(e){var t=v(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=r([t.borderBoxSize]),this.contentBoxSize=r([t.contentBoxSize]),this.devicePixelContentBoxSize=r([t.devicePixelContentBoxSize])},j=function(e){if(c(e))return 1/0;for(var t=0,a=e.parentNode;a;)t+=1,a=a.parentNode;return t},S=function(){var e=1/0,t=[];a.forEach((function(a){if(0!==a.activeTargets.length){var n=[];a.activeTargets.forEach((function(t){var a=new x(t.target),i=j(t.target);n.push(a),t.lastReportedSize=E(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){a.callback.call(a.observer,n,a.observer)})),a.activeTargets.splice(0,a.activeTargets.length)}}));for(var n=0,i=t;n<i.length;n++)(0,i[n])();return e},O=function(e){a.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(a){a.isActive()&&(j(a.target)>e?t.activeTargets.push(a):t.skippedTargets.push(a))}))}))},k=function(){var e,t=0;for(O(t);a.some((function(e){return e.activeTargets.length>0}));)t=S(),O(t);return a.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:n}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=n),window.dispatchEvent(e)),t>0},w=[],T=function(e){if(!i){var t=0,a=document.createTextNode("");new MutationObserver((function(){return w.splice(0).forEach((function(e){return e()}))})).observe(a,{characterData:!0}),i=function(){a.textContent="".concat(t?t--:t++)}}w.push(e),i()},I=0,C={attributes:!0,characterData:!0,childList:!0,subtree:!0},M=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],_=function(e){return void 0===e&&(e=0),Date.now()+e},A=!1,F=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,a=this;if(void 0===e&&(e=250),!A){A=!0;var n=_(e);t=function(){var t=!1;try{t=k()}finally{if(A=!1,e=n-_(),!I)return;t?a.run(1e3):e>0?a.run(e):a.start()}},T((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,C)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),M.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),M.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),P=function(e){!I&&e>0&&F.start(),!(I+=e)&&F.stop()},D=function(){function e(e,a){this.target=e,this.observedBox=a||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=E(this.target,this.observedBox,!0);return e=this.target,!l(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),N=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},R=new WeakMap,L=function(e,t){for(var a=0;a<e.length;a+=1)if(e[a].target===t)return a;return-1},B=function(){function e(){}return e.connect=function(e,t){var a=new N(e,t);R.set(e,a)},e.observe=function(e,t,n){var i=R.get(e),r=0===i.observationTargets.length;L(i.observationTargets,t)<0&&(r&&a.push(i),i.observationTargets.push(new D(t,n&&n.box)),P(1),F.schedule())},e.unobserve=function(e,t){var n=R.get(e),i=L(n.observationTargets,t),r=1===n.observationTargets.length;i>=0&&(r&&a.splice(a.indexOf(n),1),n.observationTargets.splice(i,1),P(-1))},e.disconnect=function(e){var t=this,a=R.get(e);a.observationTargets.slice().forEach((function(a){return t.unobserve(e,a.target)})),a.activeTargets.splice(0,a.activeTargets.length)},e}(),z=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");B.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");B.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");B.unobserve(this,e)},e.prototype.disconnect=function(){B.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=z,e.ResizeObserverEntry=x,e.ResizeObserverSize=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t){const a=/^[0-9]+$/,n=(e,t)=>{const n=a.test(e),i=a.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(145);const l=s.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.f,o.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const c=i.a.memo(l);c.displayName="ProviderContainer"},function(e,t,a){"use strict";a.d(t,"n",(function(){return i})),a.d(t,"o",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"m",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"l",(function(){return f})),a.d(t,"i",(function(){return b})),a.d(t,"k",(function(){return g})),a.d(t,"f",(function(){return y})),a.d(t,"e",(function(){return h}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),r=n.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),s=n.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=n.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=n.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),c=n.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),u=n.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=n.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),p=n.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),m=n.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=n.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),b=n.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),g=n.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),y=n.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),h=n.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,a){"use strict";e.exports=a(869)},function(e,t,a){"use strict";e.exports=a(871)},function(e,t,a){"use strict";e.exports=a(872)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.assistant.conversations.timelineConversationTitle",{defaultMessage:"Timeline"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),r=n.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),s=n.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=n.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),i=a(4),r=a(469),s=a(121),o=a(112),l=a(128),c=a(116),u=a(202),d=a(190);const p=({applyGlobalQueriesAndFilters:e=!0,extraOptions:t,getLensAttributes:a,lensAttributes:p,scopeId:m=c.SourcererScopeName.default,stackByField:f,title:b})=>{var g,y;const{selectedPatterns:h,dataViewId:v,indicesExist:E}=Object(s.d)(m),x=Object(n.useMemo)((()=>l.d.globalQuerySelector()),[]),j=Object(n.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),S=Object(o.a)(x),O=Object(o.a)(j),[{detailName:k,pageName:w,tabName:T}]=Object(u.a)(),I=Object(n.useMemo)((()=>T===r.a.events?w===i.yc.network?d.h:Object(d.b)(w):[]),[w,T]),C=Object(n.useMemo)((()=>[i.yc.hosts,i.yc.users].indexOf(w)>=0&&null!=k?Object(d.c)(w,k):i.yc.network===w?Object(d.e)(k):[]),[k,w]),M=Object(n.useMemo)((()=>null!=p?p:a&&f&&a(f,t)),[t,a,p,f]),_=Object.values(null!==(g=null==M||null===(y=M.state)||void 0===y?void 0:y.adHocDataViews)&&void 0!==g?g:{}).length>0,A=Object(n.useMemo)((()=>{var t;if(null==p&&(null==a||null==f||0===(null==f?void 0:f.length)))return null;const n=_?[]:Object(d.d)(h);return{...M,...null!=b?{title:b}:{},state:{...M.state,...e?{query:S}:{},filters:[...M.state.filters,...C,...I,...n,...e?O:[]]},references:null==M||null===(t=M.references)||void 0===t?void 0:t.map((e=>({...e,id:v})))}}),[e,M,v,O,a,_,p,C,S,h,f,I,b]);return _||!_&&E?A:null}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a(68),r=a(39),s=a(110),o=a(198);const l=({onAddToCaseClicked:e,lensAttributes:t,timeRange:a})=>{const{cases:l}=Object(s.i)().services,c=l.helpers.canUseCases([r.APP_ID]),u=Object(n.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:a},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[t,a]),d=l.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:o.b}});return{onAddToExistingCaseClicked:Object(n.useCallback)((()=>{e&&e(),d.open({getAttachments:()=>u})}),[u,e,d]),disabled:null==t||null==a||!c.create||!c.read}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a(68),r=a(39),s=a(110),o=a(198);const l=({onClick:e,timeRange:t,lensAttributes:a})=>{const{cases:l}=Object(s.i)().services,c=l.helpers.canUseCases([r.APP_ID]),u=Object(n.useMemo)((()=>[{persistableStateAttachmentState:{attributes:a,timeRange:t},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[a,t]),d=l.hooks.useCasesAddToNewCaseFlyout({toastContent:o.b});return{onAddToNewCaseClicked:Object(n.useCallback)((()=>{e&&e(),d.open({attachments:u})}),[u,d,e]),disabled:null==a||null==t||!c.create||!c.read}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(17),s=a(44);const o=a.n(s)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tb0fg5-0"})(["flex:1;"]),l=()=>i.a.createElement(o,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),c=i.a.memo(l)},function(e,t,a){"use strict";var n=a(305);a.d(t,"b",(function(){return n.b})),a.d(t,"a",(function(){return n.a}))},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(185);const i=(e,t)=>`/name/${e}${Object(n.a)(t)}`,r=(e,t,a)=>`/name/${e}/${t}${Object(n.a)(a)}`,s=(e,t)=>`/${e}${Object(n.a)(t)}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(17),i=a(44),r=a.n(i),s=a(2),o=a.n(s),l=a(432),c=a(398),u=a(399);const d=r()(n.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-12zc7xr-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),p=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-12zc7xr-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),m=o.a.forwardRef((({"aria-label":e=u.c,"data-test-subj":t,isDisabled:a=!1,onSelect:i,prepend:r=u.d,selected:l,inputRef:d,width:m=400,dropDownoptions:f,useLensCompatibleFields:b},g)=>{const y=Object(s.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),h=Object(s.useMemo)((()=>[{label:l,value:l}]),[l]),v=Object(c.b)(b),E=Object(s.useMemo)((()=>null!=f?f:v()),[f,v]),x=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(p,{width:m},o.a.createElement(n.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:a,placeholder:u.e,prepend:r,ref:g,singleSelection:x,isClearable:!1,sortMatchesBy:"startsWith",options:E,selectedOptions:h,compressed:!0,onChange:y}))}));m.displayName="StackByComboBox"},,,,,function(e,t,a){"use strict";var n=String.fromCharCode;e.exports=n},function(e,t,a){"use strict";var n=a(156),i=a(171),r={tokenize:function(e,t,a){return i(e,(function(e){return null===e||n(e)?t(e):a(e)}),"linePrefix")},partial:!0};e.exports=r},function(e,t,a){"use strict";var n=a(932);e.exports=function(e,t){var a=e[e.length-1];return a&&a[1].type===t?n(a[2].sliceStream(a[1])):0}},function(e,t,a){"use strict";var n=a(288)(/[\dA-Za-z]/);e.exports=n},function(e,t,a){"use strict";a.d(t,"w",(function(){return i})),a.d(t,"r",(function(){return r})),a.d(t,"U",(function(){return s})),a.d(t,"k",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"E",(function(){return u})),a.d(t,"F",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"d",(function(){return g})),a.d(t,"G",(function(){return y})),a.d(t,"H",(function(){return h})),a.d(t,"A",(function(){return v})),a.d(t,"B",(function(){return E})),a.d(t,"x",(function(){return x})),a.d(t,"l",(function(){return j})),a.d(t,"q",(function(){return S})),a.d(t,"s",(function(){return O})),a.d(t,"C",(function(){return k})),a.d(t,"M",(function(){return w})),a.d(t,"P",(function(){return T})),a.d(t,"T",(function(){return I})),a.d(t,"L",(function(){return C})),a.d(t,"o",(function(){return M})),a.d(t,"f",(function(){return _})),a.d(t,"h",(function(){return A})),a.d(t,"g",(function(){return F})),a.d(t,"D",(function(){return P})),a.d(t,"R",(function(){return D})),a.d(t,"t",(function(){return N})),a.d(t,"b",(function(){return R})),a.d(t,"y",(function(){return L})),a.d(t,"z",(function(){return B})),a.d(t,"S",(function(){return z})),a.d(t,"O",(function(){return q})),a.d(t,"Q",(function(){return $})),a.d(t,"N",(function(){return V})),a.d(t,"J",(function(){return U})),a.d(t,"K",(function(){return H})),a.d(t,"I",(function(){return Q})),a.d(t,"v",(function(){return G})),a.d(t,"n",(function(){return W})),a.d(t,"p",(function(){return Z})),a.d(t,"m",(function(){return K}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.overviewTabLabel",{defaultMessage:"Overview"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationGuideTabLabel",{defaultMessage:"Investigation guide"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.updatesTabLabel",{defaultMessage:"Updates"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dismissButtonLabel",{defaultMessage:"Dismiss"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.aboutSectionLabel",{defaultMessage:"About"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.definitionSectionLabel",{defaultMessage:"Definition"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.scheduleSectionLabel",{defaultMessage:"Schedule"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.setupGuideSectionLabel",{defaultMessage:"Setup guide"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.nameFieldLabel",{defaultMessage:"Name"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.descriptionFieldLabel",{defaultMessage:"Description"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.authorFieldLabel",{defaultMessage:"Author"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldLabel",{defaultMessage:"Building block"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityFieldLabel",{defaultMessage:"Severity"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityMappingFieldLabel",{defaultMessage:"Severity override"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreFieldLabel",{defaultMessage:"Risk score"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreMappingFieldLabel",{defaultMessage:"Risk score override"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.referencesFieldLabel",{defaultMessage:"Reference URLs"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.falsePositivesFieldLabel",{defaultMessage:"False positive examples"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationFieldsFieldLabel",{defaultMessage:"Custom highlighted fields"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.licenseFieldLabel",{defaultMessage:"License"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleNameOverrideFieldLabel",{defaultMessage:"Rule name override"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFieldLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),T=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndicatorPathFieldLabel",{defaultMessage:"Indicator prefix override"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timestampOverrideFieldLabel",{defaultMessage:"Timestamp override"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.tagsFieldLabel",{defaultMessage:"Tags"}),M=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.indexFieldLabel",{defaultMessage:"Index patterns"}),_=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIdFieldLabel",{defaultMessage:"Data view ID"}),A=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFieldLabel",{defaultMessage:"Data view index pattern"}),F=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFetchErrorMessage",{defaultMessage:"Could not load data view index pattern"}),P=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleTypeFieldLabel",{defaultMessage:"Rule type"}),D=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.thresholdFieldLabel",{defaultMessage:"Threshold"}),N=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.machineLearningJobIdFieldLabel",{defaultMessage:"Machine Learning job"}),R=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.anomalyThresholdFieldLabel",{defaultMessage:"Anomaly score threshold"}),L=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.relatedIntegrationsFieldLabel",{defaultMessage:"Related integrations"}),B=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.requiredFieldsFieldLabel",{defaultMessage:"Required fields"}),z=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timelineTitleFieldLabel",{defaultMessage:"Timeline template"}),q=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndexFieldLabel",{defaultMessage:"Indicator index patterns"}),$=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatMappingFieldLabel",{defaultMessage:"Indicator mapping"}),V=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFiltersFieldLabel",{defaultMessage:"Indicator filters"}),U=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsByFieldLabel",{defaultMessage:"Suppress alerts by"}),H=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsForFieldLabel",{defaultMessage:"Suppress alerts for"}),Q=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressionFieldMissingFieldLabel",{defaultMessage:"If a suppression field is missing"}),G=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.newTermsFieldsFieldLabel",{defaultMessage:"Fields"}),W=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.historyWindowSizeFieldLabel",{defaultMessage:"History Window Size"}),Z=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.intervalFieldLabel",{defaultMessage:"Runs every"}),K=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.fromFieldLabel",{defaultMessage:"Additional look-back time"})},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>n(e,t,a)>0},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>n(e,t,a)>=0},function(e,t,a){const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],a=e.match(t);if(!a)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==a[1]?a[1]:"","="===this.operator&&(this.operator=""),a[2]?this.semver=new c(a[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,t).test(this.value):""===e.operator?""===e.value||new u(this.value,t).test(e.semver):!((t=i(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(o(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(o(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=Comparator;const i=a(412),{safeRe:r,t:s}=a(316),o=a(948),l=a(314),c=a(173),u=a(217)},function(e,t,a){const n=a(217);e.exports=(e,t,a)=>{try{t=new n(t,a)}catch(e){return!1}return t.test(e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return Ie})),a.d(t,"c",(function(){return Ce})),a.d(t,"b",(function(){return Me})),a.d(t,"d",(function(){return _e}));var n=a(17),i=a(747),r=a(378),s=a(2),o=a.n(s),l=a(9),c=a(47),u=a(5),d=a(23),p=a.n(d);const m=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:i},fieldState:{error:l}}=Object(r.useController)({name:"label",defaultValue:""}),c=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return o.a.createElement(n.EuiFormRow,{label:u.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:c,fullWidth:!0},o.a.createElement(n.EuiFieldText,p()({isInvalid:c,onChange:t,value:a,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=o.a.memo(m),b=u.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),g=()=>o.a.createElement(n.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,b),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(n.EuiCode,null,"osquery")}}))});var y=a(110);const h=({node:e,onSave:t,onCancel:a})=>{var i,d,p;const m=null!=e,{osquery:b,application:{capabilities:{osquery:h}}}=Object(y.i)().services,v=Object(r.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(p=e.configuration)||void 0===p?void 0:p.ecs_mapping}}),E=Object(s.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),x=Object(s.useMemo)((()=>!(h.runSavedQueries&&h.readSavedQueries||h.writeLiveQueries)),[h.readSavedQueries,h.runSavedQueries,h.writeLiveQueries]),j=Object(s.useMemo)((()=>{if(null!=b&&b.LiveQueryField){const{LiveQueryField:e}=b;return o.a.createElement(r.FormProvider,v,o.a.createElement(f,null),o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:v}))}return null}),[v,b]);return x?o.a.createElement(g,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,o.a.createElement("h1",null,m?o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(n.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,j)),o.a.createElement(n.EuiModalFooter,null,o.a.createElement(n.EuiButtonEmpty,{onClick:a},u.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(n.EuiButton,{onClick:v.handleSubmit(E),fill:!0},m?o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},v=o.a.memo(h),E={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:o.a.createElement("div",null,o.a.createElement(n.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(n.EuiSpacer,{size:"s"})),editor:v};var x=a(411),j=a(44),S=a.n(j),O=a(404),k=a(325),w=a(868),T=a.n(w),I=a(695);const C=S()(n.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var M=a(56),_=a.n(M),A=a(61),F=a.n(A),P=(a(13),a(87)),D=a(53),N=a(117),R=a(54),L=a(122),B=a(172),z=a(559),q=a(121),$=a(116),V=a(113),U=a(153);const H=e=>e===D.FILTERS.EXISTS?U.b:e===D.FILTERS.PHRASES?U.c:U.d,Q={$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},G={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:V.a.default,queryMatch:{field:"",value:"",operator:U.b}},W=e=>{const t={...Q,meta:{...Q.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===D.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===D.FILTERS.PHRASES){var a;let n=JSON.parse(String(e.value));return"number"===e.valueType?n=n.map(Number):"boolean"===e.valueType&&(n=n.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(a=n)||void 0===a?void 0:a.map((t=>({match_phrase:{[e.field]:t}})))}}}}var n;if(e.queryType===D.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(n=e.value)&&void 0!==n?n:""}}};if(e.queryType===D.FILTERS.RANGE){let a,n;try{const t=JSON.parse(String(e.value));a=t.gte,n=t.lt}catch{a="",n=""}const i={gte:a,lt:n};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},Z=({providers:e,alertData:t})=>{const a=Object(s.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(s.useMemo)((()=>a?[]:((e,t)=>e.map((e=>e.reduce(((e,a,n)=>{const{field:i,value:r,excluded:s,queryType:o}=a,{result:c,matchedBrackets:u}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const a=/\{{([^}]+)\}}/g,n=e.match(new RegExp(a));let i=e;n&&t&&Object(l.each)(n,(e=>{const a=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const n=t.find((({field:e})=>e===a));if(n&&n.values){const{values:[t]}=n;i=i.replace(e,t)}}}));const r=new RegExp(a).test(i);return{result:i,skipped:r,matchedBrackets:n}})(r,t),d=!t&&u;if(0===n)return{and:[],enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:c,operator:H(o)}};{const t={enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:c,operator:H(o)}};e.and.push(t)}return e}),G))))(e,t)),[t,e,a]),filters:Object(s.useMemo)((()=>a?((e,t)=>{const a=[];for(let t=0;t<e.length;t++){const n=e[t];if(n.length>1){const e=n.map((e=>W(e))),t={$state:{store:D.FilterStateStore.APP_STATE},meta:{type:D.FILTERS.COMBINED,relation:D.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};a.push(t)}else{const e=n[0],t=W(e);a.push(t)}}return a})(e):[]),[a,e,t])}};var K=a(379),J=a(281),Y=a(4);const X=e=>{var t,a,n,i,r,s;const o=null!==(t=null===(a=e.meta)||void 0===a?void 0:a.key)&&void 0!==t?t:"",l={field:o,excluded:null!==(n=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==n&&n,queryType:null!==(r=null===(s=e.meta)||void 0===s?void 0:s.type)&&void 0!==r?r:D.FILTERS.PHRASE};if(Object(D.isRangeFilter)(e)){var c;const{gte:t,lt:a}=e.query.range[o],n=JSON.stringify({gte:t,lt:a});return{...l,value:n,queryType:null!==(c=e.meta.type)&&void 0!==c?c:D.FILTERS.RANGE}}if(Object(D.isPhrasesFilter)(e)){var u,d,p,m;const t=typeof(null===(u=e.meta)||void 0===u?void 0:u.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(p=e.meta)||void 0===p?void 0:p.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(m=e.meta.type)&&void 0!==m?m:D.FILTERS.PHRASES}}var f;if(Object(D.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:D.FILTERS.EXISTS};if(Object(D.isPhraseFilter)(e)){var b,g,y,h,v,E;const t=typeof(null===(b=e.meta)||void 0===b||null===(g=b.params)||void 0===g?void 0:g.query);return{...l,value:null!==(y=null===(h=e.meta)||void 0===h||null===(v=h.params)||void 0===v?void 0:v.query)&&void 0!==y?y:"",valueType:t,queryType:null!==(E=e.meta.type)&&void 0!==E?E:D.FILTERS.PHRASE}}return{...l,value:"",queryType:D.FILTERS.PHRASE}},ee=e=>e.map((e=>X(e))),te=e=>!1===e.some(D.isCombinedFilter)?[ee(e)]:e.reduce(((e,t)=>{if(Object(D.isCombinedFilter)(t)){const a=t.meta.params;if(t.meta.relation===D.BooleanRelation.OR){const t=a.map((e=>{const t=te([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=te(a);return[...e,...t]}}return[...e,[X(t)]]}),[]);var ae=a(18),ne=a(65),ie=a.n(ne),re=a(591),se=a.n(re),oe=a(328);function le(e,t,a){var n;if(void 0===t||"undefined"===a)return!1;switch(e.type){case"date":const a="string"==typeof t?ie.a.parse(t):null;return Boolean("string"==typeof t&&a&&a.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new R.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(n=e.esTypes)&&void 0!==n&&n.includes(oe.a.VERSION)?Boolean(se()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const ce=u.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),ue=u.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),de=u.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),pe=u.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),me=u.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),fe=u.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),be=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),ge=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ye=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),he=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),ve=u.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),Ee=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"}),xe="!{investigate",je=({label:e,description:t,providers:a,relativeFrom:i,relativeTo:r})=>{const{addError:l}=Object(N.a)();let c=[];try{void 0!==a&&(c=JSON.parse(a))}catch(e){l(e,{title:Ee})}const{data:u,timestamp:d}=Object(s.useContext)(O.a),{dataProviders:p,filters:m}=Z({providers:c,alertData:u}),f=Object(s.useMemo)((()=>{if(i&&r){const e=d?_()(d):_()();return{kind:"absolute",from:Object(J.e)(i,J.a,!1,_.a,e.toDate()).toISOString(),to:Object(J.e)(r,J.b,!0,_.a,e.toDate()).toISOString()}}return null}),[i,r,d]),{totalCount:b,isQueryLoading:g,oldestTimestamp:h,hasError:v}=(({dataProviders:e,filters:t,relativeTimerange:a})=>{const{uiSettings:n}=Object(y.i)().services,i=Object(s.useMemo)((()=>Object(R.getEsQueryConfig)(n)),[n]),{browserFields:r,selectedPatterns:o,indexPattern:l,dataViewId:c}=Object(q.d)($.SourcererScopeName.timeline),[u,d]=Object(s.useState)(!1),p=Object(s.useMemo)((()=>{try{if(!1===u)return Object(B.d)({config:i,dataProviders:e,indexPattern:l,browserFields:r,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[r,e,i,u,l,t]),[m,{events:f,totalCount:b}]=Object(z.a)({dataViewId:c,fields:["*"],filterQuery:null==p?void 0:p.filterQuery,id:L.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:{},...a?{startDate:null==a?void 0:a.from,endDate:null==a?void 0:a.to}:{}}),[g]=f,h=g&&g.data&&g.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:m,totalCount:b,oldestTimestamp:h&&h.value&&h.value[0],hasError:u}})({dataProviders:p,filters:m,relativeTimerange:f}),E=Object(s.useMemo)((()=>{if(f)return f;if(null!=h)return{kind:"absolute",from:h,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:a,toStr:n}=Object(J.d)();return{kind:"relative",to:e,from:t,fromStr:a,toStr:n}}}),[h,f]);return g?o.a.createElement(n.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{asEmptyButton:!1,isDisabled:v,dataProviders:p,filters:m,timeRange:E,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(n.EuiIcon,{type:"timeline"}),` ${e} (${F()(b).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},Se=({node:e,onSave:t,onCancel:a})=>{const i=null!=e,{sourcererDataView:u,indexPattern:d}=Object(q.d)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:m}},uiSettings:f,fieldFormats:b}=Object(y.i)().services,g=Object(s.useMemo)((()=>null!=u?new P.DataView({spec:u,fieldFormats:b}):null),[u,b]),[h,v]=Object(s.useState)([[]]),E=Object(s.useMemo)((()=>[{value:"0",text:""},...f.get(Y.W).map((({display:e},t)=>({value:String(t),text:e})))]),[f]),x=Object(r.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),j=Object(r.useController)({name:"label",control:x.control}),S=Object(r.useController)({name:"description",control:x.control}),O=Object(r.useController)({name:"relativeTimerange",control:x.control}),k=Object(s.useCallback)((e=>{const t=E.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),a=f.get(Y.W);return{relativeFrom:a[e].from,relativeTo:a[e].to}}return{}}),[E,f]),w=Object(s.useCallback)((()=>{t(`${xe}${JSON.stringify(Object(l.pickBy)({label:j.field.value,description:S.field.value,providers:h,...k(O.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,h,j.field.value,S.field.value,O.field.value,k]),T=Object(s.useCallback)((e=>{v(te(e))}),[]),I=Object(s.useCallback)((e=>{O.field.onChange(e.target.value)}),[O.field]),C=Object(s.useMemo)((()=>{var e;const t=null!==(e=j.field.value)&&void 0!==e?e:"",a=h.flat();return""===t.trim()||0===a.length||a.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return le(t,e.value,e.valueType);case"phrases":const a="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(a)||!a.length)&&a.every((a=>le(t,a,e.valueType)));case"range":const n=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof n&&(!n.gte||le(t,n.gte,e.valueType))&&(!n.lt||le(t,n.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==g?void 0:g.getFieldByName(e.field))))}),[j.field.value,h,g]),M=Object(s.useMemo)((()=>{const e=d&&d.getName?d.getName():"*";return[{$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[d]),_=Object(ae.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(we,null,o.a.createElement(n.EuiModalHeaderTitle,null,o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,null,i?o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===_&&o.a.createElement(n.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(n.EuiModalBody,null,o.a.createElement(r.FormProvider,x,o.a.createElement(n.EuiForm,{fullWidth:!0},o.a.createElement(n.EuiFormRow,{label:fe,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(n.EuiFormRow,{label:ce,helpText:de,isInvalid:void 0!==j.field.value&&0===j.field.value.trim().length,fullWidth:!0},o.a.createElement(n.EuiFieldText,p()({},x.register("label"),{ref:null,name:"label",onChange:j.field.onChange}))),o.a.createElement(n.EuiFormRow,{label:pe,helpText:me,fullWidth:!0},o.a.createElement(n.EuiFieldText,p()({},x.register("description"),{ref:null,name:"description",onChange:S.field.onChange}))),o.a.createElement(n.EuiFormRow,{label:be,helpText:ge,fullWidth:!0},g?o.a.createElement(m,{filters:M,onChange:T,dataView:g,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(n.EuiFormRow,{label:ye,helpText:he,fullWidth:!0},o.a.createElement(n.EuiSelect,p()({},x.register("relativeTimerange"),{ref:null,onChange:I,options:E})))))),o.a.createElement(n.EuiModalFooter,null,o.a.createElement(n.EuiButtonEmpty,{onClick:a},ve),o.a.createElement(n.EuiButton,{onClick:x.handleSubmit(w),fill:!0,disabled:C},i?o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Oe=o.a.memo(Se),ke=`${xe}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var we=S()(n.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Te=Object(n.getDefaultEuiMarkdownUiPlugins)(),Ie=Object(n.getDefaultEuiMarkdownParsingPlugins)(),Ce=Object(n.getDefaultEuiMarkdownProcessingPlugins)(),Me=[xe],_e=({insightsUpsellingMessage:e})=>{const t=Te.map((e=>e.name)),a=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:ue,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(n.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},ke),o.a.createElement(n.EuiSpacer,{size:"s"})),editor:Oe}))({insightsUpsellingMessage:e});if(!1===t.includes(a.name))Te.push(i.b),Te.push(E),Te.push(a);else{const e=Te.findIndex((e=>e.name===a.name));Te[e]=a}return Te};Ie.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,a=e.prototype.inlineMethods,n=function(e,t,a){if(!1===t.startsWith(xe))return!1;const n=t[xe.length];if("{"!==n&&"}"!==n)return!1;if(a)return!0;let i={};if("{"===n){let a="",n=0;for(let e=xe.length;e<t.length;e++){const i=t[e];if("{"===i)n++,a+=i;else if("}"===i){if(n--,-1===n)break;a+=i}else a+=i}try{return i=JSON.parse(a),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const a=e.now();this.file.fail((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:a.line,column:a.column+xe.length})}}return!1};n.locator=(e,t)=>e.indexOf(xe,t),t.insight=n,a.splice(a.indexOf("text"),0,"insight")})),Ie.push(i.a),Ie.push(x.a),Ce[1][1].components.insight=({label:e,description:t,providers:a,relativeFrom:i,relativeTo:r})=>!1===Object(ae.b)().isPlatinumPlus()?o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`),o.a.createElement("div",null,t)):o.a.createElement(je,{label:e,description:t,providers:a,relativeFrom:i,relativeTo:r}),Ce[1][1].components.timeline=i.c,Ce[1][1].components.osquery=({configuration:e})=>{var t;const[a,n]=Object(s.useState)(!1),{agentId:i,alertId:r,data:c}=Object(s.useContext)(O.a),d=Object(s.useCallback)((()=>n(!0)),[n]),p=Object(s.useCallback)((()=>n(!1)),[n]),m=Object(s.useMemo)((()=>{const e=Object(l.reduce)(c,((e,t)=>{var a;return{...e,[t.field]:null==t||null===(a=t.values)||void 0===a?void 0:a[0]}}),{});return Object(k.a)(e)}),[c]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(C,{iconType:T.a,onClick:d},null!==(t=e.label)&&void 0!==t?t:u.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),a&&o.a.createElement(I.a,{defaultValues:{...r?{alertIds:[r]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:p,ecsData:m}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(5);const c=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),u=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),p=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"}),m=(l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),f=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),b=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"}),g=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),y=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),h=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"}),v=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),E=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"}),x=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),j=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),S=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"}),O=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),k=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"}),w=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),T="primary-panel-id",I="secondary-panel-id";var C=a(13);const M=({appliesTo:e,disabled:t,disableAllow:a=!1,disableAnonymize:r=!1,disableDeny:s=!1,disableUnanonymize:o=!1,onListUpdated:l,onlyDefaults:p,selected:b})=>{const[E,x]=Object(i.useState)(!1),j=Object(n.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),k=Object(i.useCallback)((()=>x(!1)),[]),w=Object(i.useCallback)((()=>x((e=>!e))),[]),M=Object(i.useMemo)((()=>Object(C.jsx)(n.EuiToolTip,{content:"multipleRows"===e?void 0:c},Object(C.jsx)(n.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:w,size:"xs"},"multipleRows"===e?g:null))),[e,t,w]),_=Object(i.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:a,disableUnanonymize:n,closePopover:i,onListUpdated:r,onlyDefaults:s,selected:o})=>{const l=s?T:I,c=s?I:T,p=[s?[]:{icon:"check",name:d,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllow"})));r([...e,...t])}}].flat(),b=[{id:l,title:y,items:[...p,{icon:"cross",name:v,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllow"})));r([...e,...t])}},{icon:"eyeClosed",name:f,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllowReplacement"})));r([...e,...t])}},{icon:"eye",name:O,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllowReplacement"})));r([...e,...t])}}]}],g=[{id:c,items:[{disabled:e,icon:"check",name:u,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"})));r(e)}},{disabled:a,icon:"cross",name:h,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));r(e)}},{disabled:t,icon:"eyeClosed",name:m,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));r(e)}},{disabled:n,icon:"eye",name:S,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));r(e)}},{isSeparator:!0,key:"sep"},{name:y,panel:l}]},...b];return s?b:g})({disableAllow:a,disableAnonymize:r,disableDeny:s,disableUnanonymize:o,closePopover:k,onListUpdated:l,onlyDefaults:p,selected:b})),[k,a,r,s,o,l,p,b]);return Object(C.jsx)(n.EuiPopover,{anchorPosition:"downLeft",button:M,closePopover:k,"data-test-subj":"bulkActions",id:j,isOpen:E,panelPaddingSize:"none"},Object(C.jsx)(n.EuiContextMenu,{initialPanelId:T,panels:_,size:"s"}))},_=r.a.memo(M),A="allowed",F="anonymized",P="field",D=o()(n.EuiButtonEmpty)`
  max-height: 24px;
`;var N=a(388);const R=({onListUpdated:e,onlyDefaults:t,onReset:a,onSelectAll:i,selected:r,totalFields:s})=>Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(r.length))),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:i,size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(s))),Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(_,{appliesTo:"multipleRows",disabled:0===r.length,onListUpdated:e,onlyDefaults:t,selected:r})),null!=a&&Object(C.jsx)(n.EuiFlexItem,{grow:!0},Object(C.jsx)(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbarTrailingActions",gutterSize:"none",justifyContent:"flexEnd"},Object(C.jsx)(n.EuiFlexItem,{grow:!1},Object(C.jsx)(n.EuiButtonEmpty,{"data-test-subj":"resetFields",iconType:"eraser",onClick:a,size:"xs"},j)))));R.displayName="ToolbarComponent";const L=r.a.memo(R),B={sort:{direction:"desc",field:A}},z={box:{incremental:!0},filters:[{field:A,type:"is",name:p},{field:F,type:"is",name:b}]},q=({allow:e,allowReplacement:t,onListUpdated:a,onReset:r,rawData:s,pageSize:o=10})=>{const[l,c]=Object(i.useState)([]),u=Object(i.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>c(e),initialSelected:[]})),[]),d=Object(i.useRef)(null),m=Object(i.useMemo)((()=>(({onListUpdated:e,rawData:t})=>{const a={field:"actions",name:"",render:(a,n)=>Object(C.jsx)(_,{appliesTo:"singleRow",disabled:!1,disableAllow:n.allowed,disableDeny:!n.allowed,disableAnonymize:!n.allowed||n.allowed&&n.anonymized,disableUnanonymize:!n.allowed||n.allowed&&!n.anonymized,onListUpdated:e,onlyDefaults:null==t,selected:[n]}),sortable:!1,width:"36px"},i={field:"rawValues",name:k,render:e=>Object(C.jsx)(n.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},r=[{field:A,name:p,render:(a,{allowed:i,field:r})=>Object(C.jsx)(n.EuiSwitch,{"data-test-subj":"allowed",checked:i,label:"",showLabel:!1,onChange:()=>{e([{field:r,operation:i?"remove":"add",update:null==t?"defaultAllow":"allow"}]),null==t&&i&&e([{field:r,operation:"remove",update:"defaultAllowReplacement"}])}}),sortable:!0,width:"75px"},{field:F,name:b,render:(a,{allowed:i,anonymized:r,field:s})=>Object(C.jsx)(D,{"data-test-subj":"anonymized",disabled:!i,color:r?"primary":"text",flush:"both",iconType:r?"eyeClosed":"eye",isSelected:!!r,onClick:()=>e([{field:s,operation:r?"remove":"add",update:null==t?"defaultAllowReplacement":"allowReplacement"}])},Object(C.jsx)(n.EuiText,{size:"xs"},r?w:x)),sortable:!0,width:"102px"},{field:P,name:E,sortable:!0,width:"260px"}];return null==t?[...r,a]:[...r,i,a]})({onListUpdated:a,rawData:s})),[a,s]),f=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:a})=>{const n=new Set(t),i=new Set(e);return null!==a&&"object"==typeof a?Object.keys(a).sort().reduce(((e,t)=>[...e,{field:t,allowed:Object(N.a)({allowSet:i,field:t}),anonymized:Object(N.b)({allowReplacementSet:n,field:t}),denied:Object(N.c)({allowSet:i,field:t}),rawValues:a[t]}]),[]):e.sort().reduce(((e,t)=>[...e,{field:t,allowed:!0,anonymized:n.has(t),denied:!1,rawValues:[]}]),[])})({allow:e,allowReplacement:t,rawData:s})),[e,t,s]),g=Object(i.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.setSelection(f),setTimeout((()=>c(f)),0)}),[f]),y=Object(i.useMemo)((()=>({initialPageSize:o,pageSizeOptions:[5,10,25,50]})),[o]),h=Object(i.useMemo)((()=>Object(C.jsx)(L,{onListUpdated:a,onlyDefaults:null==s,onReset:r,onSelectAll:g,selected:l,totalFields:f.length})),[a,r,g,s,f.length,l]);return Object(C.jsx)(n.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:h,columns:m,compressed:!0,"data-test-subj":"contextEditor",isSelectable:!0,itemId:P,items:f,pagination:y,ref:d,search:z,selection:u,sorting:B})};q.displayName="ContextEditorComponent";const $=r.a.memo(q)},function(e,t,a){"use strict";a.d(t,"a",(function(){return W})),a.d(t,"c",(function(){return K})),a.d(t,"b",(function(){return ee}));var n=a(23),i=a.n(n),r=a(17),s=a(114),o=a(2),l=a.n(o),c=a(82),u=a(48),d=a(44),p=a.n(d),m=a(124),f=a(195),b=a(291),g=a(439),y=a(666),h=a(174),v=a(515),E=a(710),x=a(689),j=a(5),S=a(66),O=a(122),k=a(9),w=a(19),T=a(127),I=a(118),C=a(110),M=a(758),_=a(116),A=a(121),F=a(754);const P=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`;var D=a(318);const N=l.a.memo((({className:e,Component:t,enablePopOver:a,field:n,flush:i,iconSide:s,iconType:c,isExpandable:u,onClick:d,onFilterAdded:p,ownFocus:m,paddingSize:f,showLegend:b,showTooltip:g=!0,showTopN:y,scopeId:h,title:v,value:E,globalFilters:x})=>{const S=Object(T.isActiveTimeline)(null!=h?h:"")?_.SourcererScopeName.timeline:null!=h&&Object(D.c)(h)?_.SourcererScopeName.detections:_.SourcererScopeName.default,{browserFields:O,indexPattern:k}=Object(A.d)(S),w=null!=c?c:"visBarVertical",I=null!=s?s:"left",C=null!=v?v:(N=n,j.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:N},defaultMessage:"Show top {fieldName}"}));var N;const R=Object(o.useMemo)((()=>t?l.a.createElement(t,{"aria-label":C,className:e,"data-test-subj":"show-top-field",icon:w,iconType:w,iconSide:I,flush:i,onClick:d,title:C},C):l.a.createElement(r.EuiButtonIcon,{"aria-label":C,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:w,onClick:d})),[t,C,e,i,w,d,I]),L=Object(o.useMemo)((()=>g&&!y?l.a.createElement(r.EuiToolTip,{content:l.a.createElement(F.a,{additionalScreenReaderOnlyContext:P({field:n,value:E}),content:C,shortcut:"t",showShortcut:m})},R):R),[R,C,n,m,g,y,E]),B=Object(o.useMemo)((()=>l.a.createElement(M.a,{browserFields:O,field:n,indexPattern:k,onFilterAdded:p,paddingSize:f,showLegend:b,scopeId:null!=h?h:void 0,toggleTopN:d,globalFilters:x})),[O,n,k,p,f,b,h,d,x]);return u?l.a.createElement(l.a.Fragment,null,R,y&&B):y?a?l.a.createElement(r.EuiPopover,{button:R,isOpen:y,closePopover:d,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},B):B:L}));N.displayName="ShowTopNButton";var R=a(14),L=a(112),B=a(129);const z=p.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-hbiy4s-0"})(["padding:2px;"]);z.displayName="AdditionalContent";const q=p.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-hbiy4s-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),$=p()(q).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-hbiy4s-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),V=({ownFocus:e,showTopN:t})=>!t&&!e,U=l.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:a,dataProvider:n,dataType:i,draggableId:s,enableOverflowButton:c=!1,applyWidthAndPadding:d=!0,field:p,fieldType:m,isAggregatable:f,goGetTimelineId:b,isObjectArray:g,hideAddToTimeline:y=!1,hideTopN:v=!1,onFilterAdded:E,ownFocus:x,showOwnFocus:M=!0,showTopN:_,scopeId:A,toggleColumn:F,toggleTopN:P,values:D})=>{const[U,H]=Object(o.useState)(),[Q,G]=Object(o.useState)(!1),[W,Z]=Object(o.useState)(!1),K=Object(o.useCallback)((()=>{G((e=>!e)),Z(!W)}),[W,Z]),J=Object(o.useCallback)((()=>{a&&a(),G(!1),Z(!1),t&&t()}),[t,a]),Y=Object(o.useRef)(!0),X=Object(o.useRef)(null);Object(o.useEffect)((()=>{Y.current&&null!=b&&null==A&&(Y.current=!1,b(!0))}),[b,A]),Object(o.useEffect)((()=>{x&&setTimeout((()=>{var e;null===(e=X.current)||void 0===e||e.focus()}),0)}),[x]);const ee=Object(o.useCallback)((e=>{if(x)switch(e.key){case"t":Object(S.stopPropagationAndPreventDefault)(e),P();break;case"Enter":break;case"Escape":Object(S.stopPropagationAndPreventDefault)(e);break;default:H(e)}}),[x,P]),te=A===O.c.casePage,ae=A===O.c.active,ne=A===B.a.entityAnalytics,ie=Object(o.useMemo)((()=>ne&&!ae),[ae,ne]),re=Object(o.useMemo)((()=>(v?1:0)+(ie?2:0)),[ie,v]),{overflowActionItems:se,allActionItems:oe}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:a,draggableId:n,enableOverflowButton:i,field:s,fieldType:c,isAggregatable:d,handleHoverActionClicked:p,hideFilters:m,hideTopN:f,hideAddToTimeline:b,isCaseView:g,isObjectArray:y,isOverflowPopoverOpen:v,itemsToShow:E=2,onFilterAdded:x,onOverflowButtonClick:j,ownFocus:S,showTopN:M,stKeyboardEvent:_,scopeId:A,toggleColumn:F,toggleTopN:P,values:D})=>{const B=Object(C.i)(),z=Object(u.useDispatch)(),{timelines:q,uiSettings:$}=B.services,{getAddToTimelineButton:V,getColumnToggleButton:U,getCopyButton:H,getFilterForValueButton:Q,getFilterOutValueButton:G,getOverflowButton:W}=q.getHoverActions(),Z=Object(o.useMemo)((()=>B.services.data.query.filterManager),[B.services.data.query.filterManager]),K=Object(o.useMemo)((()=>I.b.getTimelineByIdSelector()),[]),J=Object(L.a)((e=>{var t;return Object(T.isActiveTimeline)(null!=A?A:"")?null===(t=K(e,null!=A?A:""))||void 0===t?void 0:t.filterManager:void 0})),Y=Object(o.useMemo)((()=>Object(T.isActiveTimeline)(null!=A?A:"")?null!=J?J:new w.FilterManager($):Z),[A,J,$,Z]),X=Object(o.useCallback)((()=>{e&&!Object(k.isEmpty)(e)&&z(Object(R.addProvider)({id:O.c.active,providers:e instanceof Array?e:[e]}))}),[e,z]),ee=Object(o.useCallback)((()=>{p&&p(),X()}),[p,X]),te=Object(o.useMemo)((()=>!m&&null!=D&&(i||!M&&!i)&&!g),[i,m,g,M,D]),ae=y&&"geo_point"!==s||g,ne=Object(o.useMemo)((()=>l.a.createElement(N,{Component:i?r.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!i&&g,field:s,key:"hover-actions-show-top-n",onClick:P,onFilterAdded:x,ownFocus:S,showTopN:M,showTooltip:!i,scopeId:A,value:D})),[i,g,s,P,x,S,M,A,D]),ie=Object(o.useMemo)((()=>[te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},Q({defaultFocusedButtonRef:a,field:s,filterManager:Y,keyboardEvent:_,onClick:p,onFilterAdded:x,ownFocus:S,showTooltip:!i,value:D})):null,te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},G({field:s,filterManager:Y,keyboardEvent:_,onFilterAdded:x,ownFocus:S,onClick:p,showTooltip:!i,value:D})):null,F&&!ae?l.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:i?r.EuiContextMenuItem:void 0,field:s,isDisabled:y&&"geo_point"!==t,isObjectArray:y,keyboardEvent:_,ownFocus:S,onClick:p,showTooltip:!i,toggleColumn:F,value:D})):null,null==D||null==n&&Object(k.isEmpty)(e)||b?null:l.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},V({Component:i?r.EuiContextMenuItem:void 0,dataProvider:e,draggableId:n,field:s,keyboardEvent:_,ownFocus:S,onClick:ee,showTooltip:!i,value:D})),Object(h.e)({fieldType:c,isAggregatable:d,fieldName:s,hideTopN:f})?ne:null,null!=s?l.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},H({Component:i?r.EuiContextMenuItem:void 0,field:s,isHoverAction:!0,keyboardEvent:_,ownFocus:S,onClick:p,showTooltip:!i,value:D})):null].filter((e=>null!=e))),[e,t,a,n,i,s,c,d,Y,V,U,H,Q,G,p,ee,b,f,y,x,S,ae,te,ne,_,F,D]);return{overflowActionItems:Object(o.useMemo)((()=>[...ie.slice(0,E),...i&&E>0&&E<ie.length?[W({closePopOver:p,field:s,keyboardEvent:_,ownFocus:S,onClick:j,showTooltip:!i,value:D,items:M?[ne]:ie.slice(E),isOverflowPopoverOpen:!!v})]:[]].filter((e=>null!=e))),[ie,i,s,W,p,v,E,j,ne,S,M,_,D]),allActionItems:Object(o.useMemo)((()=>!M||i||g?ie:[ne]),[M,i,g,ne,ie])}})({dataProvider:n,dataType:i,defaultFocusedButtonRef:X,draggableId:s,enableOverflowButton:c&&!te,field:p,fieldType:m,hideFilters:ie,isAggregatable:f,handleHoverActionClicked:J,hideAddToTimeline:y,hideTopN:v,isCaseView:te,isObjectArray:g,isOverflowPopoverOpen:W,onFilterAdded:E,onOverflowButtonClick:K,ownFocus:x,showTopN:_,stKeyboardEvent:U,toggleColumn:F,toggleTopN:P,values:D,scopeId:A}),le=d?$:q;return l.a.createElement(r.EuiFocusTrap,{disabled:V({ownFocus:x,showTopN:_})},l.a.createElement(le,{"data-test-subj":"hover-actions-container",onKeyDown:ee,$showTopN:_,$showOwnFocus:M,$hiddenActionsCount:re,$isActive:Q,className:Q?"hoverActions-active":""},l.a.createElement(r.EuiScreenReaderOnly,null,l.a.createElement("p",null,(ce=p,j.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:ce},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&l.a.createElement(z,null,e),c&&!te?se:oe));var ce}));U.displayName="HoverActions";var H=a(729);const Q=({dataProvider:e,isAggregatable:t,fieldType:a,hideTopN:n,isDraggable:i,onFilterAdded:r,render:s,scopeId:c})=>{const{timelineId:u}=Object(o.useContext)(x.b),{tableId:d}=Object(o.useContext)(H.b),p=Object(o.useRef)(null),m=Object(o.useRef)(null),[f,b]=Object(o.useState)(!1),[g,y]=Object(o.useState)(!1),v=Object(o.useMemo)((()=>c||(null!=u?u:d)),[c,d,u]),E=Object(o.useCallback)((()=>{b((e=>!e)),y((e=>(e&&setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{y(!1)}),0)}),[m]),{closeTopN:j,toggleTopN:S,isShowingTopN:O}=(e=>{const[t,a]=Object(o.useState)(!1),n=Object(o.useCallback)((()=>{a((t=>{const a=!t;return e&&e(a),a}))}),[e]);return{closeTopN:Object(o.useCallback)((()=>{a(!1)}),[]),toggleTopN:n,isShowingTopN:t}})(E),k=Object(o.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t||"boolean"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),w=Object(o.useMemo)((()=>{const o=g&&!O&&(null!==(u=null==(c=p.current)?void 0:c.querySelectorAll(".euiLink"))&&void 0!==u?u:[]).length>0?l.a.createElement(K,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},s(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):null;var c,u;return l.a.createElement(U,{additionalContent:o,closeTopN:j,closePopOver:E,dataProvider:e,draggableId:i?Object(h.l)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:a,hideTopN:n,isObjectArray:!1,onFilterAdded:r,ownFocus:g,showOwnFocus:!1,showTopN:O,scopeId:v,toggleTopN:S,values:k})}),[g,O,e,s,j,E,i,t,a,n,r,v,S,k]),T=Object(o.useCallback)((e=>{p.current=e}),[]),I=Object(o.useCallback)((()=>{var e;g||null===(e=m.current)||void 0===e||e.focus()}),[g,m]),C=Object(o.useCallback)((()=>{j(),g&&(y(!1),setTimeout((()=>{I()}),0))}),[I,g,j]),M=Object(o.useCallback)((()=>{y(!0)}),[]);return Object(o.useMemo)((()=>({closePopOverTrigger:f,handleClosePopOverTrigger:E,hoverActionsOwnFocus:g,hoverContent:w,keyboardHandlerRef:m,onCloseRequested:C,onFocus:I,openPopover:M,setContainerRef:T,isShowingTopN:O})),[f,E,g,w,C,I,M,T,O])};var G=a(694);const W=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);W.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const Z=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));Z.displayName="Wrapper";const K=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),J=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,Y=({dataProvider:e,hideTopN:t=!1,onFilterAdded:a,render:n,fieldType:d="",isAggregatable:p=!1,scopeId:m,truncate:x})=>{const[j,S]=Object(o.useState)(!1),O=e.id.includes(`-${b.a}-`),k=Object(u.useDispatch)(),{closePopOverTrigger:w,handleClosePopOverTrigger:T,hoverActionsOwnFocus:I,hoverContent:C,keyboardHandlerRef:M,onCloseRequested:_,openPopover:A,onFocus:F,setContainerRef:P,isShowingTopN:D}=Q({dataProvider:e,hideTopN:t,onFilterAdded:a,render:n,fieldType:d,isAggregatable:p,scopeId:m,truncate:x}),N=Object(o.useCallback)((()=>{O||(k(f.a.registerProvider({provider:e})),S(!0))}),[O,k,e]),R=Object(o.useCallback)((()=>j&&k(f.a.unRegisterProvider({id:e.id}))),[j,k,e.id]);Object(o.useEffect)((()=>()=>{R()}),[R]);const L=Object(o.useCallback)(((t,a)=>l.a.createElement(te,{registerProvider:N},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:J(t.draggableProps.style,a),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(K,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},n(e,t,a))))),[e,N,n]),B=Object(o.useCallback)(((t,a)=>l.a.createElement(v.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),P(e)},"data-test-subj":"providerContainer",isDragging:a.isDragging,registerProvider:N,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),x&&!a.isDragging?l.a.createElement(g.b,{"data-test-subj":"draggable-truncatable-content"},n(e,t,a)):l.a.createElement(K,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},n(e,t,a)),!a.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,E.b)))),[e,N,n,P,x]),{onBlur:z,onKeyDown:q}=Object(G.a)({closePopover:T,draggableId:Object(h.l)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:M,openPopover:A}),$=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:s.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:F,onBlur:z,onKeyDown:q,ref:M,role:"button",tabIndex:0},l.a.createElement(c.Draggable,{draggableId:Object(h.l)(e.id),index:0,key:Object(h.l)(e.id),isDragDisabled:O},B)),t.placeholder)),[B,e.id,O,M,z,F,q]),V=Object(o.useMemo)((()=>l.a.createElement(Z,{"data-test-subj":"draggableWrapperDiv",disabled:O},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(c.Droppable,{isDropDisabled:!0,droppableId:Object(h.m)(e.id),renderClone:L},$)))),[$,L,e.id,O]),U=Object(o.useCallback)((()=>V),[V]);return O?l.a.createElement(l.a.Fragment,null,V):l.a.createElement(y.a,{alwaysShow:D||I,closePopOverTrigger:w,hoverContent:C,onCloseRequested:_,render:U})},X=({dataProvider:e,hideTopN:t=!1,isDraggable:a=!1,onFilterAdded:n,render:i,isAggregatable:r=!1,fieldType:s="",scopeId:c,truncate:u})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:p,hoverContent:f,onCloseRequested:v,setContainerRef:E,isShowingTopN:x}=Q({dataProvider:e,hideTopN:t,isDraggable:a,isAggregatable:r,fieldType:s,onFilterAdded:n,render:i,scopeId:c,truncate:u}),j=Object(o.useCallback)((()=>l.a.createElement("div",{ref:e=>{E(e)},tabIndex:-1,"data-provider-id":Object(h.l)(e.id)},u?l.a.createElement(g.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(K,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,i,E,u]);return a?l.a.createElement(Y,{dataProvider:e,hideTopN:t,onFilterAdded:n,fieldType:s,isAggregatable:r,render:i,scopeId:c,truncate:u}):l.a.createElement(y.a,{alwaysShow:x||p,closePopOverTrigger:d,hoverContent:(S=c,[m.e.rulePreview,b.a].includes(null!=S?S:"")?void 0:f),onCloseRequested:v,render:j});var S},ee=l.a.memo(X);ee.displayName="DraggableWrapper";const te=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));te.displayName="ConditionalPortal"},function(e,t,a){"use strict";a.d(t,"b",(function(){return n.a})),a.d(t,"a",(function(){return i.a})),a.d(t,"c",(function(){return r.h}));var n=a(423),i=a(584),r=a(150)},function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17),l=a(48),c=a(45);const u=a(5).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var d=a(170),p=a(431),m=a(383),f=a(759),b=a(158),g=a(119),y=a(276),h=a(339),v=a(160),E=a(130),x=a(190),j=a(330),S=a(598),O=a(525);const k=({isInitialLoading:e,barChart:t,configs:a,stackByField:n,scopeId:r})=>e?i.a.createElement(O.a,null):i.a.createElement(S.a,{barChart:t,configs:a,stackByField:n,scopeId:r}),w=i.a.memo(k);k.displayName="MatrixHistogramChartContentComponent";var T=a(347);const I=s()(p.a).withConfig({displayName:"HistogramPanel",componentId:"sc-cnfih-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),C=({chartHeight:e,defaultStackByOption:t,endDate:a,errorMessage:r,filterQuery:s,getLensAttributes:p,headerChildren:S,histogramType:O,hideHistogramIfEmpty:k=!1,id:C,indexNames:M,runtimeMappings:_,isPtrIncluded:A,legendPosition:F,lensAttributes:P,mapping:D,onError:N,paddingSize:R="m",panelHeight:L=300,setAbsoluteRangeDatePickerTarget:B=g.a.global,setQuery:z,showInspectButton:q=!1,showLegend:$,showSpacer:V=!0,stackByOptions:U,startDate:H,subtitle:Q,scopeId:G,sourcererScopeId:W,title:Z,titleSize:K,yTickFormatter:J,skip:Y,hideQueryToggle:X=!1,applyGlobalQueriesAndFilters:ee=!0})=>{const te=`${C}-embeddable`,ae=Object(l.useDispatch)(),ne=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;ae(Object(b.setAbsoluteRangeDatePicker)({id:B,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[ae,B]),ie=Object(n.useMemo)((()=>Object(m.b)({chartHeight:e,from:H,legendPosition:F,to:a,onBrushEnd:ne,yTickFormatter:J,showLegend:$})),[e,H,F,a,ne,J,$]),[re,se]=Object(n.useState)(!0),[oe,le]=Object(n.useState)(t);Object(n.useEffect)((()=>{le(t)}),[t]);const ce=Object(n.useCallback)((e=>{var a;le(null!==(a=U.find((t=>t.value===e.target.value)))&&void 0!==a?a:t)}),[t,U]),{toggleStatus:ue,setToggleStatus:de}=Object(v.a)(C),[pe,me]=Object(n.useState)(Y||!ue);Object(n.useEffect)((()=>{me(Y||!ue)}),[Y,ue]);const fe=Object(n.useCallback)((e=>{de(e),me(!e)}),[me,de]),be=Object(E.a)("chartEmbeddablesEnabled"),ge={endDate:a,errorMessage:r,filterQuery:s,histogramType:O,indexNames:M,onError:N,startDate:H,stackByField:oe.value,runtimeMappings:_,isPtrIncluded:A,skip:pe||be},[ye,{data:he,inspect:ve,totalCount:Ee,refetch:xe}]=Object(f.a)(ge),je=Object(n.useMemo)((()=>null!=Z&&"function"==typeof Z?Z(oe):Z),[Z,oe]),Se=Object(T.a)({visualizationId:te}),Oe=Object(n.useMemo)((()=>{if(re)return null;if("function"==typeof Q){if(be){if(!Se||(e=Se[0],!Object.values(null!==(t=e.aggregations)&&void 0!==t?t:{}).some((({buckets:e})=>e.length>0))))return Q(0);const a=Se[0].hits.total;return a>=0?Q(a):null}return Ee>=0?Q(Ee):null}var e,t;return Q}),[be,re,Q,Ee,Se]),ke=Object(n.useMemo)((()=>!!(Ee<=0&&k)),[Ee,k]),we=Object(n.useMemo)((()=>Object(m.c)(he,D)),[he,D]);Object(n.useEffect)((()=>{ye||re||z({id:C,inspect:ve,loading:ye,refetch:xe}),re&&we&&he&&se(!1)}),[we,he,C,ve,be,re,ye,xe,se,z]);const Te=Object(n.useMemo)((()=>({from:H,to:a})),[H,a]),Ie=Object(n.useMemo)((()=>({dnsIsPtrIncluded:null!=A&&A,filters:s?[{query:Object(c.isString)(s)?JSON.parse(s):s,meta:{}}]:void 0})),[A,s]);return ke?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{show:!re,targetClassNames:[x.a]},i.a.createElement(I,{"data-test-subj":`${C}Panel`,height:ue?L:void 0,paddingSize:R},ye&&!re&&i.a.createElement(o.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:C,height:ue?void 0:0,title:je,titleSize:K,toggleStatus:ue,toggleQuery:X?void 0:fe,subtitle:Oe,inspectMultiple:!0,showInspectButton:q&&!be,isInspectDisabled:void 0===s},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},(p||P)&&Te&&!be&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(h.a,{className:"histogram-viz-actions",extraOptions:Ie,getLensAttributes:p,isInspectButtonDisabled:void 0===s,lensAttributes:P,queryId:C,stackByField:oe.value,timerange:Te,title:Z})),i.a.createElement(o.EuiFlexItem,{grow:!1},U.length>1&&i.a.createElement(o.EuiSelect,{onChange:ce,options:U,prepend:u,value:null==oe?void 0:oe.value})),i.a.createElement(o.EuiFlexItem,{grow:!1},S))),ue?be?i.a.createElement(j.a,{scopeId:W,applyGlobalQueriesAndFilters:ee,"data-test-subj":"embeddable-matrix-histogram",extraOptions:Ie,getLensAttributes:p,height:null!=e?e:150,id:te,inspectTitle:Z,lensAttributes:P,stackByField:oe.value,timerange:Te}):i.a.createElement(w,{isInitialLoading:re,barChart:we,configs:ie,stackByField:oe.value,scopeId:G}):null)),V&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},M=i.a.memo(C)},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(5);const c=l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var u=a(372),d=a(13);const p=o()(n.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`,m=({anonymized:e,isDataAnonymizable:t,showIcon:a=!1})=>{const r=Object(i.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),s=Object(i.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),o=Object(i.useMemo)((()=>Object(d.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},a&&Object(d.jsx)(p,{grow:!1},Object(d.jsx)(n.EuiIcon,{color:r,"data-test-subj":"anonymizationIcon",size:"m",type:"eyeClosed"})),Object(d.jsx)(n.EuiFlexItem,{grow:!1},Object(d.jsx)(n.EuiText,{color:r,"data-test-subj":"description",size:"s"},c)))),[r,a]);return Object(d.jsx)(n.EuiToolTip,{content:s},Object(d.jsx)(n.EuiStat,{"data-test-subj":"anonymizedFieldsStat",description:o,reverse:!0,titleColor:r,title:e,titleSize:u.a}))};m.displayName="AnonymizedStatComponent";const f=r.a.memo(m)},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),i=a.n(n),r=a(76),s=a(17),o=a(179),l=a(177),c=a(13);const u=Object(o.css)({name:"1les383",styles:".euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=({actionTypes:e,actionTypeRegistry:t,onClose:a,onSelect:n})=>e&&e.length>0?Object(c.jsx)(s.EuiModal,{onClose:a,"data-test-subj":"action-type-selector-modal"},Object(c.jsx)(s.EuiModalHeader,null,Object(c.jsx)(s.EuiModalHeaderTitle,null,l.m)),Object(c.jsx)(s.EuiModalBody,null,Object(c.jsx)(s.EuiFlexGroup,null,e.map((e=>{const a=t.get(e.id);return Object(c.jsx)(s.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(c.jsx)(s.EuiKeyPadMenuItem,{className:u,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>n(e)},Object(c.jsx)(s.EuiIcon,{size:"xl",type:a.iconClass})))}))))):null,p=i.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:a,onSaveConnector:n,onSelectActionType:i,selectedActionType:s})=>s?Object(c.jsx)(r.ConnectorAddModal,{actionType:s,actionTypeRegistry:e,onClose:a,postSaveEventHandler:n}):Object(c.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:a,onSelect:i})));p.displayName="AddConnectorModal"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(5);const i=n.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneralPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-code portal into your Elastic life. In time, I will be able to answer questions and provide assistance across all your information in Elastic, and oh-so much more. Till then, I hope this early preview will open your mind to the possibilities of what we can create when we work together, in the open. Cheers!"}),r=n.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral2Prompt",{defaultMessage:"First things first, we'll need to set up a Generative AI Connector to get this chat experience going! With the Generative AI Connector, you'll be able to configure access to either an OpenAI service or an Amazon Bedrock service, but you better believe you'll be able to deploy your own models within your Elastic Cloud instance and use those here in the future... ðŸ˜‰"}),s=n.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral3Prompt",{defaultMessage:"Go ahead and click the add connector button below to continue the conversation!"}),o=n.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.enterprisePrompt",{defaultMessage:"Elastic AI Assistant is available to Enterprise users only. Please upgrade your license to use this feature."});var l=a(168);const c={id:l.d,theme:{title:l.c,titleIcon:"logoSecurity",assistant:{name:l.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[{role:"assistant",content:i,timestamp:"",presentation:{delay:2e3,stream:!0}},{role:"assistant",content:r,timestamp:"",presentation:{delay:1e3,stream:!0}},{role:"assistant",content:s,timestamp:"",presentation:{delay:1e3,stream:!0}}],apiConfig:{}},u=[{role:"assistant",content:o,timestamp:"",presentation:{delay:2e3,stream:!0}}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),i=a.n(n),r=a(743),s=a(67),o=a(110),l=a(39),c=a(164);const u=({attributes:e})=>{const{lens:t,theme:a,i18n:u}=Object(o.i)().services,{SaveModalComponent:d,canUseEditor:p}=t,m=Object(c.m)(),{redirectTo:f,getEditOrCreateDashboardPath:b}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(o.j)(),a=Object(n.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(n.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),r=Object(n.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(n.useCallback)((e=>{"listing"===e.destination&&t({url:a}),"dashboard"===e.destination&&t({url:r(e.id)})}),[a,r,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:r,dashboardListingUrl:a}})({getSecuritySolutionUrl:m});return{openSaveVisualizationFlyout:Object(n.useCallback)((()=>{const t=document.createElement("div");Object(r.a)(i.a.createElement(d,{initialInput:e,onSave:e=>{Object(s.unmountComponentAtNode)(t)},onClose:()=>{Object(s.unmountComponentAtNode)(t)},originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${b(e)}`,redirectTo:f}),{theme:a,i18n:u})(t)}),[d,e,b,u,f,a]),disableVisualizations:Object(n.useMemo)((()=>!p()||null==e),[e,p])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(13),i=a(17),r=a(2),s=a.n(r),o=a(55),l=a(44),c=a.n(l),u=a(45),d=a(373);const p=c.a.strong`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`;var m={name:"16fopk3",styles:"overflow:hidden;&:hover{cursor:pointer;text-decoration:underline;}"};var f=a(123),b=a(221),g=a(259),y=a(251);const h="ADD_NEW_SYSTEM_PROMPT";var v={name:"1bxycju",styles:"min-width:100%"},E={name:"qhxz92",styles:"max-width:100%"};const x=({allSystemPrompts:e,compressed:t=!1,conversation:a,selectedPrompt:l,clearSelectedSystemPrompt:c,isClearable:x=!1,isEditing:j=!1,isDisabled:S=!1,isOpen:O=!1,isSettingsModalVisible:k,onSystemPromptSelectionChange:w,setIsEditing:T,setIsSettingsModalVisible:I,showTitles:C=!1})=>{var M;const{setSelectedSettingsTab:_}=Object(f.b)(),{setApiConfig:A}=Object(b.a)(),[F,P]=Object(r.useState)(O),D=Object(r.useCallback)((()=>P(!1)),[]),N=Object(r.useCallback)((e=>{a&&A({conversationId:a.id,apiConfig:{...a.apiConfig,defaultSystemPromptId:null==e?void 0:e.id}})}),[a,A]),R=Object(r.useMemo)((()=>({value:h,inputDisplay:d.a,dropdownDisplay:Object(n.jsx)(i.EuiFlexGroup,{gutterSize:"none",key:h},Object(n.jsx)(i.EuiFlexItem,{grow:!0},Object(n.jsx)(i.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},d.a)),Object(n.jsx)(i.EuiFlexItem,{grow:!1},Object(n.jsx)("div",{style:{width:"24px"}})))})),[]),L=Object(r.useMemo)((()=>(({prompts:e,showTitles:t=!1})=>{var a;return null!==(a=null==e?void 0:e.map((e=>(({content:e,id:t,name:a,showTitles:r=!1})=>({value:t,inputDisplay:Object(n.jsx)(i.EuiText,{color:"subdued","data-test-subj":"systemPromptText",css:m},r?a:e),dropdownDisplay:Object(n.jsx)(s.a.Fragment,null,Object(n.jsx)(p,{"data-test-subj":"name"},a),Object(n.jsx)(i.EuiToolTip,{content:void 0},Object(n.jsx)(i.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(u.isEmpty)(e)?Object(n.jsx)("p",null,d.d):Object(n.jsx)("p",null,e))))}))({...e,showTitles:t}))))&&void 0!==a?a:[]})({prompts:e,showTitles:C})),[e,C]),B=Object(r.useCallback)((t=>{if(t===h)return I(!0),void _(g.d);null!=w?w(t):N(e.find((e=>e.id===t))),null==T||T(!1)}),[e,w,T,I,_,N]),z=Object(r.useCallback)((()=>{N(void 0),null==T||T(!1),null==c||c()}),[c,T,N]),q=Object(r.useCallback)((()=>{null==T||T(!0),P(!0)}),[T]);return Object(n.jsx)(i.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none"},Object(n.jsx)(i.EuiFlexItem,{css:E},j&&Object(n.jsx)(i.EuiFormRow,{css:v},Object(n.jsx)(i.EuiSuperSelect,{popoverProps:{zIndex:o.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":y.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:S,isOpen:F&&!k,onChange:B,onBlur:D,options:[...L,R],placeholder:d.e,valueOfSelected:null!==(M=null==l?void 0:l.id)&&void 0!==M?M:e[0].id}))),Object(n.jsx)(i.EuiFlexItem,{grow:!1},j&&x&&Object(n.jsx)(i.EuiToolTip,{content:d.c},Object(n.jsx)(i.EuiButtonIcon,{"aria-label":d.c,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:z})),!j&&Object(n.jsx)(i.EuiToolTip,{content:d.b},Object(n.jsx)(i.EuiButtonIcon,{"aria-label":d.b,"data-test-subj":"addSystemPrompt",iconType:"plus",onClick:q}))))};x.displayName="SelectSystemPromptComponent";const j=s.a.memo(x)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(17),i=a(2),r=a.n(i),s=a(372),o=a(5);const l=o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"});var c=a(13);const u=({allowed:e,total:t})=>{const a=Object(i.useMemo)((()=>(({allowed:e,total:t})=>o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(c.jsx)(n.EuiToolTip,{content:a},Object(c.jsx)(n.EuiStat,{"data-test-subj":"allowedStat",description:l,reverse:!0,title:e,titleSize:s.a}))};u.displayName="AllowedStatComponent";const d=r.a.memo(u)},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),r=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),s=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),o=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"});n.i18n.translate("xpack.securitySolution.containers.detectionEngine.users.userProfiles.title",{defaultMessage:"Failed to find users"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(295),i=a(334);const r=async(e,t,a=!1)=>{var r,s;const o=await t.get(e,!0,a),l=o.toSpec(),c=Object(n.a)(o.getIndexPattern().split(",")),u=await t.getExistingIndices(c);return{loading:!1,id:null!==(r=l.id)&&void 0!==r?r:"",title:o.getIndexPattern(),indexFields:o.fields,fields:l.fields,patternList:u,dataView:l,browserFields:Object(i.a)(null!==(s=l.id)&&void 0!==s?s:"",l.fields).browserFields,runtimeMappings:l.runtimeFieldMap}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.indexFieldsSearch.errorSearchDescription",{defaultMessage:"An error has occurred creating the ad-hoc data view"}),r=n.i18n.translate("xpack.securitySolution.dataView.fetchFields.warning",{defaultMessage:"Failed to fetch detailed fields information"})},,,function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),a(338).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return k}));var n=a(136),i=a.n(n),r=a(45),s=a(2),o=a(48),l=a(3),c=a(54),u=a(110),d=a(209),p=a(118),m=a(446),f=a(127),b=a(125),g=a(122),y=a(202),h=a(282),v=a(336),E=a(4);const x="timelineEventsQuery",j=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],S=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),O=({dataViewId:e,endDate:t,eqlOptions:a,id:n=x,indexNames:O,fields:k,filterQuery:w,runtimeMappings:T,startDate:I,language:C="kuery",limit:M,sort:_=j,skip:A=!1,timerangeKind:F})=>{const[{pageName:P}]=Object(y.a)(),D=Object(o.useDispatch)(),{data:N}=Object(u.i)().services,R=Object(s.useRef)(r.noop),L=Object(s.useRef)(new AbortController),B=Object(s.useRef)(new l.Subscription),[z,q]=Object(s.useState)(!1),[$,V]=Object(s.useState)(n===g.c.active?h.a.getActivePage():0),[U,H]=Object(s.useState)(null),Q=Object(s.useRef)(null),{startTracking:G}=Object(v.a)(),W=Object(s.useCallback)((()=>{null!=n&&m.a.some((e=>e===n))&&(D(p.a.clearEventsLoading({id:n})),D(p.a.clearEventsDeleted({id:n})))}),[D,n]),Z=Object(s.useCallback)((e=>{W(),n===g.c.active&&(h.a.setExpandedDetail({}),h.a.setActivePage(e)),V(e)}),[W,n]),K=Object(s.useCallback)((()=>{null!=R.current&&R.current(),Z(0)}),[Z]),[J,Y]=Object(s.useState)({id:n,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:Z,refreshedAt:0}),X=Object(s.useCallback)((async(t,a)=>{if(null==t||""===P||A)return;const i=async()=>{Q.current=t,L.current=new AbortController,q(!0);const{endTracking:i}=G({name:`${E.l} timeline events search`});B.current=N.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:L.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(c.isRunningResponse)(e)||(i("success"),q(!1),Y((i=>{const r={...i,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(f.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var s;return n===g.c.active&&(h.a.setExpandedDetail({}),h.a.setPageName(P),"eql"===t.language?(h.a.setEqlRequest(t),h.a.setEqlResponse(r)):(h.a.setRequest(t),h.a.setResponse(r))),a&&a(r),r})),B.current.unsubscribe())},error:e=>{i(L.current.signal.aborted?"aborted":"error"),q(!1),N.search.showError(e),B.current.unsubscribe()}})};if(n===g.c.active&&""!==h.a.getPageName()&&P!==h.a.getPageName()){if(h.a.setPageName(P),L.current.abort(),q(!1),"eql"===t.language?(Q.current=h.a.getEqlRequest(),R.current=i.bind(null,h.a.getEqlRequest())):(Q.current=h.a.getRequest(),R.current=i.bind(null,h.a.getRequest())),Y((e=>{const a="eql"===t.language?h.a.getEqlResponse():h.a.getResponse();return null!=a?{...a,refetch:K,loadPage:Z}:e})),"eql"!==t.language&&null!=h.a.getResponse())return;if("eql"===t.language&&null!=h.a.getEqlResponse())return}B.current.unsubscribe(),L.current.abort(),await i(),R.current=i}),[P,A,n,G,N.search,e,K,Z]);Object(s.useEffect)((()=>{0!==O.length&&H((e=>{var r,s,o,l,c,u,p;const m=e,f={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(s=null==e?void 0:e.filterQuery)&&void 0!==s?s:"",querySize:null!==(o=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==o?o:0,sort:null!==(c=null==e?void 0:e.sort)&&void 0!==c?c:j,timerange:null!==(u=null==e?void 0:e.timerange)&&void 0!==u?u:{},runtimeMappings:null!==(p=null==e?void 0:e.runtimeMappings)&&void 0!==p?p:{},...S(m)},y=I&&t?{timerange:{interval:"12h",from:I,to:t}}:{},v={defaultIndex:O,filterQuery:Object(d.a)(w),querySize:M,sort:_,runtimeMappings:T,...y,...S(a)},E=i()(f,v)?$:0,x={defaultIndex:O,factoryQueryType:b.y.all,fieldRequested:k,fields:k,filterQuery:Object(d.a)(w),pagination:{activePage:E,querySize:M},language:C,runtimeMappings:T,sort:_,...y,...a||{}};return $!==E&&(V(E),n===g.c.active&&h.a.setActivePage(E)),i()(e,x)?e:x}))}),[D,O,$,t,a,w,n,C,M,I,_,k,T]);const ee=Object(s.useCallback)((async e=>{n===g.c.active&&"absolute"!==F&&i()(Q.current,U)||await X(U,e)}),[n,U,X,F]);return Object(s.useEffect)((()=>{Object(r.isEmpty)(w)&&Y({id:n,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:Z,refreshedAt:0})}),[w,n,K,Z]),[z,J,ee]},k=({dataViewId:e,endDate:t,eqlOptions:a,id:n=x,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:c,language:u="kuery",limit:d,sort:p=j,skip:m=!1,timerangeKind:f})=>{const[b,g,y]=O({dataViewId:e,endDate:t,eqlOptions:a,id:n,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:c,language:u,limit:d,sort:p,skip:m,timerangeKind:f});return Object(s.useEffect)((()=>{y&&y()}),[y]),[b,g]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(19),r=a(110);const s=()=>{const e=Object(r.i)(),{http:t}=e.services,[a,s]=Object(n.useState)(Object(i.createSavedQueryService)(t));return Object(n.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(4),r=a(110);const s=({defaultValue:e,key:t,plugin:a=i.i,isInvalidDefault:s})=>{const{storage:o}=Object(r.i)().services,[l,c]=Object(n.useState)(!1),[u,d]=Object(n.useState)(e),p=Object(n.useCallback)((()=>{const n=o.get(`${a}.${t}`),i=typeof n!=typeof e,r=null!=s&&s(n);d(i||r?e:n)}),[e,s,t,a,o]),m=Object(n.useCallback)((e=>{if("function"==typeof e){const n=e;d((e=>{const i=n(e);return o.set(`${a}.${t}`,i),i}))}else o.set(`${a}.${t}`,e),d(e)}),[t,a,o]);return Object(n.useEffect)((()=>{l||(p(),c(!0))}),[l,p]),[u,m,c]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(45);const i=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),s=e=>Object(n.isUndefined)(e)?void 0:Object(n.castArray)(e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(45),i=a(2),r=a.n(i),s=a(153),o=a(753);const l=r.a.memo((({dataProvider:e})=>{var t;const[a,l]=Object(i.useState)(!1);return r.a.createElement(o.a,{deleteProvider:n.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:a,setIsPopoverOpen:l,toggleExcludedProvider:n.noop,toggleEnabledProvider:n.noop,toggleTypeProvider:n.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||s.d,type:e.type||s.a.default})}));l.displayName="Provider"},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));const n=["50%","50%"],i=["30%","70%"]},function(e,t,a){"use strict";let n,i;a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r.c})),a(227),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(n||(n={})),function(e){e.kpiHosts="hostsKpiHosts",e.kpiUniqueIps="hostsKpiUniqueIps"}(i||(i={}));var r=a(150)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n.LastEventIndexKey})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(58);let i,r;!function(e){e.all="eventsAll",e.details="eventsDetails",e.kpi="eventsKpi",e.lastEventTime="eventsLastEventTime"}(i||(i={})),function(e){e.uniDirectional="uniDirectional",e.biDirectional="biDirectional"}(r||(r={}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return y}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(110),c=a(205),u=a(867),d=a(5);const p=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),m=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),f=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),b=o()(r.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),g=i.a.memo((({pageName:e,docLinkSelector:t})=>i.a.createElement(c.a,null,i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(b,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,null,i.a.createElement(y,{pageName:e,docLinkSelector:t})))))));g.displayName="NoPrivilegePage";const y=i.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:a}=Object(l.i)().services,r=Object(n.useMemo)((()=>({feature:{icon:"documents",label:f,url:t(a.links),target:"_blank"}})),[t,a.links]),s=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):m;return i.a.createElement(u.a,{actions:r,message:s,"data-test-subj":"noPrivilegesPage",title:p})}));y.displayName="NoPrivileges"},function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return o}));var n=a(9),i=a(420);function r(e,t){var a,n,i;return null!==(a=null===(n=e.packagePrivileges)||void 0===n||null===(i=n.endpoint)||void 0===i?void 0:i.actions[t].executePackageAction)&&void 0!==a&&a}function s(e,t){var a,n;return null!==(a=null===(n=e.endpointExceptionsPrivileges)||void 0===n?void 0:n.actions[t])&&void 0!==a&&a}const o=(e,t,a=[])=>{var o;const l=e.isPlatinumPlus(),c=e.isEnterprise(),u=a.includes("superuser"),d=r(t,"writeSecuritySolution"),p=r(t,"readSecuritySolution"),m=r(t,"writeEndpointList"),f=r(t,"readEndpointList"),b=r(t,"writePolicyManagement"),g=r(t,"readPolicyManagement"),y=r(t,"writeActionsLogManagement"),h=r(t,"readActionsLogManagement"),v=r(t,"writeHostIsolation"),E=r(t,"writeHostIsolationRelease"),x=r(t,"writeProcessOperations"),j=r(t,"writeTrustedApplications"),S=r(t,"readTrustedApplications"),O=r(t,"writeHostIsolationExceptions"),k=r(t,"readHostIsolationExceptions"),w=r(t,"accessHostIsolationExceptions"),T=r(t,"deleteHostIsolationExceptions"),I=r(t,"writeBlocklist"),C=r(t,"readBlocklist"),M=r(t,"writeEventFilters"),_=r(t,"readEventFilters"),A=r(t,"writeFileOperations"),F=r(t,"writeExecuteOperations"),P=s(t,"showEndpointExceptions"),D=s(t,"crudEndpointExceptions"),N={canWriteSecuritySolution:d,canReadSecuritySolution:p,canAccessFleet:null!==(o=null==t?void 0:t.fleet.all)&&void 0!==o&&o,canAccessEndpointManagement:u,canCreateArtifactsByPolicy:l,canWriteEndpointList:m,canReadEndpointList:f,canWritePolicyManagement:b,canReadPolicyManagement:g,canWriteActionsLogManagement:y,canReadActionsLogManagement:h&&c,canAccessEndpointActionsLogManagement:h&&l,canIsolateHost:v&&l,canUnIsolateHost:E,canKillProcess:x&&c,canSuspendProcess:x&&c,canGetRunningProcesses:x&&c,canAccessResponseConsole:!1,canWriteExecuteOperations:F&&c,canWriteFileOperations:A&&c,canWriteTrustedApplications:j,canReadTrustedApplications:S,canWriteHostIsolationExceptions:O&&l,canAccessHostIsolationExceptions:w&&l,canReadHostIsolationExceptions:k,canDeleteHostIsolationExceptions:T,canWriteBlocklist:I,canReadBlocklist:C,canWriteEventFilters:M,canReadEventFilters:_,canReadEndpointExceptions:P,canWriteEndpointExceptions:D};return N.canAccessResponseConsole=c&&Object.values(Object(n.omit)(i.g,"release")).some((e=>N[e])),N},l=()=>({canWriteSecuritySolution:!1,canReadSecuritySolution:!1,canAccessFleet:!1,canAccessEndpointActionsLogManagement:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canWriteEndpointList:!1,canReadEndpointList:!1,canWritePolicyManagement:!1,canReadPolicyManagement:!1,canWriteActionsLogManagement:!1,canReadActionsLogManagement:!1,canIsolateHost:!1,canUnIsolateHost:!1,canKillProcess:!1,canSuspendProcess:!1,canGetRunningProcesses:!1,canAccessResponseConsole:!1,canWriteFileOperations:!1,canWriteExecuteOperations:!1,canWriteTrustedApplications:!1,canReadTrustedApplications:!1,canWriteHostIsolationExceptions:!1,canAccessHostIsolationExceptions:!1,canReadHostIsolationExceptions:!1,canDeleteHostIsolationExceptions:!1,canWriteBlocklist:!1,canReadBlocklist:!1,canWriteEventFilters:!1,canReadEventFilters:!1,canReadEndpointExceptions:!1,canWriteEndpointExceptions:!1})},,,function(e,t,a){"use strict";a.r(t),a.d(t,"sourcererKibanaDataViewsSelector",(function(){return i})),a.d(t,"sourcererSignalIndexNameSelector",(function(){return r})),a.d(t,"sourcererDefaultDataViewSelector",(function(){return s})),a.d(t,"dataViewSelector",(function(){return o})),a.d(t,"sourcererScopeIdSelector",(function(){return l})),a.d(t,"scopeIdSelector",(function(){return c})),a.d(t,"kibanaDataViewsSelector",(function(){return u})),a.d(t,"signalIndexNameSelector",(function(){return d})),a.d(t,"defaultDataViewSelector",(function(){return p})),a.d(t,"sourcererDataViewSelector",(function(){return m})),a.d(t,"getSourcererDataViewsSelector",(function(){return f})),a.d(t,"getSourcererScopeSelector",(function(){return b})),a.d(t,"getSelectedDataviewSelector",(function(){return g}));var n=a(57);const i=({sourcerer:e})=>e.kibanaDataViews,r=({sourcerer:e})=>e.signalIndexName,s=({sourcerer:e})=>e.defaultDataView,o=({sourcerer:e},t)=>e.kibanaDataViews.find((e=>e.id===t)),l=({sourcerer:e},t)=>e.sourcererScopes[t],c=()=>Object(n.createSelector)(l,(e=>e)),u=()=>Object(n.createSelector)(i,(e=>e)),d=()=>Object(n.createSelector)(r,(e=>e)),p=()=>Object(n.createSelector)(s,(e=>e)),m=()=>Object(n.createSelector)(o,(e=>e)),f=()=>{const e=u(),t=p(),a=d();return n=>{const i=e(n);return{defaultDataView:t(n),kibanaDataViews:i,signalIndexName:a(n)}}},b=()=>{const e=f(),t=m(),a=c();return(n,i)=>{const r=e(n),s=a(n,i);return{...r,selectedDataView:t(n,s.selectedDataViewId),sourcererScope:s}}},g=()=>{const e=m(),t=c();return(a,n)=>{const i=t(a,n),r=e(a,i.selectedDataViewId);return null==r?void 0:r.dataView}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=e=>"relative"===e.kind,i=e=>"absolute"===e.kind},function(e,t,a){"use strict";a.r(t),a.d(t,"inputsSelector",(function(){return u})),a.d(t,"timelineTimeRangeSelector",(function(){return d})),a.d(t,"socTrendsTimeRangeSelector",(function(){return p})),a.d(t,"globalFullScreenSelector",(function(){return m})),a.d(t,"timelineFullScreenSelector",(function(){return f})),a.d(t,"globalTimeRangeSelector",(function(){return b})),a.d(t,"globalQuery",(function(){return g})),a.d(t,"globalQueryByIdSelector",(function(){return y})),a.d(t,"timelineQueryByIdSelector",(function(){return h})),a.d(t,"globalSelector",(function(){return v})),a.d(t,"globalQuerySelector",(function(){return x})),a.d(t,"globalSavedQuerySelector",(function(){return j})),a.d(t,"globalFiltersQuerySelector",(function(){return O})),a.d(t,"getTimelineSelector",(function(){return k})),a.d(t,"getTimelinePolicySelector",(function(){return w}));var n=a(57);const i={id:"kql",inspect:null,isInspected:!1,loading:!1,refetch:null,selectedInspectIndex:0},r=e=>e.inputs,s=e=>e.inputs.global,o=e=>e.inputs.timeline,l=(e,t)=>e.inputs.global.queries.find((e=>e.id===t))||i,c=(e,t)=>e.inputs.timeline.queries.find((e=>e.id===t))||e.inputs.global.queries.find((e=>e.id===t))||i,u=()=>Object(n.createSelector)(r,(e=>e)),d=Object(n.createSelector)(o,(e=>e.timerange)),p=Object(n.createSelector)((e=>e.inputs.socTrends),(e=>null==e?void 0:e.timerange)),m=Object(n.createSelector)(s,(e=>e.fullScreen)),f=Object(n.createSelector)(o,(e=>e.fullScreen)),b=Object(n.createSelector)(s,(e=>e.timerange)),g=()=>Object(n.createSelector)(s,(e=>e.queries)),y=()=>Object(n.createSelector)(l,(e=>e)),h=()=>Object(n.createSelector)(c,(e=>e)),v=()=>Object(n.createSelector)(s,(e=>e)),E={query:"",language:"kuery"},x=()=>Object(n.createSelector)(s,(e=>e.query||E)),j=()=>Object(n.createSelector)(s,(e=>e.savedQuery||null)),S=[],O=()=>Object(n.createSelector)(s,(e=>e.filters||S)),k=()=>Object(n.createSelector)(o,(e=>e)),w=()=>Object(n.createSelector)(o,(e=>e.policy))},function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return g}));var n=a(45),i=a(634),r=a(119);const s=(e,t,a)=>({...a,global:{...a.global,fullScreen:e===r.a.global?t:a.global.fullScreen},timeline:{...a.timeline,fullScreen:e===r.a.timeline?t:a.timeline.fullScreen}}),o=(e,t,a)=>t!==r.a.global&&t!==r.a.timeline||a!==r.a.socTrends?t!==r.a.socTrends||a!==r.a.global&&a!==r.a.timeline?e:Object(i.a)(e):Object(i.b)(e),l=(e,t,a)=>{const i=Object(n.get)(e,a);return null!=i?{...[e,...i.linkTo].reduce(((i,r)=>({...i,[r]:{...Object(n.get)(r,a),timerange:o(t,e,r)}})),e===r.a.timeline?{...a,global:{...a.global,linkTo:[]}}:a)}:a},c=e=>e.global.linkTo.indexOf(r.a.timeline)>-1?f([r.a.global,r.a.timeline],e):m([r.a.global,r.a.timeline],e),u=e=>e.global.linkTo.indexOf(r.a.socTrends)>-1?f([r.a.global,r.a.socTrends],e):m([r.a.global,r.a.socTrends],e),d=({inputId:e,id:t,inspect:a,loading:i,refetch:r,state:s,searchSessionId:o})=>{const l=s[e].queries.findIndex((e=>e.id===t));return{...s,[e]:{...Object(n.get)(e,s),queries:l>-1?[...s[e].queries.slice(0,l),{id:t,inspect:a,isInspected:s[e].queries[l].isInspected,loading:i,refetch:r,searchSessionId:s[e].queries[l].searchSessionId,selectedInspectIndex:s[e].queries[l].selectedInspectIndex},...s[e].queries.slice(l+1)]:[...s[e].queries,{id:t,inspect:a,isInspected:!1,loading:i,refetch:r,selectedInspectIndex:0,searchSessionId:o}]}}},p=({id:e,inputId:t,isInspected:a,selectedInspectIndex:i,state:r,searchSessionId:s})=>{const o=r[t].queries.findIndex((t=>t.id===e)),l=o>-1?r[t].queries[o]:null;return{...r,[t]:{...Object(n.get)(t,r),queries:o>-1?[...r[t].queries.slice(0,o),{...l,isInspected:a,selectedInspectIndex:i,searchSessionId:s},...r[t].queries.slice(o+1)]:[...r[t].queries]}}},m=(e,t)=>{if(2!==e.length)throw new Error("Only link 2 input states at a time");if(e.includes(r.a.socTrends)&&e.includes(r.a.timeline))throw new Error("Do not link socTrends to timeline. Only link socTrends to global");if(1===Array.from(new Set(e)).length)throw new Error("Input linkTo cannot link to itself");if(e.includes(r.a.timeline)&&e.includes(r.a.global)){const e=t.timeline.linkTo.includes(r.a.socTrends)||t.global.linkTo.includes(r.a.socTrends)?[r.a.socTrends]:[];return{...t,timeline:{...t.timeline,linkTo:[...e,r.a.global]},global:{...t.global,linkTo:[...e,r.a.timeline]},...t.socTrends&&e.length?{socTrends:{...t.socTrends,linkTo:[r.a.global,r.a.timeline]}}:{}}}if(e.includes(r.a.socTrends)&&e.includes(r.a.global)){const e=t.global.linkTo.includes(r.a.timeline)?[r.a.timeline]:[];return{...t,...t.socTrends?{socTrends:{...t.socTrends,linkTo:[...e,r.a.global]}}:{},global:{...t.global,linkTo:[...e,r.a.socTrends]},...e.length?{timeline:{...t.timeline,linkTo:[r.a.global,r.a.socTrends]}}:{}}}return t},f=(e,t)=>{if(2!==e.length)throw new Error("Only remove linkTo from 2 input states at a time");if(e.includes(r.a.socTrends)&&e.includes(r.a.timeline))throw new Error("Do not remove link socTrends to timeline. Only remove link socTrends to global");if(1===Array.from(new Set(e)).length)throw new Error("Input linkTo cannot remove link to itself");if(e.includes(r.a.timeline)&&e.includes(r.a.global)){const e=t.timeline.linkTo.includes(r.a.socTrends)||t.global.linkTo.includes(r.a.socTrends)?[r.a.socTrends]:[];return{...t,timeline:{...t.timeline,linkTo:[]},global:{...t.global,linkTo:e},...t.socTrends&&e.length?{socTrends:{...t.socTrends,linkTo:[r.a.global]}}:{}}}if(e.includes(r.a.socTrends)&&e.includes(r.a.global)){const e=t.global.linkTo.includes(r.a.timeline)?[r.a.timeline]:[];return{...t,...t.socTrends?{socTrends:{...t.socTrends,linkTo:[]}}:{},global:{...t.global,linkTo:e},...e.length?{timeline:{...t.timeline,linkTo:[r.a.global]}}:{}}}return t},b=({inputId:e,id:t,state:a})=>{const i=a[e].queries.findIndex((e=>e.id===t));return{...a,[e]:{...Object(n.get)(e,a),queries:i>-1?[...a[e].queries.slice(0,i),...a[e].queries.slice(i+1)]:[...a[e].queries]}}},g=e=>"queries"in e},function(e,t,a){"use strict";var n=a(167);a.d(t,"a",(function(){return n.c}));var i=a(195);a.d(t,"b",(function(){return i.c}));var r=a(138);a.d(t,"c",(function(){return r.d}));var s=a(149);a.d(t,"d",(function(){return s.d}))},function(e,t,a){"use strict";let n,i;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),function(e){e.host="host",e.user="user"}(n||(n={})),function(e){e.NOT_INSTALLED="NOT_INSTALLED",e.DISABLED="DISABLED",e.ENABLED="ENABLED"}(i||(i={}))},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.userName="user.name",e.hostName="host.name"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.timelines.pageTitle",{defaultMessage:"Timelines"}),r=n.i18n.translate("xpack.securitySolution.timelines.allTimelines.panelTitle",{defaultMessage:"All timelines"}),s=n.i18n.translate("xpack.securitySolution.timelines.allTimelines.importTimelineTitle",{defaultMessage:"Import"}),o=n.i18n.translate("xpack.securitySolution.timelines.allTimelines.errorFetchingTimelinesTitle",{defaultMessage:"Failed to query all timelines data"}),l=n.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorTitle",{defaultMessage:"Timeline error"}),c=n.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorText",{defaultMessage:"Something went wrong"}),u=n.i18n.translate("xpack.securitySolution.timelines.timelineVersionConflictTitle",{defaultMessage:"Version conflict"}),d=n.i18n.translate("xpack.securitySolution.timelines.timelineVersionConflictDescription",{defaultMessage:"Another user has made changes to this timeline. You need to refresh the page to make changes to this timeline."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(45),i=a(56),r=a.n(i);const s=e=>{if(Object(n.isString)(e)&&""!==e.trim()){const t=r()(new Date(e));return t.isValid()||isNaN(+e)?t:r()(new Date(+e))}return r()(new Date(e))}},function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return f}));var n=a(45),i=a(124),r=a(357),s=a(4);a(110);const o="securityDataTable",l="timelines",c={},u=e=>e?Object.keys(e).reduce(((t,a)=>{const n=e[a];return{...t,[a]:{defaultColumns:n.defaultColumns,dataViewId:n.dataViewId,excludedRowRendererIds:n.excludedRowRendererIds,filters:n.filters,indexNames:n.indexNames,loadingEventIds:n.loadingEventIds,isSelectAllChecked:n.isSelectAllChecked,itemsPerPage:n.itemsPerPage,itemsPerPageOptions:n.itemsPerPageOptions,showCheckboxes:n.showCheckboxes,graphEventId:n.graphEventId,sessionViewConfig:n.sessionViewConfig,selectAll:n.selectAll,id:n.id,title:n.title,initialized:n.initialized,updated:n.updated,sort:n.sort,selectedEventIds:n.selectedEventIds,deletedEventIds:n.deletedEventIds,expandedDetail:n.expandedDetail,totalCount:n.totalCount||0,viewMode:s.Mc.gridView,additionalFilters:{showBuildingBlockAlerts:!1,showOnlyThreatIndicatorAlerts:!1},...Array.isArray(n.columns)?{columns:n.columns.map(d).map(p)}:{}}}}),{}):c,d=e=>({...e,...Number.isInteger(e.width)&&!Number.isInteger(e.initialWidth)?{initialWidth:e.width}:e.initialWidth?{initialWidth:e.initialWidth}:{}}),p=e=>({...e,...Object(n.isEmpty)(e.label)||null!=e.displayAsText?e.displayAsText?{displayAsText:e.displayAsText}:{}:{displayAsText:e.label}}),m=(e,t)=>{let a=e.get(o);const n=e.get(l);if(!a){if(!n)return c;a=u(n)}return((e,t)=>{const a={[i.e.alertsOnAlertsPage]:`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,[i.e.alertsOnRuleDetailsPage]:`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`};Object.keys(t).filter((t=>t in a&&!e.get(a[t]))).map((e=>({[a[e]]:{columns:t[e].columns,sort:t[e].sort.map((e=>({[e.columnId]:{order:e.sortDirection}}))),visibleColumns:t[e].columns}}))).forEach((t=>Object.keys(t).forEach((a=>{e.set(a,t[a])}))))})(e,a),(e=>{[`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`].forEach((t=>{const a=e.get(t);if(a&&"visibleColumns"in a){const n=a.visibleColumns;if(n.every((e=>"string"==typeof e)))return;const i=n.map((e=>"string"==typeof e?e:e.id)).filter(Boolean);e.set(t,{...a,visibleColumns:i})}}))})(e),((e,t)=>{let a=!1;for(const[e,n]of Object.entries(t)){if(i.r[e]!==i.d.alert)continue;const t=n.columns;Array.isArray(t)&&(-1!==t.findIndex((e=>e.id===r.a.id))||(a=!0,n.columns.push(r.a)));const s=n.defaultColumns;s&&(-1!==s.findIndex((e=>e.id===r.a.id))||(a=!0,n.defaultColumns.push(r.a)))}a&&(e.set(o,t),(e=>{[`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`].forEach((t=>{const a=e.get(t);if(a&&"columns"in a){let n=!1;-1!==a.columns.findIndex((e=>e.id===r.a.id))||(a.columns.splice(1,0,r.a),n=!0),"visibleColumns"in a&&(-1!==a.visibleColumns.findIndex((e=>e===r.a.id))||(a.visibleColumns.splice(1,0,r.a.id),n=!0)),n&&e.set(t,a)}}))})(e))})(e,a),t.reduce(((e,t)=>{const n=a[t];return n?{...e,[t]:{...n,...null==n.sort||Array.isArray(n.sort)?{}:{sort:[n.sort]}}}:{...e}}),{})},f=(e,t,a)=>{const n=b(a),i=(e=>{let t=e.get(o);const a=e.get(l);if(!t){if(!a)return c;t=u(a)}return t})(e);e.set(o,{...i,[t]:n})},b=e=>{const{isLoading:t,loadingText:a,queryFields:n,unit:i,...r}=e;return r}},function(e,t,a){var n=a(996),i=a(997);e.exports=function(e,t,a){return n(i,e,t,a)}},function(e,t,a){e.exports=a(24)(3829)},function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b}));var n=a(17),i=a(56),r=a.n(i),s=a(2),o=a.n(s),l=a(44),c=a.n(l),u=a(51),d=a(459),p=a(214);d.f;const m=c.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);m.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiTitle,{size:"s"},o.a.createElement(m,null,d.e))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(u.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),b=({associateNote:e,newNote:t,updateNewNote:a,updateNote:n,user:i})=>{const r=f({newNote:t,user:i});n(r),e(r.id),a("")}},function(e,t,a){const n=a(304);e.exports=(e,t)=>{const a=n(e,t);return a?a.version:null}},function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(5);const i=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),r=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),s=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=n.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=n.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),c=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),u=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c}));var n=a(17),i=a(2),r=a.n(i),s=a(562);const o="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const a=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),a())}),[a]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiWindowEvent,{event:"keydown",handler:l}),r.a.createElement(n.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:a},s.a)):null};l.displayName="ExitFullScreenComponent";const c=r.a.memo(l)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(n.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>n.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),s=n.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});n.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(236);const c=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),u=({count:e,onClick:t})=>{const a=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?r.a.createElement(n.EuiLink,{onClick:a},r.a.createElement("b",null,r.a.createElement(l.a,{count:e}))):r.a.createElement("b",null,r.a.createElement(l.a,{count:e})):r.a.createElement(c,null)};u.displayName="ChartLabelComponent";const d=r.a.memo(u)},function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return v}));var n=a(17),i=a(2),r=a.n(i),s=a(62),o=a(9),l=a(44),c=a.n(l),u=a(5),d=a(265),p=a(351),m=a(597);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},b=c()(n.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),g=c()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),y=({children:e,dataExists:t,donutTextWrapperClassName:a,donutTextWrapperStyles:s,isChartEmbeddablesEnabled:o,label:l,title:c})=>{const{euiTheme:u}=Object(n.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:u.colors.disabled})),[u.colors.disabled]),p=o?void 0:"eui-textTruncate";return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(g,{grow:o},r.a.createElement(b,{$dataExists:t,$donutTextWrapperStyles:s,$isChartEmbeddablesEnabled:o,alignItems:"center",className:a,direction:"column",gutterSize:"none",justifyContent:"center"},r.a.createElement(n.EuiFlexItem,null,c),l&&r.a.createElement(n.EuiFlexItem,{className:p},r.a.createElement(n.EuiToolTip,{content:l},r.a.createElement(n.EuiText,{className:p,size:"s",style:t?void 0:d},l)))),e))},h=r.a.memo(y),v=({data:e,fillColor:t,height:a=90,label:l,legendItems:c,onPartitionClick:b,title:g,totalCount:y})=>{const{baseTheme:v,theme:E}=Object(d.i)(),x=Object(i.useCallback)((e=>{if(b){var t;const a=e.flat(2),n=a.length>0&&"groupByRollup"in a[0]&&null!=(null===(t=a[0])||void 0===t?void 0:t.groupByRollup)?`${a[0].groupByRollup}`:"";Object(o.isEmpty)(n.trim())||b(n.toLowerCase())}}),[b]);return r.a.createElement(h,{dataExists:null!=e&&e.length>0,label:l,title:g,isChartEmbeddablesEnabled:!1},r.a.createElement(r.a.Fragment,null,null==e||null==y||0===y?r.a.createElement(m.a,{size:a}):r.a.createElement(s.Chart,{size:a},r.a.createElement(s.Settings,{theme:[f,E],baseTheme:v,onElementClick:x,locale:u.i18n.getLocale()}),r.a.createElement(s.Partition,{id:"donut-chart",data:e,layout:s.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(s.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),c&&(null==c?void 0:c.length)>0&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(p.a,{legendItems:c,height:a}))))}},function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return p}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17);const l="#FAFBFD",c=s.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),u=s.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(c,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(u,{size:e-t,"data-test-subj":"empty-donut-small"})):null,p=i.a.memo(d)},function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(23),i=a.n(n),r=a(17),s=a(2),o=a.n(s),l=a(5),c=a(62),u=a(45),d=a(324),p=a.n(d),m=a(51),f=a(44),b=a.n(f),g=a(136),y=a.n(g),h=a(174),v=a(110),E=a(383),x=a(283),j=a(226),S=a(293),O=a(724),k=a(265),w=a(351),T=a(339),I=a(276),C=a(190);const M=b()(r.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-1257qcd-0"})(["overview:hidden;"]),_=e=>null!=e&&!!Object(u.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(u.isNumber)(t)&&t>=0)),A=["y"],F=[e=>Object(j.a)(e.g)?e.g:S.c],P=({data:e,forceHiddenLegend:t=!1,yAxisTitle:a,...n})=>{const r=Object(k.i)(),d=Object(v.l)(),m=Object(u.get)("configs.axis.xTickFormatter",n),f=Object(u.get)("configs.axis.yTickFormatter",n),b=Object(u.getOr)(0,"configs.axis.tickSize",n),g=`stat-items-barchart-${e[0].key}-x`,y=`stat-items-barchart-${e[0].key}-y`,h={...k.e,...p()(Object(u.get)("configs.settings",n),r)},E=Object(s.useMemo)((()=>p()({tickLine:{size:b}},Object(u.getOr)({},"configs.axis.bottom.style",n))),[n,b]),x=Object(s.useMemo)((()=>p()({tickLine:{size:b}},Object(u.getOr)({},"configs.axis.left.style",n))),[n,b]),j=Object(u.get)("configs.axis.bottom.labelFormat",n);return n.width&&n.height?o.a.createElement(c.Chart,null,o.a.createElement(c.Settings,i()({},h,{showLegend:h.showLegend&&!t,locale:l.i18n.getLocale()})),e.map((e=>{var t;const a=e.key;return _(e)?o.a.createElement(c.BarSeries,{id:a,key:a,name:e.key,xScaleType:Object(u.getOr)(c.ScaleType.Linear,"configs.series.xScaleType",n),yScaleType:Object(u.getOr)(c.ScaleType.Linear,"configs.series.yScaleType",n),xAccessor:"x",yAccessors:A,timeZone:d,splitSeriesAccessors:F,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(u.get)("configs.series.stackAccessors",n),color:e.color?e.color:void 0,barSeriesStyle:Object(u.get)("configs.series.barSeriesStyle",n)}):null})),o.a.createElement(c.Axis,{id:g,position:c.Position.Bottom,showOverlappingTicks:!1,style:E,tickFormat:m,labelFormat:j}),o.a.createElement(c.Axis,{id:y,position:c.Position.Left,style:x,tickFormat:f,title:a})):null};P.displayName="BarChartBaseComponent";const D=o.a.memo(P);D.displayName="BarChartBase";const N=[],R=({barChart:e,configs:t,stackByField:a,scopeId:n,visualizationActionsOptions:l})=>{const{ref:c,width:d,height:p}=Object(x.b)(),f=Object(s.useMemo)((()=>null!=e&&null!=a?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<E.a.length?E.a[t]:void 0,dataProviderId:Object(h.i)(`draggable-legend-item-${Object(m.v4)()}-${a}-${e.key}`),scopeId:n,field:a,value:e.key}})):N),[e,a,n]),b=Object(u.get)("yAxisTitle",t),g=Object(u.get)("customHeight",t),y=Object(u.get)("customWidth",t),v=Object(k.g)(g,p),j=Object(k.h)(y,d),S=Object(s.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(k.f)(t)&&t.some(_);var t}),[e]);return o.a.createElement(k.d,null,o.a.createElement(I.a,{targetClassNames:[C.a]},S&&e&&o.a.createElement(k.a,{gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(k.c,{ref:c,height:v},o.a.createElement(D,{configs:t,data:e,yAxisTitle:b,forceHiddenLegend:null!=a,height:v,width:v}))),o.a.createElement(M,{grow:!1},o.a.createElement(w.a,{legendItems:f,height:p}))),!S&&o.a.createElement(O.a,{height:v,width:j,data:e}),null!=l&&o.a.createElement(T.a,i()({},l,{className:"viz-actions"}))))},L=o.a.memo(R,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&y()(e.configs,t.configs)&&y()(e.barChart,t.barChart)))},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),i=a.n(n),r=a(901),s=a(491),o=a(394);const l=Object(n.createContext)(void 0),c=Object(n.memo)((({id:e,indexName:t,scopeId:a,ruleId:c,children:u})=>{const{dataAsNestedObject:d,indexPattern:p,loading:m}=Object(r.a)({eventId:e,indexName:t}),f=Object(n.useMemo)((()=>e&&t&&a&&d?{eventId:e,indexName:t,scopeId:a,ruleId:null!=c?c:"",indexPattern:p,dataAsNestedObject:d}:void 0),[e,t,a,c,p,d]);return m?i.a.createElement(o.a,null):f?i.a.createElement(l.Provider,{value:f},u):i.a.createElement(s.a,null)}));c.displayName="PreviewPanelProvider";const u=()=>{const e=Object(n.useContext)(l);if(!e)throw new Error("PreviewPanelContext can only be used within PreviewPanelContext provider");return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a(4);const i=20,r=[5,10,20,50,n.pc],s="securitySolution.rulesTable"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(2),i=a(50),r=a(163),s=a(337);const o=["GET",a(341).a],l=e=>Object(i.useQuery)(o,(async({signal:e})=>(await Object(r.m)({signal:e})).stats),{...s.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"u",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"k",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"p",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"t",(function(){return m})),a.d(t,"B",(function(){return f})),a.d(t,"r",(function(){return b})),a.d(t,"x",(function(){return g})),a.d(t,"y",(function(){return y})),a.d(t,"a",(function(){return h})),a.d(t,"m",(function(){return v})),a.d(t,"b",(function(){return E})),a.d(t,"z",(function(){return x})),a.d(t,"i",(function(){return j})),a.d(t,"v",(function(){return S})),a.d(t,"A",(function(){return O})),a.d(t,"l",(function(){return k})),a.d(t,"q",(function(){return w})),a.d(t,"n",(function(){return T})),a.d(t,"s",(function(){return I})),a.d(t,"c",(function(){return C})),a.d(t,"w",(function(){return M})),a.d(t,"e",(function(){return _}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.navigation.overview",{defaultMessage:"Overview"}),r=n.i18n.translate("xpack.securitySolution.navigation.ecsDataQualityDashboard",{defaultMessage:"Data Quality"}),s=n.i18n.translate("xpack.securitySolution.navigation.entityRiskScore",{defaultMessage:"Entity Risk Score"}),o=n.i18n.translate("xpack.securitySolution.navigation.detectionResponse",{defaultMessage:"Detection & Response"}),l=n.i18n.translate("xpack.securitySolution.navigation.entityAnalytics",{defaultMessage:"Entity Analytics"}),c=n.i18n.translate("xpack.securitySolution.navigation.hosts",{defaultMessage:"Hosts"}),u=n.i18n.translate("xpack.securitySolution.navigation.gettingStarted",{defaultMessage:"Get started"}),d=n.i18n.translate("xpack.securitySolution.navigation.dashboards",{defaultMessage:"Dashboards"}),p=n.i18n.translate("xpack.securitySolution.navigation.coverageOverviewDashboard",{defaultMessage:"MITRE ATT&CKÂ® Coverage"}),m=n.i18n.translate("xpack.securitySolution.navigation.network",{defaultMessage:"Network"}),f=n.i18n.translate("xpack.securitySolution.navigation.users",{defaultMessage:"Users"}),b=n.i18n.translate("xpack.securitySolution.navigation.kubernetes",{defaultMessage:"Kubernetes"}),g=n.i18n.translate("xpack.securitySolution.navigation.rules",{defaultMessage:"Rules"}),y=n.i18n.translate("xpack.securitySolution.navigation.detectionRules",{defaultMessage:"Detection rules (SIEM)"}),h=n.i18n.translate("xpack.securitySolution.navigation.addRules",{defaultMessage:"Add Rules"}),v=n.i18n.translate("xpack.securitySolution.navigation.exceptions",{defaultMessage:"Shared exception lists"}),E=n.i18n.translate("xpack.securitySolution.navigation.alerts",{defaultMessage:"Alerts"}),x=n.i18n.translate("xpack.securitySolution.navigation.timelines",{defaultMessage:"Timelines"}),j=(n.i18n.translate("xpack.securitySolution.navigation.case",{defaultMessage:"Cases"}),n.i18n.translate("xpack.securitySolution.navigation.administration",{defaultMessage:"Administration"}),n.i18n.translate("xpack.securitySolution.search.administration.endpoints",{defaultMessage:"Endpoints"})),S=n.i18n.translate("xpack.securitySolution.navigation.administration.policies",{defaultMessage:"Policies"}),O=n.i18n.translate("xpack.securitySolution.search.administration.trustedApps",{defaultMessage:"Trusted applications"}),k=n.i18n.translate("xpack.securitySolution.search.administration.eventFilters",{defaultMessage:"Event filters"}),w=n.i18n.translate("xpack.securitySolution.search.administration.hostIsolationExceptions",{defaultMessage:"Host isolation exceptions"}),T=(n.i18n.translate("xpack.securitySolution.navigation.detect",{defaultMessage:"Detect"}),n.i18n.translate("xpack.securitySolution.navigation.findings",{defaultMessage:"Findings"}),n.i18n.translate("xpack.securitySolution.navigation.explore",{defaultMessage:"Explore"})),I=n.i18n.translate("xpack.securitySolution.navigation.manage",{defaultMessage:"Manage"}),C=n.i18n.translate("xpack.securitySolution.navigation.blocklist",{defaultMessage:"Blocklist"}),M=n.i18n.translate("xpack.securitySolution.navigation.responseActionsHistory",{defaultMessage:"Response actions history"}),_=(n.i18n.translate("xpack.securitySolution.navigation.protectionUpdates",{defaultMessage:"Protection updates"}),n.i18n.translate("xpack.securitySolution.navigation.newRuleTitle",{defaultMessage:"Create new rule"}));n.i18n.translate("xpack.securitySolution.navigation.threatIntelligence",{defaultMessage:"Intelligence"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n.d})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r}));var n=a(150);let i;!function(e){e.authentications="authentications",e.anomalies="anomalies",e.events="events",e.alerts="alerts",e.dns="dns",e.preview="preview"}(i||(i={}));const r={[i.alerts]:"aggregations.alertsGroup.buckets",[i.anomalies]:"aggregations.anomalyActionGroup.buckets",[i.authentications]:"aggregations.eventActionGroup.buckets",[i.dns]:"aggregations.dns_name_query_count.buckets",[i.events]:"aggregations.eventActionGroup.buckets",[i.preview]:"aggregations.preview.buckets"}},function(e,t,a){"use strict";a.d(t,"d",(function(){return n.q})),a.d(t,"c",(function(){return n.n})),a.d(t,"g",(function(){return f})),a.d(t,"e",(function(){return g})),a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return x})),a.d(t,"f",(function(){return j.a}));var n=a(163),i=a(117),r=a(50),s=a(765),o=a(4),l=a(532),c=a(1060),u=a(472),d=a(483);const p=["PUT",o.jb];var m=a(557);const f=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),a=Object(u.b)(),i=Object(d.b)(),o=Object(c.c)();return Object(r.useMutation)((e=>Object(n.y)({rule:Object(s.b)(e)})),{...e,mutationKey:p,onSettled:(...n)=>{var r;t(),a(),i();const[s]=n;s&&o(s),null==e||null===(r=e.onSettled)||void 0===r||r.call(e,...n)}})})({onError:t=>{e(t,{title:m.a})}})},b=["POST",o.jb],g=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),a=Object(u.b)(),i=Object(d.b)();return Object(r.useMutation)((e=>Object(n.d)({rule:Object(s.b)(e)})),{...e,mutationKey:b,onSettled:(...n)=>{t(),a(),i(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onError:t=>{e(t,{title:m.a})}})};var y=a(111),h=a(289),v=a(191);const E=y.object({page:y.number().int().min(0),perPage:y.number().int().min(0),total:y.number().int().min(0)}),x=y.object({field:v.e,order:h.g});var j=a(1059)},function(e,t,a){"use strict";let n,i;a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c.g})),a.d(t,"i",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"f",(function(){return f})),a.d(t,"c",(function(){return l.e})),function(e){e.timestamp="@timestamp",e.hostName="host.name",e.hostRiskScore="host.risk.calculated_score_norm",e.hostRisk="host.risk.calculated_level",e.userName="user.name",e.userRiskScore="user.risk.calculated_score_norm",e.userRisk="user.risk.calculated_level",e.alertsCount="alertsCount"}(n||(n={})),function(e){e.unknown="Unknown",e.low="Low",e.moderate="Moderate",e.high="High",e.critical="Critical"}(i||(i={}));const r=e=>"user"in e,s={[i.critical]:0,[i.high]:0,[i.low]:0,[i.moderate]:0,[i.unknown]:0};var o=a(4),l=a(403),c=a(150);const u=(e,t=!0,a)=>a?Object(l.f)(e):`${o.ac}${t?"latest_":""}${e}`,d=(e,t=!0,a)=>a?t?Object(l.f)(e):Object(l.g)(e):`${o.bc}${t?"latest_":""}${e}`,p=e=>({terms:{"host.name":e}}),m=e=>({terms:{"user.name":e}}),f=(e,t)=>t===l.e.host?{terms:{"host.name":e}}:{terms:{"user.name":e}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u}));var n={};a.r(n),a.d(n,"selectGlobalUrlParam",(function(){return r}));var i=a(421);const r=e=>e.globalUrlParam;var s=a(136),o=a.n(s),l=a(187);const c={},u=Object(l.reducerWithInitialState)(c).case(i.registerUrlParam,((e,{key:t,initialValue:a})=>void 0!==e[t]?(console.error(`Url param key '${t}' is already being used.`),e):{...e,[t]:a})).case(i.deregisterUrlParam,((e,{key:t})=>{const a={...e};return delete a[t],a})).case(i.updateUrlParam,((e,{key:t,value:a})=>void 0===e[t]||o()(e[t],a)?e:{...e,[t]:a})).build()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(612);a(74),a(268),a(269);var i=n.default({key:"css"}),r=i.flush,s=i.hydrate,o=i.cx,l=i.merge,c=i.getRegisteredStyles,u=i.injectGlobal,d=i.keyframes,p=i.css,m=i.sheet,f=i.cache;t.cache=f,t.css=p,t.cx=o,t.flush=r,t.getRegisteredStyles=c,t.hydrate=s,t.injectGlobal=u,t.keyframes=d,t.merge=l,t.sheet=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(74),i=a(268),r=a(269);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(n);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,a){var n=[],i=r.getRegisteredStyles(e,n,a);return n.length<2?a:i+t(n)}var u=function e(t){for(var a="",n=0;n<t.length;n++){var i=t[n];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var s in r="",i)i[s]&&s&&(r&&(r+=" "),r+=s);break;default:r=i}r&&(a&&(a+=" "),a+=r)}}return a};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var s=i.serializeStyles(a,t.registered,void 0);return r.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:a,cx:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return c(t.registered,a,u(n))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var r=i.serializeStyles(a,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var r=i.serializeStyles(a,t.registered),s="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+s+"{"+r.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,a)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(614),i=a(616),r=a(418);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(n),l=s(i),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=s(r).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,a){return g={name:t,styles:a,next:g},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,a){if(null==a)return"";if(void 0!==a.__emotion_styles)return a;switch(typeof a){case"boolean":return"";case"object":if(1===a.anim)return g={name:a.name,styles:a.styles,next:g},a.name;if(void 0!==a.styles){var n=a.next;if(void 0!==n)for(;void 0!==n;)g={name:n.name,styles:n.styles,next:g},n=n.next;return a.styles+";"}return function(e,t,a){var n="";if(Array.isArray(a))for(var i=0;i<a.length;i++)n+=b(e,t,a[i])+";";else for(var r in a){var s=a[r];if("object"!=typeof s)null!=t&&void 0!==t[s]?n+=r+"{"+t[s]+"}":p(s)&&(n+=m(r)+":"+f(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=b(e,t,s);switch(r){case"animation":case"animationName":n+=m(r)+":"+o+";";break;default:n+=r+"{"+o+"}"}}else for(var l=0;l<s.length;l++)p(s[l])&&(n+=m(r)+":"+f(r,s[l])+";")}return n}(e,t,a);case"function":if(void 0!==e){var i=g,r=a(e);return g=i,b(e,t,r)}}if(null==t)return a;var s=t[a];return void 0!==s?s:a}var g,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,a){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";g=void 0;var r=e[0];null==r||void 0===r.raw?(n=!1,i+=b(a,t,r)):i+=r[0];for(var s=1;s<e.length;s++)i+=b(a,t,e[s]),n&&(i+=r[s]);y.lastIndex=0;for(var l,c="";null!==(l=y.exec(i));)c+="-"+l[1];return{name:o.default(i)+c,styles:i,next:g}}},function(e,t,a){"use strict";e.exports=a(615)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,a=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),a=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&a)+(59797*(a>>>16)<<16);switch(i){case 3:a^=(255&e.charCodeAt(n+2))<<16;case 2:a^=(255&e.charCodeAt(n+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(n)))+(59797*(a>>>16)<<16)}return(((a=1540483477*(65535&(a^=a>>>13))+(59797*(a>>>16)<<16))^a>>>15)>>>0).toString(36)}},function(e,t,a){"use strict";e.exports=a(617)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(a){return void 0===t[a]&&(t[a]=e(a)),t[a]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof document,i=function(e,t,a){var i=e.key+"-"+t.name;(!1===a||!1===n&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,a){var n="";return a.split(" ").forEach((function(a){void 0!==e[a]?t.push(e[a]+";"):n+=a+" "})),n},t.insertStyles=function(e,t,a){i(e,t,a);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",o=t;do{var l=e.insert(t===o?"."+r:"",o,e.sheet,!0);n||void 0===l||(s+=l),o=o.next}while(void 0!==o);if(!n&&0!==s.length)return s}},t.registerStyles=i},,function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(110),i=a(200);const r=async e=>n.b.get().http.post(i.s,{body:JSON.stringify(e),version:"2023-10-31"}),s=async e=>n.b.get().http.post(i.z,{body:JSON.stringify(e),version:"2023-10-31"})},function(e,t,a){"use strict";(function(e){}).call(this,a(242).Buffer)},function(e,t,a){"use strict";(function(e){}).call(this,a(242).Buffer)},function(e,t,a){"use strict";const n=a(625);e.exports=class extends Error{constructor(e){super(e.filter((e=>""!==e)).map((e=>"string"==typeof e?e:e instanceof Error?e.message:n(e))).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}},function(e,t,a){"use strict";e.exports=function(...e){try{return JSON.stringify.apply(null,e)}catch(e){return"[Cannot display object: "+e.message+"]"}}},function(e,t,a){"use strict";(function(a){const n={};t=e.exports={array:Array.prototype,buffer:a&&a.prototype,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},n.typeMap=new Map([["[object Error]",t.error],["[object Map]",t.map],["[object Promise]",t.promise],["[object Set]",t.set],["[object WeakMap]",t.weakMap],["[object WeakSet]",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(a&&e instanceof a)return t.buffer;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const i=Object.prototype.toString.call(e);return n.typeMap.get(i)||t.generic}}).call(this,a(242).Buffer)},function(e,t,a){"use strict";(function(t){const n=a(270),i=a(440),r=a(441),s={};e.exports=s.merge=function(e,a,o){if(n(e&&"object"==typeof e,"Invalid target value: must be an object"),n(null==a||"object"==typeof a,"Invalid source value: must be null, undefined, or an object"),!a)return e;if(o=Object.assign({nullOverride:!0,mergeArrays:!0},o),Array.isArray(a)){n(Array.isArray(e),"Cannot merge array onto an object"),o.mergeArrays||(e.length=0);for(let t=0;t<a.length;++t)e.push(i(a[t],{symbols:o.symbols}));return e}const l=r.keys(a,o);for(let n=0;n<l.length;++n){const r=l[n];if("__proto__"===r||!Object.prototype.propertyIsEnumerable.call(a,r))continue;const c=a[r];if(c&&"object"==typeof c){if(e[r]===c)continue;!e[r]||"object"!=typeof e[r]||Array.isArray(e[r])!==Array.isArray(c)||c instanceof Date||t&&t.isBuffer(c)||c instanceof RegExp?e[r]=i(c,{symbols:o.symbols}):s.merge(e[r],c,o)}else(null!=c||o.nullOverride)&&(e[r]=c)}return e}}).call(this,a(242).Buffer)},function(e,t,a){"use strict";e.exports=function(){}},function(e,t,a){"use strict";(function(t){const n=a(626),i={mismatched:null};e.exports=function(e,t,a){return a=Object.assign({prototype:!0},a),!!i.isDeepEqual(e,t,a,[])},i.isDeepEqual=function(e,a,r,s){if(e===a)return 0!==e||1/e==1/a;const o=typeof e;if(o!==typeof a)return!1;if(null===e||null===a)return!1;if("function"===o){if(!r.deepFunction||e.toString()!==a.toString())return!1}else if("object"!==o)return e!=e&&a!=a;const l=i.getSharedType(e,a,!!r.prototype);switch(l){case n.buffer:return t&&t.prototype.equals.call(e,a);case n.promise:return e===a;case n.regex:return e.toString()===a.toString();case i.mismatched:return!1}for(let t=s.length-1;t>=0;--t)if(s[t].isSame(e,a))return!0;s.push(new i.SeenEntry(e,a));try{return!!i.isDeepEqualObj(l,e,a,r,s)}finally{s.pop()}},i.getSharedType=function(e,t,a){if(a)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?i.mismatched:n.getInternalProto(e);const r=n.getInternalProto(e);return r!==n.getInternalProto(t)?i.mismatched:r},i.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},i.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},i.isSetSimpleEqual=function(e,t){for(const a of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,a))return!1;return!0},i.isDeepEqualObj=function(e,t,a,r,s){const{isDeepEqual:o,valueOf:l,hasOwnEnumerableProperty:c}=i,{keys:u,getOwnPropertySymbols:d}=Object;if(e===n.array){if(!r.part){if(t.length!==a.length)return!1;for(let e=0;e<t.length;++e)if(!o(t[e],a[e],r,s))return!1;return!0}for(const e of t)for(const t of a)if(o(e,t,r,s))return!0}else if(e===n.set){if(t.size!==a.size)return!1;if(!i.isSetSimpleEqual(t,a)){const e=new Set(Set.prototype.values.call(a));for(const a of Set.prototype.values.call(t)){if(e.delete(a))continue;let t=!1;for(const n of e)if(o(a,n,r,s)){e.delete(n),t=!0;break}if(!t)return!1}}}else if(e===n.map){if(t.size!==a.size)return!1;for(const[e,n]of Map.prototype.entries.call(t)){if(void 0===n&&!Map.prototype.has.call(a,e))return!1;if(!o(n,Map.prototype.get.call(a,e),r,s))return!1}}else if(e===n.error&&(t.name!==a.name||t.message!==a.message))return!1;const p=l(t),m=l(a);if((t!==p||a!==m)&&!o(p,m,r,s))return!1;const f=u(t);if(!r.part&&f.length!==u(a).length&&!r.skip)return!1;let b=0;for(const e of f)if(r.skip&&r.skip.includes(e))void 0===a[e]&&++b;else{if(!c(a,e))return!1;if(!o(t[e],a[e],r,s))return!1}if(!r.part&&f.length-b!==u(a).length)return!1;if(!1!==r.symbols){const e=d(t),n=new Set(d(a));for(const i of e){if(!r.skip||!r.skip.includes(i))if(c(t,i)){if(!c(a,i))return!1;if(!o(t[i],a[i],r,s))return!1}else if(c(a,i))return!1;n.delete(i)}for(const e of n)if(c(a,e))return!1}return!0},i.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}}}).call(this,a(242).Buffer)},function(e,t,a){"use strict";e.exports=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")}},function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),i=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),i(a(442),t),i(a(633),t),i(a(988),t),i(a(355),t),i(a(989),t),i(a(443),t)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(355),i=a(443);t.default=(e,t)=>{let a;switch(e.code){case i.ZodIssueCode.invalid_type:a=e.received===n.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case i.ZodIssueCode.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(e.expected,n.util.jsonStringifyReplacer)}`;break;case i.ZodIssueCode.unrecognized_keys:a=`Unrecognized key(s) in object: ${n.util.joinValues(e.keys,", ")}`;break;case i.ZodIssueCode.invalid_union:a="Invalid input";break;case i.ZodIssueCode.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${n.util.joinValues(e.options)}`;break;case i.ZodIssueCode.invalid_enum_value:a=`Invalid enum value. Expected ${n.util.joinValues(e.options)}, received '${e.received}'`;break;case i.ZodIssueCode.invalid_arguments:a="Invalid function arguments";break;case i.ZodIssueCode.invalid_return_type:a="Invalid function return type";break;case i.ZodIssueCode.invalid_date:a="Invalid date";break;case i.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(a=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(a=`${a} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?a=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?a=`Invalid input: must end with "${e.validation.endsWith}"`:n.util.assertNever(e.validation):a="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case i.ZodIssueCode.too_small:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case i.ZodIssueCode.too_big:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case i.ZodIssueCode.custom:a="Invalid input";break;case i.ZodIssueCode.invalid_intersection_types:a="Intersection results could not be merged";break;case i.ZodIssueCode.not_multiple_of:a=`Number must be a multiple of ${e.multipleOf}`;break;case i.ZodIssueCode.not_finite:a="Number must be finite";break;default:a=t.defaultError,n.util.assertNever(e)}return{message:a}}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;const i=a(442),r=n(a(632));t.makeIssue=e=>{const{data:t,path:a,errorMaps:n,issueData:i}=e,r=[...a,...i.path||[]],s={...i,path:r};let o="";const l=n.filter((e=>!!e)).slice().reverse();for(const e of l)o=e(s,{data:t,defaultError:o}).message;return{...i,path:r,message:i.message||o}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,a){const n=(0,t.makeIssue)({issueData:a,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,(0,i.getErrorMap)(),r.default].filter((e=>!!e))});e.common.issues.push(n)};class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,a){const n=[];for(const i of a){if("aborted"===i.status)return t.INVALID;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const a=[];for(const e of t)a.push({key:await e.key,value:await e.value});return ParseStatus.mergeObjectSync(e,a)}static mergeObjectSync(e,a){const n={};for(const i of a){const{key:a,value:r}=i;if("aborted"===a.status)return t.INVALID;if("aborted"===r.status)return t.INVALID;"dirty"===a.status&&e.dirty(),"dirty"===r.status&&e.dirty(),"__proto__"===a.value||void 0===r.value&&!i.alwaysSet||(n[a.value]=r.value)}return{status:e.value,value:n}}}t.ParseStatus=ParseStatus,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(56),i=a.n(n);const r=e=>{const{from:t,to:a}=e,n=i()(a).diff(i()(t));return{kind:"absolute",fromStr:void 0,toStr:void 0,from:i()(t).subtract(n).toISOString(),to:i()(a).subtract(n).toISOString()}},s=e=>{const{from:t,to:a}=e,n=i()(a).diff(i()(t));return{kind:"absolute",fromStr:void 0,toStr:void 0,from:i()(t).add(n).toISOString(),to:i()(a).add(n).toISOString()}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(187),i=a(755),r=a(762);const s={},o=Object(n.reducerWithInitialState)(s).case(r.a,((e,{tableId:t,...a})=>({...e,[t]:{activeGroups:[],options:Object(i.c)(t),...e[t]?e[t]:{},...a}})))},function(e,t,a){"use strict";a.d(t,"b",(function(){return i}));var n=a(58);a.d(t,"a",(function(){return n.Direction}));const i=a(111).z.enum([n.Direction.asc,n.Direction.desc])},function(e,t,a){var n=a(638),i=a(639),r=i?function(e,t){return i.set(e,t),e}:n;e.exports=r},function(e,t,a){e.exports=a(24)(1630)},function(e,t,a){var n=a(999),i=n&&new n;e.exports=i},function(e,t,a){e.exports=a(24)(3406)},function(e,t,a){var n=a(642),i=a(643),r=a(1002),s=a(358),o=a(644),l=a(650),c=a(1018),u=a(457),d=a(359);e.exports=function e(t,a,p,m,f,b,g,y,h,v){var E=128&a,x=1&a,j=2&a,S=24&a,O=512&a,k=j?void 0:s(t);return function w(){for(var T=arguments.length,I=Array(T),C=T;C--;)I[C]=arguments[C];if(S)var M=l(w),_=r(I,M);if(m&&(I=n(I,m,f,S)),b&&(I=i(I,b,g,S)),T-=_,S&&T<v){var A=u(I,M);return o(t,a,e,w.placeholder,p,I,A,y,h,v-T)}var F=x?p:this,P=j?F[t]:t;return T=I.length,y?I=c(I,y):O&&T>1&&I.reverse(),E&&h<T&&(I.length=h),this&&this!==d&&this instanceof w&&(P=k||s(P)),P.apply(F,I)}}},function(e,t){var a=Math.max;e.exports=function(e,t,n,i){for(var r=-1,s=e.length,o=n.length,l=-1,c=t.length,u=a(s-o,0),d=Array(c+u),p=!i;++l<c;)d[l]=t[l];for(;++r<o;)(p||r<s)&&(d[n[r]]=e[r]);for(;u--;)d[l++]=e[r++];return d}},function(e,t){var a=Math.max;e.exports=function(e,t,n,i){for(var r=-1,s=e.length,o=-1,l=n.length,c=-1,u=t.length,d=a(s-l,0),p=Array(d+u),m=!i;++r<d;)p[r]=e[r];for(var f=r;++c<u;)p[f+c]=t[c];for(;++o<l;)(m||r<s)&&(p[f+n[o]]=e[r++]);return p}},function(e,t,a){var n=a(1003),i=a(647),r=a(648);e.exports=function(e,t,a,s,o,l,c,u,d,p){var m=8&t;t|=m?32:64,4&(t&=~(m?64:32))||(t&=-4);var f=[e,t,o,m?l:void 0,m?c:void 0,m?void 0:l,m?void 0:c,u,d,p],b=a.apply(void 0,f);return n(e)&&i(b,f),b.placeholder=s,r(b,e,t)}},function(e,t,a){var n=a(639),i=a(700),r=n?function(e){return n.get(e)}:i;e.exports=r},function(e,t,a){var n=a(450),i=a(453);function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}r.prototype=n(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t,a){var n=a(637),i=a(1008)(n);e.exports=i},function(e,t,a){var n=a(1009),i=a(1010),r=a(1011),s=a(1012);e.exports=function(e,t,a){var o=t+"";return r(e,i(o,s(n(o),a)))}},function(e,t,a){e.exports=a(24)(3374)},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,a){e.exports=a(24)(3362)},function(e,t,a){e.exports=a(24)(3373)},function(e,t,a){e.exports=a(24)(940)},function(e,t,a){e.exports=a(24)(3309)},function(e,t,a){var n=a(451);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(a){return null!=a&&a[e]===t&&(void 0!==t||e in Object(a))}}},function(e,t,a){e.exports=a(24)(1235)},function(e,t,a){e.exports=a(24)(3368)},function(e,t,a){var n=a(1052),i=a(657),r=a(653),s=a(456),o=a(451),l=a(312);e.exports=function(e,t,a,c){if(!o(e))return e;for(var u=-1,d=(t=i(t,e)).length,p=d-1,m=e;null!=m&&++u<d;){var f=l(t[u]),b=a;if("prototype"==f&&r(m))throw new Error("Illegal access of function prototype");if(u!=p){var g=hasOwnProperty.call(m,f)?m[f]:void 0;void 0===(b=c?c(g,f,m):void 0)&&(b=o(g)?g:s(t[u+1])?[]:{})}n(m,f,b),m=m[f]}return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));const n="securityUserFlyoutAssetTable",i=e=>e.get(n),r=(e,t,a)=>{const i=e.get(n);e.set(n,{...i,[t]:a})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__FOR_TESTING__resetDeprecationsSeen=t.ofType=t.combineEpics=t.StateObservable=t.createEpicMiddleware=void 0;var n=a(1056);Object.defineProperty(t,"createEpicMiddleware",{enumerable:!0,get:function(){return n.createEpicMiddleware}});var i=a(662);Object.defineProperty(t,"StateObservable",{enumerable:!0,get:function(){return i.StateObservable}});var r=a(1057);Object.defineProperty(t,"combineEpics",{enumerable:!0,get:function(){return r.combineEpics}});var s=a(1058);Object.defineProperty(t,"ofType",{enumerable:!0,get:function(){return s.ofType}});var o=a(458);Object.defineProperty(t,"__FOR_TESTING__resetDeprecationsSeen",{enumerable:!0,get:function(){return o.resetDeprecationsSeen}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateObservable=void 0;var n=a(38),i=a(3),r=function(e){function t(t,a){var n=e.call(this,(function(e){var t=n.__notifier.subscribe(e);return t&&!t.closed&&e.next(n.value),t}))||this;return n.__notifier=new i.Subject,n.value=a,t.subscribe((function(e){e!==n.value&&(n.value=e,n.__notifier.next(e))})),n}return n.__extends(t,e),t}(i.Observable);t.StateObservable=r},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(289),i=a(425),r=a(32);const s=`${r.c}: true`,o=`${r.c}: false`,l=`${r.a}: true`,c=`${r.a}: false`;function u({filter:e,showCustomRules:t,showElasticRules:a,enabled:u,tags:p,excludeRuleTypes:m=[],ruleExecutionStatus:f}){const b=[];var g;return null!=e&&e.length&&b.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&a||(a?b.push(s):t&&b.push(o)),void 0!==u&&b.push(u?l:c),null!=p&&p.length&&b.push(function(e){return`${r.g}:(${e.map(i.b).join(" AND ")})`}(p)),m.length&&b.push("NOT "+(g=m,`${r.d}: (${g.map(i.b).join(" OR ")})`)),f===n.f.succeeded?b.push(`${r.b}: "succeeded"`):f===n.f["partial failure"]?b.push(`${r.b}: "warning"`):f===n.f.failed&&b.push(`${r.b}: "failed"`),b.join(" AND ")}const d=[r.e,r.f.INDEX,r.f.TACTIC_ID,r.f.TACTIC_NAME,r.f.TECHNIQUE_ID,r.f.TECHNIQUE_NAME,r.f.SUBTECHNIQUE_ID,r.f.SUBTECHNIQUE_NAME]},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(131),r=n.__importDefault(a(375));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(49),r=a(707);const s=()=>{const{pathname:e}=Object(i.useLocation)(),t=Object(r.a)();return[Object(n.useMemo)((()=>t(e)),[e,t])]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(17),i=a(114),r=a(2),s=a.n(r),o=a(44);const l=a.n(o)()(n.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-1w6un7x-0"})([".euiPopover__anchor{width:100%;}"]),c=s.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:a,onCloseRequested:n,render:o})=>{const[c,u]=Object(r.useState)(null!=a&&e),[d,p]=Object(r.useState)(!1),[,m]=Object(r.useState)(void 0),f=Object(r.useRef)(null),b=Object(r.useCallback)((()=>{m((e=>{clearTimeout(e)})),p(!1),null!=n&&setTimeout((()=>{n()}))}),[n]),g=Object(r.useCallback)((()=>{m(Number(setTimeout((()=>{document.body.classList.contains(i.d)||p(!0)}),100)))}),[m,p]),y=Object(r.useCallback)((()=>{e||b()}),[e,b]),h=Object(r.useCallback)((e=>{c&&"Escape"===e.key&&y()}),[c,y]),v=Object(r.useMemo)((()=>s.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:g},o(d))),[g,o,d]);return Object(r.useEffect)((()=>{u(null!=a&&(d||e))}),[a,d,e]),Object(r.useEffect)((()=>{p(!1)}),[t]),Object(r.useEffect)((()=>{var e;c&&(null==f||null===(e=f.current)||void 0===e||e.positionPopoverFluid())}),[a,c]),s.a.createElement("div",{className:e?i.c:"",onMouseLeave:y},s.a.createElement(l,{ref:f,anchorPosition:"downCenter",button:v,closePopover:b,hasArrow:!1,isOpen:c,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},c?s.a.createElement("div",{onKeyDown:h},a):null))}));c.displayName="WithHoverActions"},,,,,,,function(e,t,a){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,a){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,a){"use strict";var n=a(286);e.exports=function(e,t){return e.length?(n(e,e.length,0,t),e):t}},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var n,i=[],r=-1;++r<e.length;)(n=e[r].resolveAll)&&i.indexOf(n)<0&&(t=n(t,a),i.push(n));return t}},function(e,t,a){"use strict";var n=a(288)(/[A-Za-z]/);e.exports=n},function(e,t,a){"use strict";var n=a(287),i=a(675),r=a(286),s=a(673),o=a(676),l=a(349),c=a(938),u=a(939),d=a(941),p=a(940),m={name:"labelEnd",tokenize:function(e,t,a){for(var n,i,r=this,o=r.events.length;o--;)if(("labelImage"===r.events[o][1].type||"labelLink"===r.events[o][1].type)&&!r.events[o][1]._balanced){n=r.events[o][1];break}return function(t){return n?n._inactive?c(t):(i=r.parser.defined.indexOf(s(r.sliceSerialize({start:n.end,end:r.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):a(t)};function l(a){return 40===a?e.attempt(f,t,i?t:c)(a):91===a?e.attempt(b,t,i?e.attempt(g,t,c):c)(a):i?t(a):c(a)}function c(e){return n._balanced=!0,a(e)}},resolveTo:function(e,t){for(var a,n,s,c,u,d,p,m=e.length,f=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){f=2;break}}else"labelEnd"===c.type&&(d=m);return a={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},n={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},s={type:"labelText",start:l(e[u+f+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",a,t],["enter",n,t]],e.slice(u+1,u+f+3)),p=i(p,[["enter",s,t]]),p=i(p,o(t.parser.constructs.insideSpan.null,e.slice(u+f+4,d-3),t)),p=i(p,[["exit",s,t],e[d-2],e[d-1],["exit",n,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",a,t]]),r(e,u,e.length,p),e},resolveAll:function(e){for(var t,a=-1;++a<e.length;)(t=e[a][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(a+1,"labelImage"===t.type?4:2),t.type="data",a++);return e}},f={tokenize:function(e,t,a){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?o(t):c(e,r,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function r(t){return n(t)?p(e,s)(t):o(t)}function s(t){return 34===t||39===t||40===t?d(e,p(e,o),a,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):o(t)}function o(n){return 41===n?(e.enter("resourceMarker"),e.consume(n),e.exit("resourceMarker"),e.exit("resource"),t):a(n)}}},b={tokenize:function(e,t,a){var n=this;return function(t){return u.call(n,e,i,a,"reference","referenceMarker","referenceString")(t)};function i(e){return n.parser.defined.indexOf(s(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))<0?a(e):t(e)}}},g={tokenize:function(e,t,a){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),n};function n(n){return 93===n?(e.enter("referenceMarker"),e.consume(n),e.exit("referenceMarker"),e.exit("reference"),t):a(n)}}};e.exports=m},function(e,t,a){const n=a(173);e.exports=(e,t,a)=>{const i=new n(e,a),r=new n(t,a);return i.compare(r)||i.compareBuild(r)}},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>n(e,t,a)<0},function(e,t,a){const n=a(173),i=a(540),{ANY:r}=i,s=a(217),o=a(541),l=a(538),c=a(680),u=a(603),d=a(539);e.exports=(e,t,a,p)=>{let m,f,b,g,y;switch(e=new n(e,p),t=new s(t,p),a){case">":m=l,f=u,b=c,g=">",y=">=";break;case"<":m=c,f=d,b=l,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let a=0;a<t.set.length;++a){const n=t.set[a];let s=null,o=null;if(n.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),s=s||e,o=o||e,m(e.semver,s.semver,p)?s=e:b(e.semver,o.semver,p)&&(o=e)})),s.operator===g||s.operator===y)return!1;if((!o.operator||o.operator===g)&&f(e,o.semver))return!1;if(o.operator===y&&b(e,o.semver))return!1}return!0}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(50);class SecuritySolutionQueryClient extends r.QueryClient{constructor(e={}){var t,a,n;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(a=null==e||null===(n=e.defaultOptions)||void 0===n?void 0:n.queries)&&void 0!==a?a:{}}}})}}const s=new SecuritySolutionQueryClient,o=Object(n.memo)((({queryClient:e,children:t})=>{const a=Object(n.useMemo)((()=>e||s),[e]);return i.a.createElement(r.QueryClientProvider,{client:a},t)}));o.displayName="ReactQueryClientProvider"},function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"p",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"n",(function(){return f})),a.d(t,"o",(function(){return b})),a.d(t,"g",(function(){return g})),a.d(t,"q",(function(){return y})),a.d(t,"x",(function(){return h})),a.d(t,"y",(function(){return v})),a.d(t,"t",(function(){return E})),a.d(t,"u",(function(){return x})),a.d(t,"s",(function(){return j})),a.d(t,"r",(function(){return S})),a.d(t,"b",(function(){return O})),a.d(t,"c",(function(){return k})),a.d(t,"a",(function(){return w})),a.d(t,"i",(function(){return T})),a.d(t,"d",(function(){return I})),a.d(t,"e",(function(){return C})),a.d(t,"v",(function(){return M})),a.d(t,"w",(function(){return _}));var n=a(2),i=a.n(n),r=a(5),s=a(47);const o=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),l=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),c=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryFieldRequiredError",{defaultMessage:"An ES|QL query is required."}),u=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),d=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),p=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),m=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),f=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),b=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),g=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),y=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),h=e=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:e}}),v=()=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabelWithoutName",{defaultMessage:"Load saved query dynamically on each rule execution"}),E=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),x=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),j=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),S=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),O=(r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})),k=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsSuppressLabel",{defaultMessage:"Suppress and group alerts for events with missing fields"}),w=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsDoNotSuppressLabel",{defaultMessage:"Do not suppress alerts for events with missing fields"}),T=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),I=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perRuleExecutionLabel",{defaultMessage:"Per rule execution"}),C=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perTimePeriodLabel",{defaultMessage:"Per time period"}),M=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.Su.perRuleExecutionWarning",{defaultMessage:"Per rule execution option is not available for Threshold rule type"}),_=e=>null!=e&&e.length?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionForFieldsLabel",defaultMessage:"Suppress alerts by selected fields: {fieldsString} (Technical Preview)",values:{fieldsString:i.a.createElement("strong",null,e.join(", "))}}):r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionLabel",{defaultMessage:"Suppress alerts (Technical Preview)"})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return ft}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(110);const c="commandInputHistory";var u=a(260),d=a(0),p=a.n(d);class parsed_command_input_ParsedCommand{constructor(e){p()(this,"name",void 0),p()(this,"args",void 0),p()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),a={name:f(t),args:{}};if(!t)return a;const n=t.indexOf(" "),i=-1===n?[]:t.substring(n).trim().split(/--/);for(const e of i){const t=e.trim();if(t){const e=/[ =]/.exec(t),n=(e?t.substring(0,e.index).trim():t).trim();if(n)if(a.args[n]||(a.args[n]=[]),n!==t&&e){let i=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===i.charAt(0)&&(i=i.substring(1)),'"'===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)),a.args[n].push(i)}else a.args[n].push(!0)}}return a})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const m=e=>new parsed_command_input_ParsedCommand(e),f=e=>{const t=e.trimStart();if(!t)return"";const a=e.indexOf(" ");return-1===a?t:t.substring(0,a)},b=e=>{let t="",a="";const n=[];if(e.args)for(const[i,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${i}`):r.exclusiveOr?n.push(`--${i}`):(a.length&&(a+=" "),a+=`--${i}`);const i=({required:e,exclusive:t,optional:a})=>`${e||""}${t?` ${t}`:""} ${a&&a.length>0?`[${a}]`:""}`.trim();return n.length>0?n.map((e=>i({required:t,exclusive:e,optional:a}))):t||a?[i({required:t,optional:a})]:[]};var g=a(5),y=a(51);const h=g.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),v=(e,t)=>{if(t&&t.argsWithValueSelectors)for(const n of Object.keys(t.argsWithValueSelectors))if(e.hasArg(n)){var a;const i=null!==(a=t.argState[n])&&void 0!==a?a:[];e.args[n]=i.map((e=>e.value))}},E=(e,{type:t,payload:a})=>{var n;switch(t){case"updateInputPopoverState":if(e.input.showPopover!==a.show)return{...e,input:{...e.input,showPopover:a.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(y.v4)(),input:a.command,display:null!==(n=a.display)&&void 0!==n?n:a.command},...e.input.history.slice(0,99)]}};case"clearInputHistoryState":return{...e,input:{...e.input,history:[]}};case"updateInputTextEnteredState":const{leftOfCursorText:t,rightOfCursorText:o="",argState:l}="function"==typeof a?a(e.input):a;if(e.input.leftOfCursorText!==t||e.input.rightOfCursorText!==o){var i;const a=m(t+o);let n=e.input.enteredCommand;if(n&&l&&(null===(i=n)||void 0===i?void 0:i.argState)!==l&&(n={...n,argState:l}),a.name&&(!n||a.name!==n.commandDefinition.name)||!a.name&&n){n=void 0;const t=e.commands.find((e=>e.name===a.name));if(t){let e;for(const[a,n]of Object.entries(null!==(r=t.args)&&void 0!==r?r:{})){var r;n.SelectorComponent&&(e||(e={}),e[a]=n)}n={argState:{},commandDefinition:t,argsWithValueSelectors:e}}}return v(a,n),{...e,input:{...e.input,leftOfCursorText:t,rightOfCursorText:o,parsedInput:a,enteredCommand:n}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==a.placeholder)return{...e,input:{...e.input,placeholder:a.placeholder||h}};break;case"setInputState":if(e.input.visibleState!==a.value)return{...e,input:{...e.input,visibleState:a.value}};break;case"updateInputCommandArgState":if(e.input.enteredCommand){var s;const{name:t,instance:n,state:i}=a,r=[...null!==(s=e.input.enteredCommand.argState[t])&&void 0!==s?s:[]];r[n]=i;const o={...e.input.enteredCommand,argState:{...e.input.enteredCommand.argState,[t]:r}},l=m(e.input.leftOfCursorText+e.input.rightOfCursorText);return v(l,o),{...e,input:{...e.input,parsedInput:l,enteredCommand:o}}}}return e};var x=a(47),j=a(199);const S=Object.freeze({mustHaveValue:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveValue",{defaultMessage:"Argument --{argName} must have a value",values:{argName:e}}),mustBeNumber:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeNumber",{defaultMessage:"Argument --${argName} value must be a number",values:{argName:e}}),mustBeGreaterThanZero:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeGreaterThanZero",{defaultMessage:"Argument --{argName} value must be greater than zero",values:{argName:e}}),NO_ARGUMENTS_SUPPORTED:g.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"}),missingRequiredArg:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: --{argName}",values:{argName:e}}),unsupportedArg:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: --{argName}",values:{argName:e}}),noMultiplesAllowed:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: --{argName}",values:{argName:e}}),argValueValidatorError:(e,t)=>g.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: --{argName}. {error}",values:{argName:e,error:t}}),missingArguments:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {missingArgs}",values:{missingArgs:e}}),MUST_HAVE_AT_LEAST_ONE_ARG:g.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}),onlyOneFromExclusiveOr:e=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:i.a.createElement(j.a,{bold:!0,inline:!0},e)}})),unknownArgument:(e,t,a)=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:e,command:i.a.createElement(j.a,{bold:!0,inline:!0},t),unknownArgs:i.a.createElement(j.a,{bold:!0,inline:!0},a)}}))});var O=a(115);const k=(e="")=>{const t=oe().state.dataTestSubj;return t?t+(e?`-${e}`:""):""},w=g.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),T=Object(n.memo)((({children:e,header:t=w,"data-test-subj":a})=>i.a.createElement("div",{"data-test-subj":a},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTextColor,{color:"danger"},t)),i.a.createElement(r.EuiSpacer,{size:"s"}),e)));T.displayName="UnsupportedMessageCallout";const I={className:"euiTruncateText"},C=Object(n.memo)((({commandDef:e})=>{const t=Object(n.useMemo)((()=>b(e).map(((t,a)=>i.a.createElement(i.a.Fragment,{key:`helpUsage-${a}`},a>0&&i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(j.a,null,`${e.name} ${t}`))))),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:I,titleProps:I}),i.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:i.a.createElement(j.a,null,e.exampleUsage)}],descriptionProps:I,titleProps:I}))}));C.displayName="CommandInputUsage";const M=Object(n.memo)((({commandDef:e,errorMessage:t})=>{const a=Object(O.a)(k()),s=Object(n.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),o=Object(n.useMemo)((()=>s&&e.args?Object.entries(e.args).reduce(((e,t)=>{const a={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(a):t[1].exclusiveOr?e.exclusiveOr.push(a):e.optional.push(a),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,s]),l=(t,n)=>{const s=n.map((e=>i.a.createElement("div",null,i.a.createElement(j.a,{bold:!0,inline:!0},e.title),i.a.createElement(j.a,{inline:!0}," - ",e.description))));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,t),description:s}],descriptionProps:I,titleProps:I,"data-test-subj":a("commandUsage-options")}))},c=Object(n.useCallback)((()=>t?i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":a("validationError")},i.a.createElement("div",{"data-test-subj":a("badArgument-message")},t),i.a.createElement(r.EuiSpacer,{size:"s"})):null),[t,a]);return i.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":a("commandUsage")},c(),i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:i.a.createElement(j.a,null,e.about)}],descriptionProps:I,titleProps:I,"data-test-subj":a("commandUsage-options")}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e}),o.required&&o.required.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),o.required),o.exclusiveOr&&o.exclusiveOr.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),o.exclusiveOr),o.optional&&o.optional.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),o.optional))}));M.displayName="CommandUsage";const _=Object(n.memo)((({title:e,children:t})=>{const a=Object(O.a)(k());return i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":a("helpOutput")},t)}));_.displayName="HelpOutput";const A=Object(n.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(n.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?i.a.createElement(t,e):i.a.createElement(_,{command:e.command,title:g.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},i.a.createElement(M,{commandDef:e.command.commandDefinition,errorMessage:e.store.errorMessage}))}));A.displayName="HelpCommandArgument";const F=Object(n.memo)((({command:e,setStatus:t})=>{const a=Object(O.a)(k()),s=Object(n.useMemo)((()=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:i.a.createElement(j.a,{bold:!0,inline:!0},e.input),helpIcon:i.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},"help"),boldHelp:i.a.createElement("strong",null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(n.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":a("unknownCommandError")},s)}));F.displayName="UnknownCommand";const P=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const s=Object(O.a)(k());return Object(n.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":s("badArgument")},i.a.createElement("div",{"data-test-subj":s("badArgument-message")},a.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e.commandDefinition}),i.a.createElement(j.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));P.displayName="BadArgument";const D=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const s=Object(O.a)(k());return Object(n.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"error"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":s("validationError")},i.a.createElement("div",{"data-test-subj":s("validationError-message")},a.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e.commandDefinition}),i.a.createElement(j.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));D.displayName="ValidationError";const N=e=>`--${e}`,R=(e,t)=>{const a=E(e,{type:"updateInputHistoryState",payload:{command:t.command.input,display:t.command.inputDisplay}});return a.commandHistory=[...e.commandHistory,t],a},L={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},B=(e={})=>({status:"pending",store:e}),z=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),q=(e,t=B(),a=!0)=>({id:Object(y.v4)(),isValid:a,enteredAt:(new Date).toISOString(),command:e,state:t}),$=()=>oe().dispatch,V=Object(n.memo)((({status:e,setStatus:t})=>{const a=$();return Object(n.useEffect)((()=>{"pending"===e&&a({type:"clear"}),t("success")}),[e,t,a]),null}));V.displayName="ClearCommand";var U=a(9);const H=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const a=Object.entries(e.args).reduce(((e,[a,n])=>n.required?(e[a]=n,e):n.exclusiveOr&&!t?(t=!0,e[a]=n,e):e),{});return`${e.name} --${Object.keys(a).join(" --")}`},Q=g.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),G=e=>e.replace(/[^A-Za-z0-9]/g,""),W=o()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10x4uz4-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),Z=o()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-10x4uz4-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),K=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-10x4uz4-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),J=o()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-10x4uz4-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),Y=o()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-10x4uz4-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),X=Object(n.memo)((({commands:e,display:t="default"})=>{const a=Object(O.a)(k("commandList")),s=$(),{docLinks:o}=Object(l.i)().services,c=Object(n.useMemo)((()=>{var e;return i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(Y,null,i.a.createElement(j.a,{inline:!0,bold:!0},null===(e=ne.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),u=Object(n.useCallback)((e=>()=>{s({type:"updateInputTextEnteredState",payload:()=>({leftOfCursorText:e,rightOfCursorText:""})}),s({type:"addFocusToKeyCapture"})}),[s]),d=Object(n.useMemo)((()=>{const t=new Map,a=e.filter((e=>!0!==e.helpHidden));for(const e of a){const{helpGroupLabel:a=Q,helpGroupPosition:n=1/0}=e,i=t.get(a);i?(i.list.push(e),i.position===1/0&&void 0!==n&&n!==i.position&&(i.position=n)):t.set(e.helpGroupLabel,{label:a,position:n,list:[e]})}return Object(U.sortBy)(Array.from(t.values()),"position").map((e=>{const t=e.list.map((e=>void 0===e.helpCommandPosition?{...e,helpCommandPosition:1/0}:e));return Object(U.sortBy)(t,"helpCommandPosition")}))}),[e]),p=Object(n.useCallback)((e=>e[0].helpGroupLabel===ae.supporting.label?[...ne,...e].map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:Q]:t}})):e.map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:Q]:t}}))),[]),m=Object(n.useCallback)((e=>{var t,n;const s=null!==(t=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==t?t:Q,o=G(s);return[{field:s,name:i.a.createElement("div",{"data-test-subj":a("group")},s),render:e=>{const t=H(e);return i.a.createElement(K,{alignItems:"center","data-test-subj":a(`${o}-${e.name}`)},i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":a("command"),listItems:[{title:i.a.createElement(r.EuiBadge,{"data-test-subj":a("commandName")},t),description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}]})),e.helpGroupLabel!==ae.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?g.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):g.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},i.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:u(`${t} `),isDisabled:!0===e.helpDisabled,"data-test-subj":a(`${o}-${e.name}-addToInput`)}))))}}]}),[a,u]),f=Object(n.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions â€” no need to wait for previous actions to complete."}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:i.a.createElement(r.EuiLink,{href:o.links.securitySolution.responseActions,target:"_blank","data-test-subj":a("helpfulHintDocLink")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=i.a.createElement(Z,{title:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"}),"data-test-subj":a("helpfulTips")},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(r.EuiText,{size:"s"},e))))));return i.a.createElement("div",{"data-test-subj":a()},d.map(((e,t)=>{var n;return i.a.createElement(W,{"data-test-subj":a(G(null!==(n=e[0].helpGroupLabel)&&void 0!==n?n:Q)),key:`styledEuiBasicTable-${t}`,items:p(e),columns:m(e)})})),t)}return i.a.createElement("div",{"data-test-subj":a()},i.a.createElement(r.EuiSpacer,{size:"s"}),d.map((e=>{const t=e[0].helpGroupLabel,n=f(e);return 0===n.length?null:i.a.createElement(J,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},n.map((e=>{const t=H(e);return i.a.createElement(r.EuiFlexItem,{key:e.name},i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(r.EuiToolTip,{content:t},i.a.createElement(Y,null,i.a.createElement(j.a,{inline:!0,bold:!0},t))),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":a("command")}))})))})),i.a.createElement(r.EuiSpacer,{size:"xl"}),c)}));X.displayName="CommandList";const ee=()=>oe().state.commands,te=Object(n.memo)((e=>{const t=ee(),a=oe().state.HelpComponent;return Object(n.useEffect)((()=>{a||e.setStatus("success")}),[a,e]),a?i.a.createElement(a,e):i.a.createElement(_,{command:e.command,title:g.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},i.a.createElement(X,{commands:t}))}));te.displayName="HelpCommand";const ae=Object.freeze({supporting:{label:g.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),ne=Object.freeze([{name:"--comment",about:g.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:g.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),ie=(e,t)=>{var a,n,r,s;let o=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(a=e.keyCapture)||void 0===a||null===(n=a.current)||void 0===n||n.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(s=r.current)||void 0===s||s.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(o={...e,footerContent:t.payload.value});break;case"executeCommand":o=((e,t)=>{const{parsedInput:a,enteredCommand:n,input:r}=t.payload;if(""===a.name)return e;const s=null==n?void 0:n.commandDefinition;if(!s)return R(e,q({input:a.input,inputDisplay:r,args:a,commandDefinition:{...L,RenderComponent:F}},void 0,!1));const o={input:a.input,inputDisplay:r,args:a,commandDefinition:s},l=(c=s.args)?Object.entries(c).filter((([e,t])=>t.required)).map((([e])=>e)):[];var c;const u=(e=>e?Object.entries(e).reduce(((e,[t,a])=>(a.exclusiveOr&&e.push(t),e)),[]):[])(s.args),d=S.onlyOneFromExclusiveOr(u.map(N).join(", "));if(a.hasArgs){if(a.hasArg("help")){if(Object.keys(a.args).length>1||a.args.help.length>1||!0!==a.args.help[0])return R(e,q(z(o,P),void 0,!1));if(null!=s&&s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(z(o,A),B({errorMessage:t}),!1))}return R(e,q(z(o,A),void 0,!1))}if(!s.args||0===Object.keys(s.args).length)return R(e,q(z(o,P),B({errorMessage:S.NO_ARGUMENTS_SUPPORTED}),!1));const t=((e,t)=>{const a=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||a.push(e)})),a})(a.args,s.args);if(t.length)return R(e,q(z(o,P),B({errorMessage:S.unknownArgument(t.length,a.name,t.map(N).join(", "))}),!1));for(const t of l)if(!a.args[t])return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.missingRequiredArg(t))}),!1));if(u.filter((e=>a.args[e])).length>1)return R(e,q(z(o,P),B({errorMessage:d}),!1));for(const t of Object.keys(a.args)){var p;const n=null===(p=s.args)||void 0===p?void 0:p[t],r=a.args[t];if(!n)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.unsupportedArg(t))}),!1));if(!n.allowMultiples&&Array.isArray(r)&&r.length>1)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.noMultiplesAllowed(t))}),!1));if(void 0!==n.mustHaveValue&&!1!==n.mustHaveValue){let a="";if(0===r.length?a=S.mustHaveValue(t):r.some(((e,i)=>{switch(n.mustHaveValue){case!0:case"non-empty-string":("boolean"==typeof e||"non-empty-string"===n.mustHaveValue&&0===e.trim().length)&&(a=S.mustHaveValue(t));break;case"truthy":e||(a=S.mustHaveValue(t));break;case"number":case"number-greater-than-zero":{const s=Number(e);Number.isSafeInteger(s)?"number-greater-than-zero"===n.mustHaveValue&&s<=0&&(a=S.mustBeGreaterThanZero(t)):a=S.mustBeNumber(t),a||(r[i]=s)}}return!!a})),a)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,a)}),!1))}if(n.validate){const a=n.validate(r);if(!0!==a)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.argValueValidatorError(t,a))}),!1))}}}else{if(l.length>0)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.missingArguments(l.map((e=>N(e))).join(", ")))}),!1));if(u.length>0)return R(e,q(z(o,P),B({errorMessage:d}),!1));if(s.mustHaveArgs)return R(e,q(z(o,P),B({errorMessage:i.a.createElement(j.a,null,S.MUST_HAVE_AT_LEAST_ONE_ARG)}),!1))}if(s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(z(o,D),B({errorMessage:t}),!1))}return R(e,q(o))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":o=((e,{type:t,payload:{id:a,value:n}})=>{let i=!1;const r=e.commandHistory.map((e=>{if(i||e.id!==a)return e;i=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=n(r.state.store);break;case"updateCommandStatusState":if(r.state.status===n)return i=!1,e;r.state.status=n}return r}));return i?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":o=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"clearInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":case"updateInputCommandArgState":o=E(e,t);break;case"clear":o={...e,commandHistory:[]}}return o},re=Object(n.createContext)(null),se=Object(n.memo)((({commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:s,storagePrefix:o,managedKey:d,children:p})=>{const[f,b]=Object(u.d)(d),y=(e=>{const{storage:t}=Object(l.i)().services;return Object(n.useMemo)((()=>{if(e){var a;const n=null!==(a=t.get(`${e}.${c}`))&&void 0!==a?a:{version:2,data:[]};return 2!==n.version&&(e=>{const{data:t,version:a}=e;for(const e of t)a<2&&(e.display=e.input);e.version=2})(n),n.data}return[]}),[t,e])})(o),v=(e=>{const{storage:t}=Object(l.i)().services;return Object(n.useCallback)((a=>{if(e){const n={version:2,data:a};t.set(`${e}.${c}`,n)}}),[t,e])})(o),E=Object(n.useCallback)((e=>{const t=(({commands:e,...t},a)=>{const n=[{name:"help",about:g.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:te,helpGroupLabel:ae.supporting.label,helpCommandPosition:1},{name:"clear",about:g.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:V,helpGroupLabel:ae.supporting.label,helpCommandPosition:0}].concat(e),i=null!=a?a:{commands:n,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{leftOfCursorText:"",rightOfCursorText:"",parsedInput:m(""),enteredCommand:void 0,placeholder:h,showPopover:void 0,history:[],visibleState:void 0}};return a&&Object.assign(i,{commands:n,...t}),i})(e,f?f():void 0);return t.input.history=y,t}),[f,y]),[x,j]=Object(n.useReducer)(ie,{commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:s,storagePrefix:o},E);return Object(n.useEffect)((()=>{b&&b(x)}),[x,b]),Object(n.useEffect)((()=>{o&&x.input.history&&v(x.input.history)}),[v,x.input.history,o]),i.a.createElement(re.Provider,{value:{state:x,dispatch:j}},p)}));se.displayName="ConsoleStateProvider";const oe=()=>{const e=Object(n.useContext)(re);if(!e)throw new Error("ConsoleStateContext not defined");return e},le=()=>oe().state.input.visibleState,ce=Object(n.memo)((()=>{const e=oe().state.footerContent,t=Object(O.a)(k()),a=le(),s=Object(n.useMemo)((()=>"error"===a?"danger":"subdued"),[a]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},i.a.createElement(r.EuiText,{size:"xs",color:s,className:"font-style-italic"},e||i.a.createElement(i.a.Fragment,null,"Â ")))}));ce.displayName="ConsoleFooter";const ue=()=>oe().state.sidePanel,de=(g.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonTitle",{defaultMessage:"Help"}),g.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"})),pe=o()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-lvlnbi-0"})(["margin-left:auto;height:inherit;"]),me=Object(n.memo)((({TitleComponent:e})=>{const t=$(),a=ue().show,s=Object(O.a)(k("header")),o="help"===a,l=Object(n.useCallback)((()=>{t({type:"showSidePanel",payload:{show:o?null:"help"}})}),[t,o]);return i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate noThemeOverrides","data-test-subj":s("titleComponentContainer")},e?i.a.createElement(e,null):""),!o&&i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(pe,{style:{marginLeft:"auto"},onClick:l,iconType:"help",title:de,"aria-label":de,isSelected:o,"data-test-subj":s("helpButton")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));me.displayName="ConsoleHeader";var fe=a(23),be=a.n(fe),ge=a(59),ye=a.n(ge);const he=()=>{const{leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:i}=oe().state.input;return Object(n.useMemo)((()=>({leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:i,fullTextEntered:e+t})),[i,e,a,t])},ve=o.a.div.withConfig({displayName:"InputDisplayContainer",componentId:"sc-cduvts-0"})(["overflow:hidden !important;.inputDisplay{& > *{flex-direction:row;align-items:center;}}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}"],(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor)),Ee=Object(n.memo)((({leftOfCursor:e,rightOfCursor:t})=>{const a=Object(O.a)(k()),s=$(),{leftOfCursorText:o,fullTextEntered:l}=he(),c=Object(n.useRef)(null),u=Object(n.useRef)(null),d=Object(n.useRef)(null),p=o.length,m=Object(n.useCallback)((e=>{const t=e.target;if(l.length&&t.classList&&t.classList.contains("chr")){const a=Array.from(e.currentTarget.querySelectorAll("span.chr")).indexOf(t),n=l.substring(0,a+1),i=l.substring(a+1);s({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n,rightOfCursorText:i}})}}),[s,l]);return Object(n.useEffect)((()=>{if(u.current){const e=e=>{if(u.current){const t=e[0];if(t&&t.rootBounds){const e=u.current.scrollLeft,a=t.rootBounds.right,n=t.rootBounds.left,i=t.boundingClientRect.right;if(i>a-20){const a=e+(i-t.rootBounds.width)+20;u.current.scrollLeft=a}else if(i<n+20){const t=i-20<0?0:e-20;u.current.scrollLeft=t}}}};return c.current=new IntersectionObserver(e,{root:u.current,rootMargin:"0px -10px",threshold:0}),()=>{var e;null===(e=c.current)||void 0===e||e.disconnect(),c.current=null}}}),[]),Object(n.useEffect)((()=>{if(c.current&&d.current){const e=c.current,t=d.current;return e.observe(t),()=>{e.unobserve(t)}}}),[p]),i.a.createElement(ve,{ref:u},i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",className:"inputDisplay",onClick:m},i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":a("cmdInput-leftOfCursor"),className:"noMinWidth"},e),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"noMinWidth"},i.a.createElement("span",{className:"cursor essentialAnimation",ref:d})),i.a.createElement(r.EuiFlexItem,{className:"noMinWidth","data-test-subj":a("cmdInput-rightOfCursor")},t)))}));Ee.displayName="InputDisplay";const xe=()=>oe().state.input.showPopover,je=o.a.span.withConfig({displayName:"ArgumentSelectorWrapperContainer",componentId:"sc-jnz75k-0"})(["border:",";border-radius:",";overflow:hidden;user-select:none;.flexGroup{align-items:stretch;}.selectorContainer{padding:0 ",";max-width:25vw;display:flex;align-items:center;height:100%;}.argNameContainer{background-color:",";}.argName{padding-left:",";height:100%;display:flex;align-items:center;white-space:nowrap;}"],(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormInputGroupLabelBackground),(({theme:{eui:e}})=>e.euiSizeXS)),Se=Object(n.memo)((({argName:e,argIndex:t,argDefinition:{SelectorComponent:a}})=>{const s=$(),{valueText:o,value:l,store:c}=((e,t)=>{const a=oe().state.input.enteredCommand;return Object(n.useMemo)((()=>{var n;const i=null==a||null===(n=a.argState[e])||void 0===n?void 0:n.at(t);return null!=i?i:{value:void 0,valueText:""}}),[e,a,t])})(e,t),u=Object(n.useCallback)((a=>{s({type:"updateInputCommandArgState",payload:{name:e,instance:t,state:a}})}),[t,e,s]);return i.a.createElement(je,{className:"eui-displayInlineBlock"},i.a.createElement(r.EuiFlexGroup,{className:"flexGroup",responsive:!1,alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"argNameContainer"},i.a.createElement("div",{className:"argName"},i.a.createElement("span",null,`--${e}=`))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement("div",{className:"selectorContainer noThemeOverrides eui-textTruncate"},i.a.createElement(a,{value:l,valueText:null!=o?o:"",argName:e,argIndex:t,store:c,onChange:u})))))}));Se.displayName="ArgumentSelectorWrapper";const Oe=[""," ","="],ke=(e={})=>({value:"",renderValue:null,isArgSelector:!1,argName:"",argIndex:0,argState:void 0,...e}),we=e=>e.split("").map((e=>ke({value:e,renderValue:e}))),Te=(e,t,a)=>{var n;return i.a.createElement("span",{className:"chr",key:`${e}.${a}.${null!==(n=t.value)&&void 0!==n?n:"$"}`},t.renderValue)},Ie=(e,t)=>{let a=t.value;var n,i;return e&&t.isArgSelector&&(a+=`="${null!==(n=null===(i=t.argState)||void 0===i?void 0:i.valueText)&&void 0!==n?n:""}"`),a};class entered_input_EnteredInput{constructor(e,t,a,n){if(p()(this,"leftOfCursorContent",void 0),p()(this,"rightOfCursorContent",void 0),p()(this,"canHaveArgValueSelectors",void 0),p()(this,"argState",void 0),this.leftOfCursorContent=we(e),this.rightOfCursorContent=we(t),this.canHaveArgValueSelectors=Boolean(null==n?void 0:n.argsWithValueSelectors),a.hasArgs&&n&&n.argsWithValueSelectors){this.argState=n.argState;const s=[{input:e,items:this.leftOfCursorContent,side:"left"},{input:t,items:this.rightOfCursorContent,side:"right"}];for(const[e,o]of Object.entries(n.argsWithValueSelectors))if(a.hasArg(e)){let a=0;for(const{input:l,items:c,side:u}of s){const s=`--${e}`;let d=l.indexOf(s);for(;d>-1;){const p=s.length,m=d+p,f=l.charAt(m),b="left"===u&&""===f&&Oe.includes(t.charAt(0));if(Oe.includes(f)&&(b||"left"===u&&""!==f||"right"===u)){var r;const t=Array.from({length:p},ke),l=null===(r=n.argState[e])||void 0===r?void 0:r.at(a);t[0]=ke({value:s,renderValue:i.a.createElement(Se,{argName:e,argIndex:a,argDefinition:o}),isArgSelector:!0,argName:e,argIndex:a++,argState:l}),c.splice(d,p,...t)}d=l.indexOf(s,m)}}}this.leftOfCursorContent=this.leftOfCursorContent.filter((({value:e})=>e.length>0)),this.rightOfCursorContent=this.rightOfCursorContent.filter((({value:e})=>e.length>0))}}replaceSelection(e,t){const a=this.getFullText(),n=t?ke({value:t}):void 0;let i=a.indexOf(e);const r=[...this.leftOfCursorContent,...this.rightOfCursorContent];this.canHaveArgValueSelectors&&r.forEach(((e,t)=>{e.isArgSelector&&t<i&&(i-=e.value.length-1)}));const s=r.splice(i,e.length);n&&(r.splice(i,0,n),i++),this.leftOfCursorContent=r.splice(0,i),this.rightOfCursorContent=r,this.removeArgState(s)}removeArgState(e){if(this.argState){let a=!1;const n={...this.argState};for(const{argName:i,argIndex:r,isArgSelector:s}of e){var t;s&&null!==(t=n[i])&&void 0!==t&&t.at(r)&&(n[i]=n[i].filter(((e,t)=>t!==r)),a=!0)}a&&(this.argState=n)}}getLeftOfCursorText(e=!1){return this.leftOfCursorContent.map(Ie.bind(null,e)).join("")}getRightOfCursorText(e=!1){return this.rightOfCursorContent.map(Ie.bind(null,e)).join("")}getFullText(e=!1){return this.getLeftOfCursorText(e)+this.getRightOfCursorText(e)}getLeftOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.leftOfCursorContent.map(Te.bind(null,"left")))}getRightOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.rightOfCursorContent.map(Te.bind(null,"right")))}getArgState(){return this.argState}moveCursorTo(e){switch(e){case"end":this.leftOfCursorContent.push(...this.rightOfCursorContent.splice(0));break;case"home":this.rightOfCursorContent.unshift(...this.leftOfCursorContent.splice(0));break;case"left":if(this.leftOfCursorContent.length){const e=this.leftOfCursorContent.pop();e&&this.rightOfCursorContent.unshift(e)}break;case"right":if(this.rightOfCursorContent.length){const e=this.rightOfCursorContent.shift();e&&this.leftOfCursorContent.push(e)}}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):e&&this.leftOfCursorContent.push(ke({value:e}))}deleteChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.rightOfCursorContent.shift();null!=e&&e.isArgSelector&&this.removeArgState([e])}}backspaceChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.leftOfCursorContent.pop();null!=e&&e.isArgSelector&&this.removeArgState([e])}}clear(){this.leftOfCursorContent=[],this.rightOfCursorContent=[],this.argState=void 0}}const Ce=g.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),Me=()=>{const e=getSelection();e&&e.removeAllRanges()},_e=o.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-19dx6ae-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),Ae=Object(n.memo)((({onCapture:e,focusRef:t,onChangeFocus:a,children:r})=>{const s=Object(O.a)(k()),o=Object(n.useRef)(null),l=Object(n.useRef)(null),c=Object(n.useRef)(null),u=Object(n.useCallback)((()=>{if(o.current){var e,t,a;const n=document.getSelection(),i=(null!==(e=null==n?void 0:n.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!o.current||!n)&&(null===(t=o.current)||void 0===t?void 0:t.contains(n.focusNode))&&(null===(a=o.current)||void 0===a?void 0:a.contains(n.anchorNode));return n&&0!==i.length&&r?i:""}return""}),[]),d=Object(n.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&l.current){const t=document.createRange();t.selectNodeContents(l.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const a=/^[\w\d]{2}/.test(t.key)?"":t.key,n=u(),i=Object(U.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:a,selection:n,eventDetails:i}),n&&Me()}),[u,e]),p=Object(n.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const a=t.clipboardData.getData("text").replace(/[\r\n]/g,""),n=u();e({value:a,selection:n,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),n&&Me()}),[u,e]),m=Object(n.useCallback)((()=>{a&&a(!0)}),[a]),f=Object(n.useCallback)((()=>{a&&a(!1)}),[a]),b=Object(n.useMemo)((()=>({focus:(e=!1)=>{var t,a,n;!e&&(null!==(t=null===(a=window.getSelection())||void 0===a?void 0:a.toString())&&void 0!==t?t:"").length>0||document.activeElement===c.current||null===(n=c.current)||void 0===n||n.focus()},blur:()=>{var e;c.current&&document.activeElement===c.current&&(null===(e=c.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=b),i.a.createElement(_e,{"data-test-subj":s("inputCapture"),onKeyDown:d,onPaste:p},i.a.createElement("div",{role:"textbox","aria-placeholder":Ce,tabIndex:0,ref:o,className:"focus-container","data-test-subj":s("keyCapture-input"),onBlur:f,onFocus:m},i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("div",{ref:l,className:"text-container"},r),i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("input",{ref:c,type:"text",value:"",tabIndex:-1,onPaste:p,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));Ae.displayName="InputCapture";const Fe=g.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),Pe=g.i18n.translate("xpack.securitySolution.useInputHints.viewInputHistory",{defaultMessage:"Press the up arrow key to access previously entered commands"}),De=o()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-6afwlc-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";user-select:none;"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Ne=Object(n.memo)((()=>{const{fullTextEntered:e}=he(),t=oe().state.input.placeholder,a=Object(O.a)(k());return e.length>0?null:i.a.createElement(De,{size:"s",className:"eui-textTruncate","data-test-subj":a("inputPlaceholder")},i.a.createElement("div",{className:"eui-textTruncate"},t))}));Ne.displayName="InputPlaceholder";const Re=o()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-qp7srp-0"})(["padding-left:0;"]),Le=Object(n.memo)((({input:e,isValid:t=!0})=>{const a=Object(O.a)(k()),s=Object(n.useMemo)((()=>t?e:i.a.createElement(r.EuiTextColor,null,e)),[e,t]);return i.a.createElement(Re,{transparentBackground:!0,"data-test-subj":a("userCommandText")},s)}));Le.displayName="UserCommandInput";const Be=Object(n.memo)((()=>{const[e,t]=Object(n.useState)(!1),a=$(),s=Object(O.a)(k()),o=Object(n.useCallback)((()=>{t(!0)}),[]),l=Object(n.useCallback)((()=>{t(!1)}),[]),c=Object(n.useCallback)((()=>{a({type:"clearInputHistoryState"}),t(!1)}),[a]);return i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(r.EuiConfirmModal,{title:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmTitle",{defaultMessage:"Clear input history"}),cancelButtonText:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmSubmitButton",{defaultMessage:"Clear"}),buttonColor:"danger",onCancel:l,onConfirm:c},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.confirmMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})),i.a.createElement(r.EuiFlexGroup,{responsive:!1,justifyContent:"flexEnd",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{size:"xs",tabIndex:-1,onClick:o,disabled:e,"data-test-subj":s("clearInputHistoryButton")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.clearHistoryButtonLabel",defaultMessage:"Clear input history"})))))}));Be.displayName="CommandInputClearHistory";const ze=g.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),qe=g.i18n.translate("xpack.securitySolution.commandInputHistory.filterPlaceholder",{defaultMessage:"Filter previously entered actions"}),$e=g.i18n.translate("xpack.securitySolution.commandInputHistory.noFilteredMatchesFoundMessage",{defaultMessage:"No entries found matching the filter entered"}),Ve=Object(n.memo)((()=>{const e=$(),t=oe().state.input.history,[a]=Object(n.useState)(he()),s=Object(n.useRef)(!1),o=Object(O.a)(k()),l=Object(n.useMemo)((()=>t.map(((e,t)=>({label:e.display,key:e.id,data:e})))),[t]),c=Object(n.useMemo)((()=>({showIcons:!1,bordered:!0})),[]),u=Object(n.useMemo)((()=>({placeholder:qe,compressed:!0,fullWidth:!0})),[]),d=Object(n.useCallback)(((e,a)=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(r.EuiSpacer,{size:"s"}),t.length>0?a:i.a.createElement("div",{tabIndex:-1}))),[t.length]),p=Object(n.useCallback)((t=>{s.current=!0;const a=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),a&&e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.data.input,rightOfCursorText:""}}),e({type:"addFocusToKeyCapture"})}),[e]),m=Object(n.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),f=Object(n.useCallback)((e=>i.a.createElement(Le,{input:e.label})),[]);return Object(n.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}),()=>{s.current||(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.leftOfCursorText,rightOfCursorText:a.rightOfCursorText}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,s,a]),i.a.createElement("div",null,t.length>0&&i.a.createElement(Be,null),i.a.createElement(r.EuiSelectable,{options:l,onChange:p,onActiveOptionChange:m,renderOption:f,listProps:c,singleSelection:!0,searchable:!0,searchProps:u,emptyMessage:ze,noMatchesMessage:$e,"data-test-subj":o("inputHistorySelector"),"data-console-input-history":!0},d))}));Ve.displayName="CommandInputHistory";const Ue=Object(n.memo)((({children:e,width:t="92vw"})=>{const a=Object(O.a)(k()),s=xe(),o=void 0!==s,l=$(),c=Object(n.useMemo)((()=>({width:t,borderBottomLeftRadius:0,borderBottomRightRadius:0})),[t]),u=Object(n.useMemo)((()=>({clickOutsideDisables:!0})),[]),d=Object(n.useCallback)((()=>{l({type:"updateInputPopoverState",payload:{show:void 0}}),l({type:"addFocusToKeyCapture"})}),[l]);return Object(n.useEffect)((()=>{s||l({type:"addFocusToKeyCapture"})}),[l,s]),i.a.createElement(r.EuiPopover,{button:e,closePopover:d,isOpen:o,panelStyle:c,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:u,ownFocus:!1,"data-test-subj":a("inputPopover")},s&&i.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===s&&i.a.createElement(Ve,null)))}));Ue.displayName="InputAreaPopover";const He=o.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-ujnhrt-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}&.withPopover{border-top-left-radius:0;border-top-right-radius:0;}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiTextColor)),Qe=Object(n.memo)((({prompt:e="",focusRef:t,...a})=>{(()=>{const e=$(),t=Boolean(xe()),a=(()=>{const e=oe().state.input.parsedInput;return-1!==e.input.trimStart().indexOf(" ")?e.name:""})(),i=ee(),{leftOfCursorText:r}=he(),s=Object(n.useMemo)((()=>{if(a)return i.find((e=>e.name===a))}),[a,i]);Object(n.useEffect)((()=>{if(a&&!t)if(s&&!0!==s.helpHidden){var n,i;const t=null!==(n=null==s?void 0:s.exampleInstruction)&&void 0!==n?n:"",a=null!==(i=null==s?void 0:s.exampleUsage)&&void 0!==i?i:"";let r=null!=t?t:"";if(a&&(r+=t?` ${g.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:a}})}`:a),!r||!a){const e=b(s);e.length>0?r+=`${s.name} ${e}`:r+=Fe}e({type:"updateFooterContent",payload:{value:r}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(o=a,g.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:o}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:r||t?"":Pe}}),e({type:"setInputState",payload:{value:void 0}});var o}),[a,s,e,t,r])})();const s=Object(O.a)(k()),o=$(),{rightOfCursorText:l,leftOfCursorText:c,fullTextEntered:u,enteredCommand:d,parsedInput:p}=he(),m=le(),f=!!xe(),[y,h]=Object(n.useState)(!1),[v,E]=Object(n.useState)(void 0),[x,j]=Object(n.useState)("94vw"),S=Object(n.useRef)(null),w=t||S,T=Object(n.useMemo)((()=>ye()({cmdInput:!0,hasFocus:y,error:"error"===m,withPopover:f})),[y,f,m]),I=Object(n.useMemo)((()=>0===u.trim().length),[u]),C=Object(n.useMemo)((()=>new entered_input_EnteredInput(c,l,p,d)),[d,c,p,l]),M=Object(n.useCallback)((({width:e})=>{e>0&&j(`${e}px`)}),[]),_=Object(n.useCallback)((()=>{E({input:C.getFullText(!0),enteredCommand:d,parsedInput:p})}),[d,p,C]),A=Object(n.useCallback)((e=>{h(e)}),[]),F=Object(n.useCallback)((e=>{w.current&&w.current.focus(),f&&o({type:"updateInputPopoverState",payload:{show:void 0}})}),[o,f,w]),P=Object(n.useCallback)((({value:e,selection:t,eventDetails:a})=>{const n=a.keyCode;if(38===n)return o({type:"removeFocusFromKeyCapture"}),void o({type:"updateInputPopoverState",payload:{show:"input-history"}});o({type:"updateInputTextEnteredState",payload:({leftOfCursorText:a,rightOfCursorText:i,enteredCommand:r,parsedInput:s})=>{const o=new entered_input_EnteredInput(a,i,s,r);switch(o.addValue(null!=e?e:"",t),n){case 8:o.backspaceChar(t);break;case 46:o.deleteChar(t);break;case 13:E({input:o.getFullText(!0),enteredCommand:r,parsedInput:s}),o.clear();break;case 37:o.moveCursorTo("left");break;case 39:o.moveCursorTo("right");break;case 36:o.moveCursorTo("home");break;case 35:o.moveCursorTo("end")}return{leftOfCursorText:o.getLeftOfCursorText(),rightOfCursorText:o.getRightOfCursorText(),argState:o.getArgState()}}})}),[o]);return Object(n.useEffect)((()=>{v&&(o({type:"executeCommand",payload:v}),E(void 0),o({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}))}),[v,o]),i.a.createElement(Ue,{width:x},i.a.createElement(r.EuiResizeObserver,{onResize:M},(n=>i.a.createElement(He,be()({},a,{className:T,onClick:F,ref:n,"data-test-subj":s("cmdInput-container")}),i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},e&&i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":s("cmdInput-prompt")},i.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),i.a.createElement(r.EuiFlexItem,{className:"textEntered"},i.a.createElement(Ae,{onCapture:P,onChangeFocus:A,focusRef:t},i.a.createElement(Ee,{leftOfCursor:C.getLeftOfCursorRenderingContent(),rightOfCursor:C.getRightOfCursorRenderingContent()})),i.a.createElement(Ne,null)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"data-test-subj":s("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",color:"primary",isDisabled:I,onClick:_})))))))}));Qe.displayName="CommandInput";var Ge=a(56),We=a.n(Ge);const Ze=Object(n.memo)((({size:e="s",color:t,children:a,"data-test-subj":n,className:s})=>{const{euiTheme:o}=Object(r.useEuiTheme)();return i.a.createElement(r.EuiText,{size:e,"data-test-subj":n,className:`font-family-code ${null!=s?s:""}`},i.a.createElement(r.EuiTextColor,{color:null!=t?t:o.colors.text},a))}));Ze.displayName="ConsoleText";const Ke=Object(n.memo)((()=>{const e=Object(O.a)(k());return i.a.createElement(Ze,{"data-test-subj":e("longRunningCommandHint")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ke.displayName="LongRunningCommandHint";const Je=g.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Ye=g.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),Xe=g.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),et=Object(n.memo)((({showAs:e="success",title:t,showTitle:a=!0,"data-test-subj":s,className:o,children:l})=>{const c=k(),u=Object(O.a)(null!=s?s:c),d=Object(n.useMemo)((()=>ye()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[o||"_"]:Boolean(o)})),[o,e]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":s||u("commandExecutionResult")},"pending"===e?i.a.createElement(Ze,null,null!=l?l:Xe):i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{color:"success"===e?"success":"danger"},t||("success"===e?Je:Ye)),i.a.createElement(r.EuiSpacer,{size:"s"})),l))}));et.displayName="CommandExecutionResult";const tt=o.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-1wmcd6l-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),at=Object(n.memo)((({item:{command:e,state:t,id:a,enteredAt:s,isValid:o}})=>{const l=$(),c=e.commandDefinition.RenderComponent,[u,d]=Object(n.useState)(!1),p=Object(n.useMemo)((()=>"pending"===t.status),[t.status]),m=Object(n.useCallback)((e=>{l({type:"updateCommandStatusState",payload:{id:a,value:e}})}),[l,a]),f=Object(n.useCallback)((e=>{l({type:"updateCommandStoreState",payload:{id:a,value:e}})}),[l,a]);return Object(n.useEffect)((()=>{let e;if(p&&!u){const t=We()().diff(We()(s),"seconds");if(t>=15)return void d(!0);e=setTimeout((()=>{d(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[s,u,p]),i.a.createElement(tt,null,i.a.createElement("div",null,i.a.createElement(Le,{input:e.inputDisplay,isValid:o})),i.a.createElement("div",{className:"noThemeOverrides"},i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(c,{command:e,store:t.store,status:t.status,setStore:f,setStatus:m,ResultComponent:et}),p&&i.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),p&&u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Ke,null))))}));at.displayName="CommandExecutionOutput";const nt=a(69).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,it=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-1249lql-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),nt,nt),rt=Object(n.memo)((({children:e})=>{const t=Object(O.a)(k());return i.a.createElement(it,{grow:!0,"data-test-subj":t("historyItem")},e)}));rt.displayName="HistoryItem";const st=Object(n.memo)((e=>{const t=oe().state.commandHistory,a=$(),s=Object(O.a)(k()),o=Object(n.useMemo)((()=>t.map((e=>i.a.createElement(rt,{key:e.id},i.a.createElement(at,{item:e}))))),[t]);return Object(n.useEffect)((()=>{a({type:"scrollDown"})}),[a,t.length]),i.a.createElement(r.EuiFlexGroup,be()({"data-test-subj":s("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),o)}));st.displayName="HistoryOutput";const ot=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-ojfnk7-0"})(["padding:0 !important;"]),lt=Object(n.memo)((({headerContent:e,children:t})=>{const a=Object(O.a)(k("sidePanel"));return i.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none","data-test-subj":a()},e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container","data-test-subj":a("header")},e),i.a.createElement(r.EuiHorizontalRule,{margin:"none"})),i.a.createElement(ot,{className:"eui-scrollBar eui-yScroll layout-container"},i.a.createElement("div",{"data-test-subj":a("body")},t)))}));lt.displayName="SidePanelContentLayout";const ct=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-u9ickv-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),ut=Object(n.memo)((()=>{const e=$(),t=ee(),a=Object(O.a)(k("sidePanel")),s=ue().show,o=Object(n.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),l=Object(n.useMemo)((()=>"help"===s?i.a.createElement(i.a.Fragment,null,i.a.createElement(ct,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"s","data-test-subj":a("headerTitle")},i.a.createElement("h3",null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:o,"data-test-subj":a("headerCloseButton")}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:i.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[s,a,o]),c=Object(n.useMemo)((()=>"help"===s?i.a.createElement("div",{"data-test-subj":a("helpContent")},i.a.createElement(X,{commands:t,display:"table"})):null),[t,a,s]);return s?i.a.createElement(lt,{headerContent:l},c):null}));ut.displayName="RightPanelContentManager";const dt=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-hd3kv7-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),pt=Object(n.memo)((e=>Boolean(ue().show)?i.a.createElement(dt,{grow:!1,className:"layout-rightPanel"},i.a.createElement(ut,null)):null));pt.displayName="SidePanelFlexItem";const mt=o.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-d15gh7-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;width:100%;min-height:300px;min-width:300px;overflow:hidden;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;white-space:pre-wrap;}.euiFlexItem:not(.noMinWidth):not(.noThemeOverrides .euiFlexItem){min-width:0;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily)),ft=Object(n.memo)((({prompt:e,commands:t,HelpComponent:a,TitleComponent:s,storagePrefix:o,managedKey:l,...c})=>{const d=Object(n.useRef)(null),p=Object(n.useRef)(null),m=Object(O.a)(c["data-test-subj"]),f=Object(u.c)(l),b=Object(n.useCallback)((()=>{setTimeout((()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)}),1)}),[]),g=Object(n.useCallback)((()=>{p.current&&p.current.focus()}),[]);return Object(n.useEffect)((()=>{f&&!f.isOpen||setTimeout(g,2)}),[g,f]),i.a.createElement(se,{commands:t,scrollToBottom:b,keyCapture:p,managedKey:l,HelpComponent:a,dataTestSubj:c["data-test-subj"],storagePrefix:o},i.a.createElement(mt,c,i.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":m("mainPanel")},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},i.a.createElement(me,{TitleComponent:s})),i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},i.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:d},i.a.createElement(st,null))),i.a.createElement(r.EuiFlexItem,{onClick:g,grow:!1,className:"layout-container layout-commandInput","data-test-subj":m("mainPanel-inputArea")},i.a.createElement(Qe,{prompt:e,focusRef:p})),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},i.a.createElement(ce,null)))))))),i.a.createElement(pt,null))))}));ft.displayName="Console"},function(e,t,a){"use strict";a.d(t,"c",(function(){return Qe})),a.d(t,"a",(function(){return Ke})),a.d(t,"b",(function(){return Ye}));var n=a(17),i=a(2),r=a.n(i),s=a(47),o=a(52),l=a(231),c=a(130),u=a(9),d=a(930),p=a.n(d),m=a(49),f=a(44),b=a.n(f);const g=r.a.memo((({onClick:e,queriesLength:t})=>{const[a,o]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{e(),o(!0)}),[e]);return a?null:r.a.createElement(y,{color:"primary",paddingSize:"xs"},r.a.createElement(h,{direction:"row",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!0,"data-test-subj":"osquery-investigation-guide-text"},r.a.createElement(n.EuiText,{size:"s"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.investigationGuideSuggestion",defaultMessage:"You have {queriesLength, plural, one {a query} other {queries}} in the investigation guide. Add {queriesLength, plural, one {it as a response action} other {them as response actions}}?",values:{queriesLength:t}}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonEmpty,{size:"m",color:"primary",onClick:l,"data-test-subj":"osqueryAddInvestigationGuideQueries"},r.a.createElement(n.EuiText,{size:"s"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.addButton",defaultMessage:"Add"}))))))}));g.displayName="OsqueryInvestigationGuidePanel";var y=b()(n.EuiPanel).withConfig({displayName:"_StyledEuiPanel",componentId:"sc-10xybv0-0"})(["",""],{marginBottom:"16px"}),h=b()(n.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-10xybv0-1"})(["",""],{padding:"0 24px"}),v=a(607),E=a(5),x=a(958),j=a(696),S=a(135),O=a(71);const k={label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLabel",{defaultMessage:"Comment (optional)"}),helpText:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commentDescription",defaultMessage:"Leave a note that explains or describes the action. You can see your comment in the response actions history log."})},w=({basePath:e,disabled:t,readDefaultValueOnForm:a})=>r.a.createElement(o.UseField,{path:`${e}.comment`,readDefaultValueOnForm:a,config:k,isDisabled:t,component:O.TextField}),T=r.a.memo(w);var I=a(81),C=a(110);E.i18n.translate("xpack.securitySolution.endpoint.action.permissionDenied",{defaultMessage:"Permission denied"});const M=E.i18n.translate("xpack.securitySolution.endpoint.action.chooseFromTheList",{defaultMessage:"Choose action from the list"}),_=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLearnMore",{defaultMessage:"Learn more"}),A=({name:e,isDisabled:t})=>{const{title:a,description:i,tooltip:s}=F(e),o=r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiTitle,{size:"xs"},r.a.createElement(n.EuiText,null,a)),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(n.EuiText,null,i));return t?r.a.createElement(n.EuiToolTip,{position:"top",content:s},o):o},F=e=>"isolate"===e?{title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolate",defaultMessage:"Isolate"}),description:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateDescription",defaultMessage:"Quarantine a host from the network to prevent further spread of threats and limit potential damage"}),tooltip:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateTooltip",defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."})}:{title:"",description:"",tooltip:""},P=r.a.memo(A);var D=a(420);const N=({basePath:e,disabled:t,readDefaultValueOnForm:a})=>{const{endpointPrivileges:l}=Object(S.a)(),[c]=Object(o.useFormData)(),{docLinks:{links:{securitySolution:{responseActions:d}}}}=Object(C.i)().services,p=Object(i.useMemo)((()=>D.a.map((e=>{const t=!Object(x.b)({commandName:Object(j.d)(e),privileges:l}),a=Object(u.map)(c.responseActions,"params.command").includes(e)||t;return{value:e,inputDisplay:e,dropdownDisplay:r.a.createElement(P,{name:e,isDisabled:t}),disabled:a,"data-test-subj":`command-type-${e}`}}))),[c.responseActions,l]);return r.a.createElement(o.UseField,{path:`${e}.command`,readDefaultValueOnForm:a,config:{label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commandLabel",{defaultMessage:"Response action"}),helpText:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commandDescription",defaultMessage:"Select an endpoint response action. The response action only runs on hosts with Elastic Defend installed. {docs}",values:{docs:r.a.createElement(n.EuiLink,{href:d,target:"_blank"},_)}}),validations:[{validator:I.fieldValidators.emptyField(E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.commandIsRequiredErrorMessage",{defaultMessage:"Action is a required field."}))}]},component:O.SuperSelectField,isDisabled:t,componentProps:{euiFieldProps:{options:p,placeholder:M,"data-test-subj":"commandTypeField"}}})},R=r.a.memo(N),L=({basePath:e,editDisabled:t})=>{const[a]=Object(o.useFormData)(),i=Object(u.get)(a,`${e}.command`);return t?r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.privileges",defaultMessage:"Insufficient privileges"})},r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateTooltip",defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."}))),r.a.createElement(n.EuiSpacer,{size:"s"})):"isolate"===i?r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionDescription",defaultMessage:"Only select this option if youâ€™re certain that you want to automatically block communication with other hosts on your network until you release this host."}))),r.a.createElement(n.EuiSpacer,{size:"s"})):r.a.createElement(r.a.Fragment,null)},B=r.a.memo(L),z=r.a.memo((e=>{const t=`${e.item.path}.params`;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),r.a.createElement(B,{basePath:t,editDisabled:e.editDisabled}),r.a.createElement(T,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}))}));z.displayName="EndpointResponseAction";var q=a(264),$=a(152);let V,U,H;!function(e){e.advancedInsights="advanced_insights",e.investigationGuide="investigation_guide",e.endpointHostManagement="endpoint_host_management",e.endpointPolicyManagement="endpoint_policy_management",e.endpointPolicyProtections="endpoint_policy_protections",e.endpointArtifactManagement="endpoint_artifact_management",e.endpointResponseActions="endpoint_response_actions",e.threatIntelligence="threat-intelligence",e.osqueryAutomatedResponseActions="osquery_automated_response_actions",e.endpointExceptions="endpointExceptions",e.externalRuleActions="external_rule_actions"}(V||(V={})),function(e){e.casesConnectors="cases_connectors"}(U||(U={})),function(e){e.assistant="assistant"}(H||(H={}));const Q={...V,...U,...H};let G,W,Z;Object.freeze(Object.values(Q)),function(e){e.endpointList="endpointListSubFeature",e.endpointExceptions="endpointExceptionsSubFeature",e.trustedApplications="trustedApplicationsSubFeature",e.hostIsolationExceptions="hostIsolationExceptionsSubFeature",e.blocklist="blocklistSubFeature",e.eventFilters="eventFiltersSubFeature",e.policyManagement="policyManagementSubFeature",e.responseActionsHistory="responseActionsHistorySubFeature",e.hostIsolation="hostIsolationSubFeature",e.processOperations="processOperationsSubFeature",e.fileOperations="fileOperationsSubFeature",e.executeAction="executeActionSubFeature"}(G||(G={})),function(e){e.deleteCases="deleteCasesSubFeature",e.casesSettings="casesSettingsSubFeature"}(W||(W={})),function(e){e.createConversation="createConversationSubFeature"}(Z||(Z={}));var K=a(317);const J=r.a.memo((({field:e})=>{const{clearErrors:t,value:a,setValue:n,path:s}=e,{osquery:l}=Object(C.i)().services,c=Object(o.useFormContext)(),d=Object(i.useMemo)((()=>null==l?void 0:l.OsqueryResponseActionTypeForm),[null==l?void 0:l.OsqueryResponseActionTypeForm]),p=Object(i.useCallback)((e=>{if(Object(u.isEmpty)(e))t();else{const t=Object(u.map)(e,(e=>({message:e.message})));c.setFieldErrors(s,t)}}),[t,c,s]);return r.a.createElement(d,{defaultValues:a,onError:p,onChange:n})}));J.displayName="ResponseActionFormField";var Y=a(146),X=a(1304);const ee=()=>r.a.createElement(r.a.Fragment,null),te=r.a.memo((e=>{const{osquery:t,application:a}=Object(C.i)().services,i=Object($.b)(),o=Object(K.a)(Q.osqueryAutomatedResponseActions);if(t){var l,c,u,d,p,m,f,b;const{disabled:g,permissionDenied:y}=t.fetchInstallationStatus(),h=!(null!=a&&null!==(l=a.capabilities)&&void 0!==l&&null!==(c=l.osquery)&&void 0!==c&&c.writeLiveQueries||null!=a&&null!==(u=a.capabilities)&&void 0!==u&&null!==(d=u.osquery)&&void 0!==d&&d.runSavedQueries&&(null!=a&&null!==(p=a.capabilities)&&void 0!==p&&null!==(m=p.osquery)&&void 0!==m&&m.readSavedQueries||null!=a&&null!==(f=a.capabilities)&&void 0!==f&&null!==(b=f.osquery)&&void 0!==b&&b.readPacks));if(o)return r.a.createElement(o,null);if(y||h)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:ee}),r.a.createElement(n.EuiEmptyPrompt,{title:r.a.createElement("h2",null,X.b),titleSize:"xs",iconType:"logoOsquery",body:r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:r.a.createElement(n.EuiCode,null,"osquery")}}))}));if(g)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:ee}),r.a.createElement(n.EuiEmptyPrompt,{iconType:"logoOsquery",title:r.a.createElement("h2",null,X.c),titleSize:"xs",body:r.a.createElement("p",null,X.a)}));if(i())return r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:J,readDefaultValueOnForm:!e.item.isNew})}return null}));te.displayName="OsqueryResponseAction";const ae=e=>{switch(e){case q.b[".osquery"]:return{logo:"logoOsquery",name:"Osquery"};case q.b[".endpoint"]:return{logo:"logoSecurity",name:"Endpoint Security"};default:return{logo:"logoOsquery",name:"Osquery"}}},ne=b()(n.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-16pdpi-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),ie=({item:e,onDeleteAction:t})=>{var a;const[s,o]=Object(i.useState)(!0),[l]=Object(Y.m)(),c=Object(u.get)(l,e.path),d=null!==(a=(e=>{var t;const a=Object(S.a)().endpointPrivileges;if(".endpoint"===(null==e?void 0:e.actionTypeId)&&null!=e&&null!==(t=e.params)&&void 0!==t&&t.command)return!Object(x.b)({commandName:Object(j.d)(e.params.command),privileges:a})})(c))&&void 0!==a&&a,p=Object(i.useMemo)((()=>(null==c?void 0:c.actionTypeId)===q.b[".osquery"]?r.a.createElement(te,{item:e}):(null==c?void 0:c.actionTypeId)===q.b[".endpoint"]?r.a.createElement(z,{item:e,editDisabled:d}):null),[null==c?void 0:c.actionTypeId,d,e]),m=Object(i.useCallback)((()=>{t(e.id)}),[e,t]),f=Object(i.useMemo)((()=>{const{logo:e,name:t}=ae(null==c?void 0:c.actionTypeId);return r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIcon,{type:e,size:"m"})),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,null,t)))}),[null==c?void 0:c.actionTypeId]),b=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":E.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),disabled:d,onClick:m})),[d,m]);return r.a.createElement(ne,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:o,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:f,extraAction:b},p)};ie.displayName="ResponseActionTypeForm";const re=r.a.memo(ie);var se=a(461),oe=a.n(se),le=a(1234),ce=a.n(le),ue=a(411);const de=()=>r.a.createElement(r.a.Fragment,null),pe=r.a.memo((({items:e,removeItem:t})=>{const{detailName:a}=Object(m.useParams)(),{data:s}=Object(v.f)(a),o=Object(i.useMemo)((()=>null!=s&&s.note?(e=>{const t=oe()().use([[ce.a,{}],ue.a]).parse(e);return Object(u.filter)(null==t?void 0:t.children,["type","osquery"])})(s.note):[]),[null==s?void 0:s.note]),l=Object(Y.l)(),[c]=Object(Y.m)(),d=Object(i.useCallback)((()=>{const e=((e,t=[])=>Object(u.reduce)(e,((e,{configuration:t})=>(e.responseActions.push({actionTypeId:q.b[".osquery"],params:{savedQueryId:void 0,packId:void 0,queries:void 0,query:t.query,ecsMapping:t.ecs_mapping}}),e)),{responseActions:t}))(o,c.responseActions);l.updateFieldValues(e)}),[l,null==c?void 0:c.responseActions,o]);return r.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,a)=>r.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${a}`},r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(re,{item:e,onDeleteAction:t}),r.a.createElement(Y.e,{path:`${e.path}.actionTypeId`,component:de})))),r.a.createElement(n.EuiSpacer,{size:"m"}),o.length?r.a.createElement(g,{onClick:d,queriesLength:o.length}):null)}));pe.displayName="ResponseActionsList";var me=a(18);const fe=E.i18n.translate("xpack.securitySolution.actionForm.platinumOnly",{defaultMessage:"This functionality is available only in Platinum and above."}),be=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:a})=>{const[o]=Object(Y.m)(),[l,c]=Object(i.useState)(o.responseActions&&o.responseActions.length>0),u=Object(me.b)().isPlatinumPlus(),d=Object(i.useCallback)((e=>{c(!1),t(),a(e.id)}),[t,a]),p=Object(i.useMemo)((()=>r.a.createElement(n.EuiFlexGroup,{direction:"row"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>c(!1)},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(i.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const a=r.a.createElement(n.EuiKeyPadMenuItem,{key:t,isDisabled:!u||e.disabled,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,betaBadgeTooltipContent:"should be visible",onClick:()=>d(e)},r.a.createElement(n.EuiIcon,{size:"xl",type:e.iconClass}));return u?r.a.createElement(n.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a):r.a.createElement(n.EuiToolTip,{position:"top",content:fe},r.a.createElement(n.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a))}))),[d,u,e]);return null!=e&&e.length?r.a.createElement(r.a.Fragment,null,l?p:r.a.createElement(n.EuiFlexGroup,{direction:"row"},m)):r.a.createElement(r.a.Fragment,null)},ge=r.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:a,addItem:n})=>{const s=Object(i.useRef)(null),o=Object(i.useCallback)((e=>{s.current=e}),[]),l=Object(Y.l)(),c=Object(i.useMemo)((()=>r.a.createElement(be,{supportedResponseActionTypes:a,addActionType:n,updateActionTypeId:o})),[n,o,a]);return Object(i.useEffect)((()=>{if(s.current){const t=`responseActions[${e.length-1}].actionTypeId`;l.setFieldValue(t,s.current),s.current=null}}),[l,e.length]),r.a.createElement("div",{"data-test-subj":"response-actions-wrapper"},r.a.createElement(pe,{items:e,removeItem:t}),c)}));ge.displayName="ResponseActionsWrapper";var ye=a(943);const he=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"response-actions-header"},r.a.createElement(n.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution.",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),r.a.createElement(n.EuiSpacer,{size:"m"})),ve=[{id:q.b[".osquery"],name:"Osquery",iconClass:"logoOsquery"},{id:q.b[".endpoint"],name:"Endpoint Security",iconClass:"logoSecurity"}],Ee=({items:e,addItem:t,removeItem:a,form:s})=>{const o=(()=>{const[e,t]=Object(i.useState)(),a=Object(c.a)("endpointResponseActionsEnabled"),{canIsolateHost:n}=Object(S.a)().endpointPrivileges,r=Object(i.useMemo)((()=>({endpoint:a})),[a]),s=Object(i.useMemo)((()=>({endpoint:n})),[n]);return Object(i.useEffect)((()=>{const e=((e,t,a)=>e.reduce(((e,n)=>{const i=n.id===q.b[".endpoint"];return!t.endpoint&&i?e:q.a.options.includes(n.id)?[...e,{...n,disabled:i?!a.endpoint:void 0}]:e}),[]))(ve,r,s);t(e)}),[a,r,s]),e})(),[l,d]=Object(i.useState)(null),m=s.getFields(),f=s.getErrors(),b=Object(i.useMemo)((()=>null!=o&&o.length?r.a.createElement(ge,{items:e,removeItem:a,supportedResponseActionTypes:o,addItem:t}):null),[t,e,a,o]);return Object(i.useEffect)((()=>{d((()=>{const t=Object(u.reduce)(Object(u.map)(e,"path"),((e,t)=>{var a,n;return null!==(a=m[`${t}.params`])&&void 0!==a&&null!==(n=a.errors)&&void 0!==n&&n.length?(e.push({type:Object(u.upperFirst)(m[`${t}.actionTypeId`].value.substring(1)),errors:Object(u.map)(m[`${t}.params`].errors,"message")}),e):e}),[]);return Object(u.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[m,f,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),r.a.createElement(he,null),null!=l&&l.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(n.EuiCallOut,{"data-test-subj":"response-actions-error",title:ye.b,color:"danger",iconType:"warning"},r.a.createElement(p.a,null,l))),r.a.createElement(n.EuiSpacer,null)):null,b)};var xe=a(944),je=a(1114),Se=a(50),Oe=a(72),ke=a(117),we=a(163);const Te=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorsFetchError",{defaultMessage:"Failed to fetch connectors"}),Ie=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorTypesFetchError",{defaultMessage:"Failed to fetch connector types"}),Ce=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.actionsFetchErrorDescription",{defaultMessage:"Viewing actions is not available"}),Me=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),_e=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.docsLinkText",{defaultMessage:"Learn more"});function Ae(){const{docLinks:{links:{securitySolution:{manageDetectionRules:e}}}}=Object(C.i)().services,t=`${e}#edit-rules-settings`;return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepRuleActions.snoozeDescription",defaultMessage:"Choose when to perform actions or snooze them. Notifications are not created for snoozed actions. {docs}.",values:{docs:r.a.createElement(n.EuiLink,{href:t,target:"_blank"},_e)}})}const Fe=r.a.createElement(Ae,null),Pe=(E.i18n.translate("xpack.securitySolution.detectionEngine.actionsSectionLabel",{defaultMessage:"Actions"}),E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.notificationActions",{defaultMessage:"Notification actions"})),De=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.responseActions",{defaultMessage:"Response actions"}),Ne=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.forEachOption",{defaultMessage:"For each alert. Per rule run."}),Re=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.summaryOption",{defaultMessage:"Summary of alerts. Per rule run."}),Le=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.periodically",{defaultMessage:"Periodically"});var Be=a(1082);function ze({ruleId:e}){return r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,{size:"s"},Fe)),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(Be.a,{ruleId:e,showTooltipInline:!0})))}var qe=a(471);const $e=({children:e})=>r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,{size:"xs",color:"subdued"},e)),Ve=({frequency:e})=>{if(!e)return null;if(!e.summary)return r.a.createElement($e,null,Ne);if("onActiveAlert"===e.notifyWhen)return r.a.createElement($e,null,Re);if(!e.throttle)return null;const{unit:t,value:a}=Object(qe.g)(e.throttle),n={s:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEverySecondsLabel",defaultMessage:"Once {secondsCount, plural, one {a} other {in every}} {secondsCount, plural, one {second} other {# seconds}}",values:{secondsCount:a}}),m:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryMinutesLabel",defaultMessage:"Once {minutesCount, plural, one {a} other {in every}} {minutesCount, plural, one {minute} other {# minutes}}",values:{minutesCount:a}}),h:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryHoursLabel",defaultMessage:"Once {hoursCount, plural, one {an} other {in every}} {hoursCount, plural, one {hour} other {# hours}}",values:{hoursCount:a}}),d:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryDaysLabel",defaultMessage:"Once {daysCount, plural, one {a} other {in every}} {daysCount, plural, one {day} other {# days}}",values:{daysCount:a}})};return r.a.createElement($e,null,n[t]||Le)};function Ue({action:e,connectorTypes:t,connectors:a,actionTypeRegistry:i}){var s,o,l,c;const u=t.find((({id:t})=>t===e.actionTypeId)),d=null!==(s=null==u?void 0:u.name)&&void 0!==s?s:"",p=a.find((({id:t})=>t===e.id)),m=null!==(o=null==p?void 0:p.name)&&void 0!==o?o:"",f=null!==(l=null===(c=i.get(e.actionTypeId))||void 0===c?void 0:c.iconClass)&&void 0!==l?l:"apps";return r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{content:d,anchorClassName:"eui-textTruncate"},r.a.createElement(n.EuiIcon,{size:"m",type:f}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,{size:"s"},m),r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",component:"span",responsive:!1},r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIcon,{size:"s",type:"bell",color:"subdued"})),r.a.createElement(Ve,{frequency:e.frequency})))))}function He({action:e}){const{name:t,logo:a}=ae(e.actionTypeId);return r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(n.EuiIcon,{size:"m",type:a}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,{size:"s"},t))))}const Qe={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:""},Ge=()=>r.a.createElement(r.a.Fragment,null),We=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),r.a.createElement(n.EuiSpacer,{size:"l"})),Ze=({ruleId:e,isUpdateView:t=!1,actionMessageParams:a,summaryActionMessageParams:s,ruleType:u,form:d})=>{const{services:{application:p}}=Object(C.i)(),m=Object(c.a)("responseActionsEnabled"),f=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,null),r.a.createElement(Y.e,{path:"actions",component:je.a,componentProps:{messageVariables:a,summaryMessageVariables:s}}))),[a,s]),b=Object(i.useMemo)((()=>Object(l.f)(u)?r.a.createElement(o.UseArray,{path:"responseActions",initialNumberOfItems:0},Ee):null),[u]),g=Object(i.useMemo)((()=>p.capabilities.actions.show?r.a.createElement(r.a.Fragment,null,r.a.createElement(We,null),e&&r.a.createElement(ze,{ruleId:e}),f,m&&b,r.a.createElement(Y.e,{path:"kibanaSiemAppUrl",component:Ge}),r.a.createElement(Y.e,{path:"enabled",component:Ge})):r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiText,null,Me))),[e,p.capabilities.actions.show,f,b,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe.a,{addPadding:!t},r.a.createElement(Y.c,{form:d,"data-test-subj":"stepRuleActions"},r.a.createElement(n.EuiForm,null,g))))},Ke=Object(i.memo)(Ze),Je=({addPadding:e,defaultValues:t})=>{const{services:{triggersActionsUi:a}}=Object(C.i)(),i=a.actionTypeRegistry,{data:s}=(()=>{const{addError:e}=Object(ke.a)();return Object(Se.useQuery)(["GET",Oe.BASE_ACTION_API_PATH,"connectors"],(({signal:e})=>Object(we.f)(e)),{onError:t=>{e(t,{title:Te,toastMessage:Ce})}})})(),{data:o}=(()=>{const{addError:e}=Object(ke.a)();return Object(Se.useQuery)(["GET",Oe.BASE_ACTION_API_PATH,"connector_types","siem"],(({signal:e})=>Object(we.e)(e)),{onError:t=>{e(t,{title:Ie,toastMessage:Ce})}})})(),l=t.actions,c=t.responseActions||[];if(!(l.length>0||c.length>0)||!s||!o)return null;const u=l.length>0&&c.length>0;return r.a.createElement(xe.a,{addPadding:e},l.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiText,{size:"m"},Pe),r.a.createElement(n.EuiSpacer,{size:"s"})),l.map(((e,t)=>{const a=t===l.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{action:e,connectorTypes:o,connectors:s,actionTypeRegistry:i,key:e.id}),!a&&r.a.createElement(n.EuiSpacer,{size:"s"}))})),u&&r.a.createElement(n.EuiSpacer,{size:"l"}),c.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiText,{size:"m"},De),r.a.createElement(n.EuiSpacer,{size:"s"})),c.map(((e,t)=>{const a=t===c.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(He,{action:e,key:`${e.actionTypeId}-${t}`}),!a&&r.a.createElement(n.EuiSpacer,{size:"s"}))})))},Ye=Object(i.memo)(Je)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return ae}));var n=a(17),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(45),c=a(51),u=a(53),d=a(54),p=a(147),m=a(4),f=a(174),b=a(170),g=a(298),y=a(297),h=a(164),v=a(383),E=a(159),x=a(525),j=a(110),S=a(726),O=a(5),k=a(62),w=a(265),T=a(283),I=a(226),C=a(351),M=a(293);const _=r.a.memo((({chartHeight:e=174,data:t,from:a,legendItems:s,legendPosition:o=k.Position.Right,legendMinWidth:l,loading:c,showLegend:u,to:d,updateDateRange:p})=>{const{baseTheme:m,theme:f}=Object(w.i)(),b=Object(i.useMemo)((()=>["100%",e]),[e]),g=Object(i.useMemo)((()=>["y"]),[]),y=Object(i.useMemo)((()=>[e=>Object(I.a)(e.g)?e.g:M.c]),[]),h=Object(i.useMemo)((()=>Object(T.a)([a,d])),[a,d]);return r.a.createElement(r.a.Fragment,null,c&&r.a.createElement(n.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(k.Chart,{size:b},r.a.createElement(k.Settings,{legendPosition:o,onBrushEnd:p,showLegend:u&&0===s.length,showLegendExtra:u,theme:f,baseTheme:m,locale:O.i18n.getLocale()}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisX",position:k.Position.Bottom,tickFormat:h}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisY",position:k.Position.Left}),r.a.createElement(k.HistogramBarSeries,{id:"alertsHistogram",xScaleType:k.ScaleType.Time,yScaleType:k.ScaleType.Linear,xAccessor:"x",yAccessors:g,splitSeriesAccessors:y,data:t}))),r.a.createElement(n.EuiFlexItem,{grow:!1},s.length>0&&r.a.createElement(C.a,{legendItems:s,height:e,minWidth:l}))))}));_.displayName="AlertsHistogram";const A=O.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),F=O.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),P=O.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),D=(e,t,a)=>O.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:a},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});var N=a(137),R=a(129),L=a(432),B=a(528),z=a(398),q=a(160),$=a(399),V=a(130);const U=Object(c.v4)(),H=(e="kibana.alert.rule.name",t)=>({title:"Alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:U,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[U]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},secondaryFields:[]}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${U}`}]});var Q=a(116),G=a(330),W=a(61),Z=a.n(W),K=a(347);const J={value:0,relation:"eq"},Y="detections-histogram",X=o()(n.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-tvqkga-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),ee=o()(n.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-tvqkga-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),te=[],ae=Object(i.memo)((({alignHeader:e,chartHeight:t=155,chartOptionsContextMenu:a,combinedQueries:s,comboboxRef:o,defaultStackByOption:k=L.a,extraActions:w,filters:T,headerChildren:I,inspectTitle:C,legendPosition:M="right",onFieldSelected:U,onlyField:W,paddingSize:ae="m",panelHeight:ne=L.d,query:ie,runtimeMappings:re,setComboboxInputRef:se,showCountsInLegend:oe=!1,showGroupByPlaceholder:le=!1,showLegend:ce=!0,showLinkToAlerts:ue=!1,showStackBy:de=!0,showTotalAlertsCount:pe=!1,signalIndexName:me,stackByLabel:fe,stackByWidth:be,timelineId:ge,title:ye=A,titleSize:he="m",updateDateRange:ve,hideQueryToggle:Ee=!1,isExpanded:xe,setIsExpanded:je})=>{var Se;const{to:Oe,from:ke,deleteQuery:we,setQuery:Te}=Object(p.a)(),Ie=Object(i.useMemo)((()=>`${Y}-${Object(c.v4)()}`),[]),Ce=`alerts-trend-embeddable-${Ie}`,[Me,_e]=Object(i.useState)(!0),[Ae,Fe]=Object(i.useState)(!1),[Pe,De]=Object(i.useState)(J),[Ne,Re]=Object(i.useState)(null==W?k:W),Le=Object(V.a)("chartEmbeddablesEnabled"),Be=Object(V.a)("alertsPageChartsEnabled"),ze=Object(i.useCallback)((e=>{Re(e),null!=U&&U(e)}),[U]);Object(i.useEffect)((()=>{Re(null==W?k:W)}),[k,W]);const{toggleStatus:qe,setToggleStatus:$e}=Object(q.a)(Y),Ve=Object(i.useCallback)((e=>{Be&&void 0!==je?je(e):$e(e)}),[$e,je,Be]),Ue=Object(i.useMemo)((()=>Be&&void 0!==je?!xe:!qe),[Be,je,xe,qe]),He=Object(i.useMemo)((()=>({from:ke,to:Oe})),[ke,Oe]),{loading:Qe,data:Ge,setQuery:We,response:Ze,request:Ke,refetch:Je}=Object(g.a)({query:Object(S.d)(Ne,ke,Oe,Object(S.a)(s),re),indexName:me,skip:Ue||Le,queryName:y.a.HISTOGRAM}),Ye=Object(j.i)(),{navigateToApp:Xe}=Ye.services.application,{formatUrl:et,search:tt}=Object(h.l)(R.a.alerts),at=(({totalAlertsObj:e,visualizationId:t,isChartEmbeddablesEnabled:a})=>{const[n]=Object(j.o)(m.P),r=Object(K.a)({visualizationId:t}),s=Object(i.useMemo)((()=>D(Z()(e.value).format(n),e.value,"gte"===e.relation?">":"lte"===e.relation?"<":"")),[e.value,e.relation,n]),o=Object(i.useMemo)((()=>{const e=null!=r?r[0].hits.total:0;return D(Z()(e).format(n),e,"")}),[n,r]);return a?o:s})({totalAlertsObj:Pe,visualizationId:Ce,isChartEmbeddablesEnabled:Le}),nt=Object(i.useCallback)((e=>{e.preventDefault(),Xe(m.l,{deepLinkId:R.a.alerts,path:Object(h.c)(tt)})}),[Xe,tt]),it=Object(i.useMemo)((()=>Object(S.c)(Ge)),[Ge]),rt=Object(i.useMemo)((()=>{var e,t;return ce&&null!=(null==Ge||null===(e=Ge.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Ge.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var a;return{color:t<v.a.length?v.a[t]:void 0,count:oe?e.doc_count:void 0,dataProviderId:Object(f.i)(`draggable-legend-item-${Object(c.v4)()}-${Ne}-${e.key}`),field:Ne,timelineId:ge,value:null!==(a=null==e?void 0:e.key_as_string)&&void 0!==a?a:e.key}})):te}),[null==Ge||null===(Se=Ge.aggregations)||void 0===Se?void 0:Se.alertsByGrouping.buckets,Ne,oe,ce,ge]);Object(i.useEffect)((()=>{let e=!1;return e||Object(S.f)({isInitialLoading:Me,isLoadingAlerts:Qe})||_e(!1),()=>{e=!0}}),[Me,Qe,_e]),Object(z.a)({deleteQuery:we,loading:Qe,refetch:Je,request:Ke,response:Ze,setQuery:Te,uniqueQueryId:Ie}),Object(i.useEffect)((()=>{var e;De(null!==(e=null==Ge?void 0:Ge.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Ge]),Object(i.useEffect)((()=>{try{let t=null;var e;t=null!=s?Object(S.e)(s):Object(u.buildEsQuery)(void 0,null!=ie?[ie]:[],null!==(e=null==T?void 0:T.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(d.getEsQueryConfig)(Ye.services.uiSettings),dateFormatTZ:void 0}),Fe(!1),We(Object(S.d)(Ne,ke,Oe,Object(l.isEmpty)(t)?[]:[t],re))}catch(e){Fe(!0),We(Object(S.d)(Ne,ke,Oe,[],re))}}),[Ne,ke,Oe,ie,T,s,re]);const st=Object(i.useMemo)((()=>{if(ue)return r.a.createElement(X,{grow:!1},r.a.createElement(N.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:nt,href:et(Object(h.c)())},P))}),[ue,nt,et]),ot=Object(i.useMemo)((()=>{return null==W?ye:(e=W,O.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[W,ye]),lt=Object(i.useMemo)((()=>Be&&void 0!==xe?xe:qe),[Be,xe,qe]);return r.a.createElement(E.c,{show:!Me&&lt},r.a.createElement(B.a,{height:ne,hasBorder:!0,paddingSize:ae,"data-test-subj":"alerts-histogram-panel",$toggleStatus:lt},r.a.createElement(b.a,{alignHeader:e,id:Ie,inspectTitle:C,outerDirection:"column",title:ot,titleSize:he,toggleStatus:lt,toggleQuery:Ee?void 0:Ve,showInspectButton:!Le&&null==a,subtitle:!Me&&pe&&at,isInspectDisabled:Ae},r.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},de&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B.b,{"data-test-subj":"stackByComboBox",inputRef:se,onSelect:ze,prepend:fe,ref:o,selected:Ne,useLensCompatibleFields:Le,width:be}),le&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),r.a.createElement(n.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:F},r.a.createElement(B.b,{"data-test-subj":"stackByPlaceholder",isDisabled:!0,onSelect:l.noop,prepend:$.b,selected:"",useLensCompatibleFields:Le,width:be})))),null!=I&&I),null!=a&&!Le&&r.a.createElement(ee,{grow:!1},a(Ie)),st)),lt?Le?r.a.createElement(G.a,{"data-test-subj":"embeddable-matrix-histogram",extraActions:w,extraOptions:{filters:T},getLensAttributes:H,height:null!=t?t:155,id:Ce,inspectTitle:null!=C?C:ye,scopeId:Q.SourcererScopeName.detections,stackByField:Ne,timerange:He}):Me?r.a.createElement(x.a,null):r.a.createElement(_,{chartHeight:t,data:it,from:ke,legendItems:rt,legendPosition:M,legendMinWidth:oe?300:void 0,loading:Qe,to:Oe,showLegend:ce,updateDateRange:ve}):null))}));ae.displayName="AlertsHistogramPanel"},function(e,t,a){"use strict";a.d(t,"b",(function(){return we})),a.d(t,"a",(function(){return Me}));var n=a(45),i=a(17),r=a(2),s=a.n(r),o=a(48),l=a(44),c=a.n(l),u=a(66),d=a(135),p=a(118),m=a(134),f=a(196),b=a(116),g=a(742),y=a(113),h=a(112),v=a(282),E=a(145),x=a(296),j=a(23),S=a.n(j),O=(a(13),a(194)),k=a(47),w=a(130),T=a(110),I=a(719),C=a(485),M=a(377),_=a(122),A=a(430),F=a(721),P=a(5);const D=P.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),N=P.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),R=P.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),L=P.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),B=P.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),z=P.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),q=P.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"}),$=P.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),V=P.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var U=a(18),H=a(520),Q=a(14);const G=c.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1ib7jds-0"})(["flex:1;"]);var W=c()(G).withConfig({displayName:"_StyledHideShowContainer",componentId:"sc-1ib7jds-1"})(["overflow:hidden !important;"]);const Z=(e,t=s.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var a;const n=s.a.forwardRef(((a,n)=>s.a.createElement(r.Suspense,{fallback:t},s.a.createElement(e,S()({},a,{ref:n})))));return n.displayName=`${null!==(a=e.displayName)&&void 0!==a?a:"Tab"}WithSuspense`,n},K=c.a.div.withConfig({displayName:"AssistantTabContainer",componentId:"sc-1ib7jds-2"})(["overflow-y:auto;width:100%;"]),J=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(15),a.e(16),a.e(44)]).then(a.bind(null,1724))))),Y=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(15),a.e(16),a.e(37)]).then(a.bind(null,1732))))),X=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(17),a.e(38)]).then(a.bind(null,1710))))),ee=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(46)]).then(a.bind(null,1735))))),te=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(15),a.e(50)]).then(a.bind(null,1711))))),ae=Z(Object(r.lazy)((()=>Promise.all([a.e(1),a.e(5),a.e(9),a.e(7),a.e(10),a.e(13),a.e(47)]).then(a.bind(null,1712))))),ne=Z(Object(r.lazy)((()=>a.e(43).then(a.bind(null,1726))))),ie=Object(r.memo)((({shouldRefocusPrompt:e,setConversationId:t})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiSkeletonText,{lines:10})},s.a.createElement(K,null,s.a.createElement(O.a,{conversationId:H.a,embeddedLayout:!0,setConversationId:t,shouldRefocusPrompt:e})))));ie.displayName="AssistantTab";const re=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:a,timelineId:n,timelineType:i,setConversationId:o,showTimeline:l})=>{const{hasAssistantPrivilege:c}=Object(M.a)(),u=Object(T.i)().services.configSettings.ESQLEnabled,d=Object(r.useCallback)((e=>{switch(e){case _.d.graph:return s.a.createElement(X,{timelineId:n});case _.d.notes:return s.a.createElement(ee,{timelineId:n});case _.d.session:return s.a.createElement(ae,{timelineId:n});default:return null}}),[n]),p=Object(r.useMemo)((()=>[_.d.graph,_.d.notes,_.d.session].includes(e)),[e]),{conversations:m}=Object(C.a)(),f=Object(r.useMemo)((()=>m[H.a].messages.length>0),[m]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(G,{$isVisible:_.d.query===e,"data-test-subj":`timeline-tab-content-${_.d.query}`},s.a.createElement(J,{renderCellValue:t,rowRenderers:a,timelineId:n})),l&&u&&e===_.d.esql&&s.a.createElement(G,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${_.d.esql}`},s.a.createElement(ne,{timelineId:n})),s.a.createElement(G,{$isVisible:_.d.pinned===e,"data-test-subj":`timeline-tab-content-${_.d.pinned}`},s.a.createElement(te,{renderCellValue:t,rowRenderers:a,timelineId:n})),i===y.l.default&&s.a.createElement(G,{$isVisible:_.d.eql===e,"data-test-subj":`timeline-tab-content-${_.d.eql}`},s.a.createElement(Y,{renderCellValue:t,rowRenderers:a,timelineId:n})),s.a.createElement(G,{$isVisible:p,isOverflowYScroll:e===_.d.session,"data-test-subj":`timeline-tab-content-${_.d.graph}-${_.d.notes}`},p&&d(e)),c&&s.a.createElement(W,{$isVisible:e===_.d.securityAssistant,isOverflowYScroll:e===_.d.securityAssistant,"data-test-subj":"timeline-tab-content-security-assistant"},(e===_.d.securityAssistant||f)&&s.a.createElement(ie,{setConversationId:o,shouldRefocusPrompt:l&&e===_.d.securityAssistant})))}));re.displayName="ActiveTimelineTab";const se=c()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1ib7jds-3"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),oe=c()(i.EuiBetaBadge).withConfig({displayName:"StyledEuiBetaBadge",componentId:"sc-1ib7jds-4"})(["vertical-align:middle;margin-left:",";&:hover{cursor:pointer;}"],(({theme:e})=>e.eui.euiSizeS)),le=c()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1ib7jds-5"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),ce=c()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1ib7jds-6"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),ue=({renderCellValue:e,rowRenderers:t,timelineId:a,timelineFullScreen:l,timelineType:c,graphEventId:u,sessionViewConfig:d,timelineDescription:m})=>{const f=Object(w.a)("timelineEsqlTabDisabled"),b=Object(T.i)().services.configSettings.ESQLEnabled,{hasAssistantPrivilege:g}=Object(M.a)(),v=Object(o.useDispatch)(),E=Object(r.useMemo)((()=>Object(F.a)()),[]),x=Object(r.useMemo)((()=>Object(F.g)()),[]),j=Object(r.useMemo)((()=>Object(F.e)()),[]),S=Object(r.useMemo)((()=>Object(F.d)()),[]),O=Object(r.useMemo)((()=>Object(F.c)()),[]),C=Object(r.useMemo)((()=>Object(F.b)()),[]),P=Object(h.b)((e=>E(e,a))),G=Object(h.b)((e=>x(e,a))),W=Object(h.b)((e=>j(e,a))),Z=Object(h.a)((e=>O(e,a))),K=Object(h.a)((e=>C(e,a))),J=Object(h.a)((e=>S(e))),Y=Object(U.b)().isEnterprise(),[X,ee]=Object(r.useState)(H.a),{reportAssistantInvoked:te}=Object(I.a)(),ae=Object(r.useMemo)((()=>{const e=Object.values(K).reduce(((e,t)=>[...e,...t]),[]);return[...Z,...e]}),[Z,K]),ne=Object(r.useMemo)((()=>J.filter((e=>ae.includes(e.id))).length+(Object(n.isEmpty)(m)?0:1)),[J,ae,m]),ie=Object(r.useCallback)((e=>{v(p.a.setActiveTabTimeline({id:a,activeTab:e}))}),[v,a]),ue=Object(r.useCallback)((()=>{ie(_.d.query)}),[ie]),de=Object(r.useCallback)((()=>{ie(_.d.eql)}),[ie]),pe=Object(r.useCallback)((()=>{ie(_.d.graph)}),[ie]),me=Object(r.useCallback)((()=>{ie(_.d.notes)}),[ie]),fe=Object(r.useCallback)((()=>{ie(_.d.pinned)}),[ie]),be=Object(r.useCallback)((()=>{ie(_.d.session)}),[ie]),ge=Object(r.useCallback)((()=>{ie(_.d.securityAssistant),P!==_.d.securityAssistant&&te({conversationId:X,invokedBy:H.a})}),[P,X,te,ie]),ye=Object(r.useCallback)((()=>{v(Object(Q.initializeTimelineSettings)({id:a})),ie(_.d.esql)}),[ie,v,a]);return Object(r.useEffect)((()=>{u||P!==_.d.graph||ue()}),[P,u,ue]),s.a.createElement(s.a.Fragment,null,!l&&s.a.createElement(ce,{className:"eui-scrollBar"},s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.query}`,onClick:ue,isSelected:P===_.d.query,disabled:!1,key:_.d.query},s.a.createElement("span",null,D),G&&s.a.createElement(A.b,null)),!f&&b&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.esql}`,onClick:ye,isSelected:P===_.d.esql,disabled:!1,key:_.d.esql},s.a.createElement("span",null,q),s.a.createElement(oe,{label:$,size:"s",iconType:"beaker",tooltipContent:s.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})})),c===y.l.default&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.eql}`,onClick:de,isSelected:P===_.d.eql,disabled:!1,key:_.d.eql},s.a.createElement("span",null,N),G&&s.a.createElement(A.a,null)),s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${_.d.graph}`,onClick:pe,isSelected:P===_.d.graph,disabled:!u,key:_.d.graph},R),Y&&s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${_.d.session}`,onClick:be,isSelected:P===_.d.session,disabled:null===d,key:_.d.session},V),s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.notes}`,onClick:me,isSelected:P===_.d.notes,disabled:c===y.l.template,key:_.d.notes},s.a.createElement("span",null,L),G&&ne>0&&c===y.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,ne))),s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.pinned}`,onClick:fe,disabled:c===y.l.template,isSelected:P===_.d.pinned,key:_.d.pinned},s.a.createElement("span",null,B),G&&W>0&&c===y.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,W))),g&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.securityAssistant}`,onClick:ge,disabled:c===y.l.template,isSelected:P===_.d.securityAssistant,key:_.d.securityAssistant},s.a.createElement("span",null,z))),s.a.createElement(re,{activeTimelineTab:P,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:c,timelineDescription:m,setConversationId:ee,showTimeline:G}))},de=Object(r.memo)(ue);var pe=a(243),me=a(189),fe=a(593),be=a(49),ge=a(60),ye=a(218),he=a(128),ve=a(722),Ee=a(4),xe=a(292),je=a(516);const Se=e=>{var t;const{activeTab:a,switchToTab:n,timelineType:o}=e,{services:{storage:l}}=Object(T.i)(),c=Object(r.useMemo)((()=>xe.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[u,d]=Object(r.useState)((()=>{const e=l.get(Ee.Qb.TIMELINE);return null!=e?e:xe.c})),p=Object(r.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),m=Object(r.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(r.useEffect)((()=>{l.set(Ee.Qb.TIMELINE,u)}),[u,l]);const f=Object(r.useCallback)((e=>e===c.length?s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},je.h):[s.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:p},je.g),s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},je.j)]),[p,m,c.length]),b=null===(t=c[u.currentTourStep-1])||void 0===t?void 0:t.anchor,g=Object(ve.a)(b),y=c[u.currentTourStep-1];return null!=y&&y.timelineTab&&y.timelineTab!==a&&n(y.timelineTab),u.isTourActive&&g?s.a.createElement(s.a.Fragment,null,c.map(((e,t)=>{const a=t+1;if(u.currentTourStep!==a)return null;const n={"data-test-subj":`timeline-tour-step-${t+1}`};return s.a.createElement(i.EuiTourStep,{panelProps:n,key:t,step:a,isStepOpen:u.isTourActive&&u.currentTourStep===t+1,minWidth:u.tourPopoverWidth,stepsTotal:c.length,onFinish:p,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:xe.c.tourSubtitle,footerAction:f(a)})}))):null},Oe=s.a.memo(Se),ke=c.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),we=Object(r.createContext)({timelineId:null}),Te=({timelineId:e})=>{const t=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]);return Object(h.b)((a=>{var n;return(null!==(n=t(a,e))&&void 0!==n?n:m.b).isSaving}))?s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Ie=s.a.memo(Te),Ce=({renderCellValue:e,rowRenderers:t,timelineId:a})=>{const l=Object(o.useDispatch)(),c=Object(r.useRef)(null),j=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),S=Object(r.useMemo)((()=>he.e.scopeIdSelector()),[]),{selectedPatterns:O,selectedDataViewId:k}=Object(h.a)((e=>S(e,b.SourcererScopeName.timeline))),{dataViewId:w,indexNames:I,graphEventId:C,savedObjectId:M,timelineType:A,description:F,sessionViewConfig:P,initialized:D,show:N,isLoading:R,activeTab:L}=Object(h.a)((e=>{var t;return Object(n.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=j(e,a))&&void 0!==t?t:m.b)})),{kibanaSecuritySolutionsPrivileges:{crud:B}}=Object(d.a)(),{timelineFullScreen:z}=Object(me.c)();Object(r.useEffect)((()=>{M||D||l(p.a.createTimeline({id:a,columns:f.b,dataViewId:k,indexNames:O,expandedDetail:v.a.getExpandedDetail(),show:!1}))}),[]);const q=Object(r.useCallback)((()=>{!M||null==k||null===w&&0===I.length||w===k&&I.sort().join()===O.sort().join()||l(p.a.updateDataView({dataViewId:k,id:a,indexNames:O}))}),[l,M,k,w,O,I,a]);Object(r.useEffect)((()=>{q()}),[k,O]);const $=Object(r.useCallback)((()=>{var e;const t=null===(e=c.current)||void 0===e?void 0:e.querySelector(fe.a);var a,n;null!=t?t.focus():null===(a=c.current)||void 0===a||null===(n=a.querySelector(".globalFilterBar__addButton"))||void 0===n||n.focus()}),[c]),V=Object(r.useCallback)((()=>{var e,t;null===(e=c.current)||void 0===e||null===(t=e.querySelector(`.${E.d}`))||void 0===t||t.focus()}),[c]),U=Object(r.useCallback)((e=>{Object(u.isTab)(e)&&Object(E.l)({containerElement:c.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:$,onSkipFocusAfterEventsTable:V})}),[c,$,V]),H=Object(r.useMemo)((()=>({timelineId:a})),[a]),Q=(()=>{const{search:e,pathname:t}=Object(be.useLocation)(),{spaces:a}=Object(T.i)().services,n=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:c,graphEventId:u,activeTab:d}=Object(h.a)((e=>{var t;return null!==(t=n(e,_.c.active))&&void 0!==t?t:m.b})),f=Object(r.useCallback)((()=>{var n,r,p;const m=new URLSearchParams(e),f=null!==(n=m.get(ye.a.timeline))&&void 0!==n?n:void 0,b={id:null!=l?l:"",isOpen:!!c,activeTab:d,graphEventId:u},g=null!==(r=Object(ge.safeDecode)(null!=f?f:""))&&void 0!==r?r:b,y=null==g?void 0:g.id;if(!a||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==y)return null;const h=null!==(p=null==o?void 0:o.alias_target_id)&&void 0!==p?p:"",v={...g,id:h},E=Object(ge.encode)(v);m.set(ye.a.timeline,E);const x=`${t}?${m.toString()}${window.location.hash}`;return s.a.createElement(s.a.Fragment,null,a.ui.components.getLegacyUrlConflict({objectNoun:ye.a.timeline,currentObjectId:y,otherObjectId:h,otherObjectPath:x}),s.a.createElement(i.EuiSpacer,null))}),[d,u,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,c,a]);return Object(r.useMemo)((()=>f()),[f])})(),G=N&&!R&&B,W=Object(r.useCallback)((e=>{l(p.a.setActiveTabTimeline({id:a,activeTab:e}))}),[a,l]);return s.a.createElement(we.Provider,{value:H},s.a.createElement(pe.B,{"data-test-subj":"timeline","data-timeline-id":a,onKeyDown:U,ref:c},s.a.createElement(Ie,{timelineId:a}),s.a.createElement("div",{className:"timeline-body","data-test-subj":"timeline-body"},A===y.l.template&&s.a.createElement(ke,{className:"timeline-template-badge"},x.f),Q,s.a.createElement(pe.y,{$isVisible:!z,"data-test-subj":"timeline-hide-show-container"},s.a.createElement(g.a,{timelineId:a})),s.a.createElement(de,{graphEventId:C,sessionViewConfig:P,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:A,timelineDescription:F,timelineFullScreen:z}))),G?s.a.createElement(Oe,{activeTab:L,switchToTab:W,timelineType:A}):null)};Ce.displayName="StatefulTimelineComponent";const Me=s.a.memo(Ce)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return h}));var n=a(48),i=a(178);function r(e){return Object(n.useSelector)((function(t){return e(t[i.v][i.u])}))}var s=a(2),o=a.n(s),l=a(47),c=a(88),u=a(135),d=a(744),p=a(4),m=a(238),f=a(436),b=a(352),g=a(226),y=a(1309);const h=(e,t)=>{const{getAppUrl:a}=Object(b.a)(),n=r(f.agentPolicies),i=r(f.uiQueryParams),h=Object(d.d)(),{canAccessResponseConsole:v,canIsolateHost:E,canUnIsolateHost:x,canAccessEndpointActionsLogManagement:j,canAccessFleet:S}=Object(u.a)().endpointPrivileges;return Object(s.useMemo)((()=>{if(!e)return[];const r=Object(g.b)(e),s=e.agent.id,u=e.Endpoint.policy.applied.id,d=e.host.hostname,f=e.elastic.agent.id,b=Object(y.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:O,selected_endpoint:k,...w}=i,T=Object(m.d)({name:"endpointActivityLog",...w,selected_endpoint:s}),I=Object(m.d)({name:"endpointIsolate",...w,selected_endpoint:s}),C=Object(m.d)({name:"endpointUnIsolate",...w,selected_endpoint:s}),M=[];return r&&x?M.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:p.l,navigateOptions:{path:C},href:a({path:C}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):b&&E&&M.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:p.l,navigateOptions:{path:I},href:a({path:I}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...M,...v?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),h(e)},children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Respond"})}]:[],...null!=t&&t.isEndpointList&&j?[{"data-test-subj":"actionsLink",icon:"logoSecurity",key:"actionsLogLink",navigateAppId:p.l,navigateOptions:{path:T},href:a({path:T}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.responseActionsHistory",defaultMessage:"View response actions history"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:p.l,navigateOptions:{path:`/hosts/${d}`},href:a({path:`/hosts/${d}`}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},...S?[{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.policy_details({policyId:n[u]})[1]}`},href:`${a({appId:"fleet"})}${c.pagePathGetters.policy_details({policyId:n[u]})[1]}`,disabled:void 0===n[u],children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:f})[1]}`},href:`${a({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:f})[1]}`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:f})[1]}?openReassignFlyout=true`,state:{onDoneNavigateTo:[p.l,{path:Object(m.e)({name:"endpointList"})}]}},href:`${a({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:f})[1]}?openReassignFlyout=true`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]:[]]}),[i,v,j,e,n,a,h,null==t?void 0:t.isEndpointList,E,x,S])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(5);n.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),n.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),n.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(110),r=a(114),s=a(66);const o=({closePopover:e,draggableId:t,fieldName:a,keyboardHandlerRef:o,openPopover:l})=>{const{timelines:c}=Object(i.i)().services,u=c.getUseAddToTimeline(),{beginDrag:d,cancelDrag:p,dragToLocation:m,endDrag:f,hasDraggableLock:b}=u({draggableId:t,fieldName:a}),[g,y]=Object(n.useState)(null),h=Object(n.useCallback)((()=>{y((e=>e?(p(e),null):null))}),[p]),v=Object(n.useCallback)((a=>{const n=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var i;n&&((b()||!b()&&" "===a.key)&&(a.preventDefault(),a.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:a,draggableElement:n,dragActions:i,dragToLocation:o,endDrag:l,keyboardEvent:c,openPopover:u,setDragActions:d})=>{let p=null;switch(c.key){case" ":i?(l(i),d(null)):(null!=a&&a(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(n);break;case"ArrowUp":p=n.getBoundingClientRect(),o({dragActions:i,position:{x:p.x,y:p.y-r.f}});break;case"ArrowDown":p=n.getBoundingClientRect(),o({dragActions:i,position:{x:p.x,y:p.y+r.f}});break;case"ArrowLeft":p=n.getBoundingClientRect(),o({dragActions:i,position:{x:p.x-r.f,y:p.y}});break;case"ArrowRight":p=n.getBoundingClientRect(),o({dragActions:i,position:{x:p.x+r.f,y:p.y}});break;case"Enter":Object(s.stopPropagationAndPreventDefault)(c),i||null==u||u()}})({beginDrag:d,cancelDragActions:h,closePopover:e,dragActions:g,draggableElement:n,dragToLocation:m,endDrag:f,keyboardEvent:a,openPopover:l,setDragActions:y}),null===(i=o.current)||void 0===i||i.focus())}),[d,h,e,g,t,m,f,b,o,l,y]);return Object(n.useMemo)((()=>({onBlur:h,onKeyDown:v})),[h,v])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17),l=a(50),c=a(110),u=a(47);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),p=i.a.memo(d);var m=a(709);const f=s.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),b=({agentId:e,defaultValues:t,onClose:a,ecsData:r})=>{const{services:{osquery:s}}=Object(c.i)(),u=Object(l.useQueryClient)(),d=Object(n.useCallback)((()=>{var e;u.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,u]);return null!=s&&s.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:a},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",null,m.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(s.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:r,onSuccess:d}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(p,{handleClick:a,"data-test-subj":"flyout-footer-osquery"}))):null},g=i.a.memo(b)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return _})),a.d(t,"a",(function(){return R}));var n=a(45),i=a(17),r=a(47),s=a(2),o=a.n(s),l=a(44),c=a.n(l),u=a(48),d=a(50),p=a(126),m=a(390),f=a(118),b=a(167),g=a(468),y=a(5);const h=y.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),v=y.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),E=y.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),x=y.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),j=y.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),S=y.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),O=y.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var k=a(122),w=a(112),T=a(116),I=a(121),C=a(110),M=a(117);const _=c.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));_.displayName="NotePreviewsContainer";const A=({eventId:e,timelineId:t})=>{const a=Object(u.useDispatch)(),{selectedPatterns:n}=Object(I.d)(T.SourcererScopeName.timeline),r=Object(s.useCallback)((()=>{a(f.a.toggleDetailPanel({panelView:"eventDetail",tabType:k.d.notes,id:t,params:{eventId:e,indexName:n.join(",")}}))}),[a,e,n,t]);return o.a.createElement(i.EuiButtonIcon,{title:h,"aria-label":h,color:"text",iconType:"arrowRight",onClick:r})},F=o.a.memo(A),P=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:O,onCancel:e,onConfirm:t,cancelButtonText:S,confirmButtonText:j,buttonColor:"danger",defaultFocusedButton:"confirm"})));P.displayName="DeleteNoteConfirm";const D=o.a.memo((({noteId:e})=>{const[t,a]=Object(s.useState)(null),{mutate:n,isLoading:r}=function(e){const{services:{http:t}}=Object(C.i)(),a=Object(u.useDispatch)(),{addError:n}=Object(M.a)();return Object(d.useMutation)({mutationFn:e=>t.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{e&&a(b.a.deleteNote({id:e}))},onError:e=>{var t;n(e,{title:(t=e,y.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:t}}))})}})}(e),l=Object(s.useCallback)((async()=>{a(e)}),[e]),c=Object(s.useCallback)((()=>{a(null)}),[]),p=Object(s.useCallback)((()=>{n(e),a(null)}),[n,e]),m=Object(s.useMemo)((()=>r||null==e),[r,e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:j,"aria-label":j,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:l,disabled:m}),null!=t&&o.a.createElement(P,{closeModal:c,confirmModal:p}))}));D.displayName="DeleteNoteButton";const N=o.a.memo((({eventId:e,timelineId:t,noteId:a})=>e&&t?o.a.createElement(o.a.Fragment,null,o.a.createElement(F,{eventId:e,timelineId:t}),o.a.createElement(D,{noteId:a})):o.a.createElement(D,{noteId:a})));N.displayName="NoteActions";const R=o.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:a,showTimelineDescription:l})=>{const c=Object(s.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),u=Object(w.a)((e=>a?c(e,a):null)),d=Object(s.useMemo)((()=>l&&a&&null!=u&&u.description?[{username:Object(p.a)(u.updatedBy),event:E,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:u.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(u.updated)}):Object(p.e)(),children:o.a.createElement(i.EuiText,{size:"s"},u.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=u.updatedBy?u.updatedBy:"?",size:"l"}),actions:null}]:[]),[u,a,l]),b=Object(s.useMemo)((()=>Object(n.uniqBy)("savedObjectId",t).map((t=>{var n,s,l;const c=null!=e?Object.entries(e).reduce(((e,[a,n])=>{var i;return n.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?a:e}),null):null!==(n=t.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(p.a)(t.updatedBy),event:v,timestamp:t.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(p.e)(),children:o.a.createElement("div",{className:g.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(s=t.updatedBy)&&void 0!==s?s:x} ${v}`)),o.a.createElement(m.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:o.a.createElement(N,{eventId:c,timelineId:a,noteId:t.savedObjectId}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,a]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...d,...b]})}));R.displayName="NotePreviews"},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(45),i=a(2);const r={pageName:a(129).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},s=Object(i.createContext)([r,()=>n.noop])},,function(e,t){e.exports=function(){}},function(e,t,a){e.exports=a(24)(817)},function(e,t,a){e.exports=a(24)(1619)},function(e,t,a){e.exports=a(24)(3350)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(766);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return n.default}});var i=a(767);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var r=a(768);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return r.default}});var s=a(769);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return s.default}});var o=a(407);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return o.default}});var l=a(419);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var c=a(770);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return c.default}});var u=a(771);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return u.default}});var d=a(773);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var p=a(775);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return p.default}});var m=a(776);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return m.default}});var f=a(777);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var b=a(778);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return b.default}});var g=a(780);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return g.default}});var y=a(501);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return y.default}});var h=a(781);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return h.default}});var v=a(375);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return v.default}});var E=a(787);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return E.default}});var x=a(664);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return x.default}});var j=a(788);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return j.default}});var S=a(789);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return S.default}});var O=a(790);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return O.default}});var k=a(256);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return k.default}});var w=a(791);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return w.ensuredForwardRef}});var T=a(302);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return T.default}});var I=a(792);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return I.default}});var C=a(793);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return C.default}});var M=a(794);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return M.default}});var _=a(796);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return _.default}});var A=a(502);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return A.default}});var F=a(797);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return F.default}});var P=a(798);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return P.default}});var D=a(800);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return D.default}});var N=a(503);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return N.default}});var R=a(801);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return R.default}});var L=a(803);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return L.default}});var B=a(804);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return B.default}});var z=a(40);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return z.default}});var q=a(504);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return q.default}});var $=a(805);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return $.default}});var V=a(505);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return V.default}});var U=a(806);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var H=a(506);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return H.default}});var Q=a(507);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return Q.default}});var G=a(508);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return G.default}});var W=a(807);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return W.default}});var Z=a(808);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return Z.default}});var K=a(809);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return K.default}});var J=a(810);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return J.default}});var Y=a(811);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return Y.default}});var X=a(705);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return X.default}});var ee=a(812);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=a(813);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ae=a(814);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ae.useMediatedState}});var ne=a(815);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ne.default}});var ie=a(816);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var re=a(509);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return re.default}});var se=a(207);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return se.default}});var oe=a(510);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return oe.default}});var le=a(817);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ce=a(818);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ce.default}});var ue=a(819);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ue.default}});var de=a(820);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var pe=a(11);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return pe.default}});var me=a(821);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return me.default}});var fe=a(822);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var be=a(823);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return be.default}});var ge=a(235);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return ge.default}});var ye=a(824);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ye.default}});var he=a(825);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return he.default}});var ve=a(826);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return ve.default}});var Ee=a(511);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return Ee.default}});var xe=a(827);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return xe.default}});var je=a(257);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return je.default}});var Se=a(828);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return Se.default}});var Oe=a(829);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Oe.default}});var ke=a(835);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return ke.default}});var we=a(836);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return we.default}});var Te=a(837);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Te.default}});var Ie=a(255);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Ie.default}});var Ce=a(838);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Ce.default}});var Me=a(840);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Me.default}});var _e=a(841);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return _e.default}});var Ae=a(842);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return Ae.default}});var Fe=a(843);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return Fe.default}});var Pe=a(844);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return Pe.useStateWithHistory}});var De=a(845);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return De.default}});var Ne=a(846);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Ne.default}});var Re=a(847);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Re.default}});var Le=a(848);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return Le.default}});var Be=a(376);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return Be.default}});var ze=a(849);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return ze.default}});var qe=a(500);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return qe.default}});var $e=a(850);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return $e.default}});var Ve=a(303);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return Ve.default}});var Ue=a(851);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var He=a(223);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return He.default}});var Qe=a(254);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return Qe.default}});var Ge=a(852);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return Ge.default}});var We=a(853);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return We.default}});var Ze=a(854);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ze.default}});var Ke=a(855);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Ke.default}});var Je=a(856);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Je.useScrollbarWidth}});var Ye=a(858);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Ye.useMultiStateValidator}});var Xe=a(859);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Xe.default}});var et=a(860);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=a(861);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var at=a(862);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return at.useRendersCount}});var nt=a(300);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return nt.useFirstMountState}});var it=a(863);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var rt=a(864);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return rt.createGlobalState}});var st=a(865);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return st.useHash}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(a){var i;return n.__assign(n.__assign({},a),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var a=t,i=e;return a[i],n.__rest(a,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=n.__assign({get:i.useCallback((function(e){return a[e]}),[a])},s);return[a,o]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const i=Object(n.createContext)(null)},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a(49),r=a(20),s=a(116),o=a(121),l=a(110);const c=()=>{const{indicesExist:e,dataViewId:t}=Object(o.d)(s.SourcererScopeName.timeline),a=Object(l.i)().services.application.capabilities.siem.show,c=Object(n.useMemo)((()=>a&&(e||null===t)),[e,t,a]);return Object(n.useCallback)((e=>{return!!c&&(t=e,!Object(r.c)().map((e=>e.path)).find((e=>Object(i.matchPath)(t,e))));var t}),[c])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(17),i=a(45),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(113),u=a(393),d=a(162),p=a(132),m=a(126),f=a(296),b=a(125);const g=l()(n.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),y=l()(n.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),h=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:a,onTimelineChange:o,timelineType:l,placeholder:h})=>{const[v,E]=Object(r.useState)(50),[x,j]=Object(r.useState)(0),[S,O]=Object(r.useState)(""),[k,w]=Object(r.useState)(!1),{fetchAllTimeline:T,timelines:I,loading:C,totalCount:M}=Object(u.b)(),_=Object(r.useRef)(null),A=Object(r.useRef)(null),F=Object(r.useMemo)((()=>Object(i.debounce)(500,O)),[]),P=Object(r.useCallback)((e=>{F(e)}),[F]),D=Object(r.useCallback)((()=>{w(!k)}),[k]),N=Object(r.useCallback)(((e,t,a)=>{if(e<t&&_.current&&A.current){const e=_.current.clientHeight,t=A.current.clientHeight;a>10&&t-a<1.2*e&&t>x&&(j(t),E(v+50))}}),[x,v]),R=Object(r.useCallback)(((e,t)=>{const a=Object(d.f)({...e,title:e.timelineTitle})?p.ab:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),s.a.createElement(g,{grow:!0},s.a.createElement(n.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},s.a.createElement(n.EuiFlexItem,{"data-test-subj":"timeline"},s.a.createElement(n.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(n.EuiHighlight,{search:t},a))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(n.EuiTextColor,{color:"subdued",component:"span"},s.a.createElement("small",null,null!=r?r:Object(m.d)())))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var n;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?p.ab:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(n=t[0].graphEventId)&&void 0!==n?n:""),a()}),[a,o]),B=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]),z=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=h?h:f.e(l),onSearch:P,incremental:!1,append:s.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:k,onClick:D},p.D)})),[D,P,k,l,h]),q=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>N((null!=I?I:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:_,innerRef:A}})),[N,e,M,I]);return Object(r.useEffect)((()=>{T({pageInfo:{pageIndex:1,pageSize:v},search:S,sort:{sortField:c.f.updated,sortOrder:b.b.desc},onlyUserFavorite:k,status:null,timelineType:l})}),[T,k,v,S,l]),s.a.createElement(n.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:C&&null==I,listProps:q,renderOption:R,onChange:L,searchable:!0,searchProps:z,singleSelection:!0,options:($=t({timelines:null!=I?I:[],onlyFavorites:k,searchTimelineValue:S,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},B);var $},v=Object(r.memo)(h)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=n.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});n.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),n.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return h})),a.d(t,"c",(function(){return v}));var n=a(45),i=a(2),r=a(48),s=a(5),o=a(172),l=a(14),c=a(117),u=a(121),d=a(149),p=a(162),m=a(203),f=a(145),b=a(712),g=a(116);const y="createRuleFromTimeline",h="createRuleFromEql",v=e=>{const t=Object(r.useDispatch)(),{addError:a}=Object(c.a)(),{browserFields:v,dataViewId:E,selectedPatterns:x}=Object(u.d)(g.SourcererScopeName.timeline),j=Object(i.useRef)(!1),[S,O]=Object(i.useState)(null),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>{w(!0),O(e),e.dataViewId===E||Object(n.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[E,t]),[I]=Object(i.useState)({dataViewId:E,selectedPatterns:x}),C=Object(i.useMemo)((()=>null==S||Object(n.isEmpty)(v)||null!==S.dataViewId&&null!==E&&E!==S.dataViewId?null:v),[v,E,S]),M=Object(m.f)(y),_=Object(i.useMemo)(M,[M]),A=Object(m.f)(h),F=Object(i.useMemo)(A,[A]),P=Object(i.useCallback)((()=>{if(null!=S&&null!=C){try{const t=()=>{var e,t,a,n,i,r,s;return{dataProviders:null!=S.dataProviders&&S.dataProviders.length>0?Object(o.f)(Object(f.g)(S.dataProviders,C),{fields:[],title:x.join(",")}):"",query:{query:null!==(e=null===(t=S.kqlQuery.filterQuery)||void 0===t||null===(a=t.kuery)||void 0===a?void 0:a.expression)&&void 0!==e?e:"",language:null!==(n=null===(i=S.kqlQuery.filterQuery)||void 0===i||null===(r=i.kuery)||void 0===r?void 0:r.kind)&&void 0!==n?n:"kuery"},filters:null!==(s=S.filters)&&void 0!==s?s:[],eqlOptions:{}}},a=()=>{var e;return{dataProviders:"",query:{query:null!==(e=S.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:S.eqlOptions}}},n=j.current?a():t();w(!1),e({index:x,queryBar:{filters:""!==n.dataProviders?[...n.filters,Object(b.b)(n.dataProviders)]:n.filters,query:n.query,saved_id:null},...n.eqlOptions})}catch(e){w(!1),a(e,{toastMessage:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:S.id}}),title:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}j.current=!1,I.dataViewId!==E&&t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:I.dataViewId,selectedPatterns:I.selectedPatterns}))}}),[a,E,t,I.dataViewId,I.selectedPatterns,C,x,S,e]);Object(i.useEffect)((()=>{null!=C&&P()}),[P,C]);const D=Object(i.useCallback)((e=>{null!=S&&e===S.id||Object(p.h)({timelineId:e,onOpenTimeline:T,updateIsLoading:({id:e,isLoading:a})=>t(Object(l.updateIsLoading)({id:e,isLoading:a})),updateTimeline:Object(p.b)(t)})}),[t,T,S]),[N,R]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!N){let e=null;null!=_?e=_:null!=F&&(e=F,j.current=!0),null!=e&&(R(!0),D(e),w(!0))}}),[D,_,F,N]),{loading:k,onOpenTimeline:T}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return k}));var n=a(45),i=a(2),r=a.n(i),s=a(48),o=a(3),l=a(136),c=a.n(l),u=a(53),d=a(517),p=a.n(d),m=a(119),f=a(121),b=a(116),g=a(172),y=a(560),h=a(757),v=a(145),E=a(118);const x=p.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,j="timeline-filter-drop-area",S=(e=[])=>e.filter((e=>e.meta.controlledBy!==j)),O=Object(i.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:n,from:l,fromStr:u,kqlMode:d,isRefreshPaused:p,savedQueryId:O,setFilters:w,setSavedQueryId:T,refreshInterval:I,timelineId:C,to:M,toStr:_,updateReduxTime:A})=>{const F=Object(s.useDispatch)(),[P,D]=Object(i.useState)(null!=u?u:new Date(l).toISOString()),[N,R]=Object(i.useState)(null!=_?_:new Date(M).toISOString()),{browserFields:L,indexPattern:B}=Object(f.d)(b.SourcererScopeName.timeline),[z,q]=Object(i.useState)(void 0),[$,V]=Object(i.useState)({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"}),[U,H]=Object(i.useState)(S(t)),[Q,G]=Object(i.useState)(Object(g.f)(Object(v.g)(e,L),B)),W=Object(y.a)(),Z=Object(i.useCallback)(((e,t)=>F(E.a.applyKqlFilterQuery({id:C,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.f)(e,B)}}))),[F,B,C]);Object(i.useEffect)((()=>{let e=!0;const n=new o.Subscription;return a.setFilters(t),n.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=S(a.getFilters());w(e),H(e)}}})),()=>{e=!1,n.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=S(a.getFilters());c()(t,e)||a.setFilters(t)}),[t]),Object(i.useEffect)((()=>{V({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"})}),[n]),Object(i.useEffect)((()=>{G(Object(g.f)(Object(v.g)(e,L),B))}),[e,L,B]),Object(i.useEffect)((()=>{null!=u&&null!=_?(D(u),R(_)):null!=l&&null!=M&&(D(new Date(l).toISOString()),R(new Date(M).toISOString()))}),[l,u,M,_]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=O&&null!=W)try{const a=await W.getSavedQuery(O);e&&null!=a&&q({...a,attributes:{...a.attributes,filters:S(t)}})}catch(e){q(void 0)}else e&&q(void 0)}(),()=>{e=!1}}),[O]);const K=Object(i.useCallback)(((e,t)=>{if((null==n||null!=n&&n.expression!==e.query||n.kind!==e.language)&&Z(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");A({id:m.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:C,hasRangeChanged:!0})}}),[n,C]),J=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==O&&T(e.id),null!=W&&""!==Q){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===j)):-1;W.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(Q),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(Q)]:[]})}}else T(null)}),[Q,O,W]);return r.a.createElement(x,{className:"search_bar_container"},r.a.createElement(h.a,{dateRangeFrom:P,dateRangeTo:N,hideSavedQuery:"search"===d,indexPattern:B,isRefreshPaused:p,filterQuery:$,filterManager:a,filters:U,onSubmitQuery:K,refreshInterval:I,savedQuery:z,onSavedQuery:J,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),k=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:j,controlledBy:j,negate:!1,disabled:!1,type:"custom",key:Object(n.isEmpty)(a)?"bool":a[0],value:e},$state:{store:u.FilterStateStore.APP_STATE}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(17),i=a(2),r=a.n(i),s=a(44);const o=a.n(s)()((({iconSide:e,children:t,...a})=>r.a.createElement(n.EuiLink,a,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(s.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(s.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(s.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:a,dataTestSubj:s,disabled:l,href:c,iconSide:u="left",iconSize:d="s",iconType:p,onClick:m})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),b=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return r.a.createElement(o,{className:"siemLinkIcon",color:a,"data-test-subj":s,disabled:l,href:c,iconSide:u,onClick:m,"aria-label":b},r.a.createElement(n.EuiIcon,{size:d,type:p}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>{const a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a),n.remove()}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(17),i=a(47),r=a(56),s=a.n(r),o=a(2),l=a.n(o);const c=l.a.memo((({children:e,date:t,fieldName:a,className:r=""})=>l.a.createElement(n.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:r,content:l.a.createElement(n.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=a?l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},a)):null,l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(i.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:s.a.utc(t).toDate()})),l.a.createElement(n.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},s.a.utc(t).local().format("llll")),l.a.createElement(n.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},s()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));c.displayName="LocalizedDateTooltip"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(44);const s=a.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(r.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));s.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(s,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(5);const i=e=>e?n.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):n.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(17),s=a(113),o=a(132),l=a(193);const c=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:a})=>{const[c,u]=Object(n.useState)(null),d=Object(n.useMemo)((()=>e===s.l.template),[e]),p=Object(n.useMemo)((()=>d?c:null),[c,d]),m=Object(n.useMemo)((()=>null==p?null:p===s.g.elastic?s.k.immutable:s.k.active),[p]),f=Object(n.useMemo)((()=>[{id:s.g.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:s.g.custom,name:o.r,disabled:!d,withNext:!1,count:null!=a?a:void 0}]),[a,t,d]),b=Object(n.useCallback)((e=>{u(c===e?null:e)}),[u,c]),g=Object(n.useMemo)((()=>d?f.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:b.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,f,d,b]),y=Object(n.useCallback)((async()=>{p!==s.g.custom&&await Object(l.g)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:g,installPrepackagedTimelines:y}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(485),r=a(110);const s=()=>{const{conversations:e}=Object(i.a)(),{services:{telemetry:t}}=Object(r.i)(),a=Object(n.useCallback)((t=>{var a;return(null!==(a=e[t])&&void 0!==a?a:{isDefault:!1}).isDefault?t:"Custom"}),[e]),s=Object(n.useCallback)((({fn:e,params:{conversationId:t,...n}})=>e({...n,conversationId:a(t)})),[a]);return{reportAssistantInvoked:e=>s({fn:t.reportAssistantInvoked,params:e}),reportAssistantMessageSent:e=>s({fn:t.reportAssistantMessageSent,params:e}),reportAssistantQuickPrompt:e=>s({fn:t.reportAssistantQuickPrompt,params:e})}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.assistant.commentActions.addedNoteToTimelineToast",{defaultMessage:"Added note to timeline"}),r=n.i18n.translate("xpack.securitySolution.assistant.commentActions.viewAPMTraceLabel",{defaultMessage:"View APM Trace for this message"}),s=n.i18n.translate("xpack.securitySolution.assistant.commentActions.addMessageContentAsTimelineNoteAriaLabel",{defaultMessage:"Add message content as a timeline note"}),o=n.i18n.translate("xpack.securitySolution.assistant.commentActions.addNoteToTimelineTooltip",{defaultMessage:"Add note to timeline"}),l=n.i18n.translate("xpack.securitySolution.assistant.commentActions.addToCaseExistingCase",{defaultMessage:"Add to existing case"}),c=n.i18n.translate("xpack.securitySolution.assistant.commentActions.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),u=n.i18n.translate("xpack.securitySolution.assistant.commentActions.copyToClipboard",{defaultMessage:"Copy to clipboard"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(57),i=a(122),r=a(422),s=a(353);const o=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(n.createSelector)(r.selectNotesById,(e=>Object.values(e))),m=()=>Object(n.createSelector)(s.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const i=e=>{const[t,a]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const n=new MutationObserver((()=>{const n=!!document.getElementById(e);n&&!t&&a(!0),!n&&t&&a(!1)}));return n.observe(document.body,{childList:!0,subtree:!0}),()=>n.disconnect()}),[t,e]),t}},function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(23),i=a.n(n),r=a(62),s=a(61),o=a.n(s),l=a(2),c=a.n(l),u=a(44),d=a.n(u),p=a(17),m=a(54),f=a(4),b=a(594),g=a(229),y=a(546),h=a(172),v=a(110),E=a(484),x=a(230),j=a(384),S=a(129),O=a(164),k=a(319);const w=e=>({text:e,value:e}),T=d()(p.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-11itwu1-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),I=({combinedQueries:e,deleteQuery:t,filters:a,from:n,headerChildren:s,indexPattern:u,indexNames:d,runtimeMappings:p,onlyField:I,paddingSize:C,query:M,queryType:_,setAbsoluteRangeDatePickerTarget:A,setQuery:F,showLegend:P,showSpacer:D=!0,scopeId:N,sourcererScopeId:R,to:L,toggleTopN:B,hideQueryToggle:z=!1})=>{const q=Object(l.useMemo)((()=>`eventsByDatasetOverview-${_}`),[_]);Object(l.useEffect)((()=>()=>{t&&t({id:q})}),[t,q]);const $=Object(v.i)(),{formatUrl:V,search:U}=Object(O.l)(S.a.hosts),{navigateToApp:H}=$.services.application,[Q]=Object(v.o)(f.P),G=Object(l.useCallback)((e=>{e.preventDefault(),H(f.l,{deepLinkId:S.a.hosts,path:Object(g.c)(x.HostsTableType.events,U)})}),[H,U]),W=Object(l.useMemo)((()=>c.a.createElement(T,{onClick:G,href:V(Object(g.c)(x.HostsTableType.events))},j.o)),[G,V]),[Z,K]=Object(l.useMemo)((()=>null==e?Object(h.i)({config:Object(m.getEsQueryConfig)($.services.uiSettings),indexPattern:u,queries:[M],filters:a}):[e]),[e,$,u,M,a]);Object(k.a)({id:q,filterQuery:Z,kqlError:K,query:M,startDate:n,endDate:L});const J=Object(l.useMemo)((()=>{var e;return{...E.b,stackByOptions:null!=I?[w(I)]:E.b.stackByOptions,defaultStackByOption:null!=I?w(I):null!==(e=E.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:E.c[0],legendPosition:r.Position.Right,subtitle:e=>`${b.b}: ${o()(e).format(Q)} ${Object(b.c)(e)}`,titleSize:null==I?"m":"s"}}),[I,Q]),Y=Object(l.useMemo)((()=>null==I||null!=s?c.a.createElement(c.a.Fragment,null,s,null==I&&W):null),[I,s,W]);return c.a.createElement(y.a,i()({endDate:L,filterQuery:Z,headerChildren:Y,id:q,indexNames:d,runtimeMappings:p,onError:B,paddingSize:C,setAbsoluteRangeDatePickerTarget:A,setQuery:F,showSpacer:D,showLegend:P,skip:void 0===Z,startDate:n,scopeId:N,sourcererScopeId:R},J,{title:null!=I?j.l(I):J.title,chartHeight:160,hideQueryToggle:z}))};I.displayName="EventsByDatasetComponent";const C=c.a.memo(I)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(265),c=a(293);const u=o()(r.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1719m3x-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));u.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:a})=>i.a.createElement(u,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(a)?c.a:c.b)))},function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"d",(function(){return d}));var n=a(5);const i=e=>n.i18n.translate("xpack.securitySolution.eventsTab.externalAlertsUnit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>n.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),s=n.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=n.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=n.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),c=n.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),u=n.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=n.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(45),i=a(56),r=a.n(i),s=a(727);const o=[],l=e=>{var t,a,n;return(null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByGrouping)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:a,alerts:n})=>{var i;return[...e,...(null!==(i=n.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:n})=>({x:e,y:n,g:null!=t?t:a.toString()})))]}),o)},c=(e,t,a,n,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(r()(a).diff(r()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:a}}}}}},query:{bool:{filter:[...n,{range:{"@timestamp":{gte:t,lte:a}}}]}},runtime_mappings:i,_source:!1,size:0}),u=({isInitialLoading:e,isLoadingAlerts:t})=>e&&t,d=e=>{try{return null==e||Object(n.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},p=e=>{try{return Object(n.isEmpty)(e)?[]:[d(e)]}catch{return[]}},m=({callback:e,order:t}={})=>({id:"resetGroupByField",getDisplayName:()=>s.b,getIconType:()=>"editorRedo",type:"actionButton",isCompatible:async()=>!0,async execute({embeddable:t}){null==e||e();const a=t.getInput(),{attributes:{state:{visualization:{columns:n}}}}=a;t.updateInput({...a,attributes:{...a.attributes,state:{...a.attributes.state,visualization:{...a.attributes.state.visualization,columns:n.map((e=>({...e,hidden:!1})))}}}})},order:t})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),r=n.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(328);const i=new Set([n.b.STRING,n.b.BOOLEAN,n.b.NUMBER,n.b.IP]),r=e=>!!e&&i.has(e)},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return p}));var n=a(2),i=a.n(n),r=a(17),s=a(47),o=a(63);const l={tall:490,short:250},c=Object(n.createContext)({tableId:null}),u=({height:e="tall"})=>i.a.createElement(r.EuiPanel,{color:"subdued"},i.a.createElement(r.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},p=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(r.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e.isPlatinumOrTrialLicense},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),i=a.n(n);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function r(e,t){if(!e)throw new InvariantError(t)}},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(186);const i=(e="",t=!1,a="",i="",r="",s=!1)=>({meta:{license:e,license_uuid:a,cluster_uuid:i,cluster_name:r,cloud:t,serverless:s},global_manifest_version:"latest",windows:{events:{credential_access:!0,dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:n.f.prevent,blocklist:!0},ransomware:{mode:n.f.prevent,supported:!0},memory_protection:{mode:n.f.prevent,supported:!0},behavior_protection:{mode:n.f.prevent,reputation_service:t,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:n.f.prevent,blocklist:!0},behavior_protection:{mode:n.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:n.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:n.f.prevent,blocklist:!0},behavior_protection:{mode:n.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:n.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"LD_PRELOAD,LD_LIBRARY_PATH"}}}),r=(e=i())=>({...e,global_manifest_version:"latest"}),s=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,global_manifest_version:"latest",windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:n.f.off,supported:!1},memory_protection:{mode:n.f.off,supported:!1},behavior_protection:{mode:n.f.off,reputation_service:!1,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:n.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:n.f.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:n.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:n.f.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},o=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),l="Elastic Security {action} {filename}",c="Elastic Security {action} {rule}"},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(139),i=a(175);const r=["item_id","name","description","entries.value"],s={name:i.j,namespace_type:"agnostic",description:i.h,list_id:i.i,type:n.b.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},,function(e,t,a){"use strict";a.d(t,"c",(function(){return ge})),a.d(t,"b",(function(){return ye})),a.d(t,"a",(function(){return ve}));var n=a(2),i=a.n(n),r=a(48),s=a(60),o=a(711),l=a(110),c=a(4),u=a(112),d=a(122),p=a(118),m=a(14),f=a(393),b=a(196),g=a(47),y=a(44),h=a.n(y),v=a(113),E=a(750),x=a(478),j=a(193),S=a(135),O=a(17),k=a(132),w=a(49),T=a(117),I=a(714);const C=({onComplete:e,isEnableDownloader:t,exportedIds:a})=>{const{tabName:i}=Object(w.useParams)(),{addSuccess:r}=Object(T.a)(),s=Object(n.useCallback)((t=>{null!=e&&e(),r({title:i===v.l.template?k.U(t):k.T(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),o=Object(n.useCallback)((()=>{null!=e&&e()}),[e]);return Object(n.useEffect)((()=>{(async()=>{if(null!=a&&a.length&&t){const e=await Object(j.c)({ids:a});e instanceof Blob?(Object(I.a)(e,`${k.n}.ndjson`),s(a.length)):o()}})()}),[a,t]),null};C.displayName="ExportTimeline";const M=i.a.memo(C);var _=a(45);const A=i.a.memo((({title:e,closeModal:t,onDelete:a})=>{const{tabName:r}=Object(w.useParams)(),s=r===v.l.template?k.j:k.k,o=Object(n.useCallback)((()=>{const t=null!=e?e.trim():"",a=Object(_.isEmpty)(t)?k.ab:t;return i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:a}})}),[e]);return i.a.createElement(O.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:a,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},s))}));A.displayName="DeleteTimelineModal";const F=Object(y.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),P=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:a,title:r,onComplete:s,savedSearchIds:o})=>{const{addSuccess:l}=Object(T.a)(),{tabName:c}=Object(w.useParams)(),u=Object(n.useCallback)((()=>{null!=s&&s()}),[s]),d=Object(n.useCallback)((()=>{a.length>0&&null!=o&&o.length>0?(e(a,o),l({title:c===v.l.template?k.S(a.length):k.R(a.length)})):a.length>0&&(e(a),l({title:c===v.l.template?k.S(a.length):k.R(a.length)})),null!=s&&s()}),[e,a,s,l,c,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(F,{"data-test-subj":"remove-popover"}),t?i.a.createElement(O.EuiModal,{maxWidth:600,onClose:u},i.a.createElement(A,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:u})):null)}));P.displayName="DeleteTimelineModalOverlay";const D=({deleteTimelines:e,ids:t,savedSearchIds:a,isEnableDownloader:n,isDeleteTimelineModalOpen:r,onComplete:s,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:n,onComplete:s}),null!=e&&i.a.createElement(P,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:r,onComplete:s,savedObjectIds:t,savedSearchIds:a,title:o})),N=i.a.memo(D),R=()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(!1),[r,s]=Object(n.useState)(!1),o=Object(n.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(n.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),c=Object(n.useCallback)((e=>{s(!0),null!=e&&t(e)}),[]),u=Object(n.useCallback)((()=>{s(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(n.useCallback)((()=>{i(!1),s(!1),t(null)}),[]),isDeleteTimelineModalOpen:a,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:c,disableExportTimelineDownloader:u}},L=h.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));L.displayName="SearchRowContainer";const B=h()(O.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));B.displayName="SearchRowFlexGroup";const z=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:a,onToggleOnlyFavorites:r,children:s,timelineType:o})=>{const l=Object(n.useMemo)((()=>({placeholder:o===v.l.default?k.L:k.M,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(L,null,i.a.createElement(B,{gutterSize:"s"},i.a.createElement(O.EuiFlexItem,null,i.a.createElement(O.EuiSearchBar,{box:l,onChange:a})),i.a.createElement(O.EuiFlexItem,{grow:!1},i.a.createElement(O.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(O.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},k.D),!!s&&s)))))}));z.displayName="SearchRow";var q=a(23),$=a.n(q);const V=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,onOpenDeleteTimelineModal:n,onOpenTimeline:i,onCreateRule:r,onCreateRuleFromEql:s,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:v.l.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===v.l.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:v.l.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==v.l.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==v.l.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===v.l.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",onClick:e=>{null!=a&&a(e)},enabled:e=>null!=e.savedObjectId&&e.status!==v.k.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",onClick:e=>{null!=n&&n(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==v.k.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==v.k.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=r&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",onClick:e=>{null!=s&&e.savedObjectId&&s(e.savedObjectId)},enabled:e=>null!=s&&null!=e.savedObjectId&&e.status!==v.k.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=s&&null!=t&&t.hasEql}]}],U="45px";var H=a(162),Q=a(697),G=a(126),W=a(155);const Z=h.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),K=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:a,timelineType:n})=>[{isExpander:!0,render:({notes:t,savedObjectId:n})=>null!=t&&t.length>0&&null!=n?i.a.createElement(O.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[n]?a(Object(_.omit)(n,e)):a({...e,[n]:i.a.createElement(Q.a,{notes:t})}),"aria-label":e[n]?k.c:k.m,iconType:e[n]?"arrowDown":"arrowRight"}):null,width:U},{dataType:"string",field:"title",name:n===v.l.default?k.Y:k.Z,render:(e,a)=>null!=a.savedObjectId?i.a.createElement(O.EuiLink,{"data-test-subj":`timeline-title-${a.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${a.savedObjectId}`})},Object(H.f)(a)?k.ab:i.a.createElement(Z,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(H.f)(a)?k.ab:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(Z,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(G.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(W.b,{value:e}):Object(G.d)()),sortable:!0}],J=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(G.a)(e)),sortable:!1}]:[],Y=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(O.EuiToolTip,{content:k.C},i.a.createElement(O.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(H.d)(t)),sortable:!1,width:U},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(O.EuiToolTip,{content:k.J},i.a.createElement(O.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(H.e)(t)}`),sortable:!1,width:U},favorite:{align:"center",field:"favorite",name:i.a.createElement(O.EuiToolTip,{content:k.p},i.a.createElement(O.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(O.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:U}},a=[t.note,t.favorite],n=[t.pinnedEvent,t.note,t.favorite];return e===v.l.template?a:n},X=O.EuiBasicTable,ee=h()(X).withConfig({displayName:"BasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);ee.displayName="BasicTable";const te=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:a,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onTableChange:m,onToggleShowNotes:f,pageIndex:b,pageSize:g,searchResults:y,showExtendedColumns:h,sortField:E,sortDirection:x,tableRef:j,timelineType:O,totalSearchResultsCount:w})=>{const T={showPerPageOptions:h,pageIndex:b,pageSize:g,pageSizeOptions:[Math.floor(Math.max(a,1)/2),a,2*a],totalItemCount:w},I={sort:{field:E,direction:x}},C={selectable:e=>null!=e.savedObjectId&&e.status!==v.k.immutable,selectableMessage:e=>e?void 0:k.A,onSelectionChange:p},M=null!=j?{ref:j}:{},{kibanaSecuritySolutionsPrivileges:_}=Object(S.a)(),A=Object(n.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,itemIdToExpandedNotesRowMap:n,onCreateRule:i,onCreateRuleFromEql:r,onOpenDeleteTimelineModal:s,onOpenTimeline:o,onToggleShowNotes:l,showExtendedColumns:c,timelineType:u,hasCrudAccess:d})=>[...K({itemIdToExpandedNotesRowMap:n,onOpenTimeline:o,onToggleShowNotes:l,timelineType:u}),...J(c),...Y({timelineType:u}),...e.length?V({onCreateRule:i,onCreateRuleFromEql:r,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,onOpenDeleteTimelineModal:s,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onToggleShowNotes:f,showExtendedColumns:h,timelineType:O,hasCrudAccess:_.crud})),[e,t,s,o,l,c,u,d,p,f,h,O,_]),F=r||null==y?k.z:O===v.l.template?k.db:k.cb;return i.a.createElement(ee,$()({columns:A,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:s,items:null!=y?y:[],loading:r,noItemsMessage:F,onChange:m,pagination:T,selection:e.includes("selectable")?C:void 0,sorting:I},M))}));te.displayName="TimelinesTable";const ae=h.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ne=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:a,isLoading:r,itemIdToExpandedNotesRowMap:s,importDataModalToggle:o,onCreateRule:l,onCreateRuleFromEql:c,onDeleteSelected:u,onlyFavorites:d,onOpenTimeline:p,onQueryChange:m,onSelectionChange:f,onTableChange:b,onToggleOnlyFavorites:y,onToggleShowNotes:h,pageIndex:w,pageSize:T,query:I,refetch:C,searchResults:M,selectedItems:_,sortDirection:A,setImportDataModalToggle:F,sortField:P,timelineType:D=v.l.default,timelineStatus:L,timelineFilter:B,templateTimelineFilter:q,totalSearchResultsCount:$})=>{var V;const U=Object(n.useRef)(),{actionItem:Q,enableExportTimelineDownloader:G,isEnableDownloader:W,isDeleteTimelineModalOpen:Z,onOpenDeleteTimelineModal:K,onCompleteEditTimelineAction:J}=R(),{kibanaSecuritySolutionsPrivileges:Y}=Object(S.a)(),{getBatchItemsPopoverContent:X}=(({deleteTimelines:e,selectedItems:t,tableRef:a,timelineType:r=v.l.default})=>{const{enableExportTimelineDownloader:s,disableExportTimelineDownloader:o,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onOpenDeleteTimelineModal:u,onCloseDeleteTimelineModal:d}=R(),p=Object(n.useCallback)((e=>{null!=e&&e(),null!=a&&null!=a.current&&a.current.changeSelection([]),o(),d()}),[o,d,a]),{timelineIds:m,searchIds:f}=Object(n.useMemo)((()=>null!=t?ye(ge(t)):{timelineIds:[],searchIds:void 0}),[t]),b=Object(n.useCallback)((()=>s()),[s]),g=Object(n.useCallback)((()=>u()),[u]),y=Object(n.useCallback)((a=>{var n,s,o,u;const d=null==t||0===t.length,y=[];return t&&y.push(i.a.createElement(O.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:b},k.o)),e&&y.push(i.a.createElement(O.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:g},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:m,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onComplete:p.bind(null,a),title:1!==(null==t?void 0:t.length)?r===v.l.template?k.N(null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0):k.O(null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0):null!==(o=null===(u=t[0])||void 0===u?void 0:u.title)&&void 0!==o?o:""}),i.a.createElement(O.EuiContextMenuPanel,{items:y}))}),[t,e,m,f,l,c,p,r,b,g]);return{onCompleteBatchActions:p,getBatchItemsPopoverContent:y}})({deleteTimelines:Y.crud?e:void 0,selectedItems:_,tableRef:U,timelineType:D}),ee=Object(n.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ae,{"data-test-subj":"selectable-query-text"},I.trim().length?`${k.bb} "${I.trim()}"`:"")}})),[$,I]),ne=Object(n.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ae,{"data-test-subj":"selectable-query-text"},I.trim().length?`${k.bb} "${I.trim()}"`:"")}})),[$,I]),ie=Object(n.useMemo)((()=>null!=Q&&null!=Q.savedObjectId?[Q.savedObjectId]:[]),[Q]),re=Object(n.useMemo)((()=>null!=Q&&null!=Q.savedSearchId?[Q.savedSearchId]:void 0),[Q]),se=Object(n.useCallback)((()=>{null!=C&&C()}),[C]),oe=Object(n.useCallback)((()=>{null!=F&&F(!1)}),[F]),le=Object(n.useCallback)((()=>{null!=F&&F(!1),null!=C&&C()}),[F,C]),ce=Object(n.useMemo)((()=>{if(Y.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=c?["createRuleFromEql"]:[]];return L!==v.k.immutable&&(t.push("export"),t.push("selectable")),null!=u&&null!=e&&L!==v.k.immutable&&t.push("delete"),t}return L!==v.k.immutable?["export","selectable"]:[]}),[l,c,L,u,e,Y]),ue=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,q)),[q]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:ie,savedSearchIds:re,isDeleteTimelineModalOpen:Z,isEnableDownloader:W,onComplete:J,title:null!==(V=null==Q?void 0:Q.title)&&void 0!==V?V:k.ab}),i.a.createElement(E.a,{checkBoxLabel:k.I,closeModal:oe,description:k.P,errorMessage:k.t,failedDetailed:k.u,importComplete:le,importData:j.f,successMessage:k.V,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{className:H.a},!!B&&B,i.a.createElement(z,{"data-test-subj":"search-row",favoriteCount:a,onlyFavorites:d,onQueryChange:m,onToggleOnlyFavorites:y,query:I,timelineType:D},ue),i.a.createElement(x.a,{border:!0},i.a.createElement(x.d,null,i.a.createElement(x.c,null,i.a.createElement(x.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.Q," ",D===v.l.template?ee:ne))),i.a.createElement(x.c,null,L!==v.k.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(x.e,{"data-test-subj":"selected-count"},D===v.l.template?k.N(_.length):k.O(_.length)),i.a.createElement(x.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:X,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(x.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:se},k.K)))),i.a.createElement(te,{actionTimelineToShow:ce,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:G,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:K,onOpenTimeline:p,onSelectionChange:f,onTableChange:b,onToggleShowNotes:h,pageIndex:w,pageSize:T,searchResults:M,showExtendedColumns:!0,sortDirection:A,sortField:P,timelineType:D,tableRef:U,totalSearchResultsCount:$})))}));ne.displayName="OpenTimeline";var ie=a(170);const re=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:a,title:n})=>i.a.createElement(ie.a,{title:n,split:!0,height:40},i.a.createElement(O.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(O.EuiFlexItem,{grow:!1},i.a.createElement(O.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===a,onClick:t},k.q)),e&&i.a.createElement(O.EuiFlexItem,null,e)))));re.displayName="TitleRow";const se=h.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);se.displayName="HeaderContainer";const oe=Object(n.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:a,hideActions:r=[],isLoading:s,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:f,onToggleOnlyFavorites:b,onToggleShowNotes:g,pageIndex:y,pageSize:h,searchResults:v,selectedItems:E,sortDirection:x,sortField:j,timelineFilter:S,timelineType:k,templateTimelineFilter:w,title:T,totalSearchResultsCount:I})=>{const C=Object(n.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=c&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[c,e,r]),M=Object(n.useMemo)((()=>i.a.createElement(n.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.EuiModalHeader,null,i.a.createElement(se,null,i.a.createElement(re,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:E.length,title:T}))),i.a.createElement(O.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!S&&i.a.createElement(i.a.Fragment,null,S,i.a.createElement(O.EuiSpacer,{size:"m"})),i.a.createElement(z,{"data-test-subj":"search-row",onlyFavorites:u,onQueryChange:p,onToggleOnlyFavorites:b,query:"",timelineType:k},M),i.a.createElement(te,{actionTimelineToShow:C,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:m,onTableChange:f,onToggleShowNotes:g,pageIndex:y,pageSize:h,searchResults:v,showExtendedColumns:!1,sortDirection:x,sortField:j,timelineType:k,totalSearchResultsCount:I}))))}));oe.displayName="OpenTimelineModalBody";var le=a(129),ce=a(164);let ue;!function(e){e.tab="tab",e.filter="filter"}(ue||(ue={}));var de=a(718),pe=a(116),me=a(121),fe=a(184),be=a(224);const ge=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ye=e=>e.reduce(((e,{timelineId:t,searchId:a})=>{let n=e;return null!=a&&(n={...n,searchIds:[...n.searchIds,a]}),null!=t&&(n={...n,timelineIds:[...n.timelineIds,t]}),n}),{timelineIds:[],searchIds:[]}),he=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:a=[],isModal:g=!1,importDataModalToggle:y,onOpenTimeline:h,setImportDataModalToggle:E,title:x})=>{const S=Object(r.useDispatch)(),{startTransaction:T}=Object(fe.b)(),[I,C]=Object(n.useState)({}),[M,A]=Object(n.useState)(!1),[F,P]=Object(n.useState)(0),[D,N]=Object(n.useState)(t),[R,L]=Object(n.useState)(""),[B,z]=Object(n.useState)([]),[q,$]=Object(n.useState)("desc"),[V,U]=Object(n.useState)("updated"),Q=Object(n.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),G=Object(u.b)((e=>{var t,a;return null!==(t=null===(a=Q(e,d.c.active))||void 0===a?void 0:a.savedObjectId)&&void 0!==t?t:""})),{dataViewId:W,selectedPatterns:Z}=Object(me.d)(pe.SourcererScopeName.timeline),K=Object(n.useMemo)((()=>Object(H.b)(S)),[S]),J=Object(n.useCallback)((e=>S(Object(m.updateIsLoading)(e))),[S]),{customTemplateTimelineCount:Y,defaultTimelineCount:X,elasticTemplateTimelineCount:ee,favoriteCount:te,fetchAllTimeline:ae,timelines:ie,loading:re,totalCount:se,templateTimelineCount:he}=Object(f.b)(),{timelineType:ve,timelineTabs:Ee,timelineFilters:xe}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:a,search:r}=Object(ce.l)(le.a.timelines),{navigateToUrl:s}=Object(l.i)().services.application,{tabName:o}=Object(w.useParams)(),[c,u]=Object(n.useState)(o===v.l.default||o===v.l.template?o:v.l.default),d=a(Object(ce.j)(v.l.default,r)),p=a(Object(ce.j)(v.l.template,r)),m=Object(n.useCallback)((e=>{e.preventDefault(),s(d)}),[s,d]),f=Object(n.useCallback)((e=>{e.preventDefault(),s(p)}),[s,p]),b=Object(n.useCallback)((e=>[{id:v.l.default,name:k.X,href:d,disabled:!1,onClick:e===ue.tab?m:_.noop},{id:v.l.template,name:k.W,href:p,disabled:!1,onClick:e===ue.tab?f:_.noop}]),[d,p,m,f]),g=Object(n.useCallback)(((e,t)=>{u((t=>(t!==e&&u(e),t)))}),[u]),y=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(O.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},b(ue.tab).map((e=>i.a.createElement(O.EuiTab,{"data-test-subj":`timeline-${ue.tab}-${e.id}`,isSelected:e.id===o,disabled:e.disabled,key:`timeline-${ue.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),g(e.id,ue.tab)}},e.name)))),i.a.createElement(O.EuiSpacer,{size:"m"}))),[o]),h=Object(n.useMemo)((()=>i.a.createElement(O.EuiTabs,null,b(ue.filter).map((e=>i.a.createElement(O.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ue.filter}-${e.id}`,isSelected:e.id===c,key:`timeline-${ue.filter}-${e.id}`,onClick:t=>{e.onClick(t),g(e.id,ue.filter)}},e.name))))),[c,b,g]);return{timelineType:c,timelineTabs:y,timelineFilters:h}})({defaultTimelineCount:X,templateTimelineCount:he}),{timelineStatus:je,templateTimelineFilter:Se,installPrepackagedTimelines:Oe}=Object(de.a)({timelineType:ve,customTemplateTimelineCount:Y,elasticTemplateTimelineCount:ee}),ke=Object(n.useCallback)((()=>{ae({pageInfo:{pageIndex:F+1,pageSize:D},search:R,sort:{sortField:V,sortOrder:q},onlyUserFavorite:M,timelineType:ve,status:je})}),[ae,F,D,R,V,q,ve,je,M]),we=Object(n.useCallback)((e=>{L(e.queryText.trim())}),[]),Te=Object(n.useCallback)((async(e,t)=>{T({name:e.length>1?be.f.BULK_DELETE:be.f.DELETE}),e.includes(G)&&S(Object(m.createTimeline)({id:d.c.active,columns:b.b,dataViewId:W,indexNames:Z,show:!1})),await Object(j.b)(e,t),ke()}),[T,G,ke,S,W,Z]),Ie=Object(n.useCallback)((async(e,t)=>{await Te(e,t)}),[Te]),Ce=Object(n.useCallback)((async()=>{const e=ge(B),{timelineIds:t,searchIds:a}=ye(e);await Te(t,a),Re()}),[B,Te]),Me=Object(n.useCallback)((e=>{z(e)}),[]),_e=Object(n.useCallback)((({page:e,sort:t})=>{const{index:a,size:n}=e,{field:i,direction:r}=t;P(a),N(n),$(r),U(i)}),[]),Ae=Object(n.useCallback)((()=>{A(!M)}),[M]),Fe=Object(n.useCallback)((e=>{C(e)}),[]),{navigateTo:Pe}=Object(l.k)(),De=Object(n.useCallback)((e=>Pe({deepLinkId:c.yc.rulesCreate,path:`?${o.b}=${Object(s.encode)(e)}`})),[Pe]),Ne=Object(n.useCallback)((e=>Pe({deepLinkId:c.yc.rulesCreate,path:`?${o.a}=${Object(s.encode)(e)}`})),[Pe]),Re=Object(n.useCallback)((()=>{z([])}),[]),Le=Object(n.useCallback)((({duplicate:t,timelineId:a,timelineType:n})=>{t&&T({name:be.f.DUPLICATE}),g&&null!=e&&e(),Object(H.h)({duplicate:t,onOpenTimeline:h,timelineId:a,timelineType:n,updateIsLoading:J,updateTimeline:K})}),[J,K]);return Object(n.useEffect)((()=>{(()=>{const e=document.querySelector(`.${H.a} input`);null!=e&&e.focus()})()}),[]),Object(n.useEffect)((()=>{(async()=>{await Oe(),ke()})()}),[ke,Oe]),g?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:Ie,defaultPageSize:t,favoriteCount:te,hideActions:a,isLoading:re,itemIdToExpandedNotesRowMap:I,onAddTimelinesToFavorites:void 0,onlyFavorites:M,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Me,onTableChange:_e,onToggleOnlyFavorites:Ae,onToggleShowNotes:Fe,pageIndex:F,pageSize:D,query:R,searchResults:ie,selectedItems:B,sortDirection:q,sortField:V,templateTimelineFilter:Se,timelineType:ve,timelineStatus:je,timelineFilter:xe,title:x,totalSearchResultsCount:se}):i.a.createElement(ne,{"data-test-subj":"open-timeline",deleteTimelines:Ie,defaultPageSize:t,favoriteCount:te,isLoading:re,itemIdToExpandedNotesRowMap:I,importDataModalToggle:y,onAddTimelinesToFavorites:void 0,onCreateRule:De,onCreateRuleFromEql:Ne,onDeleteSelected:Ce,onlyFavorites:M,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Me,onTableChange:_e,onToggleOnlyFavorites:Ae,onToggleShowNotes:Fe,pageIndex:F,pageSize:D,query:R,refetch:ke,searchResults:ie,setImportDataModalToggle:E,selectedItems:B,sortDirection:q,sortField:V,templateTimelineFilter:Se,timelineType:ve,timelineStatus:je,timelineFilter:Ee,title:x,totalSearchResultsCount:se})})),ve=i.a.memo(he)},function(e,t,a){"use strict";a.d(t,"a",(function(){return w})),a.d(t,"e",(function(){return K})),a.d(t,"d",(function(){return J})),a.d(t,"f",(function(){return Y})),a.d(t,"c",(function(){return _})),a.d(t,"b",(function(){return A})),a.d(t,"g",(function(){return ie}));var n=a(17),i=a(2),r=a.n(i),s=a(0),o=a.n(s),l=a(5),c=a(13);const u={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends r.a.PureComponent{constructor(...e){super(...e),o()(this,"state",u),o()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),o()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,a=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),i=!this.state.selectedOptions.length;return Object(c.jsx)("div",{"data-test-subj":"custom-field-panel",style:{padding:16}},Object(c.jsx)(n.EuiForm,null,Object(c.jsx)(n.EuiFormRow,{label:l.i18n.translate("grouping.groupSelector.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:l.i18n.translate("grouping.groupSelector.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},Object(c.jsx)(n.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:l.i18n.translate("grouping.groupSelector.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:a,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),Object(c.jsx)(n.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:i,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},l.i18n.translate("grouping.selector.grouping.label.add",{defaultMessage:"Add"}))))}}o()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");const d=l.i18n.translate("grouping.additionalActions.takeAction",{defaultMessage:"Take actions"}),p=l.i18n.translate("grouping.alerts.label",{defaultMessage:"Group alerts by"}),m=l.i18n.translate("grouping.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),f=l.i18n.translate("grouping.groupBySingleField",{defaultMessage:"Select grouping"}),b=l.i18n.translate("grouping.noneGroupByOptionName",{defaultMessage:"None"}),g=l.i18n.translate("grouping.customGroupByOptionName",{defaultMessage:"Custom field"});var y=a(69),h=a(55);const v=Object(c.css)("font-size:",h.euiThemeVars.euiFontSizeXS,";font-weight:",h.euiThemeVars.euiFontWeightSemiBold,";border-right:",h.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;",""),E=Object(c.css)("font-size:",h.euiThemeVars.euiFontSizeXS,";font-weight:",h.euiThemeVars.euiFontWeightSemiBold,";border-right:",h.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;.smallDot{width:3px!important;display:inline-block;}.euiBadge__text{text-align:center;width:100%;}",""),x=Object(c.css)(".groupingAccordionForm .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:",h.euiThemeVars.euiBorderThin,";border-right:",h.euiThemeVars.euiBorderThin,";border-bottom:",h.euiThemeVars.euiBorderThin,";border-radius:0 0 6px 6px;}.groupingAccordionForm .euiAccordion__triggerWrapper{border-bottom:",h.euiThemeVars.euiBorderThin,";border-left:",h.euiThemeVars.euiBorderThin,";border-right:",h.euiThemeVars.euiBorderThin,";border-radius:6px;min-height:78px;padding-left:16px;padding-right:16px;}.groupingAccordionForm{border-top:",h.euiThemeVars.euiBorderThin,";border-bottom:none;border-radius:6px;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),j=Object(c.css)(".groupingAccordionFormLevel .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:none;border-right:none;border-bottom:",h.euiThemeVars.euiBorderThin,";border-radius:0;}.groupingAccordionFormLevel .euiAccordion__triggerWrapper{border-bottom:",h.euiThemeVars.euiBorderThin,";border-left:none;border-right:none;min-height:78px;padding-left:16px;padding-right:16px;border-radius:0;}.groupingAccordionFormLevel{border-top:none;border-bottom:none;border-radius:0;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),S=Object(y.euiStyled)(n.EuiContextMenu)`
  width: 250px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .euiContextMenuItem {
    border-bottom: ${h.euiThemeVars.euiBorderThin};
  }
  .euiContextMenuItem:last-child {
    border: none;
  }
`,O=Object(y.euiStyled)(n.EuiButtonEmpty)`
  font-weight: 'normal';

  .euiButtonEmpty__text {
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,k=({"data-test-subj":e,fields:t,groupsSelected:a=["none"],onGroupChange:r,options:s,title:o=p,maxGroupingLevels:u=1})=>{const[d,y]=Object(i.useState)(!1),h=Object(i.useCallback)((e=>!!a.find((t=>t===e))),[a]),v=Object(i.useMemo)((()=>{const e=e=>1!==u&&!(a.length!==u||e&&h(e));return[{id:"firstPanel",title:1===u?f:(n=u,l.i18n.translate("grouping.groupByPanelTitle",{values:{groupingLevelsCount:n},defaultMessage:"Select up to {groupingLevelsCount} groupings"})),items:[{"data-test-subj":"panel-none",name:b,icon:h("none")?"check":"empty",onClick:()=>r("none")},...s.map((t=>({"data-test-subj":`panel-${t.key}`,disabled:e(t.key),name:t.label,onClick:()=>r(t.key),icon:h(t.key)?"check":"empty"}))),{"data-test-subj":"panel-custom",name:g,icon:"empty",disabled:e(),panel:"customPanel",hasPanel:!0}]},{id:"customPanel",title:m,width:685,content:Object(c.jsx)(custom_field_panel_CustomFieldPanel,{currentOptions:s.map((e=>({text:e.label,field:e.key}))),onSubmit:e=>{r(e),y(!1)},fields:t})}];var n}),[t,a.length,h,u,r,s]),E=Object(i.useMemo)((()=>s.filter((e=>h(e.key)))),[h,s]),x=Object(i.useCallback)((()=>y((e=>!e))),[]),j=Object(i.useCallback)((()=>y(!1)),[]),k=Object(i.useMemo)((()=>{const e=h("none")?b:a.reduce(((e,t)=>{const a=E.find((e=>e.key===t));return null==a?e:e?[e,a.label].join(", "):a.label}),"");return Object(c.jsx)(O,{"data-test-subj":"group-selector-dropdown",flush:"both",iconSide:"right",iconSize:"s",iconType:"arrowDown",onClick:x,title:e,size:"xs"},`${o}: ${e}`)}),[a,h,x,E,o]);return Object(c.jsx)(n.EuiPopover,{"data-test-subj":null!=e?e:"groupByPopover",button:k,closePopover:j,isOpen:d,panelPaddingSize:"none"},Object(c.jsx)(S,{"data-test-subj":"groupByContextMenu",initialPanelId:"firstPanel",panels:v}))},w=r.a.memo(k);var T=a(30),I=a(476);const C=e=>{return t=e,l.i18n.translate("grouping.eventsTab.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"});var t},M="groups",_=e=>{const t=e.getItem(M);return t?JSON.parse(t):I.b},A=(e,t,a)=>{const n=_(e);e.setItem(M,JSON.stringify({...n,[t]:a}))};var F=a(53);const P=(e,t)=>null!=t&&t.length>0?t.reduce(((t,a)=>[...t,{meta:{alias:null,disabled:!1,key:e,negate:!1,params:{query:a},type:"phrase"},query:{match_phrase:{[e]:{query:a}}}}]),[{meta:{alias:null,disabled:!1,type:F.FILTERS.CUSTOM,negate:!1,key:e},query:{script:{script:{source:"doc[params['field']].size()==params['size']",params:{field:e,size:t.length}}}}}]):[],D=e=>[{meta:{disabled:!1,negate:!0,alias:null,key:e,value:"exists",type:"exists"},query:{exists:{field:e}}}],N=({isNullGroup:e,title:t,nullGroupMessage:a})=>Object(c.jsx)("div",null,Object(c.jsx)(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(c.jsx)(n.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},Object(c.jsx)(n.EuiTitle,{size:"xs"},Object(c.jsx)("h4",{className:"eui-textTruncate",title:t},t))),e&&a&&Object(c.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"null-group-icon"},Object(c.jsx)(n.EuiIconTip,{content:a,position:"right"})))),R=({customAccordionButtonClassName:e,customAccordionClassName:t="groupingAccordionForm",extraAction:a,forceState:r,groupBucket:s,groupPanelRenderer:o,groupingLevel:l=0,isLoading:u,isNullGroup:d=!1,onGroupClose:p,onToggleGroup:m,renderChildComponent:f,selectedGroup:b,nullGroupMessage:g})=>{const y=Object(i.useRef)(r);Object(i.useEffect)((()=>{"open"===y.current&&"closed"===r?(p(),y.current="closed"):"closed"===y.current&&"open"===r&&(y.current="open")}),[p,r,b]);const h=Object(i.useMemo)((()=>s.selectedGroup===b?{asString:s.key_as_string,asArray:s.key}:{asString:null,asArray:null}),[s.key,s.key_as_string,s.selectedGroup,b]),v=Object(i.useMemo)((()=>d?D(b):P(b,h.asArray)),[h.asArray,d,b]),E=Object(i.useCallback)((e=>{m&&m(e,s)}),[s,m]);return h.asString?Object(c.jsx)(n.EuiAccordion,{buttonClassName:e,buttonContent:Object(c.jsx)("div",{"data-test-subj":"group-panel-toggle",className:"groupingPanelRenderer"},null!=o?o:Object(c.jsx)(N,{title:h.asString,isNullGroup:d,nullGroupMessage:g})),buttonElement:"div",className:l>0?"groupingAccordionFormLevel":t,"data-test-subj":"grouping-accordion",extraAction:a,forceState:r,isLoading:u,id:`group${l}-${h.asString}`,onToggle:E,paddingSize:"m"},Object(c.jsx)("span",{"data-test-subj":"grouping-accordion-content"},f(v))):null},L=r.a.memo(R),B=({bucketKey:e,groupFilter:t,groupNumber:a,onTakeActionsOpen:r,statRenderers:s,takeActionItems:o})=>{const[l,u]=Object(i.useState)(!1),[p,m]=Object(i.useState)([]),f=Object(i.useCallback)((()=>(l||0!==p.length||m(o(t,a)),!l&&r?r():u(!l))),[o,t,a,l,r,p.length]),b=Object(i.useMemo)((()=>null==s?void 0:s.map((e=>{var t,a;const{dataTestSubj:i,component:r}=null!=e.badge?{dataTestSubj:`metric-${e.title}`,component:Object(c.jsx)(n.EuiToolTip,{position:"top",content:e.badge.value},Object(c.jsx)(n.EuiBadge,{style:{marginLeft:10,width:null!==(t=e.badge.width)&&void 0!==t?t:35},color:null!==(a=e.badge.color)&&void 0!==a?a:"hollow"},e.badge.value>99?"99+":e.badge.value.toString()))}:{dataTestSubj:`customMetric-${e.title}`,component:e.renderer};return Object(c.jsx)(n.EuiFlexItem,{grow:!1,key:e.title},Object(c.jsx)("span",{css:E,"data-test-subj":i},e.title,r))}))),[s]),g=Object(i.useMemo)((()=>Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiPopover,{anchorPosition:"downLeft",button:Object(c.jsx)(n.EuiButtonEmpty,{"data-test-subj":"take-action-button",onClick:f,iconType:"arrowDown",iconSide:"right"},d),closePopover:()=>u(!1),isOpen:l,panelPaddingSize:"none"},Object(c.jsx)(n.EuiContextMenuPanel,{items:p})))),[l,f,p]);return Object(c.jsx)(n.EuiFlexGroup,{"data-test-subj":"group-stats",key:`stats-${e}`,gutterSize:"none",alignItems:"center"},b,g)},z=r.a.memo(B);var q=a(47),$=(a(1264),a(1265)),V=a.n($);a(1266),a(1267);const U={maxWidth:500},H={tall:490,short:250},Q=({height:e="tall"})=>Object(c.jsx)(n.EuiPanel,{color:"subdued","data-test-subj":"empty-results-panel"},Object(c.jsx)(n.EuiFlexGroup,{style:{height:H[e]},alignItems:"center",justifyContent:"center"},Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiPanel,{hasBorder:!0,style:U},Object(c.jsx)(n.EuiFlexGroup,null,Object(c.jsx)(n.EuiFlexItem,null,Object(c.jsx)(n.EuiText,{size:"s"},Object(c.jsx)(n.EuiTitle,null,Object(c.jsx)("h3",null,Object(c.jsx)(q.FormattedMessage,{id:"grouping.empty.title",defaultMessage:"No grouping results match your selected Group alerts field"}))),Object(c.jsx)("p",null,Object(c.jsx)(q.FormattedMessage,{id:"grouping.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your Group alerts field"})))),Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiImage,{size:"200px",alt:"",src:V.a})))))));var G=a(1124);const W=({activePage:e,data:t,groupPanelRenderer:a,groupSelector:s,groupStatsRenderer:o,groupingId:u,groupingLevel:d=0,inspectButton:p,isLoading:m,itemsPerPage:f,onChangeGroupsItemsPerPage:b,onChangeGroupsPage:g,onGroupClose:y,onGroupToggle:h,renderChildComponent:E,selectedGroup:S,takeActionItems:O,tracker:k,unit:w=C})=>{var I,M,_;const[A,F]=Object(i.useState)({}),N=Object(i.useMemo)((()=>{var e,a;return null!==(e=null==t||null===(a=t.unitsCount)||void 0===a?void 0:a.value)&&void 0!==e?e:0}),[null==t||null===(I=t.unitsCount)||void 0===I?void 0:I.value]),R=Object(i.useMemo)((()=>`${N.toLocaleString()} ${w&&w(N)}`),[N,w]),B=Object(i.useMemo)((()=>{var e,a;return null!==(e=null==t||null===(a=t.groupsCount)||void 0===a?void 0:a.value)&&void 0!==e?e:0}),[null==t||null===(M=t.groupsCount)||void 0===M?void 0:M.value]),q=Object(i.useMemo)((()=>{return`${B.toLocaleString()} ${e=B,l.i18n.translate("grouping.total.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {group} other {groups}}"})}`;var e}),[B]),$=Object(i.useMemo)((()=>{var e,i;return null==t||null===(e=t.groupByFields)||void 0===e||null===(i=e.buckets)||void 0===i?void 0:i.map(((e,t)=>{var i,r;const s=function(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}(e.key),p=`group-${t}-${s}`,f=null!==(i=e.isNullGroup)&&void 0!==i&&i,b=f?((e,t)=>l.i18n.translate("grouping.nullGroup.title",{values:{selectedGroup:e,unit:t},defaultMessage:"The selected group by field, {selectedGroup}, is missing a value for this group of {unit}."}))(S,w(e.doc_count)):void 0;return Object(c.jsx)("span",{key:p,"data-test-subj":`level-${d}-group-${t}`},Object(c.jsx)(L,{isNullGroup:f,nullGroupMessage:b,onGroupClose:y,extraAction:Object(c.jsx)(z,{bucketKey:p,groupFilter:f?D(S):P(S,Array.isArray(e.key)?e.key:[e.key]),groupNumber:t,statRenderers:o&&o(S,e),takeActionItems:O}),forceState:null!==(r=A[p]&&A[p].state)&&void 0!==r?r:"closed",groupBucket:e,groupPanelRenderer:a&&a(S,e,b,m),isLoading:m,onToggleGroup:e=>{null==k||k(T.METRIC_TYPE.CLICK,G.a.groupToggled({isOpen:e,groupingId:u,groupNumber:t})),F({[p]:{state:e?"open":"closed"}}),null==h||h({isOpen:e,groupName:s,groupNumber:t,groupingId:u})},renderChildComponent:A[p]&&"open"===A[p].state?E:()=>Object(c.jsx)("span",null),selectedGroup:S,groupingLevel:d}),d>0?null:Object(c.jsx)(n.EuiSpacer,{size:"s"}))}))}),[null==t||null===(_=t.groupByFields)||void 0===_?void 0:_.buckets,a,o,u,d,m,y,h,E,S,O,k,A,w]),V=Object(i.useMemo)((()=>B?Math.ceil(B/f):1),[B,f]);return Object(c.jsx)(r.a.Fragment,null,d>0?null:Object(c.jsx)(n.EuiFlexGroup,{"data-test-subj":"grouping-table",justifyContent:"spaceBetween",alignItems:"center",style:{paddingBottom:20,paddingTop:20}},Object(c.jsx)(n.EuiFlexItem,{grow:!1},B>0&&N>0?Object(c.jsx)(n.EuiFlexGroup,{gutterSize:"none"},Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)("span",{css:v,"data-test-subj":"unit-count"},R)),Object(c.jsx)(n.EuiFlexItem,null,Object(c.jsx)("span",{css:v,"data-test-subj":"group-count",style:{borderRight:"none"}},q))):null),Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiFlexGroup,{gutterSize:"xs"},p&&Object(c.jsx)(n.EuiFlexItem,null,p),Object(c.jsx)(n.EuiFlexItem,null,s)))),Object(c.jsx)("div",{css:d>0?j:x,className:"eui-xScroll"},m&&Object(c.jsx)(n.EuiProgress,{"data-test-subj":"is-loading-grouping-table",size:"xs",color:"accent"}),B>0?Object(c.jsx)("span",{"data-test-subj":`grouping-level-${d}`},$,B>0&&Object(c.jsx)(r.a.Fragment,null,Object(c.jsx)(n.EuiSpacer,{size:"m"}),Object(c.jsx)(n.EuiTablePagination,{activePage:e,"data-test-subj":`grouping-level-${d}-pagination`,itemsPerPage:f,itemsPerPageOptions:[10,25,50,100],onChangeItemsPerPage:e=>{b&&b(e)},onChangePage:e=>{g&&g(e)},pageCount:V,showPerPageOptions:!0}))):Object(c.jsx)(Q,null)))},Z=r.a.memo(W),K=e=>!!e.find((e=>"none"===e)),J=({additionalFilters:e=[],from:t,groupByField:a,pageNumber:n,rootAggregations:i,runtimeMappings:r,size:s=10,sort:o,statsAggregations:l,to:c,uniqueValue:u})=>({size:0,runtime_mappings:{...r,groupByField:{type:"keyword",script:{source:"if (doc[params['selectedGroup']].size()==0) { emit(params['uniqueValue']) } else { emit(doc[params['selectedGroup']].join(params['uniqueValue']))}",params:{selectedGroup:a,uniqueValue:u}}}},aggs:{groupByFields:{terms:{field:"groupByField",size:1e4},aggs:{bucket_truncate:{bucket_sort:{sort:o,from:n,size:s}},...l?l.reduce(((e,t)=>Object.assign(e,t)),{}):{}}},unitsCount:{value_count:{field:"groupByField"}},groupsCount:{cardinality:{field:"groupByField"}},...i?i.reduce(((e,t)=>Object.assign(e,t)),{}):{}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:c}}}]}},_source:!1}),Y=(e,t,a)=>{var n,i,r,s;if(!a)return{};const o=null==a||null===(n=a.groupByFields)||void 0===n||null===(i=n.buckets)||void 0===i?void 0:i.map((a=>{if(a.key===t)return{...a,key:["â€”"],selectedGroup:e,key_as_string:"â€”",isNullGroup:!0};const n=(Array.isArray(a.key)?a.key[0]:a.key).split(t);return{...a,key:n,selectedGroup:e,key_as_string:n.join(", ")}}));return{...a,groupByFields:{buckets:o},groupsCount:{value:null!==(r=null===(s=a.groupsCount)||void 0===s?void 0:s.value)&&void 0!==r?r:0}}};var X=a(23),ee=a.n(X),te=a(1076),ae=a(1280),ne=a(1314);const ie=({componentProps:e,defaultGroupingOptions:t,fields:a,groupingId:n,maxGroupingLevels:r,onGroupChange:s,onOptionsChange:o,tracker:l,title:u})=>{const[d,p]=Object(i.useReducer)(te.a,te.b),{activeGroups:m}=Object(i.useMemo)((()=>{var e;return null!==(e=Object(ae.b)({groups:d},n))&&void 0!==e?e:I.c}),[n,d]),f=Object(i.useCallback)((e=>{p(ae.a.updateActiveGroups({id:n,activeGroups:e}))}),[n]),b=Object(ne.a)({defaultGroupingOptions:t,dispatch:p,fields:a,groupingId:n,groupingState:d,maxGroupingLevels:r,onGroupChange:s,onOptionsChange:o,tracker:l,title:u}),g=Object(i.useCallback)((t=>K([t.selectedGroup])?t.renderChildComponent([]):Object(c.jsx)(Z,ee()({},e,t,{groupSelector:b,groupingId:n,tracker:l}))),[e,b,n,l]);return Object(i.useMemo)((()=>({getGrouping:g,groupSelector:b,selectedGroups:m,setSelectedGroups:f})),[g,b,m,f])}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return Le}));var n=a(17),i=a(2),r=a.n(i),s=a(45),o=a(48),l=a(44),c=a.n(l),u=a(54),d=a(69),p=a(203),m=a(112),f=a(118),b=a(110),g=a(121),y=a(145),h=a(172),v=a(116),E=a(113),x=a(430),j=a(244),S=a(5);const O=e=>S.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),k=S.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),w=(S.i18n.translate("xpack.securitySolution.timeline.properties.savedLabel",{defaultMessage:"Saved"}),S.i18n.translate("xpack.securitySolution.timeline.properties.hasChangesLabel",{defaultMessage:"Unsaved changes"})),T=(S.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),S.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),({isOpen:e,title:t})=>S.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"})),I=c()(n.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-m1giyi-0"})(["&:active,&:focus{background:transparent;}> span{padding:0;}"]),C=c()(n.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-m1giyi-1"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;white-space:nowrap;"]),M=({timelineId:e,timelineType:t,timelineTitle:a,isOpen:l})=>{const c=Object(o.useDispatch)(),u=Object(i.useCallback)((()=>{c(f.a.showTimeline({id:e,show:!l})),Object(y.i)()}),[c,l,e]),d=Object(s.isEmpty)(a)?t===E.l.template?j.k:j.l:a,p=Object(i.useMemo)((()=>r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(C,{"data-test-subj":"timeline-title",grow:!1},l?r.a.createElement(n.EuiText,{grow:!1},r.a.createElement("h3",null,d)):r.a.createElement(r.a.Fragment,null,d)),!l&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(x.b,null)))),[l,d]);return l?r.a.createElement(r.a.Fragment,null,p):r.a.createElement(I,{"aria-label":T({isOpen:l,title:d}),className:y.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:l,onClick:u},p)},_=r.a.memo(M);var A=a(212),F=a(39),P=a(159),D=a(119),N=a(4),R=a(14),L=a(122),B=a(164),z=a(129),q=a(134);const $=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{cases:a,application:{navigateToApp:l}}=Object(b.i)().services,c=Object(o.useDispatch)(),{graphEventId:u,savedObjectId:d,status:p,title:g,timelineType:y}=Object(m.a)((a=>{var n;return Object(s.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(n=t(a,e))&&void 0!==n?n:q.b)})),[h,v]=Object(i.useState)(!1),[x,S]=Object(i.useState)(!1),O=Object(i.useCallback)((async t=>{S(!1),await l(N.l,{deepLinkId:z.a.case,path:null!=t?Object(B.a)({id:t.id}):Object(B.b)()}),c(Object(R.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:g}))}),[c,u,l,d,e,g]),k=a.helpers.canUseCases([N.i]),w=Object(i.useCallback)((()=>{v((e=>!e))}),[]),T=Object(i.useCallback)((()=>v(!1)),[]),I=Object(i.useCallback)((()=>{T(),l(N.l,{deepLinkId:z.a.case,path:Object(B.b)()}).then((()=>{c(Object(R.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:g.length>0?g:j.l})),c(Object(R.showTimeline)({id:L.c.active,show:!1}))}))}),[c,u,l,T,d,e,g]),C=Object(i.useCallback)((()=>{T(),S(!0)}),[S,T]),M=Object(i.useCallback)((()=>{S(!1)}),[S]),_=Object(i.useCallback)((()=>{v(!1)}),[]),A=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonEmpty,{size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:w,disabled:p===E.k.draft||y!==E.l.default},j.c)),[w,p,y]),F=Object(i.useMemo)((()=>[r.a.createElement(n.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:I},j.e),r.a.createElement(n.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:C},j.d)]),[C,I]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiPopover,{id:"singlePanel",button:A,isOpen:h,closePopover:_,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(n.EuiContextMenuPanel,{items:F})),x&&a.ui.getAllCasesSelectorModal({onRowClick:O,onClose:M,owner:[N.i],permissions:k}))};$.displayName="AddToCaseButtonComponent";const V=r.a.memo($);var U=a(327),H=a(466);const Q=S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineBtn",{defaultMessage:"New"}),G=S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimeline",{defaultMessage:"New Timeline"}),W=S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtn",{defaultMessage:"Open"}),Z=S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),K=(S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtn",{defaultMessage:"Save"}),S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtnLabel",{defaultMessage:"Save currently opened Timeline"}),S.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineTemplate",{defaultMessage:"New Timeline template"})),J=S.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),Y=(S.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"})),X=S.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),ee=S.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),te=S.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),ae=S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),ne=S.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),ie=S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),re=S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),se=S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),oe=S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),le=(S.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.closeButton",{defaultMessage:"Close"}),S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"})),ce=(S.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.title",{defaultMessage:"Timeline changes now require manual saves"}),S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"})),ue={padding:0},de=r.a.memo((({timelineId:e})=>{const[t,a]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{a(!1)}),[]),o=Object(i.useCallback)((()=>a((e=>!e))),[]),l=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonEmpty,{iconType:"arrowDown",size:"s",iconSide:"right",onClick:o},Q)),[o]);return r.a.createElement(n.EuiPopover,{button:l,isOpen:t,closePopover:s,panelStyle:ue},r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",direction:"column",alignItems:"flexStart"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(U.c,{timelineId:e,title:G,onClick:s})),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(H.a,{timelineId:e,title:K,onClick:s}))))}));de.displayName="NewTimelineAction";var pe=a(135),me=a(235),fe=a.n(me),be=a(146),ge=a(184),ye=a(224),he=a(228);const ve={title:{type:be.a.TEXT,validations:[{validator:be.h.emptyField("")}]},description:{type:be.a.TEXTAREA,validations:[]}},Ee=Object(be.j)({component:be.b}),xe=r.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:a,showWarning:l})=>{const{startTransaction:c}=Object(ge.b)(),u=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{isSaving:d,description:p="",status:b,title:g="",timelineType:y}=Object(m.a)((e=>Object(s.pick)(["isSaving","description","status","title","timelineType"],u(e,a)))),h=b===E.k.draft,v=fe()(d),x=Object(o.useDispatch)(),O=Object(he.a)({timelineId:L.c.active,timelineType:E.l.default}),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>w(e.target.checked)),[]),I=Object(i.useCallback)(((e,t)=>(t&&(x(f.a.updateTitleAndDescription({id:a,...e})),x(f.a.saveTimeline({id:a,saveAsNew:k}))),Promise.resolve())),[x,a,k]),C=Object(i.useMemo)((()=>({title:g,description:p})),[g,p]),{form:M}=Object(be.k)({id:"timelineTitleAndDescriptionForm",schema:ve,onSubmit:I,options:{stripEmptyFields:!1},defaultValue:C}),{isSubmitted:_,isSubmitting:A,submit:F}=M,P=Object(i.useCallback)((()=>{c({name:ye.f.SAVE}),F()}),[F,c]),D=Object(i.useCallback)((()=>{l&&O(),e()}),[e,O,l]),N=Object(i.useMemo)((()=>b===E.k.draft&&l?y===E.l.template?ne:ae:ie),[l,b,y]),R=Object(i.useMemo)((()=>b===E.k.draft?y===E.l.template?X:Y:y===E.l.template?te:Y),[b,y]),B=Object(i.useMemo)((()=>b===E.k.draft&&l?y===E.l.template?X:Y:ee),[l,b,y]),z=Object(i.useMemo)((()=>(e=>S.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===E.l.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(y)),[y]),q=Object(i.useMemo)((()=>`${se} (${oe})`),[]),$=Object(i.useMemo)((()=>({"aria-label":re,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:d,spellCheck:!0,placeholder:y===E.l.template?j.k:j.l})),[t,d,y]),V=Object(i.useMemo)((()=>({"aria-label":se,"data-test-subj":"save-timeline-description",disabled:d,placeholder:j.f})),[d]);return Object(i.useEffect)((()=>{_&&!d&&v&&e()}),[_,d,v,e]),r.a.createElement(n.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},d&&r.a.createElement(n.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(n.EuiModalHeader,{"data-test-subj":"modal-header"},R),r.a.createElement(n.EuiModalBody,null,l&&r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(n.EuiCallOut,{title:z,color:"danger",iconType:"warning","data-test-subj":"edit-timeline-callout"}),r.a.createElement(n.EuiSpacer,{size:"m"})),r.a.createElement(be.c,{form:M},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(Ee,{path:"title",fullWidth:!0,label:le,euiFieldProps:$}),r.a.createElement(n.EuiSpacer,null)),r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(Ee,{label:q,path:"description",fullWidth:!0,euiFieldProps:V}),r.a.createElement(n.EuiSpacer,null)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{direction:"row",alignItems:"center"},h?null:r.a.createElement(n.EuiSwitch,{label:ce,checked:k,onChange:T,"data-test-subj":"save-as-new-switch"}),r.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(n.EuiButton,{size:"s",fill:!1,onClick:D,isDisabled:d,"data-test-subj":"close-button"},N)),r.a.createElement(n.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(n.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:d||A,fill:!0,onClick:P,"data-test-subj":"save-button"},B))))))))}));xe.displayName="SaveTimelineModal";var je=a(57),Se=a(292);const Oe=r.a.memo((({timelineId:e})=>{const[t,a]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{a(!1)}),[]),o=Object(i.useCallback)((()=>{a(!0)}),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(pe.a)(),c=Object(i.useMemo)((()=>Object(je.createSelector)(f.b.selectTimeline,(e=>{var t,a,n,i,r,s;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:E.k.draft,updated:null!==(a=null==e?void 0:e.updated)&&void 0!==a?a:void 0,isSaving:null!==(n=null==e?void 0:e.isSaving)&&void 0!==n?n:void 0,isLoading:null!==(i=null==e?void 0:e.isLoading)&&void 0!==i?i:void 0,changed:null!==(r=null==e?void 0:e.changed)&&void 0!==r?r:void 0,show:null!==(s=null==e?void 0:e.show)&&void 0!==s?s:void 0}}))),[]),{status:u,isSaving:d}=Object(m.a)((t=>c(t,e))),p=l&&u!==E.k.immutable,b=u===E.k.draft,g=p?null:J;return r.a.createElement(n.EuiToolTip,{content:g,position:"bottom","data-test-subj":"save-timeline-btn-tooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiButton,{id:Se.a.SAVE_TIMELINE,fill:!0,color:"primary",onClick:o,size:"s",iconType:"save",isLoading:d,disabled:!p,"data-test-subj":"save-timeline-action-btn"},ee),t&&p?r.a.createElement(xe,{closeSaveTimeline:s,initialFocusOn:b?"title":"save",timelineId:e,showWarning:!1}):null))}));Oe.displayName="SaveTimelineButton";var ke=a(467);const we=["createFrom"],Te=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>t(!1)),[]),s=Object(i.useCallback)((()=>{t(!0)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"open-timeline-button",onClick:s,"aria-label":Z},W),e?r.a.createElement(ke.a,{onClose:a,hideActions:we}):null)}));Te.displayName="OpenTimelineAction";const Ie=c.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1qnxttj-0"})(["width:0px;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Ce=({mode:e="normal",timelineId:t,activeTab:a,isInspectButtonDisabled:i})=>{const{cases:s}=Object(A.b)().services,o=s.helpers.canUseCases([F.APP_ID]);return r.a.createElement(n.EuiFlexGroup,{id:Se.a.ACTION_MENU,gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",responsive:!1,"data-test-subj":"timeline-action-menu"},r.a.createElement(n.EuiFlexItem,{"data-test-subj":"new-timeline-action"},r.a.createElement(de,{timelineId:t})),r.a.createElement(n.EuiFlexItem,{"data-test-subj":"open-timeline-action"},r.a.createElement(Te,null)),r.a.createElement(n.EuiFlexItem,{"data-test-subj":"inspect-timeline-action"},r.a.createElement(P.b,{compact:"compact"===e,queryId:`${t}-${a}`,inputId:D.a.timeline,isDisabled:i,title:""})),o.create&&o.read?r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFlexItem,null,r.a.createElement(Ie,null)),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(V,{timelineId:t}))):null,r.a.createElement(n.EuiFlexItem,{"data-test-subj":"save-timeline-action"},r.a.createElement(Oe,{timelineId:t})))},Me=r.a.memo(Ce),_e=c()(n.EuiText).withConfig({displayName:"NoWrapText",componentId:"sc-33d5ea-0"})(["white-space:nowrap;"]),Ae=r.a.memo((({status:e,updated:t,changed:a})=>{let i=null;return e!==E.k.draft&&t?a&&(i=r.a.createElement(n.EuiBadge,{color:"warning"},w)):i=r.a.createElement(n.EuiBadge,{color:"warning"},k),i?r.a.createElement(_e,{size:"xs","data-test-subj":"timeline-status"},i):null}));Ae.displayName="TimelineStatusInfo";var Fe=a(756);const Pe=c()(n.EuiFlexGroup).withConfig({displayName:"FlyoutHeaderPanelContentFlexGroupContainer",componentId:"sc-a6ccyo-0"})(["overflow-x:auto;"]),De=c()(n.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-a6ccyo-1"})(["overflow:hidden;"]),Ne=Object(d.euiStyled)(n.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({$isOpen:e,theme:t})=>e?t.eui.euiBorderRadius:"0px"};
`,Re=({timelineId:e})=>{const t=Object(o.useDispatch)(),{browserFields:a,indexPattern:l}=Object(g.d)(v.SourcererScopeName.timeline),{uiSettings:c}=Object(b.i)().services,d=Object(i.useMemo)((()=>Object(u.getEsQueryConfig)(c)),[c]),E=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{activeTab:x,dataProviders:j,kqlQuery:S,title:k,timelineType:w,status:T,updated:I,show:C,filters:M,kqlMode:A,changed:F=!1}=Object(m.a)((t=>{var a;return Object(s.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode","changed"],null!==(a=E(t,e))&&void 0!==a?a:q.b)})),P=Object(i.useMemo)((()=>!Object(s.isEmpty)(j)||!Object(s.isEmpty)(Object(s.get)("filterQuery.kuery.expression",S))),[j,S]),D=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),N=Object(o.useSelector)((t=>D(t,e))),R=Object(s.isEmpty)(j)&&Object(s.isEmpty)(N)&&"template"===w?" ":null!=N?N:"",L=Object(i.useMemo)((()=>({query:R,language:"kuery"})),[R]),B=Object(i.useMemo)((()=>Object(h.d)({config:d,dataProviders:j,indexPattern:l,browserFields:a,filters:M||[],kqlQuery:L,kqlMode:A})),[a,j,d,M,l,A,L]),z=Object(i.useCallback)((()=>{Object(p.a)(),t(f.a.showTimeline({id:e,show:!1})),Object(y.i)()}),[t,e]);return r.a.createElement(Ne,{$isOpen:C,grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel","data-show":C},r.a.createElement(Pe,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},C?null:r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(Fe.b,{timelineId:e})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(U.a,{timelineId:e,compact:!0})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(De,{grow:!1},r.a.createElement(_,{timelineId:e,timelineType:w,timelineTitle:k,isOpen:C}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(Ae,{status:T,updated:I,changed:F})))),C&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(Me,{timelineId:e,activeTab:x,isInspectButtonDisabled:!P||void 0===(null==B?void 0:B.filterQuery)}),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{content:O("default"===w)},r.a.createElement(n.EuiButtonIcon,{"aria-label":O("default"===w),"data-test-subj":"close-timeline",iconType:"cross",onClick:z})))))))},Le=r.a.memo(Re)},function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(2),i=a(67),r=a.n(i),s=a(23),o=a.n(s),l=a(11),c=a.n(l),u=a(74),d=a.n(u),p=a(17);let m;!function(e){e.preboot="preboot",e.standard="standard"}(m||(m={}));const f="eui-global",b="eui-utilities",g={darkMode:!1};var y=a(13);const h=[p.euiStylisPrefixer],v=d()({key:"css",stylisPlugins:h,container:document.querySelector('meta[name="emotion"]')}),E=d()({key:f,stylisPlugins:h,container:document.querySelector(`meta[name="${f}"]`)}),x=d()({key:b,stylisPlugins:h,container:document.querySelector(`meta[name="${b}"]`)});v.compat=!0,E.compat=!0,x.compat=!0;const j={default:v,global:E,utility:x},S=({theme:{theme$:e},globalStyles:t,colorMode:a,children:i})=>{const r=c()(e,g),s=Object(n.useMemo)((()=>(e=>e.darkMode?p.COLOR_MODES_STANDARD.dark:p.COLOR_MODES_STANDARD.light)(r)),[r]),o=a||s,l=!1!==t&&void 0;return Object(y.jsx)(p.EuiProvider,{cache:j,colorMode:o,globalStyles:l,utilityClasses:l},i)},O=({children:e,i18n:t,...a})=>Object(y.jsx)(S,a,Object(y.jsx)(t.Context,null,e));var k=a(84);const w=({children:e,...t})=>Object(y.jsx)(O,o()({globalStyles:!1},t),Object(y.jsx)(k.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(y.jsx)(k.KibanaErrorBoundary,null,e))),T=(e,t)=>a=>(r.a.render(Object(y.jsx)(w,t,e),a),()=>r.a.unmountComponentAtNode(a));a(0),a(5);class mount_point_portal_MountPointPortalErrorBoundary extends n.Component{constructor(...e){super(...e),definePropertyfrom_dll_reference_kbnSharedDeps_npm_default()(this,"state",{error:void 0})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(){}render(){return this.state.error?Object(y.jsx)("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("reactPackages.mountPointPortal.errorMessage",{defaultMessage:"Error rendering portal content"})):this.props.children}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return Le}));var n=a(2),i=a.n(n),r=a(48),s=a(17),o=a(124),l=a(127),c=a(118),u=a(134),d=a(122),p=a(112),m=a(194),f=a(44),b=a.n(f),g=a(136),y=a.n(g),h=a(1359),v=a(377),E=a(405),x=a(1308),j=a(1135),S=a(1121),O=a(1273),k=a(211),w=a(620),T=a(892),I=a(1322),C=a(215),M=a(1085);const _=b()(s.EuiPanel).withConfig({displayName:"FlyoutFooterContainerPanel",componentId:"sc-1y4op3v-0"})([".side-panel-flyout-footer{background-color:transparent;}"]),A=()=>({promptContextId:void 0}),F=({browserFields:e,entityType:t="events",expandedEvent:a,handleOnEventClosed:r,isDraggable:o,isFlyoutView:l,runtimeMappings:c,tabType:u,scopeId:d,isReadOnly:p})=>{var f,b;const{hasAssistantPrivilege:g}=Object(v.a)(),y=g?m.k:A,F=Object(w.a)(),{indexName:P}=a,D=null!==(f=Object(k.a)(P,F))&&void 0!==f?f:P,[N,R,L,B,z]=Object(j.a)({entityType:t,indexName:null!=D?D:"",eventId:null!==(b=a.eventId)&&void 0!==b?b:"",runtimeMappings:c,skip:!a.eventId}),q=Object(h.a)(null==L?void 0:L.fields),{isolateAction:$,isHostIsolationPanelOpen:V,isIsolateActionSuccessBannerVisible:U,handleIsolationActionSuccess:H,showAlertDetails:Q,showHostIsolationPanel:G}=Object(S.a)(),{alertId:W,isAlert:Z,hostName:K,ruleName:J,timestamp:Y}=Object(k.b)(R),X=Object(n.useMemo)((()=>l?C.A:C.D),[l]),ee=Object(n.useCallback)((async()=>Object(E.e)(null!=R?R:[])),[R]),{promptContextId:te}=y(Z?"alert":"event",Z?C.e:C.i,Z?Object(C.d)(X):Object(C.h)(X),ee,null,Z?M.b[M.c].suggestedUserPrompt:M.b[M.e].suggestedUserPrompt,Z?C.f:C.j),ae=Object(n.useMemo)((()=>l||V?i.a.createElement(O.c,{eventId:a.eventId,eventIndex:D,isHostIsolationPanelOpen:V,isAlert:Z,isolateAction:$,loading:N,ruleName:J,showAlertDetails:Q,timestamp:Y,promptContextId:te,scopeId:d,refetchFlyoutData:z,getFieldsData:q}):i.a.createElement(x.b,{eventId:a.eventId,eventIndex:D,isAlert:Z,loading:N,ruleName:J,timestamp:Y,handleOnEventClosed:r,promptContextId:te,scopeId:d,refetchFlyoutData:z,getFieldsData:q})),[l,V,a.eventId,D,Z,$,N,J,Q,Y,te,r,d,z,q]),ne=Object(n.useMemo)((()=>l?i.a.createElement(O.a,{alertId:W,browserFields:e,detailsData:R,detailsEcsData:B,event:a,hostName:K,handleIsolationActionSuccess:H,handleOnEventClosed:r,isAlert:Z,isDraggable:o,isolateAction:$,isIsolateActionSuccessBannerVisible:U,isHostIsolationPanelOpen:V,loading:N,rawEventData:L,showAlertDetails:Q,scopeId:d,isReadOnly:p}):V?i.a.createElement(i.a.Fragment,null,U&&i.a.createElement(T.c,{hostName:K,alertId:W,isolateAction:$}),i.a.createElement(s.EuiFlyoutBody,null,i.a.createElement(I.a,{details:R,cancelCallback:Q,successCallback:H,isolateAction:$}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(x.a,{browserFields:e,detailsData:R,detailsEcsData:B,event:a,isAlert:Z,isDraggable:o,loading:N,rawEventData:L,scopeId:d,timelineTabType:u,handleOnEventClosed:r}))),[W,e,R,B,a,H,r,K,Z,o,l,V,U,p,$,N,L,Q,u,d]);return null!=a&&a.eventId?i.a.createElement(i.a.Fragment,null,ae,ne,i.a.createElement(_,{hasShadow:!1,borderRadius:"none"},i.a.createElement(O.b,{detailsData:R,detailsEcsData:B,refetchFlyoutData:z,handleOnEventClosed:r,isHostIsolationPanelOpen:V,isReadOnly:p,loadingEventDetails:N,onAddIsolationStatusClick:G,scopeId:d}))):null},P=i.a.memo(F,((e,t)=>y()(e.browserFields,t.browserFields)&&y()(e.expandedEvent,t.expandedEvent)&&e.scopeId===t.scopeId&&e.isDraggable===t.isDraggable));var D=a(5),N=a(119),R=a(137),L=a(147),B=a(121),z=a(1133),q=a(158),$=a(565),V=a(874),U=a(433),H=a(896);const Q=b.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1xbsnt9-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),G=({hostName:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(Q,null,D.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),W=({hostName:e})=>i.a.createElement(R.d,{hostName:e,isButton:!0},D.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),Z=({contextID:e,scopeId:t,hostName:a,isDraggable:s=!1})=>{const{to:o,from:c,isInitializing:u}=Object(L.a)(),{selectedPatterns:d}=Object(B.d)(),p=Object(r.useDispatch)(),[m,{hostDetails:f}]=Object(H.b)({endDate:o,hostName:a,indexNames:d,startDate:c}),b=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);p(Object(q.setAbsoluteRangeDatePicker)({id:N.a.global,from:a.from,to:a.to}))}),[p]);return i.a.createElement($.a,{criteriaFields:Object(V.a)(f),startDate:c,endDate:o,skip:u},(({isLoadingAnomaliesData:n,anomaliesData:r,jobNameById:u})=>i.a.createElement(z.a,{contextID:e,sourcererScopeId:Object(l.getSourcererScopeId)(t),id:H.a,isInDetailsSidePanel:!0,data:f,anomaliesData:r,isDraggable:s,isLoadingAnomaliesData:n,indexNames:d,loading:m,startDate:c,endDate:o,narrowDateRange:b,hostName:a,jobNameById:u})))},K=b()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1i9mt5q-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),J=b()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1i9mt5q-1"})(["flex:1 0 auto;"]),Y=b()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1i9mt5q-2"})(["align-self:flex-start;flex:1 0 auto;"]),X=b.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1i9mt5q-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),ee=i.a.memo((({contextID:e,scopeId:t,expandedHost:a,handleOnHostClosed:n,isDraggable:r,isFlyoutView:o})=>{const{hostName:l}=a;return l?o?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(G,{hostName:l})),i.a.createElement(K,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(W,{hostName:l}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Z,{contextID:e,scopeId:t,hostName:l}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(J,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(G,{hostName:l})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":D.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:n}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Y,{grow:!1},i.a.createElement(W,{hostName:l})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(X,null,i.a.createElement(Z,{contextID:e,scopeId:t,hostName:l,isDraggable:r}))):null}));var te=a(54),ae=a(319),ne=a(1310),ie=a(1311),re=a(110),se=a(172),oe=a(128),le=a(1333),ce=a(308),ue=a(1087),de=a(577),pe=a(435);const me=b.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1jm2ava-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),fe=({ip:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(me,null,D.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),be=({expandedNetwork:{ip:e,flowTarget:t}})=>i.a.createElement(R.h,{ip:e,flowTarget:t,isButton:!0},D.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),ge=({contextID:e,expandedNetwork:t,isDraggable:a})=>{const{ip:s,flowTarget:o}=t,l=Object(r.useDispatch)(),{to:c,from:u,isInitializing:d}=Object(L.a)(),m=Object(n.useMemo)((()=>oe.d.globalQuerySelector()),[]),f=Object(n.useMemo)((()=>oe.d.globalFiltersQuerySelector()),[]),b=Object(p.a)(m),g=Object(p.a)(f),y=ce.c.NetworkType.details,h=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);l(Object(q.setAbsoluteRangeDatePicker)({id:N.a.global,from:a.from,to:a.to}))}),[l]),{services:{uiSettings:v}}=Object(re.i)(),{indicesExist:E,indexPattern:x,selectedPatterns:j}=Object(B.d)(),[S,O]=Object(se.i)({config:Object(te.getEsQueryConfig)(v),indexPattern:x,queries:[b],filters:g}),[k,{id:w,networkDetails:T}]=Object(le.b)({skip:d||void 0===S,filterQuery:S,indexNames:j,ip:s});Object(ae.a)({id:w,filterQuery:S,kqlError:O,query:b,startDate:u,endDate:c});const{jobNameById:I}=Object(de.a)(),C=Object(n.useMemo)((()=>Object.keys(I)),[I]),[M,_]=Object(ue.a)({criteriaFields:Object(ie.a)(s,o),startDate:u,endDate:c,skip:d,jobIds:C,aggregationInterval:"auto"});return E?i.a.createElement(ne.a,{contextID:e,id:w,ip:s,data:T,anomaliesData:_,loading:k,isInDetailsSidePanel:!0,isLoadingAnomaliesData:M,isDraggable:a,type:y,flowTarget:o,startDate:u,endDate:c,narrowDateRange:h,indexPatterns:j,jobNameById:I}):i.a.createElement(pe.a,null)},ye=b()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1tify25-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),he=b()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tify25-1"})(["flex:1 0 auto;"]),ve=b()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1tify25-2"})(["align-self:flex-start;flex:1 0 auto;"]),Ee=b.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1tify25-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),xe=i.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:a,isFlyoutView:n,isDraggable:r})=>{const{ip:o}=t;return n?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(fe,{ip:o})),i.a.createElement(ye,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(be,{expandedNetwork:t}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(ge,{contextID:e,expandedNetwork:t}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(he,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(fe,{ip:o})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":D.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(ve,{grow:!1},i.a.createElement(be,{expandedNetwork:t})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Ee,null,i.a.createElement(ge,{contextID:e,expandedNetwork:t,isDraggable:r})))}));var je=a(1095),Se=a(693),Oe=a(1168),ke=a(176);const we=b.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-19b6yfb-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),Te=({userName:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(we,null,D.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),Ie=({userName:e})=>i.a.createElement(R.m,{userName:e,isButton:!0},D.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),Ce=({contextID:e,scopeId:t,userName:a,isDraggable:s})=>{const{to:o,from:c,isInitializing:u}=Object(L.a)(),{selectedPatterns:d}=Object(B.d)(),p=Object(r.useDispatch)(),[m,{userDetails:f}]=Object(Se.b)({endDate:o,startDate:c,userName:a,indexNames:d,skip:u}),b=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);p(Object(q.setAbsoluteRangeDatePicker)({id:N.a.global,from:a.from,to:a.to}))}),[p]);return i.a.createElement($.a,{criteriaFields:Object(Oe.a)(ke.UsersType.details,a),startDate:c,endDate:o,skip:u},(({isLoadingAnomaliesData:n,anomaliesData:r,jobNameById:u})=>i.a.createElement(je.a,{userName:a,isInDetailsSidePanel:!0,data:f,loading:m,contextID:e,sourcererScopeId:Object(l.getSourcererScopeId)(t),isDraggable:s,id:"usersDetailsQuery",anomaliesData:r,isLoadingAnomaliesData:n,startDate:c,endDate:o,narrowDateRange:b,indexPatterns:d,jobNameById:u})))},Me=b()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-iwngk-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),_e=({contextID:e,scopeId:t,userName:a})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(Te,{userName:a})),i.a.createElement(Me,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Ie,{userName:a}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Ce,{contextID:e,scopeId:t,userName:a}))),Ae=b()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-190swzt-0"})(["flex:1 0 auto;"]),Fe=b()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-190swzt-1"})(["align-self:flex-start;flex:1 0 auto;"]),Pe=b.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-190swzt-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),De=({contextID:e,scopeId:t,userName:a,isDraggable:n,handleOnClose:r})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Ae,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(Te,{userName:a})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":D.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:r}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Fe,{grow:!1},i.a.createElement(Ie,{userName:a})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Pe,null,i.a.createElement(Ce,{contextID:e,scopeId:t,userName:a,isDraggable:n}))),Ne=({contextID:e,scopeId:t,userName:a,handleOnClose:n,isFlyoutView:r,isDraggable:s})=>r?i.a.createElement(_e,{userName:a,contextID:e,scopeId:t}):i.a.createElement(De,{userName:a,contextID:e,isDraggable:s,handleOnClose:n,scopeId:t}),Re=i.a.memo(Ne),Le=i.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:a,isFlyoutView:m,runtimeMappings:f,tabType:b,scopeId:g,isReadOnly:y})=>{var h,v,E,x;const j=Object(r.useDispatch)(),S=Object(n.useMemo)((()=>Object(l.isTimelineScope)(g)?c.b.getTimelineByIdSelector():Object(l.isInTableScope)(g)?o.j.getTableByIdSelector():void 0),[g]),O=Object(p.a)((e=>{var t,a;return null===(t=null!==(a=S&&S(e,g))&&void 0!==a?a:u.b)||void 0===t?void 0:t.expandedDetail}));Object(n.useEffect)((()=>()=>{j(o.h.toggleDetailPanel({id:g}))}),[j,g]);const k=Object(n.useCallback)((()=>{const e=Object(l.getScopedActions)(g);e&&j(e.toggleDetailPanel({id:g}))}),[j,g]),w=null!=b?b:d.d.query,T=Object(n.useCallback)((()=>{a?a():k()}),[k,a]);if(!O)return null;const I=O[w];if(null==I||!I.panelView)return null;let C=null,M="s",_=g;const A=`${g}-${w}`,F=g===d.c.active&&w===d.d.query;return"eventDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(h=I.params)&&void 0!==h&&h.eventId&&(M="m",_=I.params.eventId,C=i.a.createElement(P,{browserFields:e,entityType:t,expandedEvent:null==I?void 0:I.params,handleOnEventClosed:T,isDraggable:F,isFlyoutView:m,runtimeMappings:f,tabType:w,scopeId:g,isReadOnly:y})),"hostDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(v=I.params)&&void 0!==v&&v.hostName&&(_=I.params.hostName,C=i.a.createElement(ee,{contextID:A,expandedHost:null==I?void 0:I.params,handleOnHostClosed:T,isDraggable:F,isFlyoutView:m,scopeId:g})),"userDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(E=I.params)&&void 0!==E&&E.userName&&(_=I.params.userName,C=i.a.createElement(Re,{contextID:A,userName:I.params.userName,handleOnClose:T,isDraggable:F,isFlyoutView:m,scopeId:g})),"networkDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(x=I.params)&&void 0!==x&&x.ip&&(_=I.params.ip,C=i.a.createElement(xe,{contextID:A,expandedNetwork:null==I?void 0:I.params,handleOnNetworkClosed:T,isDraggable:F,isFlyoutView:m})),m?i.a.createElement(s.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:M,onClose:T,ownFocus:!1,key:_},C):C}));Le.displayName="DetailsPanel"},,function(e,t,a){"use strict";a.d(t,"b",(function(){return E})),a.d(t,"a",(function(){return S})),a.d(t,"c",(function(){return C}));var n=a(2),i=a.n(n),r=a(17),s=a(113),o=a(708),l=a(164);const c="timeline";var u=a(5);const d=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),b=e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),g=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=a(129);const h=({onClosePopover:e,onInsert:t})=>{const{formatUrl:a}=Object(l.l)(y.a.timelines),c=Object(n.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),u=Object(n.useCallback)(((e,n,i)=>{const r=a(Object(l.k)(null!=n?n:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[a,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:c,onTimelineChange:u,onClosePopover:e,timelineType:s.l.default})))},v=Object(n.memo)(h),E={name:c,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:a}){return i.a.createElement(v,{onClosePopover:a,onInsert:t})}};var x=a(60),j=a(310);const S=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,a=e.prototype.inlineMethods,n=function(e,t,a){let n=0;if("["!==t[n])return!1;if(a)return!0;function i(e,a){if(t[n]!==e)throw new Error(f);n++;let i="",r=0;for(;n<t.length;n++){const s=t[n];if(s===a&&0===r)return n++,i;s===a?r--:s===e&&r++,i+=s}return""}const r=i("[","]"),s=i("(",")"),o=e.now();if(!r)return this.file.info(p,{line:o.line,column:o.column}),!1;try{var l;const t=s.split("?"),a=Object(j.parse)(t[1]),n=Object(x.safeDecode)(null!==(l=a.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:u=""}=null!=n?n:{id:null,graphEventId:""};return i?e(`[${r}](${s})`)({type:c,id:i,title:r,graphEventId:u}):(this.file.info(m,{line:o.line,column:o.column+s.indexOf("id")}),!1)}catch{this.file.info((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(s),{line:o.line,column:o.column})}return!1},i=function(e,t,a){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&n.call(this,e,t,a)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,a.splice(a.indexOf("url"),0,c)};var O=a(48),k=a(162),w=a(14),T=a(117);const I=({id:e,title:t,graphEventId:a})=>{const{addError:s}=Object(T.a)(),o=(()=>{const e=Object(O.useDispatch)();return Object(n.useCallback)(((t,a,n)=>{Object(k.h)({graphEventId:n,timelineId:t,onError:a,updateIsLoading:({id:t,isLoading:a})=>e(Object(w.updateIsLoading)({id:t,isLoading:a})),updateTimeline:Object(k.b)(e)})}),[e])})(),l=Object(n.useCallback)(((e,t)=>{s(e,{title:g,toastMessage:b(t)})}),[s]),c=Object(n.useCallback)((()=>o(null!=e?e:"",l,a)),[e,a,o,l]);return i.a.createElement(r.EuiToolTip,{content:(d=null!=e?e:"",u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(r.EuiLink,{onClick:c,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},C=Object(n.memo)(I)},function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(45),i=a(17),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(153),u=a(113),d=a(241),p=a(5);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),T=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),I=[{label:y},{label:v},{label:h},{label:E},{label:f},{label:m}],C=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(a=e[t],null!=a.fields&&Object.keys(a.fields).length>0?Object.keys(a.fields):C).map((e=>({label:e})))};var a})):C,_=({browserFields:e,selectedField:t,selectedOperator:a,type:i})=>{const r=t.length>0?t[0].label:"",s=a.length>0?a[0].label:"",o=e&&null!=Object(d.a)(e)[r],l=-1!==Object(n.findIndex)((e=>e.label===s),I),c=i===u.a.template&&(s===h||s===E);return o&&l&&!c},A=e=>{switch(e.length>0?e[0].label:""){case y:case v:return c.d;case h:case E:return c.c;case f:case m:return c.b;default:return c.d}},F=e=>{switch(e.length>0?e[0].label:""){case v:case E:case m:return!0;default:return!1}},P=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var D=a(145);const N=({value:e,onChangeCallback:t})=>{const[a,n]=Object(r.useState)(R(e));Object(r.useEffect)((()=>{t(L(a))}),[a,t]);const o=Object(r.useCallback)(((e,t=a)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&n([...a,{label:e}])}),[a]),l=Object(r.useCallback)((e=>{n(e)}),[]);return s.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:a,placeholder:x,onCreateOption:o,onChange:l})},R=e=>Object(D.k)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),B=({value:e,onChangeCallback:t})=>{const[a,n]=Object(r.useState)(z(e));Object(r.useEffect)((()=>{t(P(a))}),[a,t]);const o=Object(r.useCallback)((e=>{n(e.target.value)}),[]);return s.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:O,value:P(a)})},z=e=>{var t;return Object(D.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=s.a.memo((({andProviderId:e,browserFields:t,field:a,isExcluded:o,onDataProviderEdited:l,operator:u,providerId:d,timelineId:p,value:x,type:O=c.a.default})=>{const[C,P]=Object(r.useState)([{label:a}]),[D,R]=Object(r.useState)(((e,t)=>":"===t?e?[{label:v}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:h}]:e?[{label:m}]:[{label:f}])(o,u)),[L,z]=Object(r.useState)(x),$=Object(r.useMemo)((()=>D.length>0&&(D[0].label===h||D[0].label===E)),[D]),V=Object(r.useMemo)((()=>O!==c.a.template&&D.length>0&&D[0].label!==f&&D[0].label!==m&&!$),[$,O,D]),U=Object(r.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),H=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},Q=Object(r.useCallback)((e=>{P(e),O===c.a.template&&z(`{${e[0].label}}`),H()}),[O]),G=Object(r.useCallback)((e=>{R(e),H()}),[]),W=Object(r.useCallback)((e=>{z(e)}),[]),Z=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:F(D),field:C.length>0?C[0].label:"",id:p,operator:A(D),providerId:d,value:L,type:O})}),[l,e,D,C,p,d,L,O]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>n.noop})),[]),s.a.createElement(i.EuiPanel,{paddingSize:"s"},s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:b},s.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:Q,options:M(t),placeholder:g,selectedOptions:C,singleSelection:{asPlainText:!0},fullWidth:!0}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:j},s.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:G,options:I,placeholder:w,selectedOptions:D,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},V&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(B,{onChangeCallback:W,value:x})),$&&O!==c.a.template&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(N,{onChangeCallback:W,value:x}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},O===c.a.template&&$&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:T(D[0].label)}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:O,browserFields:t,selectedField:C,selectedOperator:D})||U,onClick:Z,size:"m"},S))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f}));var n=a(2),i=a.n(n),r=a(90);const s={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=a(117),l=a(110),c=a(152);const u=Object(c.d)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),d=a(5).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...s,capabilitiesFetched:!1},m=i.a.createContext(p);m.displayName="MlCapabilitiesContext";const f=i.a.memo((({children:e})=>{const[t,a]=Object(n.useState)(p),r=Object(l.h)(),{addError:s}=Object(o.a)(),{start:f,result:b,error:g}=Object(c.a)(u);return Object(n.useEffect)((()=>{f({http:r})}),[r,f]),Object(n.useEffect)((()=>{b&&a({...b,capabilitiesFetched:!0})}),[b]),Object(n.useEffect)((()=>{g&&s(g,{title:d})}),[s,g]),i.a.createElement(m.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(2),i=a.n(n),r=a(17),s=a(117),o=a(5);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),p=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),m=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),b=(e,t,a)=>{const n=a.map((t=>e(t.error.message))),i=new Error(n.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var g=a(212);const y=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:a}=Object(g.b)().services;if(!t||!e.length)return null;const{actionPath:n,message:s,buttonLabel:l}=e[0];return i.a.createElement(r.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(c=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:c},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(r.EuiText,{size:"xs"},s)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(r.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:a.basePath.prepend(n)},l||m)))));var c};y.displayName="ActionConnectorWarningsComponent";const h=i.a.memo(y);h.displayName="ActionConnectorWarnings";const v=({checkBoxLabel:e,closeModal:t,description:a,errorMessage:m,failedDetailed:g,importComplete:y,importData:v,showCheckBox:E=!0,showExceptionsCheckBox:x=!1,showActionConnectorsCheckBox:j=!1,showModal:S,submitBtnText:O,subtitle:k,successMessage:w,title:T})=>{const[I,C]=Object(n.useState)(null),[M,_]=Object(n.useState)(!1),[A,F]=Object(n.useState)(!1),[P,D]=Object(n.useState)(!1),[N,R]=Object(n.useState)(!1),{addError:L,addSuccess:B}=Object(s.a)(),[z,q]=Object(n.useState)([]),[$,V]=Object(n.useState)(0),U=Object(n.useCallback)((()=>{t(),F(!1),D(!1),R(!1),q([])}),[t,F,D]),H=Object(n.useCallback)((e=>{_(!1),C(null),y(),e&&(y(),U())}),[U,y]),Q=Object(n.useCallback)((async()=>{if(null!=I){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...a}=await v({fileToImport:I[0],overwrite:A,overwriteExceptions:P,overwriteActionConnectors:N,signal:e.signal}),n=a.action_connectors_success_count;q(t),V(n),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:a,successMessage:n,errorMessage:i,errorMessageDetailed:r,addError:s,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(n(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((u=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:u},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(a&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((c=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:c},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var c,u;if(e.errors.length>0){if(a&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:a}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:a,error:n}=e;t=t&&t!==a?`${t},${a}`:a;const{status_code:i,message:r}=n||{};let s;return s=403===i?f:r,{...e,error:{...n,message:s}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return s(b(r,e,t),{title:p(a||t.length)})}s(b(r,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&s(b(r,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:a,exceptionsIncluded:x,actionConnectorsIncluded:j,successMessage:w,errorMessage:m,errorMessageDetailed:g,addError:L,addSuccess:B}),H(!(null!=t&&t.length))}catch(e){U(),L(e,{title:m(1)})}}}),[I,v,A,P,N,x,w,m,g,L,B,j,H,U]),G=Object(n.useCallback)((()=>{U()}),[U]),W=Object(n.useCallback)((()=>{F((e=>!e))}),[]),Z=Object(n.useCallback)((()=>{D((e=>!e))}),[]),K=Object(n.useCallback)((()=>{R((e=>!e))}),[]);return i.a.createElement(i.a.Fragment,null,S&&i.a.createElement(r.EuiModal,{onClose:G,maxWidth:"750px"},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,T)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("h4",null,a)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:k,onChange:e=>{C(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:M}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(h,{actionConnectorsWarnings:z,importedActionConnectorsCount:$}),i.a.createElement(r.EuiSpacer,{size:"s"}),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:A,onChange:W}),x&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:c,checked:P,onChange:Z}),j&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:u,checked:N,onChange:K}))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:G},l),i.a.createElement(r.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:Q,disabled:null==I||M,fill:!0},O))))};v.displayName="ImportDataModalComponent";const E=i.a.memo(v);E.displayName="ImportDataModal"},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return S}));var n=a(17),i=a(2),r=a.n(i),s=a(45),o=a(114),l=a(145),c=a(243),u=a(23),d=a.n(u);const p=({rowIndex:e,colIndex:t,data:a,header:n,eventId:s,linkValues:o,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(i.useState)({});return r.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:n.id,eventId:s,data:a,header:n,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:o,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=r.a.memo(p);var f=a(5);const b=({column:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),g=e=>f.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),h=e=>{var t;const{altKey:a,ctrlKey:n,key:i,metaKey:r,shiftKey:s,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${o.a}`),l=new KeyboardEvent(u,{altKey:a,bubbles:!0,cancelable:!0,ctrlKey:n,key:i,metaKey:r,shiftKey:s});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(l)}},v=({action:e,width:t,actionsColumnWidth:a,ariaRowindex:i,columnId:s,columnValues:o,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,eventId:E,loadingEventIds:x,notesCount:j,onEventDetailsPanelOpened:S,onRowSelected:O,refetch:k,rowIndex:w,hasRowRenderers:T,onRuleChange:I,selectedEventIds:C,showCheckboxes:M,showNotes:_,tabType:A,timelineId:F,toggleShowNotes:P,setEventsLoading:D,setEventsDeleted:N})=>{const R=t||a;return r.a.createElement(c.m,{width:R,"data-test-subj":"event-actions-container",tabIndex:0},r.a.createElement(c.k,{$ariaColumnIndex:m+l.c,key:null!=A?`${E}_${A}`:`${E}`,onKeyDown:h,role:"button",tabIndex:0,width:t},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,b({row:i,column:m+2}))),e&&r.a.createElement(e,{ariaRowindex:i,width:t,checked:Object.keys(C).includes(E),columnId:s,columnValues:o,eventId:E,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,loadingEventIds:x,onEventDetailsPanelOpened:S,onRowSelected:O,refetch:k,rowIndex:w,onRuleChange:I,showCheckboxes:M,showNotes:_,timelineId:F,toggleShowNotes:P,setEventsLoading:D,setEventsDeleted:N}))),T?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,g(i))):null,j?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:i,notesCount:j}))):null))},E=({_id:e,ariaRowindex:t,index:a,header:i,data:o,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:f,tabType:v,timelineId:E})=>{var x;const j=a+l.c;return r.a.createElement(c.k,{$ariaColumnIndex:j,key:null!=v?`${i.id}_${v}`:`${i.id}`,onKeyDown:h,role:"button",tabIndex:0,width:i.initialWidth},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,b({row:t,column:j}))),r.a.createElement(m,{rowIndex:t-1,colIndex:j-1,data:o,header:i,eventId:e,linkValues:Object(s.getOr)([],null!==(x=i.linkField)&&void 0!==x?x:"",u),renderCellValue:f,tabType:v,timelineId:E}))),d?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,g(t))):null,p?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=r.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:a,columnValues:n,data:s,ecsData:o,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:f,onEventDetailsPanelOpened:b,onRowSelected:g,refetch:y,hasRowRenderers:h,onRuleChange:x,renderCellValue:j,selectedEventIds:S,showCheckboxes:O,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:_,setEventsDeleted:A})=>{const F=Object(i.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),P=Object(i.useMemo)((()=>M.length+a.length),[M,a]),D=Object(i.useMemo)((()=>F.map(((a,i)=>a&&r.a.createElement(v,{action:a,width:C[i].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(S).includes(p),columnId:C[i].id||"",columnValues:n,onRowSelected:g,"data-test-subj":"actions",eventId:p,data:s,key:i,index:P+i,rowIndex:e,ecsData:o,loadingEventIds:m,onEventDetailsPanelOpened:b,showCheckboxes:O,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:f,refetch:y,hasRowRenderers:h,onRuleChange:x,selectedEventIds:S,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,setEventsLoading:_,setEventsDeleted:A})))),[C,p,s,o,g,u,d,t,e,n,l,h,P,m,f,b,x,y,S,O,k,w,T,I,F,_,A]),N=Object(i.useMemo)((()=>a.map(((t,a)=>r.a.createElement(E,{_id:p,index:a,header:t,key:null!=w?`${t.id}_${w}`:`${t.id}`,ariaRowindex:e,data:s,ecsData:o,hasRowRenderers:h,notesCount:f,renderCellValue:j,tabType:w,timelineId:T})))),[p,e,a,s,o,h,f,j,w,T]);return r.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},N,D)}));x.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const a=e.find((e=>e.field===t));return null!=a&&null!=a.value?a.value:void 0},S=({data:e,fieldName:t})=>Object(i.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),i=a.n(n),r=a(48),s=a(688),o=a(322),l=a(158),c=a(119),u=a(384),d=a(400);const p=({combinedQueries:e,filters:t,headerChildren:a,onlyField:p,paddingSize:m,query:f,showLegend:b,setAbsoluteRangeDatePickerTarget:g=c.a.global,runtimeMappings:y,hideQueryToggle:h=!1})=>{const v=Object(r.useDispatch)(),{signalIndexName:E}=Object(o.a)(),x=(j=t,Object(n.useMemo)((()=>[...j,...Object(d.e)(!1)]),[j]));var j;const S=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;v(Object(l.setAbsoluteRangeDatePicker)({id:g,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[v,g]);return i.a.createElement(s.a,{combinedQueries:e,filters:x,headerChildren:a,legendPosition:"right",onlyField:p,paddingSize:m,query:f,showLegend:b,showLinkToAlerts:null==p,showStackBy:null==p,showTotalAlertsCount:!0,signalIndexName:E,runtimeMappings:y,title:u.b,titleSize:null==p?"m":"s",updateDateRange:S,hideQueryToggle:h})};p.displayName="SignalsByCategoryComponent";const m=i.a.memo(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(45),i=a(2),r=a.n(i),s=a(48),o=a(113),l=a(112),c=a(118),u=a(17),d=a(59),p=a.n(d),m=a(44),f=a.n(m),b=a(126),g=a(515),y=a(153),h=a(401);const v=f()(u.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.l.template?"140px":"none"));v.displayName="ProviderBadgeStyled";const E=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=f()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),j=f()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),S=({type:e,toggleType:t})=>e!==y.a.template?r.a.createElement(j,{onClick:t},h.d):r.a.createElement(x,null,h.w),O=r.a.memo(S),k={tabIndex:-1},w=r.a.memo((({deleteProvider:e,field:t,isEnabled:a,isExcluded:s,operator:l,providerId:c,togglePopover:u,toggleType:d,displayValue:m,val:f,type:E,timelineType:x})=>{const j=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),S=Object(i.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!a,"globalFilterItem-isExcluded":s})),[a,s]),w=Object(i.useMemo)((()=>Object(n.isString)(f)&&""===f?Object(b.b)():f),[f]),T=Object(i.useMemo)((()=>s?r.a.createElement("span",null,h.q," "):null),[s]),I=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,T,l!==y.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:w}"`):r.a.createElement("span",{className:"field-value"},t," ",h.j))),[m,t,w,l,T]),C=Object(i.useMemo)((()=>h.v({field:t,value:`${w}`})),[t,w]);return r.a.createElement(g.a,{id:`${c}-${t}-${f}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{className:S,color:"hollow",title:"",iconOnClick:j,iconOnClickAriaLabel:h.t,iconType:"cross",iconSide:"right",onClick:u,onClickAriaLabel:C,closeButtonProps:k,"data-test-subj":"providerBadge",$timelineType:x},I),x===o.l.template&&l!==y.c&&r.a.createElement(O,{toggleType:d,type:E})))}));w.displayName="ProviderBadge";var T=a(0),I=a.n(T),C=a(748);const M="edit-data-provider",_="exclude-data-provider",A="enable-data-provider",F="filter-for-field-present-data-provider",P="delete-data-provider",D=f()(u.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);D.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),I()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:a,id:n,operator:i,providerId:r,value:s,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:a,id:n,operator:i,providerId:r,value:s,type:o}),this.props.closePopover()})),I()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:a,providerId:n,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${a}`,operator:y.b,providerId:n,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:a,closePopover:n,deleteProvider:i,field:s,isEnabled:l,isExcluded:c,isLoading:d,isOpen:p,operator:m,providerId:f,timelineId:b,timelineType:g,toggleEnabledProvider:v,toggleExcludedProvider:E,toggleTypeProvider:x,value:j,type:S}=this.props,O=(({andProviderId:e,browserFields:t,deleteItem:a,field:n,isEnabled:i,isExcluded:s,isLoading:l,operator:c,onDataProviderEdited:u,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:f,toggleEnabled:b,toggleExcluded:g,toggleType:v,type:E,value:x})=>[{id:0,items:[{className:M,disabled:l,icon:"pencil",name:h.g,panel:1},{className:_,disabled:l,icon:s?"plusInCircle":"minusInCircle",name:s?h.p:h.i,onClick:g},{className:A,disabled:l,icon:i?"eyeClosed":"eye",name:i?h.x:h.u,onClick:b},{className:F,disabled:l,icon:"logstashFilter",name:h.k,onClick:d},f===o.l.template?{className:"convert-to-field-data-provider",disabled:l||c===y.c,icon:"visText",name:E===y.a.template?h.c:h.d,onClick:v}:{name:null},{className:P,disabled:l,icon:"trash",name:h.e,onClick:a}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=u?r.a.createElement(C.a,{andProviderId:e,browserFields:t,field:n,isExcluded:s,onDataProviderEdited:u,operator:c,providerId:p,timelineId:m,value:x,type:E}):null,id:1,title:h.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:s,isEnabled:l,isExcluded:c,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:f,timelineId:b,timelineType:g,toggleEnabled:v,toggleExcluded:E,toggleType:x,value:j,type:S});return r.a.createElement(D,{id:`popoverFor_${f}-${s}-${j}`,isOpen:p,closePopover:n,button:a,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(u.EuiContextMenu,{initialPanelId:0,panels:O,"data-test-subj":"providerActions"})))}}var N=a(195),R=a(134);const L=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:f,onDataProviderEdited:b,operator:g,providerId:h,register:v,setIsPopoverOpen:E,timelineId:x,toggleEnabledProvider:j,toggleExcludedProvider:S,toggleTypeProvider:O,displayValue:k,val:T,type:I=y.a.default,wrapperRef:C})=>{const M=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),_=Object(l.b)((e=>{var t,a;return x&&null!==(t=null===(a=M(e,x))||void 0===a?void 0:a.timelineType)&&void 0!==t?t:o.l.default})),{isLoading:A}=Object(l.a)((e=>{var t;return null!==(t=M(e,null!=x?x:""))&&void 0!==t?t:R.b})),F=Object(i.useCallback)((()=>{E(!f)}),[f,E]),P=Object(i.useCallback)((()=>{var e;E(!1),null==C||null===(e=C.current)||void 0===e||e.focus()}),[C,E]),D=Object(i.useCallback)((()=>{j(),P()}),[P,j]),L=Object(i.useCallback)((()=>{S(),P()}),[S,P]),B=Object(i.useCallback)((()=>{O(),P()}),[O,P]),[z,q]=Object(i.useState)(!1),$=Object(s.useDispatch)();Object(i.useEffect)((()=>{null!=v&&($(N.a.registerProvider({provider:{...v,and:[]}})),q(!0))}),[z,$,v,q]);const V=Object(i.useCallback)((()=>{z&&null!=v&&$(N.a.unRegisterProvider({id:v.id}))}),[z,$,v]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(w,{deleteProvider:A?n.noop:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:h,togglePopover:F,toggleType:B,displayValue:null!=k?k:String(T),val:T,operator:g,type:I,timelineType:_})),[a,k,u,p,m,A,d,B,g,h,_,F,I,T]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:P,deleteProvider:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:A,isOpen:f,onDataProviderEdited:b,operator:g,providerId:h,timelineId:x,timelineType:_,toggleEnabledProvider:D,toggleExcludedProvider:L,toggleTypeProvider:B,value:T,type:I})}));L.displayName="ProviderItemBadge"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(17),i=a(2),r=a.n(i);const s=a(5).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),o=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:a,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(n.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,s),"Â ",r.a.createElement(n.EuiBadge,{color:"hollow"},a))),l=r.a.memo(o);l.displayName="TooltipWithKeyboardShortcut"},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return b}));var n=a(85),i=(a(9),a(124)),r=a(5);const s=r.i18n.translate("xpack.securitySolution.selector.groups.ruleName.label",{defaultMessage:"Rule name"}),o=r.i18n.translate("xpack.securitySolution.selector.grouping.userName.label",{defaultMessage:"User name"}),l=r.i18n.translate("xpack.securitySolution.selector.grouping.hostName.label",{defaultMessage:"Host name"}),c=r.i18n.translate("xpack.securitySolution.selector.grouping.sourceIP.label",{defaultMessage:"Source IP"}),u=r.i18n.translate("xpack.securitySolution.selector.groups.sourceAddress.label",{defaultMessage:"Source address"}),d=r.i18n.translate("xpack.securitySolution.selector.groups.destinationAddress.label",{defaultMessage:"Destination address"}),p=e=>0===e.length?{}:{query:{bool:{filter:{ids:{values:e}}}},size:1e4},m=(e,t)=>{const a=e.split(".");return 1===a.length?{[a[0]]:t}:{[a[0]]:m(a.slice(1).join("."),t)}},f=e=>{return t=e,Array.isArray(t)?t:Object.entries(t).reduce(((e,[t,a])=>Object(n.merge)(e,m(t,a))),{});var t},b=e=>e===i.e.alertsOnAlertsPage||e===i.e.alertsRiskInputs?[{label:s,key:"kibana.alert.rule.name"},{label:o,key:"user.name"},{label:l,key:"host.name"},{label:c,key:"source.ip"}]:e===i.e.alertsOnRuleDetailsPage?[{label:u,key:"source.address"},{label:o,key:"user.name"},{label:l,key:"host.name"},{label:d,key:"destination.address,"}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return b}));var n=a(17),i=a(2),r=a.n(i),s=a(132);const o=r.a.memo((({onClick:e})=>r.a.createElement(n.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},s.G)));o.displayName="OpenTimelineModalButton";var l=a(467),c=a(244),u=a(327),d=a(466);const p="add-timeline-button",m=["createFrom"],f=({timelineId:e})=>{const[t,a]=Object(i.useState)(!1),[s,f]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>a(!t)),[t]),g=Object(i.useCallback)((()=>a(!1)),[]),y=Object(i.useCallback)((()=>f(!1)),[]),h=Object(i.useCallback)((()=>{g(),f(!0)}),[g]),v=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{className:p,"data-test-subj":"timeline-create-open-control",iconType:"plusInCircle",iconSize:"m",color:"primary",onClick:b,"aria-label":c.a})),[b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiPopover,{anchorPosition:"downRight",button:v,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:g,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(u.c,{timelineId:e,title:c.h,onClick:g})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(d.a,{onClick:g,timelineId:e,title:c.g})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(o,{onClick:h}))))),s?r.a.createElement(l.a,{onClose:y,hideActions:m}):null)},b=r.a.memo(f)},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),i=a.n(n),r=a(136),s=a.n(r),o=a(19),l=a(79),c=a(15),u=a(110);const d=e=>"esql"in e?{query:e.esql,language:"esql"}:"sql"in e?{query:e.sql,language:"sql"}:e,p=Object(n.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:r,isLoading:p=!1,isRefreshPaused:m,filterQuery:f,filterManager:b,filters:g,onChangedQuery:y,onSubmitQuery:h,refreshInterval:v,savedQuery:E,onSavedQuery:x,dataTestSubj:j,displayStyle:S,isDisabled:O})=>{const{data:k}=Object(u.i)().services,[w,T]=Object(n.useState)(),[I,C]=Object(n.useState)(g),M=Object(n.useCallback)((e=>{if(null!=e.query&&!s()(e.query,f)){const t=d(e.query);h(t)}}),[f,h]),_=Object(n.useCallback)((e=>{if(y&&null!=e.query&&!s()(e.query,f)){const t=d(e.query);y(t)}}),[f,y]),A=Object(n.useCallback)((e=>{const{query:t,filters:a,timefilter:n}=e.attributes;h(t,n),b.setFilters(a||[]),x(e)}),[b,h,x]),F=Object(n.useCallback)((()=>{null!=E&&(h({query:"",language:E.attributes.query.language}),b.setFilters([]),x(void 0))}),[b,h,x,E]),P=Object(n.useCallback)((e=>{b.setFilters(e)}),[b]),D="esql"===(null==f?void 0:f.language),N=Object(n.useMemo)((()=>D&&"string"==typeof f.query?{esql:f.query}:f),[f,D]);Object(n.useEffect)((()=>{let e;var t;return null!=(t=r)&&"object"==typeof t&&Object.hasOwn(t,"getName")?T(r):D||(async()=>{e=await k.dataViews.create({id:r.title,title:r.title}),T(e);const t=[...g];t.forEach((e=>e.meta.index=r.title)),C(t)})(),()=>{var t,a;null!==(t=e)&&void 0!==t&&t.id&&k.dataViews.clearInstanceCache(null===(a=e)||void 0===a?void 0:a.id)}}),[k.dataViews,g,r,D]);const R=Object(n.useMemo)((()=>new o.TimeHistory(new c.Storage(localStorage))),[]),L=Object(n.useMemo)((()=>null!=w?[w]:[]),[w]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:I,indexPatterns:L,isLoading:p,isRefreshPaused:m,query:N,onClearSavedQuery:F,onFiltersUpdated:P,onQueryChange:_,onQuerySubmit:M,onSaved:x,onSavedQueryUpdated:A,refreshInterval:v,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:R,dataTestSubj:j,savedQuery:E,displayStyle:S,isDisabled:O})}));p.displayName="QueryBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(2),i=a.n(n),r=a(48),s=a(54),o=a(127),l=a(119),c=a(147),u=a(110),d=a(172),p=a(128),m=a(134),f=a(118),b=a(318),g=a(17),y=a(44),h=a.n(y),v=a(723),E=a(752),x=a(121),j=a(521);const S=h.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-149y4ld-0"})(["min-width:600px;"]),O=h()(g.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-149y4ld-1"})(["position:absolute;right:4px;top:4px;"]),k=h()(g.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-149y4ld-2"})(["width:170px;"]),w=h.a.div.withConfig({displayName:"TopNContent",componentId:"sc-149y4ld-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),T=({combinedQueries:e,defaultView:t,deleteQuery:a,filters:r,field:s,from:o,indexPattern:l,options:c,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:f,scopeId:g,to:y,toggleTopN:h})=>{const[T,I]=Object(n.useState)(t),C=Object(n.useCallback)((e=>I(e)),[I]),M=Object(b.b)({scopeId:g,view:T}),{selectedPatterns:_,runtimeMappings:A}=Object(x.d)(M);Object(n.useEffect)((()=>{I(t)}),[t]);const F=Object(n.useMemo)((()=>i.a.createElement(k,{"data-test-subj":"view-select",disabled:1===c.length,onChange:C,options:c,valueOfSelected:T})),[C,c,T]),P=Object(n.useMemo)((()=>Object(b.d)({filters:r,tableId:g,view:T})),[r,g,T]);return i.a.createElement(S,{"data-test-subj":"topN-container"},i.a.createElement(w,null,"raw"===T||"all"===T?i.a.createElement(v.a,{combinedQueries:e,deleteQuery:a,filters:P,from:o,headerChildren:F,indexPattern:l,indexNames:_,runtimeMappings:A,onlyField:s,paddingSize:u,query:d,queryType:"topN",showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:f,showSpacer:!1,toggleTopN:h,scopeId:g,sourcererScopeId:M,to:y,hideQueryToggle:!0}):i.a.createElement(E.a,{combinedQueries:e,filters:P,headerChildren:F,onlyField:s,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,runtimeMappings:A,hideQueryToggle:!0})),i.a.createElement(O,{"aria-label":j.c,"data-test-subj":"close",iconType:"cross",onClick:h}))};T.displayName="TopNComponent";const I=i.a.memo(T);var C=a(122);const M=[],_={query:"",language:"kuery"},A=Object(r.connect)((()=>{const e=p.d.globalQuerySelector(),t=p.d.globalFiltersQuerySelector(),a=f.b.getTimelineByIdSelector(),n=p.d.getTimelineSelector(),i=f.b.getKqlFilterQuerySelector();return(r,s)=>{var o,l;const c=null!==(o=a(r,C.c.active))&&void 0!==o?o:m.b,u=null!==(l=c.filters)&&void 0!==l?l:M,d=n(r),{globalFilters:p}=s;return{activeTimelineEventType:c.eventType,activeTimelineFilters:c.activeTab===C.d.query?u:M,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:c.activeTab===C.d.query?i(r,C.c.active):null,activeTimelineTo:d.timerange.to,dataProviders:c.activeTab===C.d.query?c.dataProviders:[],globalQuery:e(r),globalFilters:null!=p?p:t(r),kqlMode:c.kqlMode}}})),F=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:a,activeTimelineKqlQueryExpression:r,activeTimelineTo:p,browserFields:m,dataProviders:f,field:g,indexPattern:y,globalFilters:h=M,globalQuery:v=_,kqlMode:E,onFilterAdded:x,paddingSize:j,showLegend:S,scopeId:O,toggleTopN:k})=>{const{uiSettings:w}=Object(u.i)().services,{from:T,deleteQuery:C,setQuery:A,to:F}=Object(c.a)(),P=Object(b.a)(Object(o.isActiveTimeline)(null!=O?O:"")?e:void 0),D=Object(n.useMemo)((()=>{var e;return Object(o.isActiveTimeline)(null!=O?O:"")?null===(e=Object(d.d)({browserFields:m,config:Object(s.getEsQueryConfig)(w),dataProviders:f,filters:t,indexPattern:y,kqlMode:E,kqlQuery:{language:"kuery",query:null!=r?r:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[O,m,w,f,t,y,E,r]),N=Object(n.useMemo)((()=>Object(b.c)(O)?"alert":P[0].value),[P,O]);return i.a.createElement(I,{combinedQueries:D,"data-test-subj":"top-n",defaultView:N,deleteQuery:Object(o.isActiveTimeline)(null!=O?O:"")?void 0:C,field:g,filters:Object(o.isActiveTimeline)(null!=O?O:"")?M:h,from:Object(o.isActiveTimeline)(null!=O?O:"")?a:T,indexPattern:y,options:P,paddingSize:j,query:Object(o.isActiveTimeline)(null!=O?O:"")?_:v,showLegend:S,setAbsoluteRangeDatePickerTarget:Object(o.isActiveTimeline)(null!=O?O:"")?l.a.timeline:l.a.global,setQuery:A,scopeId:O,to:Object(o.isActiveTimeline)(null!=O?O:"")?p:F,toggleTopN:k,onFilterAdded:x})};F.displayName="StatefulTopNComponent";const P=A(i.a.memo(F))},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(136),i=a.n(n),r=a(45),s=a(2),o=a(3),l=a(54),c=a(209),u=a(110),d=a(294),p=a(127),m=a(5);m.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"});const f=m.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var b=a(117),g=a(336),y=a(4);const h=[],v=({endDate:e,errorMessage:t,filterQuery:a,histogramType:n,indexNames:m,isPtrIncluded:v,onError:E,stackByField:x,runtimeMappings:j,startDate:S,threshold:O,skip:k=!1,includeMissingData:w=!0})=>{const{data:T}=Object(u.i)().services,I=Object(s.useRef)(r.noop),C=Object(s.useRef)(new AbortController),M=Object(s.useRef)(new o.Subscription),[_,A]=Object(s.useState)(!1),{startTracking:F}=Object(g.a)(),[P,D]=Object(s.useState)({defaultIndex:m,factoryQueryType:d.h,filterQuery:Object(c.a)(a),histogramType:n,timerange:{interval:"12h",from:S,to:e},stackByField:x,runtimeMappings:j,threshold:O,...null!=v?{isPtrIncluded:v}:{},...null!=w?{includeMissingData:w}:{}}),{addError:N}=Object(b.a)(),[R,L]=Object(s.useState)({data:[],inspect:{dsl:[],response:[]},refetch:I.current,totalCount:-1,buckets:[]}),B=Object(s.useCallback)((e=>{const a=async()=>{C.current=new AbortController,A(!0);const{endTracking:a}=F({name:`${y.l} matrixHistogram ${n}`});M.current=T.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:C.current.signal}).subscribe({next:e=>{if(!Object(l.isRunningResponse)(e)){const t=Object(r.getOr)(h,d.j[n],e.rawResponse);A(!1),L((a=>({...a,data:e.matrixHistogramData,inspect:Object(p.getInspectResponse)(e,a.inspect),refetch:I.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),a("success"),M.current.unsubscribe()}},error:e=>{A(!1),N(e,{title:null!=t?t:f}),a("error"),M.current.unsubscribe()}})};M.current.unsubscribe(),C.current.abort(),a(),I.current=a}),[T.search,n,N,t,F]);return Object(s.useEffect)((()=>{D((t=>{const r={...t,defaultIndex:m,filterQuery:Object(c.a)(a),histogramType:n,timerange:{interval:"12h",from:S,to:e},stackByField:x,threshold:O,...null!=v?{isPtrIncluded:v}:{}};return i()(t,r)?t:r}))}),[m,e,a,S,x,n,O,v]),Object(s.useEffect)((()=>(k||B(P),()=>{M.current.unsubscribe(),C.current.abort()})),[P,B,k]),Object(s.useEffect)((()=>{k&&(A(!1),M.current.unsubscribe(),C.current.abort())}),[k]),[_,R,Object(s.useCallback)(((e,t)=>{B({...P,timerange:{interval:"12h",from:t,to:e}})}),[P,B])]},E=e=>{const[t,a]=v({...e,includeMissingData:!0}),n=Object(s.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,r]=v({...e,includeMissingData:!1,skip:n||void 0===e.filterQuery||e.skip}),o=Object(s.useMemo)((()=>t||i),[t,i]),l=Object(s.useMemo)((()=>{if(n)return a;const{data:e,inspect:t,totalCount:i,refetch:s,buckets:l}=a,{data:c,inspect:u,totalCount:d,refetch:p}=r,m=()=>{s(),p()};return o?{data:[],inspect:{dsl:[],response:[]},refetch:m,totalCount:-1,buckets:[]}:{data:[...e,...c],inspect:{dsl:[...t.dsl,...u.dsl],response:[...t.response,...u.response]},totalCount:i+d,refetch:m,buckets:l}}),[o,a,r,n]);return[o,l]}},function(e,t,a){"use strict";a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"i",(function(){return g})),a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return S}));var n=a(49),i=a(57),r=a(33),s=a(736),o=a(178),l=a(966),c=a(884);const u=e=>e.policyItem,d=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const a=((e,t)=>{if(Object(r.b)(t,"enterprise"))return Object(s.d)(e);if(Object(r.b)(t,"platinum")){const t=Object(s.d)(e);return Object(s.e)(t)}return Object(s.f)(e)})(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:a}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,f=e=>Object(c.e)(e)||Object(c.f)(e)||Object(c.d)(e)||Object(c.c)(e)||Object(c.b)(e)||Object(c.g)(e),b=e=>e.license,g=Object(i.createSelector)((e=>e.location),(e=>{var t,a,i,r;return null!==(t=null===(a=Object(n.matchPath)(null!==(r=null==e?void 0:e.pathname)&&void 0!==r?r:"",{path:[o.n,o.r,o.m,o.o,o.l,o.q],exact:!0}))||void 0===a||null===(i=a.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),y=Object(s.c)(),h=Object(i.createSelector)(d,(e=>{var t,a,n,i;return null!==(t=null==e||null===(a=e.inputs[0])||void 0===a||null===(n=a.config)||void 0===n||null===(i=n.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:y})),v=Object(i.createSelector)(h,(e=>null==e?void 0:e.windows)),E=Object(i.createSelector)(h,(e=>null==e?void 0:e.mac)),x=Object(i.createSelector)(h,(e=>null==e?void 0:e.linux)),j=(Object(i.createSelector)(v,E,x,((e,t,a)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:a.advanced,events:a.events,malware:a.malware,behavior_protection:a.behavior_protection,memory_protection:a.memory_protection,popup:a.popup}}))),e=>e.apiError),S=e=>e.agentStatusSummary},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/groups")("UPDATE_GROUPS")},function(e,t,a){"use strict";a.d(t,"h",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return g})),a.d(t,"e",(function(){return y})),a.d(t,"a",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"I",(function(){return E})),a.d(t,"w",(function(){return x})),a.d(t,"H",(function(){return j})),a.d(t,"d",(function(){return O})),a.d(t,"g",(function(){return k})),a.d(t,"z",(function(){return w})),a.d(t,"J",(function(){return T})),a.d(t,"x",(function(){return I})),a.d(t,"F",(function(){return C})),a.d(t,"G",(function(){return M})),a.d(t,"B",(function(){return F})),a.d(t,"C",(function(){return N})),a.d(t,"D",(function(){return B})),a.d(t,"E",(function(){return $})),a.d(t,"y",(function(){return V})),a.d(t,"A",(function(){return U})),a.d(t,"k",(function(){return G})),a.d(t,"p",(function(){return W})),a.d(t,"s",(function(){return Z})),a.d(t,"r",(function(){return K})),a.d(t,"q",(function(){return J})),a.d(t,"v",(function(){return Y})),a.d(t,"n",(function(){return X})),a.d(t,"j",(function(){return ee})),a.d(t,"K",(function(){return te})),a.d(t,"t",(function(){return ae})),a.d(t,"u",(function(){return ne})),a.d(t,"o",(function(){return ie})),a.d(t,"l",(function(){return re})),a.d(t,"m",(function(){return se})),a.d(t,"f",(function(){return oe}));var n=a(45),i=a(51),r=a(153),s=a(122),o=a(113),l=a(335),c=a(134),u=a(281),d=a(204),p=a(282),m=a(424);const f=e=>null!==e,b=({id:e,noteId:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,noteIds:[...n.noteIds,t]}}},g=({id:e,noteId:t,eventId:a,timelineById:i})=>{const r=i[e],s=Object(n.getOr)([],`eventIdToNoteIds.${a}`,r);return{...i,[e]:{...r,eventIdToNoteIds:{...r.eventIdToNoteIds,[a]:Object(n.uniq)([...s,t])}}}},y=({id:e,resolveTimelineConfig:t,timeline:a,timelineById:n})=>{var i;return((e,t,a)=>e===s.c.active&&t.savedObjectId!==a.savedObjectId)(e,n[e],a)&&(p.a.setActivePage(0),p.a.setExpandedDetail({})),{...n,[e]:{...a,filterManager:n[e].filterManager,isLoading:n[e].isLoading,initialized:null!==(i=a.initialized)&&void 0!==i?i:n[e].initialized,resolveTimelineConfig:t,dateRange:a.status===o.k.immutable&&a.timelineType===o.l.template?{start:u.a.toISOString(),end:u.b.toISOString()}:a.dateRange}}},h=({id:e,timelineById:t,timelineType:a,dateRange:n,...r})=>{const s=t[e],{from:u,to:d}=Object(l.a)({from:"",to:""}),p=null!=n?n:{start:u,end:d},m=a===o.l.template?{templateTimelineId:Object(i.v4)(),templateTimelineVersion:1}:{};return{...t,[e]:{id:e,...s||{},...c.b,...r,dateRange:p,savedObjectId:null,version:null,isSaving:!1,isLoading:!1,timelineType:a,...m}}},v=({id:e,eventId:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,pinnedEventIds:{...n.pinnedEventIds,[t]:!0}}}},E=({id:e,show:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,show:t}}},x=({id:e,graphEventId:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,graphEventId:t,...""===t&&e===s.c.active?{activeTab:n.prevActiveTab,prevActiveTab:n.activeTab}:{}}}},j=({id:e,sessionViewConfig:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,sessionViewConfig:t}}},S=(e,t)=>e.field===t.field&&e.value===t.value&&e.operator===t.operator,O=({id:e,providers:t,timelineById:a})=>{const i=a[e];return""!==i.highlightedDropAndProviderId?((e,t,a,i)=>{if(0===t.length)return i;let r=Object(n.cloneDeep)(a.dataProviders);return t.forEach((e=>{const t=r.findIndex((e=>e.id===a.highlightedDropAndProviderId)),s=r[t],o=s.and.findIndex((t=>t.id===e.id)),{and:l,...c}=e;if(Object(n.isEqualWith)(S,s.queryMatch,c.queryMatch)||-1===o&&s.and.filter((e=>Object(n.isEqualWith)(S,e.queryMatch,c.queryMatch))).length>0)return i;r=[...r.slice(0,t),{...r[t],and:o>-1?[...s.and.slice(0,o),c,...s.and.slice(o+1)]:[...s.and,c]},...r.slice(t+1)]})),{...i,[e]:{...a,dataProviders:r}}})(e,t,i,a):((e,t,a,i)=>{if(0===t.length)return i;let r=Object(n.cloneDeep)(a.dataProviders);return t.forEach((e=>{const t=r.findIndex((t=>t.id===e.id));t>-1&&!Object(n.isEmpty)(r[t].and)&&(e.id=`${e.id}-${r.filter((t=>t.id===e.id)).length}`),r=t>-1&&Object(n.isEmpty)(r[t].and)?[...r.slice(0,t),e,...r.slice(t+1)]:[...r,e]})),{...i,[e]:{...a,dataProviders:r}}})(e,t,i,a)},k=({id:e,filterQuery:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,kqlQuery:{...n.kqlQuery,filterQuery:t}}}},w=({id:e,kqlMode:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,kqlMode:t}}},T=({description:e,id:t,title:a,timelineById:n})=>{const i=n[t];return{...n,[t]:{...i,description:e.trim(),title:a.trim()}}},I=({id:e,isFavorite:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,isFavorite:t}}},C=({id:e,providers:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,dataProviders:t}}},M=({id:e,start:t,end:a,timelineById:n})=>{const i=n[e];return{...n,[e]:{...i,dateRange:{start:t,end:a}}}},_=(e,t,a,n)=>n.dataProviders.map((n=>n.id===a?{...n,and:n.and.map((a=>a.id===e?{...a,enabled:t}:a))}:n)),A=(e,t,a)=>a.dataProviders.map((a=>a.id===t?{...a,enabled:e}:a)),F=({id:e,providerId:t,enabled:a,timelineById:n,andProviderId:i})=>{const r=n[e];return{...n,[e]:{...r,dataProviders:i?_(i,a,t,r):A(a,t,r)}}},P=(e,t,a,n)=>n.dataProviders.map((n=>n.id===a?{...n,and:n.and.map((a=>a.id===e?{...a,excluded:t}:a))}:n)),D=(e,t,a)=>a.dataProviders.map((a=>a.id===t?{...a,excluded:e}:a)),N=({id:e,providerId:t,excluded:a,timelineById:n,andProviderId:i})=>{const r=n[e];return{...n,[e]:{...r,dataProviders:i?P(i,a,t,r):D(a,t,r)}}},R=({excluded:e,field:t,operator:a,providerId:n,timeline:i,value:r})=>i.dataProviders.map((i=>i.id===n?{...i,excluded:e,queryMatch:{...i.queryMatch,field:t,displayField:t,value:r,displayValue:Object(m.d)(r),operator:a}}:i)),L=({andProviderId:e,excluded:t,field:a,operator:n,providerId:i,timeline:r,value:s})=>r.dataProviders.map((r=>r.id===i?{...r,and:r.and.map((i=>i.id===e?{...i,excluded:t,queryMatch:{...i.queryMatch,field:a,displayField:a,value:s,displayValue:Object(m.d)(s),operator:n}}:i))}:r)),B=({andProviderId:e,excluded:t,field:a,id:n,operator:i,providerId:r,timelineById:s,value:o})=>{const l=s[n];return{...s,[n]:{...l,dataProviders:e?L({andProviderId:e,excluded:t,field:a,operator:i,providerId:r,timeline:l,value:o}):R({excluded:t,field:a,operator:i,providerId:r,timeline:l,value:o})}}},z=(e,t,a,n)=>n.dataProviders.map((n=>n.id===a?{...n,and:n.and.map((a=>a.id===e?{...a,type:t,name:t===r.a.template?`${a.queryMatch.field}`:"",queryMatch:{...a.queryMatch,displayField:void 0,displayValue:void 0,value:t===r.a.template?`{${a.queryMatch.field}}`:"",operator:t===r.a.template?r.d:r.b}}:a))}:n)),q=(e,t,a)=>a.dataProviders.map((a=>a.id===t?{...a,type:e,name:e===r.a.template?`${a.queryMatch.field}`:"",queryMatch:{...a.queryMatch,displayField:void 0,displayValue:void 0,value:e===r.a.template?`{${a.queryMatch.field}}`:"",operator:e===r.a.template?r.d:r.b}}:a)),$=({andProviderId:e,id:t,providerId:a,type:n,timelineById:i})=>{const s=i[t];return s.timelineType!==o.l.template&&n===r.a.template?i:{...i,[t]:{...s,dataProviders:e?z(e,n,a,s):q(n,a,s)}}},V=({id:e,itemsPerPage:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,itemsPerPage:t}}},U=({id:e,itemsPerPageOptions:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,itemsPerPageOptions:t}}},H=(e,t,a)=>{var n,i,r,s;const o=a.dataProviders.findIndex((e=>e.id===t)),l=null===(n=a.dataProviders[o])||void 0===n?void 0:n.and.findIndex((t=>t.id===e));return[...a.dataProviders.slice(0,o),{...a.dataProviders[o],and:null!==(i=a.dataProviders[o])&&void 0!==i&&i.and?[...null===(r=a.dataProviders[o])||void 0===r?void 0:r.and.slice(0,l),...null===(s=a.dataProviders[o])||void 0===s?void 0:s.and.slice(l+1)]:[]},...a.dataProviders.slice(o+1)]},Q=(e,t)=>{var a;const n=t.dataProviders.findIndex((t=>t.id===e));return[...t.dataProviders.slice(0,n),...null!==(a=t.dataProviders[n])&&void 0!==a&&a.and.length?[{...t.dataProviders[n].and.slice(0,1)[0],and:[...t.dataProviders[n].and.slice(1)]}]:[],...t.dataProviders.slice(n+1)]},G=({id:e,providerId:t,timelineById:a,andProviderId:n})=>{const i=a[e];return{...a,[e]:{...i,dataProviders:n?H(n,t,i):Q(t,i)}}},W=({id:e,eventId:t,timelineById:a})=>{const i=a[e];return{...a,[e]:{...i,pinnedEventIds:Object(n.omit)(t,i.pinnedEventIds)}}},Z=({id:e,savedQueryId:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,savedQueryId:t}}},K=({id:e,filters:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,filters:t}}},J=({id:e,excludedRowRendererIds:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,excludedRowRendererIds:t}}},Y=e=>{var t;const{tabType:a,id:n,...i}=e,r=new Set(["eventDetail","hostDetail","networkDetail","userDetail"]),s=null!=a?a:"query",o={params:i.params?{...i.params}:{},panelView:i.panelView};return{[s]:r.has(null!==(t=i.panelView)&&void 0!==t?t:"")?o:{}}},X=({id:e,eventIds:t,isLoading:a,timelineById:i})=>{const r=i[e],s=a?Object(n.union)(r.loadingEventIds,t):r.loadingEventIds.filter((e=>!t.includes(e)));return{...i,[e]:{...r,loadingEventIds:s}}},ee=({id:e,columnId:t,timelineById:a})=>{const n=a[e],i=n.columns.filter((e=>e.id!==t));return{...a,[e]:{...n,columns:i}}},te=({column:e,id:t,index:a,timelineById:n})=>{const i=n[t];if(-1!==i.columns.findIndex((t=>t.id===e.id))){const r=i.columns.filter((t=>t.id!==e.id));return r.splice(a,0,e),{...n,[t]:{...i,columns:r}}}const r=[...i.columns];return r.splice(a,0,e),{...n,[t]:{...i,columns:r}}},ae=({id:e,columns:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,columns:t}}},ne=({id:e,sort:t,timelineById:a})=>{const n=a[e];return{...a,[e]:{...n,sort:t}}},ie=({id:e,eventIds:t,isSelectAllChecked:a=!1,isSelected:i,timelineById:r})=>{const s=r[e],o=i?{...s.selectedEventIds,...t}:Object(n.omit)(Object.keys(t),s.selectedEventIds);return{...r,[e]:{...s,selectedEventIds:o,isSelectAllChecked:a}}},re=({id:e,eventIds:t,isDeleted:a,timelineById:i})=>{const r=i[e],s=a?Object(n.union)(r.deletedEventIds,t):r.deletedEventIds.filter((e=>!t.includes(e))),o=Object.fromEntries(Object.entries(r.selectedEventIds).filter((([e])=>!s.includes(e)))),l=Object.keys(o).length>0&&r.isSelectAllChecked;return{...i,[e]:{...r,deletedEventIds:s,selectedEventIds:o,isSelectAllChecked:l}}},se=({id:e,timelineById:t,timelineSettingsProps:a})=>{var i;const r=t[e];return null!=r&&r.initialized?{...t,[e]:{...r,...a}}:{...t,[e]:{...c.b,...Object(c.a)(e),...r,...a,...!r||Object(n.isEmpty)(r.columns)&&!Object(n.isEmpty)(a.defaultColumns)?{columns:a.defaultColumns}:{},sort:null!==(i=a.sort)&&void 0!==i?i:c.b.sort,loadingEventIds:c.b.loadingEventIds,initialized:!0}}},oe=({id:e,columnId:t,delta:a,timelineById:n})=>{var i;const r=n[e],s=r.columns.findIndex((e=>e.id===t));if(-1===s)return{...n,[e]:{...r}};const o=(null!==(i=r.columns[s].initialWidth)&&void 0!==i?i:d.a)+a,l=Math.max(d.c,o),c={...r.columns[s],initialWidth:l},u=[...r.columns.slice(0,s),c,...r.columns.slice(s+1)];return{...n,[e]:{...r,columns:u}}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(5);const i=e=>n.i18n.translate("xpack.securitySolution.configurations.suppressedAlerts",{defaultMessage:"Alert has {numAlertsSuppressed} suppressed alerts",values:{numAlertsSuppressed:e}}),r=180,s=190},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){var a=n.createContext(void 0);return[function(){var e=n.useContext(a);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var r=i.children,s=i.initialState;return function(e,t){return n.createElement(a.Provider,e,t)}({value:n.useReducer(e,void 0!==s?s:t)},r)},a]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(254));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a,n=(a=e,function(e,t){return a.reduceRight((function(t,a){return a(e)(t)}),t)});return function(e,t,a){void 0===a&&(a=function(e){return e});var s=i.useRef(a(t)),o=i.useState(s.current)[1],l=i.useCallback((function(t){return s.current=e(s.current,t),o(s.current),t}),[e]),c=i.useRef(n({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l));return r.default((function(){c.current=n({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l)}),[l]),[s.current,c.current]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){var t=n.createContext(void 0);return[function(){var e=n.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(a){var i=a.children,r=a.initialValue;return function(e,a){return n.createElement(t.Provider,e,a)}({value:n.useState(void 0!==r?r:e)},i)},t]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(407));t.default=function(e,t){void 0===t&&(t=[]);var a=i.useState(0),s=a[0],o=a[1],l=r.default(e,n.__spreadArrays(t,[s])),c=l.loading,u=i.useCallback((function(){c||o((function(e){return e+1}))}),n.__spreadArrays(t,[c]));return n.__assign(n.__assign({},l),{retry:u})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(499)).default("audio");t.default=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],a=0;a<e.length;a++)t.push({start:e.start(a),end:e.end(a)});return t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r="object"==typeof navigator?navigator:void 0,s=r&&"function"==typeof r.getBattery;t.default=s?function(){var e=n.useState({isSupported:!0,fetched:!1}),t=e[0],a=e[1];return n.useEffect((function(){var e=!0,n=null,s=function(){if(e&&n){var r={isSupported:!0,fetched:!0,level:n.level,charging:n.charging,dischargingTime:n.dischargingTime,chargingTime:n.chargingTime};!i.isDeepEqual(t,r)&&a(r)}};return r.getBattery().then((function(t){e&&(n=t,i.on(n,"chargingchange",s),i.on(n,"chargingtimechange",s),i.on(n,"dischargingtimechange",s),i.on(n,"levelchange",s),s())})),function(){e=!1,n&&(i.off(n,"chargingchange",s),i.off(n,"chargingtimechange",s),i.off(n,"dischargingtimechange",s),i.off(n,"levelchange",s))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,i,r;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(i=n;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,r[i]))return!1;for(i=n;0!=i--;){var s=r[i];if(!("_owner"===s&&t.$$typeof||e(t[s],a[s])))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===e&&(e=!0);var a=n.useCallback((function(a){if("function"!=typeof e||e())return a.preventDefault(),t&&(a.returnValue=t),t}),[e,t]);n.useEffect((function(){if(e)return window.addEventListener("beforeunload",a),function(){return window.removeEventListener("beforeunload",a)}}),[e,a])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(500));t.default=n.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r=["mousedown","touchstart"];t.default=function(e,t,a){void 0===a&&(a=r);var s=n.useRef(t);n.useEffect((function(){s.current=t}),[t]),n.useEffect((function(){for(var t=function(t){var a=e.current;a&&!a.contains(t.target)&&s.current(t)},n=0,r=a;n<r.length;n++){var o=r[n];i.on(document,o,t)}return function(){for(var e=0,n=a;e<n.length;e++){var r=n[e];i.off(document,r,t)}}}),[a,e])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(779));t.default=function(e){var t=i.useState((function(){return r.default.get(e)||null})),a=t[0],n=t[1];return[a,i.useCallback((function(t,a){r.default.set(e,t,a),n(t)}),[e]),i.useCallback((function(){r.default.remove(e),n(null)}),[e])]}},function(e,t,a){var n,i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var a=arguments[e];for(var n in a)t[n]=a[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function a(n){function i(){}function r(t,a,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(a);/^[\{\[]/.test(s)&&(a=s)}catch(e){}a=n.write?n.write(a,t):encodeURIComponent(String(a)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var l in r)r[l]&&(o+="; "+l,!0!==r[l]&&(o+="="+r[l].split(";")[0]));return document.cookie=t+"="+a+o}}function s(e,a){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var o=r[s].split("="),l=o.slice(1).join("=");a||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(o[0]);if(l=(n.read||n)(l,c)||t(l),a)try{l=JSON.parse(l)}catch(e){}if(i[c]=l,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,a){r(t,"",e(a,{expires:-1}))},i.defaults={},i.withConverter=a,i}((function(){}))},void 0===(i="function"==typeof(n=r)?n.call(t,a,t,e):n)||(e.exports=i),e.exports=r()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(487)),r=a(2),s=n.__importDefault(a(207)),o=n.__importDefault(a(255));t.default=function(){var e=s.default(),t=o.default({value:void 0,error:void 0,noUserInteraction:!0}),a=t[0],n=t[1];return[a,r.useCallback((function(t){var a,r;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var s=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void n({value:t,error:s,noUserInteraction:!0})}if(""===t)return s=new Error("Cannot copy empty string to clipboard."),void n({value:t,error:s,noUserInteraction:!0});r=t.toString(),a=i.default(r),n({value:r,error:void 0,noUserInteraction:a})}catch(s){n({value:r,error:s,noUserInteraction:a})}}),[])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(782),r=a(783),s=a(784),o=a(786),l=a(2),c=n.__importDefault(a(40)),u=i.create();r.addon(u),s.addon(u);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),a=l.useMemo((function(){return new u.VSheet}),[]);return c.default((function(){var n={};return o.cssToTree(n,e,"."+t,""),a.diff(n),function(){a.diff({})}})),t}},function(e,t,a){"use strict";var n=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,a=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(n,"-$&").toLowerCase()},decl:function(e,t){return(e=a.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,a=e.length;a;)t=33*t^e.charCodeAt(--a);return"_"+(t>>>0).toString(36)}(a.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){a.raw+=e}},e);return a.client&&(a.sh||document.head.appendChild(a.sh=document.createElement("style")),a.putRaw=function(e){var t=a.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),a.put=function(e,t,n){var i,r,s="",o=[];for(i in t)(r=t[i])instanceof Object&&!(r instanceof Array)?o.push(i):s+=a.decl(i,r,e,n);s&&(s=e+"{"+s+"}",a.putRaw(n?n+"{"+s+"}":s));for(var l=0;l<o.length;l++)"@"===(i=o[l])[0]&&"@font-face"!==i?a.putAt(e,t[i],i):a.put(a.selector(e,i),t[i],n)},a.putAt=a.put,a}},function(e,t,a){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,a){var n=t+"{}";a&&(n=a+"{"+n+"}");var i=a?e.msh.sheet:e.sh.sheet,r=i.insertRule(n,i.cssRules.length),s=(i.cssRules||i.rules)[r];if(s.index=r,a){var o=(s.cssRules||s.rules)[0];s.style=o.style,s.styleMap=o.styleMap}return s})}},function(e,t,a){"use strict";var n=a(785).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;a.prototype.diff=function(e){var a,n=this.decl,i=this.rule.style;for(a in n)void 0===e[a]&&i.removeProperty(a);for(a in e)e[a]!==n[a]&&i.setProperty(t(a),e[a]);this.decl=e},a.prototype.del=function(){n(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var n in t)if(void 0===e[n]){var i=t[n];for(var r in i)i[r].del()}for(var n in e)if(void 0===t[n])for(var r in e[n])(l=new a(r,n)).diff(e[n][r]),e[n][r]=l;else{var s=t[n],o=e[n];for(var r in s)o[r]||s[r].del();for(var r in o){var l;(l=s[r])?(l.diff(o[r]),o[r]=l):((l=new a(r,n)).diff(o[r]),o[r]=l)}}this.tree=e},e.VRule=a,e.VSheet=i}function a(t,a){this.rule=e.createRule(t,a),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,a=e.parentStyleSheet,n=a.cssRules||a.rules;for(t=Math.max(t,n.length-1);t>=0;){if(n[t]===e){a.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,a,n,i){var r,s,o={},l=!1;for(r in a)"object"!=typeof(s=a[r])&&(l=!0,o[r]=s);for(r in l&&(t[i]||(t[i]={}),t[i][n]=o),a)if("object"==typeof(s=a[r]))if("@"===r[0])e(t,s,n,r);else{var c=r.indexOf("&")>-1,u=n.split(",");if(c)for(var d=0;d<u.length;d++)u[d]=r.replace(/&/g,u[d]);else for(d=0;d<u.length;d++)u[d]=u[d]+" "+r;e(t,s,u.join(","),i)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(376));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var n=r.default(e,t),s=n[0],o=n[1],l=n[2];return i.useEffect(l,a),[s,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){var a=n.useState(t),i=a[0],r=a[1];return null==i?[e,r]:[i,r]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var a=e.onFiles,s=e.onText,o=e.onUri,l=i.useState(!1),c=l[0],u=l[1],d=i.useCallback(u,[]),p=i.useMemo((function(){return function(e){return function(t,a){var n=t.getData("text/uri-list");if(n)(e.onUri||r)(n,a);else if(t.files&&t.files.length)(e.onFiles||r)(Array.from(t.files),a);else if(a.clipboardData){var i=a.clipboardData.getData("text");(e.onText||r)(i,a)}}}(e)}),[a,s,o]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},a=function(){d(!1)},n=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),p(e.dataTransfer,e)},r=function(e){p(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",a),document.addEventListener("dragexit",n),document.addEventListener("drop",i),s&&document.addEventListener("paste",r),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",a),document.removeEventListener("dragexit",n),document.removeEventListener("drop",i),document.removeEventListener("paste",r)}}),n.__spreadArrays([p],t)),{over:c}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(207)),s=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,a=e.onText,n=e.onUri,o=r.default(),l=i.useState(!1),c=l[0],u=l[1],d=i.useMemo((function(){return function(e,t){return function(a,n){var i=a.getData("text/uri-list");i?(e.onUri||s)(i,n):a.files&&a.files.length?(e.onFiles||s)(Array.from(a.files),n):a.items&&a.items.length&&a.items[0].getAsString((function(a){t&&(e.onText||s)(a,n)}))}}(e,o())}),[t,a,n]),p=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(a){a.preventDefault(),a.persist(),t(!1),e(a.dataTransfer,a)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,u)}),[d,u]);return[p,{over:c}]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var n=a(2);function i(e){var t=n.useRef(e&&e.current);return n.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return n.forwardRef((function(t,a){var n=i(a);return e(t,n)}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(){var e=n.useState(null),t=e[0],a=e[1];return n.useEffect((function(){if(t)throw t}),[t]),n.useCallback((function(e){a(e)}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){n.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(795)),s=n.__importDefault(a(40)),o=function(){};t.default=function(e,t,a){void 0===a&&(a={});var n=a.video,l=a.onClose,c=void 0===l?o:l,u=i.useState(t),d=u[0],p=u[1];return s.default((function(){if(t&&e.current){var a=function(){n.current.removeEventListener("webkitendfullscreen",a),c()},i=function(){if(r.default.isEnabled){var e=r.default.isFullscreen;p(e),e||c()}};if(r.default.isEnabled){try{r.default.request(e.current),p(!0)}catch(e){c(e),p(!1)}r.default.on("change",i)}else n&&n.current&&n.current.webkitEnterFullscreen?(n.current.webkitEnterFullscreen(),n.current.addEventListener("webkitendfullscreen",a),p(!0)):(c(),p(!1));return function(){if(p(!1),r.default.isEnabled)try{r.default.off("change",i),r.default.exit()}catch(e){}else n&&n.current&&n.current.webkitExitFullscreen&&(n.current.removeEventListener("webkitendfullscreen",a),n.current.webkitExitFullscreen())}}}),[t,n,e]),d}},function(e,t,a){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},a=e.exports,n=function(){for(var e,a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,i=a.length,r={};n<i;n++)if((e=a[n])&&e[1]in t){for(n=0;n<e.length;n++)r[a[0][n]]=e[n];return r}return!1}(),i={change:n.fullscreenchange,error:n.fullscreenerror},r={request:function(e){return new Promise(function(a,i){var r=function(){this.off("change",r),a()}.bind(this);this.on("change",r),e=e||t.documentElement,Promise.resolve(e[n.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,a){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[n.exitFullscreen]()).catch(a)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,a){var n=i[e];n&&t.addEventListener(n,a,!1)},off:function(e,a){var n=i[e];n&&t.removeEventListener(n,a,!1)},raw:n};n?(Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(t[n.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[n.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[n.fullscreenEnabled])}}}),a?e.exports=r:window.screenfull=r):a?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2);t.default=function(e){var t,a=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),r=a[0],s=a[1],o=!0,l=function(e){o&&s({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},c=function(e){return o&&s((function(t){return n.__assign(n.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,c,e),t=navigator.geolocation.watchPosition(l,c,e),function(){o=!1,navigator.geolocation.clearWatch(t)}}),[]),r}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(223));t.default=function(e){void 0===e&&(e={});var t=r.default(),a=i.useRef(n.__assign({},e));return[i.useCallback((function(){return a.current}),[]),i.useCallback((function(e){e&&(Object.assign(a.current,e),t())}),[])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(799);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef((function(){}));n.useEffect((function(){a.current=e})),n.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return a.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,a=e.id;delete t.listeners[a];var n=!1;for(var r in t.listeners){n=!0;break}n||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var a,r=n++;if(i[t])i[t].listeners[r]=e;else{var s=setInterval((function(){for(var e,a=i[t].listeners,n=!1,r=0,s=Object.values(a);r<s.length;r++){var o=s[r];try{o()}catch(t){n=!0,e=t}}if(n)throw e}),t);i[t]={ms:t,timer:s,listeners:(a={},a[r]=e,a)}}return{bucket:i[t],id:r}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importStar(a(2)),i=n.useState,r=function(){};t.default=function(e){var t,a,s=i(!1),o=s[0],l=s[1];return"function"==typeof e&&(e=e(o)),[n.cloneElement(e,{onMouseEnter:(a=e.props.onMouseEnter,function(e){(a||r)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||r)(e),l(!1)})}),o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(802),r=a(131),s=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,a){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===a&&(a=s);var o=n.useState(t),l=o[0],c=o[1];return n.useEffect((function(){for(var t,n=!0,s=l,o=function(e){n&&(s=e,c(e))},u=i.throttle(50,(function(){s&&o(!1),clearTimeout(t),t=setTimeout((function(){return o(!0)}),e)})),d=function(){document.hidden||u()},p=0;p<a.length;p++)r.on(window,a[p],u);return r.on(document,"visibilitychange",d),t=setTimeout((function(){return o(!0)}),e),function(){n=!1;for(var e=0;e<a.length;e++)r.off(window,a[e],u);r.off(document,"visibilitychange",d)}}),[e,a]),l}},function(e,t,a){"use strict";function n(e,t,a,n){var i,r=!1,s=0;function o(){i&&clearTimeout(i)}function l(){var l=this,c=Date.now()-s,u=arguments;function d(){s=Date.now(),a.apply(l,u)}r||(n&&!i&&d(),o(),void 0===n&&c>e?d():!0!==t&&(i=setTimeout(n?function(){i=void 0}:d,void 0===n?e-c:e)))}return"boolean"!=typeof t&&(n=a,a=t,t=void 0),l.cancel=function(){o(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=n,t.debounce=function(e,t,a){return void 0===a?n(e,t,!1):n(e,a,!1!==t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){var a=n.useState(null),i=a[0],r=a[1];return n.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var a=new IntersectionObserver((function(e){r(e[0])}),t);return a.observe(e.current),function(){r(null),a.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){var a=n.useRef((function(){}));n.useEffect((function(){a.current=e})),n.useEffect((function(){if(null!==t){var e=setInterval((function(){return a.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=n.useState(0),a=t[0],i=t[1];n.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var r=n.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),s=r.reduce((function(e,t){var n=t[0],i=t[1];return a>=i?n:e}),r[0][0]);return s}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(505)),r=n.__importDefault(a(254));t.default=function(e,t,a,n){void 0===n&&(n=i.default);var s=n(e),o=s[0],l=s[1];r.default((function(){!o&&a?a(l):o&&t&&t(l)}),[o])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r=function(){};t.default=function(e,t,a){if(!i.isClient)return[t,r,r];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=a?a.raw?function(e){return e}:a.deserializer:JSON.parse,o=n.useState((function(){try{var n=a?a.raw?String:a.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?s(i):(t&&localStorage.setItem(e,n(t)),t)}catch(e){return t}})),l=o[0],c=o[1],u=n.useCallback((function(t){try{var n="function"==typeof t?t(l):t;if(void 0===n)return;var i;i=a?a.raw?"string"==typeof n?n:JSON.stringify(n):a.serializer?a.serializer(n):JSON.stringify(n):JSON.stringify(n),localStorage.setItem(e,i),c(s(i))}catch(e){}}),[e,c]),d=n.useCallback((function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}}),[e,c]);return[l,u,d]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r=function(e){var t=window.history,a=t[e];t[e]=function(t){var n=a.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),n}};i.isClient&&(r("pushState"),r("replaceState"));var s=function(e){var t=window.history,a=t.state,n=t.length,i=window.location;return{trigger:e,state:a,length:n,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},o="function"==typeof Event;t.default=i.isClient&&o?function(){var e=n.useState(s("load")),t=e[0],a=e[1];return n.useEffect((function(){var e=function(){return a(s("popstate"))},t=function(){return a(s("pushstate"))},n=function(){return a(s("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",n),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",n)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var n=a(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function r(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=new Map,l="object"==typeof document?document:void 0,c=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var a=n.useRef(l.body);t=t||a;var u=function(e){var t=o.get(e);t&&(1===t.counter?(o.delete(e),s?(e.ontouchmove=null,c&&(document.removeEventListener("touchmove",r),c=!1)):e.style.overflow=t.initialOverflow):o.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};n.useEffect((function(){var a=i(t.current);a&&(e?function(e){var t=o.get(e);t?o.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(o.set(e,{counter:1,initialOverflow:e.style.overflow}),s?c||(document.addEventListener("touchmove",r,{passive:!1}),c=!0):e.style.overflow="hidden")}(a):u(a))}),[e,t.current]),n.useEffect((function(){var e=i(t.current);if(e)return function(){u(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(256)),r=n.__importDefault(a(254));t.default=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];i.default((function(){return console.log.apply(console,n.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),r.default((function(){console.log.apply(console,n.__spreadArrays([e+" updated"],t))}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var a=void 0===t?{}:t,r=a.isPreventDefault,s=void 0===r||r,o=a.delay,l=void 0===o?300:o,c=n.useRef(),u=n.useRef(),d=n.useCallback((function(t){s&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),u.current=t.target),c.current=setTimeout((function(){return e(t)}),l)}),[e,l,s]),p=n.useCallback((function(){c.current&&clearTimeout(c.current),s&&u.current&&u.current.removeEventListener("touchend",i)}),[s]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:p,onMouseLeave:p,onTouchEnd:p}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131);t.default=function(e,t){void 0===t&&(t=!1);var a=n.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),r=a[0],s=a[1];return n.useEffect((function(){var t=!0,a=window.matchMedia(e),n=function(){t&&s(!!a.matches)};return a.addListener(n),s(a.matches),function(){t=!1,a.removeListener(n)}}),[e]),r}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=n.useState({}),t=e[0],a=e[1];return n.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&a({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(r)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var n=a(2);t.useMediatedState=function(e,t){var a=n.useRef(e),i=n.useState(t),r=i[0],s=i[1];return[r,n.useCallback((function(e){2===a.current.length?a.current(e,s):s(a.current(e))}),[r])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){var a=n.useMemo((function(){return function(t,a){var n;return(n=e(t))[a.type].apply(n,a.payload)}}),[e]),i=n.useReducer(a,t),r=i[0],s=i[1],o=n.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return s({type:t,payload:e})},e}),{})}),[e,t]);return[r,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=r);var t=n.useState(e),a=t[0],s=t[1];return n.useEffect((function(){var e=function(e){var t=e.acceleration,a=e.accelerationIncludingGravity,n=e.rotationRate,i=e.interval;s({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:a.x,y:a.y,z:a.z},rotationRate:{alpha:n.alpha,beta:n.beta,gamma:n.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(503)),r=n.__importDefault(a(510)),s={current:null};t.default=function(e,t){void 0===t&&(t={});var a=!!t.whenHovered,n=!!t.bound,o=i.default(e,a),l=r.default(a&&!o?s:e);return n&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(){var e=n.useState(0),t=e[0],a=e[1];return n.useEffect((function(){var e=function(e){a(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=a(131),s=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},o=function(){var e=s();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],l=t[1];return i.useEffect((function(){var e=a,t=function(t){e=n.__assign(n.__assign({},e),t),l(e)},i=s(),c=function(){t({online:!0,since:new Date})},u=function(){t({online:!1,since:new Date})},d=function(){t(o())};return r.on(window,"online",c),r.on(window,"offline",u),i&&(r.on(i,"change",d),t(n.__assign(n.__assign(n.__assign({},a),{online:navigator.onLine,since:void 0}),o()))),function(){r.off(window,"online",c),r.off(window,"offline",u),i&&r.off(i,"change",d)}}),[]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(501));t.default=n.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=r);var t=window.screen,a=n.useState(e),s=a[0],o=a[1];return n.useEffect((function(){var a=!0,n=function(){if(a){var n=t.orientation;if(n){var i=n.angle,r=n.type;o({angle:i,type:r})}else window.orientation?o({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):o(e)}};return i.on(window,"orientationchange",n),n(),function(){a=!1,i.off(window,"orientationchange",n)}}),[]),s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=[]),n.useEffect((function(){if(e){var t=function(t){var a=(t=t||window.event).relatedTarget||t.toElement;a&&"HTML"!==a.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131),r=function(){};t.default=function(e){var t=!0,a=null,s=n.useState(""),o=s[0],l=s[1],c=function(){t&&a&&l(a.state)};return n.useEffect((function(){return navigator.permissions.query(e).then((function(e){a=e,c(),i.on(a,"change",c)})).catch(r),function(){t=!1,a&&i.off(a,"change",c)}}),[]),o}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(300),r=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=r);var a=n.useRef(),s=n.useRef(e);return i.useFirstMountState()||t(s.current,e)||(a.current=s.current,s.current=e),a.current}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(207));t.default=function(){var e=r.default();return i.useCallback((function(t){return new Promise((function(a,n){t.then((function(t){e()&&a(t)}),(function(t){e()&&n(t)}))}))}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),a=t[0],r=t[1];return{add:function(e){r((function(t){return n.__spreadArrays(t,[e])}))},remove:function(){var e;return r((function(t){var a=t[0],n=t.slice(1);return e=a,n})),e},get first(){return a[0]},get last(){return a[a.length-1]},get size(){return a.length}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=!0);var a=n.useRef(null),i=n.useRef(!1),r=n.useRef(e);r.current=e;var s=n.useCallback((function(e){i.current&&(r.current(e),a.current=requestAnimationFrame(s))}),[]),o=n.useMemo((function(){return[function(){i.current&&(i.current=!1,a.current&&cancelAnimationFrame(a.current))},function(){i.current||(i.current=!0,a.current=requestAnimationFrame(s))},function(){return i.current}]}),[]);return n.useEffect((function(){return t&&o[1](),o[0]}),[]),o}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,a=n.useState((function(){return i(t.search,e)})),r=a[0],s=a[1];return n.useEffect((function(){var a=function(){s(i(t.search,e))};return window.addEventListener("popstate",a),window.addEventListener("pushstate",a),window.addEventListener("replacestate",a),function(){window.removeEventListener("popstate",a),window.removeEventListener("pushstate",a),window.removeEventListener("replacestate",a)}}),[]),r}:function(){return null}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var n=a(38),i=a(2),r=a(830),s=n.__importDefault(a(506)),o=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,a=s.default(e),r=i.useState({isScratching:!1}),l=r[0],c=r[1],u=i.useRef(l),d=i.useRef(!1),p=i.useRef(null),m=i.useState(null),f=m[0],b=m[1];return i.useEffect((function(){if(!t&&f){var e,i,r=function(e,t){cancelAnimationFrame(p.current),p.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),r=i.left,s=i.top,l=r+window.scrollX,d=s+window.scrollY,p=e-l,m=t-d;c((function(e){var t=n.__assign(n.__assign({},e),{dx:p-(e.x||0),dy:m-(e.y||0),end:Date.now(),isScratching:!0});return u.current=t,(a.current.onScratch||o)(t),t}))}))},s=function(e){r(e.pageX,e.pageY)},l=function(e){r(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},m=function(){d.current&&(d.current=!1,u.current=n.__assign(n.__assign({},u.current),{isScratching:!1}),(a.current.onScratchEnd||o)(u.current),c({isScratching:!1}),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=m,i=m;var b=function(t,n){if(d.current){var r=f.getBoundingClientRect(),p=r.left,m=r.top,b=p+window.scrollX,g=m+window.scrollY,y=t-b,h=n-g,v=Date.now(),E={isScratching:!0,start:v,end:v,docX:t,docY:n,x:y,y:h,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:b,elY:g};u.current=E,(a.current.onScratchStart||o)(E),c(E),window.addEventListener("mousemove",s),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},g=function(e){d.current=!0,b(e.pageX,e.pageY)},y=function(e){d.current=!0,b(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",g),f.addEventListener("touchstart",y),function(){f.removeEventListener("mousedown",g),f.removeEventListener("touchstart",y),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),p.current&&cancelAnimationFrame(p.current),p.current=null,d.current=!1,u.current={isScratching:!1},c(u.current)}}}),[f,t,a]),[b,l]};t.ScratchSensor=function(e){e.children;var t=n.__rest(e,["children"]),a=l(t),s=a[0],o=a[1],c=r.render(e,o);return i.cloneElement(c,n.__assign(n.__assign({},c.props),{ref:function(e){c.props.ref&&("object"==typeof c.props.ref&&(c.props.ref.current=e),"function"==typeof c.props.ref&&c.props.ref(e)),s(e)}}))},t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var n=a(38),i=n.__importDefault(a(512));t.render=i.default;var r=n.__importDefault(a(831));t.createEnhancer=r.default;var s=n.__importDefault(a(834));t.hookToRenderProp=s.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var n=a(38),i=n.__importStar(a(2)),r=n.__importDefault(a(832)),s=i.createElement,o=function(e,t,a,i){var r;return s(e,t?n.__assign(((r={})[t]=i,r),a):n.__assign(n.__assign({},i),a))};t.divWrapper=function(e,t,a,n){return s("div",null,o(e,t,a,n))},t.default=function(e,t,a){void 0===a&&(a=o);var n=function(i,o,l){void 0===o&&(o=t),void 0===l&&(l=null);var c="string"==typeof i;if(c)return function(e){return n(e,i||t,o)};var u=function(t){return s(e,l,(function(e){return a(i,o,t,e)}))};return c?r.default(u):u};return n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(833));t.default=function(e){return e.prototype?e:n.default(e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importStar(a(2));t.default=function(e){var t=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(a,t),a.prototype.render=function(){return e(this.props,this.context)},a}(i.Component);return t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(512)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(a){return n.default(a,e.apply(void 0,t(a)))}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(257));t.default=function(e){var t=r.default({x:0,y:0}),a=t[0],n=t[1];return i.useEffect((function(){var t=function(){e.current&&n({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){var t=n.useState(!1),a=t[0],i=t[1];return n.useEffect((function(){if(e.current){var t,a=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",a,!1),function(){e.current&&e.current.removeEventListener("scroll",a,!1)}}return function(){}}),[e]),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(131);t.default=function(e,t,a){if(!i.isClient)return[t,function(){}];var r=n.useState((function(){try{var n=sessionStorage.getItem(e);return"string"!=typeof n?(sessionStorage.setItem(e,a?String(t):JSON.stringify(t)),t):a?n:JSON.parse(n||"null")}catch(e){return t}})),s=r[0],o=r[1];return n.useEffect((function(){try{var t=a?String(s):JSON.stringify(s);sessionStorage.setItem(e,t)}catch(e){}})),[s,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(839),r=n.__importDefault(a(375)),s=function(e,t){return e.every((function(e,a){return i.equal(e,t[a])}))};t.default=function(e,t){r.default(e,t,s)}},function(e,t){var a=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var n=a(e),i=n.length,r=0;r<i;r++)if(!(n[r]in t))return!1;for(r=0;r<i;r++)if(e[n[r]]!==t[n[r]])return!1;return i===a(t).length}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importStar(a(2)),r=a(131),s=i.useState,o=i.useEffect,l=i.useRef;t.default=function(e,t){var a=void 0===t?{}:t,c=a.width,u=void 0===c?1/0:c,d=a.height,p=void 0===d?1/0:d;if(!r.isClient)return["function"==typeof e?e({width:u,height:p}):e,{width:u,height:p}];var m=s({width:u,height:p}),f=m[0],b=m[1];"function"==typeof e&&(e=e(f));var g=e.props.style||{},y=l(null),h=null,v=function(){var e=y.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:u,height:p};b(t)},E=function(e){e.addEventListener("resize",v),setTimeout(v,35)};return o((function(){var e=y.current;if(e){if(e.contentWindow)h=e.contentWindow,E(h);else{var t=function(){e.removeEventListener("load",t),h=e.contentWindow,E(h)};e.addEventListener("load",t)}return function(){h&&h.removeEventListener&&h.removeEventListener("resize",v)}}}),[]),g.position="relative",[i.cloneElement.apply(i,n.__spreadArrays([e,{style:g}],n.__spreadArrays([i.createElement("iframe",{ref:y,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=a(131),s=n.__importDefault(a(207)),o=n.__importDefault(a(255)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var a=s.default(),n=i.useRef(!1),c=i.useRef(0),u=i.useRef(0),d=o.default({isSliding:!1,value:0}),p=d[0],m=d[1];return c.current=p.value,i.useEffect((function(){if(r.isClient){var i=void 0===t.styles||t.styles,s=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var o=function(){!n.current&&a()&&((t.onScrubStart||l)(),n.current=!0,m({isSliding:!0}),y())},d=function(){n.current&&a()&&((t.onScrubStop||l)(c.current),n.current=!1,m({isSliding:!1}),h())},p=function(e){o(),f(e)},f=t.vertical?function(e){return v(e.clientY)}:function(e){return v(e.clientX)},b=function(e){o(),g(e)},g=t.vertical?function(e){return v(e.changedTouches[0].clientY)}:function(e){return v(e.changedTouches[0].clientX)},y=function(){r.on(document,"mousemove",f),r.on(document,"mouseup",d),r.on(document,"touchmove",g),r.on(document,"touchend",d)},h=function(){r.off(document,"mousemove",f),r.off(document,"mouseup",d),r.off(document,"touchmove",g),r.off(document,"touchend",d)},v=function(n){cancelAnimationFrame(u.current),u.current=requestAnimationFrame((function(){if(a()&&e.current){var i=e.current.getBoundingClientRect(),r=t.vertical?i.top:i.left,o=t.vertical?i.height:i.width;if(!o)return;var c=(n-r)/o;c>1?c=1:c<0&&(c=0),s&&(c=1-c),m({value:c}),(t.onScrub||l)(c)}}))};return r.on(e.current,"mousedown",p),r.on(e.current,"touchstart",b),function(){r.off(e.current,"mousedown",p),r.off(e.current,"touchstart",b)}}}),[e,t.vertical]),p}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(509)),s=n.__importDefault(a(255)),o="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var a=s.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||o[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),n=a[0],l=a[1],c=i.useRef(null);return r.default((function(){var a=new SpeechSynthesisUtterance(e);t.lang&&(a.lang=t.lang),t.voice&&(a.voice=t.voice),a.rate=t.rate||1,a.pitch=t.pitch||1,a.volume=t.volume||1,a.onstart=function(){return l({isPlaying:!0})},a.onresume=function(){return l({isPlaying:!0})},a.onend=function(){return l({isPlaying:!1})},a.onpause=function(){return l({isPlaying:!1})},c.current=a,window.speechSynthesis.speak(c.current)})),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(40));t.default=function(e){n.default((function(){var t=function(t){var a,n,i,r,s;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(n=(a=t).keyCode,i=a.metaKey,r=a.ctrlKey,s=a.altKey,!(i||r||s)&&(n>=48&&n<=57||n>=65&&n<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var n=a(2),i=a(300),r=a(301);t.useStateWithHistory=function(e,t,a){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var s=i.useFirstMountState(),o=n.useState(e),l=o[0],c=o[1],u=n.useRef(null!=a?a:[]),d=n.useRef(0);return s&&(u.current.length?(u.current[u.current.length-1]!==e&&u.current.push(e),u.current.length>t&&(u.current=u.current.slice(u.current.length-t))):u.current.push(e),d.current=u.current.length&&u.current.length-1),[l,n.useCallback((function(e){c((function(a){return(e=r.resolveHookState(e))!==a&&(d.current<u.current.length-1&&(u.current=u.current.slice(0,d.current+1)),d.current=u.current.push(e)-1,u.current.length>t&&(u.current=u.current.slice(u.current.length-t))),e}))}),[l,t]),n.useMemo((function(){return{history:u.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&c((function(){return d.current-=Math.min(e,d.current),u.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==u.current.length-1&&c((function(){return d.current=Math.min(d.current+e,u.current.length-1),u.current[d.current]}))},go:function(e){e!==d.current&&c((function(){return d.current=e<0?Math.max(u.current.length+e,0):Math.min(u.current.length-1,e),u.current[d.current]}))}}}),[l])]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(207)),s=n.__importDefault(a(223)),o=n.__importDefault(a(254));t.default=function(e){void 0===e&&(e=[]);var t=r.default(),a=s.default(),l=i.useRef(0);o.default((function(){e.length<=l.current&&(l.current=e.length-1,a())}),[e.length]);var c=i.useMemo((function(){return{next:function(){return c.setStateAt(l.current+1)},prev:function(){return c.setStateAt(l.current-1)},setStateAt:function(n){t()&&e.length&&n!==l.current&&(l.current=n>=0?n%e.length:e.length+n%e.length,a())},setState:function(n){if(t()){var i=e.length?e.indexOf(n):-1;if(-1===i)throw new Error("State '"+n+"' is not a valid state (does not exist in state list)");l.current=i,a()}}}}),[e]);return n.__assign({state:e[l.current],currentIndex:l.current},c)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(303));t.default=function(e,t){void 0===t&&(t=200);var a=i.useState(e),n=a[0],s=a[1],o=i.useRef(),l=i.useRef(null),c=i.useRef(0);return i.useEffect((function(){if(o.current)l.current=e,c.current=!0;else{s(e);var a=function(){c.current?(c.current=!1,s(l.current),o.current=setTimeout(a,t)):o.current=void 0};o.current=setTimeout(a,t)}}),[e]),r.default((function(){o.current&&clearTimeout(o.current)})),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(303));t.default=function(e,t,a){void 0===t&&(t=200);var n=i.useState(null),s=n[0],o=n[1],l=i.useRef(),c=i.useRef();return i.useEffect((function(){if(l.current)c.current=a;else{o(e.apply(void 0,a));var n=function(){c.current?(o(e.apply(void 0,c.current)),c.current=void 0,l.current=setTimeout(n,t)):l.current=void 0};l.current=setTimeout(n,t)}}),a),r.default((function(){l.current&&clearTimeout(l.current)})),s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(376)),r=n.__importDefault(a(223));t.default=function(e){void 0===e&&(e=0);var t=r.default();return i.default(t,e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var a=n.useRef(document.title);document.title=e,n.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=a.current}:void 0}),[])}:function(e){}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(1092),r=n.__importDefault(a(511));t.default=function(e,t,a){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===a&&(a=0),(0,i.easing[e])(r.default(t,a))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(){var e=n.useRef(!1);return n.useEffect((function(){return function(){e.current=!0}})),n.useMemo((function(){return function(t,a){return new Promise((function(n,i){t.then((function(t){e.current||n(t)}),(function(t){e.current?a?a(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=n.__importDefault(a(508));t.default=function(e,t){void 0===t&&(t=[]);var a=i.default(t),r=a[0],s=a[1];return[r,n.__assign(n.__assign({},s),{upsert:function(t){s.upsert(e,t)}})]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,a){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===a&&(a=!0),n.useEffect((function(){var n;if(e&&(navigator.vibrate(t),a)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;n=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),a&&clearInterval(n))}}),[e])}:function(){}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38).__importDefault(a(499)).default("video");t.default=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t,a){void 0===a&&(a=[void 0]);var i=n.useRef(t),r=n.useRef(e);i.current=t,r.current=e;var s=n.useState(a),o=s[0],l=s[1],c=n.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return n.useEffect((function(){c()}),[e]),[o,c]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var n=a(857),i=a(2);t.useScrollbarWidth=function(){var e=i.useState(n.scrollbarWidth()),t=e[0],a=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){a(n.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof n.__cache)return n.__cache;var t=document.createElement("div"),a=t.style;a.display="block",a.position="absolute",a.width="100px",a.height="100px",a.left="-999px",a.top="-999px",a.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return n.__cache=100-i,document.body.removeChild(t),n.__cache;document.body.removeChild(t)}};t.scrollbarWidth=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var n=a(2);t.useMultiStateValidator=function(e,t,a){if(void 0===a&&(a=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=n.useRef(t),r=n.useRef(e);i.current=t,r.current=e;var s=n.useState(a),o=s[0],l=s[1],c=n.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return n.useEffect((function(){c()}),Object.values(e)),[o,c]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=a(131),s=n.__importDefault(a(257));t.default=function(){var e=s.default({x:r.isClient?window.pageXOffset:0,y:r.isClient?window.pageYOffset:0}),t=e[0],a=e[1];return i.useEffect((function(){var e=function(){a({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(257)),s=a(131);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var a=r.default({width:s.isClient?window.innerWidth:e,height:s.isClient?window.innerHeight:t}),n=a[0],o=a[1];return i.useEffect((function(){if(s.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2),r=n.__importDefault(a(40)),s=a(131),o={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=s.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],a=e[1],n=i.useState(o),s=n[0],l=n[1],c=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,a=t.x,n=t.y,i=t.width,r=t.height,s=t.top,o=t.left,c=t.bottom,u=t.right;l({x:a,y:n,width:i,height:r,top:s,left:o,bottom:c,right:u})}}))}),[]);return r.default((function(){if(t)return c.observe(t),function(){c.disconnect()}}),[t]),[a,s]}:function(){return[function(){},o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var n=a(2);t.useRendersCount=function(){return++n.useRef(0).current}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),i=a(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),a=t[0],r=t[1],s=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(n.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(n.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),o=n.__assign({has:i.useCallback((function(e){return a.has(e)}),[a])},s);return[a,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var n=a(38),i=a(2),r=n.__importDefault(a(256)),s=n.__importDefault(a(40));function o(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),a=e[0],n=e[1];return r.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==n}))}})),s.default((function(){t.setters.includes(n)||t.setters.push(n)})),[a,t.setState]}}t.createGlobalState=o,t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var n=a(38),i=a(2),r=n.__importDefault(a(507));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],a=e[1],n=i.useCallback((function(){a(window.location.hash)}),[]);r.default((function(){window.addEventListener("hashchange",n)}),(function(){window.removeEventListener("hashchange",n)}));var s=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,s]}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(23),i=a.n(n),r=a(17),s=a(2),o=a.n(s),l=a(44);const c=a.n(l)()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);c.displayName="EmptyPrompt";const u=o.a.memo((({actions:e,message:t,title:a,...n})=>{const l=Object.keys(e),u=Object(s.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:a,url:n,descriptionTitle:i,description:s,onClick:c,fill:u=!0},d)=>null!=i||null!=s?o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiCard,{title:null!=i&&i,description:null!=s&&s,footer:o.a.createElement(r.EuiButton,{href:n,onClick:c,iconType:e,target:a,fill:u,"data-test-subj":`empty-page-${l[d]}-action`},t)})):o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiButton,{href:n,onClick:c,iconType:e,target:a,"data-test-subj":`empty-page-${l[d]}-action`},t))))),[e,l]);return o.a.createElement(c,i()({iconType:"logoSecurity",title:o.a.createElement(r.EuiText,null,o.a.createElement("h2",null,a)),body:t&&o.a.createElement("p",null,t),actions:o.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},u)},n))}));u.displayName="EmptyPageComponent";const d=o.a.memo(u);d.displayName="EmptyPage"},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(870);a(23),a(2),a(518),a(13),a(269),a(268),a(519);var i=n.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(23),i=a(2),r=a(518),s=a(13),o=a(269),l=a(268),c=a(519);function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var p=d(i),m=u(r).default,f=function(e){return"theme"!==e},b=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?m:f},g=function(e,t,a){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof n&&a&&(n=e.__emotion_forwardProp),n},y="undefined"!=typeof document,h=function(e){var t=e.cache,a=e.serialized,n=e.isStringTag;o.registerStyles(t,a,n);var i=c.useInsertionEffectAlwaysWithSyncFallback((function(){return o.insertStyles(t,a,n)}));if(!y&&void 0!==i){for(var r,s=a.name,l=a.next;void 0!==l;)s+=" "+l.name,l=l.next;return p.createElement("style",((r={})["data-emotion"]=t.key+" "+s,r.dangerouslySetInnerHTML={__html:i},r.nonce=t.sheet.nonce,r))}return null};t.default=function e(t,a){var i,r,c=t.__emotion_real===t,u=c&&t.__emotion_base||t;void 0!==a&&(i=a.label,r=a.target);var d=g(t,a,c),m=d||b(u),f=!m("as");return function(){var y=arguments,v=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&v.push("label:"+i+";"),null==y[0]||void 0===y[0].raw)v.push.apply(v,y);else{v.push(y[0][0]);for(var E=y.length,x=1;x<E;x++)v.push(y[x],y[0][x])}var j=s.withEmotionCache((function(e,t,a){var n=f&&e.as||u,i="",c=[],g=e;if(null==e.theme){for(var y in g={},e)g[y]=e[y];g.theme=p.useContext(s.ThemeContext)}"string"==typeof e.className?i=o.getRegisteredStyles(t.registered,c,e.className):null!=e.className&&(i=e.className+" ");var E=l.serializeStyles(v.concat(c),t.registered,g);i+=t.key+"-"+E.name,void 0!==r&&(i+=" "+r);var x=f&&void 0===d?b(n):m,j={};for(var S in e)f&&"as"===S||x(S)&&(j[S]=e[S]);return j.className=i,j.ref=a,p.createElement(p.Fragment,null,p.createElement(h,{cache:t,serialized:E,isStringTag:"string"==typeof n}),p.createElement(n,j))}));return j.displayName=void 0!==i?i:"Styled("+("string"==typeof u?u:u.displayName||u.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=u,j.__emotion_styles=v,j.__emotion_forwardProp=d,Object.defineProperty(j,"toString",{value:function(){return"."+r}}),j.withComponent=function(t,i){return e(t,n({},a,i,{shouldForwardProp:g(j,i,!0)})).apply(void 0,v)},j}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(418);function i(e){return e&&e.__esModule?e:{default:e}}var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,s=i(n).default((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=s},function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(a(2)),r="undefined"!=typeof document,s=!!i.useInsertionEffect&&i.useInsertionEffect,o=r&&s||function(e){return e()},l=s||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=o,t.useInsertionEffectWithLayoutFallback=l},function(e,t,a){"use strict";var n=a(513),i=a(2);function r(e,t,a){return e[t]?e[t][0]?e[t][0][a]:e[t][a]:"contentBoxSize"===t?e.contentRect["inlineSize"===a?"width":"height"]:void 0}e.exports=function(e){void 0===e&&(e={});var t=e.onResize,a=i.useRef(void 0);a.current=t;var s=e.round||Math.round,o=i.useRef(),l=i.useState({width:void 0,height:void 0}),c=l[0],u=l[1],d=i.useRef(!1);i.useEffect((function(){return d.current=!1,function(){d.current=!0}}),[]);var p=i.useRef({width:void 0,height:void 0}),m=function(e,t){var a=i.useRef(null),n=i.useRef(null);n.current=t;var r=i.useRef(null);i.useEffect((function(){s()}));var s=i.useCallback((function(){var t=r.current,i=n.current,s=t||(i?i instanceof Element?i:i.current:null);a.current&&a.current.element===s&&a.current.subscriber===e||(a.current&&a.current.cleanup&&a.current.cleanup(),a.current={element:s,subscriber:e,cleanup:s?e(s):void 0})}),[e]);return i.useEffect((function(){return function(){a.current&&a.current.cleanup&&(a.current.cleanup(),a.current=null)}}),[]),i.useCallback((function(e){r.current=e,s()}),[s])}(i.useCallback((function(t){return o.current&&o.current.box===e.box&&o.current.round===s||(o.current={box:e.box,round:s,instance:new n.ResizeObserver((function(t){var n=t[0],i="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",o=r(n,i,"inlineSize"),l=r(n,i,"blockSize"),c=o?s(o):void 0,m=l?s(l):void 0;if(p.current.width!==c||p.current.height!==m){var f={width:c,height:m};p.current.width=c,p.current.height=m,a.current?a.current(f):d.current||u(f)}}))}),o.current.instance.observe(t,{box:e.box}),function(){o.current&&o.current.instance.unobserve(t)}}),[e.box,s]),e.ref);return i.useMemo((function(){return{ref:m,width:c.width,height:c.height}}),[m,c.width,c.height])}},,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(111),i=a(289),r=a(607);let s;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(s||(s={}));const o=n.object({searchTerm:n.string(),source:n.nativeEnum(s),tags:n.array(n.string()),enabled:n.boolean(),ruleExecutionStatus:i.e}).partial(),l=r.b.pick({field:!0,order:!0}).partial(),c=r.a.pick({perPage:!0}).partial(),u=r.a.pick({page:!0,perPage:!0}).partial()},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"i",(function(){return s})),a.d(t,"j",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"j",(function(){return b})),a.d(t,"b",(function(){return g}));var n=a(51),i=a(5),r=a(169),s=a(277);const o=(e,t,a)=>a.reduce(((a,i,r)=>{const s=((e,t,a,i,r=n.v4)=>{var s;const{fields:o}=e,{fields:l}=t,c=a.field,u=a.value,[d]=o.filter((({name:e})=>null!=c&&c===e)),[p]=l.filter((({name:e})=>null!=u&&u===e));return{id:null!==(s=a.id)&&void 0!==s?s:r(),field:d,type:"mapping",value:p,entryIndex:i}})(e,t,i,r);return[...a,s]}),[]),l=(e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}),c=(e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}},u=(e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}},d=()=>Object(r.d)({field:"",type:"mapping",value:""}),p=()=>Object(r.d)({entries:[Object(r.d)({field:"",type:"mapping",value:""})]}),m=e=>e.reduce(((e,t)=>{const a={...t,entries:t.entries};return s.o.is(a)?[...e,a]:e}),[]),f=e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))),b=e=>1===e.length&&1===e[0].entries.length&&""===e[0].entries[0].field&&""===e[0].entries[0].value,g={forbiddenField:(e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return m}));var n=a(49),i=a(57),r=a(178);const s=e=>e.artifacts.location,o=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.n,exact:!0}))),c=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.r,exact:!0}))),u=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.m,exact:!0}))),d=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.o,exact:!0}))),p=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.l,exact:!0}))),m=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.q,exact:!0})))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),i=a(50),r=a(163),s=a(326),o=a(337);const l=["POST",s.e],c=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(r.w)({signal:e})),{...o.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),i=a(50),r=a(163),s=a(326),o=a(337);const l=["POST",s.f],c=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(r.x)({signal:e})),{...o.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(49);const r=(e,t)=>{const a=Object(i.useHistory)();return Object(n.useCallback)((n=>{try{t&&t(n)}catch(e){throw n.preventDefault(),e}n.defaultPrevented||0===n.button&&(n.currentTarget instanceof HTMLAnchorElement&&""!==n.currentTarget.target&&"_self"!==n.currentTarget.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),Array.isArray(e)?a.push(...e):a.push(e)))}),[a,t,e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return BlocklistsApiClient}));var n=a(175),i=a(964),r=a(599),s=a(1077);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends r.a{constructor(e){super(e,n.c,s.a,o,l)}static getInstance(e){return super.getInstance(e,n.c,s.a,o,l)}}},,function(e,t,a){"use strict";a.d(t,"d",(function(){return J})),a.d(t,"a",(function(){return Y})),a.d(t,"b",(function(){return X})),a.d(t,"c",(function(){return ee}));var n=a(2),i=a.n(n),r=a(17),s=a(517),o=a.n(s),l=a(55),c=a(47),u=a(427),d=a(331);const p=`${u.a}RulePreview`,m=`${p}RulePreviewTitle`,f=`${m}Suppressed`,b=`${p}CreatedByText`,g=`${p}UpdatedByText`,y=`${p}Body`,h=`${p}AboutSection`,v=(d.c,d.a,`${p}DefinitionSection`),E=(d.c,d.a,`${p}ScheduleSection`),x=(d.c,d.a,`${p}ActionsSection`),j=(d.c,d.a,`${p}Loading`),S=`${p}Footer`,O=`${u.a}AlertReasonPreviewBody`;var k=a(601),w=a(960),T=a(572),I=a(491);const C=o.a.div`
  overflow-x: auto;
  padding-block: ${l.euiThemeVars.euiSizeS};
`,M=o.a.div``,_=()=>{const{dataAsNestedObject:e,scopeId:t}=Object(k.b)(),a=Object(n.useMemo)((()=>Object(w.a)({data:e,rowRenderers:T.b})),[e]),s=Object(n.useMemo)((()=>a?a.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[a,e,t]);return a?i.a.createElement(r.EuiPanel,{hasShadow:!1,"data-test-subj":O},i.a.createElement(r.EuiTitle,null,i.a.createElement("h6",null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.alertReason.panelTitle",defaultMessage:"Alert reason"}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(C,null,i.a.createElement(M,{className:"eui-displayInlineBlock"},s))):i.a.createElement(r.EuiPanel,{hasShadow:!1,hasBorder:!1},i.a.createElement(I.a,null))};_.displayName="AlertReasonPreview";var A=a(179),F=a(428),P=a(340),D=a(1105),N=a(1136);const R=({rule:e,isSuppressed:t})=>i.a.createElement("div",{"data-test-subj":m},i.a.createElement(r.EuiTitle,null,i.a.createElement("h6",null,e.name)),t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiBadge,{"data-test-subj":f,title:""},D.a)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"xs",direction:"column"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":b},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(N.a,{createdBy:null==e?void 0:e.created_by,createdAt:null==e?void 0:e.created_at}))),i.a.createElement(r.EuiFlexItem,{"data-test-subj":g},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(N.b,{updatedBy:null==e?void 0:e.updated_by,updatedAt:null==e?void 0:e.updated_at})))));R.displayName="RulePreviewTitle";var L=a(1071),B=a(1072),z=a(1073),q=a(686),$=a(394);const V=A.css`
  dt {
    font-size: 90% !important;
  }
  text-overflow: ellipsis;
  .euiFlexGroup {
    flex-wrap: inherit;
  }

  .euiFlexItem {
    inline-size: inherit;
    flex-basis: inherit;
  }
`,U=Object(n.memo)((()=>{var e,t;const{ruleId:a}=Object(k.b)(),[s,o]=Object(n.useState)(null),{rule:l,loading:u,isExistingRule:p}=Object(F.a)(null!=a?a:"");Object(n.useEffect)((()=>{null!=l&&o(l)}),[l]);const{ruleActionsData:m}=null!=s?Object(P.h)({rule:s,detailsView:!0}):{ruleActionsData:null},f=Boolean(null==m||null===(e=m.actions)||void 0===e?void 0:e.length),b=Boolean(null==m||null===(t=m.responseActions)||void 0===t?void 0:t.length),g=null!=m&&(f||b);return u?i.a.createElement($.a,{"data-test-subj":j}):s?i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1,"data-test-subj":y,className:"eui-yScroll"},i.a.createElement(R,{rule:s,isSuppressed:!p}),i.a.createElement(r.EuiHorizontalRule,{margin:"s"}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.b,{title:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.aboutLabel",defaultMessage:"About"}),expanded:!0,"data-test-subj":h},i.a.createElement(r.EuiText,{size:"s"},s.description),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(L.b,{rule:s,hideName:!0,hideDescription:!0,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),i.a.createElement(d.b,{title:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.definitionLabel",defaultMessage:"Definition"}),expanded:!1,"data-test-subj":v},i.a.createElement(z.a,{rule:s,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),i.a.createElement(d.b,{title:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.scheduleLabel",defaultMessage:"Schedule"}),expanded:!1,"data-test-subj":E},i.a.createElement(B.a,{rule:s,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),g&&i.a.createElement(d.b,{title:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.actionsLabel",defaultMessage:"Actions"}),expanded:!1,"data-test-subj":x},i.a.createElement(q.b,{addPadding:!1,defaultValues:m}))):i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1},i.a.createElement(I.a,null))}));U.displayName="RulePreview";var H=a(5),Q=a(928),G=a(285);const W=Object(n.memo)((({children:e,...t})=>i.a.createElement(r.EuiFlyoutFooter,t,i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent"},e))));W.displayName="FlyoutFooter";const Z=Object(n.memo)((()=>{const{scopeId:e,eventId:t,ruleId:a}=Object(k.b)();return a?i.a.createElement(W,{"data-test-subj":S},i.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(Q.a,{contextId:e,eventId:t,fieldName:G.n,fieldType:"string",isAggregatable:!1,isDraggable:!1,linkValue:a,value:H.i18n.translate("xpack.securitySolution.flyout.preview.rule.viewDetailsLabel",{defaultMessage:"Show rule details"}),openInNewTab:!0})))):null}));Z.displayName="RulePreviewFooter";const K=[{id:"rule-preview",content:i.a.createElement(U,null),footer:i.a.createElement(Z,null)},{id:"alert-reason-preview",content:i.a.createElement(_,null)}],J="rule-preview",Y="alert-reason-preview",X="document-details-preview",ee=Object(n.memo)((({path:e})=>{const t=Object(n.useMemo)((()=>e?K.find((t=>t.id===e.tab)):null),[e]);return t?i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween",direction:"column",gutterSize:"none",style:{height:"100%"}},i.a.createElement(r.EuiFlexItem,{style:{marginTop:"-15px"}},t.content),i.a.createElement(r.EuiFlexItem,{grow:!1},t.footer)):null}));ee.displayName="PreviewPanel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v}));var n=a(2),i=a.n(n),r=a(4),s=a(387),o=a(117),l=a(110),c=a(5);const u=c.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),d=c.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retrieve detection engine privileges"});var p=a(152),m=a(311);var f=a(9),b=a(18),g=a(575),y=a(902);const h=Object(n.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:{loading:!0,...Object(g.b)()},kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),v=({kibanaCapabilities:e,children:t})=>{const a=!0===e[r.vc].crud,c=!0===e[r.vc].show,[v,E]=Object(n.useState)({crud:a,read:c}),x=((e=!0)=>{const t=Object(l.h)(),{lists:a}=Object(l.i)().services,{start:i,...r}=Object(s.l)(),{addError:c}=Object(o.a)(),d=Object(n.useRef)(new AbortController);return Object(n.useEffect)((()=>{const{loading:n,result:s,error:o}=r;!e||!a||n||s||o||(d.current.abort(),d.current=new AbortController,i({http:t,signal:d.current.signal}))}),[t,a,i,r,e]),Object(n.useEffect)((()=>()=>{d.current.abort()}),[]),Object(n.useEffect)((()=>{const e=r.error;null!=e&&c(e,{title:u})}),[c,r.error]),{loading:r.loading,error:r.error,result:r.result}})(c),j=((e=!0)=>{const{start:t,...a}=Object(p.a)(Object(p.d)(m.i)),{addError:i}=Object(o.a)(),r=Object(n.useRef)(new AbortController);return Object(n.useEffect)((()=>{const{loading:n,result:i,error:s}=a;!e||n||i||s||(r.current.abort(),r.current=new AbortController,t({signal:r.current.signal}))}),[t,a,e]),Object(n.useEffect)((()=>()=>{r.current.abort()}),[]),Object(n.useEffect)((()=>{const e=a.error;null!=e&&i(e,{title:d})}),[i,a.error]),a})(c),S=(()=>{var e,t;const a=Object(p.b)(),i=Object(l.f)(),r=Object(l.i)().services.fleet,s=null===(e=Object(y.b)())||void 0===e?void 0:e.fleet,o=null!==(t=null==r?void 0:r.authz)&&void 0!==t?t:null==s?void 0:s.authz,c=Object(b.b)(),[u,d]=Object(n.useState)(!1),[m,h]=Object(n.useState)([]),v=Object(n.useMemo)((()=>{const e=!u||!i;return Object.freeze({loading:e,...e||!o||Object(f.isEmpty)(i)?Object(g.b)():Object(g.a)(c,o,m)})}),[u,i,o,c,m]);return Object(n.useEffect)((()=>{(async()=>{i&&a()&&(h(null==i?void 0:i.roles),d(!0))})()}),[a,i]),v})();return Object(n.useEffect)((()=>{E((e=>e.read!==c||e.crud!==a?{read:c,crud:a}:e))}),[a,c]),i.a.createElement(h.Provider,{value:{listPrivileges:x,detectionEnginePrivileges:j,endpointPrivileges:S,kibanaSecuritySolutionsPrivileges:v}},t)}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return g}));var n=a(9),i=a(231),r=a(110),s=a(307),o=a(3),l=a(54);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(n.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=a(475);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const f=(e,t)=>{let a,n=[];return(...i)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...i);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},b=async(...e)=>{const[{value:t,formData:a}]=e,{query:f}=t,b=f.query,{dataViewId:g,index:y,ruleType:h}=a;if(void 0===h&&!Object(n.isEmpty)(b)||Object(i.b)(h)&&!Object(n.isEmpty)(b))try{const{data:e}=r.b.get();let t=null==y?void 0:y.join(),i={};if(null!=g&&""!==g&&a.dataSourceType===s.a.DataView){const a=await e.dataViews.get(g);t=a.title,i=a.getRuntimeMappings()}const p=(new AbortController).signal,f=await(async({data:e,dataViewTitle:t,query:a,signal:i,runtimeMappings:r})=>{const{rawResponse:s}=await Object(o.firstValueFrom)(e.search.search({params:{index:t,body:{query:a,runtime_mappings:r,size:0}},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>u(e)&&c(Object(n.get)(e,"error.type")))(s))return{valid:!1,errors:d(s)};if(u(s))throw new Error(JSON.stringify(s));return{valid:!0,errors:[]}})({data:e,query:b,signal:p,dataViewTitle:t,runtimeMappings:i});if(!1===(null==f?void 0:f.valid))return{code:m.INVALID_EQL,message:"",messages:f.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},g=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===m.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));const n=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,r=e=>"LoadedResourceState"===e.type,s=e=>"FailedResourceState"===e.type,o=()=>({type:"UninitialisedResourceState"}),l=e=>({type:"LoadingResourceState",previousState:e}),c=e=>({type:"LoadedResourceState",data:e}),u=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),d=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return o()}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(45),i=a(2),r=a(117),s=a(110),o=a(21),l=a(1129),c=a(5);const u=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),p=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),m=()=>{const{telemetry:e}=Object(s.i)().services,{addError:t}=Object(r.a)(),[a,n]=Object(i.useState)(!1);return{enableDatafeed:Object(i.useCallback)((async(a,i)=>{if(n(!0),Object(o.h)(o.a.COUNT,a.isElasticJob?o.c.SIEM_JOB_ENABLED:o.c.CUSTOM_JOB_ENABLED),!a.isInstalled)try{await Object(l.c)({configTemplate:a.moduleId,indexPatternName:a.defaultIndexPattern,jobIdErrorFilter:[a.id],groups:a.groups}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,moduleId:a.moduleId,status:o.b.moduleInstalled})}catch(i){return n(!1),t(i,{title:p}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,moduleId:a.moduleId,status:o.b.installationError,errorMessage:`${p} - ${i.message}`}),{enabled:!1}}const r=new Date,s=r.setDate(r.getDate()-14),c=`datafeed-${a.id}`,d=Math.max(i,s);try{var m;const t=await Object(l.d)({datafeedIds:[c],start:d});if(null!==(m=t[c])&&void 0!==m&&m.error)throw new Error(t[c].error);return e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:o.b.started}),{enabled:!!t[c]&&t[c].started}}catch(n){Object(o.h)(o.a.COUNT,o.c.JOB_ENABLE_FAILURE),t(n,{title:u}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:o.b.startError,errorMessage:`${u} - ${n.message}`})}finally{n(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(i.useCallback)((async a=>{Object(o.h)(o.a.COUNT,a.isElasticJob?o.c.SIEM_JOB_DISABLED:o.c.CUSTOM_JOB_DISABLED),n(!0);const i=`datafeed-${a.id}`;try{const[t]=await Object(l.e)({datafeedIds:[i]});if(f(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:o.b.stopped}),{enabled:!t[i]||!t[i].stopped}}catch(n){Object(o.h)(o.a.COUNT,o.c.JOB_DISABLE_FAILURE),t(n,{title:d}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:o.b.stopError,errorMessage:`${d} - ${n.message}`})}finally{n(!1)}return{enabled:!0}}),[t,e]),isLoading:a}},f=e=>!Object(n.isEmpty)(e.error)},,,function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.alert="alert",e.asset="asset",e.enrichment="enrichment",e.event="event",e.metric="metric",e.state="state",e.pipeline_error="pipeline_error",e.signal="signal"}(n||(n={}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(2);const i=a.n(n).a.createContext(void 0),r=()=>Object(n.useContext)(i)},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/discover"),r=i("UPDATE_DISCOVER_APP_STATE"),s=i("UPDATE_DISCOVER_INTERNAL_STATE"),o=i("UPDATE_DISCOVER_SAVED_SEARCH_STATE")},function(e,t,a){var n=a(1029),i=a(1033),r=a(638),s=a(274),o=a(1039);e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?s(e)?i(e[0],e[1]):n(e):o(e)}},function(e,t,a){e.exports=a(24)(1228)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(48),s=a(957),o=a(271);const l=i.a.memo((e=>{const t=Object(r.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),a=Object(r.useDispatch)();return t||a(Object(o.createResolver)({id:e.resolverComponentInstanceID})),Object(n.useEffect)((()=>{e.shouldUpdate&&a(Object(o.createResolver)({id:e.resolverComponentInstanceID}))}),[a,e.shouldUpdate,e.resolverComponentInstanceID]),i.a.createElement(s.a,e)}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(211),i=a(428);const r=({dataFormattedForFieldBrowser:e})=>{const t=Object(n.b)(e),{loading:a,error:r,rule:s}=Object(i.a)(t.ruleId);return{loading:a,error:r,basicAlertData:t,ruleNote:null==s?void 0:s.note}}},function(e,t,a){"use strict";var n=a(260);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return j}));var n=a(1155),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(47),c=a(236),u=a(18),d=a(379),p=a(963),m=a(183),f=a(201),b=a(670),g=a(126),y=a(151);const h="prevalence-details",v="now-30d",E=()=>{const{euiTheme:e}=Object(o.useEuiTheme)();return s.a.createElement("div",{"data-test-subj":m.t,style:{height:"16px",width:"100%",background:e.colors.lightShade}})},x=[{field:"field",name:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.fieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":m.q,render:e=>s.a.createElement(o.EuiText,{size:"xs"},e),width:"20%"},{field:"values",name:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.valueColumnLabel",defaultMessage:"Value"}),"data-test-subj":m.v,render:e=>s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map((e=>s.a.createElement(o.EuiFlexItem,{key:e},s.a.createElement(o.EuiText,{size:"xs"},e))))),width:"20%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnTooltip",defaultMessage:"Total number of alerts with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnLabel",defaultMessage:"Alert"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":m.o,render:e=>{const t=e.values.map((t=>Object(b.a)(e.field,`timeline-indicator-${e.field}-${t}`,t)));return e.alertCount>0?s.a.createElement(d.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to}},s.a.createElement(c.a,{count:e.alertCount})):Object(g.d)()},width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnTooltip",defaultMessage:"Total number of event documents with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnLabel",defaultMessage:"Document"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":m.p,render:e=>{const t=e.values.map((t=>({...Object(b.a)(e.field,`timeline-indicator-${e.field}-${t}`,t),and:[Object(b.b)("event.kind","timeline-indicator-event.kind-not-signal","signal",y.e,!0)]})));return e.docCount>0?s.a.createElement(d.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to},keepDataView:!0},s.a.createElement(c.a,{count:e.docCount})):Object(g.d)()},width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnTooltip",defaultMessage:"Percentage of unique hosts with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnLabel",defaultMessage:"Host"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":m.r,render:e=>s.a.createElement(s.a.Fragment,null,e.isPlatinumPlus?s.a.createElement(o.EuiText,{size:"xs"},`${Math.round(100*e.hostPrevalence)}%`):s.a.createElement(E,null)),width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnTooltip",defaultMessage:"Percentage of unique users with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnLabel",defaultMessage:"User"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":m.u,render:e=>s.a.createElement(s.a.Fragment,null,e.isPlatinumPlus?s.a.createElement(o.EuiText,{size:"xs"},`${Math.round(100*e.userPrevalence)}%`):s.a.createElement(E,null)),width:"10%"}],j=()=>{const{dataFormattedForFieldBrowser:e,investigationFields:t}=Object(f.b)(),a=Object(u.b)().isPlatinumPlus(),[n,c]=Object(r.useState)(v),[d,b]=Object(r.useState)("now"),[g,y]=Object(r.useState)((i.a.parse(v)||new Date).toISOString()),[h,E]=Object(r.useState)((i.a.parse("now")||new Date).toISOString()),{loading:j,error:S,data:O}=Object(p.a)({dataFormattedForFieldBrowser:e,investigationFields:t,interval:{from:n,to:d}}),k=Object(r.useMemo)((()=>O.map((e=>({...e,from:g,to:h,isPlatinumPlus:a})))),[O,g,h,a]),w=s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiCallOut,{"data-test-subj":m.w},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellDescription",defaultMessage:"Host and user prevalence are only available with a {subscription}.",values:{subscription:s.a.createElement(o.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellLinkText",defaultMessage:"Platinum or higher subscription"}))}})),s.a.createElement(o.EuiSpacer,{size:"s"}));return s.a.createElement(s.a.Fragment,null,!S&&!a&&w,s.a.createElement(o.EuiPanel,null,s.a.createElement(o.EuiSuperDatePicker,{start:n,end:d,onTimeChange:({start:e,end:t,isInvalid:a})=>{if(a)return;c(e),b(t);const n=i.a.parse(e);n&&n.isValid()&&y(n.toISOString());const r=i.a.parse(t);r&&r.isValid()&&E(r.toISOString())},"data-test-subj":m.n,width:"full"}),s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiInMemoryTable,{items:S?[]:k,columns:x,loading:j,"data-test-subj":m.s,message:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})})))};j.displayName="PrevalenceDetails"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(45),i=a(142),r=a(566),s=a(911),o=a(1277);const l=({dataFormattedForFieldBrowser:e,investigationFields:t})=>{var a,l;const c=Object(o.a)(e),u=Object(n.find)({category:"event",field:"event.code"},e),d=Array.isArray(null==u?void 0:u.originalValue)?null==u||null===(a=u.originalValue)||void 0===a?void 0:a[0]:null==u?void 0:u.originalValue,p=Object(n.find)({category:"kibana",field:i.R},e),m=Array.isArray(null==p?void 0:p.originalValue)?null==p||null===(l=p.originalValue)||void 0===l?void 0:l[0]:null==p?void 0:p.originalValue;return Object(o.b)({eventCategories:c,eventCode:d,eventRuleType:m,highlightedFieldsOverride:null!=t?t:[]}).reduce(((t,a)=>{const i=e.find((e=>e.field===a.id||a.legacyId&&e.field===a.legacyId));if(!i)return t;const o=i.values;return!o||Object(n.isEmpty)(o)?t:(i.field===a.legacyId&&(a.id=a.legacyId),"agent.id"===a.id&&!Object(s.b)({data:e})||a.id===r.a&&!Object(r.c)({data:e})?t:{...t,[a.id]:{...a.overrideField&&{overrideField:a.overrideField},values:o}})}),{})}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=(e,t,a)=>Object.keys(e).map((n=>{const i=e[n].values,r=e[n].overrideField,s=r||n;return{field:s,description:{field:s,...r?{originalField:n}:{},values:i,scopeId:t,isPreview:a}}})),i=e=>Object.keys(e).reduce(((t,a)=>({...t,[a]:{terms:{[a]:e[a].values}}})),[])},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(879),r=a(127),s=a(313);const o=({entityId:e,scopeId:t})=>{const{loading:a,error:o,count:l,alertIds:c}=Object(i.a)({field:s.c,value:e,isActiveTimelines:Object(r.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0});return Object(n.useMemo)((()=>({loading:a,error:o,data:c||[],dataCount:l||0})),[c,l,o,a])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(313),r=a(879),s=a(127);const o=({originalEventId:e,scopeId:t})=>{const{loading:a,error:o,count:l,alertIds:c}=Object(r.a)({field:i.a,value:e,isActiveTimelines:Object(s.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0});return Object(n.useMemo)((()=>({loading:a,error:o,data:c||[],dataCount:l||0})),[c,l,o,a])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(50),i=a(2),r=a(110),s=a(4);const o=({eventId:e})=>{const{services:{cases:t}}=Object(r.i)(),{data:a,isLoading:o,isError:l}=Object(n.useQuery)(["useFetchRelatedCases",e],(()=>t.api.getRelatedCases(e,{owner:s.i})),{keepPreviousData:!0});return Object(i.useMemo)((()=>({loading:o,error:l,data:a||[],dataCount:(null==a?void 0:a.length)||0})),[a,l,o])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(39),i=a(212);const r=()=>{const{cases:e}=Object(i.b)().services;return e.helpers.canUseCases([n.APP_ID]).read}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),i=a(45),r=a(1063),s=a(130),o=a(18),l=a(313),c=a(192);const u=({getFieldsData:e,dataAsNestedObject:t,dataFormattedForFieldBrowser:a,eventId:u,isPreview:d})=>{var p;const m=Object(s.a)("insightsRelatedAlertsByProcessAncestry"),f=Object(r.a)(t),b=null!==(p=Object(c.a)(e(l.a)))&&void 0!==p?p:"",g=d?b:u,y=Object(n.useMemo)((()=>Object(i.find)({category:"kibana",field:l.f},a)),[a]),h=Object(o.b)().isPlatinumPlus();return{show:m&&f&&null!=y&&h,documentId:g,...y&&y.values&&{indices:y.values}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(142);const i=({getFieldsData:e})=>{const t=e(n.cb),a=t?parseInt(t[0],10):0;return{show:Boolean(t),alertSuppressionCount:a}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(313),i=a(192);const r=({getFieldsData:e})=>{const t=Object(i.a)(e(n.a));return{show:null!=t,...t&&{originalEventId:t}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(313),i=a(192);const r=({getFieldsData:e})=>{const t=Object(i.a)(e(n.c));return{show:null!=t,...t&&{entityId:t}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(1064),r=a(127);const s=({documentId:e,indices:t,scopeId:a})=>{const s=Object(r.isActiveTimeline)(a),{loading:o,error:l,alertIds:c}=Object(i.a)({isActiveTimeline:s,documentId:e,indices:t});return Object(n.useMemo)((()=>({loading:o,error:l,data:c,dataCount:(null==c?void 0:c.length)||0})),[c,l,o])}},,,,,,,,,function(e,t,a){"use strict";const n=a(2),i=a(1172),r=a(461),s=a(1173),o=a(1220),l=a(1221),c=a(1222),u=a(1223),d=a(1225),p=a(1226).hastChildrenToReact;e.exports=g;const m={}.hasOwnProperty,f="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",b={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function g(e){for(const t in b)if(m.call(b,t)&&m.call(e,t)){const e=b[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <${f}#${e.id}> for more info)`),delete b[t]}const t=r().use(s).use(e.remarkPlugins||e.plugins||[]).use(o,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let a;"string"==typeof e.children?a=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),a=i());const l=t.runSync(t.parse(a),a);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=n.createElement(n.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=n.createElement("div",{className:e.className},d)),d}g.defaultProps={transformLinkUri:d},g.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},g.uriTransformer=d},function(e,t,a){"use strict";var n={}.hasOwnProperty;e.exports=n},function(e,t,a){"use strict";e.exports=function(e){for(var t=-1,a=0;++t<e.length;)a+="string"==typeof e[t]?e[t].length:1;return a}},function(e,t,a){"use strict";var n=a(414),i=a(286),r=a(349);function s(e,t){for(var a,n,r,s,o,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),f=m.events,b=[],g={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(a=u.sliceStream(c),c.next||a.push(null),n&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(a),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),n=c,c=c.next}for(c=n,r=f.length;r--;)"enter"===f[r][0]?s=!0:s&&f[r][1].type===f[r-1][1].type&&f[r][1].start.line!==f[r][1].end.line&&(y(f.slice(r+1,o)),c._tokenizer=c.next=void 0,c=c.previous,o=r+1);for(m.events=c._tokenizer=c.next=void 0,y(f.slice(0,o)),r=-1,l=0;++r<b.length;)g[l+b[r][0]]=l+b[r][1],l+=b[r][1]-b[r][0]-1;return g;function y(t){var a=p.pop();b.unshift([a,a+t.length-1]),i(e,a,2,t)}}e.exports=function(e){for(var t,a,o,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((o=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[o][1].type&&(o+=2),o<u.length&&"content"===u[o][1].type))for(;++o<u.length&&"content"!==u[o][1].type;)"chunkText"===u[o][1].type&&(u[o][1].isInFirstContentOfListItem=!0,o++);if("enter"===t[0])t[1].contentType&&(n(p,s(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(o=m,a=void 0;o--&&("lineEnding"===(l=e[o])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(a&&(e[a][1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);a&&(t[1].end=r(e[a][1].start),(c=e.slice(a,m)).unshift(t),i(e,a,m-a+1,c))}}return!d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(414),i=a(349),r=l("text"),s=l("string"),o={resolveAll:c()};function l(e){return{tokenize:function(t){var a=this,n=this.parser.constructs[e],i=t.attempt(n,r,s);return r;function r(e){return l(e)?i(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),o)}function l(e){var t=n[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(a,a.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,a){for(var n,i=-1;++i<=t.length;)void 0===n?t[i]&&"data"===t[i][1].type&&(n=i,i++):t[i]&&"data"===t[i][1].type||(i!==n+2&&(t[n][1].end=t[i-1][1].end,t.splice(n+2,i-n-2),i=n+2),n=void 0);return e?e(t,a):t}}function u(e,t){for(var a,r,s,o,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(r=e[p-1][1],o=(a=t.sliceStream(r)).length,l=-1,c=0,u=void 0;o--;)if("string"==typeof(s=a[o])){for(l=s.length;32===s.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===s)u=!0,c++;else if(-1!==s){o++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-c,offset:r.end.offset-c,_index:r.start._index+o,_bufferIndex:o?l:r.start._bufferIndex+l},end:i(r.end)},r.end=i(d.start),r.start.offset===r.end.offset?n(r,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=o,t.string=s,t.text=r},function(e,t,a){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,a){e.exports=a(24)(3428)},function(e,t,a){"use strict";var n=a(288)(/\d/);e.exports=n},function(e,t,a){"use strict";var n=a(935),i=a(287),r=a(156);e.exports=function(e,t,a,s,o,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(s),e.enter(o),e.enter(l),e.consume(t),e.exit(l),f):n(t)||41===t?a(t):(e.enter(s),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),y(t))};function f(a){return 62===a?(e.enter(l),e.consume(a),e.exit(l),e.exit(o),e.exit(s),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),b(a))}function b(t){return 62===t?(e.exit("chunkString"),e.exit(u),f(t)):null===t||60===t||r(t)?a(t):(e.consume(t),92===t?g:b)}function g(t){return 60===t||62===t||92===t?(e.consume(t),b):b(t)}function y(r){return 40===r?++m>p?a(r):(e.consume(r),y):41===r?m--?(e.consume(r),y):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(s),t(r)):null===r||i(r)?m?a(r):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(s),t(r)):n(r)?a(r):(e.consume(r),92===r?h:y)}function h(t){return 40===t||41===t||92===t?(e.consume(t),y):y(t)}}},function(e,t,a){"use strict";var n=a(156),i=a(258);e.exports=function(e,t,a,r,s,o){var l,c=this,u=0;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),e.enter(o),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?a(i):93===i?(e.exit(o),e.enter(s),e.consume(i),e.exit(s),e.exit(r),t):n(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||n(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},function(e,t,a){"use strict";var n=a(156),i=a(258),r=a(171);e.exports=function(e,t){var a;return function s(o){return n(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a=!0,s):i(o)?r(e,s,a?"linePrefix":"lineSuffix")(o):t(o)}}},function(e,t,a){"use strict";var n=a(156),i=a(171);e.exports=function(e,t,a,r,s,o){var l;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),l=40===t?41:t,c};function c(a){return a===l?(e.enter(s),e.consume(a),e.exit(s),e.exit(r),t):(e.enter(o),u(a))}function u(t){return t===l?(e.exit(o),c(l)):null===t?a(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||n(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,a){"use strict";var n=a(156),i=a(258),r=a(171),s={name:"thematicBreak",tokenize:function(e,t,a){var s,o=0;return function(t){return e.enter("thematicBreak"),s=t,l(t)};function l(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):i(u)?r(e,l,"whitespace")(u):o<3||null!==u&&!n(u)?a(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===s?(e.consume(t),o++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=s},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"Per rule run"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"Custom frequency"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.body.summary.message",{defaultMessage:"Rule {ruleName} generated {signalsCount} alerts",values:{ruleName:"{{context.rule.name}}",signalsCount:"{{state.signals_count}}"}}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.body.forEachAlert.message",{defaultMessage:"Rule {ruleName} generated alert {alertId}",values:{ruleName:"{{context.rule.name}}",alertId:"{{alert.id}}"}})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(44);const s=a.n(r).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1qyhc9r-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));s.defaultProps={addPadding:!1};const o=i.a.memo(s);o.displayName="StepContentWrapper"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17);const l=s()(o.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1oris7-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),c=({badges:e,"data-test-subj":t})=>i.a.createElement(o.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0,"data-test-subj":t},e.map((e=>i.a.createElement(o.EuiFlexItem,{grow:!1,key:`badge-${e}`,"data-test-subj":`${t}Item`},i.a.createElement(l,{color:"hollow"},e)))))},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>0===n(e,t,a)},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>0!==n(e,t,a)},function(e,t,a){const n=a(946),i=a(947),r=a(538),s=a(539),o=a(680),l=a(603);e.exports=(e,t,a,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e===a;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e!==a;case"":case"=":case"==":return n(e,a,c);case"!=":return i(e,a,c);case">":return r(e,a,c);case">=":return s(e,a,c);case"<":return o(e,a,c);case"<=":return l(e,a,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17),l=a(86),c=a(110);const u=s()(o.EuiLink).withConfig({displayName:"StyledJobEuiLInk",componentId:"sc-ilb29r-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({jobId:e,jobName:t})=>{const{services:{http:a,ml:n}}=Object(c.i)(),r=Object(l.useMlHref)(n,a.basePath.get(),{page:l.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}},[e]);return i.a.createElement(u,{"data-test-subj":"machineLearningJobLink",href:r,target:"_blank"},i.a.createElement("span",{"data-test-subj":"machineLearningJob"},null!=t?t:e))},p=Object(n.memo)(d)},function(e,t,a){"use strict";a.r(t),a.d(t,"updateNetworkTable",(function(){return r})),a.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return s})),a.d(t,"setNetworkTablesActivePageToZero",(function(){return o})),a.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return l})),a.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var n=a(26);const i=a.n(n)()("x-pack/security_solution/local/network"),r=i("UPDATE_NETWORK_TABLE"),s=i("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=i("UPDATE_NETWORK_ANOMALIES_INTERVAL")},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(961),s=a(594);const o=e=>[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,s.a),id:"default-timeline-control-column",rowCellRender:r.a,width:Object(r.c)(e)}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return TrustedAppsApiClient}));var n=a(175),i=a(964),r=a(599),s=a(953);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends r.a{constructor(e){super(e,n.n,s.b,o,l)}static getInstance(e){return super.getInstance(e,n.n,s.b,o,l)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(139),i=a(175);const r=["name","description","item_id","entries.value","entries.entries.value"],s={name:i.o,namespace_type:"agnostic",description:i.m,list_id:i.n,type:n.b.ENDPOINT_TRUSTED_APPS}},function(e,t,a){"use strict";a.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var n=a(175),i=a(599),r=a(737);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,n.i,r.a)}static getInstance(e){return super.getInstance(e,n.i,r.a)}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return Lt})),a.d(t,"b",(function(){return Bt}));var n=a(2),i=a.n(n),r=a(144),s=a(900),o=a(192),l=a(140),c=a(17),u=a(5),d=a(194),p=a(218),m=a(1284),f=a(1332),b=a(211),g=a(377),y=a(405),h=a(215),v=a(1085);const E=()=>({promptContextId:void 0});var x=a(133);const j=Object(n.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,indexName:a}=Object(l.b)(),{isAlert:r,timestamp:s}=Object(b.b)(e),o=Object(f.a)({_id:t,_index:a,timestamp:s}),j=r&&o,S=e=>{const t=new URLSearchParams(window.location.search);return`${e}&${p.a.eventFlyout}=${t.get(p.a.eventFlyout)}`},{showAssistant:O,promptContextId:k}=(({dataFormattedForFieldBrowser:e,isAlert:t})=>{const{hasAssistantPrivilege:a}=Object(g.a)(),i=a?d.k:E,r=Object(n.useCallback)((async()=>Object(y.e)(null!=e?e:[])),[e]),{promptContextId:s}=i(t?"alert":"event",t?h.e:h.i,t?Object(h.d)(h.A):Object(h.h)(h.A),r,null,t?v.b[v.c].suggestedUserPrompt:v.b[v.e].suggestedUserPrompt,t?h.f:h.j);return{showAssistant:a&&null!==s,promptContextId:s||""}})({dataFormattedForFieldBrowser:e,isAlert:r});return i.a.createElement(c.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd",alignItems:"center",gutterSize:"none",responsive:!1},O&&i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(d.g,{conversationId:r?h.e:h.i,promptContextId:k,iconOnly:!0})),j&&i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiToolTip,{content:u.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonToolTip",{defaultMessage:"Share alert"})},i.a.createElement(c.EuiCopy,{textToCopy:o},(e=>i.a.createElement(c.EuiButtonIcon,{iconType:"share",color:"text","aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonAriaLabel",{defaultMessage:"Share alert"}),"data-test-subj":x.bb,onClick:()=>Object(m.a)(e,o,S),onKeyDown:()=>Object(m.a)(e,o,S)}))))))}));j.displayName="HeaderActions";var S=a(1285),O=a(233);const k=Object(n.memo)((({flyoutIsExpandable:e})=>{const{openLeftPanel:t}=Object(r.d)(),{eventId:a,indexName:s,scopeId:o}=Object(l.b)(),c=Object(n.useCallback)((()=>{t({id:O.a,params:{id:a,indexName:s,scopeId:o}})}),[a,t,s,o]);return i.a.createElement(S.a,{flyoutIsExpandable:e,expandDetails:c,actions:i.a.createElement(j,null)})}));k.displayName="PanelNavigation";var w=a(1325),T=a(1299),I=a(47),C=a(1300),M=a(1329);const _=()=>{const{openLeftPanel:e}=Object(r.d)(),{eventId:t,indexName:a,scopeId:s}=Object(l.b)(),o=Object(n.useCallback)((()=>{e({id:O.a,path:{tab:O.e},params:{id:t,indexName:a,scopeId:s}})}),[t,a,e,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(c.EuiButton,{onClick:o,iconType:"documentation","data-test-subj":x.V},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.responseButtonLabel",defaultMessage:"Response"})))};_.displayName="ResponseButton";var A=a(331);const F=({expanded:e=!1})=>{const{isPreview:t}=Object(l.b)();return i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.sectionTitle",defaultMessage:"Response"}),"data-test-subj":x.W},t?i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):i.a.createElement(_,null))};F.displayName="ResponseSection";var P=a(912),D=a(428),N=a(1167),R=a(566),L=a(895),B=a(285),z=a(416);const q=({value:e})=>{const{scopeId:t,eventId:a,indexName:s}=Object(l.b)(),{openLeftPanel:o}=Object(r.d)(),u=Object(n.useCallback)((()=>{o({id:O.a,path:{tab:O.c,subTab:z.a},params:{id:a,indexName:s,scopeId:t}})}),[a,s,o,t]);return i.a.createElement(c.EuiLink,{onClick:u,"data-test-subj":x.G},e)},$=({values:e,field:t,originalField:a})=>i.a.createElement(i.a.Fragment,null,null!=e&&e.map(((e,n)=>i.a.createElement(c.EuiFlexItem,{grow:!1,key:`${n}-${e}`,"data-test-subj":`${e}-${x.E}`},t===B.g||t===B.p?i.a.createElement(q,{value:e}):t===B.a&&a===R.a?i.a.createElement(N.b,{agentId:String(null!=e?e:""),"data-test-subj":x.C}):t===B.a?i.a.createElement(L.b,{endpointAgentId:String(null!=e?e:""),"data-test-subj":x.C}):i.a.createElement("span",{"data-test-subj":x.D},e)))));var V=a(600),U=a(910);const H=[{field:"field",name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableFieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":"fieldCell",width:"30%"},{field:"description",name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableValueColumnLabel",defaultMessage:"Value"}),"data-test-subj":"valueCell",width:"70%",render:e=>i.a.createElement(V.a,{field:e.field,value:e.values},i.a.createElement($,{values:e.values,field:e.field,originalField:e.originalField}))}],Q=()=>{var e,t;const{dataFormattedForFieldBrowser:a,scopeId:r,isPreview:s}=Object(l.b)(),{ruleId:o}=Object(b.b)(a),{loading:u,rule:d}=Object(D.a)(o),p=Object(U.a)({dataFormattedForFieldBrowser:a,investigationFields:null!==(e=null==d||null===(t=d.investigation_fields)||void 0===t?void 0:t.field_names)&&void 0!==e?e:[]}),m=Object(n.useMemo)((()=>Object(P.b)(p,r,s)),[p,r,s]);return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.H},i.a.createElement(c.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.highlightedFieldsTitle",defaultMessage:"Highlighted fields"})))),i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.F},i.a.createElement(c.EuiPanel,{hasBorder:!0,hasShadow:!1},i.a.createElement(c.EuiInMemoryTable,{items:m,columns:H,compressed:!0,loading:u,message:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.noDataDescription",defaultMessage:"There's no highlighted fields for this alert."})}))))};var G=a(907);const W=()=>{const{openLeftPanel:e}=Object(r.d)(),{eventId:t,indexName:a,scopeId:s,dataFormattedForFieldBrowser:o,isPreview:d}=Object(l.b)(),{loading:p,error:m,basicAlertData:f,ruleNote:b}=Object(G.a)({dataFormattedForFieldBrowser:o}),g=Object(n.useCallback)((()=>{e({id:O.a,path:{tab:O.d},params:{id:t,indexName:a,scopeId:s}})}),[t,a,e,s]);return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":x.N},i.a.createElement(c.EuiFlexItem,null,i.a.createElement(c.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideTitle",defaultMessage:"Investigation guide"})))),d?i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):p?i.a.createElement(c.EuiSkeletonText,{"data-test-subj":x.M,contentAriaLabel:u.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideLoadingAriaLabel",{defaultMessage:"investigation guide"})}):!m&&f.ruleId&&b?i.a.createElement(c.EuiFlexItem,null,i.a.createElement(c.EuiButton,{onClick:g,iconType:"documentation","data-test-subj":x.L,"aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonAriaLabel",{defaultMessage:"Show investigation guide"})},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonLabel",defaultMessage:"Show investigation guide"}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataDescription",defaultMessage:"Thereâ€™s no investigation guide for this rule."}))};W.displayName="InvestigationGuideButton";const Z=({expanded:e=!0})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.sectionTitle",defaultMessage:"Investigation"}),"data-test-subj":x.O},i.a.createElement(W,null),i.a.createElement(c.EuiSpacer,{size:"m"}),i.a.createElement(Q,null));Z.displayName="InvestigationSection";var K=a(44),J=a.n(K),Y=a(9),X=(a(13),a(890));const ee=()=>{const{dataFormattedForFieldBrowser:e,scopeId:t,eventId:a,indexName:s,isPreview:o}=Object(l.b)(),{isAlert:d,ruleDescription:p,ruleName:m,ruleId:f}=Object(b.b)(e),{openPreviewPanel:g}=Object(r.d)(),y=Object(n.useCallback)((()=>{const e={tab:X.d};g({id:X.b,path:e,params:{id:a,indexName:s,scopeId:t,banner:{title:u.i18n.translate("xpack.securitySolution.flyout.right.about.description.rulePreviewTitle",{defaultMessage:"Preview rule details"}),backgroundColor:"warning",textColor:"warning"},ruleId:f}})}),[a,g,s,t,f]),h=Object(n.useMemo)((()=>i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:y,iconSide:"right","data-test-subj":x.Z,"aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonAriaLabel",{defaultMessage:"Show rule summary"}),disabled:Object(Y.isEmpty)(m)||Object(Y.isEmpty)(f)||o},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonLabel",defaultMessage:"Show rule summary"})))),[m,y,f,o]),v=(null==p?void 0:p.length)>0?p:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.noRuleDescription",defaultMessage:"There's no description for this rule."});return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.o},i.a.createElement(c.EuiTitle,{size:"xxs"},d?i.a.createElement(c.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},i.a.createElement(c.EuiFlexItem,null,i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleTitle",defaultMessage:"Rule description"}))),h):i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.documentTitle",defaultMessage:"Document description"})))),i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.n},i.a.createElement(te,null,d?v:"-")))};ee.displayName="Description";var te=J()("p").withConfig({displayName:"_StyledP",componentId:"sc-1drpqi-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"]),ae=a(142);const ne=()=>{const{eventId:e,indexName:t,scopeId:a,dataFormattedForFieldBrowser:s,getFieldsData:d}=Object(l.b)(),{isAlert:p}=Object(b.b)(s),m=Object(o.a)(d(ae.s)),{openPreviewPanel:f}=Object(r.d)(),g=Object(n.useCallback)((()=>{f({id:X.b,path:{tab:X.a},params:{id:e,indexName:t,scopeId:a,banner:{title:u.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonPreviewTitle",{defaultMessage:"Preview alert reason"}),backgroundColor:"warning",textColor:"warning"}}})}),[e,f,t,a]),y=Object(n.useMemo)((()=>i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:g,iconSide:"right","data-test-subj":x.S,"aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonButtonAriaLabel",{defaultMessage:"Show full reason"}),disabled:!m},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonButtonLabel",defaultMessage:"Show full reason"})))),[m,g]),h=m||i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.noReasonDescription",defaultMessage:"There's no source event information for this alert."});return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.U},i.a.createElement(c.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,p?i.a.createElement(c.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonTitle",defaultMessage:"Alert reason"}))),y):i.a.createElement("p",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.documentReasonTitle",defaultMessage:"Document reason"}))))),i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.T},p?h:"-"))};ne.displayName="Reason";var ie=a(1305);const re=()=>{const{searchHit:e}=Object(l.b)(),t=Object(n.useMemo)((()=>Object(ie.a)(e)),[e]);return t&&t[0]?i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(c.EuiSpacer,{size:"m"}),i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.Q},i.a.createElement(c.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,t[0].title))),i.a.createElement(c.EuiFlexItem,{"data-test-subj":x.P},t[0].description)):null};re.displayName="MitreAttack";const se=({expanded:e=!0})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.sectionTitle",defaultMessage:"About"}),"data-test-subj":x.a},i.a.createElement(ee,null),i.a.createElement(c.EuiSpacer,{size:"m"}),i.a.createElement(ne,null),i.a.createElement(re,null));se.displayName="AboutSection";var oe=a(216),le=a(920),ce=a(913),ue=a(236);const de=({loading:e=!1,error:t=!1,icon:a,value:n,text:r,color:s,"data-test-subj":o})=>{const{euiTheme:l}=Object(c.useEuiTheme)(),d=`${o}Loading`;if(e)return i.a.createElement(c.EuiSkeletonText,{lines:1,size:"m",isLoading:e,contentAriaLabel:u.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryLoadingAriaLabel",{defaultMessage:"Loading insights for {value}",values:{value:n}}),"data-test-subj":d});if(t)return null;const p=`${o}Icon`,m=`${o}Value`,f=`${o}Color`;return i.a.createElement(c.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(pe,{"data-test-subj":p,"aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryButtonIconAriaLabel",{defaultMessage:"Insight summary row icon"}),color:"text",display:"empty",type:a,size:"m",$_css:l.size.s})),i.a.createElement(me,{"data-test-subj":m},n&&i.a.createElement(ue.a,{count:n})," ",r),s&&i.a.createElement(c.EuiFlexItem,{grow:!1,"data-test-subj":f},i.a.createElement(c.EuiHealth,{color:s})))};de.displayName="InsightsSummaryRow";var pe=J()(c.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-uq3b7l-0"})(["margin:",";"],(e=>e.$_css)),me=J()(c.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-uq3b7l-1"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;"]);const fe=({entityId:e,scopeId:t})=>{const{loading:a,error:n,dataCount:r}=Object(ce.a)({entityId:e,scopeId:t}),s=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sessionAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by session",values:{count:r}});return i.a.createElement(de,{loading:a,error:n,icon:"warning",value:r,text:s,"data-test-subj":x.i,key:`correlation-row-${s}`})};fe.displayName="RelatedAlertsBySession";var be=a(919),ge=a(914);const ye=({originalEventId:e,scopeId:t})=>{const{loading:a,error:n,dataCount:r}=Object(ge.a)({originalEventId:e,scopeId:t}),s=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sourceAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by source event",values:{count:r}});return i.a.createElement(de,{loading:a,error:n,icon:"warning",value:r,text:s,"data-test-subj":x.h,key:`correlation-row-${s}`})};ye.displayName="RelatedAlertsBySameSourceEvent";var he=a(921);const ve=({documentId:e,indices:t,scopeId:a})=>{const{loading:n,error:r,dataCount:s}=Object(he.a)({documentId:e,indices:t,scopeId:a}),o=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.ancestryAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by ancestry",values:{count:s}});return i.a.createElement(de,{loading:n,error:r,icon:"warning",value:s,text:o,"data-test-subj":x.g,key:`correlation-row-${o}`})};ve.displayName="RelatedAlertsByAncestry";var Ee=a(917),xe=a(568);const je=({alertSuppressionCount:e})=>i.a.createElement(c.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(de,{loading:!1,error:!1,icon:"layers",value:e,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.suppressedAlertsLabel",defaultMessage:"suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),"data-test-subj":x.l,key:"correlation-row-suppressed-alerts"})),i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiBetaBadge,{label:xe.w,size:"s",iconType:"beaker",tooltipContent:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.suppressedAlertTechnicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"bottom","data-test-subj":x.k})));je.displayName="SuppressedAlerts";var Se=a(918),Oe=a(915);const ke=({eventId:e})=>{const{loading:t,error:a,dataCount:n}=Object(Oe.a)({eventId:e}),r=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.relatedCasesLabel",defaultMessage:"related {count, plural, one {case} other {cases}}",values:{count:n}});return i.a.createElement(de,{loading:t,error:a,icon:"warning",value:n,text:r,"data-test-subj":x.j,key:`correlation-row-${r}`})};ke.displayName="RelatedCases";var we=a(916),Te=a(959);const Ie=()=>{const{dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:a,indexName:s,getFieldsData:o,scopeId:u,isPreview:d}=Object(l.b)(),{openLeftPanel:p}=Object(r.d)(),m=Object(n.useCallback)((()=>{p({id:O.a,path:{tab:O.c,subTab:Te.a},params:{id:a,indexName:s,scopeId:u}})}),[a,p,s,u]),{show:f,documentId:b,indices:g}=Object(Ee.a)({getFieldsData:o,dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:a,isPreview:d}),{show:y,originalEventId:h}=Object(be.a)({getFieldsData:o}),{show:v,entityId:E}=Object(le.a)({getFieldsData:o}),j=Object(we.a)(),{show:S,alertSuppressionCount:k}=Object(Se.a)({getFieldsData:o}),w=f||y||v||j||S;return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTitle",defaultMessage:"Correlations"}),link:{callback:m,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTooltip",defaultMessage:"Show all correlations"})},iconType:"arrowStart"},"data-test-subj":x.m},w?i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"none"},S&&i.a.createElement(je,{alertSuppressionCount:k}),j&&i.a.createElement(ke,{eventId:a}),y&&h&&i.a.createElement(ye,{originalEventId:h,scopeId:u}),v&&E&&i.a.createElement(fe,{entityId:E,scopeId:u}),f&&b&&g&&i.a.createElement(ve,{documentId:b,indices:g,scopeId:u})):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};Ie.displayName="CorrelationsOverview";var Ce=a(963),Me=a(909);const _e=()=>{const{eventId:e,indexName:t,dataFormattedForFieldBrowser:a,scopeId:s,investigationFields:o}=Object(l.b)(),{openLeftPanel:u}=Object(r.d)(),d=Object(n.useCallback)((()=>{u({id:O.a,path:{tab:O.c,subTab:Me.a},params:{id:e,indexName:t,scopeId:s}})}),[e,u,t,s]),{loading:p,error:m,data:f}=Object(Ce.a)({dataFormattedForFieldBrowser:a,investigationFields:o,interval:{from:"now-30d",to:"now"}}),b=Object(n.useMemo)((()=>f.filter((e=>isFinite(e.hostPrevalence)&&e.hostPrevalence>0&&e.hostPrevalence<.1))),[f]);return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTitle",defaultMessage:"Prevalence"}),link:{callback:d,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTooltip",defaultMessage:"Show all prevalence"})},iconType:"arrowStart"},content:{loading:p,error:m},"data-test-subj":x.R},i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"none"},b.length>0?b.map((e=>i.a.createElement(de,{icon:"warning",text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.rowDescription",defaultMessage:"{field}, {value} is uncommon",values:{field:e.field,value:e.values.toString()}}),"data-test-subj":`${x.R}${e.field}`,key:`${x.R}${e.field}`}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})))};_e.displayName="PrevalenceOverview";var Ae=a(741),Fe=a(962),Pe=a(272),De=a(965);const Ne=()=>{const{eventId:e,indexName:t,scopeId:a,dataFormattedForFieldBrowser:s}=Object(l.b)(),{openLeftPanel:o}=Object(r.d)(),u=Object(n.useCallback)((()=>{o({id:O.a,path:{tab:O.c,subTab:De.a},params:{id:e,indexName:t,scopeId:a}})}),[e,o,t,a]),{loading:d,threatMatchesCount:p,threatEnrichmentsCount:m}=(({dataFormattedForFieldBrowser:e})=>{const{isAlert:t}=Object(b.b)(e),a=Object(n.useMemo)((()=>Object(Ae.b)(e||[])),[e]),i=Object(n.useMemo)((()=>t?Object(Ae.f)(e||[]).map((e=>Object(Ae.g)(e))):[]),[e,t]),{result:r,loading:s}=Object(Fe.c)(a),o=Object(n.useMemo)((()=>s||null==r||!r.enrichments?i:Object(Ae.a)([...i,...r.enrichments])),[s,r,i]),{[Pe.c.IndicatorMatchRule]:l,[Pe.c.InvestigationTime]:c}=Object(Y.groupBy)(o,"matched.type");return{loading:s,threatMatches:l,threatMatchesCount:(l||[]).length,threatEnrichments:c,threatEnrichmentsCount:(c||[]).length}})({dataFormattedForFieldBrowser:s});return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTitle",defaultMessage:"Threat intelligence"}),link:{callback:u,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTooltip",defaultMessage:"Show all threat intelligence"})},iconType:"arrowStart"},"data-test-subj":x.K,content:{loading:d}},i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"none","data-test-subj":`${x.K}Container`},i.a.createElement(de,{icon:"warning",value:p,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatMatchDescription",defaultMessage:"threat {count, plural, one {match} other {matches}} detected",values:{count:p}}),"data-test-subj":x.K}),i.a.createElement(de,{icon:"warning",value:m,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatEnrichmentDescription",defaultMessage:"{count, plural, one {field} other {fields}} enriched with threat intelligence",values:{count:m}}),"data-test-subj":x.K})))};Ne.displayName="ThreatIntelligenceOverview",a(179);var Re=a(45),Le=a(730),Be=a(125),ze=a(126),qe=a(214),$e=a(667),Ve=a(306),Ue=a(121),He=a(147),Qe=a(479),Ge=a(896),We=a(1288),Ze=a(898);const Ke=({hostName:e})=>{const{eventId:t,indexName:a,scopeId:s}=Object(l.b)(),{openLeftPanel:d}=Object(r.d)(),p=Object(n.useCallback)((()=>{d({id:O.a,path:{tab:O.c,subTab:z.a},params:{id:t,indexName:a,scopeId:s}})}),[t,d,a,s]),{from:m,to:f}=Object(He.a)(),{selectedPatterns:b}=Object(Ue.d)(),g=Object(n.useMemo)((()=>({from:m,to:f})),[m,f]),y=Object(n.useMemo)((()=>e?Object(Be.B)([e]):void 0),[e]),{data:h,isAuthorized:v,loading:E}=Object(Qe.c)({filterQuery:y,riskEntity:Be.v.host,skip:null==e,timerange:g}),[j,{hostDetails:S}]=Object(Ge.b)({hostName:e,indexNames:b,startDate:m,endDate:f}),k=Object(n.useMemo)((()=>Object(o.a)(Object(Re.getOr)([],"host.os.family",S))),[S]),w=Object(n.useMemo)((()=>[{title:We.c,description:k?i.a.createElement(V.a,{field:"host.os.family",value:k},k):Object(ze.d)()}]),[k]),T=Object(n.useMemo)((()=>[{title:We.k,description:i.a.createElement(Le.a,{indexPatterns:b,field:"host.name",value:e,type:Le.b.LAST_SEEN})}]),[e,b]),{euiTheme:I}=Object(c.useEuiTheme)(),C=Object(c.useEuiFontSize)("xs").fontSize,[M]=Object(n.useMemo)((()=>{const e=h&&h.length>0?h[0]:void 0;return[{title:i.a.createElement(c.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},We.f),i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(Ze.a,{riskScoreEntity:Be.v.host}))),description:i.a.createElement(i.a.Fragment,null,e?i.a.createElement(Ve.a,{severity:e.host.risk.calculated_level}):Object(ze.d)())}]}),[h]);return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":x.u},i.a.createElement(c.EuiFlexItem,null,i.a.createElement(c.EuiFlexGroup,{gutterSize:"m",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiIcon,{type:"storage"})),i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(Je,{"data-test-subj":x.q,onClick:p,$_css:C,$_css2:I.font.weight.bold},e)))),E||j?i.a.createElement(c.EuiSkeletonText,{"data-test-subj":x.r,contentAriaLabel:u.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.hostLoadingAriaLabel",{defaultMessage:"host overview"})}):i.a.createElement(c.EuiFlexItem,null,i.a.createElement(c.EuiFlexGroup,{responsive:!1},i.a.createElement(c.EuiFlexItem,null,i.a.createElement($e.a,{dataTestSubj:x.s,descriptionList:w})),i.a.createElement(c.EuiFlexItem,null,v?i.a.createElement(qe.d,{"data-test-subj":x.t,listItems:[M]}):i.a.createElement($e.a,{dataTestSubj:x.p,descriptionList:T})))))};Ke.displayName="HostEntityOverview";var Je=J()(c.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-cud8pg-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2)),Ye=a(1286),Xe=a(693);const et=({userName:e})=>{const{eventId:t,indexName:a,scopeId:s}=Object(l.b)(),{openLeftPanel:d}=Object(r.d)(),p=Object(n.useCallback)((()=>{d({id:O.a,path:{tab:O.c,subTab:z.a},params:{id:t,indexName:a,scopeId:s}})}),[t,d,a,s]),{from:m,to:f}=Object(He.a)(),{selectedPatterns:b}=Object(Ue.d)(),g=Object(n.useMemo)((()=>({from:m,to:f})),[m,f]),y=Object(n.useMemo)((()=>e?Object(Be.C)([e]):void 0),[e]),[h,{userDetails:v}]=Object(Xe.b)({endDate:f,userName:e,indexNames:b,startDate:m}),{data:E,isAuthorized:j,loading:S}=Object(Qe.c)({filterQuery:y,riskEntity:Be.v.user,timerange:g}),k=Object(n.useMemo)((()=>Object(o.a)(Object(Re.getOr)([],"user.domain",v))),[v]),w=Object(n.useMemo)((()=>[{title:Ye.h,description:k?i.a.createElement(V.a,{field:"user.domain",value:k},k):Object(ze.d)()}]),[k]),T=Object(n.useMemo)((()=>[{title:Ye.f,description:i.a.createElement(Le.a,{indexPatterns:b,field:"user.name",value:e,type:Le.b.LAST_SEEN})}]),[e,b]),{euiTheme:I}=Object(c.useEuiTheme)(),C=Object(c.useEuiFontSize)("xs").fontSize,[M]=Object(n.useMemo)((()=>{const e=E&&E.length>0?E[0]:void 0;return[{title:i.a.createElement(c.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},Ye.j),i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(Ze.a,{riskScoreEntity:Be.v.user}))),description:i.a.createElement(i.a.Fragment,null,e?i.a.createElement(Ve.a,{severity:e.user.risk.calculated_level}):Object(ze.d)())}]}),[E]);return i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":x.A},i.a.createElement(c.EuiFlexItem,null,i.a.createElement(c.EuiFlexGroup,{gutterSize:"m",responsive:!1},i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(c.EuiIcon,{type:"user"})),i.a.createElement(c.EuiFlexItem,{grow:!1},i.a.createElement(tt,{"data-test-subj":x.x,onClick:p,$_css:C,$_css2:I.font.weight.bold},e)))),i.a.createElement(c.EuiFlexItem,null,h||S?i.a.createElement(c.EuiSkeletonText,{contentAriaLabel:u.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.userLoadingAriaLabel",{defaultMessage:"user overview"}),"data-test-subj":x.y}):i.a.createElement(c.EuiFlexGroup,{responsive:!1},i.a.createElement(c.EuiFlexItem,null,i.a.createElement($e.a,{dataTestSubj:x.v,descriptionList:w})),i.a.createElement(c.EuiFlexItem,null,j?i.a.createElement(qe.d,{"data-test-subj":x.z,listItems:[M]}):i.a.createElement($e.a,{dataTestSubj:x.w,descriptionList:T})))))};var tt=J()(c.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-f1yfvo-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2));const at=()=>{const{eventId:e,getFieldsData:t,indexName:a,scopeId:s}=Object(l.b)(),{openLeftPanel:u}=Object(r.d)(),d=Object(o.a)(t("host.name")),p=Object(o.a)(t("user.name")),m=Object(n.useCallback)((()=>{u({id:O.a,path:{tab:O.c,subTab:z.a},params:{id:e,indexName:a,scopeId:s}})}),[e,u,a,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTitle",defaultMessage:"Entities"}),link:{callback:m,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTooltip",defaultMessage:"Show all entities"})},iconType:"arrowStart"},"data-test-subj":x.I},p||d?i.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},p&&i.a.createElement(i.a.Fragment,null,i.a.createElement(c.EuiFlexItem,null,i.a.createElement(et,{userName:p})),i.a.createElement(c.EuiSpacer,{size:"s"})),d&&i.a.createElement(c.EuiFlexItem,null,i.a.createElement(Ke,{hostName:d}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."})))};at.displayName="EntitiesOverview";const nt=({expanded:e=!1})=>i.a.createElement(A.b,{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.sectionTitle",defaultMessage:"Insights"}),expanded:e,"data-test-subj":x.J},i.a.createElement(at,null),i.a.createElement(c.EuiSpacer,{size:"s"}),i.a.createElement(Ne,null),i.a.createElement(c.EuiSpacer,{size:"s"}),i.a.createElement(Ie,null),i.a.createElement(c.EuiSpacer,{size:"s"}),i.a.createElement(_e,null));nt.displayName="InsightsSection";var it=a(48),rt=a(124),st=a(184),ot=a(929),lt=a(224),ct=a(127),ut=a(14),dt=a(1063);const pt=(e,t,a,n,i)=>{const r=e.find((e=>e.id===t.parent));if(i===n&&r)return{id:"ancestor",label:"...",children:[a],isExpanded:!0};if(n<0||i<0||i>=n||!r)return a;const s={id:r.id,label:r.name,children:[a],isExpanded:!0};return pt(e,r,s,n,i+1)},mt=(e,t,a,n,i)=>{const r=e.filter((e=>e.parent===t.id));if(i===n&&r.length>0)return[{id:"descendant",label:"...",isExpanded:!1}];if(a<0||n<0||i<0||i>=n||!r||0===r.length)return;const s=[];return r.forEach(((t,r)=>{r<a&&s.push({id:t.id,label:t.name,children:mt(e,t,a,n,i+1),isExpanded:!1}),r===a&&s.push({id:"more-child",label:"..."})})),s};var ft=a(313),bt=a(1064);const gt=()=>{var e,t;const[a,r]=Object(n.useState)({}),{dataFormattedForFieldBrowser:s,getFieldsData:d,scopeId:p,eventId:m,isPreview:f}=Object(l.b)(),b=null!==(e=Object(o.a)(d(ft.a)))&&void 0!==e?e:"",g=f?b:m,y=Object(Re.find)({category:"kibana",field:ft.e},s),h=null!==(t=null==y?void 0:y.values)&&void 0!==t?t:[],{statsNodes:v,loading:E,error:j}=Object(bt.a)({isActiveTimeline:Object(ct.isActiveTimeline)(p),documentId:g,indices:h});Object(n.useEffect)((()=>{v&&0!==v.length&&r({statsNodes:v})}),[v,r]);const S=Object(n.useMemo)((()=>{var e;return((e,t=3,a=3,n=3)=>{if(0===e.length)return[];const r=e[0],s={id:r.id,label:i.a.createElement("b",{},r.name),children:mt(e,r,t,n,0),isExpanded:!0,icon:i.a.createElement(c.EuiToken,{iconType:"tokenConstant"})};return[pt(e,r,s,a,0)]})(null!==(e=a.statsNodes)&&void 0!==e?e:[],3,3,3)}),[a.statsNodes]),O=m&&y&&S&&S.length>0&&!j;return E?i.a.createElement(c.EuiSkeletonText,{"data-test-subj":x.b,contentAriaLabel:u.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.loadingAriaLabel",{defaultMessage:"analyzer preview"})}):O?i.a.createElement(c.EuiTreeView,{items:S,display:"compressed","aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.treeViewAriaLabel",{defaultMessage:"Analyzer preview"}),showExpansionArrows:!0,"data-test-subj":x.c}):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.errorDescription",defaultMessage:"An error is preventing this alert from being analyzed."})};gt.displayName="AnalyzerPreview";const yt="timeline-1",ht=()=>{const{dataAsNestedObject:e,isPreview:t}=Object(l.b)(),a=Object(dt.a)(e),r=Object(it.useDispatch)(),{startTransaction:s}=Object(st.b)(),{investigateInTimelineAlertClick:o}=Object(ot.a)({ecsRowData:e}),u=Object(n.useCallback)((()=>{o(),s({name:lt.a.OPEN_ANALYZER});const t=Object(ct.getScopedActions)(yt);t&&e&&r(t.updateGraphEventId({id:yt,graphEventId:e._id})),r(Object(ut.setActiveTabTimeline)({id:yt,activeTab:rt.f.graph}))}),[e,r,o,s]);return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTitle",defaultMessage:"Analyzer preview"}),iconType:"timeline",...a&&!t&&{link:{callback:u,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTooltip",defaultMessage:"Show analyzer graph"})}}},"data-test-subj":x.c},a?i.a.createElement(gt,null):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataDescription",defaultMessage:"You can only visualize events triggered by hosts configured with the Elastic Defend integration or any {sysmon} data from {winlogbeat}. Refer to {link} for more information.",values:{sysmon:i.a.createElement(c.EuiMark,null,"sysmon"),winlogbeat:i.a.createElement(c.EuiMark,null,"winlogbeat"),link:i.a.createElement(c.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/visual-event-analyzer.html",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataLinkText",defaultMessage:"Visual event analyzer"}))}}))};ht.displayName="AnalyzerPreviewContainer";var vt=a(18),Et=a(155);const xt=e=>{const t=Object(o.a)(e("process.entry_leader.user.name")),a=Object(o.a)(e("process.entry_leader.user.id"));return t||(a?"0"===a?"root":`uid: ${a}`:"unknown")};var jt=a(928);const St=({text:e,children:t})=>i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(i.a.Fragment,null,"Â ",i.a.createElement("span",null,e),"Â "),t),Ot=()=>{const{eventId:e,scopeId:t,isPreview:a}=Object(l.b)(),{processName:r,userName:s,startAt:u,ruleName:d,ruleId:p,workdir:m,command:f}=(()=>{const{getFieldsData:e}=Object(l.b)();return Object(n.useMemo)((()=>({userName:xt(e),processName:Object(o.a)(e("process.entry_leader.name")),startAt:Object(o.a)(e("process.entry_leader.start")),ruleName:Object(o.a)(e(ae.G)),ruleId:Object(o.a)(e(ae.V)),workdir:Object(o.a)(e("process.group_leader.working_directory")),command:Object(o.a)(e("process.command_line"))})),[e])})(),{euiTheme:b}=Object(c.useEuiTheme)(),g=Object(n.useMemo)((()=>({fontWeight:b.font.weight.bold})),[b.font.weight.bold]),y=Object(n.useMemo)((()=>r&&i.a.createElement(St,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.processDescription",defaultMessage:"started"})},i.a.createElement("span",{style:g},r))),[g,r]),h=Object(n.useMemo)((()=>u&&i.a.createElement(St,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.timeDescription",defaultMessage:"at"})},i.a.createElement(Et.c,{value:new Date(u)}))),[u]),v=Object(n.useMemo)((()=>d&&p&&i.a.createElement(St,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.ruleDescription",defaultMessage:"with rule"})},i.a.createElement(jt.a,{contextId:t,eventId:e,fieldName:B.n,fieldType:"string",isAggregatable:!1,isDraggable:!1,linkValue:a?null:p,value:d}))),[d,p,t,e,a]),E=Object(n.useMemo)((()=>f&&i.a.createElement(St,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.commandDescription",defaultMessage:"by"})},i.a.createElement(c.EuiCode,null,m," ",f))),[f,m]);return i.a.createElement(kt,{"data-test-subj":x.ab},i.a.createElement(St,null,i.a.createElement(c.EuiIcon,{type:"user"}),"Â ",i.a.createElement("span",{style:g},s)),y,h,v,E)};var kt=J()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-16jqh3v-0"})(["line-height:1.5;"]);const wt="timeline-1",Tt=()=>{const{dataAsNestedObject:e,getFieldsData:t,isPreview:a}=Object(l.b)(),r=(({getFieldsData:e})=>{const t=Object(o.a)(e("_id")),a=Object(o.a)(e("kibana.alert.ancestors.index"))||Object(o.a)(e("_index")),n=Object(o.a)(e("process.entry_leader.entity_id")),i=Object(o.a)(e("process.entry_leader.start")),r=Object(o.a)(e("process.entity_id")),s=Object(o.a)(e("kibana.alert.original_time"))||Object(o.a)(e("timestamp"));return a&&n&&i?{index:a,sessionEntityId:n,sessionStartTime:i,...r&&{jumpToEntityId:r},...s&&{jumpToCursor:s},...t&&{investigatedAlertId:t}}:null})({getFieldsData:t}),s=Object(vt.b)().isEnterprise(),u=r&&s,d=Object(it.useDispatch)(),{startTransaction:p}=Object(st.b)(),m=Object(ct.getScopedActions)(wt),{investigateInTimelineAlertClick:f}=Object(ot.a)({ecsRowData:e}),b=Object(n.useCallback)((()=>{f(),p({name:lt.a.OPEN_SESSION_VIEW}),null!==r&&(d(Object(ut.setActiveTabTimeline)({id:wt,activeTab:rt.f.session})),m&&d(m.updateSessionViewConfig({id:wt,sessionViewConfig:r})))}),[d,f,m,r,p]),{euiTheme:g}=Object(c.useEuiTheme)(),y=s?r?null:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataDescription",defaultMessage:"You can only view Linux session details if youâ€™ve enabled the {setting} setting in your Elastic Defend integration policy. Refer to {link} for more information.",values:{setting:i.a.createElement(It,{$_css:g.font.weight.bold},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataSettingDescription",defaultMessage:"Include session data"})),link:i.a.createElement(c.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/session-view.html#enable-session-view",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataLinkText",defaultMessage:"Enable Session View data"}))}}):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellDescription",defaultMessage:"This feature requires an {subscription}",values:{subscription:i.a.createElement(c.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellLinkText",defaultMessage:"Enterprise subscription"}))}});return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTitle",defaultMessage:"Session viewer preview"}),iconType:"timeline",...u&&!a&&{link:{callback:b,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTooltip",defaultMessage:"Show session viewer"})}}},"data-test-subj":x.ab},u?i.a.createElement(Ot,null):y)};var It=J()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-4u5d2b-0"})(["font-weight:",";"],(e=>e.$_css));const Ct=({expanded:e=!1})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sectionTitle",defaultMessage:"Visualizations"}),"data-test-subj":x.db},i.a.createElement(Tt,null),i.a.createElement(c.EuiSpacer,null),i.a.createElement(ht,null));Ct.displayName="VisualizationsSection";const Mt=Object(n.memo)((()=>i.a.createElement(c.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"none","aria-label":u.i18n.translate("xpack.securitySolution.flyout.right.overview.overviewContentAriaLabel",{defaultMessage:"Alert overview"})},i.a.createElement(se,null),i.a.createElement(c.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Z,null),i.a.createElement(c.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Ct,null),i.a.createElement(c.EuiHorizontalRule,{margin:"m"}),i.a.createElement(nt,null),i.a.createElement(c.EuiHorizontalRule,{margin:"m"}),i.a.createElement(F,null))));Mt.displayName="OverviewTab";var _t=a(1301);const At=[{id:"overview","data-test-subj":C.c,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.overviewTabLabel",defaultMessage:"Overview"}),content:i.a.createElement(Mt,null)},{id:"table","data-test-subj":C.d,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.tableTabLabel",defaultMessage:"Table"}),content:i.a.createElement(_t.a,null)},{id:"json","data-test-subj":C.b,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.jsonTabLabel",defaultMessage:"JSON"}),content:i.a.createElement(M.a,null)}];var Ft=a(55),Pt=a(1273),Dt=a(1121);const Nt=J()("div").withConfig({displayName:"ContainerDiv",componentId:"sc-vi2r7u-0"})([".side-panel-flyout-footer{padding:",";}"],Ft.euiThemeVars.euiPanelPaddingModifiers.paddingMedium),Rt=({isPreview:e})=>{const{closeFlyout:t,openRightPanel:a}=Object(r.d)(),{eventId:s,indexName:o,dataFormattedForFieldBrowser:c,dataAsNestedObject:u,refetchFlyoutData:d,scopeId:p}=Object(l.b)(),{isHostIsolationPanelOpen:m,showHostIsolationPanel:f}=Object(Dt.a)(),b=Object(n.useCallback)((e=>{f(e),a({id:"document-details-isolate-host",params:{id:s,indexName:o,scopeId:p,isolateAction:e}})}),[s,o,a,p,f]);return e?null:i.a.createElement(Nt,null,i.a.createElement(Pt.b,{detailsData:c,detailsEcsData:u,handleOnEventClosed:t,isHostIsolationPanelOpen:m,isReadOnly:!1,loadingEventDetails:!1,onAddIsolationStatusClick:b,scopeId:p,refetchFlyoutData:d}))},Lt="document-details-right",Bt=Object(n.memo)((({path:e})=>{const{openRightPanel:t}=Object(r.d)(),{eventId:a,getFieldsData:c,indexName:u,scopeId:d,isPreview:p}=Object(l.b)(),m=Object(o.a)(c("event.kind"))===s.a.signal,f=m?At:At.filter((e=>"overview"!==e.id)),b=Object(n.useMemo)((()=>{var t;const a=f[0].id;return e&&null!==(t=f.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:a}),[e,f]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{flyoutIsExpandable:m}),i.a.createElement(w.a,{tabs:f,selectedTabId:b,setSelectedTabId:e=>{t({id:Lt,path:{tab:e},params:{id:a,indexName:u,scopeId:d}})}}),i.a.createElement(T.a,{tabs:f,selectedTabId:b}),i.a.createElement(Rt,{isPreview:p}))}));Bt.displayName="RightPanel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return Ot}));var n=a(2),i=a.n(n),r=a(48),s=a(17),o=a(47),l=a(49),c=a(1093),u=a(161),d=a(44),p=a.n(d),m=a(489);function f(e,t,a){return t+(e>1?a*(e-1):0)}var b=a(55);function g(){return Object(n.useMemo)((()=>({copyableFieldBackground:b.euiThemeVars.euiColorLightShade,descriptionText:b.euiThemeVars.euiTextColor,full:b.euiThemeVars.euiColorFullShade,graphControls:b.euiThemeVars.euiColorDarkestShade,graphControlsBackground:b.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:b.euiThemeVars.euiColorLightShade,processBackingFill:`${b.euiThemeVars.euiColorPrimary}${b.darkMode?"1F":"0F"}`,resolverBackground:b.euiThemeVars.euiColorEmptyShade,resolverEdge:b.darkMode?b.euiThemeVars.euiColorLightShade:b.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:b.euiThemeVars.euiColorLightestShade,resolverEdgeText:b.darkMode?b.euiThemeVars.euiColorFullShade:b.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${b.euiThemeVars.euiColorDanger}${b.darkMode?"1F":"0F"}`,pillStroke:b.euiThemeVars.euiColorLightShade,linkColor:b.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${f(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),h=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),v=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:r})=>{const s=Object(m.c)(a,r),l=Object(m.c)(n,r),[c]=r,u=g(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(s,l),b=f(c,10,7.5),v={left:`${s[0]}px`,top:`${s[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(s,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),i.a.createElement(y,{className:e,style:v,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(h,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:b,textColor:u.resolverEdgeText},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=a(5);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:a(513).ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(n.createContext)(x),S=Object(n.memo)(p()(s.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),O=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),k=p()(s.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),w=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),T=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),I=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),C=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],T,I),M=p()(s.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),_=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function A({id:e}){return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function F(e,t,a){const i=A({id:e}),r=g(),s=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.runningProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.loadingCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},errorCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.errorCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.runningTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.terminatedProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.terminatedTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger}})),[i,r]);return"terminated"===t?a?s.terminatedTriggerCube:s[P.processTerminated]:"running"===t?a?s[P.processCausedAlert]:s[P.processRan]:"error"===t?s[P.processError]:s[P.processLoading]}const P={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},D=Object(n.memo)((function({id:e,className:t,size:a="2.15em",state:n,isOrigin:r,"data-test-subj":s}){const{cubeSymbol:o,strokeColor:l}=F(e,n,!1),{processCubeActiveBacking:c}=A({id:e});return i.a.createElement(N,{className:t,width:a,height:a,viewBox:"0 0 34 34","data-test-subj":s,isOrigin:r,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:n}})),r&&i.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:o,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),N=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),R=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))}));var L=a(699);const B=p()(s.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1bgkbkz-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),z=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1bgkbkz-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),q=["fit-content(10em)","auto"],$=p()(s.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1bgkbkz-2"})(["text-transform:uppercase;"]),V=p()(s.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1bgkbkz-3"})(["lineheight:'2.2em';"]),U=p()(s.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1bgkbkz-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),H=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1bgkbkz-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),Q=i.a.memo((({id:e,className:t})=>{const a=Object(r.useDispatch)(),o=Object(r.useSelector)((t=>u.G(t.analyzer[e]))),{timestamp:l}=Object(n.useContext)(j),[c,d]=Object(n.useState)(null),p=g(),m=Object(n.useCallback)((e=>{d(e===c?null:e)}),[d,c]),f=Object(n.useCallback)((()=>d(null)),[]),b=Object(n.useCallback)((t=>{const n=parseFloat(t.target.value);!1===isNaN(n)&&a(Object(L.userSetZoomLevel)({id:e,zoomLevel:n}))}),[a,e]),y=Object(n.useCallback)((()=>{a(Object(L.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[a,e]),h=Object(n.useCallback)((()=>{a(Object(L.userClickedZoomOut)({id:e}))}),[a,e]),v=Object(n.useCallback)((()=>{a(Object(L.userClickedZoomIn)({id:e}))}),[a,e]),[x,S,O,k]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{a(Object(L.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[a,l,e]);return i.a.createElement(H,{className:t,$iconColor:p.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(z,null,i.a.createElement(G,{id:e,closePopover:f,isOpen:"schemaInfo"===c,setActivePopover:m}),i.a.createElement(W,{id:e,closePopover:f,isOpen:"nodeLegend"===c,setActivePopover:m})),i.a.createElement(z,null,i.a.createElement(s.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:x},i.a.createElement(s.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:k},i.a.createElement(s.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:y},i.a.createElement(s.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:S},i.a.createElement(s.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:O},i.a.createElement(s.EuiIcon,{type:"arrowDown"})))),i.a.createElement(s.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:v},i.a.createElement(s.EuiIcon,{type:"plusInCircle"})),i.a.createElement(B,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:o,onChange:b}),i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:h},i.a.createElement(s.EuiIcon,{type:"minusInCircle"})))))})),G=({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{var l,c,d;const p=g(),m=Object(r.useSelector)((t=>u.F(t.analyzer[e]))),f=Object(n.useCallback)((()=>a("schemaInfo")),[a]),b=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),y=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(U,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:b,"aria-label":b,onClick:f,iconType:"iInCircle",$backgroundColor:p.graphControlsBackground,$iconColor:p.graphControls,$borderColor:p.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(s.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement(S,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:q,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(l=null==m?void 0:m.dataSource)&&void 0!==l?l:y)),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(c=null==m?void 0:m.schema.id)&&void 0!==c?c:y)),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(d=null==m?void 0:m.schema.parent)&&void 0!==d?d:y))))))},W=({id:e,closePopover:t,setActivePopover:a,isOpen:r})=>{const o=Object(n.useCallback)((()=>a("nodeLegend")),[a]),l=g(),c=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:o,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:r,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement(S,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:q,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function Z(e,t){return function(e,t){const a=Object(l.useHistory)(),i=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:i}}({search:Object(r.useSelector)((a=>u.D(a.analyzer[e])(t)))})}var K=a(236),J=a(271);const Y=i.a.memo((({id:e,className:t,nodeID:a,nodeStats:r})=>{const s=Object(n.useMemo)((()=>void 0===r?[]:Object.entries(r.byCategory).map((([e,t])=>({prefix:i.a.createElement(K.a,{count:t||0}),category:e})))),[r]);return void 0===s?null:i.a.createElement("ul",{className:`${t} options`,"aria-describedby":a},s.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>i.a.createElement(X,{id:e,pill:t,nodeID:a,key:t.category}))))})),X=({id:e,pill:t,nodeID:a})=>{const s=Z(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:a,eventCategory:t.category}}),{pillStroke:o,resolverBackground:l}=g(),c=Object(n.useMemo)((()=>({border:`1.5px solid ${o}`,backgroundColor:l})),[o,l]),u=Object(r.useDispatch)(),{timestamp:d}=Object(n.useContext)(j),p=Object(n.useCallback)((t=>{s.onClick(t),u(Object(J.userSelectedResolverNode)({id:e,nodeID:a,time:d()}))}),[d,s,u,a,e]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:p},t.prefix," ",t.category))},ee=p()(Y).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),te=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ae=p()(s.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),ne=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ie=p()(s.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var re=a(356),se=a(263),oe=a(408),le=a(444);const ce=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),ue=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),de=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),pe=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),me=i.a.memo((({id:e,className:t,position:a,node:l,nodeID:c,projectionMatrix:d,timeAtRender:p})=>{const b=`resolver:${e}`,y=A({id:e}),{timestamp:h}=Object(n.useContext)(j),[v,x]=Object(m.c)(a,d),[S]=d,O=Object(r.useSelector)((t=>u.a(t.analyzer[e]))),k=Object(r.useSelector)((t=>u.H(t.analyzer[e]))),w=Object(r.useSelector)((t=>u.y(t.analyzer[e]))),T=Object(r.useSelector)((t=>u.x(t.analyzer[e])(c))),I=Object(n.useCallback)((e=>Object(s.htmlIdGenerator)(b)(`${e}:node`)),[b]),C=Object(r.useSelector)((t=>u.c(t.analyzer[e])(c))),M=Object(r.useSelector)((t=>u.b(t.analyzer[e])(p)(c))),_=S>.8,P=S>=.55,D=(_?3.5:P?1:21)*S+5,N=360*(_?-.147413:-.147413-.08*(S-.5))*S,R=120*(_?-.53684:.2*-S*(1-S)/S-.53684)*S,L=Object(n.useMemo)((()=>({left:`${v+N}px`,top:`${x+R}px`,width:360*S+"px",height:120*S+"px"})),[v,S,N,R,x]),B=f(S,18.75,12.5),z=i.a.createRef(),q=g(),$=Object(r.useSelector)((t=>u.v(t.analyzer[e])(c))),V="loading"===$,{backingFill:U,cubeSymbol:H,descriptionText:Q,isLabelFilled:G,labelButtonFill:W,strokeColor:K}=F(e,$,!1),Y=Object(n.useMemo)((()=>Object(s.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),X=c===O,te=c===k,ae=c===w,ne=Object(r.useDispatch)(),ie=Z(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),me=Object(n.useCallback)((()=>{ne(Object(J.userFocusedOnResolverNode)({id:e,nodeID:c,time:h()}))}),[ne,c,h,e]),fe=Object(n.useCallback)((t=>{var a;null!==(a=z.current)&&void 0!==a&&a.beginElement&&z.current.beginElement(),"error"===$?ne(Object(le.userReloadedResolverNode)({id:e,nodeID:c})):(ne(Object(J.userSelectedResolverNode)({id:e,nodeID:c,time:h()})),ie.onClick(t))}),[z,ne,c,ie,$,h,e]),be=Object(r.useSelector)((t=>u.I(t.analyzer[e])(l))),ge=re.c(l),ye=Object(r.useSelector)((t=>oe.a(u.u(t.analyzer[e])(String(l.id))))),he=Object(n.useMemo)((()=>void 0!==ye?se.l(ye):ge),[ye,ge]),ve=Object(n.useMemo)((()=>null===M?void 0:I(M)),[M,I]),Ee=Object(n.useMemo)((()=>I(c)),[I,c]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===C?void 0:C,"aria-flowto":ve,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":X?"true":void 0,"aria-selected":te?"true":void 0,style:L,id:Ee,tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{me(),fe(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(pe,{isNodeLoading:V},i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:U,x:-15.35,y:-15.35,stroke:K,width:22.5,height:22.5,className:"backing"}),ae&&i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:K,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:H,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:z})))),i.a.createElement(ce,{color:q.full,fontSize:B,topPct:D},i.a.createElement(ue,{backgroundColor:q.resolverBackground,color:q.descriptionText,isDisplaying:P,"data-test-subj":"resolver:node:description"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event Â· {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ae,descriptionText:Q}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:fe,onFocus:me,tabIndex:-1,style:{backgroundColor:q.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(s.EuiButton,{iconSide:V?"right":"left",isLoading:V,color:W,fill:G,iconType:"error"===$?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*S,32)}px`,maxWidth:(_?400:210*S)+"px"},tabIndex:-1,title:he,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},i.a.createElement(de,{isShowingIcon:"loading"===$||"error"===$,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:$,nodeName:he}})))),i.a.createElement(s.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:q.resolverBackground,display:_?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(s.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==be&&be>0&&i.a.createElement(ee,{id:e,buttonFill:q.resolverBackground,nodeStats:T,nodeID:c})))))})),fe=p()(me).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var be=a(63);function ge({id:e}){const t=e;return Object(n.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const ye=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),he=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),ve=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Ee=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),xe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),je=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Se=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Oe=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=ge({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:a.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:a.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:a.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),ke=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=A({id:e}),n=ge({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:a.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:a.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ye),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:a.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,he),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:a.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ve),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:a.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Ee),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:a.terminatedProcessCube},i.a.createElement("title",null,xe),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),i.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:a.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,je),t&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!t&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:a.processCubeActiveBacking},i.a.createElement("title",null,Se),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),we=Object(n.memo)((({id:e})=>{const t=Object(be.useUiSetting)("theme:darkMode");return i.a.createElement(Te,null,i.a.createElement("defs",null,i.a.createElement(Oe,{id:e,isDarkMode:t}),i.a.createElement(ke,{id:e,isDarkMode:t})))})),Te=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Ie=a(23),Ce=a.n(Ie);const Me=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:r}=g();return i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{background:a,text:r,breadcrumbs:t,truncate:!1}))})),_e=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function Ae({id:e}){const t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),a=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),r=Z(e,{panelView:"nodes"}),o=Object(n.useMemo)((()=>[{text:a,...r}]),[r,a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:o}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(_e,null,i.a.createElement(s.EuiLoadingSpinner,{size:"m"})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Fe({event:e}){var t,a,n,r,s,l,c,u,d,p,m,f,b,g,y,h,v,E,x;return Object(se.i)(e)?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(se.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(r=n.rule)&&void 0!==r&&r.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(f=e.kibana)||void 0===f||null===(b=f.alert)||void 0===b||null===(g=b.rule)||void 0===g?void 0:g.name)}}):null!==(s=e.file)&&void 0!==s&&s.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(h=e.registry)||void 0===h?void 0:h.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(v=e.registry)||void 0===v?void 0:v.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(se.b)(e)}})}var Pe=a(78),De=a.n(Pe);const Ne=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Re=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Le(e){const t=Object(be.useUiSetting)("dateFormat"),a=Object(be.useUiSetting)("dateFormat:tz"),n="Browser"===a?De.a.tz.guess():a;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?De.a.tz(i,n).format(t):Re.format(i):Ne}var Be=a(325);const ze=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(r.useSelector)((a=>u.g(a.analyzer[e])(t))),l=Object(r.useSelector)((t=>u.p(t.analyzer[e]))),c=Object(r.useSelector)((t=>u.h(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l?i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Ae,{id:e})):i.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!n?i.a.createElement(s.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ve,{id:e,nodeName:n.name,eventCategory:a,nodeID:t}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement($e,{id:e,eventCategory:a,nodeID:t}))))})),qe=Object(n.memo)((function({id:e,event:t,nodeID:a,eventCategory:n}){const r=Object(Be.a)(t),l=se.g(r),c=se.e(r),u=se.p(r),d=Le(l)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),p=Z(e,{panelView:"eventDetail",panelParameters:{nodeID:a,eventCategory:n,eventID:c,eventTimestamp:String(l),winlogRecordID:String(u)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,null,i.a.createElement(M,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:se.d(r).join(", "),eventType:se.h(r).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(_,{dateTime:d},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:d},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiButtonEmpty,Ce()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},p),i.a.createElement(Fe,{event:r})))})),$e=Object(n.memo)((function({id:e,eventCategory:t,nodeID:a}){const l=Object(r.useSelector)((t=>u.w(t.analyzer[e]))),c=Object(r.useDispatch)(),d=Object(n.useCallback)((()=>{c(Object(le.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),p=Object(r.useSelector)((t=>u.o(t.analyzer[e]))),m=Object(r.useSelector)((t=>u.r(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l.map(((r,o)=>i.a.createElement(n.Fragment,{key:o},i.a.createElement(qe,{id:e,nodeID:a,eventCategory:t,event:r}),o===l.length-1?null:i.a.createElement(s.EuiHorizontalRule,{margin:"m"})))),m&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButton,{color:"primary",size:"s",fill:!0,onClick:d,isLoading:p,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Ve=Object(n.memo)((function({id:e,nodeName:t,eventCategory:a,nodeID:n}){const s=Object(r.useSelector)((t=>u.K(t.analyzer[e])(n))),l=Object(r.useSelector)((t=>u.B(t.analyzer[e])(n,a))),c=Z(e,{panelView:"nodes"}),d=Z(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),p=Z(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}});return i.a.createElement(Me,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:s},defaultMessage:"{totalCount} Events"}),...p},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:a},defaultMessage:"{count} {category}"})}]})}));function Ue({id:e,nodeID:t}){const a=Object(r.useSelector)((a=>oe.a(u.u(a.analyzer[e])(t)))),n=Object(r.useSelector)((a=>u.x(a.analyzer[e])(t)));return void 0===a||void 0===n?i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Ae,{id:e})):i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Qe,{id:e,nodeName:se.l(a),nodeID:t,totalEventCount:n.total}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(He,{id:e,nodeID:t,relatedStats:n}))}const He=Object(n.memo)((function({id:e,nodeID:t,relatedStats:a}){const r=Object(n.useMemo)((()=>Object.entries(a.byCategory).map((([e,t])=>({eventType:e,count:t})))),[a.byCategory]),o=Object(n.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:a=>i.a.createElement(Ge,{id:e,nodeID:t,eventType:a},a)}]),[t,e]);return i.a.createElement(s.EuiInMemoryTable,{items:r,columns:o,sorting:!0})})),Qe=Object(n.memo)((function({id:e,nodeID:t,nodeName:a,totalEventCount:n}){return i.a.createElement(Me,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...Z(e,{panelView:"nodes"})},{text:a,...Z(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...Z(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),Ge=Object(n.memo)((({id:e,nodeID:t,eventType:a,children:n})=>{const r=Z(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:a}});return i.a.createElement(s.EuiButtonEmpty,Ce()({"data-test-subj":"resolver:panel:node-events:event-type-link"},r),n)})),We=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-1sthks-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ae,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),Ze=Object(n.memo)((({textToCopy:e,content:t})=>{var a;const{linkColor:r,copyableFieldBackground:o}=g(),[l,c]=Object(n.useState)(!1),u=null===(a=Object(be.useKibana)().services.notifications)||void 0===a?void 0:a.toasts,d=()=>c(!0),p=()=>c(!1),m=Object(n.useMemo)((()=>i.a.createElement(We,{backgroundColor:o,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:r,onMouseEnter:d},t)),[t,o,r]),{writeTextToClipboard:f}=Object(n.useContext)(j),b=Object(n.useCallback)((async()=>{try{await f(e)}catch(e){u&&u.addError(e,{title:E.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,u,f]);return i.a.createElement("div",{onMouseLeave:p},i.a.createElement(s.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},i.a.createElement(s.EuiToolTip,{content:E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},i.a.createElement(s.EuiButtonIcon,{"aria-label":E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:b}))))}));var Ke=a(1094);const Je=Object(n.memo)((function({id:e,translatedErrorMessage:t}){const a=Z(e,{panelView:"nodes"}),r=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...a},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:r}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiButtonEmpty,a,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Ye=p()(D).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),Xe=["fit-content(10em)","auto"],et=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),tt=Object(n.memo)((function({id:e,nodeID:t}){const a=Object(r.useSelector)((a=>oe.a(u.u(a.analyzer[e])(t))));return"loading"===Object(r.useSelector)((a=>u.v(a.analyzer[e])(t)))?i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Ae,{id:e})):a?i.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(at,{id:e,nodeID:t,processEvent:a})):i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Je,{id:e,translatedErrorMessage:et}))})),at=Object(n.memo)((function({id:e,processEvent:t,nodeID:a}){const l=se.l(t),c=Object(r.useSelector)((t=>u.v(t.analyzer[e])(a))),d=Object(r.useSelector)((t=>u.C(t.analyzer[e])(a))),p=Le(se.g(t)),m=Object(n.useMemo)((()=>{const e={title:"@timestamp",description:p},a={title:"process.executable",description:Object(Ke.d)(t)},n={title:"process.pid",description:Object(Ke.c)(t)},r={title:"user.name",description:se.o(t)};return[e,a,n,{title:"process.entity_id",description:se.c(t)},r,{title:"user.domain",description:se.n(t)},{title:"process.parent.pid",description:se.k(t)},{title:"process.hash.md5",description:se.j(t)},{title:"process.args",description:se.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:i.a.createElement(Ze,{textToCopy:String(e.description),content:i.a.createElement(R,null,String(e.description))})})))}),[p,t]),f=Z(e,{panelView:"nodes"}),b=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...f},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,f]),{descriptionText:g}=F(e,c,!1),y=Z(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}}),h=Object(n.useMemo)((()=>Object(s.htmlIdGenerator)("resolverTable")()),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:b}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiTitle,{size:"xs"},i.a.createElement(O,{"aria-describedby":h},i.a.createElement(Ye,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(R,null,l)))),i.a.createElement(s.EuiText,null,i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:h},g))),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiLink,Ce()({},y,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:d},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(S,{"data-test-subj":"resolver:node-detail",type:"column",columnWidths:Xe,align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:m}))})),nt=i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),it=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),rt=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ie,{size:"s",title:i.a.createElement(it,{numberOfEntries:e})},i.a.createElement("p",null,nt))})),st=Object(n.memo)((({id:e})=>{const t=Object(n.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,a)=>i.a.createElement(ot,{id:e,name:t,nodeID:a.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>i.a.createElement(lt,{eventDate:e})}]),[e]),a=Object(r.useSelector)(Object(n.useCallback)((t=>{const{processNodePositions:a}=u.s(t.analyzer[e]),n=[];for(const e of a.keys()){const t=re.c(e),a=re.b(e);void 0!==a&&n.push({name:t,timestamp:re.e(e),nodeID:a})}return n}),[e])),o=a.length,l=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(r.useSelector)((t=>u.k(t.analyzer[e]))),d=Object(r.useSelector)((t=>u.j(t.analyzer[e]))),p=Object(r.useSelector)((t=>u.l(t.analyzer[e]))),m=!0===c||!0===d||!0===p,f=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Me,{breadcrumbs:l}),m&&i.a.createElement(rt,{numberDisplayed:o}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiInMemoryTable,{rowProps:f,"data-test-subj":"resolver:node-list",items:a,columns:t,sorting:!0}))}));function ot({id:e,name:t,nodeID:a}){const o=Object(r.useSelector)((t=>u.y(t.analyzer[e])===a)),l=Object(r.useSelector)((t=>u.v(t.analyzer[e])(a))),{descriptionText:c}=g(),d=Z(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),p=Object(r.useDispatch)(),{timestamp:m}=Object(n.useContext)(j),f=Object(n.useCallback)((t=>{d.onClick(t),p(Object(J.userSelectedResolverNode)({id:e,nodeID:a,time:m()}))}),[m,d,p,a,e]);return i.a.createElement(s.EuiButtonEmpty,{onClick:f,href:d.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":a},void 0===t?i.a.createElement(s.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(w,null,i.a.createElement(D,{id:e,state:l,isOrigin:o,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(C,null,o&&i.a.createElement(T,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(I,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}const lt=Object(n.memo)((({eventDate:e})=>{const t=Le(e);return t?i.a.createElement(Ze,{textToCopy:t,content:t}):i.a.createElement("span",null,"â€”")}));function ct(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...n],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...n,e],value:i[e]})))):null!=i&&a.push([n,i])}return a}const ut=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),dt=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(r.useSelector)((t=>u.n(t.analyzer[e]))),s=Object(r.useSelector)((t=>u.q(t.analyzer[e]))),o=Object(r.useSelector)((a=>oe.a(u.u(a.analyzer[e])(t)))),l=Object(r.useSelector)((a=>u.v(a.analyzer[e])(t))),c=n||s||"loading"===l,d=Object(r.useSelector)((t=>u.d(t.analyzer[e])));return c?i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Ae,{id:e})):d?i.a.createElement(pt,{id:e,nodeID:t,event:d,processEvent:o,eventType:a}):i.a.createElement(ae,{hasBorder:!0},i.a.createElement(Je,{id:e,translatedErrorMessage:ut}))})),pt=Object(n.memo)((function({id:e,nodeID:t,event:a,eventType:n,processEvent:r}){const l=Le(se.m(a))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=r?se.l(r):null;return i.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(ft,{id:e,nodeID:t,nodeName:c,event:a,breadcrumbEventCategory:n}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement(M,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(se.h(a))},defaultMessage:"{category} {eventType}"})),i.a.createElement(_,{dateTime:l},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(bt,null,i.a.createElement(R,null,i.a.createElement(Fe,{event:a}))),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(mt,{event:a}))}));function mt({event:e}){const t=Object(n.useMemo)((()=>{const t=[],a=Object(Be.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a={namespace:i.a.createElement(R,null,e),descriptions:ct(n).map((([t,a])=>{const n=[e,...t].join(".");return{title:i.a.createElement(R,null,n),description:i.a.createElement(Ze,{textToCopy:String(a),content:i.a.createElement(R,null,String(a))})}}))};t.push(a)}return t}),[e]);return i.a.createElement(i.a.Fragment,null,t.map((({namespace:e,descriptions:a},r)=>i.a.createElement(n.Fragment,{key:r},0===r?null:i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiTitle,{size:"xxxs"},i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement(gt,null,e,i.a.createElement(yt,null)))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(S,{type:"column",columnWidths:["fit-content(8em)","auto"],align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:a}),r===t.length-1?null:i.a.createElement(s.EuiSpacer,{size:"m"})))))}function ft({id:e,nodeID:t,nodeName:a,event:s,breadcrumbEventCategory:l}){const c=Object(r.useSelector)((a=>u.B(a.analyzer[e])(t,l))),d=Object(r.useSelector)((a=>u.C(a.analyzer[e])(t))),p=Z(e,{panelView:"nodes"}),m=Z(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),f=Z(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),b=Z(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),g=Object(n.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...p},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:d},defaultMessage:"{totalCount} Events"}),...f},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...b},{text:i.a.createElement(Fe,{event:s})}];return a&&e.splice(1,0,{text:a,...m}),e}),[l,c,s,m,f,a,d,p,b]);return i.a.createElement(Me,{breadcrumbs:g})}const bt=Object(n.memo)(p()(s.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),gt=Object(n.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-1monurs-1"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),yt=Object(n.memo)((()=>i.a.createElement(s.EuiHorizontalRule,{margin:"none",size:"half"}))),ht=Object(n.memo)((function({id:e}){const t=Object(r.useSelector)((t=>u.z(t.analyzer[e])));return"nodeDetail"===t.panelView?i.a.createElement(tt,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?i.a.createElement(Ue,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?i.a.createElement(ze,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?i.a.createElement(dt,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):i.a.createElement(st,{id:e})}));var vt=a(1131);const Et=p()(s.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),xt=p()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),jt=()=>i.a.createElement(xt,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Et,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var St=a(117);const Ot=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m},f){!function(e){const t=Object(n.useRef)();t.current=Object(l.useLocation)().search;const a=Object(l.useHistory)(),i=Object(c.a)(e);Object(n.useEffect)((()=>{const e=i;return()=>{const n=new URLSearchParams(t.current);n.delete(e);const i={search:n.toString()};a.replace(i)}}),[i,a])}(a),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:i,shouldUpdate:s}){const o=Object(r.useDispatch)(),c=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{o(Object(J.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:a,shouldUpdate:s,filters:i}))}),[o,e,t,c,a,s,i])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m}),function({id:e}){const{addSuccess:t}=Object(St.a)(),{from:a,to:i}=Object(r.useSelector)((t=>{const a=u.e(t.analyzer[e]);return{from:null!=a&&a.from?a.from:void 0,to:null!=a&&a.to?a.to:void 0}})),s=Le(a),o=Le(i),l=Object(n.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:s,to:o}})),[s,o]);Object(n.useEffect)((()=>{(a||i)&&t(l)}),[t,l,a,i])}({id:a}),function({id:e}){const t=Object(r.useDispatch)(),a=e,i=Object(l.useLocation)().search,s=Object(n.useContext)(j),o=Object(r.useSelector)((t=>u.H(t.analyzer[e]))),c=Object(r.useSelector)((t=>u.g(t.analyzer[e]))),d=Object(vt.a)({locationSearch:i,resolverComponentInstanceID:a});let p;"nodes"!==d.panelView&&(p=d.panelParameters.nodeID),Object(n.useEffect)((()=>{p&&c(p)&&p!==o&&t(Object(J.userSelectedResolverNode)({id:e,nodeID:p,time:s.timestamp()}))}),[d.panelView,p,t,c,o,s,e])}({id:a});const{timestamp:b}=Object(n.useContext)(j),y=b(),{processNodePositions:h,connectingEdgeLineSegments:x}=Object(r.useSelector)((e=>u.O(e.analyzer[a])(y))),{projectionMatrix:S,ref:O,onMouseDown:k}=function({id:e}){const t=Object(r.useDispatch)(),a=Object(n.useContext)(j),[i,s]=Object(n.useState)(null),o=Object(r.useSelector)(Object(n.useCallback)((t=>u.A(t.analyzer[e])),[e])),l=Object(n.useRef)(),[c,d]=Object(n.useState)(o(a.timestamp())),p=Object(r.useSelector)((t=>u.N(t.analyzer[e]))),m=Object(r.useSelector)((t=>u.m(t.analyzer[e]))),[f,b]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(j),[t,a]=Object(n.useState)(null),{ResizeObserver:i,requestAnimationFrame:r}=Object(n.useContext)(j),[s,o]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{o(e)}),[]);return Object(n.useEffect)((()=>{null!==s&&a(e(s))}),[s,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const i=()=>{r((()=>{const i=window.scrollX,r=window.scrollY;null===s||t===i&&n===r||a(e(s)),t=i,n=r}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[s,r,e]),Object(n.useEffect)((()=>{if(null!==s){const t=new i((t=>{null!==s&&s===t[0].target&&a(e(s))}));return t.observe(s),()=>{t.disconnect()}}}),[i,s,e]),[t,l]}(),g=Object(n.useCallback)((e=>null===f?null:[e.clientX-f.x,e.clientY-f.y]),[f]),y=Object(n.useCallback)((n=>{const i=g(n);null!==i&&t(Object(L.userStartedPanning)({id:e,screenCoordinates:i,time:a.timestamp()}))}),[t,g,a,e]),h=Object(n.useCallback)((n=>{const i=g(n);i&&t(Object(L.userMovedPointer)({id:e,screenCoordinates:i,time:a.timestamp()}))}),[t,g,a,e]),v=Object(n.useCallback)((()=>{p&&t(Object(L.userStoppedPanning)({id:e,time:a.timestamp()}))}),[t,a,p,e]),E=Object(n.useCallback)((n=>{null!==f&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),t(Object(L.userZoomed)({id:e,zoomChange:n.deltaY/-f.height,time:a.timestamp()})))}),[f,t,a,e]),x=Object(n.useCallback)((e=>{s(e),b(e)}),[b]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",v,{passive:!0}),()=>{window.removeEventListener("mouseup",v)})),[v]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",h,{passive:!0}),()=>{window.removeEventListener("mousemove",h)})),[h]),Object(n.useEffect)((()=>{if(null!==i)return i.addEventListener("wheel",E),()=>{i.removeEventListener("wheel",E)}}),[i,E]),Object(n.useLayoutEffect)((()=>{l.current=o}),[o]),Object(n.useLayoutEffect)((()=>{d(o(a.timestamp()))}),[o,a]),Object(n.useLayoutEffect)((()=>{const e=a.timestamp();if(m(e)){let e=null;const t=()=>{const n=a.timestamp();void 0!==l.current&&d(l.current(n)),e=m(n)?a.requestAnimationFrame(t):null};return e=a.requestAnimationFrame(t),()=>{null!==e&&a.cancelAnimationFrame(e)}}}),[m,a]),Object(n.useEffect)((()=>{null!==f&&t(Object(L.userSetRasterSize)({id:e,dimensions:[f.width,f.height]}))}),[t,f,e]),{ref:x,onMouseDown:y,projectionMatrix:c}}({id:a}),w=Object(n.useCallback)((e=>{O(e),"function"==typeof f?f(e):null!==f&&(f.current=e)}),[O,f]),T=Object(r.useSelector)((e=>u.q(e.analyzer[a]))),I=Object(r.useSelector)((e=>u.i(e.analyzer[a]))),C=Object(r.useSelector)((e=>u.a(e.analyzer[a]))),M=Object(r.useSelector)((e=>u.E(e.analyzer[a]))),_=g();return i.a.createElement(te,{className:e,backgroundColor:_.resolverBackground},T?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"})):I?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):M?i.a.createElement(i.a.Fragment,null,i.a.createElement(ne,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:k,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},x.map((({points:[e,t],metadata:a})=>i.a.createElement(v,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:S}))),[...h].map((([e,t])=>{const n=re.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return i.a.createElement(fe,{id:a,key:n,nodeID:n,position:t,projectionMatrix:S,node:e,timeAtRender:y})}))),i.a.createElement(ht,{id:a})):i.a.createElement(jt,null),i.a.createElement(Q,{id:a}),i.a.createElement(we,{id:a}))})))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return J})),a.d(t,"b",(function(){return Y}));var n=a(2),i=a.n(n),r=a(17),s=a(47),o=a(183),l=a(277),c=a(180),u=a(142),d=a(5);const p=({tooltip:e,anchorPosition:t="top",children:a})=>i.a.createElement(r.EuiToolTip,{content:e,position:t},a);var m=a(567),f=a(50),b=a(9),g=a(110),y=a(19);const h=[5,10,20],v={pageIndex:0,pageSize:h[0]},E=(e,t)=>t,x={sort:{field:"@timestamp",direction:"desc"},enableAllColumns:!0},j=(e,t)=>({...e,sort:t}),S=e=>{const{setPagination:t,pagination:a,pageSizeOptions:i}=(()=>{const[e,t]=Object(n.useReducer)(E,v);return Object(n.useMemo)((()=>({pageSizeOptions:[...h],pagination:e,setPagination:t})),[e])})(),{sorting:r,sortConfig:s,setSorting:o}=(()=>{const[e,t]=Object(n.useReducer)(j,x),a=Object(n.useMemo)((()=>[{[e.sort.field]:e.sort.direction}]),[e.sort.direction,e.sort.field]);return{sorting:e,setSorting:t,sortConfig:a}})(),{data:l,totalItemCount:c,loading:u,error:d}=(({alertIds:e,from:t,size:a,sort:i})=>{const{services:{data:r}}=Object(g.i)(),s=Object(n.useMemo)((()=>{return e=r.search,async({signal:t,alertIds:a,from:n,size:i,sort:r})=>new Promise(((s,o)=>{const l=e.search({params:{body:{query:{ids:{values:a}},from:n,size:i,sort:r,fields:["*"],_source:!1}}},{abortSignal:t}).subscribe({next:e=>{Object(y.isRunningResponse)(e)||(l.unsubscribe(),s(e.rawResponse))},error:e=>{l.unsubscribe(),o(new Error("Error while loading alerts"))}})}));var e}),[r.search]),{data:o,isLoading:l,isError:c}=Object(f.useQuery)(["useFetchAlerts",e,t,a,i],(async({signal:n})=>s({signal:n,alertIds:e,from:t,size:a,sort:i})),{keepPreviousData:!0});return Object(n.useMemo)((()=>{var e,t;const a=null==o||null===(e=o.hits)||void 0===e?void 0:e.total;return{loading:l,error:c,data:(null==o||null===(t=o.hits)||void 0===t?void 0:t.hits)||[],totalItemCount:Object(b.isNumber)(a)?a:0}}),[o,c,l])})({alertIds:e,from:a.pageIndex*a.pageSize,size:a.pageSize,sort:s});return{paginationConfig:Object(n.useMemo)((()=>({...a,pageSizeOptions:i,totalItemCount:c})),[i,a,c]),setPagination:t,setSorting:o,loading:u,data:l,sorting:r,error:d}};var O=a(216),k=a(379),w=a(197),T=a(670);const I=[{field:"@timestamp",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.timestampColumnLabel",defaultMessage:"Timestamp"}),truncateText:!0,dataType:"date",render:e=>{const t=Object(r.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS");return i.a.createElement(p,{tooltip:t},i.a.createElement("span",null,t))}},{field:u.G,name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ruleColumnLabel",defaultMessage:"Rule"}),truncateText:!0,render:e=>i.a.createElement(p,{tooltip:e},i.a.createElement("span",null,e))},{field:u.s,name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.reasonColumnLabel",defaultMessage:"Reason"}),truncateText:!0,render:e=>i.a.createElement(p,{tooltip:e,anchorPosition:"left"},i.a.createElement("span",null,e))},{field:"kibana.alert.severity",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.severityColumnLabel",defaultMessage:"Severity"}),truncateText:!0,render:e=>{const t=l.h.decode(e),a=Object(c.isRight)(t)?i.a.createElement(m.a,{value:t.right}):i.a.createElement("p",null,e);return i.a.createElement(p,{tooltip:e},a)}}],C=({title:e,loading:t,alertIds:a,scopeId:s,eventId:o,noItemsMessage:l,"data-test-subj":c})=>{const{setPagination:u,setSorting:d,data:p,loading:m,paginationConfig:f,sorting:b,error:g}=S(a||[]),y=Object(n.useCallback)((({page:e,sort:t})=>{if(e){const{index:t,size:a}=e;u({pageIndex:t,pageSize:a})}t&&d(t)}),[u,d]),h=Object(n.useMemo)((()=>p.map((e=>e.fields)).map(((e={})=>Object.keys(e).reduce(((t,a)=>{var n;return t[a]=(null==e||null===(n=e[a])||void 0===n?void 0:n[0])||(null==e?void 0:e[a]),t}),{})))),[p]),v=Boolean(a&&a.length&&a.length>=5),E=Object(n.useMemo)((()=>v?null:_(s,o,a)),[a,v,s,o]),x=Object(n.useMemo)((()=>v?M(a):null),[a,v]);return i.a.createElement(O.a,{header:{title:e,iconType:"warning",headerContent:a&&a.length&&a.length>0?i.a.createElement("div",{"data-test-subj":`${c}InvestigateInTimeline`},i.a.createElement(k.a,{dataProviders:E,filters:x,asEmptyButton:!0,iconType:"timeline"},w.i)):null},content:{error:g},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":c},i.a.createElement(r.EuiBasicTable,{"data-test-subj":`${c}Table`,loading:t||m,items:h,columns:I,pagination:f,sorting:b,onChange:y,noItemsMessage:l}))},M=e=>e&&e.length?[{meta:{alias:d.i18n.translate("xpack.securitySolution.flyout.left.insights.correlations.tableFilterLabel",{defaultMessage:"Correlations Details Table Alert IDs."}),type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null,_=(e,t,a)=>a&&a.length?a.reduce(((a,n,i)=>{const r=`${e}-${t}-event.id-${i}-${n}`;return a.push(Object(T.a)("_id",r,n)),a}),[]):null;var A=a(913);const F=({entityId:e,scopeId:t,eventId:a})=>{const{loading:n,error:r,data:l,dataCount:c}=Object(A.a)({entityId:e,scopeId:t});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by session",values:{count:c}}),loading:n,alertIds:l,scopeId:t,eventId:a,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsNoDataDescription",defaultMessage:"No alerts related by session."}),"data-test-subj":o.c})};F.displayName="RelatedAlertsBySession";var P=a(914);const D=({originalEventId:e,scopeId:t,eventId:a})=>{const{loading:n,error:r,data:l,dataCount:c}=Object(P.a)({originalEventId:e,scopeId:t});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by source event",values:{count:c}}),loading:n,alertIds:l,scopeId:t,eventId:a,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsNoDataDescription",defaultMessage:"No related source events."}),"data-test-subj":o.d})};D.displayName="RelatedAlertsBySameSourceEvent";var N=a(137),R=a(915);const L=[{field:"title",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.nameColumnLabel",defaultMessage:"Name"}),render:(e,t)=>i.a.createElement(p,{tooltip:t.title},i.a.createElement(N.a,{detailName:t.id,title:t.title},t.title))},{field:"status",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.statusColumnLabel",defaultMessage:"Status"}),truncateText:!0,width:"25%"}],B=({eventId:e})=>{const{loading:t,error:a,data:n,dataCount:l}=Object(R.a)({eventId:e});return a?null:i.a.createElement(O.a,{header:{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesTitle",defaultMessage:"{count} related {count, plural, one {case} other {cases}}",values:{count:l}}),iconType:"warning"},content:{error:a},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":o.f},i.a.createElement(r.EuiInMemoryTable,{loading:t,items:n,columns:L,pagination:!0,message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesNoDataDescription",defaultMessage:"No related cases."}),"data-test-subj":o.e}))};B.displayName="RelatedCases";var z=a(916),q=a(917),$=a(918),V=a(201),U=a(919),H=a(920),Q=a(921);const G=({documentId:e,indices:t,scopeId:a})=>{const{loading:n,error:r,data:l,dataCount:c}=Object(Q.a)({documentId:e,indices:t,scopeId:a});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by ancestry",values:{count:c}}),loading:n,alertIds:l,scopeId:a,eventId:e,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsNoDataDescription",defaultMessage:"No alerts related by ancestry."}),"data-test-subj":o.b})};G.displayName="RelatedAlertsByAncestry";var W=a(568),Z=a(1290);const K=({dataAsNestedObject:e,alertSuppressionCount:t})=>{const a=i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.suppressedAlertsTitle",defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:t}})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiBetaBadge,{label:W.w,style:{verticalAlign:"middle"},size:"s","data-test-subj":o.A}))),n=t>0&&i.a.createElement("div",{"data-test-subj":`${o.g}InvestigateInTimeline`},i.a.createElement(Z.a,{ecsRowData:e,buttonType:"emptyButton"}));return i.a.createElement(O.a,{header:{title:a,iconType:"layers",headerContent:n},"data-test-subj":o.g})};K.displayName="SuppressedAlerts";const J="correlations-details",Y=()=>{const{dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:a,getFieldsData:n,scopeId:l,isPreview:c}=Object(V.b)(),{show:u,indices:d,documentId:p}=Object(q.a)({getFieldsData:n,dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:a,isPreview:c}),{show:m,originalEventId:f}=Object(U.a)({getFieldsData:n}),{show:b,entityId:g}=Object(H.a)({getFieldsData:n}),y=Object(z.a)(),{show:h,alertSuppressionCount:v}=Object($.a)({getFieldsData:n}),E=u||m||b||y||h;return i.a.createElement(r.EuiPanel,{paddingSize:"none","data-test-subj":o.h,color:"transparent"},E?i.a.createElement(r.EuiFlexGroup,{gutterSize:"l",direction:"column"},h&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(K,{alertSuppressionCount:v,dataAsNestedObject:e})),y&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(B,{eventId:a})),m&&f&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(D,{originalEventId:f,scopeId:l,eventId:a})),b&&g&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(F,{entityId:g,scopeId:l,eventId:a})),u&&p&&d&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(G,{indices:d,scopeId:l,documentId:p}))):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};Y.displayName="CorrelationsDetails"},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(2),i=a(910),r=a(912),s=a(53),o=a(50),l=a(110),c=a(866),u=a(127),d=a(116);const p="fieldNames",m="eventKind",f="hostName",b="userName",g="hosts",y="users",h=(e,t,a,n)=>{const i=Object(s.buildEsQuery)(void 0,[],[{query:{bool:{filter:[{range:{"@timestamp":{gte:t,lte:a}}}]}},meta:{}}]);return v(i,e,n)},v=(e,t,a)=>({params:{index:a,body:{query:e,aggs:{[p]:{filters:{filters:t},aggs:{[f]:{cardinality:{field:"host.name"}},[b]:{cardinality:{field:"user.name"}},[m]:{terms:{field:"event.kind",size:10}}}},[g]:{cardinality:{field:"host.name"}},[y]:{cardinality:{field:"user.name"}}},size:0}}});var E=a(900);const x=({interval:e,dataFormattedForFieldBrowser:t,investigationFields:a})=>{const s=Object(i.a)({dataFormattedForFieldBrowser:t,investigationFields:a}),v=Object(n.useMemo)((()=>Object(r.a)(s)),[s]),{data:x,loading:j,error:S}=(({highlightedFieldsFilters:e,interval:{from:t,to:a}})=>{const{services:{data:{search:n}}}=Object(l.i)(),{selectedPatterns:i}=Object(c.a)(Object(u.isActiveTimeline)(d.SourcererScopeName.default)),r=h(e,t,a,i),{data:s,isLoading:p,isError:m}=Object(o.useQuery)(["useFetchFieldValuePairWithAggregation",e,t,a],(()=>(async(e,t)=>{let a;return new Promise(((n,i)=>{e.search(t).subscribe({next:e=>{a=e.rawResponse},complete:()=>{n(a)},error:e=>{i(e)}})}))})(n,r)));return{loading:p,error:m,data:s}})({highlightedFieldsFilters:v,interval:e}),O=[];if(x&&x.aggregations){const e=x.aggregations[g].value,t=x.aggregations[y].value;Object.keys(x.aggregations[p].buckets).forEach((a=>{var n;const i=s[a].values,r=(null===(n=x.aggregations[p].buckets[a][m].buckets.find((e=>e.key===E.a.signal)))||void 0===n?void 0:n.doc_count)||0;let o=0;x.aggregations[p].buckets[a][m].buckets.reduce(((e,t)=>(t.key!==E.a.signal&&(o+=t.doc_count),e)),o);const l=x.aggregations[p].buckets[a][f].value,c=x.aggregations[p].buckets[a][b].value,u=e?l/e:0,d=t?c/t:0;O.push({field:a,values:i,alertCount:r,docCount:o,hostPrevalence:u,userPrevalence:d})}))}return{loading:j,error:S,data:O}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return d}));var n=a(169);const i="included",r=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},s=(e,t)=>({field:e,value:t,type:"match",operator:i}),o=(e,t)=>({field:e,value:t,type:"match_any",operator:i}),l=(e,t=!1)=>{const a=[];return e.forEach((e=>{if(e.field.includes(n.b.HASH))(function(e,t){const a=[];if(!Array.isArray(t.value)){const i=s(`${e}${n.b.HASH}${r(t.value)}`,t.value.toLowerCase());return a.push(i),a}const i=t.value.reduce(((e,t)=>{const a=r(t);return a?{...e,[a]:[...e[a],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const r=o(`${e}${n.b.HASH}${t}`,i.map((e=>e.toLowerCase())));a.push(r)})),a})(e.field.split(".")[0],e).forEach((e=>a.push(e)));else if(e.field.includes(n.b.SIGNER)){const n=function(e,t,a=!1){const n=Array.isArray(t)?o("subject_name",t):s("subject_name",t),i=[];return a&&i.push(s("trusted","true")),i.push(n),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);a.push(n)}else if((e.field.includes(n.b.EXECUTABLE)||e.field.includes(n.b.PATH))&&"wildcard"===e.type){const t=(l=e.field,c=e.value,Array.isArray(c)?o(l,c):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(l,c));a.push(t)}else{const t=function(e,t){return Array.isArray(t)?o(e,t):s(e,t)}(e.field,e.value);a.push(t)}var l,c})),a},c=(e,t,a)=>({field:e,value:a,type:t,operator:i});function u(e){return`${e.split(".")[0]}${n.b.HASH}*`}const d=e=>{const t=(e=>e.reduce(((e,t)=>{const a=t.field;if(a.includes(n.b.HASH)&&"match"===t.type){const n=u(a);return{...e,[n]:c(n,t.type,t.value)}}if(a.includes(n.b.HASH)&&"match_any"===t.type){var i,r;const n=u(a),s=null!==(i=null===(r=e[n])||void 0===r?void 0:r.value)&&void 0!==i?i:[];return{...e,[n]:c(n,t.type,[...s,...t.value])}}if((a.includes(n.b.EXECUTABLE)||a.includes(n.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[a]:c(a,t.type,t.value)};if(a.includes(n.b.SIGNER)&&"nested"===t.type){const n=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(n)return{...e,[a]:c(a,n.type,n.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j}));var n=a(2),i=a.n(n),r=a(17),s=a(1151),o=a.n(s),l=a(1289),c=a(1323),u=a(211),d=a(741),p=a(4),m=a(116),f=a(962),b=a(1135),g=a(121),y=a(202),h=a(201),v=a(183),E=a(394);const x="threat-intelligence-details",j=()=>{const{enrichments:e,eventFields:t,isEnrichmentsLoading:a,isEventDataLoading:s,isLoading:x,range:j,setRange:S}=(()=>{const{indexName:e,eventId:t}=Object(h.b)(),[{pageName:a}]=Object(y.a)(),i=a===p.yc.detections?m.SourcererScopeName.detections:m.SourcererScopeName.default,r=Object(g.d)(i),[s,o]=Object(b.a)({indexName:e,eventId:t,runtimeMappings:r.runtimeMappings,skip:!t}),{isAlert:l}=Object(u.b)(o),c=Object(n.useMemo)((()=>o||[]),[o]),v=Object(n.useMemo)((()=>Object(d.b)(c||[])),[c]),{result:E,loading:x,setRange:j,range:S}=Object(f.c)(v),O=Object(n.useMemo)((()=>l?Object(d.f)(c).map((e=>Object(d.g)(e))):[]),[c,l]);return{enrichments:Object(n.useMemo)((()=>x||null==E||!E.enrichments?O:Object(d.a)([...O,...E.enrichments])),[x,E,O]),eventFields:v,isEnrichmentsLoading:x,isEventDataLoading:s,isLoading:x||s,range:S,setRange:j}})();return s?i.a.createElement(E.a,{"data-test-subj":v.B}):i.a.createElement(c.a,{before:null,loading:x,enrichments:e,showInvestigationTimeEnrichments:!o()(t)},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{setRange:S,loading:a,range:j}),i.a.createElement(r.EuiSpacer,{size:"m"})))};j.displayName="ThreatIntelligenceDetails"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(9);const i=e=>{const{id:t,revision:a,created_by:i,created_at:r,updated_by:s,updated_at:o,...l}=e,c=Object(n.cloneDeep)(l),u=c.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),c}},function(e,t,a){e.exports=a(24)(191)},function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,a){"use strict";var n="%[a-f0-9]{2}",i=new RegExp("("+n+")|([^%]+?)","gi"),r=new RegExp("("+n+")+","gi");function s(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],s(a),s(n))}function o(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(i)||[],a=1;a<t.length;a++)t=(e=s(t,a).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},a=r.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var n=o(a[0]);n!==a[0]&&(t[a[0]]=n)}a=r.exec(e)}t["%C2"]="ï¿½";for(var i=Object.keys(t),s=0;s<i.length;s++){var l=i[s];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],n=0;n<e.rangeCount;n++)a.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||a.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},,function(e,t,a){"use strict";const n=a(974),i={codes:new Map([[100,"Continue"],[101,"Switching Protocols"],[102,"Processing"],[200,"OK"],[201,"Created"],[202,"Accepted"],[203,"Non-Authoritative Information"],[204,"No Content"],[205,"Reset Content"],[206,"Partial Content"],[207,"Multi-Status"],[300,"Multiple Choices"],[301,"Moved Permanently"],[302,"Moved Temporarily"],[303,"See Other"],[304,"Not Modified"],[305,"Use Proxy"],[307,"Temporary Redirect"],[400,"Bad Request"],[401,"Unauthorized"],[402,"Payment Required"],[403,"Forbidden"],[404,"Not Found"],[405,"Method Not Allowed"],[406,"Not Acceptable"],[407,"Proxy Authentication Required"],[408,"Request Time-out"],[409,"Conflict"],[410,"Gone"],[411,"Length Required"],[412,"Precondition Failed"],[413,"Request Entity Too Large"],[414,"Request-URI Too Large"],[415,"Unsupported Media Type"],[416,"Requested Range Not Satisfiable"],[417,"Expectation Failed"],[418,"I'm a teapot"],[422,"Unprocessable Entity"],[423,"Locked"],[424,"Failed Dependency"],[425,"Too Early"],[426,"Upgrade Required"],[428,"Precondition Required"],[429,"Too Many Requests"],[431,"Request Header Fields Too Large"],[451,"Unavailable For Legal Reasons"],[500,"Internal Server Error"],[501,"Not Implemented"],[502,"Bad Gateway"],[503,"Service Unavailable"],[504,"Gateway Time-out"],[505,"HTTP Version Not Supported"],[506,"Variant Also Negotiates"],[507,"Insufficient Storage"],[509,"Bandwidth Limit Exceeded"],[510,"Not Extended"],[511,"Network Authentication Required"]])};t.Boom=class extends Error{constructor(e,a={}){if(e instanceof Error)return t.boomify(n.clone(e),a);const{statusCode:r=500,data:s=null,ctor:o=t.Boom}=a,l=new Error(e||void 0);Error.captureStackTrace(l,o),l.data=s;const c=i.initialize(l,r);return Object.defineProperty(c,"typeof",{value:o}),a.decorate&&Object.assign(c,a.decorate),c}static[Symbol.hasInstance](e){return this===t.Boom?t.isBoom(e):this.prototype.isPrototypeOf(e)}},t.isBoom=function(e,t){return e instanceof Error&&!!e.isBoom&&(!t||e.output.statusCode===t)},t.boomify=function(e,t){return n.assert(e instanceof Error,"Cannot wrap non-Error object"),void 0!==(t=t||{}).data&&(e.data=t.data),t.decorate&&Object.assign(e,t.decorate),e.isBoom?!1===t.override||!t.statusCode&&!t.message?e:i.initialize(e,t.statusCode||e.output.statusCode,t.message):i.initialize(e,t.statusCode||500,t.message)},t.badRequest=function(e,a){return new t.Boom(e,{statusCode:400,data:a,ctor:t.badRequest})},t.unauthorized=function(e,a,i){const r=new t.Boom(e,{statusCode:401,ctor:t.unauthorized});if(!a)return r;if("string"!=typeof a)return r.output.headers["WWW-Authenticate"]=a.join(", "),r;let s=`${a}`;return(i||e)&&(r.output.payload.attributes={}),i&&("string"==typeof i?(s+=" "+n.escapeHeaderAttribute(i),r.output.payload.attributes=i):s+=" "+Object.keys(i).map((e=>{let t=i[e];return null==t&&(t=""),r.output.payload.attributes[e]=t,`${e}="${n.escapeHeaderAttribute(t.toString())}"`})).join(", ")),e?(i&&(s+=","),s+=` error="${n.escapeHeaderAttribute(e)}"`,r.output.payload.attributes.error=e):r.isMissing=!0,r.output.headers["WWW-Authenticate"]=s,r},t.paymentRequired=function(e,a){return new t.Boom(e,{statusCode:402,data:a,ctor:t.paymentRequired})},t.forbidden=function(e,a){return new t.Boom(e,{statusCode:403,data:a,ctor:t.forbidden})},t.notFound=function(e,a){return new t.Boom(e,{statusCode:404,data:a,ctor:t.notFound})},t.methodNotAllowed=function(e,a,n){const i=new t.Boom(e,{statusCode:405,data:a,ctor:t.methodNotAllowed});return"string"==typeof n&&(n=[n]),Array.isArray(n)&&(i.output.headers.Allow=n.join(", ")),i},t.notAcceptable=function(e,a){return new t.Boom(e,{statusCode:406,data:a,ctor:t.notAcceptable})},t.proxyAuthRequired=function(e,a){return new t.Boom(e,{statusCode:407,data:a,ctor:t.proxyAuthRequired})},t.clientTimeout=function(e,a){return new t.Boom(e,{statusCode:408,data:a,ctor:t.clientTimeout})},t.conflict=function(e,a){return new t.Boom(e,{statusCode:409,data:a,ctor:t.conflict})},t.resourceGone=function(e,a){return new t.Boom(e,{statusCode:410,data:a,ctor:t.resourceGone})},t.lengthRequired=function(e,a){return new t.Boom(e,{statusCode:411,data:a,ctor:t.lengthRequired})},t.preconditionFailed=function(e,a){return new t.Boom(e,{statusCode:412,data:a,ctor:t.preconditionFailed})},t.entityTooLarge=function(e,a){return new t.Boom(e,{statusCode:413,data:a,ctor:t.entityTooLarge})},t.uriTooLong=function(e,a){return new t.Boom(e,{statusCode:414,data:a,ctor:t.uriTooLong})},t.unsupportedMediaType=function(e,a){return new t.Boom(e,{statusCode:415,data:a,ctor:t.unsupportedMediaType})},t.rangeNotSatisfiable=function(e,a){return new t.Boom(e,{statusCode:416,data:a,ctor:t.rangeNotSatisfiable})},t.expectationFailed=function(e,a){return new t.Boom(e,{statusCode:417,data:a,ctor:t.expectationFailed})},t.teapot=function(e,a){return new t.Boom(e,{statusCode:418,data:a,ctor:t.teapot})},t.badData=function(e,a){return new t.Boom(e,{statusCode:422,data:a,ctor:t.badData})},t.locked=function(e,a){return new t.Boom(e,{statusCode:423,data:a,ctor:t.locked})},t.failedDependency=function(e,a){return new t.Boom(e,{statusCode:424,data:a,ctor:t.failedDependency})},t.tooEarly=function(e,a){return new t.Boom(e,{statusCode:425,data:a,ctor:t.tooEarly})},t.preconditionRequired=function(e,a){return new t.Boom(e,{statusCode:428,data:a,ctor:t.preconditionRequired})},t.tooManyRequests=function(e,a){return new t.Boom(e,{statusCode:429,data:a,ctor:t.tooManyRequests})},t.illegal=function(e,a){return new t.Boom(e,{statusCode:451,data:a,ctor:t.illegal})},t.internal=function(e,a,n=500){return i.serverError(e,a,n,t.internal)},t.notImplemented=function(e,a){return i.serverError(e,a,501,t.notImplemented)},t.badGateway=function(e,a){return i.serverError(e,a,502,t.badGateway)},t.serverUnavailable=function(e,a){return i.serverError(e,a,503,t.serverUnavailable)},t.gatewayTimeout=function(e,a){return i.serverError(e,a,504,t.gatewayTimeout)},t.badImplementation=function(e,a){const n=i.serverError(e,a,500,t.badImplementation);return n.isDeveloperError=!0,n},i.initialize=function(e,t,a){const r=parseInt(t,10);if(n.assert(!isNaN(r)&&r>=400,"First argument must be a number (400+):",t),e.isBoom=!0,e.isServer=r>=500,e.hasOwnProperty("data")||(e.data=null),e.output={statusCode:r,payload:{},headers:{}},Object.defineProperty(e,"reformat",{value:i.reformat,configurable:!0}),a||e.message||(e.reformat(),a=e.output.payload.error),a){const t=Object.getOwnPropertyDescriptor(e,"message")||Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"message");n.assert(!t||t.configurable&&!t.get,"The error is not compatible with boom"),e.message=a+(e.message?": "+e.message:""),e.output.payload.message=e.message}return e.reformat(),e},i.reformat=function(e=!1){this.output.payload.statusCode=this.output.statusCode,this.output.payload.error=i.codes.get(this.output.statusCode)||"Unknown",500===this.output.statusCode&&!0!==e?this.output.payload.message="An internal server error occurred":this.message&&(this.output.payload.message=this.message)},i.serverError=function(e,a,n,i){return a instanceof Error&&!a.isBoom?t.boomify(a,{statusCode:n,message:e}):new t.Boom(e,{statusCode:n,data:a,ctor:i})}},function(e,t,a){"use strict";t.applyToDefaults=a(975),t.assert=a(270),t.Bench=a(976),t.block=a(977),t.clone=a(440),t.contain=a(978),t.deepEqual=a(629),t.Error=a(624),t.escapeHeaderAttribute=a(979),t.escapeHtml=a(980),t.escapeJson=a(981),t.escapeRegex=a(630),t.flatten=a(982),t.ignore=a(628),t.intersect=a(983),t.isPromise=a(984),t.merge=a(627),t.once=a(985),t.reach=a(354),t.reachTemplate=a(986),t.stringify=a(625),t.wait=a(987)},function(e,t,a){"use strict";const n=a(270),i=a(440),r=a(627),s=a(354),o={};e.exports=function(e,t,a={}){if(n(e&&"object"==typeof e,"Invalid defaults value: must be an object"),n(!t||!0===t||"object"==typeof t,"Invalid source value: must be true, falsy or an object"),n("object"==typeof a,"Invalid options: must be an object"),!t)return null;if(a.shallow)return o.applyToDefaultsWithShallow(e,t,a);const s=i(e);if(!0===t)return s;const l=void 0!==a.nullOverride&&a.nullOverride;return r(s,t,{nullOverride:l,mergeArrays:!1})},o.applyToDefaultsWithShallow=function(e,t,a){const l=a.shallow;n(Array.isArray(l),"Invalid keys");const c=new Map,u=!0===t?null:new Set;for(let a of l){a=Array.isArray(a)?a:a.split(".");const n=s(e,a);n&&"object"==typeof n?c.set(n,u&&s(t,a)||n):u&&u.add(a)}const d=i(e,{},c);if(!u)return d;for(const e of u)o.reachCopy(d,t,e);const p=void 0!==a.nullOverride&&a.nullOverride;return r(d,t,{nullOverride:p,mergeArrays:!1})},o.reachCopy=function(e,t,a){for(const e of a){if(!(e in t))return;const a=t[e];if("object"!=typeof a||null===a)return;t=a}const n=t;let i=e;for(let e=0;e<a.length-1;++e){const t=a[e];"object"!=typeof i[t]&&(i[t]={}),i=i[t]}i[a[a.length-1]]=n}},function(e,t,a){"use strict";(function(t){const a={};e.exports=a.Bench=class{constructor(){this.ts=0,this.reset()}reset(){this.ts=a.Bench.now()}elapsed(){return a.Bench.now()-this.ts}static now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}}}).call(this,a(391))},function(e,t,a){"use strict";const n=a(628);e.exports=function(){return new Promise(n)}},function(e,t,a){"use strict";const n=a(270),i=a(629),r=a(630),s=a(441),o={};e.exports=function(e,t,a={}){return"object"!=typeof t&&(t=[t]),n(!Array.isArray(t)||t.length,"Values array cannot be empty"),"string"==typeof e?o.string(e,t,a):Array.isArray(e)?o.array(e,t,a):(n("object"==typeof e,"Reference must be string or an object"),o.object(e,t,a))},o.array=function(e,t,a){if(Array.isArray(t)||(t=[t]),!e.length)return!1;if(a.only&&a.once&&e.length!==t.length)return!1;let n;const i=new Map;for(const e of t)if(a.deep&&e&&"object"==typeof e){n=n||o.compare(a);let t=!1;for(const[a,r]of i.entries())if(n(a,e)){++r.allowed,t=!0;break}t||i.set(e,{allowed:1,hits:0})}else{const t=i.get(e);t?++t.allowed:i.set(e,{allowed:1,hits:0})}let r=0;for(const t of e){let e;if(a.deep&&t&&"object"==typeof t){n=n||o.compare(a);for(const[a,r]of i.entries())if(n(a,t)){e=r;break}}else e=i.get(t);if(e&&(++e.hits,++r,a.once&&e.hits>e.allowed))return!1}if(a.only&&r!==e.length)return!1;for(const e of i.values())if(e.hits!==e.allowed&&e.hits<e.allowed&&!a.part)return!1;return!!r},o.object=function(e,t,a){n(void 0===a.once,"Cannot use option once with object");const i=s.keys(e,a);if(!i.length)return!1;if(Array.isArray(t))return o.array(i,t,a);const r=Object.getOwnPropertySymbols(t).filter((e=>t.propertyIsEnumerable(e))),l=[...Object.keys(t),...r],c=o.compare(a),u=new Set(l);for(const n of i)if(u.has(n)){if(!c(t[n],e[n]))return!1;u.delete(n)}else if(a.only)return!1;return!u.size||!!a.part&&u.size<l.length},o.string=function(e,t,a){if(""===e)return 1===t.length&&""===t[0]||!a.once&&!t.some((e=>""!==e));const i=new Map,s=[];for(const e of t)if(n("string"==typeof e,"Cannot compare string reference to non-string value"),e){const t=i.get(e);t?++t.allowed:(i.set(e,{allowed:1,hits:0}),s.push(r(e)))}else if(a.once||a.only)return!1;if(!s.length)return!0;const o=new RegExp(`(${s.join("|")})`,"g"),l=e.replace(o,((e,t)=>(++i.get(t).hits,"")));if(a.only&&l)return!1;let c=!1;for(const e of i.values())if(e.hits&&(c=!0),e.hits!==e.allowed){if(e.hits<e.allowed&&!a.part)return!1;if(a.once)return!1}return!!c},o.compare=function(e){if(!e.deep)return o.shallow;const t=void 0!==e.only,a=void 0!==e.part,n={prototype:t?e.only:!!a&&!e.part,part:t?!e.only:!!a&&e.part};return(e,t)=>i(e,t,n)},o.shallow=function(e,t){return e===t}},function(e,t,a){"use strict";const n=a(270);e.exports=function(e){return n(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(e),"Bad attribute value ("+e+")"),e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')}},function(e,t,a){"use strict";const n={};e.exports=function(e){if(!e)return"";let t="";for(let a=0;a<e.length;++a){const i=e.charCodeAt(a);n.isSafe(i)?t+=e[a]:t+=n.escapeHtmlChar(i)}return t},n.escapeHtmlChar=function(e){const t=n.namedHtml[e];return void 0!==t?t:e>=256?"&#"+e+";":`&#x${e.toString(16).padStart(2,"0")};`},n.isSafe=function(e){return void 0!==n.safeCharCodes[e]},n.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"},n.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}()},function(e,t,a){"use strict";e.exports=function(e){if(!e)return"";let t;return e.replace(/[<>&\u2028\u2029]/g,(e=>(t=e.charCodeAt(0),60===t?"\\u003c":62===t?"\\u003e":38===t?"\\u0026":8232===t?"\\u2028":"\\u2029")))}},function(e,t,a){"use strict";const n={};e.exports=n.flatten=function(e,t){const a=t||[];for(let t=0;t<e.length;++t)Array.isArray(e[t])?n.flatten(e[t],a):a.push(e[t]);return a}},function(e,t,a){"use strict";const n={};e.exports=function(e,t,a={}){if(!e||!t)return a.first?null:[];const i=[],r=Array.isArray(e)?new Set(e):e,s=new Set;for(const e of t)if(n.has(r,e)&&!s.has(e)){if(a.first)return e;i.push(e),s.add(e)}return a.first?null:i},n.has=function(e,t){return"function"==typeof e.has?e.has(t):void 0!==e[t]}},function(e,t,a){"use strict";e.exports=function(e){return!!e&&"function"==typeof e.then}},function(e,t,a){"use strict";e.exports=function(e){if(e._hoekOnce)return e;let t=!1;const a=function(...a){t||(t=!0,e(...a))};return a._hoekOnce=!0,a}},function(e,t,a){"use strict";const n=a(354);e.exports=function(e,t,a){return t.replace(/{([^{}]+)}/g,((t,i)=>{const r=n(e,i,a);return null==r?"":r}))}},function(e,t,a){"use strict";e.exports=function(e,t){if("number"!=typeof e&&void 0!==e)throw new TypeError("Timeout must be a number");return new Promise((a=>setTimeout(a,e,t)))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=t.discriminatedUnion=void 0;const n=a(442),i=a(990),r=a(633),s=a(355),o=a(443);class ParseInputLazyPath{constructor(e,t,a,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=a,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const l=(e,t)=>{if((0,r.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new o.ZodError(e.common.issues);return this._error=t,this._error}}};function c(e){if(!e)return{};const{errorMap:t,invalid_type_error:a,required_error:n,description:i}=e;if(t&&(a||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=a?a:t.defaultError},description:i}}class ZodType{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,s.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new r.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if((0,r.isAsync)(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const a=this.safeParse(e,t);if(a.success)return a.data;throw a.error}safeParse(e,t){var a;const n={common:{issues:[],async:null!==(a=null==t?void 0:t.async)&&void 0!==a&&a,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},i=this._parseSync({data:e,path:n.path,parent:n});return l(n,i)}async parseAsync(e,t){const a=await this.safeParseAsync(e,t);if(a.success)return a.data;throw a.error}async safeParseAsync(e,t){const a={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},n=this._parse({data:e,path:a.path,parent:a}),i=await((0,r.isAsync)(n)?n:Promise.resolve(n));return l(a,i)}refine(e,t){const a=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const i=e(t),r=()=>n.addIssue({code:o.ZodIssueCode.custom,...a(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then((e=>!!e||(r(),!1))):!!i||(r(),!1)}))}refinement(e,t){return this._refinement(((a,n)=>!!e(a)||(n.addIssue("function"==typeof t?t(a,n):t),!1)))}_refinement(e){return new ZodEffects({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...c(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ZodDefault({...c(this._def),innerType:this,defaultValue:t,typeName:S.ZodDefault})}brand(){return new ZodBranded({typeName:S.ZodBranded,type:this,...c(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ZodCatch({...c(this._def),innerType:this,catchValue:t,typeName:S.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=ZodType,t.Schema=ZodType,t.ZodSchema=ZodType;const u=/^c[^\s-]{8,}$/i,d=/^[a-z][a-z0-9]*$/,p=/[0-9A-HJKMNP-TV-Z]{26}/,m=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,f=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,b=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,g=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,y=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class ZodString extends ZodType{constructor(){super(...arguments),this._regex=(e,t,a)=>this.refinement((t=>e.test(t)),{validation:t,code:o.ZodIssueCode.invalid_string,...i.errorUtil.errToObj(a)}),this.nonempty=e=>this.min(1,i.errorUtil.errToObj(e)),this.trim=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==s.ZodParsedType.string){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.string,received:t.parsedType}),r.INVALID}const t=new r.ParseStatus;let a;for(const c of this._def.checks)if("min"===c.kind)e.data.length<c.value&&(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),t.dirty());else if("max"===c.kind)e.data.length>c.value&&(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),t.dirty());else if("length"===c.kind){const n=e.data.length>c.value,i=e.data.length<c.value;(n||i)&&(a=this._getOrReturnCtx(e,a),n?(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):i&&(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),t.dirty())}else if("email"===c.kind)f.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"email",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("emoji"===c.kind)b.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"emoji",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("uuid"===c.kind)m.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"uuid",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("cuid"===c.kind)u.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"cuid",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("cuid2"===c.kind)d.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"cuid2",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("ulid"===c.kind)p.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"ulid",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty());else if("url"===c.kind)try{new URL(e.data)}catch(n){a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"url",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty()}else"regex"===c.kind?(c.regex.lastIndex=0,c.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"regex",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty())):"trim"===c.kind?e.data=e.data.trim():"includes"===c.kind?e.data.includes(c.value,c.position)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),t.dirty()):"toLowerCase"===c.kind?e.data=e.data.toLowerCase():"toUpperCase"===c.kind?e.data=e.data.toUpperCase():"startsWith"===c.kind?e.data.startsWith(c.value)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_string,validation:{startsWith:c.value},message:c.message}),t.dirty()):"endsWith"===c.kind?e.data.endsWith(c.value)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_string,validation:{endsWith:c.value},message:c.message}),t.dirty()):"datetime"===c.kind?((l=c).precision?l.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}Z$`):0===l.precision?l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_string,validation:"datetime",message:c.message}),t.dirty()):"ip"===c.kind?(n=e.data,("v4"!==(i=c.version)&&i||!g.test(n))&&("v6"!==i&&i||!y.test(n))&&(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{validation:"ip",code:o.ZodIssueCode.invalid_string,message:c.message}),t.dirty())):s.util.assertNever(c);var n,i,l;return{status:t.value,value:e.data}}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...i.errorUtil.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...i.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errorUtil.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function h(e,t){const a=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=a>n?a:n;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}t.ZodString=ZodString,ZodString.create=e=>{var t;return new ZodString({checks:[],typeName:S.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...c(e)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==s.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.number,received:t.parsedType}),r.INVALID}let t;const a=new r.ParseStatus;for(const n of this._def.checks)"int"===n.kind?s.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),a.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),a.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),a.dirty()):"multipleOf"===n.kind?0!==h(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),a.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_finite,message:n.message}),a.dirty()):s.util.assertNever(n);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,a,n){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:i.errorUtil.toString(n)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&s.util.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const a of this._def.checks){if("finite"===a.kind||"int"===a.kind||"multipleOf"===a.kind)return!0;"min"===a.kind?(null===t||a.value>t)&&(t=a.value):"max"===a.kind&&(null===e||a.value<e)&&(e=a.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=ZodNumber,ZodNumber.create=e=>new ZodNumber({checks:[],typeName:S.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...c(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==s.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.bigint,received:t.parsedType}),r.INVALID}let t;const a=new r.ParseStatus;for(const n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),a.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),a.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),a.dirty()):s.util.assertNever(n);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,a,n){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:i.errorUtil.toString(n)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=ZodBigInt,ZodBigInt.create=e=>{var t;return new ZodBigInt({checks:[],typeName:S.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...c(e)})};class ZodBoolean extends ZodType{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==s.ZodParsedType.boolean){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.boolean,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodBoolean=ZodBoolean,ZodBoolean.create=e=>new ZodBoolean({typeName:S.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...c(e)});class ZodDate extends ZodType{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==s.ZodParsedType.date){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.date,received:t.parsedType}),r.INVALID}if(isNaN(e.data.getTime())){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_date}),r.INVALID}const t=new r.ParseStatus;let a;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(a=this._getOrReturnCtx(e,a),(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):s.util.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=ZodDate,ZodDate.create=e=>new ZodDate({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:S.ZodDate,...c(e)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.symbol){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.symbol,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodSymbol=ZodSymbol,ZodSymbol.create=e=>new ZodSymbol({typeName:S.ZodSymbol,...c(e)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.undefined,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodUndefined=ZodUndefined,ZodUndefined.create=e=>new ZodUndefined({typeName:S.ZodUndefined,...c(e)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.null){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.null,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodNull=ZodNull,ZodNull.create=e=>new ZodNull({typeName:S.ZodNull,...c(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,r.OK)(e.data)}}t.ZodAny=ZodAny,ZodAny.create=e=>new ZodAny({typeName:S.ZodAny,...c(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,r.OK)(e.data)}}t.ZodUnknown=ZodUnknown,ZodUnknown.create=e=>new ZodUnknown({typeName:S.ZodUnknown,...c(e)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.never,received:t.parsedType}),r.INVALID}}t.ZodNever=ZodNever,ZodNever.create=e=>new ZodNever({typeName:S.ZodNever,...c(e)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.void,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodVoid=ZodVoid,ZodVoid.create=e=>new ZodVoid({typeName:S.ZodVoid,...c(e)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:a}=this._processInputParams(e),n=this._def;if(t.parsedType!==s.ZodParsedType.array)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:t.parsedType}),r.INVALID;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&((0,r.addIssueToContext)(t,{code:e?o.ZodIssueCode.too_big:o.ZodIssueCode.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),t.common.async)return Promise.all([...t.data].map(((e,a)=>n.type._parseAsync(new ParseInputLazyPath(t,e,t.path,a))))).then((e=>r.ParseStatus.mergeArray(a,e)));const i=[...t.data].map(((e,a)=>n.type._parseSync(new ParseInputLazyPath(t,e,t.path,a))));return r.ParseStatus.mergeArray(a,i)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:i.errorUtil.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:i.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}function v(e){if(e instanceof ZodObject){const t={};for(const a in e.shape){const n=e.shape[a];t[a]=ZodOptional.create(v(n))}return new ZodObject({...e._def,shape:()=>t})}return e instanceof ZodArray?new ZodArray({...e._def,type:v(e.element)}):e instanceof ZodOptional?ZodOptional.create(v(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(v(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map((e=>v(e)))):e}t.ZodArray=ZodArray,ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...c(t)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=s.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==s.ZodParsedType.object){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),r.INVALID}const{status:t,ctx:a}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),l=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const e in a.data)i.includes(e)||l.push(e);const c=[];for(const e of i){const t=n[e],i=a.data[e];c.push({key:{status:"valid",value:e},value:t._parse(new ParseInputLazyPath(a,i,a.path,e)),alwaysSet:e in a.data})}if(this._def.catchall instanceof ZodNever){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of l)c.push({key:{status:"valid",value:e},value:{status:"valid",value:a.data[e]}});else if("strict"===e)l.length>0&&((0,r.addIssueToContext)(a,{code:o.ZodIssueCode.unrecognized_keys,keys:l}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of l){const n=a.data[t];c.push({key:{status:"valid",value:t},value:e._parse(new ParseInputLazyPath(a,n,a.path,t)),alwaysSet:t in a.data})}}return a.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of c){const a=await t.key;e.push({key:a,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>r.ParseStatus.mergeObjectSync(t,e))):r.ParseStatus.mergeObjectSync(t,c)}get shape(){return this._def.shape()}strict(e){return i.errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,a)=>{var n,r,s,o;const l=null!==(s=null===(r=(n=this._def).errorMap)||void 0===r?void 0:r.call(n,t,a).message)&&void 0!==s?s:a.defaultError;return"unrecognized_keys"===t.code?{message:null!==(o=i.errorUtil.errToObj(e).message)&&void 0!==o?o:l}:{message:l}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:S.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};return s.util.objectKeys(e).forEach((a=>{e[a]&&this.shape[a]&&(t[a]=this.shape[a])})),new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};return s.util.objectKeys(this.shape).forEach((a=>{e[a]||(t[a]=this.shape[a])})),new ZodObject({...this._def,shape:()=>t})}deepPartial(){return v(this)}partial(e){const t={};return s.util.objectKeys(this.shape).forEach((a=>{const n=this.shape[a];e&&!e[a]?t[a]=n:t[a]=n.optional()})),new ZodObject({...this._def,shape:()=>t})}required(e){const t={};return s.util.objectKeys(this.shape).forEach((a=>{if(e&&!e[a])t[a]=this.shape[a];else{let e=this.shape[a];for(;e instanceof ZodOptional;)e=e._def.innerType;t[a]=e}})),new ZodObject({...this._def,shape:()=>t})}keyof(){return j(s.util.objectKeys(this.shape))}}t.ZodObject=ZodObject,ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:S.ZodObject,...c(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:S.ZodObject,...c(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:S.ZodObject,...c(t)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),a=this._def.options;if(t.common.async)return Promise.all(a.map((async e=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const a of e)if("dirty"===a.result.status)return t.common.issues.push(...a.ctx.common.issues),a.result;const a=e.map((e=>new o.ZodError(e.ctx.common.issues)));return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:a}),r.INVALID}));{let e;const n=[];for(const i of a){const a={...t,common:{...t.common,issues:[]},parent:null},r=i._parseSync({data:t.data,path:t.path,parent:a});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:a}),a.common.issues.length&&n.push(a.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=n.map((e=>new o.ZodError(e)));return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:i}),r.INVALID}}get options(){return this._def.options}}t.ZodUnion=ZodUnion,ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:S.ZodUnion,...c(t)});const E=e=>e instanceof ZodLazy?E(e.schema):e instanceof ZodEffects?E(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?Object.keys(e.enum):e instanceof ZodDefault?E(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:null;class ZodDiscriminatedUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.object)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),r.INVALID;const a=this.discriminator,n=t.data[a],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),r.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,a){const n=new Map;for(const a of t){const t=E(a.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of t){if(n.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);n.set(i,a)}}return new ZodDiscriminatedUnion({typeName:S.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...c(a)})}}function x(e,t){const a=(0,s.getParsedType)(e),n=(0,s.getParsedType)(t);if(e===t)return{valid:!0,data:e};if(a===s.ZodParsedType.object&&n===s.ZodParsedType.object){const a=s.util.objectKeys(t),n=s.util.objectKeys(e).filter((e=>-1!==a.indexOf(e))),i={...e,...t};for(const a of n){const n=x(e[a],t[a]);if(!n.valid)return{valid:!1};i[a]=n.data}return{valid:!0,data:i}}if(a===s.ZodParsedType.array&&n===s.ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let n=0;n<e.length;n++){const i=x(e[n],t[n]);if(!i.valid)return{valid:!1};a.push(i.data)}return{valid:!0,data:a}}return a===s.ZodParsedType.date&&n===s.ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}t.ZodDiscriminatedUnion=ZodDiscriminatedUnion;class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:a}=this._processInputParams(e),n=(e,n)=>{if((0,r.isAborted)(e)||(0,r.isAborted)(n))return r.INVALID;const i=x(e.value,n.value);return i.valid?(((0,r.isDirty)(e)||(0,r.isDirty)(n))&&t.dirty(),{status:t.value,value:i.data}):((0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_intersection_types}),r.INVALID)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}t.ZodIntersection=ZodIntersection,ZodIntersection.create=(e,t,a)=>new ZodIntersection({left:e,right:t,typeName:S.ZodIntersection,...c(a)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==s.ZodParsedType.array)return(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:a.parsedType}),r.INVALID;if(a.data.length<this._def.items.length)return(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.INVALID;!this._def.rest&&a.data.length>this._def.items.length&&((0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...a.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new ParseInputLazyPath(a,e,a.path,t)):null})).filter((e=>!!e));return a.common.async?Promise.all(n).then((e=>r.ParseStatus.mergeArray(t,e))):r.ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}t.ZodTuple=ZodTuple,ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:S.ZodTuple,rest:null,...c(t)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==s.ZodParsedType.object)return(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:a.parsedType}),r.INVALID;const n=[],i=this._def.keyType,l=this._def.valueType;for(const e in a.data)n.push({key:i._parse(new ParseInputLazyPath(a,e,a.path,e)),value:l._parse(new ParseInputLazyPath(a,a.data[e],a.path,e))});return a.common.async?r.ParseStatus.mergeObjectAsync(t,n):r.ParseStatus.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,a){return new ZodRecord(t instanceof ZodType?{keyType:e,valueType:t,typeName:S.ZodRecord,...c(a)}:{keyType:ZodString.create(),valueType:e,typeName:S.ZodRecord,...c(t)})}}t.ZodRecord=ZodRecord;class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==s.ZodParsedType.map)return(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.map,received:a.parsedType}),r.INVALID;const n=this._def.keyType,i=this._def.valueType,l=[...a.data.entries()].map((([e,t],r)=>({key:n._parse(new ParseInputLazyPath(a,e,a.path,[r,"key"])),value:i._parse(new ParseInputLazyPath(a,t,a.path,[r,"value"]))})));if(a.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const a of l){const n=await a.key,i=await a.value;if("aborted"===n.status||"aborted"===i.status)return r.INVALID;"dirty"!==n.status&&"dirty"!==i.status||t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const a of l){const n=a.key,i=a.value;if("aborted"===n.status||"aborted"===i.status)return r.INVALID;"dirty"!==n.status&&"dirty"!==i.status||t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}}t.ZodMap=ZodMap,ZodMap.create=(e,t,a)=>new ZodMap({valueType:t,keyType:e,typeName:S.ZodMap,...c(a)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==s.ZodParsedType.set)return(0,r.addIssueToContext)(a,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.set,received:a.parsedType}),r.INVALID;const n=this._def;null!==n.minSize&&a.data.size<n.minSize.value&&((0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&a.data.size>n.maxSize.value&&((0,r.addIssueToContext)(a,{code:o.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const i=this._def.valueType;function l(e){const a=new Set;for(const n of e){if("aborted"===n.status)return r.INVALID;"dirty"===n.status&&t.dirty(),a.add(n.value)}return{status:t.value,value:a}}const c=[...a.data.values()].map(((e,t)=>i._parse(new ParseInputLazyPath(a,e,a.path,t))));return a.common.async?Promise.all(c).then((e=>l(e))):l(c)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:i.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=ZodSet,ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:S.ZodSet,...c(t)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.function)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.function,received:t.parsedType}),r.INVALID;function a(e,a){return(0,r.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_arguments,argumentsError:a}})}function i(e,a){return(0,r.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_return_type,returnTypeError:a}})}const l={errorMap:t.common.contextualErrorMap},c=t.data;if(this._def.returns instanceof ZodPromise){const e=this;return(0,r.OK)((async function(...t){const n=new o.ZodError([]),r=await e._def.args.parseAsync(t,l).catch((e=>{throw n.addIssue(a(t,e)),n})),s=await Reflect.apply(c,this,r);return await e._def.returns._def.type.parseAsync(s,l).catch((e=>{throw n.addIssue(i(s,e)),n}))}))}{const e=this;return(0,r.OK)((function(...t){const n=e._def.args.safeParse(t,l);if(!n.success)throw new o.ZodError([a(t,n.error)]);const r=Reflect.apply(c,this,n.data),s=e._def.returns.safeParse(r,l);if(!s.success)throw new o.ZodError([i(r,s.error)]);return s.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ZodFunction({...this._def,args:ZodTuple.create(e).rest(ZodUnknown.create())})}returns(e){return new ZodFunction({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,a){return new ZodFunction({args:e||ZodTuple.create([]).rest(ZodUnknown.create()),returns:t||ZodUnknown.create(),typeName:S.ZodFunction,...c(a)})}}t.ZodFunction=ZodFunction;class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=ZodLazy,ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:S.ZodLazy,...c(t)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_literal,expected:this._def.value}),r.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function j(e,t){return new ZodEnum({values:e,typeName:S.ZodEnum,...c(t)})}t.ZodLiteral=ZodLiteral,ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:S.ZodLiteral,...c(t)});class ZodEnum extends ZodType{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),a=this._def.values;return(0,r.addIssueToContext)(t,{expected:s.util.joinValues(a),received:t.parsedType,code:o.ZodIssueCode.invalid_type}),r.INVALID}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),a=this._def.values;return(0,r.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_enum_value,options:a}),r.INVALID}return(0,r.OK)(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ZodEnum.create(e)}exclude(e){return ZodEnum.create(this.options.filter((t=>!e.includes(t))))}}t.ZodEnum=ZodEnum,ZodEnum.create=j;class ZodNativeEnum extends ZodType{_parse(e){const t=s.util.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==s.ZodParsedType.string&&a.parsedType!==s.ZodParsedType.number){const e=s.util.objectValues(t);return(0,r.addIssueToContext)(a,{expected:s.util.joinValues(e),received:a.parsedType,code:o.ZodIssueCode.invalid_type}),r.INVALID}if(-1===t.indexOf(e.data)){const e=s.util.objectValues(t);return(0,r.addIssueToContext)(a,{received:a.data,code:o.ZodIssueCode.invalid_enum_value,options:e}),r.INVALID}return(0,r.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=ZodNativeEnum,ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:S.ZodNativeEnum,...c(t)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.promise&&!1===t.common.async)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.promise,received:t.parsedType}),r.INVALID;const a=t.parsedType===s.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,r.OK)(a.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}t.ZodPromise=ZodPromise,ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:S.ZodPromise,...c(t)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:a}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{(0,r.addIssueToContext)(a,e),e.fatal?t.abort():t.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){const e=n.transform(a.data,i);return a.common.issues.length?{status:"dirty",value:a.data}:a.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:a.path,parent:a}))):this._def.schema._parseSync({data:e,path:a.path,parent:a})}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,i);if(a.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===a.common.async){const n=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===n.status?r.INVALID:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((a=>"aborted"===a.status?r.INVALID:("dirty"===a.status&&t.dirty(),e(a.value).then((()=>({status:t.value,value:a.value}))))))}if("transform"===n.type){if(!1===a.common.async){const e=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!(0,r.isValid)(e))return e;const s=n.transform(e.value,i);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((e=>(0,r.isValid)(e)?Promise.resolve(n.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}s.util.assertNever(n)}}t.ZodEffects=ZodEffects,t.ZodTransformer=ZodEffects,ZodEffects.create=(e,t,a)=>new ZodEffects({schema:e,typeName:S.ZodEffects,effect:t,...c(a)}),ZodEffects.createWithPreprocess=(e,t,a)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:S.ZodEffects,...c(a)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===s.ZodParsedType.undefined?(0,r.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=ZodOptional,ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:S.ZodOptional,...c(t)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===s.ZodParsedType.null?(0,r.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=ZodNullable,ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:S.ZodNullable,...c(t)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let a=t.data;return t.parsedType===s.ZodParsedType.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=ZodDefault,ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:S.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...c(t)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),a={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return(0,r.isAsync)(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o.ZodError(a.common.issues)},input:a.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new o.ZodError(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=ZodCatch,ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:S.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...c(t)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.nan){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.nan,received:t.parsedType}),r.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=ZodNaN,ZodNaN.create=e=>new ZodNaN({typeName:S.ZodNaN,...c(e)}),t.BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),a=t.data;return this._def.type._parse({data:a,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ZodBranded;class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?r.INVALID:"dirty"===e.status?(t.dirty(),(0,r.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:a.path,parent:a})})();{const e=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?r.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:a.path,parent:a})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:S.ZodPipeline})}}t.ZodPipeline=ZodPipeline;class ZodReadonly extends ZodType{_parse(e){const t=this._def.innerType._parse(e);return(0,r.isValid)(t)&&(t.value=Object.freeze(t.value)),t}}var S;t.ZodReadonly=ZodReadonly,ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:S.ZodReadonly,...c(t)}),t.custom=(e,t={},a)=>e?ZodAny.create().superRefine(((n,i)=>{var r,s;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(s=null!==(r=e.fatal)&&void 0!==r?r:a)||void 0===s||s,l="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...l,fatal:o})}})):ZodAny.create(),t.late={object:ZodObject.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(S=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={})),t.instanceof=(e,a={message:`Input not instance of ${e.name}`})=>(0,t.custom)((t=>t instanceof e),a);const O=ZodString.create;t.string=O;const k=ZodNumber.create;t.number=k;const w=ZodNaN.create;t.nan=w;const T=ZodBigInt.create;t.bigint=T;const I=ZodBoolean.create;t.boolean=I;const C=ZodDate.create;t.date=C;const M=ZodSymbol.create;t.symbol=M;const _=ZodUndefined.create;t.undefined=_;const A=ZodNull.create;t.null=A;const F=ZodAny.create;t.any=F;const P=ZodUnknown.create;t.unknown=P;const D=ZodNever.create;t.never=D;const N=ZodVoid.create;t.void=N;const R=ZodArray.create;t.array=R;const L=ZodObject.create;t.object=L;const B=ZodObject.strictCreate;t.strictObject=B;const z=ZodUnion.create;t.union=z;const q=ZodDiscriminatedUnion.create;t.discriminatedUnion=q;const $=ZodIntersection.create;t.intersection=$;const V=ZodTuple.create;t.tuple=V;const U=ZodRecord.create;t.record=U;const H=ZodMap.create;t.map=H;const Q=ZodSet.create;t.set=Q;const G=ZodFunction.create;t.function=G;const W=ZodLazy.create;t.lazy=W;const Z=ZodLiteral.create;t.literal=Z;const K=ZodEnum.create;t.enum=K;const J=ZodNativeEnum.create;t.nativeEnum=J;const Y=ZodPromise.create;t.promise=Y;const X=ZodEffects.create;t.effect=X,t.transformer=X;const ee=ZodOptional.create;t.optional=ee;const te=ZodNullable.create;t.nullable=te;const ae=ZodEffects.createWithPreprocess;t.preprocess=ae;const ne=ZodPipeline.create;t.pipeline=ne,t.ostring=()=>O().optional(),t.onumber=()=>k().optional(),t.oboolean=()=>I().optional(),t.coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},t.NEVER=r.INVALID},function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,(n=t.errorUtil||(t.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},n.toString=e=>"string"==typeof e?e:null==e?void 0:e.message},function(e,t,a){e.exports=a(24)(5)},function(e,t,a){e.exports=a(24)(2982)},function(e,t,a){e.exports=a(24)(2993)},function(e,t,a){e.exports=a(24)(2989)},function(e,t,a){var n=a(588)("set",a(1050));n.placeholder=a(589),e.exports=n},function(e,t,a){e.exports=a(24)(3827)},function(e,t,a){e.exports={ary:a(998),assign:a(1021),clone:a(1022),curry:a(1023),forEach:a(649),isArray:a(274),isError:a(1024),isFunction:a(653),isWeakMap:a(1027),iteratee:a(1028),keys:a(703),rearg:a(1043),toInteger:a(651),toPath:a(1045)}},function(e,t,a){var n=a(449);e.exports=function(e,t,a){return t=a?void 0:t,t=e&&null==t?e.length:t,n(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,a){e.exports=a(24)(3355)},function(e,t,a){var n=a(358),i=a(359);e.exports=function(e,t,a){var r=1&t,s=n(e);return function t(){return(this&&this!==i&&this instanceof t?s:e).apply(r?a:this,arguments)}}},function(e,t,a){var n=a(640),i=a(358),r=a(641),s=a(644),o=a(650),l=a(457),c=a(359);e.exports=function(e,t,a){var u=i(e);return function i(){for(var d=arguments.length,p=Array(d),m=d,f=o(i);m--;)p[m]=arguments[m];var b=d<3&&p[0]!==f&&p[d-1]!==f?[]:l(p,f);return(d-=b.length)<a?s(e,t,r,i.placeholder,void 0,p,b,void 0,void 0,a-d):n(this&&this!==c&&this instanceof i?u:e,this,p)}}},function(e,t){e.exports=function(e,t){for(var a=e.length,n=0;a--;)e[a]===t&&++n;return n}},function(e,t,a){var n=a(452),i=a(645),r=a(1004),s=a(1006);e.exports=function(e){var t=r(e),a=s[t];if("function"!=typeof a||!(t in n.prototype))return!1;if(e===a)return!0;var o=i(a);return!!o&&e===o[0]}},function(e,t,a){var n=a(1005),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",a=n[t],r=i.call(n,t)?a.length:0;r--;){var s=a[r],o=s.func;if(null==o||o==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,a){var n=a(452),i=a(646),r=a(453),s=a(274),o=a(454),l=a(1007),c=Object.prototype.hasOwnProperty;function u(e){if(o(e)&&!s(e)&&!(e instanceof n)){if(e instanceof i)return e;if(c.call(e,"__wrapped__"))return l(e)}return new i(e)}u.prototype=r.prototype,u.prototype.constructor=u,e.exports=u},function(e,t,a){var n=a(452),i=a(646),r=a(455);e.exports=function(e){if(e instanceof n)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t,a){e.exports=a(24)(3410)},function(e,t){var a=/\{\n\/\* \[wrapped with (.+)\] \*/,n=/,? & /;e.exports=function(e){var t=e.match(a);return t?t[1].split(n):[]}},function(e,t){var a=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(a,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,a){e.exports=a(24)(3407)},function(e,t,a){var n=a(649),i=a(1013),r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return n(r,(function(a){var n="_."+a[0];t&a[1]&&!i(e,n)&&e.push(n)})),e.sort()}},function(e,t,a){var n=a(1014);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},function(e,t,a){var n=a(1015),i=a(1016),r=a(1017);e.exports=function(e,t,a){return t==t?r(e,t,a):n(e,i,a)}},function(e,t){e.exports=function(e,t,a,n){for(var i=e.length,r=a+(n?1:-1);n?r--:++r<i;)if(t(e[r],r,e))return r;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,a){for(var n=a-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},function(e,t,a){var n=a(455),i=a(456),r=Math.min;e.exports=function(e,t){for(var a=e.length,s=r(t.length,a),o=n(e);s--;){var l=t[s];e[s]=i(l,a)?o[l]:void 0}return e}},function(e,t,a){var n=a(640),i=a(358),r=a(359);e.exports=function(e,t,a,s){var o=1&t,l=i(e);return function t(){for(var i=-1,c=arguments.length,u=-1,d=s.length,p=Array(d+c),m=this&&this!==r&&this instanceof t?l:e;++u<d;)p[u]=s[u];for(;c--;)p[u++]=arguments[++i];return n(m,o?a:this,p)}}},function(e,t,a){var n=a(642),i=a(643),r=a(457),s="__lodash_placeholder__",o=128,l=Math.min;e.exports=function(e,t){var a=e[1],c=t[1],u=a|c,d=u<131,p=c==o&&8==a||c==o&&256==a&&e[7].length<=t[8]||384==c&&t[7].length<=t[8]&&8==a;if(!d&&!p)return e;1&c&&(e[2]=t[2],u|=1&a?0:4);var m=t[3];if(m){var f=e[3];e[3]=f?n(f,m,t[4]):m,e[4]=f?r(e[3],s):t[4]}return(m=t[5])&&(f=e[5],e[5]=f?i(f,m,t[6]):m,e[6]=f?r(e[5],s):t[6]),(m=t[7])&&(e[7]=m),c&o&&(e[8]=null==e[8]?t[8]:l(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}},function(e,t,a){e.exports=a(24)(3375)},function(e,t,a){var n=a(652);e.exports=function(e){return n(e,4)}},function(e,t,a){var n=a(449),i=8;function r(e,t,a){var s=n(e,i,void 0,void 0,void 0,void 0,void 0,t=a?void 0:t);return s.placeholder=r.placeholder,s}r.placeholder={},e.exports=r},function(e,t,a){var n=a(1025),i=a(454),r=a(1026);e.exports=function(e){if(!i(e))return!1;var t=n(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!r(e)}},function(e,t,a){e.exports=a(24)(356)},function(e,t,a){e.exports=a(24)(3400)},function(e,t,a){var n=a(701),i=a(454);e.exports=function(e){return i(e)&&"[object WeakMap]"==n(e)}},function(e,t,a){var n=a(652),i=a(904);e.exports=function(e){return i("function"==typeof e?e:n(e,1))}},function(e,t,a){var n=a(1030),i=a(1032),r=a(656);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(a){return a===e||n(a,e,t)}}},function(e,t,a){var n=a(1031),i=a(654);e.exports=function(e,t,a,r){var s=a.length,o=s,l=!r;if(null==e)return!o;for(e=Object(e);s--;){var c=a[s];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<o;){var u=(c=a[s])[0],d=e[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in e))return!1}else{var m=new n;if(r)var f=r(d,p,u,e,t,m);if(!(void 0===f?i(p,d,3,r,m):f))return!1}}return!0}},function(e,t,a){e.exports=a(24)(1610)},function(e,t,a){var n=a(655),i=a(905);e.exports=function(e){for(var t=i(e),a=t.length;a--;){var r=t[a],s=e[r];t[a]=[r,s,n(s)]}return t}},function(e,t,a){var n=a(654),i=a(1034),r=a(1035),s=a(658),o=a(655),l=a(656),c=a(312);e.exports=function(e,t){return s(e)&&o(t)?l(c(e),t):function(a){var s=i(a,e);return void 0===s&&s===t?r(a,e):n(t,s,3)}}},function(e,t,a){e.exports=a(24)(1918)},function(e,t,a){var n=a(1036),i=a(1037);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,a){var n=a(657),i=a(702),r=a(274),s=a(456),o=a(1038),l=a(312);e.exports=function(e,t,a){for(var c=-1,u=(t=n(t,e)).length,d=!1;++c<u;){var p=l(t[c]);if(!(d=null!=e&&a(e,p)))break;e=e[p]}return d||++c!=u?d:!!(u=null==e?0:e.length)&&o(u)&&s(p,u)&&(r(e)||i(e))}},function(e,t,a){e.exports=a(24)(1622)},function(e,t,a){var n=a(1040),i=a(1041),r=a(658),s=a(312);e.exports=function(e){return r(e)?n(s(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,a){var n=a(1042);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t,a){e.exports=a(24)(1632)},function(e,t,a){var n=a(449),i=a(1044)((function(e,t){return n(e,256,void 0,void 0,void 0,t)}));e.exports=i},function(e,t,a){e.exports=a(24)(3401)},function(e,t,a){var n=a(1046),i=a(455),r=a(274),s=a(1047),o=a(1048),l=a(312),c=a(1049);e.exports=function(e){return r(e)?n(e,l):s(e)?[e]:i(o(c(e)))}},function(e,t,a){e.exports=a(24)(1633)},function(e,t,a){e.exports=a(24)(818)},function(e,t,a){e.exports=a(24)(3369)},function(e,t,a){e.exports=a(24)(3371)},function(e,t,a){e.exports=a(1051)},function(e,t,a){var n=a(659);e.exports=function(e,t,a){return null==e?e:n(e,t,a)}},function(e,t,a){e.exports=a(24)(1635)},function(e,t,a){var n=a(588)("setWith",a(1054));n.placeholder=a(589),e.exports=n},function(e,t,a){e.exports=a(1055)},function(e,t,a){var n=a(659);e.exports=function(e,t,a,i){return i="function"==typeof i?i:void 0,null==e?e:n(e,t,a,i)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEpicMiddleware=void 0;var n=a(3),i=a(64),r=a(662);a(458),t.createEpicMiddleware=function(e){void 0===e&&(e={});var t,a=new(0,n.queueScheduler.constructor)(n.queueScheduler.schedulerActionCtor),s=new n.Subject,o=function(o){t=o;var l=new n.Subject,c=new n.Subject,u=l.asObservable().pipe(i.observeOn(a)),d=new r.StateObservable(c.pipe(i.observeOn(a)),t.getState());return s.pipe(i.map((function(t){var a=t(u,d,e.dependencies);if(!a)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return a})),i.mergeMap((function(e){return n.from(e).pipe(i.subscribeOn(a),i.observeOn(a))}))).subscribe(t.dispatch),function(e){return function(a){var n=e(a);return c.next(t.getState()),l.next(a),n}}};return o.run=function(e){s.next(e)},o}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineEpics=void 0;var n=a(3);t.combineEpics=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n.merge.apply(void 0,e.map((function(e){var a=e.apply(void 0,t);if(!a)throw new TypeError('combineEpics: one of the provided Epics "'+(e.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return a})))};try{Object.defineProperty(a,"name",{value:"combineEpics("+e.map((function(e){return e.name||"<anonymous>"})).join(", ")+")"})}catch(e){}return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ofType=void 0;var n=a(64),i=(a(458),function(e,t){return e===t||"function"==typeof t&&e===t.toString()});t.ofType=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=e.length;return n.filter(1===a?function(t){return i(t.type,e[0])}:function(t){for(var n=0;n<a;n++)if(i(t.type,e[n]))return!0;return!1})}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return B}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(44),l=a.n(o),c=a(45),u=a(17),d=a(142),p=a(182),m=a(567),f=a(126),b=a(471),g=a(1306),y=a(945),h=a(570),v=a(537);const E=l()(u.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-ssmf6u-0"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),x=l()(u.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-ssmf6u-1"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),j=l()(u.EuiLink).withConfig({displayName:"StyledEuiLink",componentId:"sc-ssmf6u-2"})(["word-break:break-word;"]),S=({name:e})=>s.a.createElement(u.EuiText,{size:"s"},e),O=({description:e})=>s.a.createElement(u.EuiText,{size:"s"},e),k=({author:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"authorPropertyValue"}),w=()=>s.a.createElement(u.EuiText,{size:"s","data-test-subj":"buildingBlockPropertyValue"},v.d),T=({severityMappingItem:e})=>s.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(E,null,s.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField-${e.value}`},s.a.createElement("span",{"data-test-subj":"severityOverrideField"},`${e.field}:`))),s.a.createElement(x,null,s.a.createElement(u.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue-${e.value}`},s.a.createElement("span",{"data-test-subj":"severityOverrideValue"},Object(f.a)(e.value)))),s.a.createElement(u.EuiFlexItem,{grow:!1},s.a.createElement(u.EuiIcon,{type:"sortRight"})),s.a.createElement(u.EuiFlexItem,null,s.a.createElement(m.a,{"data-test-subj":"severityOverrideSeverity",value:e.severity}))),I=({riskScore:e})=>s.a.createElement(u.EuiText,{size:"s","data-test-subj":"riskScorePropertyValue"},e),C=({riskScoreMappingItem:e})=>s.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(E,null,s.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField-${e.value}`},s.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyFieldName"},e.field))),s.a.createElement(u.EuiFlexItem,{grow:!1},s.a.createElement(u.EuiIcon,{type:"sortRight"})),s.a.createElement(u.EuiFlexItem,{"data-test-subj":"riskScoreOverridePropertyOverride"},d.t)),M=({references:e})=>s.a.createElement(u.EuiText,{size:"s"},s.a.createElement("ul",null,e.filter((e=>!Object(c.isEmpty)(e))).map(((e,t)=>s.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},s.a.createElement(j,{href:e,external:!0,target:"_blank"},e)))))),_=({falsePositives:e})=>s.a.createElement(u.EuiText,{size:"s"},s.a.createElement("ul",null,e.map((e=>s.a.createElement("li",{"data-test-subj":"falsePositivesPropertyValueItem",key:`falsePositives-${e}`},e))))),A=({investigationFields:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"investigationFieldsPropertyValue"}),F=({license:e})=>s.a.createElement(u.EuiText,{size:"s","data-test-subj":"licensePropertyValue"},e),P=({ruleNameOverride:e})=>s.a.createElement(u.EuiText,{size:"s","data-test-subj":"ruleNameOverridePropertyValue"},e),D=({threat:e})=>s.a.createElement(g.a,{threat:Object(b.a)(e),"data-test-subj":"threatPropertyValue"}),N=({threatIndicatorPath:e})=>s.a.createElement(u.EuiText,{size:"s"},e),R=({timestampOverride:e})=>s.a.createElement(u.EuiText,{size:"s","data-test-subj":"timestampOverridePropertyValue"},e),L=({tags:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"tagsPropertyValue"}),B=({rule:e,columnWidths:t=h.a,hideName:a,hideDescription:n,...r})=>{var o,l;const c=((e,t,a)=>{const n=[];return!t&&e.name&&n.push({title:v.u,description:s.a.createElement(S,{name:e.name})}),!a&&e.description&&n.push({title:v.j,description:s.a.createElement(O,{description:e.description})}),e.author&&e.author.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"authorPropertyTitle"},v.c),description:s.a.createElement(k,{author:e.author})}),e.building_block_type&&n.push({title:s.a.createElement("span",{"data-test-subj":"buildingBlockPropertyTitle"},v.e),description:s.a.createElement(w,null)}),e.severity&&n.push({title:s.a.createElement("span",{"data-test-subj":"severityPropertyTitle"},v.G),description:s.a.createElement(m.a,{value:e.severity,"data-test-subj":"severityPropertyValue"})}),e.severity_mapping&&e.severity_mapping.length>0&&n.push(...e.severity_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?s.a.createElement("span",{"data-test-subj":"severityOverridePropertyTitle"},v.H):"",description:s.a.createElement(T,{severityMappingItem:e})})))),e.risk_score&&n.push({title:s.a.createElement("span",{"data-test-subj":"riskScorePropertyTitle"},v.A),description:s.a.createElement(I,{riskScore:e.risk_score})}),e.risk_score_mapping&&e.risk_score_mapping.length>0&&n.push(...e.risk_score_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?s.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyTitle"},v.B):"",description:s.a.createElement(C,{riskScoreMappingItem:Object(p.d)(e)})})))),e.references&&e.references.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"referencesPropertyTitle"},v.x),description:s.a.createElement(M,{references:e.references})}),e.false_positives&&e.false_positives.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"falsePositivesPropertyTitle"},v.l),description:s.a.createElement(_,{falsePositives:e.false_positives})}),e.investigation_fields&&e.investigation_fields.field_names.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"investigationFieldsPropertyTitle"},v.q),description:s.a.createElement(A,{investigationFields:e.investigation_fields.field_names})}),e.license&&n.push({title:s.a.createElement("span",{"data-test-subj":"licensePropertyTitle"},v.s),description:s.a.createElement(F,{license:e.license})}),e.rule_name_override&&n.push({title:s.a.createElement("span",{"data-test-subj":"ruleNameOverridePropertyTitle"},v.C),description:s.a.createElement(P,{ruleNameOverride:e.rule_name_override})}),e.threat&&e.threat.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"threatPropertyTitle"},v.M),description:s.a.createElement(D,{threat:e.threat})}),"threat_indicator_path"in e&&e.threat_indicator_path&&n.push({title:v.P,description:s.a.createElement(N,{threatIndicatorPath:e.threat_indicator_path})}),e.timestamp_override&&n.push({title:s.a.createElement("span",{"data-test-subj":"timestampOverridePropertyTitle"},v.T),description:s.a.createElement(R,{timestampOverride:e.timestamp_override})}),e.tags&&e.tags.length>0&&n.push({title:s.a.createElement("span",{"data-test-subj":"tagsPropertyTitle"},v.L),description:s.a.createElement(L,{tags:e.tags})}),n})(e,a,n);return s.a.createElement("div",null,s.a.createElement(u.EuiSpacer,{size:"m"}),s.a.createElement(u.EuiDescriptionList,i()({type:null!==(o=r.type)&&void 0!==o?o:"column",rowGutterSize:null!==(l=r.rowGutterSize)&&void 0!==l?l:"m",listItems:c,columnWidths:t,"data-test-subj":"listItemColumnStepRuleDescription"},r)))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(340),c=a(570),u=a(537);const d=({interval:e})=>s.a.createElement(o.EuiText,{size:"s","data-test-subj":"intervalPropertyValue"},e),p=({from:e,interval:t})=>s.a.createElement(o.EuiText,{size:"s","data-test-subj":`fromPropertyValue-${e}`},Object(l.f)(e,t)),m=({rule:e,columnWidths:t=c.a,...a})=>{var n,r;if(!e.interval||!e.from)return null;const l=[];return l.push({title:s.a.createElement("span",{"data-test-subj":"intervalPropertyTitle"},u.p),description:s.a.createElement(d,{interval:e.interval})},{title:s.a.createElement("span",{"data-test-subj":"fromPropertyTitle"},u.m),description:s.a.createElement(p,{from:e.from,interval:e.interval})}),s.a.createElement("div",{"data-test-subj":"listItemColumnStepRuleDescription"},s.a.createElement(o.EuiDescriptionList,i()({type:null!==(n=a.type)&&void 0!==n?n:"column",rowGutterSize:null!==(r=a.rowGutterSize)&&void 0!==r?r:"m",listItems:l,columnWidths:t},a)))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return ne}));var n=a(23),i=a.n(n),r=a(44),s=a.n(r),o=a(2),l=a.n(o),c=a(45),u=a(17),d=a(19),p=a(1279),m=a(328),f=a(79),b=a(247),g=a(143),y=a(1113),h=a(1083),v=a(1307),E=a(1117),x=a(1112),j=a(296),S=a(1088),O=a(307),k=a(340),w=a(1079),T=a(949),I=a(690),C=a(212),M=a(1138),_=a(945),A=a(570),F=a(537);const P=({savedQueryName:e})=>l.a.createElement(u.EuiText,{size:"s","data-test-subj":"savedQueryNamePropertyValue"},e),D=s()(u.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1lxmnf2-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),N=({filters:e,dataViewId:t,index:a,"data-test-subj":n})=>{const{indexPattern:i}=Object(S.b)({dataSourceType:t?O.a.DataView:O.a.IndexPatterns,index:null!=a?a:[],dataViewId:t}),r=Object(d.mapAndFlattenFilters)(e);return l.a.createElement(u.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs","data-test-subj":n},r.map(((e,t)=>{const a=e.meta.alias?e.meta.alias:l.a.createElement(f.FilterBadgeGroup,{filters:[e],dataViews:[i]});return l.a.createElement(ie,{grow:!1,key:`filter-${t}`,"data-test-subj":`filterItem-${e.meta.key}`},l.a.createElement(D,{color:"hollow"},null!=i?a:l.a.createElement(u.EuiLoadingSpinner,{size:"m"})))})))},R=s.a.div.withConfig({displayName:"QueryContent",componentId:"sc-1lxmnf2-1"})(["white-space:pre-wrap;"]),L=({query:e,"data-test-subj":t="query"})=>l.a.createElement(R,{"data-test-subj":t},e),B=({index:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"indexPropertyValue"}),z=({dataViewId:e})=>l.a.createElement(u.EuiText,{size:"s","data-test-subj":"dataViewIdPropertyValue"},e),q=({dataViewId:e})=>{const{data:t}=Object(C.b)().services,[a,n]=l.a.useState(""),[i,r]=l.a.useState(!1);return l.a.useEffect((()=>{t.dataViews.get(e).then((e=>{n(e.getIndexPattern())})).catch((()=>{r(!0)}))}),[t,e]),i?l.a.createElement(u.EuiText,{size:"s"},F.g):a?l.a.createElement(u.EuiText,{size:"s","data-test-subj":"dataViewIndexPatternPropertyValue"},a):l.a.createElement(u.EuiLoadingSpinner,{size:"m"})},$=({threshold:e})=>l.a.createElement("div",{"data-test-subj":"thresholdPropertyValue"},Object(c.isEmpty)(e.field[0])?`${y.x} >= ${e.value}`:`${y.w} ${Array.isArray(e.field)?e.field.join(","):e.field} >= ${e.value}`),V=({anomalyThreshold:e})=>l.a.createElement(u.EuiText,{size:"s","data-test-subj":"anomalyThresholdPropertyValue"},e),U=({jobIds:e,isInteractive:t})=>{const{jobs:a}=Object(I.a)();if(t)return l.a.createElement(w.a,{jobIds:e});const n=a.filter((t=>e.includes(t.id)));return l.a.createElement(l.a.Fragment,null,n.map((e=>{var t;return l.a.createElement(T.a,{key:e.id,jobId:e.id,jobName:null===(t=e.customSettings)||void 0===t?void 0:t.security_app_display_name})})))},H=({type:e})=>l.a.createElement(u.EuiText,{size:"s"},(e=>{switch(e){case"machine_learning":return y.n;case"query":case"saved_query":return y.q;case"threshold":return y.y;case"eql":return y.j;case"esql":return l.a.createElement(M.a,{label:y.l});case"threat_match":return y.u;case"new_terms":return y.o;default:return Object(g.a)(e)}})(e)),Q=s()(u.EuiText).withConfig({displayName:"StyledFieldTypeText",componentId:"sc-1lxmnf2-2"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),G=({requiredFields:e})=>l.a.createElement(u.EuiFlexGrid,{gutterSize:"s","data-test-subj":"requiredFieldsPropertyValue"},e.map(((t,a)=>l.a.createElement(u.EuiFlexItem,{grow:!1,key:t.name},l.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},l.a.createElement(u.EuiFlexItem,{grow:!1},l.a.createElement(p.a,{"data-test-subj":"field-type-icon",type:Object(m.c)(t.type),label:t.type})),l.a.createElement(u.EuiFlexItem,{grow:!1},l.a.createElement(Q,{grow:!1,size:"s","data-test-subj":"requiredFieldsPropertyValueItem"},` ${t.name}${a+1!==e.length?", ":""}`))))))),W=({timelineTitle:e})=>l.a.createElement(u.EuiText,{size:"s","data-test-subj":"timelineTemplatePropertyValue"},e),Z=({threatIndex:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"threatIndexPropertyValue"}),K=({threatMapping:e})=>{const t=e.reduce(((e,t,a,{length:n})=>{const i=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${x.d} ${t.value}`:0===a?`(${t.field} ${x.d} ${t.value})`:`${e} ${x.a} (${t.field} ${x.d} ${t.value})`),"");return 1===n?`${i}`:0===a?`(${i})`:`${e} ${x.e} (${i})`}),"");return l.a.createElement(u.EuiText,{size:"s","data-test-subj":"threatMappingPropertyValue"},t)},J=({title:e})=>l.a.createElement(v.a,{label:e}),Y=({fields:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"alertSuppressionGroupByPropertyValue"}),X=({duration:e})=>{const t=e?`${e.value}${e.unit}`:y.b;return l.a.createElement(u.EuiText,{size:"s","data-test-subj":"alertSuppressionDurationPropertyValue"},t)},ee=({missingFieldsStrategy:e})=>{const t=e===b.a.suppress?y.c:y.a;return l.a.createElement(u.EuiText,{size:"s","data-test-subj":"alertSuppressionSuppressionFieldPropertyValue"},t)},te=({newTermsFields:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"newTermsFieldsPropertyValue"}),ae=({historyWindowStart:e})=>{const t=e?Object(k.b)(e):"7d";return l.a.createElement(u.EuiText,{size:"s","data-test-subj":`newTermsWindowSizePropertyValue-${e}`},t)},ne=({rule:e,isInteractive:t=!1,columnWidths:a=A.a,dataTestSubj:n,...r})=>{var s,o;const{savedQuery:c}=Object(E.a)({savedQueryId:"saved_query"===e.type?e.saved_id:"",ruleType:e.type}),d=((e,t,a,n)=>{var i;const r=[];return"index"in e&&e.index&&e.index.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"indexPropertyTitle"},F.o),description:l.a.createElement(B,{index:e.index})}),"data_view_id"in e&&e.data_view_id&&r.push({title:l.a.createElement("span",{"data-test-subj":"dataViewIdPropertyTitle"},F.f),description:l.a.createElement(z,{dataViewId:e.data_view_id})},{title:l.a.createElement("span",{"data-test-subj":"dataViewIndexPatternPropertyTitle"},F.h),description:l.a.createElement(q,{dataViewId:e.data_view_id})}),a&&(r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryNamePropertyTitle"},y.t),description:l.a.createElement(P,{savedQueryName:a.attributes.title})}),a.attributes.filters&&r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryFiltersPropertyTitle"},y.r),description:l.a.createElement(N,{filters:a.attributes.filters,"data-test-subj":"savedQueryFiltersPropertyValue"})}),"string"==typeof a.attributes.query.query&&r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryContentPropertyTitle"},y.s),description:l.a.createElement(L,{query:a.attributes.query.query,"data-test-subj":"savedQueryContentPropertyValue"})})),"filters"in e&&null!==(i=e.filters)&&void 0!==i&&i.length&&r.push({title:l.a.createElement("span",{"data-test-subj":"filtersPropertyTitle"},y.m),description:l.a.createElement(N,{filters:e.filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"filtersPropertyValue"})}),"query"in e&&e.query&&("eql"===e.type?r.push({title:l.a.createElement("span",{"data-test-subj":"eqlQueryPropertyTitle"},y.g),description:l.a.createElement(L,{query:e.query,"data-test-subj":"eqlQueryPropertyValue"})}):"esql"===e.type?r.push({title:l.a.createElement("span",{"data-test-subj":"esqlQueryPropertyTitle"},y.k),description:l.a.createElement(L,{query:e.query,"data-test-subj":"esqlQueryPropertyValue"})}):r.push({title:l.a.createElement("span",{"data-test-subj":"customQueryPropertyTitle"},y.p),description:l.a.createElement(L,{query:e.query,"data-test-subj":"customQueryPropertyValue"})})),e.type&&r.push({title:F.D,description:l.a.createElement(H,{type:e.type})}),"anomaly_threshold"in e&&e.anomaly_threshold&&r.push({title:l.a.createElement("span",{"data-test-subj":"anomalyThresholdPropertyTitle"},F.b),description:l.a.createElement(V,{anomalyThreshold:e.anomaly_threshold})}),"machine_learning_job_id"in e&&r.push({title:l.a.createElement("span",{"data-test-subj":"mlJobPropertyTitle"},F.t),description:l.a.createElement(U,{jobIds:e.machine_learning_job_id,isInteractive:t})}),e.related_integrations&&e.related_integrations.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"relatedIntegrationsPropertyTitle"},F.y),description:l.a.createElement(h.b,{relatedIntegrations:e.related_integrations,dataTestSubj:"relatedIntegrationsPropertyValue"})}),e.required_fields&&e.required_fields.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"requiredFieldsPropertyTitle"},F.z),description:l.a.createElement(G,{requiredFields:e.required_fields})}),r.push({title:l.a.createElement("span",{"data-test-subj":"timelineTemplatePropertyTitle"},F.S),description:l.a.createElement(W,{timelineTitle:e.timeline_title||j.b})}),"threshold"in e&&e.threshold&&r.push({title:l.a.createElement("span",{"data-test-subj":"thresholdPropertyTitle"},F.R),description:l.a.createElement($,{threshold:e.threshold})}),"threat_index"in e&&e.threat_index&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatIndexPropertyTitle"},F.O),description:l.a.createElement(Z,{threatIndex:e.threat_index})}),"threat_mapping"in e&&e.threat_mapping&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatMappingPropertyTitle"},F.Q),description:l.a.createElement(K,{threatMapping:e.threat_mapping})}),"threat_filters"in e&&e.threat_filters&&e.threat_filters.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatFiltersPropertyTitle"},F.N),description:l.a.createElement(N,{filters:e.threat_filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"threatFiltersPropertyValue"})}),"threat_query"in e&&e.threat_query&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatQueryPropertyTitle"},y.v),description:l.a.createElement(L,{query:e.threat_query,"data-test-subj":"threatQueryPropertyValue"})}),"alert_suppression"in e&&e.alert_suppression&&("group_by"in e.alert_suppression&&r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionGroupByPropertyTitle"},l.a.createElement(J,{title:F.J})),description:l.a.createElement(Y,{fields:e.alert_suppression.group_by})}),r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionDurationPropertyTitle"},l.a.createElement(J,{title:F.K})),description:l.a.createElement(X,{duration:e.alert_suppression.duration})}),"missing_fields_strategy"in e.alert_suppression&&r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionSuppressionFieldPropertyTitle"},l.a.createElement(J,{title:F.I})),description:l.a.createElement(ee,{missingFieldsStrategy:e.alert_suppression.missing_fields_strategy})})),"new_terms_fields"in e&&e.new_terms_fields&&e.new_terms_fields.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"newTermsFieldsPropertyTitle"},F.v),description:l.a.createElement(te,{newTermsFields:e.new_terms_fields})}),"history_window_start"in e&&r.push({title:l.a.createElement("span",{"data-test-subj":"newTermsWindowSizePropertyTitle"},F.n),description:l.a.createElement(ae,{historyWindowStart:e.history_window_start})}),r})(e,t,c);return l.a.createElement("div",{"data-test-subj":n},l.a.createElement(u.EuiDescriptionList,i()({type:null!==(s=r.type)&&void 0!==s?s:"column",rowGutterSize:null!==(o=r.rowGutterSize)&&void 0!==o?o:"m",listItems:d,columnWidths:a,"data-test-subj":"listItemColumnStepRuleDescription"},r)))};var ie=s()(u.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1lxmnf2-3"})({width:"100%"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(44),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(232);const c=i()(o.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);c.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[n,i]=Object(r.useState)(!1),u=Object(r.useCallback)((async t=>{i(!0),await a(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,a]);return s.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(o.EuiFlexItem,{grow:!1},t||n||Object(l.b)(e.jobState,e.datafeedState)?s.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):s.a.createElement(c,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=s.a.memo(u);d.displayName="JobSwitch"},function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(2),i=a(49),r=a(48),s=a(175),o=a(178),l=a(238),c=a(1263),u=a(4);function d(e){return Object(r.useSelector)((t=>e(t[o.v][o.w])))}function p(e){const t=d(c.c),a=Object(i.useHistory)(),r=d(c.k),{state:o}=Object(i.useLocation)(),u=Object(n.useCallback)((a=>e===s.n?Object(l.k)(r,{...t,...a}):e===s.f?Object(l.l)(r,{...t,...a}):e===s.c?Object(l.i)(r,{...t,...a}):Object(l.m)(r,{...t,...a})),[e,t,r]);return Object(n.useCallback)((e=>a.push(u(e),o)),[u,a,o])}const m=()=>window.location.pathname.includes(u.Yb)&&window.location.pathname.includes("/settings")},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(476),i=a(740);const r=window.localStorage,s={groupById:n.b},o=(e,t)=>{let a={};r&&(a=Object(i.c)(r));const s=((e,t,a)=>{switch(t.type){case n.a.updateActiveGroups:{const{id:i,activeGroups:r}=t.payload;return{...e,groupById:{...a,[i]:{...n.c,...a[i],activeGroups:r}}}}case n.a.updateGroupOptions:{const{id:i,newOptionList:r}=t.payload;return{...e,groupById:{...a,[i]:{...n.c,...a[i],options:r}}}}}throw Error("Unknown grouping action")})(e,t,{...e.groupById,...a});if(r){const e=t.payload.id;Object(i.b)(r,e,s.groupById[e])}return s}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(139),i=a(175);const r=n.b.ENDPOINT_BLOCKLISTS,s={name:i.d,namespace_type:"agnostic",description:i.b,list_id:i.c,type:r},o=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},,function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(2),i=a.n(n),r=a(210),s=a(1065),o=a(385),l=a(690),c=a(897),u=a(1074),d=a(44),p=a.n(d),m=a(17),f=a(5);const b=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),g=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),y=(f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlAdminPermissionsRequiredDescription",{defaultMessage:"ML Admin Permissions required to perform this action"}));var h,v=a(232),E=a(949);!function(e){e.info="info",e.warning="warning",e.error="error"}(h||(h={}));const x=({message:e})=>{if(!e)return null;let t="primary",a="warning";return e.level===h.info?a="iInCircle":e.level===h.warning?t="warning":e.level===h.error&&(t="danger"),i.a.createElement(m.EuiToolTip,{content:e.text},i.a.createElement(m.EuiIcon,{"data-test-subj":"mlJobAuditIcon",type:a,color:t}))},j=Object(n.memo)(x),S=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),O=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),k=({job:e})=>{const t=Object(v.c)(e.jobState,e.datafeedState),a=t?"success":"danger",n=t?S:O;return i.a.createElement(m.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},w=Object(n.memo)(k),T=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ilmnak-0"})(["overflow:hidden;"]),I=({job:e,switchComponent:t,...a})=>{var n;const r=Object(v.c)(e.jobState,e.datafeedState);return i.a.createElement(T,a,i.a.createElement("div",null,i.a.createElement(E.a,{jobId:e.id,jobName:null===(n=e.customSettings)||void 0===n?void 0:n.security_app_display_name}),i.a.createElement(j,{message:e.auditMessage})),i.a.createElement(m.EuiFlexGroup,{justifyContent:"flexStart"},i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},i.a.createElement(w,{job:e})),i.a.createElement(m.EuiFlexItem,{grow:!1},t),i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginLeft:"0"},"data-test-subj":"mlJobActionLabel"},r?g:b)))},C=Object(n.memo)(I),M=({job:e,loading:t,refreshJob:a})=>{const{enableDatafeed:r,disableDatafeed:s,isLoading:o}=Object(c.a)(),l=Object(n.useCallback)((async(t,n,i)=>{i?await r(e,n):await s(e),a(e)}),[r,s,e,a]),d=Object(n.useMemo)((()=>i.a.createElement(u.a,{job:e,isSecurityJobsLoading:t||o,onJobStateChange:l})),[l,o,e,t]);return i.a.createElement(C,{job:e,switchComponent:d})},_=Object(n.memo)(M),A=({jobIds:e})=>{const{loading:t,jobs:a,refetch:n,isMlAdmin:r}=Object(l.a)();if(!r)return null;const s=a.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,s.map((e=>i.a.createElement(_,{key:e.id,job:e,loading:t,refreshJob:n}))))},F=Object(n.memo)(A);var P=a(577),D=a(700),N=a.n(D);const R=({job:e})=>{const t=Object(n.useMemo)((()=>i.a.createElement(m.EuiToolTip,{content:y},i.a.createElement(m.EuiSwitch,{disabled:!0,"data-test-subj":"mlUserJobSwitch",showLabel:!1,label:"",checked:Object(v.c)(e.jobState,e.datafeedState),onChange:N.a}))),[e]);return i.a.createElement(C,{job:e,switchComponent:t})},L=Object(n.memo)(R),B=({jobIds:e})=>{const{isMlUser:t,jobs:a}=Object(P.b)();if(!t)return null;const n=a.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,n.map((e=>i.a.createElement(L,{key:e.id,job:e}))))},z=Object(n.memo)(B),q=({jobIds:e})=>{const t=Object(r.a)(),a=Object(o.a)(t);return Object(s.a)(t)?i.a.createElement(F,{jobIds:e}):a?i.a.createElement(z,{jobIds:e}):null},$=Object(n.memo)(q)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(751),l=a(572);var c=a(5);c.i18n.translate("xpack.securitySolution.expandedValue.showTopN.showTopValues",{defaultMessage:"Show top values"}),c.i18n.translate("xpack.securitySolution.expandedValue.hideTopValues.HideTopValues",{defaultMessage:"Hide top values"});const u=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),d=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),p=c.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),m=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),f=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),b=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),g=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),y=c.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"});var h=a(285),v=a(272),E=a(927),x=a(878);a(110);const j=[{columnId:h.g,label:u},{columnId:"source.ip",fieldType:E.b,label:p},{columnId:"destination.ip",fieldType:E.b,label:p},{columnId:"signal.rule.name",label:m,linkField:"signal.rule.id"},...x.b.map((e=>({columnId:e,label:f}))),{columnId:h.m,label:b},{columnId:h.l,label:b},{columnId:h.e,label:g},{columnId:v.j,label:y},{columnId:h.p,label:d}],S=s.a.div.withConfig({displayName:"StyledContent",componentId:"sc-18lfxbd-0"})(["padding:",";width:100%;margin:0 auto;"],(({$isDetails:e})=>e?"0 8px":void 0)),O=({data:e,ecsData:t,eventId:a,header:r,isDetails:s,isDraggable:c,isTimeline:u,linkValues:d,rowRenderers:p,scopeId:m,truncate:f,asPlainText:b,context:g})=>{const y=Object(n.useMemo)((()=>{return void 0!==(e=r.id,t=r.type,a=r.linkField,j.find((n=>n.columnId===e||!(!n.fieldType||t!==n.fieldType||void 0===a&&void 0===n.linkField))))&&!u;var e,t,a}),[r.id,r.linkField,r.type,u]),h=Object(o.c)({data:e,fieldName:r.id}),v=s?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(S,{className:v,$isDetails:s},((e,t,a,n)=>{const i=t.find((t=>t.isInstance(e,a,n)));return null!=i?i:(()=>{throw new Error("Unhandled Column Renderer")})()})(r.id,l.a,e,g).renderColumn({asPlainText:null!=b?b:y,columnName:r.id,ecsData:t,eventId:a,field:r,isDetails:s,isDraggable:c,linkValues:d,rowRenderers:p,scopeId:m,truncate:f,values:h,context:g}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(213),s=a(415),o=a(110),l=a(474),c=a(406);const u=a(5).i18n.translate("xpack.securitySolution.detectionEngine.rulesSnoozeBadge.error.unableToFetch",{defaultMessage:"Unable to fetch snooze settings"});function d({ruleId:e,showTooltipInline:t=!1}){const a=Object(o.i)().services.triggersActionsUi.getRulesListNotifyBadge,{snoozeSettings:n,error:d}=function(e){var t,a;const{state:{rulesSnoozeSettings:n}}=null!==(t=Object(c.c)())&&void 0!==t?t:{state:{}},{data:i,isFetching:r,isError:s}=Object(l.a)([e],{enabled:!(null!=n&&n.data[e]||null!=n&&n.isFetching)}),o=null!==(a=null==n?void 0:n.data[e])&&void 0!==a?a:null==i?void 0:i[e],d=(null==n?void 0:n.isFetching)||r;return{snoozeSettings:o,error:(null==n?void 0:n.isError)||s||!o&&!d?u:void 0}}(e),[{canUserCRUD:p}]=Object(r.b)(),m=Object(s.c)(p),f=Object(l.b)();return i.a.createElement(a,{ruleId:e,snoozeSettings:n,loading:!n&&!d,disabled:!m||d,showTooltipInline:t,onRuleChanged:f})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return S}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(1140),l=a(17),c=a(110);const u=({integration:e})=>{const t=Object(c.d)(),a=e.integrationTitle,n=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:n,target:"_blank","data-test-subj":"integrationLink"},a)},d=i.a.memo(u);d.displayName="IntegrationLink";var p=a(882);const m=s()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-63ceph-0"})(["margin-left:5px;"]),f=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:a,isEnabled:n}=t,r=a?"success":"#E0E5EE",s=a?n?p.c:p.e:p.j,o=a?n?p.b:p.d:p.i;return i.a.createElement(l.EuiToolTip,{content:s},i.a.createElement(m,{color:r,"data-test-subj":"statusBadge"},o))},b=i.a.memo(f);b.displayName="IntegrationStatusBadge";const g=s.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-8orjjk-0"})(["margin-left:5px;"]),y=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(g,null,i.a.createElement(l.EuiIconTip,{type:"warning",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},h=i.a.memo(y);h.displayName="IntegrationVersionMismatchIcon";const v=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-hszsn0-0"})(["overflow:hidden;"]),E=({integration:e,dataTestSubj:t="integrationDescription"})=>i.a.createElement(v,{"data-test-subj":`${t}-${e.packageName}`},i.a.createElement(d,{integration:e})," ",i.a.createElement(b,{integration:e}),i.a.createElement(h,{integration:e})),x=i.a.memo(E),j=({relatedIntegrations:e,dataTestSubj:t="relatedIntegrationsDescription"})=>{const{integrations:a}=Object(o.a)(e);return i.a.createElement(i.a.Fragment,null,a.map(((e,a)=>i.a.createElement(x,{key:`${e.packageName}-${a}`,integration:e,dataTestSubj:t}))))},S=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(j,{relatedIntegrations:t})}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(5);const c=l.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),u=l.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),d=o()(r.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-15mz0pi-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:40px;height:40px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);d.displayName="RoundBadge";const p=({type:e})=>i.a.createElement(d,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?c:u);p.displayName="RoundedBadge";const m=Object(s.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),f=o()(r.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-1s6c9rb-0"})([""," &:after{top:0;}"],m),b=o()(r.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-1s6c9rb-1"})([""," &:after{bottom:0;}"],m),g=({type:e})=>i.a.createElement(r.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},i.a.createElement(f,{"data-test-subj":"andOrBadgeBarTop",grow:1}),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(p,{type:e})),i.a.createElement(b,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));g.displayName="RoundedBadgeAntenna";const y=i.a.memo((({type:e,includeAntennas:t=!1})=>t?i.a.createElement(g,{type:e}):i.a.createElement(p,{type:e})));y.displayName="AndOrBadge"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(9),i=a(5),r=a(17),s=a(2),o=a.n(s),l=a(53),c=a(883),u=a(231),d=a(4),p=a(232),m=a(146),f=a(307),b=a(893),g=a(169),y=a(110),h=a(682);const v=i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.unknownError",{defaultMessage:"Unknown error while validating ES|QL"}),E=i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingIdInQueryError",{defaultMessage:"Queries that donâ€™t use the STATS...BY function (non-aggregating queries) must include the [metadata _id, _version, _index] operator after the source command. For example: FROM logs* [metadata _id, _version, _index].  In addition, the metadata properties (_id, _version, and _index)  must be returned in the query response."});var x=a(1141);let j;!function(e){e.INVALID_ESQL="ERR_INVALID_ESQL",e.ERR_MISSING_ID_FIELD_FROM_RESULT="ERR_MISSING_ID_FIELD_FROM_RESULT"}(j||(j={}));const S=e=>{return{code:j.INVALID_ESQL,message:null!=e&&e.message?(t=e.message,i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.errorMessage",{values:{message:t},defaultMessage:'Error validating ES|QL: "{message}"'})):v,error:e};var t};var O=a(683),k=a(1118);const w={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:o.a.createElement(r.EuiText,{size:"xs"},O.l),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(p.d)(t.ruleType)&&!Object(u.c)(t.ruleType)&&t.dataSourceType===f.a.IndexPatterns)return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data view"}),fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e,n=null!=a.dataViewId&&""!==a.dataViewId;if(!Object(p.d)(a.ruleType)&&!n&&a.dataSourceType===f.a.DataView)return{path:t,message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},dataViewTitle:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewTitleSelector",{defaultMessage:"Data view index pattern"}),validations:[]},eqlOptions:{},queryBar:{fieldsToValidateOnChange:["queryBar"],validations:[{validator:(...e)=>{const[{value:t,path:a,formData:i}]=e,{query:r,filters:s,saved_id:o}=t;if(!Object(p.d)(i.ruleType)&&Object(n.isEmpty)(r.query)&&Object(n.isEmpty)(s)&&!o)return{code:"ERR_FIELD_MISSING",path:a,message:Object(k.a)(i.ruleType)}}},{validator:(...e)=>{const[{value:t,path:a,formData:i}]=e,{query:r}=t;if(!Object(p.d)(i.ruleType)&&!Object(n.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:O.m}}}},{validator:Object(b.a)(b.b,300)},{validator:Object(b.a)((async(...e)=>{const[{value:t,formData:a}]=e,{query:i}=t,r=i.query,{ruleType:s}=a;if(Object(u.c)(s)&&!Object(n.isEmpty)(r))try{var o;const e=y.b.get(),t=Object(g.e)(r);if(!t&&!/(?<!\|[\s\S.]*)\[\s*metadata[\s\S.]*_id[\s\S.]*\]/i.test(r))return{code:j.ERR_MISSING_ID_FIELD_FROM_RESULT,message:E};const a=await h.b.fetchQuery(Object(x.a)({esqlQuery:r,expressions:e.expressions}));if(a&&"error"in a)return S(a.error);const n=(null!==(o=null==a?void 0:a.columns)&&void 0!==o?o:[]).find((({id:e})=>"_id"===e));if(!t&&!n)return{code:j.ERR_MISSING_ID_FIELD_FROM_RESULT,message:E}}catch(e){return S(e)}}),300)}]},ruleType:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(p.d)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.h)(t.ruleType))return m.h.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.h)(t.ruleType))return m.h.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.h)(t.ruleType))return Object(n.isEmpty)(t["threshold.cardinality.field"])&&!Object(n.isEmpty)(t["threshold.cardinality.value"])?m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.h)(t.ruleType))return Object(n.isEmpty)(t["threshold.cardinality.field"])?void 0:m.h.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:o.a.createElement(r.EuiText,{size:"xs"},O.t),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.g)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(u.g)(t.ruleType))return c.b.forbiddenField(a,"*")}}]},threatMapping:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;if(Object(u.g)(a.ruleType))return Object(c.j)(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:O.u}:Object(c.a)(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:O.s}:void 0}}]},threatQueryBar:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:i}]=e;if(!Object(u.g)(i.ruleType))return;const{query:r,filters:s}=t;return Object(n.isEmpty)(r.query)&&Object(n.isEmpty)(s)?{code:"ERR_FIELD_MISSING",path:a,message:O.f}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:i}]=e;if(!Object(u.g)(i.ruleType))return;const{query:r}=t;if(!Object(n.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:O.m}}}}]},groupByFields:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"}),labelAppend:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabelAppend",{defaultMessage:"Optional (Technical Preview)"})),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.f)(t.ruleType))return m.h.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}}]},groupByRadioSelection:{},groupByDuration:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByDurationValueLabel",{defaultMessage:"Suppress alerts for"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByDurationValueHelpText",{defaultMessage:"Suppress alerts for"}),value:{},unit:{}},suppressionMissingFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.suppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})},newTermsFields:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.e)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.e)(t.ruleType))return m.h.maxLengthField({length:d.Mb,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},shouldLoadQueryDynamically:{type:m.a.CHECKBOX,defaultValue:!1},enableThresholdSuppression:{type:m.a.CHECKBOX,defaultValue:!1}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f}));var n=a(2),i=a(231),r=a(307),s=a(110),o=a(146),l=a(1086),c=a(1139),u=a(1119),d=a(1130),p=a(241);const m=({defineStepDefault:e,aboutStepDefault:t,scheduleStepDefault:a,actionsStepDefault:r})=>{const{triggersActionsUi:{actionTypeRegistry:p}}=Object(s.i)().services,{form:m}=Object(o.k)({defaultValue:e,options:{stripEmptyFields:!1},schema:l.a}),[f,b]=Object(n.useState)(e.eqlOptions),[g]=Object(o.m)({form:m}),y=Object(n.useMemo)((()=>"index"in g?{...g,eqlOptions:f}:e),[e,g,f]),h=Object(n.useMemo)((()=>Object(i.g)(y.ruleType)?c.b:c.a),[y.ruleType]),{form:v}=Object(o.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:h}),[E]=Object(o.m)({form:v}),x="name"in E?E:t,{form:j}=Object(o.k)({defaultValue:a,options:{stripEmptyFields:!1},schema:u.a}),[S]=Object(o.m)({form:j}),O="interval"in S?S:a,k=Object(n.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(d.a)(e)}]},responseActions:{},enabled:{},kibanaSiemAppUrl:{}}))({actionTypeRegistry:p})),[p]),{form:w}=Object(o.k)({defaultValue:r,options:{stripEmptyFields:!1},schema:k}),[T]=Object(o.m)({form:w});return{defineStepForm:m,defineStepData:y,aboutStepForm:v,aboutStepData:x,scheduleStepForm:j,scheduleStepData:O,actionsStepForm:w,actionsStepData:"actions"in T?T:r,eqlOptionsSelected:f,setEqlOptionsSelected:b}},f=({dataSourceType:e,index:t,dataViewId:a})=>{const{data:i}=Object(s.i)().services,[o,{browserFields:l,indexPatterns:c}]=Object(p.b)(t),[u,d]=Object(n.useState)(c);return Object(n.useEffect)((()=>{e!==r.a.IndexPatterns||o||d(c),e===r.a.DataView&&(async()=>{if(null!=a){const e=await i.dataViews.get(a);d(e)}})()}),[e,o,i,a,c]),{indexPattern:u,isIndexPatternLoading:o,browserFields:l}}},,,,,,,,,,,function(e,t,a){e.exports=a(24)(1233)},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(44),s=a.n(r),o=a(17);const l=s.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-1nku0d-0"})(["width:100%;display:inline-grid;"]),c=({tooltipContent:e,children:t,healthColor:a,dataTestSubj:n})=>i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(o.EuiHealth,{color:a,"data-test-subj":n},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));c.displayName="HealthTruncateText"},,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(45),i=a(17),r=a(2),s=a.n(r),o=a(324),l=a.n(o),c=a(930),u=a.n(c),d=a(44),p=a.n(d),m=a(72),f=a(47),b=a(142),g=a(4),y=a(146),h=a(110),v=a(943);const E=[{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onActiveAlert",inputDisplay:v.d,"data-test-subj":"onActiveAlert",dropdownDisplay:s.a.createElement(i.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(f.FormattedMessage,{defaultMessage:"Per rule run",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.label"})))}},{isSummaryOption:!0,isForEachAlertOption:!1,value:{value:"onThrottleInterval",inputDisplay:v.a,"data-test-subj":"onThrottleInterval",dropdownDisplay:s.a.createElement(i.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(f.FormattedMessage,{defaultMessage:"Custom frequency",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.label"})))}}],x=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-kyvj3t-0"})(["p{margin-bottom:0;}"]),j=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-kyvj3t-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__children {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),S=({field:e,messageVariables:t,summaryMessageVariables:a})=>{const[o,c]=Object(r.useState)(null),d=Object(y.l)(),{isValid:p}=d,{triggersActionsUi:{getActionForm:f}}=Object(h.i)().services,[S,O]=Object(r.useState)(!1),k=Object(r.useMemo)((()=>Object(n.isEmpty)(e.value)?[]:e.value),[e.value]),w=Object(r.useMemo)((()=>k.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[k]),T=Object(r.useCallback)(((t,a)=>{const i=[...k];Object(n.isEmpty)(i[a].params)&&O(!0),i[a]=l()(i[a],{id:t}),e.setValue(i)}),[e,k]),I=Object(r.useCallback)((t=>e.setValue(t)),[e]),C=Object(r.useCallback)(((t,a,n)=>{const i=()=>{e.setValue((e=>{const i=[...e];return i[n]={...i[n],params:{...i[n].params,[t]:a}},i}))};S?(setTimeout(i,0),O(!1)):i()}),[e,S]),M=Object(r.useCallback)(((t,a,i)=>{e.setValue((e=>{const r=[...e],{alertsFilter:s,...o}=r[i],l={...s};return a?l[t]=a:delete l[t],r[i]={...o,...Object(n.isEmpty)(l)?{}:{alertsFilter:l}},r}))}),[e]),_=Object(r.useCallback)(((t,a,n)=>{e.setValue((e=>{var i;const r=[...e];return r[n]={...r[n],frequency:{...null!==(i=r[n].frequency)&&void 0!==i?i:g.Sb,[t]:a}},r}))}),[e]),A=void 0!==p,F=Object(r.useMemo)((()=>f({actions:k,messageVariables:t,summaryMessageVariables:a,defaultActionGroupId:"default",setActionIdByIndex:T,setActions:I,setActionParamsProperty:C,setActionFrequencyProperty:_,setActionAlertsFilterProperty:M,featureId:m.SecurityConnectorFeatureId,producerId:b.sb.SIEM,defaultActionMessage:v.c,defaultSummaryMessage:v.e,hideActionHeader:!0,hasAlertsMappings:!0,notifyWhenSelectOptions:E,defaultRuleFrequency:g.Sb,disableErrorMessages:!A})),[k,f,t,a,_,T,C,I,M,A]);return Object(r.useEffect)((()=>{if(!1===p){const t=e.errors.map((({message:e})=>e)).join("\n");return c(t)}return c(null)}),[e.errors,p]),s.a.createElement(j,{$caseIndexes:w},o?s.a.createElement(s.a.Fragment,null,s.a.createElement(x,null,s.a.createElement(i.EuiCallOut,{title:v.b,color:"danger",iconType:"warning"},s.a.createElement(u.a,null,o))),s.a.createElement(i.EuiSpacer,null)):null,F)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));const n={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1,enabled:void 0,ruleExecutionStatus:void 0},i={field:"enabled",order:"desc"},r=1,s=20},function(e,t,a){const n=a(173),i=a(304),{safeRe:r,t:s}=a(316);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){let t;for(;(t=r[s.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&t.index+t[0].length===a.index+a[0].length||(a=t),r[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[s.COERCERTL].lastIndex=-1}else a=e.match(r[s.COERCE]);return null===a?null:i(`${a[2]}.${a[3]||"0"}.${a[4]||"0"}`,t)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a(50),r=a(560),s=a(117),o=a(154);const l=({savedQueryId:e,ruleType:t,onError:a})=>{var l;const c=Object(r.a)(),{addError:u}=Object(s.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?c.getSavedQuery(e):null),{onError:null!=a?a:e=>{u(e,{title:o.Lc})},retry:!1,refetchOnWindowFocus:!1}),p=Object(n.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(683),i=a(231);const r=e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))},s=e=>Object(i.c)(e)?n.j:Object(i.b)(e)?n.h:n.f},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(5);const i={interval:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}}},,,function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),r=n.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),s=n.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=n.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=n.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"});n.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(2),i=a(5),r=a(48),s=a(128),o=a(112),l=a(121),c=a(116),u=a(334),d=a(117),p=a(110),m=a(477),f=a(149);const b=()=>{const{indicesExist:e,dataViewId:t}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:a}=Object(u.b)(),b=Object(r.useDispatch)(),{addError:g}=Object(d.a)(),y=Object(n.useRef)(new AbortController),{data:{dataViews:h}}=Object(p.i)().services,v=Object(n.useMemo)((()=>s.e.defaultDataViewSelector()),[]),E=Object(n.useMemo)((()=>s.e.signalIndexNameSelector()),[]),x=Object(o.a)(E),j=Object(o.a)(v),S=Object(n.useMemo)((()=>!j.title.includes(`${x}`)),[j.title,x]),O=Object(n.useMemo)((()=>!e&&!S),[e,S]),k=Object(n.useCallback)((()=>{null!==x&&(y.current.abort(),(async()=>{y.current=new AbortController;try{const e=await Object(m.a)({body:{patternList:j.title.split(",")},signal:y.current.signal,dataViewId:t,dataViewService:h});null!==x&&null!=e&&e.defaultDataView.patternList.includes(x)&&(a({dataViewId:e.defaultDataView.id}),b(f.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||g(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,t,h,j.title,b,a,x]);return{...O?{pollForSignalIndex:k}:{},signalIndexNeedsInit:S}}},function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return i})),function(e){e.GROUP_TOGGLED="alerts_table_toggled_",e.GROUPED_ALERTS="alerts_table_group_by_"}(n||(n={}));const i={groupToggled:({isOpen:e,groupingId:t,groupNumber:a})=>`${n.GROUP_TOGGLED}${e?"on":"off"}_${t}_group-${a}`,groupChanged:({groupingId:e,selected:t})=>`${n.GROUPED_ALERTS}${e}_${t}`}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j}));var n=a(17),i=a(2),r=a.n(i),s=a(45),o=a(124),l=a(18),c=a(112),u=a(572),d=a(470),p=a(318),m=a(266),f=a(285),b=a(121),g=a(1081),y=a(764),h=a(4),v=a(241),E=a(357);const x=e=>{var t,a,o,l,c,u;const{columnId:b,rowIndex:h,scopeId:v}=e,E=Object(i.useMemo)((()=>b===f.n&&Object(p.c)(v)&&0===h&&!e.isDetails),[b,e.isDetails,h,v]),x=null===(t=e.ecsData)||void 0===t||null===(a=t.kibana)||void 0===a||null===(o=a.alert.suppression)||void 0===o||null===(l=o.docs_count)||void 0===l?void 0:l[0],j=null===(c=Object(s.find)({field:"kibana.alert.suppression.docs_count"},e.data))||void 0===c||null===(u=c.value)||void 0===u?void 0:u[0],S=x?parseInt(x,10):j,O=r.a.createElement(d.a,{isTourAnchor:E,step:m.a.pointToAlertName,tourId:m.b.alertsCases},r.a.createElement(g.a,e));return b===f.n&&S&&S>0?r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"top",content:Object(y.c)(S)},r.a.createElement(n.EuiIcon,{type:"layers"}))),r.a.createElement(n.EuiFlexItem,{grow:!1},O)):O},j=({scopeId:e,tableId:t})=>({context:a})=>{var n;const{browserFields:d}=Object(b.d)(e),p=Object(i.useMemo)((()=>Object(v.a)(d)),[d]),m=Object(i.useMemo)((()=>o.j.getTableByIdSelector()),[]),f=Object(l.b)(),g=(null!==(n=Object(c.b)((e=>{var a;return(null!==(a=m(e,t))&&void 0!==a?a:o.q).viewMode})))&&void 0!==n?n:o.q.viewMode)===h.Mc.gridView?Object(E.c)(f):E.b;return Object(i.useCallback)((({columnId:e,colIndex:n,data:i,ecsData:o,eventId:l,header:c,isDetails:m=!1,isDraggable:f=!1,isExpandable:b,isExpanded:y,rowIndex:h,rowRenderers:v,setCellProps:E,linkValues:j,truncate:S=!0})=>{var O;const k=null!=c?c:{id:e,...p[e]},w=i.map((e=>{let t=e;if(["_id","_index"].includes(e.field)){var a;const n=null!==(a=e.value)&&void 0!==a?a:"";t={field:e.field,value:Array.isArray(n)?n:[n]}}return t})),T=g.find((t=>t.id===e)),I=Object(s.getOr)([],null!==(O=null==T?void 0:T.linkField)&&void 0!==O?O:"",o);return r.a.createElement(x,{browserFields:d,columnId:e,data:w,ecsData:o,eventId:l,header:k,isDetails:m,isDraggable:f,isExpandable:b,isExpanded:y,linkValues:null!=j?j:I,rowIndex:h,colIndex:n,rowRenderers:null!=v?v:u.b,setCellProps:E,scopeId:t,truncate:S,asPlainText:!1,context:a})}),[p,g,d,a])}},function(e,t,a){"use strict";var n=a(888);a.d(t,"a",(function(){return n.a}))},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(83),i=a(1260),r=a.n(i),s=a(45),o=a(5);const l=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(s.startCase)(t):""},c=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(s.isString)(e)||Object(s.isArray)(e))),a=Object(s.uniq)(Object(s.flattenDeep)(t));if(a.length)return a}}return[]})(e,t),i=(e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(s.isString)(a))try{r.a.render(a,{})}catch(a){t.push((e=>o.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(s.startCase)(e)}}))(e))}})),t})(e.params),l=Object(n.validateActionFilterQuery)(e);return[...a,...i,...l?[l]:[]]},u=(e,t=100)=>a=>{let n=!1;const i=new Promise((i=>{setTimeout((()=>{n?i():i((e=>async(...t)=>{const[{value:a,path:n}]=t,i=[];for(const t of a){const a=await c(t,e);if(a.length){const e=l(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${n.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${i.join("\n")}`}})(e)(a))}),t)}));return i.cancel=()=>{n=!0},i}},,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return F})),a.d(t,"a",(function(){return P}));var n=a(2),i=a.n(n),r=a(17),s=a(44),o=a.n(s),l=a(48),c=a(124),u=a(127),d=a(110),p=a(5);const m=p.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),f=p.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var b=a(122),g=a(118),y=a(121),h=a(282),v=a(134),E=a(112),x=a(745),j=a(116),S=a(1078),O=a(4),k=a(1109),w=a(562),T=a(189),I=a(446),C=a(135);const M=o()(r.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-tyt961-0"})(["margin:4px 0 4px 0;"]),_=({fullScreen:e,globalFullScreen:t,onCloseOverlay:a,isActiveTimelines:n,timelineFullScreen:s,toggleFullScreen:o,graphEventId:l,activeTab:c})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:a,size:"xs","data-test-subj":"close-overlay"},n?c===b.d.graph?m:f:l?m:f)),!1===n&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:e?w.a:k.d},i.a.createElement(M,{"aria-label":Object(S.b)({globalFullScreen:t,isActiveTimelines:n,timelineFullScreen:s})?w.a:k.d,display:e?"fill":"empty",color:"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));_.displayName="NavigationComponent";const A=i.a.memo(_),F=({scopeId:e})=>{const t=Object(l.useDispatch)(),a=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?g.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?c.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:r,setGlobalFullScreen:s}=Object(T.a)(),{timelineFullScreen:o,setTimelineFullScreen:d}=Object(T.c)(),p=Object(u.isTimelineScope)(e)?v.b:c.q,{graphEventId:m,sessionViewConfig:f,activeTab:y,prevActiveTab:h}=Object(E.a)((t=>{var n;return{activeTab:v.b.activeTab,prevActiveTab:v.b.prevActiveTab,...null!==(n=a&&a(t,e))&&void 0!==n?n:p}})),x=Object(u.getScopedActions)(e),j=Object(n.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(u.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(O.rc,"euiDataGrid__restrictBody"):Object(u.isActiveTimeline)(e)?d(!1):s(!1),!1===Object(u.isActiveTimeline)(e)?x&&(t(x.updateGraphEventId({id:e,graphEventId:""})),t(x.updateSessionViewConfig({id:e,sessionViewConfig:null}))):y===b.d.graph?(x&&t(x.updateGraphEventId({id:e,graphEventId:""})),h!==b.d.session||f||t(g.a.setActiveTabTimeline({id:e,activeTab:b.d.query}))):y===b.d.session&&(Object(u.isTimelineScope)(e)&&(h!==b.d.graph||m?t(g.a.setActiveTabTimeline({id:e,activeTab:h})):t(g.a.setActiveTabTimeline({id:e,activeTab:b.d.query}))),x&&t(x.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[d,s,x,t,e,y,h,f,m]),k=Object(n.useMemo)((()=>Object(S.b)({globalFullScreen:r,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o})),[r,e,o]),w=Object(n.useCallback)((()=>{Object(u.isActiveTimeline)(e)?d(!o):s(!r)}),[e,d,o,s,r]),I=Object(n.useMemo)((()=>i.a.createElement(A,{fullScreen:k,globalFullScreen:r,activeTab:y,onCloseOverlay:j,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o,toggleFullScreen:w,graphEventId:m})),[k,r,y,j,e,o,w,m]);return{onCloseOverlay:j,Navigation:I}},P=({scopeId:e,entityType:t,height:a})=>{const{sessionView:r}=Object(d.i)().services,s=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?g.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?c.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:o}=Object(T.a)(),{timelineFullScreen:p}=Object(T.c)(),{canReadPolicyManagement:m}=Object(C.a)().endpointPrivileges,f=Object(u.isTimelineScope)(e)?v.b:c.q,{sessionViewConfig:O,activeTab:k}=Object(E.a)((t=>{var a;return{activeTab:v.b.activeTab,prevActiveTab:v.b.prevActiveTab,...null!==(a=s&&s(t,e))&&void 0!==a?a:f}})),w=Object(n.useMemo)((()=>Object(S.b)({globalFullScreen:o,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:p})),[o,e,p]),M=Object(n.useMemo)((()=>Object(u.isActiveTimeline)(e)?j.SourcererScopeName.timeline:I.a.includes(e)?j.SourcererScopeName.detections:j.SourcererScopeName.default),[e]),{openEventDetailsPanel:_,shouldShowDetailsPanel:A,DetailsPanel:F}=(({entityType:e,isFlyoutView:t,sourcererScope:a,scopeId:r,tabType:s=b.d.query})=>{const{browserFields:o,selectedPatterns:d,runtimeMappings:p}=Object(y.d)(a),m=Object(l.useDispatch)(),f=Object(n.useMemo)((()=>Object(u.isTimelineScope)(r)?g.b.getTimelineByIdSelector():Object(u.isInTableScope)(r)?c.j.getTableByIdSelector():void 0),[r]),j=Object(n.useMemo)((()=>d.join(",")),[d]),S=Object(E.a)((e=>{var t,a;return null===(t=null!==(a=f&&f(e,r))&&void 0!==a?a:v.b)||void 0===t?void 0:t.expandedDetail})),O=Object(n.useRef)((()=>{})),k=()=>{},w=Object(n.useMemo)((()=>{var e;return!!(s&&S&&S[s]&&null!==(e=S[s])&&void 0!==e&&e.panelView)}),[S,s]),T=Object(u.getScopedActions)(r),I=Object(n.useCallback)((e=>{e&&T&&m(T.toggleDetailPanel({...e,tabType:s,id:r}))}),[T,r,m,s]),C=Object(n.useCallback)(((e,t)=>{e&&I({panelView:"eventDetail",params:{eventId:e,indexName:j}}),O.current=null!=t?t:k}),[I,j]),M=Object(n.useCallback)(((e,t)=>{I({panelView:"hostDetail",params:{hostName:e}}),O.current=null!=t?t:k}),[I]),_=Object(n.useCallback)(((e,t,a)=>{I({panelView:"networkDetail",params:{ip:e,flowTarget:t}}),O.current=null!=a?a:k}),[I]),A=Object(n.useCallback)(((e,t)=>{I({panelView:"userDetail",params:{userName:e}}),O.current=null!=t?t:k}),[I]),F=Object(n.useCallback)((()=>{var e;O.current&&O.current(),T&&m(T.toggleDetailPanel({tabType:s,id:r})),s&&null!==(e=S[s])&&void 0!==e&&e.panelView&&r===b.c.active&&w&&h.a.toggleExpandedDetail({})}),[T,s,S,r,w,m]),P=Object(n.useMemo)((()=>w?i.a.createElement(x.a,{browserFields:o,entityType:e,handleOnPanelClosed:F,isFlyoutView:t,runtimeMappings:p,tabType:s,scopeId:r}):null),[o,e,F,t,p,w,s,r]);return{openEventDetailsPanel:C,openHostDetailsPanel:M,openNetworkDetailsPanel:_,openUserDetailsPanel:A,handleOnDetailsPanelClosed:F,shouldShowDetailsPanel:w,DetailsPanel:P}})({isFlyoutView:!Object(u.isActiveTimeline)(e),entityType:t,sourcererScope:M,scopeId:e,tabType:Object(u.isActiveTimeline)(e)?k:b.d.query}),P=Object(n.useMemo)((()=>{const e=a?a-118:void 0;return null!==O?r.getSessionView({...O,loadAlertDetails:_,isFullScreen:w,height:e,canReadPolicyManagement:m}):null}),[a,O,r,_,w,m]);return{openEventDetailsPanel:_,shouldShowDetailsPanel:A,SessionView:P,DetailsPanel:F}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(2),i=a.n(n),r=a(47);const s=a(5).i18n.translate("xpack.securitySolution.detectionEngine.ruleInfo.UnknownText",{defaultMessage:"Unknown"});var o=a(155);const l=({createdBy:e,createdAt:t,"data-test-subj":a})=>i.a.createElement("div",{"data-test-subj":a},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!=e?e:s,date:i.a.createElement(o.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"createdAt"})}}));l.displayName="CreatedBy";const c=({updatedBy:e,updatedAt:t,"data-test-subj":a})=>i.a.createElement("div",{"data-test-subj":a},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!=e?e:s,date:i.a.createElement(o.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"updatedAt"})}}));c.displayName="UpdatedBy"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(50),i=(a(2),a(110));const r=["POST","/api/ml/jobs/jobs_summary"],s=(e,t)=>Object(n.useQuery)([r,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(5),i=a(146),r=a(17),s=a(2),o=a.n(s),l=a(154);const c=o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},l.Zb);var u=a(226),d=a(1157);const{emptyField:p}=i.h,m={author:{type:i.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:c,validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:i.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:i.a.TEXTAREA,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:i.a.CHECKBOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:c},isAssociatedToEndpointList:{type:i.a.CHECKBOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:c},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:c,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object(u.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:d.k}:void 0}}]},falsePositives:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:c},investigationFields:{type:i.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldCustomHighlightedFieldsLabel",{defaultMessage:"Custom highlighted fields"}),labelAppend:c},license:{type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:c},ruleNameOverride:{type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:c},threat:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:c},threatIndicatorPath:{type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:c},timestampOverride:{type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:c},timestampOverrideFallbackDisabled:{type:i.a.CHECKBOX,defaultValue:!1,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:c},tags:{type:i.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:c,validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:i.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:i.a.TEXTAREA,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:c}},f={type:i.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:i.g.FIELD}]},b={...m,threatIndicatorPath:f}},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a(9),r=a(1235),s=a.n(r);const o=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=s.a.valid(s.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,a)=>`app/integrations/detail/${a?`${e}-${a}`:e}/overview${t?`?integration=${t}`:""}`;var u=a(1326);const d=e=>{const{data:t}=Object(u.a)({packages:[]});return Object(n.useMemo)((()=>{const a=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const a=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=a?a:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:a,installed:n,isLoaded:i}=e,r=a.package,u=null!==(t=a.integration)&&void 0!==t?t:null,d=a.version;if(!i){const e=o(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!1}}}if(null==n){const e=o(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var p;const e=null!==(p=n.integration_title)&&void 0!==p?p:n.package_title,t=n.package_version,a=s.a.satisfies(t,d),i=a?t:l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:i,targetUrl:c(r,u,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:n.is_enabled,isVersionMismatch:!a,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:a,isLoaded:null!=t}}),[e,t])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(64),i=a(3),r=a(54);const s=({esqlQuery:e,expressions:t})=>{const a=`${e} | limit 0`;return{queryKey:[(null!=e?e:"").trim()],queryFn:async()=>{if(!e)return null;try{const e=await function(e,t,a){return Object(r.textBasedQueryStateToAstWithValidation)({query:e,time:void 0}).then((e=>{if(e){const a=t.run(e,null);let r,s;return a.pipe(Object(n.pluck)("result")).subscribe((e=>{const t=e;"error"===t.type?s=t.error.message:r=t})),Object(i.lastValueFrom)(a).then((()=>{if(s)throw new Error(s);return r}))}})).catch((e=>{throw new Error(e.message)}))}({esql:a},t);return e}catch(e){return{error:e}}},staleTime:6e4}}},,function(e,t,a){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,a){e.exports=a.p+"1cbd62546f764080f7071e03889e9de3.svg"},,,,,,,function(e,t,a){var n=a(703),i=a(701),r=a(702),s=a(274),o=a(1099),l=a(1152),c=a(1153),u=a(1154),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||r(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!n(e).length;for(var a in e)if(d.call(e,a))return!1;return!0}},function(e,t,a){e.exports=a(24)(1229)},function(e,t,a){e.exports=a(24)(1232)},function(e,t,a){e.exports=a(24)(1621)},function(e,t,a){e.exports=a(24)(172)},,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(24)(1919)},function(e,t,a){e.exports=a(24)(3706)},function(e,t,a){"use strict";e.exports=function(e){var t=this;this.Parser=function(a){return n(a,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var n=a(1174)},function(e,t,a){"use strict";e.exports=a(1175)},function(e,t,a){"use strict";e.exports=function(e,t,a){return"string"!=typeof t&&(a=t,t=void 0),function(e){var t=e||{},a=function(e,t){for(var a=-1;++a<t.length;)m(e,t[a]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:g(M),autolinkProtocol:j,autolinkEmail:j,atxHeading:g(T),blockQuote:g((function(){return{type:"blockquote",children:[]}})),characterEscape:j,characterReference:j,codeFenced:g(w),codeFencedFenceInfo:y,codeFencedFenceMeta:y,codeIndented:g(w,y),codeText:g((function(){return{type:"inlineCode",value:""}}),y),codeTextData:j,data:j,codeFlowValue:j,definition:g((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:y,definitionLabelString:y,definitionTitleString:y,emphasis:g((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:g(I),hardBreakTrailing:g(I),htmlFlow:g(C,y),htmlFlowData:j,htmlText:g(C,y),htmlTextData:j,image:g((function(){return{type:"image",title:null,url:"",alt:null}})),label:y,link:g(M),listItem:g((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){f("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:g(_,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:g(_),paragraph:g((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:y,resourceDestinationString:y,resourceTitleString:y,setextHeading:g(T),strong:g((function(){return{type:"strong",children:[]}})),thematicBreak:g((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:v(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:v(),autolinkEmail:function(e){S.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){S.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:v(),characterEscapeValue:S,characterReferenceMarkerHexadecimal:k,characterReferenceMarkerNumeric:k,characterReferenceValue:function(e){var t,a,n=this.sliceSerialize(e),i=f("characterReferenceType");i?(t=o(n,"characterReferenceMarkerNumeric"===i?10:16),u("characterReferenceType")):t=d(n),(a=this.stack.pop()).value+=t,a.position.end=b(e.end)},codeFenced:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){f("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:S,codeIndented:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:S,data:S,definition:v(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:v(),hardBreakEscape:v(O),hardBreakTrailing:v(O),htmlFlow:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:S,htmlText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:S,image:v((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=s(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(f("atHardBreak"))return t.children[t.children.length-1].position.end=b(e.end),void u("atHardBreak");!f("setextHeadingSlurpLineEnding")&&a.canContainEols.indexOf(t.type)>-1&&(j.call(this,e),S.call(this,e))},link:v((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:v(),listOrdered:v(),listUnordered:v(),paragraph:v(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:v((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:v(),thematicBreak:v()}},t.mdastExtensions||[]),l={};return function(e){for(var t,n=[{type:"root",children:[]}],s=[],o=[],l=-1,d={stack:n,tokenStack:s,config:a,enter:h,exit:E,buffer:y,resume:x,setData:u,getData:f};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?o.push(l):l=c(e,o.pop(l),l));for(l=-1;++l<e.length;)t=a[e[l][0]],r.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(s.length)throw new Error("Cannot close document, a token (`"+s[s.length-1].type+"`, "+p({start:s[s.length-1].start,end:s[s.length-1].end})+") is still open");return n[0].position={start:b(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:b(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},n[0]};function c(e,t,a){for(var n,i,r,s,o,l,c,u=t-1,d=-1,p=!1;++u<=a;)if("listUnordered"===(o=e[u])[1].type||"listOrdered"===o[1].type||"blockQuote"===o[1].type?("enter"===o[0]?d++:d--,c=void 0):"lineEndingBlank"===o[1].type?"enter"===o[0]&&(!n||c||d||l||(l=u),c=void 0):"linePrefix"===o[1].type||"listItemValue"===o[1].type||"listItemMarker"===o[1].type||"listItemPrefix"===o[1].type||"listItemPrefixWhitespace"===o[1].type||(c=void 0),!d&&"enter"===o[0]&&"listItemPrefix"===o[1].type||-1===d&&"exit"===o[0]&&("listUnordered"===o[1].type||"listOrdered"===o[1].type)){if(n){for(i=u,r=void 0;i--;)if("lineEnding"===(s=e[i])[1].type||"lineEndingBlank"===s[1].type){if("exit"===s[0])continue;r&&(e[r][1].type="lineEndingBlank",p=!0),s[1].type="lineEnding",r=i}else if("linePrefix"!==s[1].type&&"blockQuotePrefix"!==s[1].type&&"blockQuotePrefixWhitespace"!==s[1].type&&"blockQuoteMarker"!==s[1].type&&"listItemIndent"!==s[1].type)break;l&&(!r||l<r)&&(n._spread=!0),n.end=b(r?e[r][1].start:o[1].end),e.splice(r||u,0,["exit",n,o[2]]),u++,a++}"listItemPrefix"===o[1].type&&(n={type:"listItem",_spread:!1,start:b(o[1].start)},e.splice(u,0,["enter",n,o[2]]),u++,a++,l=void 0,c=!0)}return e[t][1]._spread=p,a}function u(e,t){l[e]=t}function f(e){return l[e]}function b(e){return{line:e.line,column:e.column,offset:e.offset}}function g(e,t){return function(a){h.call(this,e(a),a),t&&t.call(this,a)}}function y(){this.stack.push({type:"fragment",children:[]})}function h(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:b(t.start)},e}function v(e){return function(t){e&&e.call(this,t),E.call(this,t)}}function E(e){var t=this.stack.pop(),a=this.tokenStack.pop();if(!a)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): itâ€™s not open");if(a.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+a.type+"`, "+p({start:a.start,end:a.end})+") is open");return t.position.end=b(e.end),t}function x(){return n(this.stack.pop())}function j(e){var t=this.stack[this.stack.length-1].children,a=t[t.length-1];a&&"text"===a.type||((a={type:"text",value:""}).position={start:b(e.start)},this.stack[this.stack.length-1].children.push(a)),this.stack.push(a)}function S(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=b(e.end)}function O(){u("atHardBreak",!0)}function k(e){u("characterReferenceType",e.type)}function w(){return{type:"code",lang:null,meta:null,value:""}}function T(){return{type:"heading",depth:void 0,children:[]}}function I(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function _(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(a)(u(l(a).document().write(c()(e,t,!0))))};var n=a(1176),i=a(414),r=a(931),s=a(673),o=a(1177),l=a(1178),c=a(1217),u=a(1218),d=a(936),p=a(1219);function m(e,t){var a,n;for(a in t)n=r.call(e,a)?e[a]:e[a]={},"canContainEols"===a?e[a]=[].concat(n,t[a]):Object.assign(n,t[a])}},function(e,t,a){"use strict";function n(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],a=-1;++a<e.length;)t[a]=n(e[a]);return t.join("")}e.exports=n},function(e,t,a){"use strict";var n=a(533);e.exports=function(e,t){var a=parseInt(e,t);return a<9||11===a||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||65535==(65535&a)||65534==(65535&a)||a>1114111?"ï¿½":n(a)}},function(e,t,a){"use strict";var n=a(1179),i=a(1180),r=a(1181),s=a(934),o=a(1184),l=a(1185),c=a(674),u=a(1188);e.exports=function(e){var t={defined:[],constructs:o([u].concat(c((e||{}).extensions))),content:a(n),document:a(i),flow:a(r),string:a(s.string),text:a(s.text)};return t;function a(e){return function(a){return l(t,e,a)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(156),i=a(171);t.tokenize=function(e){var t,a=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,a,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),r(t)}));return a;function r(a){var n=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=n),t=n,s(a)}function s(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):n(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),s)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(156),i=a(171),r=a(534),s={tokenize:function(e,t,a){return i(e,e.attempt(this.parser.constructs.document,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},o={tokenize:function(e,t,a){return i(e,e.lazy(this.parser.constructs.flow,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,a,i,l=this,c=[],u=0,d={tokenize:function(e,n){var i=0;return t={},u;function u(n){return i<c.length?(l.containerState=c[i][1],e.attempt(c[i][0].continuation,d,p)(n)):a.currentConstruct&&a.currentConstruct.concrete?(t.flowContinue=!0,b(n)):(l.interrupt=a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(s,f,b)(n))}function d(e){return i++,l.containerState._closeFlow?f(e):u(e)}function p(t){return a.currentConstruct&&a.currentConstruct.lazy?(l.containerState={},e.attempt(s,f,e.attempt(o,f,e.check(r,f,m)))(t)):f(t)}function m(e){return i=c.length,t.lazy=!0,t.flowContinue=!0,b(e)}function f(e){return t.flowEnd=!0,b(e)}function b(e){return t.continued=i,l.interrupt=l.containerState=void 0,n(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,f)(t)):f(t)}function m(e){return u++,p(e)}function f(n){return t&&t.flowContinue?g(n):(l.interrupt=a&&a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(s,b,g)(n))}function b(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,f(e)}function g(t){return null===t?(E(0,!0),void e.consume(t)):(a=a||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:a}),y(t))}function y(t){return null===t?(v(e.exit("chunkFlow")),g(t)):n(t)?(e.consume(t),v(e.exit("chunkFlow")),e.check(d,h)):(e.consume(t),y)}function h(e){return E(t.continued,t&&t.flowEnd),u=0,p(e)}function v(e){i&&(i.next=e),i=e,a.lazy=t&&t.lazy,a.defineSkip(e.start),a.write(l.sliceStream(e))}function E(t,n){var r=c.length;for(a&&n&&(a.write([null]),i=a=void 0);r-- >t;)l.containerState=c[r][1],c[r][0].exit.call(l,e);c.length=t}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1182),i=a(171),r=a(534);t.tokenize=function(e){var t=this,a=e.attempt(r,(function(n){if(null!==n)return e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),t.currentConstruct=void 0,a;e.consume(n)}),e.attempt(this.parser.constructs.flowInitial,s,i(e,e.attempt(this.parser.constructs.flow,s,e.attempt(n,s)),"linePrefix")));return a;function s(n){if(null!==n)return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),t.currentConstruct=void 0,a;e.consume(n)}}},function(e,t,a){"use strict";var n=a(156),i=a(535),r=a(933),s=a(171),o={tokenize:function(e,t){var a;return function(t){return e.enter("content"),a=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):n(t)?e.check(l,s,r)(t):(e.consume(t),i)}function r(a){return e.exit("chunkContent"),e.exit("content"),t(a)}function s(t){return e.consume(t),e.exit("chunkContent"),a=a.next=e.enter("chunkContent",{contentType:"content",previous:a}),i}},resolve:function(e){return r(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,a){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s(e,o,"linePrefix")};function o(s){return null===s||n(s)?a(s):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,a,t)(s):t(s)}},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=[].splice;e.exports=n},function(e,t,a){"use strict";var n=a(931),i=a(286),r=a(674);function s(e,t){var a,i,s,l;for(a in t)for(l in i=n.call(e,a)?e[a]:e[a]={},s=t[a])i[l]=o(r(s[l]),n.call(i,l)?i[l]:[])}function o(e,t){for(var a=-1,n=[];++a<e.length;)("after"===e[a].add?t:n).push(e[a]);return i(t,0,0,n),t}e.exports=function(e){for(var t={},a=-1;++a<e.length;)s(t,e[a]);return t}},function(e,t,a){"use strict";var n=a(414),i=a(156),r=a(675),s=a(286),o=a(674),l=a(676),c=a(1186),u=a(349),d=a(1187);e.exports=function(e,t,a){var p=a?u(a):{line:1,column:1,offset:0},m={},f=[],b=[],g=[],y={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,w()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===b[p._index].length&&(p._bufferIndex=-1,p._index++)),h.previous=e},enter:function(e,t){var a=t||{};return a.type=e,a.start=x(),h.events.push(["enter",a,h]),g.push(a),a},exit:function(e){var t=g.pop();return t.end=x(),h.events.push(["exit",t,h]),t},attempt:O((function(e,t){k(e,t.from)})),check:O(S),interrupt:O(S,{interrupt:!0}),lazy:O(S,{lazy:!0})},h={previous:null,events:[],parser:e,sliceStream:E,sliceSerialize:function(e){return c(E(e))},now:x,defineSkip:function(e){m[e.line]=e.column,w()},write:function(e){return b=r(b,e),function(){for(var e,t;p._index<b.length;)if("string"==typeof(t=b[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)j(t.charCodeAt(p._bufferIndex));else j(t)}(),null!==b[b.length-1]?[]:(k(t,0),h.events=l(f,h.events,h),h.events)}},v=t.tokenize.call(h,y);return t.resolveAll&&f.push(t),p._index=0,p._bufferIndex=-1,h;function E(e){return d(b,e)}function x(){return u(p)}function j(e){v=v(e)}function S(e,t){t.restore()}function O(e,t){return function(a,i,r){var s,l,c,u;return a.tokenize||"length"in a?d(o(a)):function(e){return e in a||null in a?d(a.null?o(a[e]).concat(o(a.null)):a[e])(e):r(e)};function d(e){return s=e,m(e[l=0])}function m(e){return function(a){var i,r,s,o,l;return i=x(),r=h.previous,s=h.currentConstruct,o=h.events.length,l=Array.from(g),u={restore:function(){p=i,h.previous=r,h.currentConstruct=s,h.events.length=o,g=l,w()},from:o},c=e,e.partial||(h.currentConstruct=e),e.name&&h.parser.constructs.disable.null.indexOf(e.name)>-1?b():e.tokenize.call(t?n({},h,t):h,y,f,b)(a)}}function f(t){return e(c,u),i}function b(e){return u.restore(),++l<s.length?m(s[l]):r}}}function k(e,t){e.resolveAll&&f.indexOf(e)<0&&f.push(e),e.resolve&&s(h.events,t,h.events.length-t,e.resolve(h.events.slice(t),h)),e.resolveTo&&(h.events=e.resolveTo(h.events,h))}function w(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,a){"use strict";var n=a(533);e.exports=function(e){for(var t,a,i,r=-1,s=[];++r<e.length;){if("string"==typeof(t=e[r]))a=t;else if(-5===t)a="\r";else if(-4===t)a="\n";else if(-3===t)a="\r\n";else if(-2===t)a="\t";else if(-1===t){if(i)continue;a=" "}else a=n(t);i=-2===t,s.push(a)}return s.join("")}},function(e,t,a){"use strict";e.exports=function(e,t){var a,n=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;return n===r?a=[e[n].slice(i,s)]:(a=e.slice(n,r),i>-1&&(a[0]=a[0].slice(i)),s>0&&a.push(e[r].slice(0,s))),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(934),i=a(1189),r=a(1195),s=a(1197),o=a(1198),l=a(1200),c=a(1202),u=a(1203),d=a(1204),p=a(1205),m=a(1206),f=a(1207),b=a(1208),g=a(1211),y=a(678),h=a(1212),v=a(1213),E=a(1214),x=a(1215),j=a(1216),S=a(942),O={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:s},k={91:p},w={"-2":u,"-1":u,32:u},T={35:f,42:S,45:[j,S],60:b,61:j,95:S,96:c,126:c},I={38:l,92:o},C={"-5":E,"-4":E,"-3":E,33:h,38:l,42:i,60:[r,g],91:v,92:[m,o],93:y,95:i,96:d},M={null:[i,n.resolver]};t.contentInitial=k,t.disable={null:[]},t.document=O,t.flow=T,t.flowInitial=w,t.insideSpan=M,t.string=I,t.text=C},function(e,t,a){"use strict";var n=a(675),i=a(286),r=a(1190),s=a(1194),o=a(676),l=a(349),c={name:"attention",tokenize:function(e,t){var a,n=r(this.previous);return function(t){return e.enter("attentionSequence"),a=t,i(t)};function i(s){var o,l,c,u;return s===a?(e.consume(s),i):(o=e.exit("attentionSequence"),c=!(l=r(s))||2===l&&n,u=!n||2===n&&l,o._open=42===a?c:c&&(n||!u),o._close=42===a?u:u&&(l||!c),t(s))}},resolveAll:function(e,t){for(var a,r,c,u,d,p,m,f,b=-1;++b<e.length;)if("enter"===e[b][0]&&"attentionSequence"===e[b][1].type&&e[b][1]._close)for(a=b;a--;)if("exit"===e[a][0]&&"attentionSequence"===e[a][1].type&&e[a][1]._open&&t.sliceSerialize(e[a][1]).charCodeAt(0)===t.sliceSerialize(e[b][1]).charCodeAt(0)){if((e[a][1]._close||e[b][1]._open)&&(e[b][1].end.offset-e[b][1].start.offset)%3&&!((e[a][1].end.offset-e[a][1].start.offset+e[b][1].end.offset-e[b][1].start.offset)%3))continue;u={type:(p=e[a][1].end.offset-e[a][1].start.offset>1&&e[b][1].end.offset-e[b][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:s(l(e[a][1].end),-p),end:l(e[a][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[b][1].start),end:s(l(e[b][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[a][1].end),end:l(e[b][1].start)},r={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[a][1].end=l(u.start),e[b][1].start=l(d.end),m=[],e[a][1].end.offset-e[a][1].start.offset&&(m=n(m,[["enter",e[a][1],t],["exit",e[a][1],t]])),m=n(m,[["enter",r,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=n(m,o(t.parser.constructs.insideSpan.null,e.slice(a+1,b),t)),m=n(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",r,t]]),e[b][1].end.offset-e[b][1].start.offset?(f=2,m=n(m,[["enter",e[b][1],t],["exit",e[b][1],t]])):f=0,i(e,a-1,b-a+3,m),b=a+m.length-f-2;break}for(b=-1;++b<e.length;)"attentionSequence"===e[b][1].type&&(e[b][1].type="data");return e}};e.exports=c},function(e,t,a){"use strict";var n=a(287),i=a(1191),r=a(1193);e.exports=function(e){return null===e||n(e)||r(e)?1:i(e)?2:void 0}},function(e,t,a){"use strict";var n=a(1192),i=a(288)(n);e.exports=i},function(e,t,a){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,a){"use strict";var n=a(288)(/\s/);e.exports=n},function(e,t,a){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,a){"use strict";var n=a(677),i=a(536),r=a(1196),s=a(935),o={name:"autolink",tokenize:function(e,t,a){var o=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return n(t)?(e.consume(t),c):r(t)?p(t):a(t)}function c(e){return 43===e||45===e||46===e||i(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&o++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),g(t)):32===t||60===t||s(t)?a(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),o=0,m):r(t)?(e.consume(t),p):a(t)}function m(e){return i(e)?f(e):a(e)}function f(t){return 46===t?(e.consume(t),o=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",g(t)):b(t)}function b(t){return(45===t||i(t))&&o++<63?(e.consume(t),45===t?b:f):a(t)}function g(a){return e.enter("autolinkMarker"),e.consume(a),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=o},function(e,t,a){"use strict";var n=a(288)(/[#-'*+\--9=?A-Z^-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(258),i=a(171),r={name:"blockQuote",tokenize:function(e,t,a){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r):a(t)};function r(a){return n(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}},continuation:{tokenize:function(e,t,a){return i(e,e.attempt(r,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=r},function(e,t,a){"use strict";var n=a(1199),i={name:"characterEscape",tokenize:function(e,t,a){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return n(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(288)(/[!-/:-@[-`{-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(936),i=a(536),r=a(937),s=a(1201);function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(n),c={name:"characterReference",tokenize:function(e,t,a){var n,o,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),n=31,o=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),n=6,o=s,m):(e.enter("characterReferenceValue"),n=7,o=r,m(t))}function m(r){var s;return 59===r&&u?(s=e.exit("characterReferenceValue"),o!==i||l.default(c.sliceSerialize(s))?(e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):a(r)):o(r)&&u++<n?(e.consume(r),m):a(r)}}};e.exports=c},function(e,t,a){"use strict";var n=a(288)(/[\dA-Fa-f]/);e.exports=n},function(e,t,a){"use strict";var n=a(156),i=a(287),r=a(535),s=a(171),o={name:"codeFenced",tokenize:function(e,t,a){var o,l=this,c={tokenize:function(e,t,a){var i=0;return s(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function r(t){return t===o?(e.consume(t),i++,r):i<d?a(t):(e.exit("codeFencedFenceSequence"),s(e,l,"whitespace")(t))}function l(i){return null===i||n(i)?(e.exit("codeFencedFence"),t(i)):a(i)}},partial:!0},u=r(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),o=t,p(t)};function p(t){return t===o?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?a(t):s(e,m,"whitespace")(t))}function m(t){return null===t||n(t)?y(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(t))}function f(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),s(e,b,"whitespace")(t)):96===t&&t===o?a(t):(e.consume(t),f)}function b(t){return null===t||n(t)?y(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||n(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),y(t)):96===t&&t===o?a(t):(e.consume(t),g)}function y(a){return e.exit("codeFencedFence"),l.interrupt?t(a):h(a)}function h(t){return null===t?E(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,E,u?s(e,h,"linePrefix",u+1):h)):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||n(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),v)}function E(a){return e.exit("codeFenced"),t(a)}},concrete:!0};e.exports=o},function(e,t,a){"use strict";var n=a(156),i=a(286),r=a(535),s=a(171),o={name:"codeIndented",tokenize:function(e,t,a){return e.attempt(l,i,a);function i(a){return null===a?t(a):n(a)?e.attempt(l,i,t)(a):(e.enter("codeFlowValue"),r(a))}function r(t){return null===t||n(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),r)}},resolve:function(e,t){var a={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",a,t]]),i(e,e.length,0,[["exit",a,t]]),e}},l={tokenize:function(e,t,a){var i=this;return s(e,(function o(l){return n(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s(e,o,"linePrefix",5)):r(i.events,"linePrefix")<4?a(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=a(156),i={name:"codeText",tokenize:function(e,t,a){var i,r,s=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),o(t)};function o(t){return 96===t?(e.consume(t),s++,o):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?a(t):96===t?(r=e.enter("codeTextSequence"),i=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||n(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(a){return 96===a?(e.consume(a),i++,u):i===s?(e.exit("codeTextSequence"),e.exit("codeText"),t(a)):(r.type="codeTextData",c(a))}},resolve:function(e){var t,a,n=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[n][1].type&&"space"!==e[n][1].type))for(t=i;++t<n;)if("codeTextData"===e[t][1].type){e[n][1].type=e[i][1].type="codeTextPadding",i+=2,n-=2;break}for(t=i-1,n++;++t<=n;)void 0===a?t!==n&&"lineEnding"!==e[t][1].type&&(a=t):t!==n&&"lineEnding"!==e[t][1].type||(e[a][1].type="codeTextData",t!==a+2&&(e[a][1].end=e[t-1][1].end,e.splice(a+2,t-a-2),n-=t-a-2,t=a+2),a=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,a){"use strict";var n=a(156),i=a(287),r=a(673),s=a(938),o=a(939),l=a(171),c=a(940),u=a(941),d={name:"definition",tokenize:function(e,t,a){var i,u=this;return function(t){return e.enter("definition"),o.call(u,e,d,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=r(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,s(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):a(t)}function m(r){return null===r||n(r)?(e.exit("definition"),u.parser.defined.indexOf(i)<0&&u.parser.defined.push(i),t(r)):a(r)}}},p={tokenize:function(e,t,a){return function(t){return i(t)?c(e,r)(t):a(t)};function r(t){return 34===t||39===t||40===t?u(e,l(e,s,"whitespace"),a,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):a(t)}function s(e){return null===e||n(e)?t(e):a(e)}},partial:!0};e.exports=d},function(e,t,a){"use strict";var n=a(156),i={name:"hardBreakEscape",tokenize:function(e,t,a){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return n(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(156),i=a(287),r=a(258),s=a(286),o=a(171),l={name:"headingAtx",tokenize:function(e,t,a){var s=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(n){return 35===n&&l++<6?(e.consume(n),c):null===n||i(n)?(e.exit("atxHeadingSequence"),s.interrupt?t(n):u(n)):a(n)}function u(a){return 35===a?(e.enter("atxHeadingSequence"),d(a)):null===a||n(a)?(e.exit("atxHeading"),t(a)):r(a)?o(e,u,"whitespace")(a):(e.enter("atxHeadingText"),p(a))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var a,n,i=e.length-2,r=3;return"whitespace"===e[r][1].type&&(r+=2),i-2>r&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(r===i-1||i-4>r&&"whitespace"===e[i-2][1].type)&&(i-=r+1===i?2:4),i>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},n={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},s(e,r,i-r+1,[["enter",a,t],["enter",n,t],["exit",n,t],["exit",a,t]])),e}};e.exports=l},function(e,t,a){"use strict";var n=a(677),i=a(536),r=a(156),s=a(287),o=a(258),l=a(533),c=a(1209),u=a(1210),d=a(534),p={name:"htmlFlow",tokenize:function(e,t,a){var d,p,f,b,g,y=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),h};function h(i){return 33===i?(e.consume(i),v):47===i?(e.consume(i),j):63===i?(e.consume(i),d=3,y.interrupt?t:$):n(i)?(e.consume(i),f=l(i),p=!0,S):a(i)}function v(i){return 45===i?(e.consume(i),d=2,E):91===i?(e.consume(i),d=5,f="CDATA[",b=0,x):n(i)?(e.consume(i),d=4,y.interrupt?t:$):a(i)}function E(n){return 45===n?(e.consume(n),y.interrupt?t:$):a(n)}function x(n){return n===f.charCodeAt(b++)?(e.consume(n),b===f.length?y.interrupt?t:D:x):a(n)}function j(t){return n(t)?(e.consume(t),f=l(t),S):a(t)}function S(n){return null===n||47===n||62===n||s(n)?47!==n&&p&&u.indexOf(f.toLowerCase())>-1?(d=1,y.interrupt?t(n):D(n)):c.indexOf(f.toLowerCase())>-1?(d=6,47===n?(e.consume(n),O):y.interrupt?t(n):D(n)):(d=7,y.interrupt?a(n):p?w(n):k(n)):45===n||i(n)?(e.consume(n),f+=l(n),S):a(n)}function O(n){return 62===n?(e.consume(n),y.interrupt?t:D):a(n)}function k(t){return o(t)?(e.consume(t),k):F(t)}function w(t){return 47===t?(e.consume(t),F):58===t||95===t||n(t)?(e.consume(t),T):o(t)?(e.consume(t),w):F(t)}function T(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),T):I(t)}function I(t){return 61===t?(e.consume(t),C):o(t)?(e.consume(t),I):w(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),g=t,M):o(t)?(e.consume(t),C):(g=void 0,_(t))}function M(t){return t===g?(e.consume(t),A):null===t||r(t)?a(t):(e.consume(t),M)}function _(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||s(t)?I(t):(e.consume(t),_)}function A(e){return 47===e||62===e||o(e)?w(e):a(e)}function F(t){return 62===t?(e.consume(t),P):a(t)}function P(t){return o(t)?(e.consume(t),P):null===t||r(t)?D(t):a(t)}function D(t){return 45===t&&2===d?(e.consume(t),L):60===t&&1===d?(e.consume(t),B):62===t&&4===d?(e.consume(t),V):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),q):!r(t)||6!==d&&7!==d?null===t||r(t)?N(t):(e.consume(t),D):e.check(m,V,N)(t)}function N(t){return e.exit("htmlFlowData"),R(t)}function R(t){return null===t?U(t):r(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),R):(e.enter("htmlFlowData"),D(t))}function L(t){return 45===t?(e.consume(t),$):D(t)}function B(t){return 47===t?(e.consume(t),f="",z):D(t)}function z(t){return 62===t&&u.indexOf(f.toLowerCase())>-1?(e.consume(t),V):n(t)&&f.length<8?(e.consume(t),f+=l(t),z):D(t)}function q(t){return 93===t?(e.consume(t),$):D(t)}function $(t){return 62===t?(e.consume(t),V):D(t)}function V(t){return null===t||r(t)?(e.exit("htmlFlowData"),U(t)):(e.consume(t),V)}function U(a){return e.exit("htmlFlow"),t(a)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,a){return function(n){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),e.attempt(d,t,a)}},partial:!0};e.exports=p},function(e,t,a){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,a){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,a){"use strict";var n=a(677),i=a(536),r=a(156),s=a(287),o=a(258),l=a(171),c={name:"htmlText",tokenize:function(e,t,a){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),f};function f(t){return 33===t?(e.consume(t),b):47===t?(e.consume(t),I):63===t?(e.consume(t),w):n(t)?(e.consume(t),_):a(t)}function b(t){return 45===t?(e.consume(t),g):91===t?(e.consume(t),u="CDATA[",d=0,x):n(t)?(e.consume(t),k):a(t)}function g(t){return 45===t?(e.consume(t),y):a(t)}function y(t){return null===t||62===t?a(t):45===t?(e.consume(t),h):v(t)}function h(e){return null===e||62===e?a(e):v(e)}function v(t){return null===t?a(t):45===t?(e.consume(t),E):r(t)?(p=v,B(t)):(e.consume(t),v)}function E(t){return 45===t?(e.consume(t),q):v(t)}function x(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?j:x):a(t)}function j(t){return null===t?a(t):93===t?(e.consume(t),S):r(t)?(p=j,B(t)):(e.consume(t),j)}function S(t){return 93===t?(e.consume(t),O):j(t)}function O(t){return 62===t?q(t):93===t?(e.consume(t),O):j(t)}function k(t){return null===t||62===t?q(t):r(t)?(p=k,B(t)):(e.consume(t),k)}function w(t){return null===t?a(t):63===t?(e.consume(t),T):r(t)?(p=w,B(t)):(e.consume(t),w)}function T(e){return 62===e?q(e):w(e)}function I(t){return n(t)?(e.consume(t),C):a(t)}function C(t){return 45===t||i(t)?(e.consume(t),C):M(t)}function M(t){return r(t)?(p=M,B(t)):o(t)?(e.consume(t),M):q(t)}function _(t){return 45===t||i(t)?(e.consume(t),_):47===t||62===t||s(t)?A(t):a(t)}function A(t){return 47===t?(e.consume(t),q):58===t||95===t||n(t)?(e.consume(t),F):r(t)?(p=A,B(t)):o(t)?(e.consume(t),A):q(t)}function F(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),F):P(t)}function P(t){return 61===t?(e.consume(t),D):r(t)?(p=P,B(t)):o(t)?(e.consume(t),P):A(t)}function D(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),c=t,N):r(t)?(p=D,B(t)):o(t)?(e.consume(t),D):(e.consume(t),c=void 0,L)}function N(t){return t===c?(e.consume(t),R):null===t?a(t):r(t)?(p=N,B(t)):(e.consume(t),N)}function R(e){return 62===e||47===e||s(e)?A(e):a(e)}function L(t){return null===t||34===t||39===t||60===t||61===t||96===t?a(t):62===t||s(t)?A(t):(e.consume(t),L)}function B(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,z,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function z(t){return e.enter("htmlTextData"),p(t)}function q(n){return 62===n?(e.consume(n),e.exit("htmlTextData"),e.exit("htmlText"),t):a(n)}}};e.exports=c},function(e,t,a){"use strict";var n={name:"labelStartImage",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):a(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(678).resolveAll};e.exports=n},function(e,t,a){"use strict";var n={name:"labelStartLink",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(678).resolveAll};e.exports=n},function(e,t,a){"use strict";var n=a(171),i={name:"lineEnding",tokenize:function(e,t){return function(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n(e,t,"linePrefix")}}};e.exports=i},function(e,t,a){"use strict";var n=a(937),i=a(258),r=a(535),s=a(932),o=a(171),l=a(534),c=a(942),u={name:"list",tokenize:function(e,t,a){var o=this,u=r(o.events,"linePrefix"),p=0;return function(t){var i=o.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!o.containerState.marker||t===o.containerState.marker:n(t)){if(o.containerState.type||(o.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,a,f)(t):f(t);if(!o.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return a(t)};function m(t){return n(t)&&++p<10?(e.consume(t),m):(!o.interrupt||p<2)&&(o.containerState.marker?t===o.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),f(t)):a(t)}function f(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||t,e.check(l,o.interrupt?a:b,e.attempt(d,y,g))}function b(e){return o.containerState.initialBlankLine=!0,u++,y(e)}function g(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),y):a(t)}function y(a){return o.containerState.size=u+s(o.sliceStream(e.exit("listItemPrefix"))),t(a)}},continuation:{tokenize:function(e,t,a){var n=this;return n.containerState._closeFlow=void 0,e.check(l,(function(a){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,o(e,t,"listItemIndent",n.containerState.size+1)(a)}),(function(a){return n.containerState.furtherBlankLines||!i(a)?(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,r(a)):(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,e.attempt(p,t,r)(a))}));function r(i){return n.containerState._closeFlow=!0,n.interrupt=void 0,o(e,e.attempt(u,t,a),"linePrefix",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return i(e)||!r(n.events,"listItemPrefixWhitespace")?a(e):t(e)}),"listItemPrefixWhitespace",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return r(n.events,"listItemIndent")===n.containerState.size?t(e):a(e)}),"listItemIndent",n.containerState.size+1)},partial:!0};e.exports=u},function(e,t,a){"use strict";var n=a(156),i=a(349),r=a(171),s={name:"setextUnderline",tokenize:function(e,t,a){for(var i,s,o=this,l=o.events.length;l--;)if("lineEnding"!==o.events[l][1].type&&"linePrefix"!==o.events[l][1].type&&"content"!==o.events[l][1].type){s="paragraph"===o.events[l][1].type;break}return function(t){return o.lazy||!o.interrupt&&!s?a(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,c(t))};function c(t){return t===i?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),r(e,u,"lineSuffix")(t))}function u(i){return null===i||n(i)?(e.exit("setextHeadingLine"),t(i)):a(i)}},resolveTo:function(e,t){for(var a,n,r,s,o=e.length;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){a=o;break}"paragraph"===e[o][1].type&&(n=o)}else"content"===e[o][1].type&&e.splice(o,1),r||"definition"!==e[o][1].type||(r=o);return s={type:"setextHeading",start:i(e[n][1].start),end:i(e[e.length-1][1].end)},e[n][1].type="setextHeadingText",r?(e.splice(n,0,["enter",s,t]),e.splice(r+1,0,["exit",e[a][1],t]),e[a][1].end=i(e[r][1].end)):e[a][1]=s,e.push(["exit",s,t]),e}};e.exports=s},function(e,t,a){"use strict";var n=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,a=1,i="";return function(r,s,o){var l,c,u,d,p,m=[];for(r=i+r.toString(s),u=0,i="",t&&(65279===r.charCodeAt(0)&&u++,t=void 0);u<r.length;){if(n.lastIndex=u,d=(l=n.exec(r))?l.index:r.length,p=r.charCodeAt(d),!l){i=r.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(r.slice(u,d)),a+=d-u),0===p)m.push(65533),a++;else if(9===p)for(c=4*Math.ceil(a/4),m.push(-2);a++<c;)m.push(-1);else 10===p?(m.push(-4),a=1):(e=!0,a=1);u=d+1}return o&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,a){"use strict";var n=a(933);e.exports=function(e){for(;!n(e););return e}},function(e,t,a){e.exports=a(24)(3709)},function(e,t,a){e.exports=a(24)(2067)},function(e,t,a){e.exports=a(24)(8)},function(e,t,a){e.exports=a(24)(1647)},function(e,t,a){const n=a(1224);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{n(e,"element",t)};function t(t,a,n){const i=t,r=n;let s;if(e.allowedElements?s=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(s=e.disallowedElements.includes(i.tagName)),!s&&e.allowElement&&"number"==typeof a&&(s=!e.allowElement(i,a,r)),s&&"number"==typeof a)return e.unwrapDisallowed&&i.children?r.children.splice(a,1,...i.children):r.children.splice(a,1),a}}},function(e,t,a){e.exports=a(24)(365)},function(e,t){const a=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<a.length;){const e=a[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},function(e,t,a){"use strict";const n=a(2),i=a(1227),r=a(1228),s=a(1229),o=a(1230),l=a(1231),c=a(1232),u=a(1233);t.hastToReact=f,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const a=[];let n,i=-1;for(;++i<t.children.length;)n=t.children[i],"element"===n.type?a.push(f(e,n,i,t)):"text"===n.type?"element"===t.type&&p.has(t.tagName)&&"\n"===n.value||a.push(n.value):"raw"!==n.type||e.options.skipHtml||a.push(n.value);return a}function f(e,t,a,s){const o=e.options,l=e.schema,c=t.tagName,u={};let p,f=l;if("html"===l.space&&"svg"===c&&(f=r,e.schema=f),t.properties)for(p in t.properties)d.call(t.properties,p)&&g(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const y=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const h=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},v=o.components&&d.call(o.components,c)?o.components[c]:c,E="string"==typeof v||v===n.Fragment;if(!i.isValidElementType(v))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,h.start.line,h.start.column,a].join("-"),"a"===c&&o.linkTarget&&(u.target="function"==typeof o.linkTarget?o.linkTarget(u.href,t.children,u.title):o.linkTarget),"a"===c&&o.transformLinkUri&&(u.href=o.transformLinkUri(u.href,t.children,u.title)),E||"code"!==c||"element"!==s.type||"pre"===s.tagName||(u.inline=!0),E||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&o.transformImageUri&&(u.src=o.transformImageUri(u.src,u.alt,u.title)),!E&&"li"===c&&"element"===s.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const a=e.children[t];if("element"===a.type&&"input"===a.tagName)return a}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=b(s,t),u.ordered="ol"===s.tagName}var x;return E||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),E||(u.isHeader="th"===c)),E||"tr"!==c||"element"!==s.type||(u.isHeader=Boolean("thead"===s.tagName)),o.sourcePos&&(u["data-sourcepos"]=[(x=h).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!E&&o.rawSourcePos&&(u.sourcePosition=t.position),!E&&o.includeElementIndex&&(u.index=b(s,t),u.siblingCount=b(s)),E||(u.node=t),y.length>0?n.createElement(v,u,y):n.createElement(v,u)}function b(e,t){let a=-1,n=0;for(;++a<e.children.length&&e.children[a]!==t;)"element"===e.children[a].type&&n++;return n}function g(e,t,a,n){const i=s(n.schema,t);let r=a;null!=r&&r==r&&(r&&"object"==typeof r&&"length"in r&&(r=(i.commaSeparated?c:l).stringify(r)),"style"===i.property&&"string"==typeof r&&(r=function(e){const t={};try{u(e,(function(e,a){const n="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[n.replace(/-([a-z])/g,y)]=a}))}catch(e){}return t}(r)),i.space&&i.property?e[d.call(o,i.property)?o[i.property]:i.property]=r:i.attribute&&(e[i.attribute]=r))}function y(e,t){return t.toUpperCase()}},function(e,t,a){e.exports=a(24)(476)},function(e,t,a){e.exports=a(24)(3772)},function(e,t,a){e.exports=a(24)(1658)},function(e,t,a){e.exports=a(24)(3774)},function(e,t,a){e.exports=a(24)(1659)},function(e,t,a){e.exports=a(24)(1660)},function(e,t,a){e.exports=a(24)(3775)},function(e,t,a){e.exports=a(24)(2063)},function(e,t,a){const n=a(316),i=a(315),r=a(173),s=a(514),o=a(304),l=a(591),c=a(1236),u=a(1237),d=a(1238),p=a(1239),m=a(1240),f=a(1241),b=a(1242),g=a(225),y=a(1243),h=a(1244),v=a(679),E=a(1245),x=a(1246),j=a(538),S=a(680),O=a(946),k=a(947),w=a(539),T=a(603),I=a(948),C=a(1116),M=a(540),_=a(217),A=a(541),F=a(1250),P=a(1251),D=a(1252),N=a(1253),R=a(1254),L=a(681),B=a(1255),z=a(1256),q=a(1257),$=a(1258),V=a(1259);e.exports={parse:o,valid:l,clean:c,inc:u,diff:d,major:p,minor:m,patch:f,prerelease:b,compare:g,rcompare:y,compareLoose:h,compareBuild:v,sort:E,rsort:x,gt:j,lt:S,eq:O,neq:k,gte:w,lte:T,cmp:I,coerce:C,Comparator:M,Range:_,satisfies:A,toComparators:F,maxSatisfying:P,minSatisfying:D,minVersion:N,validRange:R,outside:L,gtr:B,ltr:z,intersects:q,simplifyRange:$,subset:V,SemVer:r,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},function(e,t,a){const n=a(304);e.exports=(e,t)=>{const a=n(e.trim().replace(/^[=v]+/,""),t);return a?a.version:null}},function(e,t,a){const n=a(173);e.exports=(e,t,a,i,r)=>{"string"==typeof a&&(r=i,i=a,a=void 0);try{return new n(e instanceof n?e.version:e,a).inc(t,i,r).version}catch(e){return null}}},function(e,t,a){const n=a(304);e.exports=(e,t)=>{const a=n(e,null,!0),i=n(t,null,!0),r=a.compare(i);if(0===r)return null;const s=r>0,o=s?a:i,l=s?i:a,c=!!o.prerelease.length;if(l.prerelease.length&&!c)return l.patch||l.minor?o.patch?"patch":o.minor?"minor":"major":"major";const u=c?"pre":"";return a.major!==i.major?u+"major":a.minor!==i.minor?u+"minor":a.patch!==i.patch?u+"patch":"prerelease"}},function(e,t,a){const n=a(173);e.exports=(e,t)=>new n(e,t).major},function(e,t,a){const n=a(173);e.exports=(e,t)=>new n(e,t).minor},function(e,t,a){const n=a(173);e.exports=(e,t)=>new n(e,t).patch},function(e,t,a){const n=a(304);e.exports=(e,t)=>{const a=n(e,t);return a&&a.prerelease.length?a.prerelease:null}},function(e,t,a){const n=a(225);e.exports=(e,t,a)=>n(t,e,a)},function(e,t,a){const n=a(225);e.exports=(e,t)=>n(e,t,!0)},function(e,t,a){const n=a(679);e.exports=(e,t)=>e.sort(((e,a)=>n(e,a,t)))},function(e,t,a){const n=a(679);e.exports=(e,t)=>e.sort(((e,a)=>n(a,e,t)))},function(e,t,a){"use strict";const n=a(1248),i=Symbol("max"),r=Symbol("length"),s=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),f=()=>1,b=(e,t,a)=>{const n=e[p].get(t);if(n){const t=n.value;if(g(e,t)){if(h(e,n),!e[o])return}else a&&(e[m]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},g=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const a=Date.now()-t.now;return t.maxAge?a>t.maxAge:e[l]&&a>e[l]},y=e=>{if(e[r]>e[i])for(let t=e[d].tail;e[r]>e[i]&&null!==t;){const a=t.prev;h(e,t),t=a}},h=(e,t)=>{if(t){const a=t.value;e[c]&&e[c](a.key,a.value),e[r]-=a.length,e[p].delete(a.key),e[d].removeNode(t)}};class Entry{constructor(e,t,a,n,i){this.key=e,this.value=t,this.length=a,this.now=n,this.maxAge=i||0}}const v=(e,t,a,n)=>{let i=a.value;g(e,i)&&(h(e,a),e[o]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[s]="function"!=typeof t?f:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[s]&&(this[s]=e,this[r]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[r]+=e.length}))),y(this)}get lengthCalculator(){return this[s]}get length(){return this[r]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let a=this[d].tail;null!==a;){const n=a.prev;v(this,e,a,t),a=n}}forEach(e,t){t=t||this;for(let a=this[d].head;null!==a;){const n=a.next;v(this,e,a,t),a=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach((e=>this[c](e.key,e.value))),this[p]=new Map,this[d]=new n,this[r]=0}dump(){return this[d].map((e=>!g(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,a){if((a=a||this[l])&&"number"!=typeof a)throw new TypeError("maxAge must be a number");const n=a?Date.now():0,o=this[s](t,e);if(this[p].has(e)){if(o>this[i])return h(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[c]&&(this[u]||this[c](e,s.value)),s.now=n,s.maxAge=a,s.value=t,this[r]+=o-s.length,s.length=o,this.get(e),y(this),!0}const m=new Entry(e,t,o,n,a);return m.length>this[i]?(this[c]&&this[c](e,t),!1):(this[r]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),y(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!g(this,t)}get(e){return b(this,e,!0)}peek(e){return b(this,e,!1)}pop(){const e=this[d].tail;return e?(h(this,e),e.value):null}del(e){h(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let a=e.length-1;a>=0;a--){const n=e[a],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach(((e,t)=>b(this,t,!1)))}}},function(e,t,a){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var a=0,i=arguments.length;a<i;a++)t.push(arguments[a]);return t}function i(e,t,a){var n=t===e.head?new o(a,null,t,e):new o(a,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function r(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,a,n){if(!(this instanceof o))return new o(e,t,a,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,a?(a.prev=this,this.next=a):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,a=e.prev;return t&&(t.prev=a),a&&(a.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=a),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var a=this.head,n=0;null!==a;n++)e.call(t,a.value,n,this),a=a.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var a=this.tail,n=this.length-1;null!==a;n--)e.call(t,a.value,n,this),a=a.prev},n.prototype.get=function(e){for(var t=0,a=this.head;null!==a&&t<e;t++)a=a.next;if(t===e&&null!==a)return a.value},n.prototype.getReverse=function(e){for(var t=0,a=this.tail;null!==a&&t<e;t++)a=a.prev;if(t===e&&null!==a)return a.value},n.prototype.map=function(e,t){t=t||this;for(var a=new n,i=this.head;null!==i;)a.push(e.call(t,i.value,this)),i=i.next;return a},n.prototype.mapReverse=function(e,t){t=t||this;for(var a=new n,i=this.tail;null!==i;)a.push(e.call(t,i.value,this)),i=i.prev;return a},n.prototype.reduce=function(e,t){var a,n=this.head;if(arguments.length>1)a=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,a=this.head.value}for(var i=0;null!==n;i++)a=e(a,n.value,i),n=n.next;return a},n.prototype.reduceReverse=function(e,t){var a,n=this.tail;if(arguments.length>1)a=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,a=this.tail.value}for(var i=this.length-1;null!==n;i--)a=e(a,n.value,i),n=n.prev;return a},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,a=this.head;null!==a;t++)e[t]=a.value,a=a.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,a=this.tail;null!==a;t++)e[t]=a.value,a=a.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)a.push(r.value);return a},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)a.push(r.value);return a},n.prototype.splice=function(e,t,...a){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var s=[];for(n=0;r&&n<t;n++)s.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),n=0;n<a.length;n++)r=i(this,r,a[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,a=e;null!==a;a=a.prev){var n=a.prev;a.prev=a.next,a.next=n}return this.head=t,this.tail=e,this};try{a(1249)(n)}catch(e){}},function(e,t,a){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,a){const n=a(217);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,a){const n=a(173),i=a(217);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&-1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(173),i=a(217);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(173),i=a(217),r=a(538);e.exports=(e,t)=>{e=new i(e,t);let a=new n("0.0.0");if(e.test(a))return a;if(a=new n("0.0.0-0"),e.test(a))return a;a=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!r(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||a&&!r(a,s)||(a=s)}return a&&e.test(a)?a:null}},function(e,t,a){const n=a(217);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,a){const n=a(681);e.exports=(e,t,a)=>n(e,t,">",a)},function(e,t,a){const n=a(681);e.exports=(e,t,a)=>n(e,t,"<",a)},function(e,t,a){const n=a(217);e.exports=(e,t,a)=>(e=new n(e,a),t=new n(t,a),e.intersects(t,a))},function(e,t,a){const n=a(541),i=a(225);e.exports=(e,t,a)=>{const r=[];let s=null,o=null;const l=e.sort(((e,t)=>i(e,t,a)));for(const e of l)n(e,t,a)?(o=e,s||(s=e)):(o&&r.push([s,o]),o=null,s=null);s&&r.push([s,null]);const c=[];for(const[e,t]of r)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,a){const n=a(217),i=a(540),{ANY:r}=i,s=a(541),o=a(225),l=[new i(">=0.0.0-0")],c=[new i(">=0.0.0")],u=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=a.includePrerelease?l:c}if(1===t.length&&t[0].semver===r){if(a.includePrerelease)return!0;t=c}const n=new Set;let i,u,m,f,b,g,y;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,a):"<"===t.operator||"<="===t.operator?u=p(u,t,a):n.add(t.semver);if(n.size>1)return null;if(i&&u){if(m=o(i.semver,u.semver,a),m>0)return null;if(0===m&&(">="!==i.operator||"<="!==u.operator))return null}for(const e of n){if(i&&!s(e,String(i),a))return null;if(u&&!s(e,String(u),a))return null;for(const n of t)if(!s(e,String(n),a))return!1;return!0}let h=!(!u||a.includePrerelease||!u.semver.prerelease.length)&&u.semver,v=!(!i||a.includePrerelease||!i.semver.prerelease.length)&&i.semver;h&&1===h.prerelease.length&&"<"===u.operator&&0===h.prerelease[0]&&(h=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(f=d(i,e,a),f===e&&f!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),a))return!1;if(u)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),"<"===e.operator||"<="===e.operator){if(b=p(u,e,a),b===e&&b!==u)return!1}else if("<="===u.operator&&!s(u.semver,String(e),a))return!1;if(!e.operator&&(u||i)&&0!==m)return!1}return!(i&&g&&!u&&0!==m||u&&y&&!i&&0!==m||v||h)},d=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,a={})=>{if(e===t)return!0;e=new n(e,a),t=new n(t,a);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=u(n,e,a);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,a){var n,i,r,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,o=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function b(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.cache={}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},f.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},b.prototype.push=function(e){return new b(e,this)},b.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,s,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),s=0;null!=t&&s<i.length;)s===i.length-1&&(l=r(t,i[s])),t=t[i[s++]];else t=o.view[e],l=r(o.view,e);if(l)break;o=o.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){this.cache={}},g.prototype.parse=function(t,n){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,n){if(!t)return[];var r,l,b,g,y=[],h=[],v=[],E=!1,x=!1;function j(){if(E&&!x)for(;v.length;)delete h[v.pop()];else v=[];E=!1,x=!1}function S(e){if("string"==typeof e&&(e=e.split(u,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),b=new RegExp("\\s*"+i("}"+e[1]))}S(n||e.tags);for(var O,k,w,T,I,C,M=new f(t);!M.eos();){if(O=M.pos,w=M.scanUntil(r))for(var _=0,A=w.length;_<A;++_)g=T=w.charAt(_),function(e,t){return s.call(e,t)}(o,g)?x=!0:v.push(h.length),h.push(["text",T,O,O+1]),O+=1,"\n"===T&&j();if(!M.scan(r))break;if(E=!0,k=M.scan(m)||"name",M.scan(c),"="===k?(w=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===k?(w=M.scanUntil(b),M.scan(p),M.scanUntil(l),k="&"):w=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(I=[k,w,O,M.pos],h.push(I),"#"===k||"^"===k)y.push(I);else if("/"===k){if(!(C=y.pop()))throw new Error('Unopened section "'+w+'" at '+O);if(C[1]!==w)throw new Error('Unclosed section "'+C[1]+'" at '+O)}else"name"===k||"{"===k||"&"===k?x=!0:"="===k&&S(w)}if(C=y.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,a=[],n=a,i=[],r=0,s=e.length;r<s;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(h))}(t,n)),l},g.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof b?t:new b(t);return this.renderTokens(n,i,a,e)},g.prototype.renderTokens=function(e,t,a,n){for(var i,r,s,o="",l=0,c=e.length;l<c;++l)s=void 0,"#"===(r=(i=e[l])[0])?s=this.renderSection(i,t,a,n):"^"===r?s=this.renderInverted(i,t,a,n):">"===r?s=this.renderPartial(i,t,a,n):"&"===r?s=this.unescapedValue(i,t):"name"===r?s=this.escapedValue(i,t):"text"===r&&(s=this.rawValue(i)),void 0!==s&&(o+=s);return o},g.prototype.renderSection=function(e,t,i,r){var s=this,o="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)o+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,r);else if(n(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return s.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,r);return o}},g.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||a(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},g.prototype.renderPartial=function(e,t,a){if(a){var i=n(a)?a(e[1]):a[e[1]];return null!=i?this.renderTokens(this.parse(i),t,a,i):void 0}},g.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},g.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},g.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new g;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,n)},e.to_html=function(t,a,i,r){var s=e.render(t,a,i);if(!n(r))return s;r(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=f,e.Context=b,e.Writer=g,e},t&&"string"!=typeof t.nodeName?s(t):(i=[t],void 0===(r="function"==typeof(n=s)?n.apply(t,i):n)||(e.exports=r))},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),r=n.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),s=n.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=n.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),c=n.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),u=n.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=n.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"});n.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"})},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),r=n.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),s=n.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),o=n.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=n.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=n.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=n.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=n.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,a){"use strict";var n=a(760);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b})),a.d(t,"j",(function(){return n.g})),a.d(t,"k",(function(){return n.i}));var i=a(884);a.d(t,"c",(function(){return i.a})),a.d(t,"d",(function(){return i.b})),a.d(t,"e",(function(){return i.c})),a.d(t,"f",(function(){return i.d})),a.d(t,"g",(function(){return i.e})),a.d(t,"h",(function(){return i.f})),a.d(t,"i",(function(){return i.g}))},function(e,t,a){e.exports=a.p+"2d015490d219c87a014c81f9555e556a.svg"},function(e,t,a){e.exports=a.p+"432a17d27c37a1b4467753dcc2332f12.svg"},function(e,t,a){e.exports=a.p+"8d3deaa318988ae73e799b48ff864cb3.svg"},function(e,t,a){e.exports=a.p+"c82e317671d73dcc4b62ca8bfdf1979c.svg"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(17),i=a(44),r=a.n(i);const s="siemEventsTable",o=r.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1a6qah7-0"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),l=r()(n.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroupTable",componentId:"sc-1a6qah7-1"})(["overflow:hidden;margin:0;display:",";"],(({$visible:e})=>e?"flex":"none")),c=r()(n.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1a6qah7-2"})(["overflow:auto;"]),u=(r()(n.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1a6qah7-3"})(["overflow:hidden;margin:0;min-height:490px;display:",";"],(({$visible:e=!0})=>e?"flex":"none")),r()(n.EuiFlexGroup).withConfig({displayName:"UpdatedFlexGroup",componentId:"sc-1a6qah7-4"})([""," ",";display:inline-flex;z-index:",";",""],(({$hasRightOffset:e,theme:t,position:a})=>"relative"===a?`margin-right: ${t.eui.euiSizeXS}; margin-left: `:e&&"absolute"===a?`margin-right: ${t.eui.euiSizeXL};`:`margin-right: ${t.eui.euiSizeXS};`),(({position:e})=>"absolute"===e?"position: absolute":"display: flex; justify-content:center; align-items:center"),(({theme:e})=>e.eui.euiZLevel1-3),(({$hasRightOffset:e,theme:t,position:a})=>"relative"===a?"right: 0;":e&&"absolute"===a?`right: ${t.eui.euiSizeXL};`:`right: ${t.eui.euiSizeL};`))),d=r()(n.EuiFlexItem).withConfig({displayName:"UpdatedFlexItem",componentId:"sc-1a6qah7-5"})(["",""],(({$show:e})=>e?"":"visibility: hidden;")),p=r.a.div.attrs((({className:e=""})=>({className:`securitySolutionTimeline__container ${e}`}))).withConfig({displayName:"EventsContainerLoading",componentId:"sc-1a6qah7-6"})(["position:relative;width:100%;overflow:hidden;flex:1;display:flex;flex-direction:column;"]),m=r()(n.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1a6qah7-7"})(["display:flex;flex-direction:column;position:relative;width:100%;",""],(({$isFullScreen:e})=>e&&"\n    border: 0;\n    box-shadow: none;\n    padding-top: 0;\n    padding-bottom: 0;\n"))},,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return f})),a.d(t,"a",(function(){return d}));var n=a(736),i=a(760),r=a(924),s=a(966);const o=e=>{const t={coreStart:e};return e=>a=>async o=>{a(o),(async({coreStart:e},{dispatch:t,getState:a},o)=>{const l=e.http,c=a();if("userChangedUrl"===o.type&&Object(i.f)(c)&&Object(i.d)(c)){const e=Object(i.i)(c);let a;try{a=(await Object(r.e)(l,e)).item,""===a.inputs[0].config.policy.value.windows.popup.malware.message&&(a.inputs[0].config.policy.value.windows.popup.malware.message=n.a,a.inputs[0].config.policy.value.mac.popup.malware.message=n.a,a.inputs[0].config.policy.value.linux.popup.malware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.ransomware.message&&(a.inputs[0].config.policy.value.windows.popup.ransomware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(a.inputs[0].config.policy.value.windows.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(a.inputs[0].config.policy.value.mac.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(a.inputs[0].config.policy.value.linux.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.windows.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.mac.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.linux.popup.behavior_protection.message=n.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:a}}),a.policy_id){const{results:e}=await Object(r.d)(l,a.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===o.type){const{id:e}=Object(i.g)(c),a=Object(i.h)(c);let n;try{n=await Object(r.f)(l,e,a).catch((t=>t.response&&409===t.response.status?Object(r.e)(l,e).then((t=>{const n=t.item;return n.inputs[0].config.policy=a.inputs[0].config.policy,Object(r.f)(l,e,Object(s.a)(n))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:n.item,updateStatus:{success:!0}}})}})(t,e,o)}};var l=a(734),c=a(238),u=a(178);const d=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0,all:0,active:0},artifacts:{location:{page:u.b,pageSize:u.c,show:void 0,filter:""}}}),p=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),m=(e=d(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const a={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(c.b)(Object(l.parse)(t.payload.search.slice(1)))}},n=Object(i.d)(a),r=Object(i.d)(e),s=Object(i.e)(a);return n?r?a:{...a,isLoading:!0}:{...d(),location:t.payload,license:s}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const a={...e,policyItem:{...e.policyItem}},n={...Object(i.c)(e)};return a.policyItem.inputs[0].config.policy.value=n,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{n[e]={...n[e],...t}})),a}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},f=(e=d(),t)=>[m].reduce(((e,a)=>a(e,t)),e)},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(476);const i={updateActiveGroups:({activeGroups:e,id:t})=>({payload:{activeGroups:e,id:t},type:n.a.updateActiveGroups}),updateGroupOptions:({newOptionList:e,id:t})=>({payload:{newOptionList:e,id:t},type:n.a.updateGroupOptions})};a(1076);const r=(e,t)=>(e=>e.groups.groupById)(e)[t]},function(e,t,a){"use strict";a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return g}));var n=a(50),i=a(2),r=a(27),s=a(135),o=a(110),l=a(70),c=a(163),u=a(885),d=a(604),p=a(886);const m=["POST",l.EPM_API_ROUTES.BULK_INSTALL_PATTERN],f=["POST",l.EPM_API_ROUTES.INSTALL_FROM_REGISTRY_PATTERN],b=()=>{const e=Object(o.i)(),t=Object(s.a)().endpointPrivileges.canAccessFleet,{mutate:a}=(e=>{const t=Object(d.b)(),a=Object(u.b)(),i=Object(p.b)();return Object(n.useMutation)((e=>Object(c.c)(e)),{...e,mutationKey:m,onSettled:(...e)=>{const n=e[0],s=null==n?void 0:n.items.find((e=>e.name===r.d));s&&"result"in s&&"installed"===s.result.status&&(t(),a(),i())}})})(),{mutate:l}=(e=>{const t=Object(d.b)(),a=Object(u.b)(),i=Object(p.b)();return Object(n.useMutation)((e=>Object(c.o)(e)),{...e,mutationKey:f,onSettled:(...e)=>{const{packageName:n}=e[2];n===r.d&&(t(),a(),i())}})})();Object(i.useEffect)((()=>{t&&(async t=>{await(null===(t=e.services.fleet)||void 0===t?void 0:t.isInitialized());const n="traditional"===o.b.getBuildFlavor()&&(o.b.getKibanaVersion().includes("-SNAPSHOT")||"main"===o.b.getKibanaBranch()),i=o.b.getPrebuiltRulesPackageVersion(),s=["endpoint",r.d];null!=i&&(l({packageName:r.d,packageVersion:i,prerelease:n,force:!0}),s.splice(s.indexOf(r.d),1)),a({packages:s,prerelease:n})})()}),[a,t,e.services.fleet,l])},g=()=>Object(n.useIsMutating)({predicate:({options:{mutationKey:e},state:{variables:t}})=>e===m?t.packages.includes(r.d):e===f&&t.packageName===r.d})>0},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(55),i=a(2),r=a.n(i),s=a(4),o=a(110),l=a(126),c=a(464),u=a(730),d=a(397),p=a(214),m=a(529),f=a(1276),b=a(210),g=a(385),y=a(159),h=a(667);const v=r.a.memo((({contextID:e,id:t,ip:a,data:i,isDraggable:v=!1,isInDetailsSidePanel:E=!1,loading:x,flowTarget:j,startDate:S,endDate:O,isLoadingAnomaliesData:k,anomaliesData:w,narrowDateRange:T,indexPatterns:I,jobNameById:C})=>{const M=Object(b.a)(),_=Object(g.a)(M),[A]=Object(o.o)(s.C),F=i[j],P=[{title:d.i,description:Object(c.g)([`${j}.geo.city_name`,`${j}.geo.region_name`],i,e,v)},{title:d.c,description:F?Object(c.d)(F.autonomousSystem,j,e,v):Object(l.d)()}],D=[_?[...P,{title:d.j,description:r.a.createElement(f.a,{anomalies:w,startDate:S,endDate:O,isLoading:k,narrowDateRange:T,jobNameById:C})}]:P,[{title:d.d,description:r.a.createElement(u.a,{indexPatterns:I,field:`${j}.ip`,value:a,type:u.b.FIRST_SEEN})},{title:d.h,description:r.a.createElement(u.a,{indexPatterns:I,field:`${j}.ip`,value:a,type:u.b.LAST_SEEN})}],[{title:d.e,description:F&&i.host?Object(c.e)({host:i.host,isDraggable:v,ipFilter:a,contextID:e}):Object(l.d)()},{title:d.f,description:F&&i.host?Object(c.f)(i.host,a,e,v):Object(l.d)()}],[{title:d.o,description:Object(c.i)(a)},{title:d.k,description:Object(c.h)(a)}]];return r.a.createElement(y.c,null,r.a.createElement(p.g,{direction:E?"column":"row"},!E&&r.a.createElement(y.b,{queryId:t,title:d.g,inspectIndex:0}),D.map(((e,t)=>r.a.createElement(h.a,{descriptionList:e,key:t}))),x&&r.a.createElement(m.a,{overlay:!0,overlayBackground:A?n.euiDarkVars.euiPageBackgroundColor:n.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));v.displayName="IpOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(125);const i=(e,t)=>t===n.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===n.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(11),r=a.n(i),s=a(110);const o=()=>{const{getComponents$:e}=Object(s.i)().services,t=Object(n.useMemo)((()=>e()),[e]);return r()(t,{})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(124),i=a(2),r=a(48),s=a(112);const{updateShowBuildingBlockAlertsFilter:o,updateShowThreatIndicatorAlertsFilter:l}=n.h,c=e=>{const t=Object(r.useDispatch)(),a=Object(i.useMemo)((()=>n.j.getTableByIdSelector()),[]),{showOnlyThreatIndicatorAlerts:c,showBuildingBlockAlerts:u}=Object(s.b)((t=>{var i,r;return null!==(i=(null!==(r=a(t,e))&&void 0!==r?r:n.q).additionalFilters)&&void 0!==i?i:n.q.additionalFilters}));return{showBuildingBlockAlerts:u,setShowBuildingBlockAlerts:Object(i.useCallback)((a=>{t(o({id:e,showBuildingBlockAlerts:a}))}),[t,e]),showOnlyThreatIndicatorAlerts:c,setShowOnlyThreatIndicatorAlerts:Object(i.useCallback)((a=>{t(l({id:e,showOnlyThreatIndicatorAlerts:a}))}),[t,e])}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(30),i=a(2),r=a(1280),s=a(476),o=a(740),l=a(1124),c=a(13);const u=({defaultGroupingOptions:e,groupingId:t,fields:a,onGroupChange:n,maxGroupingLevels:r})=>{const s=Object(i.useCallback)((e=>{n([e])}),[n]);return Object(c.jsx)(o.a,{groupingId:t,groupsSelected:["none"],"data-test-subj":"alerts-table-group-selector",onGroupChange:s,fields:a,maxGroupingLevels:r,options:e})},d=({defaultGroupingOptions:e,dispatch:t,fields:a,groupingId:u,groupingState:d,maxGroupingLevels:p=1,onGroupChange:m,onOptionsChange:f,tracker:b,title:g})=>{var y;const{activeGroups:h,options:v}=null!==(y=Object(r.b)({groups:d},u))&&void 0!==y?y:s.c,E=Object(i.useCallback)((e=>{t(r.a.updateActiveGroups({id:u,activeGroups:e}))}),[t,u]),x=Object(i.useCallback)((e=>{t(r.a.updateGroupOptions({id:u,newOptionList:e})),null==f||f(e)}),[t,u,f]),j=Object(i.useCallback)((e=>{if(1===p)E([e]);else{if(h.find((t=>t===e))){const t=h.filter((t=>t!==e));return void(0===t.length?E(["none"]):E(t))}const t=Object(o.e)([e])?[e]:[...h.filter((e=>"none"!==e)),e];E(t)}null==b||b(n.METRIC_TYPE.CLICK,l.a.groupChanged({groupingId:u,selected:e})),null==m||m({tableId:u,groupByField:e})}),[u,p,m,h,E,b]);return Object(i.useEffect)((()=>{if(0===v.length&&e.length>0)return x(e.find((e=>h.find((t=>t===e.key))))?e:[...e,...Object(o.e)(h)?[]:h.map((e=>({key:e,label:e})))]);if(Object(o.e)(h))return;const t=v.map((e=>e.key)),a=[...v];h.forEach((e=>{t.includes(e)||a.push({label:e,key:e})})),a.length!==v.length&&x(a)}),[e,v,h,x]),Object(c.jsx)(o.a,{groupingId:u,groupsSelected:h,"data-test-subj":"alerts-table-group-selector",onGroupChange:j,fields:a,maxGroupingLevels:p,options:v,title:g})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(2),i=a.n(n),r=a(17),s=a(55),o=a(48),l=a(44),c=a.n(l),u=a(124),d=a(127),p=a(112),m=a(119),f=a(189),b=a(1078),g=a(181),y=a(906),h=a(866),v=a(118),E=a(134);const x="sessionViewFullScreen",j=Object(l.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),S=c.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-jhq5kd-0"})(["",""],j),O=Object(l.css)(["background-color:"," position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],(({theme:e})=>`${e.eui.euiColorEmptyShade};`),s.euiThemeVars.euiZLevel3),k=c.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-jhq5kd-1"})(["",""],O),w=c()(y.a).withConfig({displayName:"StyledResolver",componentId:"sc-jhq5kd-2"})(["height:100%;"]),T=c()(r.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-jhq5kd-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),x,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),I=({SessionView:e,Navigation:t,scopeId:a})=>{const s=Object(o.useDispatch)(),{globalFullScreen:l}=Object(f.a)(),{timelineFullScreen:c}=Object(f.c)(),y=Object(n.useMemo)((()=>Object(d.isInTableScope)(a)?u.j.getTableByIdSelector():Object(d.isTimelineScope)(a)?v.b.getTimelineByIdSelector():void 0),[a]),I=Object(d.isInTableScope)(a)?u.q:E.b,{graphEventId:C,sessionViewConfig:M}=Object(p.a)((e=>{var t;return null!==(t=y&&y(e,a))&&void 0!==t?t:I})),_=Object(n.useMemo)((()=>Object(b.b)({globalFullScreen:l,isActiveTimelines:Object(d.isActiveTimeline)(a),timelineFullScreen:c})),[l,a,c]);Object(n.useEffect)((()=>()=>{const e=Object(d.getScopedActions)(a);e&&s(e.updateGraphEventId({id:a,graphEventId:""})),Object(d.isActiveTimeline)(a)?s(g.c.setFullScreen({id:m.a.timeline,fullScreen:!1})):s(g.c.setFullScreen({id:m.a.global,fullScreen:!1}))}),[s,a]);const{from:A,to:F,shouldUpdate:P,selectedPatterns:D}=Object(h.a)(Object(d.isActiveTimeline)(a)),N=Object(n.useMemo)((()=>({from:A,to:F})),[A,F]),R=Object(n.useRef)(null);Object(n.useLayoutEffect)((()=>{_&&R.current?R.current.setAttribute("style",O.join("")):R.current&&R.current.setAttribute("style",j.join(""))}),[_]);const L=Object(n.useMemo)((()=>void 0!==C?i.a.createElement(w,{databaseDocumentID:C,resolverComponentInstanceID:a,indices:D,shouldUpdate:P,filters:N}):i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),[C,a,D,P,N]);return Object(d.isActiveTimeline)(a)||null===M?_&&!Object(d.isActiveTimeline)(a)?i.a.createElement(k,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),L):i.a.createElement(S,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),L):i.a.createElement(S,{"data-test-subj":"overlayContainer",ref:R},i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexItem,{grow:!1},t),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(T,{grow:2,className:_?x:""},e)))},C=i.a.memo(I)},function(e,t,a){"use strict";var n=a(357);a.d(t,"b",(function(){return n.c}));var i=a(1125);a.d(t,"a",(function(){return i.a}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(17),s=a(1334),o=a(887),l=a(110);let c;!function(e){e.overview="details",e.activityLog="activity_log"}(c||(c={}));const u=Object(n.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:a}=Object(l.c)(),n=Object(o.a)(e.route);return i.a.createElement(r.EuiTab,{href:a({path:e.route}),onClick:n,isSelected:t,key:e.id,"data-test-subj":`endpoint-details-flyout-tab-${e.id}`},e.name)}));u.displayName="EndpointDetailsTab";const d=Object(n.memo)((({hostname:e,isHostInfoLoading:t,show:a,tabs:o})=>{const l=Object(n.useMemo)((()=>o.find((e=>e.id===a))),[o,a]),c=o.map((e=>i.a.createElement(u,{key:e.id,tab:e,isSelected:e.id===(null==l?void 0:l.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{hostname:e,isHostInfoLoading:t,hasBorder:!0},i.a.createElement(r.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},c)),i.a.createElement(r.EuiFlyoutBody,{"data-test-subj":`endpoint${"details"===(null==l?void 0:l.id)?"Details":"ActivityLog"}FlyoutBody`},null==l?void 0:l.content))}));d.displayName="EndpointDetailsFlyoutTabs"},,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),i=a(209),r=a(125),s=a(5);const o=s.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});s.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var l=a(279);const c="networkDetailsQuery",u=({filterQuery:e,id:t=c,indexNames:a,ip:s,skip:u})=>{const{loading:d,result:p,search:m,refetch:f,inspect:b}=Object(l.a)({factoryQueryType:r.q.details,initialResult:{networkDetails:{}},errorMessage:o,abort:u}),g=Object(n.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:b,isInspected:!1,refetch:f})),[t,b,f,p.networkDetails]),y=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:r.q.details,filterQuery:Object(i.a)(e),ip:s})),[e,a,s]);return Object(n.useEffect)((()=>{!u&&y&&m(y)}),[y,m,u]),[d,g]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),i=a.n(n),r=a(17),s=a(5),o=a(238),l=a(887),c=a(691),u=a(436),d=a(352);const p=Object(n.memo)((({endpointId:e})=>{var t;const{getAppUrl:a}=Object(d.a)(),{show:p,...m}=Object(c.b)(u.uiQueryParams),f=Object(n.useMemo)((()=>Object(o.d)({name:"endpointDetails",...m,selected_endpoint:e})),[m,e]),b=Object(l.a)(f),g=Object(n.useMemo)((()=>({title:s.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:a({path:f}),onClick:b})),[b,a,f]);return i.a.createElement("div",null,i.a.createElement(r.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==g?void 0:g.href)&&void 0!==t?t:"",onClick:null==g?void 0:g.onClick},null==g?void 0:g.title))}));p.displayName="BackToEndpointDetailsFlyoutSubHeader";const m=Object(n.memo)((({children:e,endpointId:t,hasBorder:a=!1,hostname:n,isHostInfoLoading:s})=>i.a.createElement(r.EuiFlyoutHeader,{hasBorder:a},t&&i.a.createElement(p,{endpointId:t}),s?i.a.createElement(r.EuiSkeletonText,{lines:1}):i.a.createElement(r.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate"},i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},n))),e)));m.displayName="EndpointDetailsFlyoutHeader"},,,,,,,,,function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1344);case"v8light":return a(1346)}},function(e,t,a){var n=a(332),i=a(1345);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav{background:linear-gradient(160deg,#3437414d,#3437414d 32px,#f000 0),linear-gradient(175deg,#3437414d,#3437414d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1347);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav{background:linear-gradient(160deg,#d3dae64d,#d3dae64d 32px,#f000 0),linear-gradient(175deg,#d3dae64d,#d3dae64d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1349);case"v8light":return a(1351)}},function(e,t,a){var n=a(332),i=a(1350);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){var n=a(333),i=a(1143),r=a(1144);t=n(!1);var s=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+s+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1352);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){var n=a(333),i=a(1143),r=a(1144);t=n(!1);var s=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+s+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1354);case"v8light":return a(1356)}},function(e,t,a){var n=a(332),i=a(1355);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1357);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,a){e.exports=a.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.dashboards.pageTitle",{defaultMessage:"Dashboards"}),r=n.i18n.translate("xpack.securitySolution.dashboards.dashboard.createDashboardTitle",{defaultMessage:"Editing New Dashboard"})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(395);const r=Object(i.c)(),s=()=>{const[e]=Object(n.useState)(r);return{globalKQLHeaderPortalNode:e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=t.indexOf(e),i=[...t];n>=0?i.splice(n,1):i.push(e),a(i)}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(57);const i=({groups:e},t)=>e[t],r=()=>Object(n.createSelector)(i,(e=>e))},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(2),i=a.n(n),r=a(48),s=a(144),o=a(124),l=a(63),c=a(118),u=a(4),d=a(956),p=a(751),m=a(151),f=a(130);const b=({columnHeaders:e,controlColumn:t,data:a,disabled:b,index:g,isEventViewer:y,loadingEventIds:h,onRowSelected:v,onRuleChange:E,pageRowIndex:x,rowIndex:j,selectedEventIds:S,showCheckboxes:O,tabType:k,tableId:w,setEventsLoading:T,setEventsDeleted:I,width:C,refetch:M})=>{const{data:_,ecs:A,_id:F,_index:P}=null!=a?a:{},{openFlyout:D}=Object(s.d)(),N=Object(r.useDispatch)(),[R]=Object(l.useUiSetting$)(u.nb),L=Object(f.a)("expandableFlyoutInCreateRuleEnabled"),B=Object(n.useMemo)((()=>_&&e.map((e=>{var t;return null!==(t=Object(p.b)({data:_,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[e,_]);let z;z=w===o.e.rulePreview?R&&L:R;const q=Object(n.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:null!=F?F:"",indexName:null!=P?P:""}};z?D({right:{id:d.a,params:{id:F,indexName:P,scopeId:w}}}):w===o.e.alertsOnCasePage?N(c.a.toggleDetailPanel({...e,id:m.f.casePage})):N(o.h.toggleDetailPanel({...e,tabType:k,id:w}))}),[N,F,P,D,k,w,z]),$=t.rowCellRender;return _&&A&&F?i.a.createElement(i.a.Fragment,null,$&&i.a.createElement($,{ariaRowindex:x+1,checked:Object.keys(S).includes(F),columnId:t.id||"",columnValues:B||"",data:_,"data-test-subj":"actions",disabled:b,ecsData:A,eventId:F,index:g,isEventViewer:y,loadingEventIds:h,onEventDetailsPanelOpened:q,onRowSelected:v,onRuleChange:E,rowIndex:j,showCheckboxes:O,tabType:k,timelineId:w,width:C,setEventsLoading:T,setEventsDeleted:I,refetch:M})):i.a.createElement("span",{"data-test-subj":"noData"})},g=i.a.memo(b)},function(e,t,a){"use strict";(function(e){var n=a(1673),i=a(2);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function c(e,t){return p(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r,s,o=[],l=!0,c=!1;try{if(r=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=r.call(a)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=a.return&&(s=a.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}(e,t)||f(e,t)||g()}function u(e){return p(e)||m(e)||f(e)||g()}function d(e){return function(e){if(Array.isArray(e))return b(e)}(e)||m(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){if(Array.isArray(e))return e}function m(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function f(e,t){if(e){if("string"==typeof e)return b(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=f(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw r}}}}var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function v(e,t){return e(t={exports:{}},t.exports),t.exports}var E=v((function(e){
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/
!function(){var t={}.hasOwnProperty;function a(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var r=typeof i;if("string"===r||"number"===r)e.push(i);else if(Array.isArray(i)){if(i.length){var s=a.apply(null,i);s&&e.push(s)}}else if("object"===r){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var o in i)t.call(i,o)&&i[o]&&e.push(o)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):window.classNames=a}()})),x={hunkClassName:"",lineClassName:"",gutterClassName:"",codeClassName:"",monotonous:!1,gutterType:"default",viewType:"split",widgets:{},hideGutter:!1,selectedChanges:[],generateAnchorID:function(){},renderGutter:function(e){var t=e.renderDefault;return(0,e.wrapInAnchor)(t())},codeEvents:{},gutterEvents:{}},j=i.createContext(x),S=j.Provider,O=function(){return i.useContext(j)},k=v((function(e,t){!function(t){function a(e){var t=e.slice(11),a=null,n=null;switch(t.indexOf('"')){case-1:a=(s=t.split(" "))[0].slice(2),n=s[1].slice(2);break;case 0:var i=t.indexOf('"',2);a=t.slice(3,i);var r=t.indexOf('"',i+1);n=r<0?t.slice(i+4):t.slice(r+3,-1);break;default:var s;a=(s=t.split(" "))[0].slice(2),n=s[1].slice(3,-1)}return{oldPath:a,newPath:n}}var n={parse:function(e){for(var t,n,i,r,s,o=[],l=2,c=e.split("\n"),u=c.length,d=0;d<u;){var p=c[d];if(0===p.indexOf("diff --git")){t={hunks:[],oldEndingNewLine:!0,newEndingNewLine:!0,oldPath:(s=a(p)).oldPath,newPath:s.newPath},o.push(t);var m,f=null;e:for(;m=c[++d];){var b=m.indexOf(" "),g=b>-1?m.slice(0,b):g;switch(g){case"diff":d--;break e;case"deleted":case"new":var y=m.slice(b+1);0===y.indexOf("file mode")&&(t["new"===g?"newMode":"oldMode"]=y.slice(10));break;case"similarity":t.similarity=parseInt(m.split(" ")[2],10);break;case"index":var h=m.slice(b+1).split(" "),v=h[0].split("..");t.oldRevision=v[0],t.newRevision=v[1],h[1]&&(t.oldMode=t.newMode=h[1]);break;case"copy":case"rename":var E=m.slice(b+1);0===E.indexOf("from")?t.oldPath=E.slice(5):t.newPath=E.slice(3),f=g;break;case"---":var x=m.slice(b+1),j=c[++d].slice(4);"/dev/null"===x?(j=j.slice(2),f="add"):"/dev/null"===j?(x=x.slice(2),f="delete"):(f="modify",x=x.slice(2),j=j.slice(2)),x&&(t.oldPath=x),j&&(t.newPath=j),l=5;break e}}t.type=f||"modify"}else if(0===p.indexOf("Binary"))t.isBinary=!0,t.type=p.indexOf("/dev/null and")>=0?"add":p.indexOf("and /dev/null")>=0?"delete":"modify",l=2,t=null;else if(5===l)if(0===p.indexOf("@@")){var S=/^@@\s+-([0-9]+)(,([0-9]+))?\s+\+([0-9]+)(,([0-9]+))?/.exec(p);n={content:p,oldStart:S[1]-0,newStart:S[4]-0,oldLines:S[3]-0||1,newLines:S[6]-0||1,changes:[]},t.hunks.push(n),i=n.oldStart,r=n.newStart}else{var O=p.slice(0,1),k={content:p.slice(1)};switch(O){case"+":k.type="insert",k.isInsert=!0,k.lineNumber=r,r++;break;case"-":k.type="delete",k.isDelete=!0,k.lineNumber=i,i++;break;case" ":k.type="normal",k.isNormal=!0,k.oldLineNumber=i,k.newLineNumber=r,i++,r++;break;case"\\":var w=n.changes[n.changes.length-1];w.isDelete||(t.newEndingNewLine=!1),w.isInsert||(t.oldEndingNewLine=!1)}k.type&&n.changes.push(k)}d++}return o}};e.exports=n}()}));function w(e){return"insert"===e.type}function T(e){return"delete"===e.type}function I(e){return"normal"===e.type}function C(e){return e[0]}function M(e){return e[e.length-1]}function _(e){return["".concat(e,"Start"),"".concat(e,"Lines")]}function A(e){return"old"===e?function(e){return w(e)?-1:I(e)?e.oldLineNumber:e.lineNumber}:function(e){return T(e)?-1:I(e)?e.newLineNumber:e.lineNumber}}function F(e,t){return function(a,n){var i=a[e],r=i+a[t];return n>=i&&n<r}}function P(e,t){return function(a,n,i){var r=a[e]+a[t],s=n[e];return i>=r&&i<s}}function D(e){var t=A(e),a=function(e){var t=c(_(e),2),a=F(t[0],t[1]);return function(e,t){return e.find((function(e){return a(e,t)}))}}(e);return function(e,n){var i=a(e,n);if(i)return i.changes.find((function(e){return t(e)===n}))}}function N(e){var t="old"===e?"new":"old",a=c(_(e),2),n=a[0],i=a[1],r=c(_(t),2),s=r[0],o=r[1],l=A(e),u=A(t),d=F(n,i),p=P(n,i);return function(e,t){var a=C(e);if(t<a[n]){var r=a[n]-t;return a[s]-r}var c=M(e);if(c[n]+c[i]<=t){var m=t-c[n]-c[i];return c[s]+c[o]+m}for(var f=0;f<e.length;f++){var b=e[f],g=e[f+1];if(d(b,t)){var y=b.changes.findIndex((function(e){return l(e)===t})),h=b.changes[y];if(I(h))return u(h);var v=T(h)?y+1:y-1,E=b.changes[v];if(!E)return-1;var x=w(h)?"delete":"insert";return E.type===x?u(E):-1}if(p(b,g,t)){var j=t-b[n]-b[i];return b[s]+b[o]+j}}throw new Error("Unexpected line position ".concat(t))}}var R=function(e,t,a,n){for(var i=e.length,r=a+(n?1:-1);n?r--:++r<i;)if(t(e[r],r,e))return r;return-1},L=function(e,t){return e===t||e!=e&&t!=t},B=function(e,t){for(var a=e.length;a--;)if(L(e[a][0],t))return a;return-1},z=Array.prototype.splice;function q(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(e){var t=this.__data__,a=B(t,e);return!(a<0||(a==t.length-1?t.pop():z.call(t,a,1),--this.size,0))},q.prototype.get=function(e){var t=this.__data__,a=B(t,e);return a<0?void 0:t[a][1]},q.prototype.has=function(e){return B(this.__data__,e)>-1},q.prototype.set=function(e,t){var a=this.__data__,n=B(a,e);return n<0?(++this.size,a.push([e,t])):a[n][1]=t,this};var $=q,V="object"==typeof h&&h&&h.Object===Object&&h,U="object"==typeof self&&self&&self.Object===Object&&self,H=V||U||Function("return this")(),Q=H.Symbol,G=Object.prototype,W=G.hasOwnProperty,Z=G.toString,K=Q?Q.toStringTag:void 0,J=Object.prototype.toString,Y=Q?Q.toStringTag:void 0,X=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Y&&Y in Object(e)?function(e){var t=W.call(e,K),a=e[K];try{e[K]=void 0;var n=!0}catch(e){}var i=Z.call(e);return n&&(t?e[K]=a:delete e[K]),i}(e):function(e){return J.call(e)}(e)},ee=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},te=function(e){if(!ee(e))return!1;var t=X(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},ae=H["__core-js_shared__"],ne=function(){var e=/[^.]+$/.exec(ae&&ae.keys&&ae.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ie=Function.prototype.toString,re=function(e){if(null!=e){try{return ie.call(e)}catch(e){}try{return e+""}catch(e){}}return""},se=/^\[object .+?Constructor\]$/,oe=Function.prototype,le=Object.prototype,ce=oe.toString,ue=le.hasOwnProperty,de=RegExp("^"+ce.call(ue).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pe=function(e,t){var a=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ee(e)||(t=e,ne&&ne in t))&&(te(e)?de:se).test(re(e));var t}(a)?a:void 0},me=pe(H,"Map"),fe=pe(Object,"create"),be=Object.prototype.hasOwnProperty,ge=Object.prototype.hasOwnProperty;function ye(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}ye.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},ye.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ye.prototype.get=function(e){var t=this.__data__;if(fe){var a=t[e];return"__lodash_hash_undefined__"===a?void 0:a}return be.call(t,e)?t[e]:void 0},ye.prototype.has=function(e){var t=this.__data__;return fe?void 0!==t[e]:ge.call(t,e)},ye.prototype.set=function(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=fe&&void 0===t?"__lodash_hash_undefined__":t,this};var he=ye,ve=function(e,t){var a,n,i=e.__data__;return("string"==(n=typeof(a=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==a:null===a)?i["string"==typeof t?"string":"hash"]:i.map};function Ee(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}Ee.prototype.clear=function(){this.size=0,this.__data__={hash:new he,map:new(me||$),string:new he}},Ee.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},Ee.prototype.get=function(e){return ve(this,e).get(e)},Ee.prototype.has=function(e){return ve(this,e).has(e)},Ee.prototype.set=function(e,t){var a=ve(this,e),n=a.size;return a.set(e,t),this.size+=a.size==n?0:1,this};var xe=Ee;function je(e){var t=this.__data__=new $(e);this.size=t.size}je.prototype.clear=function(){this.__data__=new $,this.size=0},je.prototype.delete=function(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a},je.prototype.get=function(e){return this.__data__.get(e)},je.prototype.has=function(e){return this.__data__.has(e)},je.prototype.set=function(e,t){var a=this.__data__;if(a instanceof $){var n=a.__data__;if(!me||n.length<199)return n.push([e,t]),this.size=++a.size,this;a=this.__data__=new xe(n)}return a.set(e,t),this.size=a.size,this};var Se=je;function Oe(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new xe;++t<a;)this.add(e[t])}Oe.prototype.add=Oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Oe.prototype.has=function(e){return this.__data__.has(e)};var ke=Oe,we=function(e,t){for(var a=-1,n=null==e?0:e.length;++a<n;)if(t(e[a],a,e))return!0;return!1},Te=function(e,t,a,n,i,r){var s=1&a,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var c=r.get(e),u=r.get(t);if(c&&u)return c==t&&u==e;var d=-1,p=!0,m=2&a?new ke:void 0;for(r.set(e,t),r.set(t,e);++d<o;){var f=e[d],b=t[d];if(n)var g=s?n(b,f,d,t,e,r):n(f,b,d,e,t,r);if(void 0!==g){if(g)continue;p=!1;break}if(m){if(!we(t,(function(e,t){if(s=t,!m.has(s)&&(f===e||i(f,e,a,n,r)))return m.push(t);var s}))){p=!1;break}}else if(f!==b&&!i(f,b,a,n,r)){p=!1;break}}return r.delete(e),r.delete(t),p},Ie=H.Uint8Array,Ce=function(e){var t=-1,a=Array(e.size);return e.forEach((function(e,n){a[++t]=[n,e]})),a},Me=function(e){var t=-1,a=Array(e.size);return e.forEach((function(e){a[++t]=e})),a},_e=Q?Q.prototype:void 0,Ae=_e?_e.valueOf:void 0,Fe=function(e,t){for(var a=-1,n=t.length,i=e.length;++a<n;)e[i+a]=t[a];return e},Pe=Array.isArray,De=Object.prototype.propertyIsEnumerable,Ne=Object.getOwnPropertySymbols,Re=Ne?function(e){return null==e?[]:(e=Object(e),function(t,a){for(var n=-1,i=null==t?0:t.length,r=0,s=[];++n<i;){var o=t[n];l=o,De.call(e,l)&&(s[r++]=o)}var l;return s}(Ne(e)))}:function(){return[]},Le=function(e){return null!=e&&"object"==typeof e},Be=function(e){return Le(e)&&"[object Arguments]"==X(e)},ze=Object.prototype,qe=ze.hasOwnProperty,$e=ze.propertyIsEnumerable,Ve=Be(function(){return arguments}())?Be:function(e){return Le(e)&&qe.call(e,"callee")&&!$e.call(e,"callee")},Ue=function(){return!1},He=v((function(e,t){var a=t&&!t.nodeType&&t,n=a&&e&&!e.nodeType&&e,i=n&&n.exports===a?H.Buffer:void 0,r=(i?i.isBuffer:void 0)||Ue;e.exports=r})),Qe=/^(?:0|[1-9]\d*)$/,Ge=function(e,t){var a=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==a||"symbol"!=a&&Qe.test(e))&&e>-1&&e%1==0&&e<t},We=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Ze={};Ze["[object Float32Array]"]=Ze["[object Float64Array]"]=Ze["[object Int8Array]"]=Ze["[object Int16Array]"]=Ze["[object Int32Array]"]=Ze["[object Uint8Array]"]=Ze["[object Uint8ClampedArray]"]=Ze["[object Uint16Array]"]=Ze["[object Uint32Array]"]=!0,Ze["[object Arguments]"]=Ze["[object Array]"]=Ze["[object ArrayBuffer]"]=Ze["[object Boolean]"]=Ze["[object DataView]"]=Ze["[object Date]"]=Ze["[object Error]"]=Ze["[object Function]"]=Ze["[object Map]"]=Ze["[object Number]"]=Ze["[object Object]"]=Ze["[object RegExp]"]=Ze["[object Set]"]=Ze["[object String]"]=Ze["[object WeakMap]"]=!1;var Ke,Je=v((function(e,t){var a=t&&!t.nodeType&&t,n=a&&e&&!e.nodeType&&e,i=n&&n.exports===a&&V.process,r=function(){try{return n&&n.require&&n.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=r})),Ye=Je&&Je.isTypedArray,Xe=Ye?(Ke=Ye,function(e){return Ke(e)}):function(e){return Le(e)&&We(e.length)&&!!Ze[X(e)]},et=Object.prototype.hasOwnProperty,tt=Object.prototype,at=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||tt)},nt=function(e,t){return function(a){return e(t(a))}}(Object.keys,Object),it=Object.prototype.hasOwnProperty,rt=function(e){if(!at(e))return nt(e);var t=[];for(var a in Object(e))it.call(e,a)&&"constructor"!=a&&t.push(a);return t},st=function(e){return null!=e&&We(e.length)&&!te(e)},ot=function(e){return st(e)?function(e,t){var a=Pe(e),n=!a&&Ve(e),i=!a&&!n&&He(e),r=!a&&!n&&!i&&Xe(e),s=a||n||i||r,o=s?function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}(e.length,String):[],l=o.length;for(var c in e)!t&&!et.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ge(c,l))||o.push(c);return o}(e):rt(e)},lt=function(e){return function(e,t,a){var n=t(e);return Pe(e)?n:Fe(n,a(e))}(e,ot,Re)},ct=Object.prototype.hasOwnProperty,ut=pe(H,"DataView"),dt=pe(H,"Promise"),pt=pe(H,"Set"),mt=pe(H,"WeakMap"),ft=re(ut),bt=re(me),gt=re(dt),yt=re(pt),ht=re(mt),vt=X;(ut&&"[object DataView]"!=vt(new ut(new ArrayBuffer(1)))||me&&"[object Map]"!=vt(new me)||dt&&"[object Promise]"!=vt(dt.resolve())||pt&&"[object Set]"!=vt(new pt)||mt&&"[object WeakMap]"!=vt(new mt))&&(vt=function(e){var t=X(e),a="[object Object]"==t?e.constructor:void 0,n=a?re(a):"";if(n)switch(n){case ft:return"[object DataView]";case bt:return"[object Map]";case gt:return"[object Promise]";case yt:return"[object Set]";case ht:return"[object WeakMap]"}return t});var Et=vt,xt="[object Object]",jt=Object.prototype.hasOwnProperty,St=function e(t,a,n,i,r){return t===a||(null==t||null==a||!Le(t)&&!Le(a)?t!=t&&a!=a:function(e,t,a,n,i,r){var s=Pe(e),o=Pe(t),l=s?"[object Array]":Et(e),c=o?"[object Array]":Et(t),u=(l="[object Arguments]"==l?xt:l)==xt,d=(c="[object Arguments]"==c?xt:c)==xt,p=l==c;if(p&&He(e)){if(!He(t))return!1;s=!0,u=!1}if(p&&!u)return r||(r=new Se),s||Xe(e)?Te(e,t,a,n,i,r):function(e,t,a,n,i,r,s){switch(a){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!r(new Ie(e),new Ie(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return L(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=Ce;case"[object Set]":var l=1&n;if(o||(o=Me),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;n|=2,s.set(e,t);var u=Te(o(e),o(t),n,i,r,s);return s.delete(e),u;case"[object Symbol]":if(Ae)return Ae.call(e)==Ae.call(t)}return!1}(e,t,l,a,n,i,r);if(!(1&a)){var m=u&&jt.call(e,"__wrapped__"),f=d&&jt.call(t,"__wrapped__");if(m||f){var b=m?e.value():e,g=f?t.value():t;return r||(r=new Se),i(b,g,a,n,r)}}return!!p&&(r||(r=new Se),function(e,t,a,n,i,r){var s=1&a,o=lt(e),l=o.length;if(l!=lt(t).length&&!s)return!1;for(var c=l;c--;){var u=o[c];if(!(s?u in t:ct.call(t,u)))return!1}var d=r.get(e),p=r.get(t);if(d&&p)return d==t&&p==e;var m=!0;r.set(e,t),r.set(t,e);for(var f=s;++c<l;){var b=e[u=o[c]],g=t[u];if(n)var y=s?n(g,b,u,t,e,r):n(b,g,u,e,t,r);if(!(void 0===y?b===g||i(b,g,a,n,r):y)){m=!1;break}f||(f="constructor"==u)}if(m&&!f){var h=e.constructor,v=t.constructor;h==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof h&&h instanceof h&&"function"==typeof v&&v instanceof v||(m=!1)}return r.delete(e),r.delete(t),m}(e,t,a,n,i,r))}(t,a,n,i,e,r))},Ot=function(e){return e==e&&!ee(e)},kt=function(e,t){return function(a){return null!=a&&a[e]===t&&(void 0!==t||e in Object(a))}},wt=function(e){return"symbol"==typeof e||Le(e)&&"[object Symbol]"==X(e)},Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,Ct=function(e,t){if(Pe(e))return!1;var a=typeof e;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=e&&!wt(e))||It.test(e)||!Tt.test(e)||null!=t&&e in Object(t)};function Mt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var a=function(){var n=arguments,i=t?t.apply(this,n):n[0],r=a.cache;if(r.has(i))return r.get(i);var s=e.apply(this,n);return a.cache=r.set(i,s)||r,s};return a.cache=new(Mt.Cache||xe),a}Mt.Cache=xe;var _t,At,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/\\(\\)?/g,Dt=(_t=Mt((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ft,(function(e,a,n,i){t.push(n?i.replace(Pt,"$1"):a||e)})),t}),(function(e){return 500===At.size&&At.clear(),e})),At=_t.cache,_t),Nt=function(e,t){for(var a=-1,n=null==e?0:e.length,i=Array(n);++a<n;)i[a]=t(e[a],a,e);return i},Rt=Q?Q.prototype:void 0,Lt=Rt?Rt.toString:void 0,Bt=function e(t){if("string"==typeof t)return t;if(Pe(t))return Nt(t,e)+"";if(wt(t))return Lt?Lt.call(t):"";var a=t+"";return"0"==a&&1/t==-1/0?"-0":a},zt=function(e){return null==e?"":Bt(e)},qt=function(e,t){return Pe(e)?e:Ct(e,t)?[e]:Dt(zt(e))},$t=function(e){if("string"==typeof e||wt(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Vt=function(e,t){for(var a=0,n=(t=qt(t,e)).length;null!=e&&a<n;)e=e[$t(t[a++])];return a&&a==n?e:void 0},Ut=function(e,t){return null!=e&&t in Object(e)},Ht=function(e,t){return Ct(e)&&Ot(t)?kt($t(e),t):function(a){var n=function(e,t,a){var n=null==e?void 0:Vt(e,t);return void 0===n?void 0:n}(a,e);return void 0===n&&n===t?function(e,t){return null!=e&&function(e,t,a){for(var n=-1,i=(t=qt(t,e)).length,r=!1;++n<i;){var s=$t(t[n]);if(!(r=null!=e&&a(e,s)))break;e=e[s]}return r||++n!=i?r:!!(i=null==e?0:e.length)&&We(i)&&Ge(s,i)&&(Pe(e)||Ve(e))}(e,t,Ut)}(a,e):St(t,n,3)}},Qt=function(e){return e},Gt=function(e){return"function"==typeof e?e:null==e?Qt:"object"==typeof e?Pe(e)?Ht(e[0],e[1]):(i=function(e){for(var t=ot(e),a=t.length;a--;){var n=t[a],i=e[n];t[a]=[n,i,Ot(i)]}return t}(n=e),1==i.length&&i[0][2]?kt(i[0][0],i[0][1]):function(e){return e===n||function(e,t,a,n){var i=a.length,r=i;if(null==e)return!r;for(e=Object(e);i--;){var s=a[i];if(s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<r;){var o=(s=a[i])[0],l=e[o],c=s[1];if(s[2]){if(void 0===l&&!(o in e))return!1}else{var u,d=new Se;if(!(void 0===u?St(c,l,3,n,d):u))return!1}}return!0}(e,0,i)}):Ct(t=e)?(a=$t(t),function(e){return null==e?void 0:e[a]}):function(e){return function(t){return Vt(t,e)}}(t);var t,a,n,i},Wt=/\s/,Zt=/^\s+/,Kt=/^[-+]0x[0-9a-f]+$/i,Jt=/^0b[01]+$/i,Yt=/^0o[0-7]+$/i,Xt=parseInt,ea=function(e){return e?1/0===(e=function(e){if("number"==typeof e)return e;if(wt(e))return NaN;if(ee(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ee(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;var a;e=(a=e)?a.slice(0,function(e){for(var t=e.length;t--&&Wt.test(e.charAt(t)););return t}(a)+1).replace(Zt,""):a;var n=Jt.test(e);return n||Yt.test(e)?Xt(e.slice(2),n?2:8):Kt.test(e)?NaN:+e}(e))||-1/0===e?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},ta=function(e){var t=ea(e),a=t%1;return t==t?a?t-a:t:0},aa=Math.max,na=Math.min,ia=function(e,t,a){var n=null==e?0:e.length;if(!n)return-1;var i=n-1;return void 0!==a&&(i=ta(a),i=a<0?aa(n+i,0):na(i,n-1)),R(e,Gt(t),i,!0)},ra=A("old"),sa=A("new");function oa(e){var t=e.oldStart;return[t,t+e.oldLines-1]}function la(e){if(!e.length)return null;var t=e.reduce((function(e,t){return I(t)||(e.isPlain=!1),w(t)||(e.oldLines=e.oldLines+1,-1===e.oldStart&&(e.oldStart=ra(t))),T(t)||(e.newLines=e.newLines+1,-1===e.newStart&&(e.newStart=sa(t))),e}),{isPlain:!0,content:"",oldStart:-1,oldLines:0,newStart:-1,newLines:0}),a=t.oldStart,n=t.oldLines,i=t.newStart,r=t.newLines;return s(s({},t),{},{content:"@@ -".concat(a,",").concat(n," +").concat(i,",").concat(r),changes:e})}function ca(e,t,a){return la(e.map((function(e,n){return{type:"normal",isNormal:!0,oldLineNumber:t+n,newLineNumber:a+n,content:""+e}})))}function ua(e,t,a){var n=e.changes,i=n.findIndex((function(e){return ra(e)>=t}));if(-1===i)return null;var r=function(){if(0===i)return i;var e=ia(n,(function(e){return!w(e)}),i-1);return-1===e?i:e+1}();if(void 0===a)return la(n.slice(r));var s=ia(n,(function(e){return ra(e)<=a}));return la(n.slice(r,-1===s?void 0:s))}function da(e,t){if(!e)return t;if(!t)return e;var a=c(oa(e),2),n=a[0],i=a[1],r=c(oa(t),2),s=r[0],o=r[1];if(i+1===s)return la([].concat(d(e.changes),d(t.changes)));if(n<=s&&i>=o){if(e.isPlain&&!t.isPlain){var l=ua(e,n,s),u=ua(e,o+1);return da(da(l,t),u)}return e}return e.isPlain?da(ua(e,n,s),t):da(e,ua(t,i+1))}function pa(e,t){var a=M(e);if(!a)return[t];if(a.oldStart+a.oldLines<t.oldStart)return e.concat(t);var n=da(a,t);return n?[].concat(d(e.slice(0,-1)),[n]):e}function ma(e,t){var a=ra(t.changes[0]),n=e.findIndex((function(e){var t=e.changes;return!!t.length&&ra(t[0])>=a}));return(-1===n?e.concat(t):[].concat(d(e.slice(0,n)),[t],d(e.slice(n)))).reduce(pa,[])}function fa(e){if(!e)throw new Error("change is not provided");if(I(e))return"N".concat(e.oldLineNumber);var t=w(e)?"I":"D";return"".concat(t).concat(e.lineNumber)}var ba=N("old"),ga=A("old"),ya=F("oldStart","oldLines"),ha=P("oldStart","oldLines");function va(e,t,a){var n=function(e,t){if(!e.length)return-1;var a=C(e);if(t<a.oldStart||ya(a,t))return 0;for(var n=1;n<e.length;n++){var i=e[n];if(ya(i,t))return n;var r=e[n-1];if(ha(r,i,t))return n}return-1}(e,t);if(-1===n)return[[t,a]];var i=e[n];if(t<i.oldStart){var r=i.changes.findIndex((function(e){return!I(e)})),s=i.oldStart+Math.max(r,0);return s>=a?[[t,a]]:[[t,s]].concat(d(va(e,s+1,a)))}var o=i.changes,l=function(e,t){var a=e.changes,n=a.findIndex((function(e){return ga(e)===t}));if(n<0)return-1;for(var i=n;i<a.length;i++)if(I(a[i]))return i;return-1}(i,t);if(-1===l)return[];var c=o[l],u=ga(c),p=o.slice(l+1).findIndex((function(e){return!I(e)})),m=ga(c)+Math.max(p,0);return m>=a?[[u,a]]:[[u,m]].concat(d(va(e,m+1,a)))}function Ea(e,t,a,n){return va(e,a,n).reduce((function(e,a){return function(e,t,a){var n=c(a,2),i=n[0],r=n[1],s=("string"==typeof t?t.split("\n"):t).slice(Math.max(i,1)-1,r-1);if(!s.length)return e;var o=ca(s,i,ba(e,i));return o?ma(e,o):e}(e,t,a)}),e)}function xa(e,t){if(!e)return t.oldStart-1;var a=e.oldStart+e.oldLines;return t.oldStart-a}function ja(e,t,a){var n="string"==typeof t?t.split("\n"):t,i=C(e),r=a(i.oldStart-1,1,1)?[[1,i.oldStart]]:[],s=e.reduce((function(e,t,i,r){var s=r[i+1],o=t.oldStart+t.oldLines,l=t.newStart+t.newLines,c=s?xa(t,s):n.length-o+1;return a(c,o,l)&&e.push([o,o+c]),e}),r);return s.reduce((function(e,t){var a=c(t,2),i=a[0],r=a[1];return Ea(e,n,i,r)}),e)}var Sa=A("old"),Oa=A("new"),ka=D("old"),wa=D("new"),Ta=N("new"),Ia=N("old"),Ca=function(){try{var e=pe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ma=function(e,t,a){"__proto__"==t&&Ca?Ca(e,t,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[t]=a},_a=function(e,t){return e&&function(e,t,a){for(var n=-1,i=Object(e),r=a(e),s=r.length;s--;){var o=r[++n];if(!1===t(i[o],o,i))break}return e}(e,t,ot)},Aa=function(e,t){var a={};return t=Gt(t),_a(e,(function(e,n,i){Ma(a,n,t(e,n,i))})),a},Fa=["changeKey","text","tokens","renderToken"],Pa=function e(t,a){var i=t.type,r=t.value,s=t.markType,o=t.properties,l=t.className,c=t.children,u=function(t){return n.jsx("span",{className:t,children:r||c&&c.map(e)},a)};switch(i){case"text":return r;case"mark":return u("diff-code-mark diff-code-mark-".concat(s));case"edit":return u("diff-code-edit");default:var d=o&&o.className;return u(E(l||d))}};function Da(e){if(e.length>1)return!1;var t=c(e,1)[0];return"text"===t.type&&!t.value}var Na=i.memo((function(e){var t=e.changeKey,a=e.text,i=e.tokens,r=e.renderToken,o=l(e,Fa),c=r?function(e,t){return r(e,Pa,t)}:Pa;return n.jsx("td",s(s({},o),{},{"data-change-key":t,children:i?Da(i)?" ":i.map(c):a||" "}))}));function Ra(e,t){return function(){var a="old"===t?Sa(e):Oa(e);return-1===a?void 0:a}}function La(e,t){return function(a){return e&&a?n.jsx("a",{href:t?"#"+t:void 0,children:a}):a}}function Ba(e,t){return t?function(a){e(),t(a)}:e}function za(e,t,a,n){return i.useMemo((function(){var i=Aa(e,(function(e){return function(a){return e&&e(t,a)}}));return i.onMouseEnter=Ba(a,i.onMouseEnter),i.onMouseLeave=Ba(n,i.onMouseLeave),i}),[e,a,n,t])}function qa(e,t,a,i,r,o,l,c,u){var d={change:t,side:i,inHoverState:c,renderDefault:Ra(t,i),wrapInAnchor:La(r,o)};return n.jsx("td",s(s({className:e},l),{},{"data-change-key":a,children:u(d)}))}var $a=i.memo((function(e){var t,a,r,o=e.change,l=e.selected,u=e.tokens,d=e.className,p=e.gutterClassName,m=e.codeClassName,f=e.gutterEvents,b=e.codeEvents,g=e.hideGutter,y=e.gutterAnchor,h=e.generateAnchorID,v=e.renderToken,x=e.renderGutter,j=o.type,S=o.content,O=fa(o),k=(a=(t=c(i.useState(!1),2))[0],r=t[1],[a,i.useCallback((function(){return r(!0)}),[]),i.useCallback((function(){return r(!1)}),[])]),w=c(k,3),T=w[0],I=w[1],C=w[2],M=i.useMemo((function(){return{change:o}}),[o]),_=za(f,M,I,C),A=za(b,M,I,C),F=h(o),P=E("diff-gutter","diff-gutter-".concat(j),p,{"diff-gutter-selected":l}),D=E("diff-code","diff-code-".concat(j),m,{"diff-code-selected":l});return n.jsxs("tr",{id:F,className:E("diff-line",d),children:[!g&&qa(P,o,O,"old",y,F,_,T,x),!g&&qa(P,o,O,"new",y,F,_,T,x),n.jsx(Na,s({className:D,changeKey:O,text:S,tokens:u,renderToken:v},A))]})}));function Va(e){var t=e.hideGutter,a=e.element;return n.jsx("tr",{className:"diff-widget",children:n.jsx("td",{colSpan:t?1:3,className:"diff-widget-content",children:a})})}var Ua=["hideGutter","selectedChanges","tokens","lineClassName"],Ha=["hunk","widgets","className"];function Qa(e){var t=e.hunk,a=e.widgets,i=e.className,r=l(e,Ha),o=function(e,t){return e.reduce((function(e,a){var n=fa(a);e.push(["change",n,a]);var i=t[n];return i&&e.push(["widget",n,i]),e}),[])}(t.changes,a);return n.jsx("tbody",{className:E("diff-hunk",i),children:o.map((function(e){return function(e,t){var a=c(e,3),i=a[0],r=a[1],o=a[2],u=t.hideGutter,d=t.selectedChanges,p=t.tokens,m=t.lineClassName,f=l(t,Ua);if("change"===i){var b=T(o)?"old":"new",g=T(o)?Sa(o):Oa(o),y=p?p[b][g-1]:null;return n.jsx($a,s({className:m,change:o,hideGutter:u,selected:d.includes(r),tokens:y},f),"change".concat(r))}return"widget"===i?n.jsx(Va,{hideGutter:u,element:o},"widget".concat(r)):null}(e,r)}))})}var Ga=0;function Wa(e,t,a,n){var r=i.useCallback((function(){return t(e)}),[e,t]),s=i.useCallback((function(){return t("")}),[t]);return i.useMemo((function(){var t=Aa(n,(function(t){return function(n){return t&&t({side:e,change:a},n)}}));return t.onMouseEnter=Ba(r,t.onMouseEnter),t.onMouseLeave=Ba(s,t.onMouseLeave),t}),[a,n,r,e,s])}function Za(e){var t=e.change,a=e.side,i=e.selected,r=e.tokens,l=e.gutterClassName,c=e.codeClassName,u=e.gutterEvents,d=e.codeEvents,p=e.anchorID,m=e.gutterAnchor,f=e.gutterAnchorTarget,b=e.hideGutter,g=e.hover,y=e.renderToken,h=e.renderGutter;if(!t){var v=E("diff-gutter","diff-gutter-omit",l),x=E("diff-code","diff-code-omit",c);return[!b&&n.jsx("td",{className:v},"gutter"),n.jsx("td",{className:x},"code")]}var j=t.type,S=t.content,O=fa(t),k=a===Ga?"old":"new",w=s({id:p||void 0,className:E("diff-gutter","diff-gutter-".concat(j),o({"diff-gutter-selected":i},"diff-line-hover-"+k,g),l),children:h({change:t,side:k,inHoverState:g,renderDefault:Ra(t,k),wrapInAnchor:La(m,f)})},u),T=E("diff-code","diff-code-".concat(j),o({"diff-code-selected":i},"diff-line-hover-"+k,g),c);return[!b&&n.jsx("td",s(s({},w),{},{"data-change-key":O}),"gutter"),n.jsx(Na,s({className:T,changeKey:O,text:S,tokens:r,renderToken:y},d),"code")]}var Ka=i.memo((function(e){var t=e.className,a=e.oldChange,r=e.newChange,o=e.oldSelected,l=e.newSelected,u=e.oldTokens,d=e.newTokens,p=e.monotonous,m=e.gutterClassName,f=e.codeClassName,b=e.gutterEvents,g=e.codeEvents,y=e.hideGutter,h=e.generateAnchorID,v=e.gutterAnchor,x=e.renderToken,j=e.renderGutter,S=c(i.useState(""),2),O=S[0],k=S[1],w=Wa("old",k,a,b),T=Wa("new",k,r,b),I=Wa("old",k,a,g),C=Wa("new",k,r,g),M=a&&h(a),_=r&&h(r),A={monotonous:p,hideGutter:y,gutterClassName:m,codeClassName:f,gutterEvents:b,codeEvents:g,renderToken:x,renderGutter:j},F=s(s({},A),{},{change:a,side:Ga,selected:o,tokens:u,gutterEvents:w,codeEvents:I,anchorID:M,gutterAnchor:v,gutterAnchorTarget:M,hover:"old"===O}),P=s(s({},A),{},{change:r,side:1,selected:l,tokens:d,gutterEvents:T,codeEvents:C,anchorID:a===r?null:_,gutterAnchor:v,gutterAnchorTarget:a===r?M:_,hover:"new"===O});if(p)return n.jsx("tr",{className:E("diff-line",t),children:Za(a?F:P)});var D=function(e,t){return e&&!t?"diff-line-old-only":!e&&t?"diff-line-new-only":e===t?"diff-line-normal":"diff-line-compare"}(a,r);return n.jsxs("tr",{className:E("diff-line",D,t),children:[Za(F),Za(P)]})}));function Ja(e){var t=e.hideGutter,a=e.oldElement,i=e.newElement;return e.monotonous?n.jsx("tr",{className:"diff-widget",children:n.jsx("td",{colSpan:t?1:2,className:"diff-widget-content",children:a||i})}):a===i?n.jsx("tr",{className:"diff-widget",children:n.jsx("td",{colSpan:t?2:4,className:"diff-widget-content",children:a})}):n.jsxs("tr",{className:"diff-widget",children:[n.jsx("td",{colSpan:t?1:2,className:"diff-widget-content",children:a}),n.jsx("td",{colSpan:t?1:2,className:"diff-widget-content",children:i})]})}var Ya=["selectedChanges","monotonous","hideGutter","tokens","lineClassName"],Xa=["hunk","widgets","className"];function en(e,t){return(e?fa(e):"00")+(t?fa(t):"00")}function tn(e){var t=e.hunk,a=e.widgets,i=e.className,r=l(e,Xa),o=function(e,t){for(var a=function(e){if(!e)return null;var a=fa(e);return t[a]||null},n=[],i=0;i<e.length;i++){var r=e[i];if(I(r))n.push(["change",en(r,r),r,r]);else if(T(r)){var s=e[i+1];s&&w(s)?(i+=1,n.push(["change",en(r,s),r,s])):n.push(["change",en(r,null),r,null])}else n.push(["change",en(null,r),null,r]);var o=n[n.length-1],l=a(o[2]),c=a(o[3]);if(l||c){var u=o[1];n.push(["widget",u,l,c])}}return n}(t.changes,a);return n.jsx("tbody",{className:E("diff-hunk",i),children:o.map((function(e){return function(e,t){var a=c(e,4),i=a[0],r=a[1],o=a[2],u=a[3],d=t.selectedChanges,p=t.monotonous,m=t.hideGutter,f=t.tokens,b=t.lineClassName,g=l(t,Ya);if("change"===i){var y=!!o&&d.includes(fa(o)),h=!!u&&d.includes(fa(u)),v=o&&f?f.old[Sa(o)-1]:null,E=u&&f?f.new[Oa(u)-1]:null;return n.jsx(Ka,s({className:b,oldChange:o,newChange:u,monotonous:p,hideGutter:m,oldSelected:y,newSelected:h,oldTokens:v,newTokens:E},g),"change".concat(r))}return"widget"===i?n.jsx(Ja,{monotonous:p,hideGutter:m,oldElement:o,newElement:u},"widget".concat(r)):null}(e,r)}))})}var an=["gutterType","hunkClassName"];function nn(e){var t=e.hunk,a=O(),i=a.gutterType,r=a.hunkClassName,o=l(a,an),c="none"===i,u="anchor"===i,d="unified"===o.viewType?Qa:tn;return n.jsx(d,s(s({},o),{},{hunk:t,hideGutter:c,gutterAnchor:u,className:r}))}function rn(){}function sn(e,t){var a=t?"auto":"none";e instanceof HTMLElement&&e.style.userSelect!==a&&(e.style.userSelect=a)}function on(e){return e.map((function(e){return n.jsx(nn,{hunk:e},function(e){return"-".concat(e.oldStart,",").concat(e.oldLines," +").concat(e.newStart,",").concat(e.newLines)}(e))}))}var ln=i.memo((function(e){var t=e.diffType,a=e.hunks,r=e.optimizeSelection,s=e.className,o=e.hunkClassName,l=void 0===o?x.hunkClassName:o,c=e.lineClassName,u=void 0===c?x.lineClassName:c,p=e.gutterClassName,m=void 0===p?x.gutterClassName:p,f=e.codeClassName,b=void 0===f?x.codeClassName:f,g=e.gutterType,h=void 0===g?x.gutterType:g,v=e.viewType,j=void 0===v?x.viewType:v,O=e.gutterEvents,k=void 0===O?x.gutterEvents:O,w=e.codeEvents,T=void 0===w?x.codeEvents:w,I=e.generateAnchorID,C=void 0===I?x.generateAnchorID:I,M=e.selectedChanges,_=void 0===M?x.selectedChanges:M,A=e.widgets,F=void 0===A?x.widgets:A,P=e.renderGutter,D=void 0===P?x.renderGutter:P,N=e.tokens,R=e.renderToken,L=e.children,B=void 0===L?on:L,z=i.useRef(null),q=i.useCallback((function(e){var t=e.target;if(0===e.button){var a=function(e,t){for(var a=e;a&&a!==document.documentElement&&!a.classList.contains("diff-code");)a=a.parentElement;return a===document.documentElement?null:a}(t);if(a&&a.parentElement){var n=window.getSelection();n&&n.removeAllRanges();var i=d(a.parentElement.children).indexOf(a);if(1===i||3===i){var r,s=y(z.current?z.current.querySelectorAll(".diff-line"):[]);try{for(s.s();!(r=s.n()).done;){var o=r.value.children;sn(o[1],1===i),sn(o[3],3===i)}}catch(e){s.e(e)}finally{s.f()}}}}}),[]),$="none"===h,V="add"===t||"delete"===t,U="split"===j&&!V&&r?q:rn,H=i.useMemo((function(){return"unified"===j?n.jsxs("colgroup",{children:[!$&&n.jsx("col",{className:"diff-gutter-col"}),!$&&n.jsx("col",{className:"diff-gutter-col"}),n.jsx("col",{})]}):V?n.jsxs("colgroup",{children:[!$&&n.jsx("col",{className:"diff-gutter-col"}),n.jsx("col",{})]}):n.jsxs("colgroup",{children:[!$&&n.jsx("col",{className:"diff-gutter-col"}),n.jsx("col",{}),!$&&n.jsx("col",{className:"diff-gutter-col"}),n.jsx("col",{})]})}),[j,V,$]),Q=i.useMemo((function(){return{hunkClassName:l,lineClassName:u,gutterClassName:m,codeClassName:b,monotonous:V,hideGutter:$,viewType:j,gutterType:h,codeEvents:T,gutterEvents:k,generateAnchorID:C,selectedChanges:_,widgets:F,renderGutter:D,tokens:N,renderToken:R}}),[b,T,C,m,k,h,$,l,u,V,D,R,_,N,j,F]);return n.jsx(S,{value:Q,children:n.jsxs("table",{ref:z,className:E("diff","diff-".concat(j),s),onMouseDown:U,children:[H,B(a)]})})}));function cn(e){var t=e.hideGutter,a=e.monotonous,r=e.className,s=e.gutterClassName,o=e.contentClassName,l=e.children,u=E("diff-decoration",r),d=E("diff-decoration-gutter",s),p=E("diff-decoration-content",o),m=(t?2:4)/(a?2:1),f=m-(t?0:1);if(1===i.Children.count(l))return n.jsx("tbody",{className:u,children:n.jsx("tr",{children:n.jsx("td",{colSpan:m,className:p,children:l})})});var b=c(l,2),g=b[0],y=b[1];return n.jsx("tbody",{className:u,children:n.jsxs("tr",{children:[!t&&n.jsx("td",{className:d,children:g}),n.jsx("td",{colSpan:f,className:p,children:y})]})})}function un(e){var t=e.hideGutter,a=e.className,r=e.gutterClassName,s=e.contentClassName,o=e.children,l=E("diff-decoration",a),u=E("diff-decoration-gutter",r),d=E("diff-decoration-content",s);if(1===i.Children.count(o))return n.jsx("tbody",{className:l,children:n.jsx("tr",{children:n.jsx("td",{colSpan:t?1:3,className:d,children:o})})});var p=c(o,2),m=p[0],f=p[1];return n.jsx("tbody",{className:l,children:n.jsxs("tr",{children:[!t&&n.jsx("td",{colSpan:2,className:u,children:m}),n.jsx("td",{className:d,children:f})]})})}var dn,pn=function(e,t,a,n){for(var i=-1,r=null==e?0:e.length;++i<r;){var s=e[i];t(n,s,a(s),e)}return n},mn=(dn=_a,function(e,t){if(null==e)return e;if(!st(e))return dn(e,t);for(var a=e.length,n=-1,i=Object(e);++n<a&&!1!==t(i[n],n,i););return e}),fn=function(e,t,a,n){return mn(e,(function(e,i,r){t(n,e,a(e),r)})),n},bn=function(e,t){return function(a,n){var i=Pe(a)?pn:fn,r=t?t():{};return i(a,e,Gt(n),r)}},gn=bn((function(e,t,a){Ma(e,a,t)})),yn=Q?Q.isConcatSpreadable:void 0,hn=function(e){return Pe(e)||Ve(e)||!!(yn&&e&&e[yn])},vn=function e(t,a,n,i,r){var s=-1,o=t.length;for(n||(n=hn),r||(r=[]);++s<o;){var l=t[s];a>0&&n(l)?a>1?e(l,a-1,n,i,r):Fe(r,l):i||(r[r.length]=l)}return r},En=function(e,t){var a=-1,n=st(e)?Array(e.length):[];return mn(e,(function(e,i,r){n[++a]=t(e,i,r)})),n},xn=function(e,t){return(Pe(e)?Nt:En)(e,Gt(t))},jn=function(e,t){return vn(xn(e,t),1)};function Sn(e,t){var a=t.newStart,n=t.changes.reduce((function(e,t){var a=c(e,2),n=a[0],i=a[1];return T(t)?(n.splice(i,1),[n,i]):(w(t)&&n.splice(i,0,t.content),[n,i+1])}),[e,a-1]);return c(n,1)[0]}function On(e,t,a){if(!e.length)return[];var n="old"===t?Sa:Oa,i=gn(e,n),r=n(e[e.length-1]);return Array.from({length:r}).map((function(e,t){return a(i[t+1])}))}function kn(e){return{type:"root",children:e}}function wn(e){return e.map((function(e){return s({},e)}))}function Tn(e,t){return[].concat(d(wn(e.slice(0,-1))),[t])}function In(e){var t=e[e.length-1];if("text"===t.type)return t;throw new Error("Invalid token path with leaf of type ".concat(t.type))}var Cn=["children"];function Mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.children){var n=e.children,i=l(e,Cn);a.push(i);var r,s=y(n);try{for(s.s();!(r=s.n()).done;)Mn(r.value,t,a)}catch(e){s.e(e)}finally{s.f()}a.pop()}else t.push(wn([].concat(d(a.slice(1)),[e])));return t}function _n(e){return Mn(e).reduce((function(e,t){var a=e[e.length-1],n=function(e){var t=In(e);return t.value.includes("\n")?t.value.split("\n").map((function(a){return Tn(e,s(s({},t),{},{value:a}))})):[e]}(t),i=u(n),r=i[0],o=i.slice(1);return[].concat(d(e.slice(0,-1)),[[].concat(d(a),[r])],d(o.map((function(e){return[e]}))))}),[[]])}var An=function(e,t,a){var n=(a="function"==typeof a?a:void 0)?a(e,t):void 0;return void 0===n?St(e,t,void 0,a):!!n},Fn=function(e,t){return St(e,t)},Pn=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};function Dn(e){var t,a={type:"root",children:[]},n=y(e);try{var i=function(){var e=t.value;e.reduce((function(t,a,n){return function(e,t){if(!e.children)throw new Error("parent node missing children property");var a,n,i=Pn(e.children);return i&&(n=t,(a=i).type===n.type&&("text"===a.type||a.children&&n.children&&An(a,n,(function(e,t,a){return"chlidren"===a||Fn(e,t)}))))?e.children[e.children.length-1]=function(e,t){return"value"in e&&"value"in t?s(s({},e),{},{value:"".concat(e.value).concat(t.value)}):e}(i,t):e.children.push(t),e.children[e.children.length-1]}(t,n===e.length-1?s({},a):s(s({},a),{},{children:[]}))}),a)};for(n.s();!(t=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}return a}var Nn=Object.prototype.hasOwnProperty,Rn=bn((function(e,t,a){Nn.call(e,a)?e[a].push(t):Ma(e,a,[t])})),Ln=Object.prototype.hasOwnProperty,Bn=function(e){if(null==e)return!0;if(st(e)&&(Pe(e)||"string"==typeof e||"function"==typeof e.splice||He(e)||Xe(e)||Ve(e)))return!e.length;var t=Et(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(at(e))return!rt(e).length;for(var a in e)if(Ln.call(e,a))return!1;return!0},zn=function(e,t){var a=t.start,n=t.length,i=a+n,r=e.reduce((function(e,n){var r=c(e,2),o=r[0],l=r[1],u=l+In(n).value.length;if(l>i||u<a)o.push(n);else{var p=function(e,t,a,n){var i=e.slice(0,-1),r=In(e),o=[];if(a<=0||t>=(null==r?void 0:r.value.length))return[e];var l=function(e,t){var a=r.value.slice(e,t);return[].concat(d(i),[s(s({},r),{},{value:a})])};if(t>0){var c=l(0,t);o.push(wn(c))}var u=l(Math.max(t,0),a);if(o.push(n?function(e,t){return[t].concat(d(wn(e)))}(u,n):wn(u)),a<r.value.length){var p=l(a);o.push(wn(p))}return o}(n,a-l,i-l,t);o.push.apply(o,d(p))}return[o,u]}),[[],0]);return c(r,1)[0]};function qn(e,t){var a=Rn(t,"lineNumber");return e.map((function(e,t){return function(e,t){return Bn(t)?e:t.reduce(zn,e)}(e,a[t+1])}))}function $n(e,t){return function(a){var n=c(a,2),i=n[0],r=n[1];return[qn(i,e),qn(r,t)]}}var Vn=function(e){return null!=e&&e.length?vn(e,1):[]},Un=Math.max,Hn=function(e,t,a){var n=null==e?0:e.length;if(!n)return-1;var i=null==a?0:ta(a);return i<0&&(i=Un(n+i,0)),R(e,Gt(t),i)},Qn=v((function(e){var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,a,n,i){void 0===i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=i;if(null==e||null==a)throw new Error("Null input. (diff_main)");if(e==a)return e?[new t.Diff(0,e)]:[];void 0===n&&(n=!0);var s=n,o=this.diff_commonPrefix(e,a),l=e.substring(0,o);e=e.substring(o),a=a.substring(o),o=this.diff_commonSuffix(e,a);var c=e.substring(e.length-o);e=e.substring(0,e.length-o),a=a.substring(0,a.length-o);var u=this.diff_compute_(e,a,s,r);return l&&u.unshift(new t.Diff(0,l)),c&&u.push(new t.Diff(0,c)),this.diff_cleanupMerge(u),u},t.prototype.diff_compute_=function(e,a,n,i){var r;if(!e)return[new t.Diff(1,a)];if(!a)return[new t.Diff(-1,e)];var s=e.length>a.length?e:a,o=e.length>a.length?a:e,l=s.indexOf(o);if(-1!=l)return r=[new t.Diff(1,s.substring(0,l)),new t.Diff(0,o),new t.Diff(1,s.substring(l+o.length))],e.length>a.length&&(r[0][0]=r[2][0]=-1),r;if(1==o.length)return[new t.Diff(-1,e),new t.Diff(1,a)];var c=this.diff_halfMatch_(e,a);if(c){var u=c[0],d=c[1],p=c[2],m=c[3],f=c[4],b=this.diff_main(u,p,n,i),g=this.diff_main(d,m,n,i);return b.concat([new t.Diff(0,f)],g)}return n&&e.length>100&&a.length>100?this.diff_lineMode_(e,a,i):this.diff_bisect_(e,a,i)},t.prototype.diff_lineMode_=function(e,a,n){var i=this.diff_linesToChars_(e,a);e=i.chars1,a=i.chars2;var r=i.lineArray,s=this.diff_main(e,a,!1,n);this.diff_charsToLines_(s,r),this.diff_cleanupSemantic(s),s.push(new t.Diff(0,""));for(var o=0,l=0,c=0,u="",d="";o<s.length;){switch(s[o][0]){case 1:c++,d+=s[o][1];break;case-1:l++,u+=s[o][1];break;case 0:if(l>=1&&c>=1){s.splice(o-l-c,l+c),o=o-l-c;for(var p=this.diff_main(u,d,!1,n),m=p.length-1;m>=0;m--)s.splice(o,0,p[m]);o+=p.length}c=0,l=0,u="",d=""}o++}return s.pop(),s},t.prototype.diff_bisect_=function(e,a,n){for(var i=e.length,r=a.length,s=Math.ceil((i+r)/2),o=s,l=2*s,c=new Array(l),u=new Array(l),d=0;d<l;d++)c[d]=-1,u[d]=-1;c[o+1]=0,u[o+1]=0;for(var p=i-r,m=p%2!=0,f=0,b=0,g=0,y=0,h=0;h<s&&!((new Date).getTime()>n);h++){for(var v=-h+f;v<=h-b;v+=2){for(var E=o+v,x=(w=v==-h||v!=h&&c[E-1]<c[E+1]?c[E+1]:c[E-1]+1)-v;w<i&&x<r&&e.charAt(w)==a.charAt(x);)w++,x++;if(c[E]=w,w>i)b+=2;else if(x>r)f+=2;else if(m&&(O=o+p-v)>=0&&O<l&&-1!=u[O]&&w>=(S=i-u[O]))return this.diff_bisectSplit_(e,a,w,x,n)}for(var j=-h+g;j<=h-y;j+=2){for(var S,O=o+j,k=(S=j==-h||j!=h&&u[O-1]<u[O+1]?u[O+1]:u[O-1]+1)-j;S<i&&k<r&&e.charAt(i-S-1)==a.charAt(r-k-1);)S++,k++;if(u[O]=S,S>i)y+=2;else if(k>r)g+=2;else if(!m){var w;if((E=o+p-j)>=0&&E<l&&-1!=c[E]&&(x=o+(w=c[E])-E,w>=(S=i-S)))return this.diff_bisectSplit_(e,a,w,x,n)}}}return[new t.Diff(-1,e),new t.Diff(1,a)]},t.prototype.diff_bisectSplit_=function(e,t,a,n,i){var r=e.substring(0,a),s=t.substring(0,n),o=e.substring(a),l=t.substring(n),c=this.diff_main(r,s,!1,i),u=this.diff_main(o,l,!1,i);return c.concat(u)},t.prototype.diff_linesToChars_=function(e,t){var a=[],n={};function i(e){for(var t="",i=0,s=-1,o=a.length;s<e.length-1;){-1==(s=e.indexOf("\n",i))&&(s=e.length-1);var l=e.substring(i,s+1);(n.hasOwnProperty?n.hasOwnProperty(l):void 0!==n[l])?t+=String.fromCharCode(n[l]):(o==r&&(l=e.substring(i),s=e.length),t+=String.fromCharCode(o),n[l]=o,a[o++]=l),i=s+1}return t}a[0]="";var r=4e4,s=i(e);return r=65535,{chars1:s,chars2:i(t),lineArray:a}},t.prototype.diff_charsToLines_=function(e,t){for(var a=0;a<e.length;a++){for(var n=e[a][1],i=[],r=0;r<n.length;r++)i[r]=t[n.charCodeAt(r)];e[a][1]=i.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var a=0,n=Math.min(e.length,t.length),i=n,r=0;a<i;)e.substring(r,i)==t.substring(r,i)?r=a=i:n=i,i=Math.floor((n-a)/2+a);return i},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var a=0,n=Math.min(e.length,t.length),i=n,r=0;a<i;)e.substring(e.length-i,e.length-r)==t.substring(t.length-i,t.length-r)?r=a=i:n=i,i=Math.floor((n-a)/2+a);return i},t.prototype.diff_commonOverlap_=function(e,t){var a=e.length,n=t.length;if(0==a||0==n)return 0;a>n?e=e.substring(a-n):a<n&&(t=t.substring(0,a));var i=Math.min(a,n);if(e==t)return i;for(var r=0,s=1;;){var o=e.substring(i-s),l=t.indexOf(o);if(-1==l)return r;s+=l,0!=l&&e.substring(i-s)!=t.substring(0,s)||(r=s,s++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var a=e.length>t.length?e:t,n=e.length>t.length?t:e;if(a.length<4||2*n.length<a.length)return null;var i=this;function r(e,t,a){for(var n,r,s,o,l=e.substring(a,a+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var d=i.diff_commonPrefix(e.substring(a),t.substring(c)),p=i.diff_commonSuffix(e.substring(0,a),t.substring(0,c));u.length<p+d&&(u=t.substring(c-p,c)+t.substring(c,c+d),n=e.substring(0,a-p),r=e.substring(a+d),s=t.substring(0,c-p),o=t.substring(c+d))}return 2*u.length>=e.length?[n,r,s,o,u]:null}var s,o,l,c,u,d=r(a,n,Math.ceil(a.length/4)),p=r(a,n,Math.ceil(a.length/2));return d||p?(s=p?d&&d[4].length>p[4].length?d:p:d,e.length>t.length?(o=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],o=s[2],l=s[3]),[o,l,c,u,s[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var a=!1,n=[],i=0,r=null,s=0,o=0,l=0,c=0,u=0;s<e.length;)0==e[s][0]?(n[i++]=s,o=c,l=u,c=0,u=0,r=e[s][1]):(1==e[s][0]?c+=e[s][1].length:u+=e[s][1].length,r&&r.length<=Math.max(o,l)&&r.length<=Math.max(c,u)&&(e.splice(n[i-1],0,new t.Diff(-1,r)),e[n[i-1]+1][0]=1,i--,s=--i>0?n[i-1]:-1,o=0,l=0,c=0,u=0,r=null,a=!0)),s++;for(a&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(-1==e[s-1][0]&&1==e[s][0]){var d=e[s-1][1],p=e[s][1],m=this.diff_commonOverlap_(d,p),f=this.diff_commonOverlap_(p,d);m>=f?(m>=d.length/2||m>=p.length/2)&&(e.splice(s,0,new t.Diff(0,p.substring(0,m))),e[s-1][1]=d.substring(0,d.length-m),e[s+1][1]=p.substring(m),s++):(f>=d.length/2||f>=p.length/2)&&(e.splice(s,0,new t.Diff(0,d.substring(0,f))),e[s-1][0]=1,e[s-1][1]=p.substring(0,p.length-f),e[s+1][0]=-1,e[s+1][1]=d.substring(f),s++),s++}s++}},t.prototype.diff_cleanupSemanticLossless=function(e){function a(e,a){if(!e||!a)return 6;var n=e.charAt(e.length-1),i=a.charAt(0),r=n.match(t.nonAlphaNumericRegex_),s=i.match(t.nonAlphaNumericRegex_),o=r&&n.match(t.whitespaceRegex_),l=s&&i.match(t.whitespaceRegex_),c=o&&n.match(t.linebreakRegex_),u=l&&i.match(t.linebreakRegex_),d=c&&e.match(t.blanklineEndRegex_),p=u&&a.match(t.blanklineStartRegex_);return d||p?5:c||u?4:r&&!o&&l?3:o||l?2:r||s?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var i=e[n-1][1],r=e[n][1],s=e[n+1][1],o=this.diff_commonSuffix(i,r);if(o){var l=r.substring(r.length-o);i=i.substring(0,i.length-o),r=l+r.substring(0,r.length-o),s=l+s}for(var c=i,u=r,d=s,p=a(i,r)+a(r,s);r.charAt(0)===s.charAt(0);){i+=r.charAt(0),r=r.substring(1)+s.charAt(0),s=s.substring(1);var m=a(i,r)+a(r,s);m>=p&&(p=m,c=i,u=r,d=s)}e[n-1][1]!=c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=u,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var a=!1,n=[],i=0,r=null,s=0,o=!1,l=!1,c=!1,u=!1;s<e.length;)0==e[s][0]?(e[s][1].length<this.Diff_EditCost&&(c||u)?(n[i++]=s,o=c,l=u,r=e[s][1]):(i=0,r=null),c=u=!1):(-1==e[s][0]?u=!0:c=!0,r&&(o&&l&&c&&u||r.length<this.Diff_EditCost/2&&o+l+c+u==3)&&(e.splice(n[i-1],0,new t.Diff(-1,r)),e[n[i-1]+1][0]=1,i--,r=null,o&&l?(c=u=!0,i=0):(s=--i>0?n[i-1]:-1,c=u=!1),a=!0)),s++;a&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var a,n=0,i=0,r=0,s="",o="";n<e.length;)switch(e[n][0]){case 1:r++,o+=e[n][1],n++;break;case-1:i++,s+=e[n][1],n++;break;case 0:i+r>1?(0!==i&&0!==r&&(0!==(a=this.diff_commonPrefix(o,s))&&(n-i-r>0&&0==e[n-i-r-1][0]?e[n-i-r-1][1]+=o.substring(0,a):(e.splice(0,0,new t.Diff(0,o.substring(0,a))),n++),o=o.substring(a),s=s.substring(a)),0!==(a=this.diff_commonSuffix(o,s))&&(e[n][1]=o.substring(o.length-a)+e[n][1],o=o.substring(0,o.length-a),s=s.substring(0,s.length-a))),n-=i+r,e.splice(n,i+r),s.length&&(e.splice(n,0,new t.Diff(-1,s)),n++),o.length&&(e.splice(n,0,new t.Diff(1,o)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,r=0,i=0,s="",o=""}""===e[e.length-1][1]&&e.pop();var l=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),l=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),l=!0)),n++;l&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var a,n=0,i=0,r=0,s=0;for(a=0;a<e.length&&(1!==e[a][0]&&(n+=e[a][1].length),-1!==e[a][0]&&(i+=e[a][1].length),!(n>t));a++)r=n,s=i;return e.length!=a&&-1===e[a][0]?s:s+(t-r)},t.prototype.diff_prettyHtml=function(e){for(var t=[],a=/&/g,n=/</g,i=/>/g,r=/\n/g,s=0;s<e.length;s++){var o=e[s][0],l=e[s][1].replace(a,"&amp;").replace(n,"&lt;").replace(i,"&gt;").replace(r,"&para;<br>");switch(o){case 1:t[s]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case-1:t[s]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[s]="<span>"+l+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],a=0;a<e.length;a++)1!==e[a][0]&&(t[a]=e[a][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],a=0;a<e.length;a++)-1!==e[a][0]&&(t[a]=e[a][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,a=0,n=0,i=0;i<e.length;i++){var r=e[i][0],s=e[i][1];switch(r){case 1:a+=s.length;break;case-1:n+=s.length;break;case 0:t+=Math.max(a,n),a=0,n=0}}return t+Math.max(a,n)},t.prototype.diff_toDelta=function(e){for(var t=[],a=0;a<e.length;a++)switch(e[a][0]){case 1:t[a]="+"+encodeURI(e[a][1]);break;case-1:t[a]="-"+e[a][1].length;break;case 0:t[a]="="+e[a][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,a){for(var n=[],i=0,r=0,s=a.split(/\t/g),o=0;o<s.length;o++){var l=s[o].substring(1);switch(s[o].charAt(0)){case"+":try{n[i++]=new t.Diff(1,decodeURI(l))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var c=parseInt(l,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+l);var u=e.substring(r,r+=c);"="==s[o].charAt(0)?n[i++]=new t.Diff(0,u):n[i++]=new t.Diff(-1,u);break;default:if(s[o])throw new Error("Invalid diff operation in diff_fromDelta: "+s[o])}}if(r!=e.length)throw new Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return n},t.prototype.match_main=function(e,t,a){if(null==e||null==t||null==a)throw new Error("Null input. (match_main)");return a=Math.max(0,Math.min(a,e.length)),e==t?0:e.length?e.substring(a,a+t.length)==t?a:this.match_bitap_(e,t,a):-1},t.prototype.match_bitap_=function(e,t,a){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var n=this.match_alphabet_(t),i=this;function r(e,n){var r=e/t.length,s=Math.abs(a-n);return i.Match_Distance?r+s/i.Match_Distance:s?1:r}var s=this.Match_Threshold,o=e.indexOf(t,a);-1!=o&&(s=Math.min(r(0,o),s),-1!=(o=e.lastIndexOf(t,a+t.length))&&(s=Math.min(r(0,o),s)));var l,c,u=1<<t.length-1;o=-1;for(var d,p=t.length+e.length,m=0;m<t.length;m++){for(l=0,c=p;l<c;)r(m,a+c)<=s?l=c:p=c,c=Math.floor((p-l)/2+l);p=c;var f=Math.max(1,a-c+1),b=Math.min(a+c,e.length)+t.length,g=Array(b+2);g[b+1]=(1<<m)-1;for(var y=b;y>=f;y--){var h=n[e.charAt(y-1)];if(g[y]=0===m?(g[y+1]<<1|1)&h:(g[y+1]<<1|1)&h|(d[y+1]|d[y])<<1|1|d[y+1],g[y]&u){var v=r(m,y-1);if(v<=s){if(s=v,!((o=y-1)>a))break;f=Math.max(1,2*a-o)}}}if(r(m+1,a)>s)break;d=g}return o},t.prototype.match_alphabet_=function(e){for(var t={},a=0;a<e.length;a++)t[e.charAt(a)]=0;for(a=0;a<e.length;a++)t[e.charAt(a)]|=1<<e.length-a-1;return t},t.prototype.patch_addContext_=function(e,a){if(0!=a.length){if(null===e.start2)throw Error("patch not initialized");for(var n=a.substring(e.start2,e.start2+e.length1),i=0;a.indexOf(n)!=a.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=a.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin;var r=a.substring(e.start2-i,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var s=a.substring(e.start2+e.length1,e.start2+e.length1+i);s&&e.diffs.push(new t.Diff(0,s)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+s.length,e.length2+=r.length+s.length}},t.prototype.patch_make=function(e,a,n){var i,r;if("string"==typeof e&&"string"==typeof a&&void 0===n)i=e,(r=this.diff_main(i,a,!0)).length>2&&(this.diff_cleanupSemantic(r),this.diff_cleanupEfficiency(r));else if(e&&"object"==typeof e&&void 0===a&&void 0===n)r=e,i=this.diff_text1(r);else if("string"==typeof e&&a&&"object"==typeof a&&void 0===n)i=e,r=a;else{if("string"!=typeof e||"string"!=typeof a||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");i=e,r=n}if(0===r.length)return[];for(var s=[],o=new t.patch_obj,l=0,c=0,u=0,d=i,p=i,m=0;m<r.length;m++){var f=r[m][0],b=r[m][1];switch(l||0===f||(o.start1=c,o.start2=u),f){case 1:o.diffs[l++]=r[m],o.length2+=b.length,p=p.substring(0,u)+b+p.substring(u);break;case-1:o.length1+=b.length,o.diffs[l++]=r[m],p=p.substring(0,u)+p.substring(u+b.length);break;case 0:b.length<=2*this.Patch_Margin&&l&&r.length!=m+1?(o.diffs[l++]=r[m],o.length1+=b.length,o.length2+=b.length):b.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(o,d),s.push(o),o=new t.patch_obj,l=0,d=p,c=u)}1!==f&&(c+=b.length),-1!==f&&(u+=b.length)}return l&&(this.patch_addContext_(o,d),s.push(o)),s},t.prototype.patch_deepCopy=function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n],r=new t.patch_obj;r.diffs=[];for(var s=0;s<i.diffs.length;s++)r.diffs[s]=new t.Diff(i.diffs[s][0],i.diffs[s][1]);r.start1=i.start1,r.start2=i.start2,r.length1=i.length1,r.length2=i.length2,a[n]=r}return a},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var a=this.patch_addPadding(e);t=a+t+a,this.patch_splitMax(e);for(var n=0,i=[],r=0;r<e.length;r++){var s,o,l=e[r].start2+n,c=this.diff_text1(e[r].diffs),u=-1;if(c.length>this.Match_MaxBits?-1!=(s=this.match_main(t,c.substring(0,this.Match_MaxBits),l))&&(-1==(u=this.match_main(t,c.substring(c.length-this.Match_MaxBits),l+c.length-this.Match_MaxBits))||s>=u)&&(s=-1):s=this.match_main(t,c,l),-1==s)i[r]=!1,n-=e[r].length2-e[r].length1;else if(i[r]=!0,n=s-l,c==(o=-1==u?t.substring(s,s+c.length):t.substring(s,u+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[r].diffs)+t.substring(s+c.length);else{var d=this.diff_main(c,o,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(d)/c.length>this.Patch_DeleteThreshold)i[r]=!1;else{this.diff_cleanupSemanticLossless(d);for(var p,m=0,f=0;f<e[r].diffs.length;f++){var b=e[r].diffs[f];0!==b[0]&&(p=this.diff_xIndex(d,m)),1===b[0]?t=t.substring(0,s+p)+b[1]+t.substring(s+p):-1===b[0]&&(t=t.substring(0,s+p)+t.substring(s+this.diff_xIndex(d,m+b[1].length))),-1!==b[0]&&(m+=b[1].length)}}}}return[t=t.substring(a.length,t.length-a.length),i]},t.prototype.patch_addPadding=function(e){for(var a=this.Patch_Margin,n="",i=1;i<=a;i++)n+=String.fromCharCode(i);for(i=0;i<e.length;i++)e[i].start1+=a,e[i].start2+=a;var r=e[0],s=r.diffs;if(0==s.length||0!=s[0][0])s.unshift(new t.Diff(0,n)),r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a;else if(a>s[0][1].length){var o=a-s[0][1].length;s[0][1]=n.substring(s[0][1].length)+s[0][1],r.start1-=o,r.start2-=o,r.length1+=o,r.length2+=o}return 0==(s=(r=e[e.length-1]).diffs).length||0!=s[s.length-1][0]?(s.push(new t.Diff(0,n)),r.length1+=a,r.length2+=a):a>s[s.length-1][1].length&&(o=a-s[s.length-1][1].length,s[s.length-1][1]+=n.substring(0,o),r.length1+=o,r.length2+=o),n},t.prototype.patch_splitMax=function(e){for(var a=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=a)){var i=e[n];e.splice(n--,1);for(var r=i.start1,s=i.start2,o="";0!==i.diffs.length;){var l=new t.patch_obj,c=!0;for(l.start1=r-o.length,l.start2=s-o.length,""!==o&&(l.length1=l.length2=o.length,l.diffs.push(new t.Diff(0,o)));0!==i.diffs.length&&l.length1<a-this.Patch_Margin;){var u=i.diffs[0][0],d=i.diffs[0][1];1===u?(l.length2+=d.length,s+=d.length,l.diffs.push(i.diffs.shift()),c=!1):-1===u&&1==l.diffs.length&&0==l.diffs[0][0]&&d.length>2*a?(l.length1+=d.length,r+=d.length,c=!1,l.diffs.push(new t.Diff(u,d)),i.diffs.shift()):(d=d.substring(0,a-l.length1-this.Patch_Margin),l.length1+=d.length,r+=d.length,0===u?(l.length2+=d.length,s+=d.length):c=!1,l.diffs.push(new t.Diff(u,d)),d==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(d.length))}o=(o=this.diff_text2(l.diffs)).substring(o.length-this.Patch_Margin);var p=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==p&&(l.length1+=p.length,l.length2+=p.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=p:l.diffs.push(new t.Diff(0,p))),c||e.splice(++n,0,l)}}},t.prototype.patch_toText=function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a];return t.join("")},t.prototype.patch_fromText=function(e){var a=[];if(!e)return a;for(var n=e.split("\n"),i=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var s=n[i].match(r);if(!s)throw new Error("Invalid patch string: "+n[i]);var o=new t.patch_obj;for(a.push(o),o.start1=parseInt(s[1],10),""===s[2]?(o.start1--,o.length1=1):"0"==s[2]?o.length1=0:(o.start1--,o.length1=parseInt(s[2],10)),o.start2=parseInt(s[3],10),""===s[4]?(o.start2--,o.length2=1):"0"==s[4]?o.length2=0:(o.start2--,o.length2=parseInt(s[4],10)),i++;i<n.length;){var l=n[i].charAt(0);try{var c=decodeURI(n[i].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+c)}if("-"==l)o.diffs.push(new t.Diff(-1,c));else if("+"==l)o.diffs.push(new t.Diff(1,c));else if(" "==l)o.diffs.push(new t.Diff(0,c));else{if("@"==l)break;if(""!==l)throw new Error('Invalid patch mode "'+l+'" in: '+c)}i++}}return a},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[a+1]=e+encodeURI(this.diffs[a][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=-1,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0})),Gn=Qn.DIFF_EQUAL,Wn=Qn.DIFF_DELETE,Zn=Qn.DIFF_INSERT;function Kn(e){var t=Hn(e,(function(e){return!I(e)}));if(-1===t)return[];var a=Hn(e,(function(e){return!!I(e)}),t);return-1===a?[e.slice(t)]:[e.slice(t,a)].concat(d(Kn(e.slice(a))))}function Jn(e){return e.reduce((function(e,t){var a=c(t,2),n=a[0],i=u(a[1].split("\n").map((function(e){return[n,e]}))),r=i[0],s=i.slice(1);return[].concat(d(e.slice(0,-1)),[[].concat(d(e[e.length-1]),[r])],d(s.map((function(e){return[e]}))))}),[[]])}function Yn(e,t){return e.reduce((function(e,a){var n=c(e,2),i=n[0],r=n[1],s=c(a,2),o=s[0],l=s[1];if(o!==Gn){var u={type:"edit",lineNumber:t,start:r,length:l.length};i.push(u)}return[i,r+l.length]}),[[],0])[0]}function Xn(e,t){return jn(e,(function(e,a){return Yn(e,t+a)}))}function ei(e,t){var a=new Qn,n=a.diff_main(e,t);return a.diff_cleanupSemantic(n),n.length<=1?[[],[]]:function(e){return e.reduce((function(e,t){var a=c(e,2),n=a[0],i=a[1];switch(c(t,1)[0]){case Zn:i.push(t);break;case Wn:n.push(t);break;default:n.push(t),i.push(t)}return[n,i]}),[[],[]])}(n)}function ti(e){var t=e.reduce((function(e,t){var a=c(e,2),n=a[0],i=a[1];return T(t)?[n+(n?"\n":"")+t.content,i]:[n,i+(i?"\n":"")+t.content]}),["",""]),a=c(t,2),n=c(ei(a[0],a[1]),2),i=n[0],r=n[1];if(0===i.length&&0===r.length)return[[],[]];var s=function(e){if(e&&!I(e))return e.lineNumber},o=s(e.find(T)),l=s(e.find(w));if(void 0===o||void 0===l)throw new Error("Could not find start line number for edit");return[Xn(Jn(i),o),Xn(Jn(r),l)]}function ai(e){var t=e.reduce((function(e,t){var a=c(e,3),n=a[0],i=a[1],r=a[2];if(!r||!T(r)||!w(t))return[n,i,t];var s=c(ei(r.content,t.content),2),o=s[0],l=s[1];return[n.concat(Yn(o,r.lineNumber)),i.concat(Yn(l,t.lineNumber)),t]}),[[],[],null]),a=c(t,2);return[a[0],a[1]]}var ni=["enhancers"];function ii(e,t,a){return i.useMemo((function(){return a?ja(t,a,(function(t){return t<e})):t}),[e,t,a])}function ri(e,t){switch(t.type){case"push":return[].concat(d(e),[t.value]);case"clear":return e.length?[]:e;case"toggle":return e.includes(t.value)?e.filter((function(e){return e!==t.value})):e.concat(t.value);case"only":return[t.value];default:return e}}function si(){var e=c(i.useReducer(ri,[]),2),t=e[0],a=e[1];return{collection:t,clear:function(){a({type:"clear"})},push:function(e){a({value:e,type:"push"})},toggle:function(e){a({value:e,type:"toggle"})},only:function(e){a({value:e,type:"only"})}}}function oi(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).multiple,a=void 0!==t&&t,n=si(),r=n.collection,s=n.clear,o=n.toggle,l=n.only;return i.useEffect(s,[e]),[r,function(e){var t=e.change;if(t){var n=fa(t);a?o(n):l(n)}}]}function li(e,t){var a=si(),n=a.collection,r=a.clear,s=a.push;i.useEffect(r,[e,t]);var o=i.useMemo((function(){return Array.isArray(t)?t:(t||"").split("\n")}),[t]);return[i.useMemo((function(){return o.length?n.reduce((function(e,t){var a=c(t,2),n=a[0],i=a[1];return Ea(e,o,n,i)}),e):e}),[o,e,n]),function(e,t){return s([e,t])}]}function ci(e,t){if(e===t)return!0;if(!e||!t)return!1;const a=Object.keys(e),n=Object.keys(t),i=a.length;if(n.length!==i)return!1;for(let n=0;n<i;n++){const i=a[n];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}var ui,di=["hunks"],pi=["hunks"],mi=(ui=0,function(){return ui+=1});function fi(e){return jn(e,(function(e){return e.changes.filter((function(e){return!I(e)}))}))}function bi(e,t){if(!t)return!0;var a,n=e.hunks,i=l(e,di),r=t.hunks,s=l(t,pi);return i.oldSource!==s.oldSource||(i.oldSource?!ci(i,s)||(a=r,!function(e,t){if(e===t)return!0;if(!e||!t)return!1;const a=e.length;if(t.length!==a)return!1;for(let n=0;n<a;n++)if(e[n]!==t[n])return!1;return!0}(fi(n),fi(a))):n!==r||!ci(i,s))}function gi(e,t){var a,n,r,s,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).shouldTokenize,l=void 0===o?bi:o,u=(a=t,n=function(e,t){return!l(e,t)},r=i.useRef(void 0),s=i.useRef(0),n(a,r.current)||(r.current=a,s.current=s.current+1),s.current),d=c(i.useState({tokens:null,tokenizationFailReason:null}),2),p=d[0],m=d[1],f=i.useRef(null);return i.useEffect((function(){var t=function(e){var t=e.data,a=t.payload;t.id===f.current&&(a.success?m({tokens:a.tokens,tokenizationFailReason:null}):m({tokens:null,tokenizationFailReason:a.reason}))};return e.addEventListener("message",t),function(){return e.removeEventListener("message",t)}}),[e]),i.useEffect((function(){f.current=mi();var a={payload:t,id:f.current,type:"tokenize"};e.postMessage(a)}),[u,e,l]),p}function yi(e,t){return"".concat(t,"(").concat("string"==typeof(a=e)||null==a?a:a.displayName||a.name||"Component",")");var a}var hi=["mapPayload"];function vi(e){return e}t.Decoration=function(e){var t=e.className,a=void 0===t?"":t,r=e.gutterClassName,s=void 0===r?"":r,o=e.contentClassName,l=void 0===o?"":o,c=e.children,u=O(),d=u.viewType,p=u.gutterType,m=u.monotonous,f="split"===d?cn:un,b=(i.Children.count(c),"none"===p);return n.jsx(f,{hideGutter:b,monotonous:m,className:a,gutterClassName:s,contentClassName:l,children:c})},t.Diff=ln,t.Hunk=nn,t.computeNewLineNumber=Oa,t.computeOldLineNumber=Sa,t.expandCollapsedBlockBy=ja,t.expandFromRawCode=Ea,t.findChangeByNewLineNumber=wa,t.findChangeByOldLineNumber=ka,t.getChangeKey=fa,t.getCollapsedLinesCountBetween=xa,t.getCorrespondingNewLineNumber=Ia,t.getCorrespondingOldLineNumber=Ta,t.insertHunk=ma,t.isDelete=T,t.isInsert=w,t.isNormal=I,t.markEdits=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).type,a="block"===(void 0===t?"block":t)?ti:ai,n=jn(e.map((function(e){return e.changes})),Kn).map(a).reduce((function(e,t){var a=c(e,2),n=a[0],i=a[1],r=c(t,2),s=r[0],o=r[1];return[n.concat(s),i.concat(o)]}),[[],[]]),i=c(n,2),r=i[0],s=i[1];return $n(Vn(r),Vn(s))},t.markWord=function(e,t){var a=function(e,t,a){return function(n){return jn(n,(function(n){var i=In(n);return i.value.includes(e)?i.value.split(e).reduce((function(e,r,o){return 0!==o&&e.push(Tn(n,{type:"mark",markType:t,value:a})),r&&e.push(Tn(n,s(s({},i),{},{value:r}))),e}),[]):[n]}))}}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e);return function(e){var t=c(e,2),n=t[0],i=t[1];return[n.map(a),i.map(a)]}},t.minCollapsedLines=function(e){return function(t){function a(a){var i=ii(e,a.hunks,a.oldSource);return n.jsx(t,s(s({},a),{},{hunks:i}))}return a.displayName=yi(t,"minCollapsedLines"),a}},t.parseDiff=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(e){if(e.startsWith("diff --git"))return e;var t=e.indexOf("\n"),a=e.indexOf("\n",t+1),n=e.slice(0,t),i=e.slice(t+1,a),r=n.split(" ").slice(1,-3).join(" "),s=i.split(" ").slice(1,-3).join(" ");return["diff --git a/".concat(r," b/").concat(s),"index 1111111..2222222 100644","--- a/".concat(r),"+++ b/".concat(s),e.slice(a+1)].join("\n")}(e.trim());return k.parse(a).map((function(e){return function(e,t){var a=e.hunks.map((function(e){return function(e,t){var a="zip"===t.nearbySequences?function(e){var t=e.reduce((function(e,t,a){var n=c(e,3),i=n[0],r=n[1],s=n[2];return r?w(t)&&s>=0?(i.splice(s+1,0,t),[i,t,s+2]):(i.push(t),[i,t,T(t)&&T(r)?s:a]):(i.push(t),[i,t,T(t)?a:-1])}),[[],null,-1]);return c(t,1)[0]}(e.changes):e.changes;return s(s({},e),{},{isPlain:!1,changes:a})}(e,t)}));return s(s({},e),{},{hunks:a})}(e,t)}))},t.pickRanges=$n,t.textLinesToHunk=ca,t.tokenize=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.enhancers,i=void 0===n?[]:n,r=c(function(e,t){if(t.oldSource){var a=function(e,t){return t.reduce(Sn,e.split("\n")).join("\n")}(t.oldSource,e),n=t.highlight?function(e){return t.refractor.highlight(e,t.language)}:function(e){return[{type:"text",value:e}]};return[kn(n(t.oldSource)),kn(n(a))]}var i=c(function(e){var t=function(e){return jn(e,(function(e){return e.changes})).reduce((function(e,t){var a=c(e,2),n=a[0],i=a[1];return I(t)?(n.push(t),i.push(t)):T(t)?n.push(t):i.push(t),[n,i]}),[[],[]])}(e),a=c(t,2),n=a[0],i=a[1],r=function(e){return e?e.content:""};return[On(n,"old",r).join("\n"),On(i,"new",r).join("\n")]}(e),2),r=i[0],s=i[1],o=t.highlight?function(e){return kn(t.refractor.highlight(e,t.language))}:function(e){return kn([{type:"text",value:e}])};return[o(r),o(s)]}(e,l(a,ni)),2),s=r[0],o=r[1],u=[_n(s),_n(o)],d=c((t=[u[0],u[1]],i.reduce((function(e,t){return t(e)}),t)),2),p=d[0],m=d[1],f=[p.map(Dn),m.map(Dn)],b=f[1];return{old:f[0].map((function(e){var t;return null!==(t=e.children)&&void 0!==t?t:[]})),new:b.map((function(e){var t;return null!==(t=e.children)&&void 0!==t?t:[]}))}},t.useChangeSelect=oi,t.useMinCollapsedLines=ii,t.useSourceExpansion=li,t.useTokenizeWorker=gi,t.withChangeSelect=function(e){return function(t){function a(a){var i=c(oi(a.hunks,e),2),r=i[0],o=i[1];return n.jsx(t,s(s({},a),{},{selectedChanges:r,onToggleChangeSelection:o}))}return a.displayName=yi(t,"withChangeSelect"),a}},t.withSourceExpansion=function(){return function(e){function t(t){var a=c(li(t.hunks,t.oldSource),2),i=a[0],r=a[1];return n.jsx(e,s(s({},t),{},{hunks:i,onExpandRange:r}))}return t.displayName=yi(e,"withSourceExpansion"),t}},t.withTokenizeWorker=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.mapPayload,i=void 0===a?vi:a,r=l(t,hi);return function(t){function a(a){var o=function(e){var t=e.hunks,a=e.oldSource,n=e.language;return i({language:n,oldSource:a,hunks:t},e)}(a),l=gi(e,o,r);return n.jsx(t,s(s({},a),l))}return a.displayName=yi(t,"withTokenizeWorker"),a}}}).call(this,a(967))},function(e,t,a){"use strict";var n=a(952);a.d(t,"a",(function(){return n.a}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(48),s=a(18);const o=Object(n.memo)((({children:e})=>{const t=Object(r.useDispatch)();return Object(n.useEffect)((()=>{var e;const a=null===(e=s.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==a?void 0:a.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));o.displayName="CurrentLicense"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(59),c=a.n(l),u=(a(1343),a(47)),d=a(5),p=(a(1348),a(13));const m=e=>{const{className:t,size:a,...n}=e,r={};return(e=>void 0===e.iconType)(e)&&(r.iconType=`logo${e.name.replace(/\s+/g,"")}`),Object(p.jsx)(o.EuiAvatar,i()({className:c()("kbnSolutionAvatar",{[`kbnSolutionAvatar--${a}`]:a},t),size:"xxl"===a?"xl":a,iconSize:a,color:"plain"},n,r))};a(1353);const f=d.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),b=d.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),g=({className:e,isCollapsed:t,...a})=>{const n=c()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":t},e);return Object(p.jsx)(o.EuiButtonIcon,i()({className:n,size:"s",color:"text",iconType:t?"menuRight":"menuLeft","aria-label":t?b:f,title:t?b:f},a))},y=(e,t)=>e.map((e=>(e.tabIndex=t?-1:void 0,e.items=e.items&&y(e.items,t),e))),h=Object(o.htmlIdGenerator)("SolutionNav"),v=({children:e,headingProps:t,icon:a,isOpenOnDesktop:n=!1,items:l,mobileBreakpoints:f=["xs","s"],closeFlyoutButtonPosition:b="outside",name:v,onCollapse:E,canBeCollapsed:x=!0,...j})=>{const S=Object(o.useIsWithinBreakpoints)(f),O=Object(o.useIsWithinBreakpoints)(["m"]),k=Object(o.useIsWithinMinBreakpoint)("l"),[w,T]=Object(r.useState)(!1),I=k&&!n&&x,C=!!e,M=c()("kbnSolutionNav",{"kbnSolutionNav--hidden":I}),_=(null==t?void 0:t.id)||h("heading"),A=(null==t?void 0:t.element)||"h2",F=Object(p.jsx)(o.EuiTitle,{size:"xs",id:_,"data-test-subj":null==t?void 0:t["data-test-subj"],className:"kbnSolutionNav__title"},Object(p.jsx)(A,null,a&&Object(p.jsx)(m,{className:"kbnSolutionNav__titleAvatar",iconType:a,name:v}),Object(p.jsx)("strong",null,Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:v||"Navigation",menuText:S?d.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),P=Object(r.useMemo)((()=>C?e:l?Object(p.jsx)(o.EuiSideNav,i()({"aria-labelledby":_,"aria-hidden":I,items:y(l,I),mobileBreakpoints:[]},j)):null),[e,_,C,I,l,j]);return Object(p.jsx)(s.a.Fragment,null,S&&Object(p.jsx)(o.EuiCollapsibleNavGroup,{className:M,paddingSize:"none",background:"none",title:F,titleElement:"span",isCollapsible:x,initialIsOpen:!1},Object(p.jsx)(o.EuiPanel,{color:"transparent",paddingSize:"s"},P)),O&&Object(p.jsx)(s.a.Fragment,null,(w||!x)&&Object(p.jsx)(o.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:()=>T(!1),side:"left",size:248,closeButtonPosition:b,className:"kbnSolutionNav__flyout",hideCloseButton:!x},Object(p.jsx)("div",{className:M},F,Object(p.jsx)(o.EuiSpacer,{size:"l"}),P)),x&&Object(p.jsx)(g,{isCollapsed:!0,onClick:()=>{T(!w)}})),k&&Object(p.jsx)(s.a.Fragment,null,Object(p.jsx)("div",{className:M},F,Object(p.jsx)(o.EuiSpacer,{size:"l"}),P),x&&Object(p.jsx)(g,{isCollapsed:!n,onClick:E})))};var E=a(179);const x="solutionNavIsCollapsed",j=e=>{const t=t=>{var a;const n=Object(o.useIsWithinBreakpoints)(["m"]),s=Object(o.useIsWithinMinBreakpoint)("l"),[l,u]=Object(r.useState)(!JSON.parse(String(localStorage.getItem(x)))),{solutionNav:d,children:m,...f}=t,{euiTheme:b}=Object(o.useEuiTheme)(),{canBeCollapsed:g=!0}=d,y=n||g&&s&&!l,h=(e=>Object(E.css)("flex:0 1 0;overflow:hidden;",o.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}",""))(b),j=c()("kbnSolutionNav__sidebar",{"kbnSolutionNav__sidebar--shrink":y},null===(a=t.pageSideBarProps)||void 0===a?void 0:a.className,h),S=Object(p.jsx)(v,i()({isOpenOnDesktop:l,onCollapse:()=>{u(!l),localStorage.setItem(x,JSON.stringify(l))}},d)),O={paddingSize:"none",...t.pageSideBarProps,minWidth:y?b.size.xxl:void 0,className:j};return Object(p.jsx)(e,i()({},f,{pageSideBar:S,pageSideBarProps:O}),m)};var a;return t.displayName=`WithSolutionNavBar(${a=e,a.displayName||a.name||"UnnamedComponent"})`,t};a(11);const S=s.a.createContext(null);a(84);const O={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},k=({children:e,navigateToUrl:t,currentAppId:a,...n})=>{const s=Object(r.useRef)(null),o=Object(r.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:n})=>{if(!t||!n)return;const i=((e,t)=>{let a=e;do{var n,i;if("a"===(null===(n=a)||void 0===n?void 0:n.tagName.toLowerCase()))return a;const e=null===(i=a)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const r=i.href,s=""===i.target||"_self"===i.target,o=0===e.button;r&&s&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(i.href))})({event:e,currentAppId:a,navigateToUrl:t,container:s.current})),[a,t]);return Object(p.jsx)("div",i()({onClick:o,ref:s,css:O,"data-test-subj":"kbnRedirectAppLink"},n),e)},w=({children:e,...t})=>Object(p.jsx)(k,i()({},function(){const e=Object(r.useContext)(S);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e);var T=a(1358),I=a.n(T);const C=d.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),M=d.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),_=d.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),A=d.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),F=()=>Object(p.jsx)(o.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:I.a,alt:""}),P=({title:e,description:t,canAccessFleet:a,button:n,...r})=>Object(p.jsx)(o.EuiCard,i()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:a?Object(p.jsx)(o.EuiScreenReaderOnly,null,Object(p.jsx)("span",null,e||_)):Object(p.jsx)(o.EuiTextColor,{color:"default"},C),description:a?t||A:Object(p.jsx)(o.EuiTextColor,{color:"default"},M),footer:(()=>{if(a)return n&&"string"!=typeof n?n:Object(p.jsx)(o.EuiButton,{fill:!0},n||e||_)})(),isDisabled:!a,image:Object(p.jsx)(F,null)},r)),D=s.a.createContext(null),N=({href:e,category:t,description:a,...n})=>{var s;const{canAccessFleet:o,addBasePath:l}=function(){const e=Object(r.useContext)(D);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),c=Object(r.useMemo)((()=>{if(e)return e;const a="/app/integrations/browse";return l(t?`${a}/${t}`:a)}),[l,e,t]);return Object(p.jsx)(w,null,Object(p.jsx)(P,i()({},n,{href:c,canAccessFleet:null!==(s=n.canAccessFleet)&&void 0!==s?s:o,description:a})))},R=({action:e})=>{const t=Object.keys(e);if(1!==t.length)return null;const a=t[0],n="elasticAgent"===a?"empty-page-agent-action":`empty-page-${a}-action`;return Object(p.jsx)(N,i()({key:n},e[a]))},L=({solution:e,logo:t,action:a,docsLink:n,pageTitle:i,pageDescription:r,className:s})=>{const l=i||d.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:e}}),f=n?Object(p.jsx)(o.EuiLink,{href:n,target:"_blank"},Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})):null,b=null!=r?r:f?Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:e,link:f}}):Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.introNoDocLink",defaultMessage:"Add your data to get started."});return Object(p.jsx)(o.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:c()("kbnNoDataPageContents",s),"data-test-subj":"kbnNoDataPage"},Object(p.jsx)(o.EuiText,{textAlign:"center"},Object(p.jsx)(m,{name:e,iconType:t||`logo${e}`,size:"xxl"}),Object(p.jsx)(o.EuiSpacer,{size:"l"}),Object(p.jsx)("h1",null,l),Object(p.jsx)(o.EuiTextColor,{color:"subdued"},Object(p.jsx)("p",null,b))),Object(p.jsx)(o.EuiSpacer,{size:"xxl"}),Object(p.jsx)(R,{action:a}))},B=e=>{const{className:t,noDataConfig:a,pageSideBar:n,pageSideBarProps:r,...s}=e;if(!a)return null;let l;n&&(l=Object(p.jsx)(o.EuiPageTemplate.Sidebar,r,n));const u=((e,t)=>c()("kbnPageTemplate","",t||""))(0,t);return Object(p.jsx)(o.EuiPageTemplate,i()({className:u,restrictWidth:950,panelled:!1,offset:0,minHeight:0},s),l,Object(p.jsx)(L,a))},z=j(B),q=({className:e,pageHeader:t,children:a,isEmptyState:n,pageSideBar:r,pageSideBarProps:s,...l})=>{let u,d;if(n&&t&&!a){const{iconType:e,pageTitle:n,description:i,rightSideItems:r}=t,s=n?Object(p.jsx)("h1",null,n):void 0,l=i?Object(p.jsx)("p",null,i):void 0;a=Object(p.jsx)(o.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:s,body:l,actions:r})}else t&&(u=Object(p.jsx)(o.EuiPageTemplate.Header,t));if(r){const e={...s};e.sticky=!0,d=Object(p.jsx)(o.EuiPageTemplate.Sidebar,e,r)}const m=((e,t)=>c()("kbnPageTemplate","",t||""))(0,e);return Object(p.jsx)(o.EuiPageTemplate,i()({className:m,offset:0,minHeight:u?"calc(100vh - var(--euiFixedHeadersOffset, 0))":0,grow:!u&&void 0},l),d,u,a)},$=j(q),V=Object.assign((({className:e,children:t,solutionNav:a,noDataConfig:n,...r})=>n&&a?Object(p.jsx)(z,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:n,solutionNav:a}):n?Object(p.jsx)(B,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:n}):a?Object(p.jsx)($,i()({className:e,solutionNav:a,children:t},r)):Object(p.jsx)(q,i()({className:e,children:t},r))),{Sidebar:o.EuiPageTemplate.Sidebar,Header:o.EuiPageTemplate.Header,Section:o.EuiPageTemplate.Section,BottomBar:o.EuiPageTemplate.BottomBar,EmptyPrompt:o.EuiPageTemplate.EmptyPrompt})},function(e,t,a){"use strict";a.d(t,"a",(function(){return Ae}));var n=a(23),i=a.n(n),r=a(2),s=a.n(r),o=a(17),l=a(5),c=a(402),u=a(169),d=a(9),p=a(115),m=a(47),f=a(44),b=a.n(f),g=a(880);const y={type:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating system"})},h=Object(r.memo)((({children:e,"data-test-subj":t})=>s.a.createElement(o.EuiTitle,{size:"xxs","data-test-subj":t},s.a.createElement("h5",null,e))));h.displayName="SettingCardHeader";const v=Object(r.memo)((({type:e,supportedOss:t,osRestriction:a,dataTestSubj:n,rightCorner:i,children:l,selected:c=!0,mode:u="edit"})=>{const d=Object(r.useContext)(f.ThemeContext).eui.euiPanelPaddingModifiers.paddingMedium,b=Object(p.a)(n);return s.a.createElement(o.EuiPanel,{"data-test-subj":b(),hasBorder:!0,hasShadow:!1,paddingSize:"none"},s.a.createElement(o.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center",style:{padding:`${d} ${d} 0 ${d}`}},s.a.createElement(o.EuiFlexItem,{grow:1},s.a.createElement(h,null,y.type),s.a.createElement(o.EuiText,{size:"s","data-test-subj":b("type")},e)),s.a.createElement(o.EuiFlexItem,{grow:2},s.a.createElement(h,null,y.os),s.a.createElement(o.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center","data-test-subj":b("osValueContainer")},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiText,{size:"s","data-test-subj":b("osValues")},t.map((e=>g.a[e])).join(", ")," ")),a&&s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":b("osRestriction")},s.a.createElement(o.EuiFlexGroup,{direction:"row",gutterSize:"xs"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiTextColor,{color:"subdued"},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIconTip,{type:"warning",color:"warning",content:a,anchorProps:{"data-test-subj":b("osRestrictionTooltipIcon")}})))))),s.a.createElement(o.EuiShowFor,{sizes:["m","l","xl"]},s.a.createElement(o.EuiFlexItem,{grow:3},s.a.createElement(o.EuiFlexGroup,{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":b("rightCornerContainer")},i)))),s.a.createElement(o.EuiShowFor,{sizes:i?["s","xs"]:[]},s.a.createElement(o.EuiFlexItem,{"data-test-subj":b("rightCornerContainer")},i))),"edit"===u||c?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{padding:`0 ${d} ${d} ${d}`}},l)):s.a.createElement(o.EuiSpacer,{size:"m"}))}));v.displayName="SettingCard";const E=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),x=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Toggle on to register Elastic as an official Antivirus solution for Windows OS. This will also disable Windows Defender."}),j=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),S=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.notRegisteredLabel",{defaultMessage:"Do not register as antivirus"}),O=Object(r.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(p.a)(n),m=!Object(c.a)(),f=e.windows.antivirus_registration.enabled,b="edit"===a,g=f?j:S,y=Object(r.useCallback)((a=>{const n=Object(d.cloneDeep)(e);n.windows.antivirus_registration.enabled=a.target.checked,t({isValid:!0,updatedPolicy:n})}),[t,e]);return m?s.a.createElement(v,{type:E,supportedOss:[u.c.WINDOWS],dataTestSubj:i(),osRestriction:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported because Antivirus registration requires Windows Security Center, which is not included in Windows Server operating systems."})},b&&s.a.createElement(o.EuiText,{size:"s"},x),s.a.createElement(o.EuiSpacer,{size:"s"}),b?s.a.createElement(o.EuiSwitch,{label:g,checked:f,onChange:y,"data-test-subj":i("switch")}):s.a.createElement("div",{"data-test-subj":i("value")},g)):null}));O.displayName="AntivirusRegistrationCard";var k=a(126),w=a(186);const T={[u.c.WINDOWS]:w.e.windows,[u.c.LINUX]:w.e.linux,[u.c.MAC]:w.e.mac},I=Object(r.memo)((({policy:e,onChange:t,mode:a,os:n,options:i,selection:c,supplementalOptions:u,"data-test-subj":m})=>{const b=Object(p.a)(m),g="edit"===a,y=Object(r.useContext)(f.ThemeContext),E=i.length,x=T[n],j=Object(r.useMemo)((()=>{const e=u?u.map((e=>e.protectionField)):[];return Object.entries(c).filter((([t,a])=>!e.includes(t)&&a)).length}),[c,u]);return s.a.createElement(v,{type:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event collection"}),supportedOss:[n],mode:a,selected:j>0,rightCorner:s.a.createElement(o.EuiText,{size:"s",color:"subdued","data-test-subj":b("selectedCount")},l.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:j,total:E}})),dataTestSubj:b()},s.a.createElement(h,null,l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),s.a.createElement(o.EuiSpacer,{size:"s"}),s.a.createElement("div",{"data-test-subj":b("options")},i.map((({name:n,protectionField:i})=>{const r=`${x}.events.${String(i)}`;return s.a.createElement(C,{label:n,key:r,keyPath:r,policy:e,onChange:t,mode:a,"data-test-subj":b(i)})})),0===j&&!g&&s.a.createElement("div",null,Object(k.e)())),u&&u.map((({title:n,description:i,name:r,uncheckedName:l,protectionField:c,tooltipText:u,beta:p,indented:m,isDisabled:f})=>{const v=`${x}.events.${String(c)}`,E=Object(d.get)(e,v),j=c;return g||E?s.a.createElement("div",{key:String(c),style:m?{paddingLeft:y.eui.euiSizeL}:{},"data-test-subj":b(`${j}Container`)},n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(h,{"data-test-subj":b(`${j}Title`)},n)),i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"s"}),s.a.createElement(o.EuiText,{size:"xs",color:"subdued","data-test-subj":b(`${j}Description`)},i)),s.a.createElement(o.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiSpacer,{size:"s"}),s.a.createElement(C,{label:r,unCheckedLabel:l,key:v,keyPath:v,policy:e,onChange:t,mode:a,disabled:!!f&&f(e),"data-test-subj":b(j)})),u&&s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIconTip,{position:"right",content:u,anchorProps:{"data-test-subj":b(`${j}TooltipIcon`)}})),p&&s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiBetaBadge,{label:"beta",size:"s","data-test-subj":b(`${j}Badge`)})))):null})))}));I.displayName="EventCollectionCard";const C=Object(r.memo)((({policy:e,onChange:t,label:a,unCheckedLabel:n,mode:i,keyPath:l,disabled:c,"data-test-subj":u})=>{const p=Object(d.get)(e,l),m="edit"===i,f=p?a:n||a,b=Object(r.useCallback)((a=>{const n=Object(d.cloneDeep)(e);Object(d.set)(n,l,a.target.checked),t({isValid:!0,updatedPolicy:n})}),[l,t,e]);return m?s.a.createElement(o.EuiCheckbox,{key:l,id:l,label:f,"data-test-subj":u,checked:p,onChange:b,disabled:c}):p?s.a.createElement("div",{"data-test-subj":u},f):null}));C.displayName="EventCheckbox";const M=[{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"}],_=[{id:"sessionDataSection",title:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.title",{defaultMessage:"Session data"}),description:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.description",{defaultMessage:"Turn this on to capture the extended process data required for Session View. Session View provides you a visual representation of session and process execution data. Session View data is organized according to the Linux process model to help you investigate process, user, and service activity on your Linux infrastructure."}),name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_dataChecked",{defaultMessage:"Collect session data"}),uncheckedName:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_dataUnChecked",{defaultMessage:"Do not collect session data"}),protectionField:"session_data",isDisabled:e=>!e.linux.events.process},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_ioChecked",{defaultMessage:"Capture terminal output"}),uncheckedName:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_ioUnChecked",{defaultMessage:"Do not capture terminal output"}),protectionField:"tty_io",tooltipText:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io.tooltip",{defaultMessage:"Turn this on to collect terminal (tty) output. Terminal output appears in Session View, and you can view it separately to see what commands were executed and how they were typed, provided the terminal is in echo mode. Only works on hosts that support ebpf."}),indented:!0,isDisabled:e=>!e.linux.events.session_data}],A=Object(r.memo)((e=>{const t=Object(r.useMemo)((()=>"edit"===e.mode?_:_.map((e=>"sessionDataSection"===e.id?{...e,description:void 0}:e))),[e.mode]);return s.a.createElement(I,i()({},e,{os:u.c.LINUX,selection:e.policy.linux.events,supplementalOptions:t,options:M}))}));A.displayName="LinuxEventCollectionCard";const F=[{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}],P=Object(r.memo)((e=>s.a.createElement(I,i()({},e,{os:u.c.MAC,selection:e.policy.mac.events,options:F}))));P.displayName="MacEventCollectionCard";const D=[{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.credentialAccess",{defaultMessage:"API"}),protectionField:"credential_access"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}],N=Object(r.memo)((e=>s.a.createElement(I,i()({},e,{os:u.c.WINDOWS,selection:e.policy.windows.events,options:D}))));N.displayName="WindowsEventCollectionCard";var R=a(18);const L=b.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"sc-sl8jse-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 33.3%;}"]),B=Object(r.memo)((({title:e,"data-test-subj":t})=>{const a=Object(p.a)(t);return s.a.createElement(L,null,s.a.createElement(o.EuiCard,{"data-test-subj":a(),betaBadgeProps:{"data-test-subj":a("badge"),label:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"})},isDisabled:!0,icon:s.a.createElement(o.EuiIcon,{size:"xl",type:"lock"}),title:s.a.createElement("h3",{"data-test-subj":a("title")},s.a.createElement("strong",null,e)),description:!1},s.a.createElement(o.EuiFlexGroup,{className:"lockedCardDescription",direction:"column",gutterSize:"none"},s.a.createElement(o.EuiText,null,s.a.createElement(o.EuiFlexItem,null,s.a.createElement("h4",null,s.a.createElement(o.EuiTextColor,{color:"subdued"},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),s.a.createElement(o.EuiFlexItem,null,s.a.createElement("p",null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.lockedCardUpgradeMessage",defaultMessage:"To turn on this protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:s.a.createElement(o.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank","data-test-subj":a("cloudLink")},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}})))))))}));B.displayName="SettingLockedCard";const z=[u.c.WINDOWS],q=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.attack_surface_reduction",{defaultMessage:"Attack Surface Reduction"}),$=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.attackSurfaceReduction.type",{defaultMessage:"Attack surface reduction"}),V=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.credentialHardening.toggleEnabled",{defaultMessage:"Credential hardening enabled"}),U=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.credentialHardening.toggleDisabled",{defaultMessage:"Credential hardening disabled"}),H=Object(r.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(R.b)().isPlatinumPlus(),l=Object(p.a)(n),u=!Object(c.a)(),m=e.windows.attack_surface_reduction.credential_hardening.enabled,f="edit"===a,b=m?V:U,g=Object(r.useCallback)((a=>{const n=Object(d.cloneDeep)(e);n.windows.attack_surface_reduction.credential_hardening.enabled=a.target.checked,t({isValid:!0,updatedPolicy:n})}),[t,e]);return u?i?s.a.createElement(v,{type:$,supportedOss:z,dataTestSubj:l()},f?s.a.createElement(o.EuiSwitch,{label:b,checked:m,onChange:g,"data-test-subj":l("enableDisableSwitch")}):s.a.createElement("span",{"data-test-subj":l("valueLabel")},b)):s.a.createElement(B,{title:q,"data-test-subj":l("locked")}):null}));H.displayName="AttackSurfaceReductionCard";var Q=a(110);const G=l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.useReputationService",{defaultMessage:"Use reputation service"}),W=l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.doNotUseReputationService",{defaultMessage:"Don't use reputation service"}),Z=s.a.memo((({policy:e,onChange:t,mode:a,protection:n,"data-test-subj":i})=>{var c;const u="edit"===a,{cloud:f}=Object(Q.i)().services,b=null!==(c=null==f?void 0:f.isCloudEnabled)&&void 0!==c&&c,g=Object(p.a)(i),y=e.windows.behavior_protection.mode!==w.f.off,v=e.windows.behavior_protection.reputation_service&&y,E=Object(r.useCallback)((a=>{const n=Object(d.cloneDeep)(e);n.windows.behavior_protection.reputation_service=a.target.checked,n.mac.behavior_protection.reputation_service=a.target.checked,n.linux.behavior_protection.reputation_service=a.target.checked,t({isValid:!0,updatedPolicy:n})}),[e,t]),x=v?G:W;return b?s.a.createElement("div",{"data-test-subj":g()},s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(h,null,s.a.createElement(o.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":g("label")},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("h4",null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.reputationService",defaultMessage:"Reputation service"})))),s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":g("tooltipIcon")},s.a.createElement(o.EuiIconTip,{position:"right","data-test-subj":g("tooltip"),content:s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.reputationServiceTooltip",defaultMessage:"This option enables/disables the Reputation Service feature in Endpoint. When the option is ON, Endpoint will reach out to a Cloud API for additional detection coverage. When it's OFF, Endpoint will not reach out to the Cloud API, resulting in reduced efficacy."})})))),s.a.createElement(o.EuiSpacer,{size:"s"}),u?s.a.createElement(o.EuiCheckbox,{"data-test-subj":g("checkbox"),id:`${n}ReputationServiceCheckbox}`,onChange:E,checked:v,disabled:!y,label:l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.reputationService",{defaultMessage:"Reputation service"})}):s.a.createElement(s.a.Fragment,null,x)):null}));Z.displayName="ReputationService";const K=Object.freeze({malware:"7.11+",ransomware:"7.12+",memory_protection:"7.15+",behavior_protection:"7.15+"}),J=l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",{defaultMessage:"User notification"}),Y=l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.notifyUser",{defaultMessage:"Notify user"}),X=l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.notificationMessage",{defaultMessage:"Notification message"}),ee=l.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",{defaultMessage:"Customize notification message"}),te=s.a.memo((({policy:e,onChange:t,mode:a,protection:n,osList:i,"data-test-subj":c})=>{const u=Object(R.b)().isPlatinumPlus(),f=Object(p.a)(c),b="edit"===a,g=e.windows[n].mode,y=e.windows.popup[n].enabled,v=e.windows.popup[n].message,E=Object(r.useCallback)((a=>{const r=Object(d.cloneDeep)(e);for(const e of i)("windows"===e||"mac"===e||"linux"===e)&&(r[e].popup[n].enabled=a.target.checked);t({isValid:!0,updatedPolicy:r})}),[e,t,i,n]),x=Object(r.useCallback)((a=>{const r=Object(d.cloneDeep)(e);for(const e of i)("windows"===e||"mac"===e||"linux"===e)&&(r[e].popup[n].message=a.target.value);t({isValid:!0,updatedPolicy:r})}),[e,t,i,n]),j=Object(r.useCallback)((e=>"memory_protection"===e?l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.memoryProtectionTooltip",{defaultMessage:"memory threat"}):"behavior_protection"===e?l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.behaviorProtectionTooltip",{defaultMessage:"malicious behavior"}):e),[]),S=Object(r.useCallback)((e=>"memory_protection"===e||"behavior_protection"===n?l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.rule",{defaultMessage:"rule"}):l.i18n.translate("xpack.securitySolution.endpoint.policyDetail.filename",{defaultMessage:"filename"})),[n]);return u?s.a.createElement("div",{"data-test-subj":f()},s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(h,{"data-test-subj":f("title")},J),s.a.createElement(ae,{protection:n,"data-test-subj":f("supportedVersion")}),s.a.createElement(o.EuiSpacer,{size:"s"}),b?s.a.createElement(o.EuiCheckbox,{"data-test-subj":f("checkbox"),id:`${n}UserNotificationCheckbox}`,onChange:E,checked:y,disabled:!b||g===w.f.off,label:Y}):s.a.createElement(s.a.Fragment,null,Y),y&&(b?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiText,{size:"s","data-test-subj":f("customMessageTitle")},s.a.createElement("h4",null,ee))),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIconTip,{position:"right","data-test-subj":f("tooltipInfo"),anchorProps:{"data-test-subj":f("tooltipIcon")},content:s.a.createElement(s.a.Fragment,null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when { protectionName } is prevented or detected.",values:{protectionName:j(n)}}),s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.c",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the { bracketText }.",values:{bracketText:S(n)}}))}))),s.a.createElement(o.EuiSpacer,{size:"xs"}),s.a.createElement(o.EuiTextArea,{placeholder:l.i18n.translate("xpack.securitySolution.endpoint.policyDetails.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:v,onChange:x,fullWidth:!0,disabled:!b,"data-test-subj":f("customMessage")})):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("h4",null,X)),s.a.createElement(o.EuiSpacer,{size:"xs"}),s.a.createElement(s.a.Fragment,null,v||Object(k.e)())))):null}));te.displayName="NotifyUserOption";const ae=s.a.memo((({protection:e,"data-test-subj":t})=>{const a=Object(r.useMemo)((()=>K[e]),[e]);return a?s.a.createElement(o.EuiText,{color:"subdued",size:"xs","data-test-subj":t},s.a.createElement("i",null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:a}}))):null}));ae.displayName="SupportedVersionForProtectionNotice";const ne=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"}),ie=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"}),re=Object(r.memo)((({policy:e,protection:t,osList:a,mode:n,onChange:i,"data-test-subj":l})=>{const c="edit"===n,u=Object(p.a)(l),d=Object(r.useMemo)((()=>[{id:w.f.detect,label:ne,flexGrow:1},{id:w.f.prevent,label:ie,flexGrow:5}]),[]),f=Object(r.useMemo)((()=>{const a=d.find((a=>a.id===e.windows[t].mode));return a?a.label:ie}),[e.windows,t,d]);return s.a.createElement("div",{"data-test-subj":u()},s.a.createElement(h,null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection level"})),s.a.createElement(o.EuiSpacer,{size:"xs"}),s.a.createElement(o.EuiFlexGroup,null,c?d.map((({label:r,id:l,flexGrow:c})=>s.a.createElement(o.EuiFlexItem,{grow:c,key:l},s.a.createElement(se,{policy:e,onChange:i,mode:n,protection:t,protectionMode:l,osList:a,label:r,"data-test-subj":u(`${l}Radio`)})))):s.a.createElement(s.a.Fragment,null,f)))}));re.displayName="DetectPreventProtectionLevel";const se=s.a.memo((({protection:e,protectionMode:t,osList:a,label:n,onChange:i,policy:l,mode:c,"data-test-subj":u})=>{const p=l.windows[e].mode,m=Object(R.b)().isPlatinumPlus(),f="edit"===c,b=Object(r.useMemo)((()=>`${a.join("-")}-${e}-${t}`),[a,e,t]),g=Object(r.useCallback)((()=>{const n=Object(d.cloneDeep)(l);for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=t),m&&("windows"===i||"mac"===i||"linux"===i)&&(t===w.f.prevent?n[i].popup[e].enabled=!0:n[i].popup[e].enabled=!1);i({isValid:!0,updatedPolicy:n})}),[m,i,a,l,e,t]);return s.a.createElement(o.EuiRadio,{label:n,id:b,checked:p===t,onChange:g,disabled:!f||p===w.f.off,"data-test-subj":u})}));se.displayName="ProtectionRadio";const oe=s.a.memo((({protection:e,protectionLabel:t,osList:a,additionalOnSwitchChange:n,onChange:i,policy:c,mode:u,selected:m,"data-test-subj":f})=>{const b=Object(p.a)(f),g=Object(R.b)().isPlatinumPlus(),y="edit"===u,h=Object(r.useMemo)((()=>l.i18n.translate("xpack.securitySolution.endpoint.policy.details.protectionsEnabled",{defaultMessage:"{protectionLabel} {mode, select, true {enabled} false {disabled}}",values:{protectionLabel:t,mode:m}})),[t,m]),v=Object(r.useCallback)((t=>{const r=Object(d.cloneDeep)(c);if(!1===t.target.checked)for(const n of a)("windows"===n||"mac"===n||"linux"===n)&&(r[n][e].mode=w.f.off),g&&(("windows"===n||"mac"===n||"linux"===n)&&(r[n].popup[e].enabled=t.target.checked),"behavior_protection"===e&&(r.windows.behavior_protection.reputation_service=!1,r.mac.behavior_protection.reputation_service=!1,r.linux.behavior_protection.reputation_service=!1));else for(const n of a)("windows"===n||"mac"===n||"linux"===n)&&(r[n][e].mode=w.f.prevent),g&&("behavior_protection"===e&&(r.windows.behavior_protection.reputation_service=!0,r.mac.behavior_protection.reputation_service=!0,r.linux.behavior_protection.reputation_service=!0),("windows"===n||"mac"===n||"linux"===n)&&(r[n].popup[e].enabled=t.target.checked));i({isValid:!0,updatedPolicy:n?n({value:t.target.checked,policyConfigData:r,protectionOsList:a}):r})}),[c,i,n,a,g,e]);return y?s.a.createElement(o.EuiSwitch,{label:h,labelProps:{"data-test-subj":b("label")},checked:m,onChange:v,"data-test-subj":b()}):s.a.createElement("span",{"data-test-subj":b()},h)}));oe.displayName="ProtectionSettingCardSwitch";const le=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior",{defaultMessage:"Malicious Behavior"}),ce=[w.e.windows,w.e.mac,w.e.linux],ue=Object(r.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(R.b)().isPlatinumPlus(),r=Object(p.a)(n),d=!Object(c.a)(),m="behavior_protection",f=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.behavior",{defaultMessage:"Malicious behavior protections"}),b=(e&&e.windows[m].mode)!==w.f.off;return d?i?s.a.createElement(v,{type:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior_protection",{defaultMessage:"Malicious behavior"}),selected:b,mode:a,supportedOss:[u.c.WINDOWS,u.c.MAC,u.c.LINUX],dataTestSubj:r(),rightCorner:s.a.createElement(oe,{selected:b,policy:e,onChange:t,mode:a,protection:m,protectionLabel:f,osList:ce,"data-test-subj":r("enableDisableSwitch")})},s.a.createElement(re,{policy:e,onChange:t,mode:a,protection:m,osList:ce,"data-test-subj":r("protectionLevel")}),s.a.createElement(Z,{policy:e,onChange:t,mode:a,protection:m,"data-test-subj":r("reputationService")}),s.a.createElement(te,{policy:e,onChange:t,mode:a,protection:m,osList:ce,"data-test-subj":r("notifyUser")}),s.a.createElement(o.EuiSpacer,{size:"m"})):s.a.createElement(B,{title:le,"data-test-subj":r("locked")}):null}));ue.displayName="BehaviourProtectionCard";const de=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory",{defaultMessage:"Memory Threat"}),pe=[w.e.windows,w.e.mac,w.e.linux],me=Object(r.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(R.b)().isPlatinumPlus(),r=Object(p.a)(n),d=!Object(c.a)(),m="memory_protection",f=(e&&e.windows[m].mode)!==w.f.off,b=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.memory",{defaultMessage:"Memory threat protections"});return d?i?s.a.createElement(v,{type:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory_protection",{defaultMessage:"Memory threat"}),supportedOss:[u.c.WINDOWS,u.c.MAC,u.c.LINUX],dataTestSubj:r(),selected:f,mode:a,rightCorner:s.a.createElement(oe,{selected:f,policy:e,onChange:t,mode:a,protection:m,protectionLabel:b,osList:pe,"data-test-subj":r("enableDisableSwitch")})},s.a.createElement(re,{policy:e,onChange:t,mode:a,protection:m,osList:pe,"data-test-subj":r("protectionLevel")}),s.a.createElement(te,{policy:e,onChange:t,mode:a,protection:m,osList:pe,"data-test-subj":r("notifyUser")}),s.a.createElement(o.EuiSpacer,{size:"m"})):s.a.createElement(B,{title:de,"data-test-subj":r("locked")}):null}));me.displayName="MemoryProtectionCard";const fe=Object(r.memo)((({"data-test-subj":e})=>{const t=Object(p.a)(e),{docLinks:{links:{securitySolution:a}}}=Object(Q.i)().services;return s.a.createElement(o.EuiCallOut,{iconType:"iInCircle","data-test-subj":t()},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesDocsMessage",defaultMessage:"The Endpoint Security detection rule is enabled automatically with Elastic Defend. This rule must remain enabled to receive Endpoint alerts. {detectionRulesDocsLink}.",values:{detectionRulesDocsLink:s.a.createElement(o.EuiLink,{"data-test-subj":t("link"),target:"_blank",href:`${a.detectionEngineOverview}`},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessageDocsLink",defaultMessage:"Learn More"}))}}))}));fe.displayName="RelatedDetectionRulesCallout";const be=[w.e.windows],ge=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),ye=s.a.memo((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(R.b)().isPlatinumPlus(),r=!Object(c.a)(),d=Object(p.a)(n),m="ransomware",f=(e&&e.windows[m].mode)!==w.f.off,b=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.ransomware",{defaultMessage:"Ransomware protections"});return r?i?s.a.createElement(v,{type:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[u.c.WINDOWS],dataTestSubj:d(),selected:f,mode:a,rightCorner:s.a.createElement(oe,{selected:f,policy:e,onChange:t,mode:a,protection:m,protectionLabel:b,osList:be,"data-test-subj":d("enableDisableSwitch")})},s.a.createElement(re,{protection:m,osList:be,onChange:t,policy:e,mode:a,"data-test-subj":d("protectionLevel")}),s.a.createElement(te,{policy:e,onChange:t,mode:a,protection:m,osList:be,"data-test-subj":d("notifyUser")}),s.a.createElement(o.EuiSpacer,{size:"m"})):s.a.createElement(B,{title:ge,"data-test-subj":d("locked")}):null}));ye.displayName="RansomwareProtectionCard";const he=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.blocklistEnabled",{defaultMessage:"Blocklist enabled"}),ve=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.blocklistDisabled",{defaultMessage:"Blocklist disabled"}),Ee=({value:e,policyConfigData:t,protectionOsList:a})=>{for(const n of a)t[n].malware.blocklist=e;return t},xe=[w.e.windows,w.e.mac,w.e.linux],je=s.a.memo((({policy:e,onChange:t,mode:a="edit","data-test-subj":n})=>{const i=Object(p.a)(n),r=!Object(c.a)(),d="malware",m=(e&&e.windows[d].mode)!==w.f.off,f=l.i18n.translate("xpack.securitySolution.endpoint.policy.protections.malware",{defaultMessage:"Malware protections"});return r?s.a.createElement(v,{type:l.i18n.translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[u.c.WINDOWS,u.c.MAC,u.c.LINUX],dataTestSubj:i(),selected:m,mode:a,rightCorner:s.a.createElement(oe,{selected:m,protection:d,protectionLabel:f,osList:xe,additionalOnSwitchChange:Ee,policy:e,onChange:t,mode:a,"data-test-subj":i("enableDisableSwitch")})},s.a.createElement(re,{policy:e,onChange:t,mode:a,protection:d,osList:xe,"data-test-subj":i("protectionLevel")}),s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(Se,{policy:e,onChange:t,mode:a,"data-test-subj":i("blocklist")}),s.a.createElement(te,{policy:e,onChange:t,mode:a,protection:d,osList:xe,"data-test-subj":i("notifyUser")}),s.a.createElement(o.EuiSpacer,{size:"m"})):null}));je.displayName="MalwareProtectionsCard";const Se=Object(r.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(p.a)(n),l=e.windows.malware.blocklist,c="off"===e.windows.malware.mode,u="edit"===a,f=l?he:ve,b=Object(r.useCallback)((a=>{const n=a.target.checked,i=Object(d.cloneDeep)(e);Ee({value:n,policyConfigData:i,protectionOsList:xe}),t({isValid:!0,updatedPolicy:i})}),[t,e]);return s.a.createElement(o.EuiFlexGroup,{gutterSize:"xs","data-test-subj":i()},s.a.createElement(o.EuiFlexItem,{grow:!1},u?s.a.createElement(o.EuiSwitch,{label:f,checked:l,onChange:b,disabled:c,"data-test-subj":i("enableDisableSwitch")}):s.a.createElement(s.a.Fragment,null,f)),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIconTip,{position:"right",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.blocklistTooltip",defaultMessage:"Enables or disables the blocklist associated with this policy. The blocklist is a collection hashes, paths, or signers which extends the list of processes the endpoint considers malicious. See the blocklist tab for entry details."}))})))}));Se.displayName="EnableDisableBlocklist";const Oe=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.tty_io.max_kilobytes_per_process",first_supported_version:"8.5",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_process",{defaultMessage:"The maximum kilobytes of terminal output to record for a single process. Default: 512"})},{key:"linux.advanced.tty_io.max_kilobytes_per_event",first_supported_version:"8.5",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_event",{defaultMessage:"The maximum kilobytes of terminal output to record in a single event. Default: 512"})},{key:"linux.advanced.capture_env_vars",first_supported_version:"8.6",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.capture_env_vars",{defaultMessage:"The list of environment variables to capture (up to five), separated by commas."})},{key:"linux.advanced.tty_io.max_event_interval_seconds",first_supported_version:"8.5",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_event_interval_seconds",{defaultMessage:"The maximum amount of time (seconds) to batch terminal output in a single event. Default: 30"})},{key:"linux.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"mac.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.kernel.fileaccess",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileaccess",{defaultMessage:"Report limited file access (read) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.registryaccess",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registryaccess",{defaultMessage:"Report limited registry access (queryvalue, savekey) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.process_handle",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process_handle",{defaultMessage:"Capture process and thread handle events. Default: true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})},{key:"windows.advanced.ransomware.canary",first_supported_version:"7.14",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.canary",{defaultMessage:"A value of 'false' disables Ransomware canary protection. Default: true."})},{key:"windows.advanced.memory_protection.shellcode",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode",{defaultMessage:"Enable shellcode injection detection as a part of memory protection. Default: true."})},{key:"windows.advanced.memory_protection.memory_scan",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.malware.quarantine",first_supported_version:"7.14",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.memory_protection.shellcode_collect_sample",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected shellcode regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.shellcode_enhanced_pe_parsing",first_supported_version:"7.15",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.memory_protection.shellcode_enhanced_pe_parsing",{defaultMessage:"Attempt to identify and extract PE metadata from injected shellcode, including Authenticode signatures and version resource information. Default: true."})},{key:"mac.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"mac.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"linux.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"mac.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.events.etw",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.etw",{defaultMessage:"Enable collection of ETW events. Default: true"})},{key:"windows.advanced.diagnostic.rollback_telemetry_enabled",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.rollback_telemetry_enabled",{defaultMessage:"Enable diagnostic rollback telemetry. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_content_filtering",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_content_filtering",{defaultMessage:"Enable or disable the network content filter, this will enable/disable network eventing. Host isolation will fail if this option is disabled. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_packet_filtering",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_packet_filtering",{defaultMessage:"Enable or disable the network packet filter. Host isolation will fail if this option is disabled. Default: true"})},{key:"windows.advanced.memory_protection.shellcode_trampoline_detection",first_supported_version:"8.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_trampoline_detection",{defaultMessage:"Enable trampoline-based shellcode injection detection as a part of memory protection. Default: true"})},{key:"linux.advanced.kernel.capture_mode",first_supported_version:"8.2",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.kernel.capture_mode",{defaultMessage:"Allows users to control whether kprobes or ebpf are used to gather data. Options are kprobe, ebpf, or auto. Auto uses ebpf if possible, otherwise uses kprobe. Default: auto"})},{key:"linux.advanced.event_filter.default",first_supported_version:"8.3",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"mac.advanced.event_filter.default",first_supported_version:"8.3",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.event_filter.default",first_supported_version:"8.3",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 100"})},{key:"linux.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 50"})},{key:"windows.advanced.alerts.rollback.self_healing.enabled",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.enabled",{defaultMessage:"Self-healing erases attack artifacts when prevention alerts are triggered. Warning: data loss can occur. Default: false"}),license:"platinum"},{key:"linux.advanced.fanotify.ignore_unknown_filesystems",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignore_unknown_filesystems",{defaultMessage:'Whether fanotify should ignore unknown filesystems. When true, only CI tested filesystems will be marked by default; additional filesystems can be added or removed with "monitored_filesystems" and "ignored_filesystems", respectively. When false, only an internally curated list of filesystems will be ignored, all others will be marked; additional filesystems can be ignored via "ignored_filesystems". "monitored_filesystems" is ignored when "ignore_unknown_filesystems" is false. Default: true'})},{key:"linux.advanced.fanotify.monitored_filesystems",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.monitored_filesystems",{defaultMessage:'Additional filesystems for fanotify to monitor. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "jfs,ufs,ramfs". It is recommended to avoid network-backed filesystems. When "ignore_unknown_filesystems" is false, this option is ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option are monitored by fanotify unless overridden by entries in "ignored_filesystems" or internally known bad filesystems.'})},{key:"linux.advanced.fanotify.ignored_filesystems",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignored_filesystems",{defaultMessage:'Additional filesystems for fanotify to ignore. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "ext4,tmpfs". When "ignore_unknown_filesystems" is false, parsed entries of this option supplement internally known bad filesystems to be ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option override entries in "monitored_filesystems" and internally CI tested filesystems.'})},{key:"windows.advanced.memory_protection.context_manipulation_detection",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.context_manipulation_detection",{defaultMessage:"Detect injection based on thread context manipulation (e.g. `SetThreadContext`) as a part of memory protection. Default: true"})},{key:"windows.advanced.kernel.image_and_process_file_timestamp",first_supported_version:"8.4",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.image_and_process_file_timestamp",{defaultMessage:"Collect executable/dll timestamps for process and async image load events. Default: true"})},{key:"linux.advanced.host_isolation.allowed",first_supported_version:"8.6.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.host_isolation.allowed",{defaultMessage:"A value of false disallows host isolation activity on Linux endpoints, regardless of whether host isolation is supported. Note that if a host is currently not isolated, it will refuse to isolate, and likewise, a host will refuse to release if it is currently isolated. A value of true will allow Linux endpoints to isolate if supported. Default: true"})},{key:"mac.advanced.capture_env_vars",first_supported_version:"8.7",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.capture_env_vars",{defaultMessage:"The list of environment variables to capture (up to five), separated by commas."})},{key:"linux.advanced.events.disable_fd_kprobes",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.disable_fd_kprobes",{defaultMessage:"When only process events are being collected, this option will disable file descriptor tracking probes. This can be used to reduce Endpoint processing at the expense of missing fchdir based working directory changes. This only applies if the capture_mode is kprobe or if auto resolves tracefs (kprobe) probes. ebpf based event collection ignores this setting. Default is false."})},{key:"windows.advanced.events.callstacks.emit_in_events",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.emit_in_events",{defaultMessage:"If set, callstacks will be included in regular events where they are collected. Otherwise, they are only included in events that trigger behavioral protection rules. Note that setting this may significantly increase data volumes. Default: false"})},{key:"windows.advanced.events.callstacks.process",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.process",{defaultMessage:"Collect callstacks during process events?  Default: true"})},{key:"windows.advanced.events.callstacks.image_load",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.image_load",{defaultMessage:"Collect callstacks during image/library load events?  Default: true"})},{key:"windows.advanced.events.callstacks.file",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.file",{defaultMessage:"Collect callstacks during file events?  Default: true"})},{key:"windows.advanced.events.callstacks.registry",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.registry",{defaultMessage:"Collect callstacks during registry events?  Default: true"})},{key:"windows.advanced.events.callstacks.timeout_microseconds",first_supported_version:"8.12",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.timeout_microseconds",{defaultMessage:"Maximum runtime of inline callstack collection/enrichment.  Default: 100000"})},{key:"windows.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"windows.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"windows.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"windows.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"mac.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"mac.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"mac.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"mac.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"linux.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"linux.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"linux.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"linux.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"windows.advanced.events.api",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api",{defaultMessage:"Controls whether ETW API events are enabled. Set to false to disable ETW event collection. Default: true"})},{key:"windows.advanced.events.api_disabled",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api_disabled",{defaultMessage:"A comma separated list of API names to selectively disable."})},{key:"windows.advanced.events.api_verbose",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api_verbose",{defaultMessage:"Controls whether high volume API events are forwarded. Event filtering is recommended if enabled. Default: false"})},{key:"windows.advanced.alerts.rollback.self_healing.registry_enabled",first_supported_version:"8.8",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.registry_enabled",{defaultMessage:"Enables self-healing of registry based malware artifacts. Requires rollback.self_healing.enabled to also be enabled. Default: true"})},{key:"windows.advanced.events.callstacks.include_network_images",first_supported_version:"8.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.include_network_images",{defaultMessage:"Should executables and DLLs on network shares be parsed for call stack symbols?  This may cause Endpoint to hang on some networks. Default: true"})},{key:"windows.advanced.kernel.ppl.harden_images",first_supported_version:"8.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.ppl.harden_images",{defaultMessage:"Mitigate attacks like PPLFault by preventing Protected Process Light (PPL) processes from loading DLLs over the network. Default: true"})},{key:"windows.advanced.kernel.ppl.harden_am_images",first_supported_version:"8.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.ppl.harden_am_images",{defaultMessage:'Apply the windows.advanced.kernel.ppl.harden_images mitigation to Anti-Malware PPL as well. Disable this if third-party Anti-Malware is blocked from loading DLLs over the network. If this happens, there will be Event ID 8 events in the "Microsoft-Windows-Security-Mitigations/Kernel Mode" event log. Default: true'})},{key:"windows.advanced.malware.networkshare",first_supported_version:"8.9",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.networkshare",{defaultMessage:"Controls whether malware protection is applied to network drives. Default: true"})},{key:"windows.advanced.events.check_debug_registers",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.check_debug_registers",{defaultMessage:"Check debug registers inline to detect the use of hardware breakpoints. Malware may use hardware breakpoints to forge benign-looking call stacks. Default: true"})},{key:"mac.advanced.kernel.fileaccess",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.fileaccess",{defaultMessage:"A value of false overrides other config settings that would enable kernel fileaccess events. Default: true."})},{key:"mac.advanced.events.image_load",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.image_load",{defaultMessage:"A value of false overrides other config settings that would enable kernel image load events. Default: true."})},{key:"mac.advanced.image_load.capture",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.image_load.collect",{defaultMessage:"Collect and send image load events to Elasticsearch. Take caution, this can be a very high data volume. Adding an event filter to drop unwanted events is strongly recommended. Default: false"})},{key:"windows.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"mac.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"linux.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"linux.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"mac.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"windows.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"windows.advanced.utilization_limits.resident_memory_target_mb",first_supported_version:"8.12.0",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.resident_memory_target_mb",{defaultMessage:"How much memory (in MB) should Endpoint aim to keep resident in RAM? This setting affects Private Working Set on Windows. It does not affect the amount of virtual memory that Endpoint requests from the OS (Private Bytes aka Commit Charge). If plenty of unused RAM is available, Windows may give Endpoint more RAM than requested to reduce unnecessary paging and improve performance. If the current Defend configuration requires regularly touching more than the requested amount of memory, then the Private Working Set will be higher than requested here. Default 200. This value cannot be decreased below 50."})},{key:"windows.advanced.events.disable_image_load_suppression_cache",first_supported_version:"8.12.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.disable_image_load_suppression_cache",{defaultMessage:"The image load suppression cache improves system performance by enabling Endpoint to tell its kernel driver about DLLs which are un-interesting and will never be evented upon. This feature improves system reponsiveness and reduces Endpoint CPU usage.  Use this setting only for troubleshooting if image load events are not being generated as expected. Default: false"})},{key:"windows.advanced.events.disable_registry_write_suppression",first_supported_version:"8.12.1",documentation:l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.disable_registry_write_suppression",{defaultMessage:"Registry write suppression improves system performance by enabling Endpoint to tell its driver that certain types of registry operations are uninteresting. Once deemed uninteresting, the driver can quickly drop these events, improving system responsiveness and reducing Endpoint CPU usage. Use this setting only for troubleshooting if registry events are not functioning as expected. Default: false"})}],ke=l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"}),we=l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:"This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values."}),Te=l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.hide",{defaultMessage:"Hide"}),Ie=l.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.show",{defaultMessage:"Show"}),Ce=Object(r.memo)((({policy:e,mode:t,onChange:a,"data-test-subj":n})=>{const i=Object(p.a)(n),[l,c]=Object(r.useState)(!1),u=Object(R.b)().isPlatinumPlus(),f="edit"===t,b=Object(r.useCallback)((()=>{c((e=>!e))}),[]),g=Object(r.useCallback)((t=>{const n=Object(d.cloneDeep)(e);!function(e,t,a){let n=e;for(let e=0;e<a.length-1;e++)n[a[e]]||(n[a[e]]={}),n=n[a[e]];if(n[a[a.length-1]]=t,""===t||void 0===t){n=e;for(let t=a.length;t>=0;t--){const i=a.slice(0,t);for(let e=0;e<i.length-1;e++)n=n[i[e]];if(void 0!==n[i[i.length-1]]&&""!==n[i[i.length-1]]&&0!==Object.keys(n[i[i.length-1]]).length)break;"advanced"===i[i.length-1]?n[i[i.length-1]]=void 0:delete n[i[i.length-1]],n=e}}}(n,t.target.value,t.target.name.split(".")),a({isValid:!0,updatedPolicy:n})}),[a,e]);return s.a.createElement("div",{"data-test-subj":i()},s.a.createElement(o.EuiButtonEmpty,{"data-test-subj":i("showButton"),onClick:b},s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced.showHideButtonLabel",defaultMessage:"{action} advanced settings",values:{action:l?Te:Ie}})),s.a.createElement(o.EuiSpacer,{size:"l"}),l&&s.a.createElement("div",null,f&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiCallOut,{title:ke,color:"warning",iconType:"warning","data-test-subj":i("warning")},s.a.createElement("p",null,we)),s.a.createElement(o.EuiSpacer,null)),s.a.createElement(o.EuiText,{size:"xs",color:"subdued"},s.a.createElement("h4",null,s.a.createElement(m.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),s.a.createElement(o.EuiPanel,{"data-test-subj":i("settings"),paddingSize:"s"},Oe.map((({key:t,documentation:a,first_supported_version:n,last_supported_version:r,license:l},c)=>{if(!u&&"platinum"===l)return s.a.createElement(s.a.Fragment,{key:t});const d=t.split("."),p=function(e,t){let a=e;for(let e=0;e<t.length-1;e++){if(!a[t[e]])return"";a=a[t[e]]}return a[t[t.length-1]]}(e,d);return s.a.createElement(o.EuiFormRow,{key:t,fullWidth:!0,"data-test-subj":i(`${t}-container`),label:s.a.createElement(o.EuiFlexGroup,{responsive:!1},s.a.createElement(o.EuiFlexItem,{grow:!0,"data-test-subj":i(`${t}-label`)},t),a&&s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIconTip,{content:a,position:"right",anchorProps:{"data-test-subj":i(`${t}-tooltipIcon`)}}))),labelAppend:s.a.createElement(o.EuiText,{size:"xs","data-test-subj":i(`${t}-versionInfo`)},r?`${n}-${r}`:`${n}+`)},f?s.a.createElement(o.EuiFieldText,{"data-test-subj":t,fullWidth:!0,name:t,value:p,onChange:g}):s.a.createElement(o.EuiText,{size:"xs","data-test-subj":i(`${t}-viewValue`)},p||Object(k.e)()))})))))}));Ce.displayName="AdvancedSection";const Me=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.protections",{defaultMessage:"Protections"}),_e=l.i18n.translate("xpack.securitySolution.endpoint.policy.details.settings",{defaultMessage:"Settings"}),Ae=Object(r.memo)((e=>{const t=Object(p.a)(e["data-test-subj"]),a=Object(c.a)();return s.a.createElement("div",{"data-test-subj":t()},s.a.createElement(Fe,null,Me),s.a.createElement(o.EuiSpacer,{size:"s"}),a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(a,null),s.a.createElement(o.EuiSpacer,{size:"l"})),!a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(fe,null),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(je,i()({},e,{"data-test-subj":t("malware")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(ye,i()({},e,{"data-test-subj":t("ransomware")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(me,i()({},e,{"data-test-subj":t("memory")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(ue,i()({},e,{"data-test-subj":t("behaviour")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(H,i()({},e,{"data-test-subj":t("attackSurface")})),s.a.createElement(o.EuiSpacer,{size:"l"})),s.a.createElement(Fe,null,_e),s.a.createElement(o.EuiSpacer,{size:"s"}),s.a.createElement(N,i()({},e,{"data-test-subj":t("windowsEvents")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(P,i()({},e,{"data-test-subj":t("macEvents")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(A,i()({},e,{"data-test-subj":t("linuxEvents")})),s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(O,i()({},e,{"data-test-subj":t("antivirusRegistration")})),s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(Ce,i()({},e,{"data-test-subj":t("advancedSection")})))}));Ae.displayName="PolicySettingsForm";const Fe=Object(r.memo)((({children:e})=>s.a.createElement(o.EuiText,{size:"xs",color:"subdued"},s.a.createElement("h4",null,e))));Fe.displayName="FormSectionTitle"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var n=a(2),i=a.n(n),r=a(17),s=a(47),o=a(110),l=a(155),c=a(50),u=a(200),d=a(44),p=a.n(d),m=a(186),f=a(0),b=a.n(f),g=a(5);const y=Object.freeze(new Map([["logging",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.logging",{defaultMessage:"Logging"})],["streaming",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.streaming",{defaultMessage:"Streaming"})],["malware",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.malware",{defaultMessage:"Malware"})],["events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.events",{defaultMessage:"Events"})],["memory_protection",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.memory_protection",{defaultMessage:"Memory Threat"})],["behavior_protection",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.behavior_protection",{defaultMessage:"Malicious Behavior"})]])),h=Object.freeze(new Map([["configure_dns_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_dns_events",{defaultMessage:"Configure DNS Events"})],["configure_elasticsearch_connection",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_elasticsearch_connection",{defaultMessage:"Configure Elasticsearch Connection"})],["configure_file_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_file_events",{defaultMessage:"Configure File Events"})],["configure_imageload_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_imageload_events",{defaultMessage:"Configure Image Load Events"})],["configure_kernel",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_kernel",{defaultMessage:"Configure Kernel"})],["configure_logging",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_logging",{defaultMessage:"Configure Logging"})],["configure_malware",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_malware",{defaultMessage:"Configure Malware"})],["configure_network_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_network_events",{defaultMessage:"Configure Network Events"})],["configure_process_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_process_events",{defaultMessage:"Configure Process Events"})],["configure_registry_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_registry_events",{defaultMessage:"Configure Registry Events"})],["configure_security_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_security_events",{defaultMessage:"Configure Security Events"})],["connect_kernel",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.connect_kernel",{defaultMessage:"Connect Kernel"})],["detect_async_image_load_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_async_image_load_events",{defaultMessage:"Detect Async Image Load Events"})],["detect_file_open_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_open_events",{defaultMessage:"Detect File Open Events"})],["detect_file_write_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_write_events",{defaultMessage:"Detect File Write Events"})],["detect_network_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_network_events",{defaultMessage:"Detect Network Events"})],["detect_process_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_process_events",{defaultMessage:"Detect Process Events"})],["detect_registry_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_registry_events",{defaultMessage:"Detect Registry Events"})],["detect_sync_image_load_events",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_sync_image_load_events",{defaultMessage:"Detect Sync Image Load Events"})],["download_global_artifacts",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_global_artifacts",{defaultMessage:"Download Global Artifacts"})],["download_user_artifacts",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_user_artifacts",{defaultMessage:"Download User Artifacts"})],["load_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_config",{defaultMessage:"Load Config"})],["load_malware_model",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_malware_model",{defaultMessage:"Load Malware Model"})],["read_elasticsearch_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_elasticsearch_config",{defaultMessage:"Read Elasticsearch Config"})],["read_events_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_events_config",{defaultMessage:"Read Events Config"})],["read_kernel_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_kernel_config",{defaultMessage:"Read Kernel Config"})],["read_logging_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_logging_config",{defaultMessage:"Read Logging Config"})],["read_malware_config",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_malware_config",{defaultMessage:"Read Malware Config"})],["workflow",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.workflow",{defaultMessage:"Workflow"})],["full_disk_access",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.full_disk_access",{defaultMessage:"Full Disk Access"})],["macos_system_ext",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.macos_system_ext",{defaultMessage:"Permissions required"})],["linux_deadlock",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.linux_deadlock",{defaultMessage:"Disabled to avoid potential system deadlock"})]])),v=Object.freeze(new Map([[m.b.success,g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.success",{defaultMessage:"Success"})],[m.b.warning,g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.warning",{defaultMessage:"Warning"})],[m.b.failure,g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.failed",{defaultMessage:"Failed"})],[m.b.unsupported,g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.unsupported",{defaultMessage:"Unsupported"})]])),E=Object.freeze(new Map([["full_disk_access",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.full_disk_access",{defaultMessage:"You must enable full disk access for Elastic Endpoint on your machine."})],["macos_system_ext",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.macos_system_ext",{defaultMessage:"You must enable the Mac system extension for Elastic Endpoint on your machine."})],["linux_deadlock",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.linux_deadlock",{defaultMessage:"Malware protection was disabled to avoid a potential system deadlock. To resolve this issue, the file systems causing this need to be identified in integration policy advanced settings (linux.advanced.fanotify.ignored_filesystems). Learn more in our"})]])),x=Object.freeze(new Map([["full_disk_access",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.full_disk_access",{defaultMessage:" Learn more."})],["macos_system_ext",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.macos_system_ext",{defaultMessage:" Learn more."})],["linux_deadlock",g.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.linux_deadlock",{defaultMessage:" troubleshooting docs."})]])),j="Disabled due to potential system deadlock",S=new Set(["load_malware_model","configure_malware"]);function O(e,t){return"macos"===e&&"connect_kernel"===t.name&&t.status===m.b.failure}function k(e,t){return"linux"===e&&S.has(t.name)&&t.message===j}class policy_response_friendly_names_PolicyResponseActionFormatter{constructor(e,t,a=""){var n;b()(this,"key",void 0),b()(this,"title",void 0),b()(this,"description",void 0),b()(this,"hasError",void 0),b()(this,"errorTitle",void 0),b()(this,"errorDescription",void 0),b()(this,"status",void 0),b()(this,"linkText",void 0),this.policyResponseAppliedAction=e,this.docLinks=t,this.os=a,this.key=e.name,this.title=null!==(n=h.get(this.errorKey||this.key))&&void 0!==n?n:this.key.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase())),this.hasError=e.status===m.b.failure||e.status===m.b.warning,this.description=E.get(this.key)||e.message,this.errorDescription=E.get(this.errorKey||this.key)||this.policyResponseAppliedAction.message,this.errorTitle=this.errorDescription?this.title:e.name,this.status=v.get(e.status),this.linkText=x.get(this.errorKey||this.key)}get linkUrl(){return this.docLinks[this.errorKey]}get isGeneric(){return e=this.os,t=this.policyResponseAppliedAction,!!("macos"===e&&"full_disk_access"===t.name||O(this.os,this.policyResponseAppliedAction)||k(this.os,this.policyResponseAppliedAction));var e,t}get errorKey(){return O(this.os,this.policyResponseAppliedAction)?"macos_system_ext":k(this.os,this.policyResponseAppliedAction)?"linux_deadlock":this.policyResponseAppliedAction.name}}const w=p()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallout",componentId:"sc-1hzi5tn-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),T=p()(r.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-1hzi5tn-1"})(["white-space:break-spaces;text-align:left;line-height:inherit;"]),I=Object(n.memo)((({policyResponseActionFormatter:e})=>e.hasError?i.a.createElement(w,{title:e.errorTitle,color:"danger",iconType:"warning","data-test-subj":"endpointPolicyResponseErrorCallOut"},i.a.createElement(T,{size:"s","data-test-subj":"endpointPolicyResponseMessage"},e.errorDescription,e.linkText&&e.linkUrl&&i.a.createElement(r.EuiLink,{target:"_blank",href:e.linkUrl,"data-test-subj":"endpointPolicyResponseErrorCallOutLink"},e.linkText))):i.a.createElement(T,{size:"xs","data-test-subj":"endpointPolicyResponseMessage"},e.description||e.title)));I.displayName="PolicyResponseActionItem";const C=p()(r.EuiTreeView).withConfig({displayName:"StyledEuiTreeView",componentId:"sc-1krv2vw-0"})([".policy-response-action-item-expanded{height:auto;padding-top:",";padding-bottom:",";.euiTreeView__nodeLabel{width:100%;}}.policyResponseStatusHealth{padding-top:5px;}.euiTreeView__node--expanded{max-height:none !important;.policy-response-action-expanded + div{.euiTreeView__node{max-height:none !important;}}}.euiTreeView__node{max-height:none !important;.euiNotificationBadge{margin-right:5px;}.euiTreeView__nodeLabel{.euiText{font-size:",";}}}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiFontSize)),M=Object(n.memo)((({hostOs:e,policyResponseConfig:t,policyResponseActions:a,policyResponseAttentionCount:l})=>{const{docLinks:c}=Object(o.i)().services,u=Object(n.useCallback)(((e,t)=>e===m.b.success?i.a.createElement(r.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):e===m.b.unsupported?i.a.createElement(r.EuiHealth,{color:"subdued","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},t)),[]),d=Object(n.useCallback)((t=>t.map((t=>{const n=a.find((e=>e.name===t)),s=new policy_response_friendly_names_PolicyResponseActionFormatter(n||{},c.links.securitySolution.policyResponseTroubleshooting,e);return{label:i.a.createElement(r.EuiText,{color:n.status!==m.b.success&&n.status!==m.b.unsupported?"danger":"default","data-test-subj":"endpointPolicyResponseAction"},s.title),id:t,className:n.status!==m.b.success&&n.status!==m.b.unsupported?"policy-response-action-expanded":"",icon:u(n.status,n.status!==m.b.success?1:0),children:[{label:i.a.createElement(I,{policyResponseActionFormatter:s}),id:`action_message_${t}`,isExpanded:!0,className:"policy-response-action-item-expanded"}]}}))),[c.links.securitySolution.policyResponseTroubleshooting,u,a,e]),p=Object(n.useCallback)((()=>Object.entries(t).map((([e,t])=>{const a=l.get(e);return{label:i.a.createElement(r.EuiText,{color:a?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseConfig"},(n=e,y.has(n)||y.set(n,n.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase()))),y.get(n))),id:e,icon:a?i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},a):i.a.createElement(r.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}),children:d(t.concerned_actions)};var n}))),[d,l,t]),f=Object(n.useCallback)((()=>{let e=0;for(const t of l.values())e+=t;return[{label:i.a.createElement(r.EuiText,{color:e?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseTitle"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.title",defaultMessage:"Policy Response"})),id:"policyResponse",icon:e?i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusHealth"},e):void 0,children:p()}]}),[p,l])();return i.a.createElement(C,{items:f,showExpansionArrows:!0,"aria-label":"policyResponseTreeView","aria-labelledby":"policyResponseTreeView"})}));M.displayName="PolicyResponse";var _=a(744);const A=Object(n.memo)((({endpointId:e,showRevisionMessage:t=!0,onShowNeedsAttentionBadge:a})=>{var d,p,f;const{data:b,isLoading:g,isFetching:y,isError:h}=function(e,t){const a=Object(o.h)();return Object(c.useQuery)(["getEndpointPolicyResponse",e],(()=>a.get(u.g,{version:"2023-10-31",query:{agentId:e}})),void 0)}(e),{data:v}=Object(_.c)(e),{docLinks:E}=Object(o.i)().services,[x,j]=Object(n.useState)(),[S,O]=Object(n.useState)(),[k,w]=Object(n.useState)(new Map);Object(n.useEffect)((()=>{!b||g||y||h||(j(b.policy_response.Endpoint.policy.applied.response.configurations),O(b.policy_response.Endpoint.policy.applied.actions),w((e=>{var t;const a=new Map;return void 0!==(null==e||null===(t=e.response)||void 0===t?void 0:t.configurations)&&void 0!==(null==e?void 0:e.actions)&&Object.entries(e.response.configurations).map((([t,n])=>{let i=0;for(const t of n.concerned_actions){var r;const a=null===(r=e.actions.find((e=>e.name===t)))||void 0===r?void 0:r.status;a!==m.b.failure&&a!==m.b.warning||(i+=1)}return a.set(t,i)})),a})(b.policy_response.Endpoint.policy.applied)))}),[b,g,y,h]),Object(n.useEffect)((()=>{if(a)for(const e of k.values())if(e)return void a(!0)}),[k,a]);const T=Object(n.useMemo)((()=>x||S?null==S?void 0:S.reduce(((e,t)=>{const a=new policy_response_friendly_names_PolicyResponseActionFormatter(t,E.links.securitySolution.policyResponseTroubleshooting,null==v?void 0:v.metadata.host.os.name.toLowerCase());return a.isGeneric&&a.hasError&&e.push(a),e}),[]):[]),[E.links.securitySolution.policyResponseTroubleshooting,S,x,null==v?void 0:v.metadata.host.os.name]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"xs",color:"subdued","data-test-subj":"endpointPolicyResponseTimestamp"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.appliedOn",defaultMessage:"Revision {rev} applied on {date}",values:{rev:null!==(d=null==b?void 0:b.policy_response.Endpoint.policy.applied.endpoint_policy_version)&&void 0!==d?d:"",date:i.a.createElement(l.d,{value:null!==(p=null==b?void 0:b.policy_response["@timestamp"])&&void 0!==p?p:""})}})),i.a.createElement(r.EuiSpacer,{size:"s"})),h&&i.a.createElement(r.EuiEmptyPrompt,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.noPolicyResponse",defaultMessage:"No policy response available"})}),g&&i.a.createElement(r.EuiLoadingSpinner,{size:"m"}),void 0!==x&&void 0!==S&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{hostOs:null!==(f=null==v?void 0:v.metadata.host.os.name.toLowerCase())&&void 0!==f?f:"",policyResponseConfig:x,policyResponseActions:S,policyResponseAttentionCount:k}),i.a.createElement(r.EuiSpacer,{size:"m"}),null==T?void 0:T.map((e=>i.a.createElement(i.a.Fragment,{key:e.key},i.a.createElement(I,{policyResponseActionFormatter:e}),i.a.createElement(r.EuiSpacer,{size:"m"}))))))}));A.displayName="PolicyResponse"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(2),i=a.n(n),r=a(3),s=a(44),o=a.n(s),l=a(136),c=a.n(l),u=a(17),d=a(19),p=a(79);const m=Object(n.memo)((({indexPattern:e,isLoading:t=!1,isRefreshPaused:a,filterQuery:r,filterManager:s,filters:o,refreshInterval:l,dataTestSubj:c,displayStyle:u})=>{const d=Object(n.useCallback)((e=>{s.setFilters(e)}),[s]),m=Object(n.useMemo)((()=>[e]),[e]);return i.a.createElement(p.SearchBar,{showSubmitButton:!1,filters:o,indexPatterns:m,isLoading:t,isRefreshPaused:a,query:r,onFiltersUpdated:d,refreshInterval:l,showAutoRefreshOnly:!1,showFilterBar:!0,showDatePicker:!1,showQueryInput:!1,showSaveQuery:!1,dataTestSubj:c,displayStyle:u})}));m.displayName="FilterBar";var f=a(117),b=a(475),g=a(9);const y=({ariaLabel:e,errors:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!a)}),[a]),o=Object(n.useCallback)((()=>{r(!1)}),[]);return i.a.createElement(u.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"error",size:"s",color:"danger","aria-label":e,onClick:s},t.length),isOpen:a,closePopover:o,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(u.EuiPopoverTitle,null,b.k),t.map(((e,t)=>i.a.createElement(u.EuiText,{key:t},e)))))};var h=a(110);const v=o()(u.EuiText).withConfig({displayName:"InlineText",componentId:"sc-yylwe5-0"})(["display:inline-block;"]),E=()=>{const e=Object(h.i)().services.docLinks.links.query.eql;return i.a.createElement(u.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(v,{size:"xs"},b.i))},x=o()(u.EuiFlexGroup).withConfig({displayName:"Container",componentId:"sc-x7d5ta-0"})(["border-radius:0;border-bottom-left-radius:6px;border-bottom-right-radius:6px;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),j=o()(u.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-x7d5ta-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),S=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-x7d5ta-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),O=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-x7d5ta-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),k=o()(u.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-x7d5ta-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),w={asPlainText:!0},T=({errors:e,isLoading:t,isSizeOptionDisabled:a,optionsData:r,optionsSelected:s,onOptionsChange:o})=>{var l;const[c,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(null!==(l=null==s?void 0:s.size)&&void 0!==l?l:100),f=Object(n.useRef)(),h=Object(n.useCallback)((()=>{d(!0)}),[]),v=Object(n.useCallback)((()=>{d(!1)}),[]),T=Object(n.useCallback)((e=>{o&&(e.length>0?o("eventCategoryField",e[0].label):o("eventCategoryField",void 0))}),[o]),I=Object(n.useCallback)((e=>{o&&(e.length>0?o("tiebreakerField",e[0].label):o("tiebreakerField",void 0))}),[o]),C=Object(n.useCallback)((e=>{o&&(e.length>0?o("timestampField",e[0].label):o("timestampField",void 0))}),[o]),M=Object(n.useCallback)((e=>{var t,a,n,i;o&&(m(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(a=f.current)&&void 0!==a&&a.cancel&&(null===(i=f.current)||void 0===i||i.cancel()),f.current=Object(g.debounce)((e=>o("size",e)),800),f.current(null==e||null===(n=e.target)||void 0===n?void 0:n.value))}),[o]),_=Object(n.useMemo)((()=>null!=(null==s?void 0:s.eventCategoryField)?[{label:null==s?void 0:s.eventCategoryField}]:void 0),[null==s?void 0:s.eventCategoryField]),A=Object(n.useMemo)((()=>null!=(null==s?void 0:s.tiebreakerField)?[{label:null==s?void 0:s.tiebreakerField}]:void 0),[null==s?void 0:s.tiebreakerField]),F=Object(n.useMemo)((()=>null!=(null==s?void 0:s.timestampField)?[{label:null==s?void 0:s.timestampField}]:void 0),[null==s?void 0:s.timestampField]);return i.a.createElement(x,null,i.a.createElement(j,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiFlexGroup,null,i.a.createElement(u.EuiFlexItem,{grow:!1},e.length>0&&i.a.createElement(y,{ariaLabel:b.l,errors:e}),t&&i.a.createElement(k,{"data-test-subj":"eql-validation-loading",size:"m"})))),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},!o&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(E,null)),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(O,{grow:!1},i.a.createElement(E,null)),i.a.createElement(S,{grow:!1},i.a.createElement(u.EuiPopover,{button:i.a.createElement(u.EuiButtonIcon,{onClick:h,iconType:"controlsVertical",isDisabled:c,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:c,closePopover:v,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(u.EuiPopoverTitle,null,b.j),i.a.createElement("div",{style:{width:"300px"}},!a&&i.a.createElement(u.EuiFormRow,{"data-test-subj":"eql-size-field",label:b.h,helpText:b.g},i.a.createElement(u.EuiFieldNumber,{value:p,onChange:M,min:1,max:1e4})),i.a.createElement(u.EuiFormRow,{"data-test-subj":"eql-event-category-field",label:b.b,helpText:b.a},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.keywordFields,selectedOptions:_,singleSelection:w,onChange:T})),i.a.createElement(u.EuiFormRow,{"data-test-subj":"eql-tiebreaker-field",label:b.d,helpText:b.c},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.nonDateFields,selectedOptions:A,singleSelection:w,onChange:I})),i.a.createElement(u.EuiFormRow,{"data-test-subj":"eql-timestamp-field",label:b.f,helpText:b.e},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.dateFields,selectedOptions:F,singleSelection:w,onChange:C}))))))))))};var I=a(893);const C=o()(u.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-u3oqty-0"})(["display:block;border:0;box-shadow:none;border-radius:0px;min-height:",";&:focus{box-shadow:none;}"],(({theme:e})=>e.eui.euiFormControlHeight)),M=o()(u.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-u3oqty-1"})(["border:",";border-radius:",";.euiFormRow__labelWrapper{background:",";border-top-left-radius:",";border-top-right-radius:",";padding:8px 10px;margin-bottom:0px;label{color:",";&.euiFormLabel-isInvalid{color:",";}}}"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiTextSubduedColor),(({theme:e})=>e.eui.euiColorDangerText)),_=({dataTestSubj:e,field:t,isLoading:a=!1,indexPattern:s,showFilterBar:o,idAria:l,optionsData:p,optionsSelected:g,isSizeOptionDisabled:y,onOptionsChange:v,onValidityChange:E,onValiditingChange:x})=>{const{addError:j}=Object(f.a)(),[S,O]=Object(n.useState)([]),{isValidating:k,value:w,setValue:_}=t,{isValid:A,message:F,messages:P,error:D}=Object(I.c)(t),{uiSettings:N}=Object(h.i)().services,R=Object(n.useRef)(new d.FilterManager(N));Object(n.useEffect)((()=>{null!=E&&E(A)}),[A,E]),Object(n.useEffect)((()=>{O(null!=P?P:[])}),[P]),Object(n.useEffect)((()=>{D&&j(D,{title:b.m})}),[D,j]),Object(n.useEffect)((()=>{x&&x(k)}),[k,x]),Object(n.useEffect)((()=>{let e=!0;const t=new r.Subscription;return R.current.setFilters([]),t.add(R.current.getUpdates$().subscribe({next:()=>{if(e){const e=R.current.getFilters(),{filters:t}=w;c()(t,e)||_({...w,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[w,R,_]),Object(n.useEffect)((()=>{const{filters:e}=w;c()(e,R.current.getFilters())||R.current.setFilters(e)}),[w,R]);const L=Object(n.useCallback)((e=>{const t=e.target.value;x&&x(!0),O([]),_({filters:w.filters,query:{query:t,language:"eql"},saved_id:null})}),[w,_,x]);return i.a.createElement(M,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:F,isInvalid:!A&&!k,fullWidth:!0,"data-test-subj":e,describedByIds:l?[l]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!A&&!k,value:w.query.query,onChange:L}),i.a.createElement(T,{errors:S,isLoading:k,isSizeOptionDisabled:y,optionsData:p,optionsSelected:g,onOptionsChange:v}),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(m,{"data-test-subj":"eqlFilterBar",indexPattern:s,isLoading:a,isRefreshPaused:!1,filterQuery:w.query,filterManager:R.current,filters:R.current.getFilters()||[],displayStyle:"inPage"}))))}},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(80),i=a(1275),r=a(178),s=a(436),o=a(200),l=a(894);const c=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,sortDirection:o.h,sortField:o.i,loading:!1,error:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(l.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:r.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,isolationRequestState:Object(l.e)(),endpointPendingActions:Object(l.c)(new Map),metadataTransformStats:Object(l.e)()}),u=n.combineReducers,d=(r.w,Object(i.a)(),r.u,c(),u({[r.w]:i.c,[r.u]:(e=c(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:a,total:n,page:i,pageSize:r,sortDirection:s,sortField:o}=t.payload;return{...e,hosts:a,total:n,pageIndex:i,pageSize:r,sortField:o,sortDirection:s,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(s.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var a,n;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(a=t.payload.isAutoRefreshEnabled)&&void 0!==a?a:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(n=t.payload.autoRefreshInterval)&&void 0!==n?n:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const a={...e,location:t.payload},n=Object(s.isOnEndpointPage)(a)&&!Object(s.hasSelectedEndpoint)(a),i=Object(s.isOnEndpointPage)(e)&&!Object(s.hasSelectedEndpoint)(e),r=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a),o=Object(s.isOnEndpointPage)(e)&&Object(s.hasSelectedEndpoint)(e),c={location:t.payload,error:void 0};if("isolate"===Object(s.uiQueryParams)(a).show||Object(l.i)(Object(s.getCurrentIsolationRequestState)(a))||(c.isolationRequestState=Object(l.e)()),n){if(!i)return{...e,...c,loading:!0,policyItemsLoading:!0}}else if(r)return o||i?{...e,...c,detailsLoading:!0}:{...e,...c,loading:!0,policyItemsLoading:!0};return{...e,...c,endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(124),i=a(2),r=a.n(i),s=a(44),o=a.n(s),l=a(130),c=a(159),u=a(1268),d=a(17),p=a(15),m=a(5),f=a(4);const b=new p.Storage(localStorage),g=o.a.div.withConfig({displayName:"ContainerEuiSelectable",componentId:"sc-134jgj0-0"})(["width:300px;.euiSelectableListItem__text{white-space:pre-wrap !important;line-height:normal;}"]),y=m.i18n.translate("xpack.securitySolution.selector.summaryView.gridView.label",{defaultMessage:"Grid view"}),h=m.i18n.translate("xpack.securitySolution.selector.summaryView.eventRendererView.label",{defaultMessage:"Event rendered view"}),v=({viewSelected:e,onViewChange:t})=>{const[a,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>n((e=>!e))),[]),o=Object(i.useCallback)((()=>n(!1)),[]),l=Object(i.useCallback)((e=>{var a,i;const r=e.filter((e=>"on"===e.checked));var s,o;b.set(f.f,null!==(a=null===(i=r[0])||void 0===i?void 0:i.key)&&void 0!==a?a:"gridView"),r.length>0&&t(null!==(s=null===(o=r[0])||void 0===o?void 0:o.key)&&void 0!==s?s:"gridView"),n(!1)}),[t]),c=Object(i.useMemo)((()=>r.a.createElement(d.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",iconSize:"s",onClick:s,size:"xs",flush:"both",style:{fontWeight:"normal"}},"gridView"===e?y:h)),[s,e]),u=Object(i.useMemo)((()=>[{label:y,"data-test-subj":"gridView",key:"gridView",checked:"gridView"===e?"on":void 0,meta:[{text:m.i18n.translate("xpack.securitySolution.selector.summaryView.options.default.description",{defaultMessage:"View as tabular data with the ability to group and sort by specific fields"})}]},{label:h,"data-test-subj":"eventRenderedView",key:"eventRenderedView",checked:"eventRenderedView"===e?"on":void 0,meta:[{text:m.i18n.translate("xpack.securitySolution.selector.summaryView.options.summaryView.description",{defaultMessage:"View a rendering of the event flow for each alert"})}]}]),[e]),p=Object(i.useCallback)((e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiTitle,{size:"xxs"},r.a.createElement("h6",null,e.label)),r.a.createElement(d.EuiTextColor,{color:"subdued"},r.a.createElement("small",null,e.meta[0].text)))),[]),v=Object(i.useMemo)((()=>({rowHeight:80,showIcons:!0})),[]);return r.a.createElement(d.EuiPopover,{panelPaddingSize:"none",button:c,isOpen:a,closePopover:o},r.a.createElement(g,null,r.a.createElement(d.EuiSelectable,{options:u,onChange:l,renderOption:p,searchable:!1,height:160,listProps:v,singleSelection:!0},(e=>e))))},E=r.a.memo(v),x=o.a.span.withConfig({displayName:"TitleText",componentId:"sc-fudkl1-0"})(["margin-right:12px;"]),j=({tableView:e,loading:t,tableId:a,title:s,onViewChange:o,additionalFilters:d,hasRightOffset:p,showInspect:m=!0,position:f="absolute",additionalMenuOptions:b=[]})=>{const g="gridView"===e?"baseline":"center",y=Object(i.useMemo)((()=>r.a.createElement(x,{"data-test-subj":"title"},s)),[s]),h=Object(l.a)("tGridEventRenderedViewEnabled"),v=Object(i.useMemo)((()=>b.length?b.map(((e,a)=>r.a.createElement(u.h,{grow:!1,$show:!t,key:a},e))):null),[b,t]);return r.a.createElement(u.g,{alignItems:g,"data-test-subj":"events-viewer-updated",gutterSize:"m",component:"span",justifyContent:"flexEnd",direction:"row",$hasRightOffset:p,position:f},m?r.a.createElement(u.h,{grow:!1,$show:!t},r.a.createElement(c.b,{title:y,queryId:a})):null,r.a.createElement(u.h,{grow:!1,$show:!t},d),h&&[n.e.alertsOnRuleDetailsPage,n.e.alertsOnAlertsPage].includes(a)&&r.a.createElement(u.h,{grow:!1,$show:!t,"data-test-subj":"summary-view-selector"},r.a.createElement(E,{viewSelected:e,onViewChange:o})),v)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(128),i=a(178),r=a(1275),s=a(3),o=a(539),l=a.n(o),c=a(200),u=a(621),d=a(1330),p=a(1293),m=a(894),f=a(924),b=a(436);const g=console.error,y=(e,t)=>{async function a(e){var a;const n=null!==(a=Object(b.endpointPackageVersion)(e))&&void 0!==a?a:"",i=n.includes("-")?n.substring(0,n.indexOf("-")):n,r=l()(i,"1.2.0")?c.v:c.C,o=t.data.search.search({indices:[r],onlyCheckIfIndicesExist:!1},{strategy:c.k});return[{title:r,fields:(await Object(s.firstValueFrom)(o)).indexFields}]}return t=>n=>async i=>{n(i);const{getState:r,dispatch:s}=t;return await async function(e,t,a){if(Object(b.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(m.d)(Object(m.a)(Object(b.endpointPackageInfo)(e)))});try{const e=await Object(f.c)(a.http);t({type:"endpointPackageInfoStateChanged",payload:Object(m.c)(e)})}catch(e){g(e),t({type:"endpointPackageInfoStateChanged",payload:Object(m.b)(e)})}}}(r(),s,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(b.isOnEndpointPage)(r())||await async function({store:e,coreStart:t,fetchIndexPatterns:a}){const{getState:n,dispatch:i}=e,{page_index:r,page_size:s,sort_field:o,sort_direction:l}=Object(b.uiQueryParams)(n());let u;try{const a=Object(b.searchBarQuery)(n());u=await t.http.get(c.r,{version:"2023-10-31",query:{page:r,pageSize:s,kuery:a.query,sortField:o,sortDirection:l}}),i({type:"serverReturnedEndpointList",payload:u}),x(e),async function({store:e,hosts:t,http:a}){const{getState:n,dispatch:i}=e;try{const e=await h(a,t,Object(b.nonExistingPolicies)(n()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){g(e)}}({http:t.http,hosts:u.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(b.patterns)(n()).length)try{const e=await a(n());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(u&&0===u.data.length){const e=t.http;if(await v(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(p.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var d;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(d=e.body)&&void 0!==d?d:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:a}),"endpointIsolationRequest"===i.type?E(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:a,dispatch:n}=t;if(!e||!a||!n)return;const i=a();if(!Object(b.isMetadataTransformStatsLoading)(i)){n({type:"metadataTransformStatsChanged",payload:Object(m.d)(Object(m.a)(Object(b.getMetadataTransformStats)(i)))});try{const t=await e.get(c.u,{version:"2023-10-31"});n({type:"metadataTransformStatsChanged",payload:Object(m.c)(t.transforms)})}catch(e){n({type:"metadataTransformStatsChanged",payload:Object(m.b)(e)})}}}(e.http,t):void 0}},h=async(e,t,a)=>{if(0===t.length)return;const n=[...new Set(t.reduce(((e,t)=>{const n=t.metadata.Endpoint.policy.applied.id;return a[n]||e.push(n),e}),[]))];if(0===n.length)return;const i=(await Object(f.b)(e,n)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_id,e)),{packagePolicy:{},agentPolicy:{}}),r=n.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(r.packagePolicy).length||0!==Object.keys(r.agentPolicy).length?r:void 0},v=async e=>{try{return await(async e=>{try{return(await e.get(c.r,{version:"2023-10-31",query:{page:0,pageSize:1}})).total}catch(e){g("error while trying to check for total endpoints"),g(e)}return 0})(e)>0}catch(e){g("error while trying to check if endpoints exist"),g(e)}return!1},E=async({getState:e,dispatch:t},a)=>{const n=e();if(!Object(b.getIsIsolationRequestPending)(n)){t({type:"endpointIsolationRequestStateChange",payload:Object(m.d)(Object(m.a)(Object(b.getCurrentIsolationRequestState)(n)))});try{let e;e="unisolate"===a.payload.type?await Object(u.b)(a.payload.data):await Object(u.a)(a.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(m.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(m.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},x=async({getState:e,dispatch:t})=>{const a=e(),n=Object(b.listData)(a),i=new Set;for(const e of n)i.add(e.metadata.elastic.agent.id);if(0!==i.size)try{const{data:e}=await Object(d.a)(Array.from(i)),a=new Map;for(const t of e)a.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(m.c)(a)})}catch(e){g(e)}},j=e=>t=>t[i.v][e],S=(e,t)=>[Object(n.f)(j(i.w),Object(r.b)(e,t)),Object(n.f)(j(i.u),y(e,t))]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){
/*!

 diff v5.1.0

Software License Agreement (BSD License)

Copyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>

All rights reserved.

Redistribution and use of this software in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above
  copyright notice, this list of conditions and the
  following disclaimer.

* Redistributions in binary form must reproduce the above
  copyright notice, this list of conditions and the
  following disclaimer in the documentation and/or other
  materials provided with the distribution.

* Neither the name of Kevin Decker nor the names of its
  contributors may be used to endorse or promote products
  derived from this software without specific prior
  written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
@license
*/
!function(e){"use strict";function t(){}function a(e,t,a,n,i){for(var r=0,s=t.length,o=0,l=0;r<s;r++){var c=t[r];if(c.removed){if(c.value=e.join(n.slice(l,l+c.count)),l+=c.count,r&&t[r-1].added){var u=t[r-1];t[r-1]=t[r],t[r]=u}}else{if(!c.added&&i){var d=a.slice(o,o+c.count);d=d.map((function(e,t){var a=n[l+t];return a.length>e.length?a:e})),c.value=e.join(d)}else c.value=e.join(a.slice(o,o+c.count));o+=c.count,c.added||(l+=c.count)}}var p=t[s-1];return s>1&&"string"==typeof p.value&&(p.added||p.removed)&&e.equals("",p.value)&&(t[s-2].value+=p.value,t.pop()),t}t.prototype={diff:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.callback;"function"==typeof n&&(i=n,n={}),this.options=n;var r=this;function s(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var o=(t=this.removeEmpty(this.tokenize(t))).length,l=e.length,c=1,u=o+l;n.maxEditLength&&(u=Math.min(u,n.maxEditLength));var d=[{newPos:-1,components:[]}],p=this.extractCommon(d[0],t,e,0);if(d[0].newPos+1>=o&&p+1>=l)return s([{value:this.join(t),count:t.length}]);function m(){for(var n=-1*c;n<=c;n+=2){var i=void 0,u=d[n-1],p=d[n+1],m=(p?p.newPos:0)-n;u&&(d[n-1]=void 0);var f=u&&u.newPos+1<o,b=p&&0<=m&&m<l;if(f||b){if(!f||b&&u.newPos<p.newPos?(i={newPos:(g=p).newPos,components:g.components.slice(0)},r.pushComponent(i.components,void 0,!0)):((i=u).newPos++,r.pushComponent(i.components,!0,void 0)),m=r.extractCommon(i,t,e,n),i.newPos+1>=o&&m+1>=l)return s(a(r,i.components,t,e,r.useLongestToken));d[n]=i}else d[n]=void 0}var g;c++}if(i)!function e(){setTimeout((function(){if(c>u)return i();m()||e()}),0)}();else for(;c<=u;){var f=m();if(f)return f}},pushComponent:function(e,t,a){var n=e[e.length-1];n&&n.added===t&&n.removed===a?e[e.length-1]={count:n.count+1,added:t,removed:a}:e.push({count:1,added:t,removed:a})},extractCommon:function(e,t,a,n){for(var i=t.length,r=a.length,s=e.newPos,o=s-n,l=0;s+1<i&&o+1<r&&this.equals(t[s+1],a[o+1]);)s++,o++,l++;return l&&e.components.push({count:l}),e.newPos=s,o},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],a=0;a<e.length;a++)e[a]&&t.push(e[a]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var n=new t;function i(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}var r=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,s=/\S/,o=new t;o.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!s.test(e)&&!s.test(t)},o.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),a=0;a<t.length-1;a++)!t[a+1]&&t[a+2]&&r.test(t[a])&&r.test(t[a+2])&&(t[a]+=t[a+2],t.splice(a+1,2),a--);return t};var l=new t;function c(e,t,a){return l.diff(e,t,a)}l.tokenize=function(e){var t=[],a=e.split(/(\n|\r\n)/);a[a.length-1]||a.pop();for(var n=0;n<a.length;n++){var i=a[n];n%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t};var u=new t;u.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var d=new t;function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}d.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var b=Object.prototype.toString,g=new t;function y(e,t,a,n,i){var r,s;for(t=t||[],a=a||[],n&&(e=n(i,e)),r=0;r<t.length;r+=1)if(t[r]===e)return a[r];if("[object Array]"===b.call(e)){for(t.push(e),s=new Array(e.length),a.push(s),r=0;r<e.length;r+=1)s[r]=y(e[r],t,a,n,i);return t.pop(),a.pop(),s}if(e&&e.toJSON&&(e=e.toJSON()),"object"===p(e)&&null!==e){t.push(e),s={},a.push(s);var o,l=[];for(o in e)e.hasOwnProperty(o)&&l.push(o);for(l.sort(),r=0;r<l.length;r+=1)s[o=l[r]]=y(e[o],t,a,n,o);t.pop(),a.pop()}else s=e;return s}g.useLongestToken=!0,g.tokenize=l.tokenize,g.castInput=function(e){var t=this.options,a=t.undefinedReplacement,n=t.stringifyReplacer,i=void 0===n?function(e,t){return void 0===t?a:t}:n;return"string"==typeof e?e:JSON.stringify(y(e,null,null,i),i,"  ")},g.equals=function(e,a){return t.prototype.equals.call(g,e.replace(/,([\r\n])/g,"$1"),a.replace(/,([\r\n])/g,"$1"))};var h=new t;function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.split(/\r\n|[\n\v\f\r\x85]/),n=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],r=0;function s(){var e={};for(i.push(e);r<a.length;){var n=a[r];if(/^(\-\-\-|\+\+\+|@@)\s/.test(n))break;var s=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(n);s&&(e.index=s[1]),r++}for(o(e),o(e),e.hunks=[];r<a.length;){var c=a[r];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(l());else{if(c&&t.strict)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(c));r++}}}function o(e){var t=/^(---|\+\+\+)\s+(.*)$/.exec(a[r]);if(t){var n="---"===t[1]?"old":"new",i=t[2].split("\t",2),s=i[0].replace(/\\\\/g,"\\");/^".*"$/.test(s)&&(s=s.substr(1,s.length-2)),e[n+"FileName"]=s,e[n+"Header"]=(i[1]||"").trim(),r++}}function l(){var e=r,i=a[r++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),s={oldStart:+i[1],oldLines:void 0===i[2]?1:+i[2],newStart:+i[3],newLines:void 0===i[4]?1:+i[4],lines:[],linedelimiters:[]};0===s.oldLines&&(s.oldStart+=1),0===s.newLines&&(s.newStart+=1);for(var o=0,l=0;r<a.length&&!(0===a[r].indexOf("--- ")&&r+2<a.length&&0===a[r+1].indexOf("+++ ")&&0===a[r+2].indexOf("@@"));r++){var c=0==a[r].length&&r!=a.length-1?" ":a[r][0];if("+"!==c&&"-"!==c&&" "!==c&&"\\"!==c)break;s.lines.push(a[r]),s.linedelimiters.push(n[r]||"\n"),"+"===c?o++:"-"===c?l++:" "===c&&(o++,l++)}if(o||1!==s.newLines||(s.newLines=0),l||1!==s.oldLines||(s.oldLines=0),t.strict){if(o!==s.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(l!==s.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return s}for(;r<a.length;)s();return i}function E(e,t,a){var n=!0,i=!1,r=!1,s=1;return function o(){if(n&&!r){if(i?s++:n=!1,e+s<=a)return s;r=!0}if(!i)return r||(n=!0),t<=e-s?-s++:(i=!0,o())}}function x(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=v(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var n,i,r=e.split(/\r\n|[\n\v\f\r\x85]/),s=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=t.hunks,l=a.compareLine||function(e,t,a,n){return t===n},c=0,u=a.fuzzFactor||0,d=0,p=0;function m(e,t){for(var a=0;a<e.lines.length;a++){var n=e.lines[a],i=n.length>0?n[0]:" ",s=n.length>0?n.substr(1):n;if(" "===i||"-"===i){if(!l(t+1,r[t],i,s)&&++c>u)return!1;t++}}return!0}for(var f=0;f<o.length;f++){for(var b=o[f],g=r.length-b.oldLines,y=0,h=p+b.oldStart-1,x=E(h,d,g);void 0!==y;y=x())if(m(b,h+y)){b.offset=p+=y;break}if(void 0===y)return!1;d=b.offset+b.oldStart+b.oldLines}for(var j=0,S=0;S<o.length;S++){var O=o[S],k=O.oldStart+O.offset+j-1;j+=O.newLines-O.oldLines;for(var w=0;w<O.lines.length;w++){var T=O.lines[w],I=T.length>0?T[0]:" ",C=T.length>0?T.substr(1):T,M=O.linedelimiters[w];if(" "===I)k++;else if("-"===I)r.splice(k,1),s.splice(k,1);else if("+"===I)r.splice(k,0,C),s.splice(k,0,M),k++;else if("\\"===I){var _=O.lines[w-1]?O.lines[w-1][0]:null;"+"===_?n=!0:"-"===_&&(i=!0)}}}if(n)for(;!r[r.length-1];)r.pop(),s.pop();else i&&(r.push(""),s.push("\n"));for(var A=0;A<r.length-1;A++)r[A]=r[A]+s[A];return r.join("")}function j(e,t,a,n,i,r,s){s||(s={}),void 0===s.context&&(s.context=4);var o=c(a,n,s);if(o){o.push({value:"",lines:[]});for(var l=[],u=0,d=0,p=[],f=1,b=1,g=function(e){var t=o[e],i=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=i,t.added||t.removed){var r;if(!u){var c=o[e-1];u=f,d=b,c&&(p=s.context>0?h(c.lines.slice(-s.context)):[],u-=p.length,d-=p.length)}(r=p).push.apply(r,m(i.map((function(e){return(t.added?"+":"-")+e})))),t.added?b+=i.length:f+=i.length}else{if(u)if(i.length<=2*s.context&&e<o.length-2){var g;(g=p).push.apply(g,m(h(i)))}else{var y,v=Math.min(i.length,s.context);(y=p).push.apply(y,m(h(i.slice(0,v))));var E={oldStart:u,oldLines:f-u+v,newStart:d,newLines:b-d+v,lines:p};if(e>=o.length-2&&i.length<=s.context){var x=/\n$/.test(a),j=/\n$/.test(n),S=0==i.length&&p.length>E.oldLines;!x&&S&&a.length>0&&p.splice(E.oldLines,0,"\\ No newline at end of file"),(x||S)&&j||p.push("\\ No newline at end of file")}l.push(E),u=0,d=0,p=[]}f+=i.length,b+=i.length}},y=0;y<o.length;y++)g(y);return{oldFileName:e,newFileName:t,oldHeader:i,newHeader:r,hunks:l}}function h(e){return e.map((function(e){return" "+e}))}}function S(e,t,a,n,i,r,s){return function(e){var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+(void 0===e.oldHeader?"":"\t"+e.oldHeader)),t.push("+++ "+e.newFileName+(void 0===e.newHeader?"":"\t"+e.newHeader));for(var a=0;a<e.hunks.length;a++){var n=e.hunks[a];0===n.oldLines&&(n.oldStart-=1),0===n.newLines&&(n.newStart-=1),t.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),t.push.apply(t,n.lines)}return t.join("\n")+"\n"}(j(e,t,a,n,i,r,s))}function O(e,t){if(t.length>e.length)return!1;for(var a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0}function k(e){var t=z(e.lines),a=t.oldLines,n=t.newLines;void 0!==a?e.oldLines=a:delete e.oldLines,void 0!==n?e.newLines=n:delete e.newLines}function w(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return v(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return j(void 0,void 0,t,e)}return e}function T(e){return e.newFileName&&e.newFileName!==e.oldFileName}function I(e,t,a){return t===a?t:(e.conflict=!0,{mine:t,theirs:a})}function C(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function M(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function _(e,t,a,n,i){var r={offset:t,lines:a,index:0},s={offset:n,lines:i,index:0};for(D(e,r,s),D(e,s,r);r.index<r.lines.length&&s.index<s.lines.length;){var o=r.lines[r.index],l=s.lines[s.index];if("-"!==o[0]&&"+"!==o[0]||"-"!==l[0]&&"+"!==l[0])if("+"===o[0]&&" "===l[0]){var c;(c=e.lines).push.apply(c,m(R(r)))}else if("+"===l[0]&&" "===o[0]){var u;(u=e.lines).push.apply(u,m(R(s)))}else"-"===o[0]&&" "===l[0]?F(e,r,s):"-"===l[0]&&" "===o[0]?F(e,s,r,!0):o===l?(e.lines.push(o),r.index++,s.index++):P(e,R(r),R(s));else A(e,r,s)}N(e,r),N(e,s),k(e)}function A(e,t,a){var n,i,r=R(t),s=R(a);if(L(r)&&L(s)){var o,l;if(O(r,s)&&B(a,r,r.length-s.length))return void(o=e.lines).push.apply(o,m(r));if(O(s,r)&&B(t,s,s.length-r.length))return void(l=e.lines).push.apply(l,m(s))}else if(i=s,(n=r).length===i.length&&O(n,i)){var c;return void(c=e.lines).push.apply(c,m(r))}P(e,r,s)}function F(e,t,a,n){var i,r=R(t),s=function(e,t){for(var a=[],n=[],i=0,r=!1,s=!1;i<t.length&&e.index<e.lines.length;){var o=e.lines[e.index],l=t[i];if("+"===l[0])break;if(r=r||" "!==o[0],n.push(l),i++,"+"===o[0])for(s=!0;"+"===o[0];)a.push(o),o=e.lines[++e.index];l.substr(1)===o.substr(1)?(a.push(o),e.index++):s=!0}if("+"===(t[i]||"")[0]&&r&&(s=!0),s)return a;for(;i<t.length;)n.push(t[i++]);return{merged:n,changes:a}}(a,r);s.merged?(i=e.lines).push.apply(i,m(s.merged)):P(e,n?s:r,n?r:s)}function P(e,t,a){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:a})}function D(e,t,a){for(;t.offset<a.offset&&t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n),t.offset++}}function N(e,t){for(;t.index<t.lines.length;){var a=t.lines[t.index++];e.lines.push(a)}}function R(e){for(var t=[],a=e.lines[e.index][0];e.index<e.lines.length;){var n=e.lines[e.index];if("-"===a&&"+"===n[0]&&(a="+"),a!==n[0])break;t.push(n),e.index++}return t}function L(e){return e.reduce((function(e,t){return e&&"-"===t[0]}),!0)}function B(e,t,a){for(var n=0;n<a;n++){var i=t[t.length-a+n].substr(1);if(e.lines[e.index+n]!==" "+i)return!1}return e.index+=a,!0}function z(e){var t=0,a=0;return e.forEach((function(e){if("string"!=typeof e){var n=z(e.mine),i=z(e.theirs);void 0!==t&&(n.oldLines===i.oldLines?t+=n.oldLines:t=void 0),void 0!==a&&(n.newLines===i.newLines?a+=n.newLines:a=void 0)}else void 0===a||"+"!==e[0]&&" "!==e[0]||a++,void 0===t||"-"!==e[0]&&" "!==e[0]||t++})),{oldLines:t,newLines:a}}h.tokenize=function(e){return e.slice()},h.join=h.removeEmpty=function(e){return e},e.Diff=t,e.applyPatch=x,e.applyPatches=function(e,t){"string"==typeof e&&(e=v(e));var a=0;!function n(){var i=e[a++];if(!i)return t.complete();t.loadFile(i,(function(e,a){if(e)return t.complete(e);var r=x(a,i,t);t.patched(i,r,(function(e){if(e)return t.complete(e);n()}))}))}()},e.canonicalize=y,e.convertChangesToDMP=function(e){for(var t,a,n=[],i=0;i<e.length;i++)a=(t=e[i]).added?1:t.removed?-1:0,n.push([a,t.value]);return n},e.convertChangesToXML=function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];n.added?t.push("<ins>"):n.removed&&t.push("<del>"),t.push((i=n.value,void 0,i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))),n.added?t.push("</ins>"):n.removed&&t.push("</del>")}var i;return t.join("")},e.createPatch=function(e,t,a,n,i,r){return S(e,e,t,a,n,i,r)},e.createTwoFilesPatch=S,e.diffArrays=function(e,t,a){return h.diff(e,t,a)},e.diffChars=function(e,t,a){return n.diff(e,t,a)},e.diffCss=function(e,t,a){return d.diff(e,t,a)},e.diffJson=function(e,t,a){return g.diff(e,t,a)},e.diffLines=c,e.diffSentences=function(e,t,a){return u.diff(e,t,a)},e.diffTrimmedLines=function(e,t,a){var n=i(a,{ignoreWhitespace:!0});return l.diff(e,t,n)},e.diffWords=function(e,t,a){return a=i(a,{ignoreWhitespace:!0}),o.diff(e,t,a)},e.diffWordsWithSpace=function(e,t,a){return o.diff(e,t,a)},e.merge=function(e,t,a){e=w(e,a),t=w(t,a);var n={};(e.index||t.index)&&(n.index=e.index||t.index),(e.newFileName||t.newFileName)&&(T(e)?T(t)?(n.oldFileName=I(n,e.oldFileName,t.oldFileName),n.newFileName=I(n,e.newFileName,t.newFileName),n.oldHeader=I(n,e.oldHeader,t.oldHeader),n.newHeader=I(n,e.newHeader,t.newHeader)):(n.oldFileName=e.oldFileName,n.newFileName=e.newFileName,n.oldHeader=e.oldHeader,n.newHeader=e.newHeader):(n.oldFileName=t.oldFileName||e.oldFileName,n.newFileName=t.newFileName||e.newFileName,n.oldHeader=t.oldHeader||e.oldHeader,n.newHeader=t.newHeader||e.newHeader)),n.hunks=[];for(var i=0,r=0,s=0,o=0;i<e.hunks.length||r<t.hunks.length;){var l=e.hunks[i]||{oldStart:1/0},c=t.hunks[r]||{oldStart:1/0};if(C(l,c))n.hunks.push(M(l,s)),i++,o+=l.newLines-l.oldLines;else if(C(c,l))n.hunks.push(M(c,o)),r++,s+=c.newLines-c.oldLines;else{var u={oldStart:Math.min(l.oldStart,c.oldStart),oldLines:0,newStart:Math.min(l.newStart+s,c.oldStart+o),newLines:0,lines:[]};_(u,l.oldStart,l.lines,c.oldStart,c.lines),r++,i++,n.hunks.push(u)}}return n},e.parsePatch=v,e.structuredPatch=j,Object.defineProperty(e,"__esModule",{value:!0})}(t)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var n;e.exports=function e(t,a,i){function r(o,l){if(!a[o]){if(!t[o]){if(!l&&"function"==typeof n&&n)return n(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=a[o]={exports:{}};t[o][0].call(c.exports,(function(e){return r(t[o][1][e]||e)}),c,c.exports,e,t,a,i)}return a[o].exports}for(var s="function"==typeof n&&n,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,a){(function(n,i,r,s,o,l,c,u,d){"use strict";function p(e,t){return function(e,t){var a;if(void 0===(a="passthrough"!==t.algorithm?y.createHash(t.algorithm):new g).write&&(a.write=a.update,a.end=a.update),b(t,a).dispatch(e),a.update||a.end(""),a.digest)return a.digest("buffer"===t.encoding?void 0:t.encoding);var n=a.read();return"buffer"===t.encoding?n:n.toString(t.encoding)}(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var a=0;a<h.length;++a)h[a].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=h[a]);if(-1===h.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+h.join(", "));if(-1===v.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+v.join(", "));return t}function f(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function b(e,t,a){a=a||[];var n=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var a=typeof t;return null===t&&(a="null"),this["_"+a](t)},_object:function(t){var i=Object.prototype.toString.call(t),s=/\[object (.*)\]/i.exec(i);s=(s=s?s[1]:"unknown:["+i+"]").toLowerCase();var o;if((o=a.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+o+"]");if(a.push(t),void 0!==r&&r.isBuffer&&r.isBuffer(t))return n("buffer:"),n(t);if("object"===s||"function"===s){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||f(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+l.length+":");var c=this;return l.forEach((function(a){c.dispatch(a),n(":"),e.excludeValues||c.dispatch(t[a]),n(",")}))}if(!this["_"+s]){if(e.ignoreUnknown)return n("["+s+"]");throw new Error('Unknown object type "'+s+'"')}this["_"+s](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var r=this;if(n("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return r.dispatch(e)}));var s=[],o=t.map((function(t){var n=new g,i=a.slice();return b(e,n,i).dispatch(t),s=s.concat(i.slice(a.length)),n.read().toString()}));return a=a.concat(s),o.sort(),this._array(o,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),f(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString())},_map:function(t){n("map:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_set:function(t){n("set:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function g(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var y=e("crypto");(a=t.exports=p).sha1=function(e){return p(e)},a.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var h=y.getHashes?y.getHashes().slice():["sha1","md5"];h.push("passthrough");var v=["buffer","hex","binary","base64"];a.writeToStream=function(e,t,a){return void 0===a&&(a=t,t={}),b(t=m(e,t),a).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===n||t===l?62:t===i||t===c?63:t<r?-1:t<r+10?t-r+26+26:t<o+26?t-o:t<s+26?t-s+26:void 0}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),i="/".charCodeAt(0),r="0".charCodeAt(0),s="a".charCodeAt(0),o="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function n(e){c[d++]=e}var i,r,s,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new a(3*e.length/4-l),s=l>0?e.length-4:e.length;var d=0;for(i=0,r=0;i<s;i+=4,r+=3)n((16711680&(o=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&o)>>8),n(255&o);return 2===l?n(255&(o=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===l&&(n((o=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&o)),c},e.fromByteArray=function(e){function t(e){return u.charAt(e)}function a(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var n,i,r,s=e.length%3,o="";for(n=0,r=e.length-s;n<r;n+=3)o+=a(i=(e[n]<<16)+(e[n+1]<<8)+e[n+2]);switch(s){case 1:o+=t((i=e[e.length-1])>>2),o+=t(i<<4&63),o+="==";break;case 2:o+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),o+=t(i>>4&63),o+=t(i<<2&63),o+="="}return o}}(void 0===a?this.base64js={}:a)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function i(e,t,a){if(!(this instanceof i))return new i(e,t,a);var n,r,s,o=typeof e;if("base64"===t&&"string"===o)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"===o)n=M(e);else if("string"===o)n=i.byteLength(e,t);else{if("object"!==o)throw new Error("First argument needs to be a number, array or string.");n=M(e.length)}if(i._useTypedArrays?r=i._augment(new Uint8Array(n)):((r=this).length=n,r._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)r._set(e);else if(function(e){return _(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(s=0;s<n;s++)i.isBuffer(e)?r[s]=e.readUInt8(s):r[s]=e[s];else if("string"===o)r.write(e,0,t);else if("number"===o&&!i._useTypedArrays&&!a)for(s=0;s<n;s++)r[s]=0;return r}function d(e,t,a,n){a=Number(a)||0;var r=e.length-a;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;z(s%2==0,"Invalid hex string"),n>s/2&&(n=s/2);for(var o=0;o<n;o++){var l=parseInt(t.substr(2*o,2),16);z(!isNaN(l),"Invalid hex string"),e[a+o]=l}return i._charsWritten=2*o,o}function p(e,t,a,n){return i._charsWritten=D(F(t),e,a,n)}function m(e,t,a,n){return i._charsWritten=D(function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function f(e,t,a,n){return i._charsWritten=D(P(t),e,a,n)}function b(e,t,a,n){return i._charsWritten=D(function(e){for(var t,a,n,i=[],r=0;r<e.length;r++)a=(t=e.charCodeAt(r))>>8,n=t%256,i.push(n),i.push(a);return i}(t),e,a,n)}function g(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;i++)n+=String.fromCharCode(e[i]);return n}function y(e,t,a,n){n||(z("boolean"==typeof a,"missing or invalid endian"),z(null!=t,"missing offset"),z(t+1<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(i=e[t],t+1<r&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<r&&(i|=e[t+1])),i}function h(e,t,a,n){n||(z("boolean"==typeof a,"missing or invalid endian"),z(null!=t,"missing offset"),z(t+3<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(t+2<r&&(i=e[t+2]<<16),t+1<r&&(i|=e[t+1]<<8),i|=e[t],t+3<r&&(i+=e[t+3]<<24>>>0)):(t+1<r&&(i=e[t+1]<<16),t+2<r&&(i|=e[t+2]<<8),t+3<r&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function v(e,t,a,n){if(n||(z("boolean"==typeof a,"missing or invalid endian"),z(null!=t,"missing offset"),z(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=y(e,t,a,!0);return 32768&i?-1*(65535-i+1):i}}function E(e,t,a,n){if(n||(z("boolean"==typeof a,"missing or invalid endian"),z(null!=t,"missing offset"),z(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=h(e,t,a,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function x(e,t,a,n){return n||(z("boolean"==typeof a,"missing or invalid endian"),z(t+3<e.length,"Trying to read beyond buffer length")),$.read(e,t,a,23,4)}function j(e,t,a,n){return n||(z("boolean"==typeof a,"missing or invalid endian"),z(t+7<e.length,"Trying to read beyond buffer length")),$.read(e,t,a,52,8)}function S(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+1<e.length,"trying to write beyond buffer length"),R(t,65535));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,2);s<o;s++)e[a+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function O(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+3<e.length,"trying to write beyond buffer length"),R(t,4294967295));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,4);s<o;s++)e[a+s]=t>>>8*(n?s:3-s)&255}function k(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+1<e.length,"Trying to write beyond buffer length"),L(t,32767,-32768)),a>=e.length||S(e,t>=0?t:65535+t+1,a,n,i)}function w(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+3<e.length,"Trying to write beyond buffer length"),L(t,2147483647,-2147483648)),a>=e.length||O(e,t>=0?t:4294967295+t+1,a,n,i)}function T(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+3<e.length,"Trying to write beyond buffer length"),B(t,34028234663852886e22,-34028234663852886e22)),a>=e.length||$.write(e,t,a,n,23,4)}function I(e,t,a,n,i){i||(z(null!=t,"missing value"),z("boolean"==typeof n,"missing or invalid endian"),z(null!=a,"missing offset"),z(a+7<e.length,"Trying to write beyond buffer length"),B(t,17976931348623157e292,-17976931348623157e292)),a>=e.length||$.write(e,t,a,n,52,8)}function C(e,t,a){return"number"!=typeof e?a:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function _(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function A(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);if(n<=127)t.push(e.charCodeAt(a));else{var i=a;n>=55296&&n<=57343&&a++;for(var r=encodeURIComponent(e.slice(i,a+1)).substr(1).split("%"),s=0;s<r.length;s++)t.push(parseInt(r[s],16))}}return t}function P(e){return q.toByteArray(e)}function D(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);i++)t[i+a]=e[i];return i}function N(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function R(e,t){z("number"==typeof e,"cannot write a non-number as a number"),z(e>=0,"specified a negative value for writing an unsigned value"),z(e<=t,"value is larger than maximum value for type"),z(Math.floor(e)===e,"value has a fractional component")}function L(e,t,a){z("number"==typeof e,"cannot write a non-number as a number"),z(e<=t,"value larger than maximum allowed value"),z(e>=a,"value smaller than minimum allowed value"),z(Math.floor(e)===e,"value has a fractional component")}function B(e,t,a){z("number"==typeof e,"cannot write a non-number as a number"),z(e<=t,"value larger than maximum allowed value"),z(e>=a,"value smaller than minimum allowed value")}function z(e,t){if(!e)throw new Error(t||"Failed assertion")}var q=e("base64-js"),$=e("ieee754");a.Buffer=i,a.SlowBuffer=i,a.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var a;switch(e+="",t||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=F(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=P(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},i.concat=function(e,t){if(z(_(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var a;if("number"!=typeof t)for(t=0,a=0;a<e.length;a++)t+=e[a].length;var n=new i(t),r=0;for(a=0;a<e.length;a++){var s=e[a];s.copy(n,r),r+=s.length}return n},i.prototype.write=function(e,t,a,n){if(isFinite(t))isFinite(a)||(n=a,a=void 0);else{var i=n;n=t,t=a,a=i}t=Number(t)||0;var r,s=this.length-t;switch(a?(a=Number(a))>s&&(a=s):a=s,n=String(n||"utf8").toLowerCase()){case"hex":r=d(this,e,t,a);break;case"utf8":case"utf-8":r=p(this,e,t,a);break;case"ascii":r=m(this,e,t,a);break;case"binary":r=function(e,t,a,n){return m(e,t,a,n)}(this,e,t,a);break;case"base64":r=f(this,e,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=b(this,e,t,a);break;default:throw new Error("Unknown encoding")}return r},i.prototype.toString=function(e,t,a){var n,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(a=void 0!==a?Number(a):a=i.length)===t)return"";switch(e){case"hex":n=function(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",r=t;r<a;r++)i+=A(e[r]);return i}(i,t,a);break;case"utf8":case"utf-8":n=function(e,t,a){var n="",i="";a=Math.min(e.length,a);for(var r=t;r<a;r++)e[r]<=127?(n+=N(i)+String.fromCharCode(e[r]),i=""):i+="%"+e[r].toString(16);return n+N(i)}(i,t,a);break;case"ascii":n=g(i,t,a);break;case"binary":n=function(e,t,a){return g(e,t,a)}(i,t,a);break;case"base64":n=function(e,t,a){return 0===t&&a===e.length?q.fromByteArray(e):q.fromByteArray(e.slice(t,a))}(i,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,a){for(var n=e.slice(t,a),i="",r=0;r<n.length;r+=2)i+=String.fromCharCode(n[r]+256*n[r+1]);return i}(i,t,a);break;default:throw new Error("Unknown encoding")}return n},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,a,n){var r=this;if(a||(a=0),n||0===n||(n=this.length),t||(t=0),n!==a&&0!==e.length&&0!==r.length){z(n>=a,"sourceEnd < sourceStart"),z(t>=0&&t<e.length,"targetStart out of bounds"),z(a>=0&&a<r.length,"sourceStart out of bounds"),z(n>=0&&n<=r.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var s=n-a;if(s<100||!i._useTypedArrays)for(var o=0;o<s;o++)e[o+t]=this[o+a];else e._set(this.subarray(a,a+s),t)}},i.prototype.slice=function(e,t){var a=this.length;if(e=C(e,a,0),t=C(t,a,a),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var n=t-e,r=new i(n,void 0,!0),s=0;s<n;s++)r[s]=this[s+e];return r},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(z(null!=e,"missing offset"),z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return y(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return y(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return h(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return h(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(z(null!=e,"missing offset"),z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return v(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return v(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return E(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return E(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return x(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return x(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return j(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return j(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,a){a||(z(null!=e,"missing value"),z(null!=t,"missing offset"),z(t<this.length,"trying to write beyond buffer length"),R(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,a){S(this,e,t,!0,a)},i.prototype.writeUInt16BE=function(e,t,a){S(this,e,t,!1,a)},i.prototype.writeUInt32LE=function(e,t,a){O(this,e,t,!0,a)},i.prototype.writeUInt32BE=function(e,t,a){O(this,e,t,!1,a)},i.prototype.writeInt8=function(e,t,a){a||(z(null!=e,"missing value"),z(null!=t,"missing offset"),z(t<this.length,"Trying to write beyond buffer length"),L(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,a):this.writeUInt8(255+e+1,t,a))},i.prototype.writeInt16LE=function(e,t,a){k(this,e,t,!0,a)},i.prototype.writeInt16BE=function(e,t,a){k(this,e,t,!1,a)},i.prototype.writeInt32LE=function(e,t,a){w(this,e,t,!0,a)},i.prototype.writeInt32BE=function(e,t,a){w(this,e,t,!1,a)},i.prototype.writeFloatLE=function(e,t,a){T(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){T(this,e,t,!1,a)},i.prototype.writeDoubleLE=function(e,t,a){I(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){I(this,e,t,!1,a)},i.prototype.fill=function(e,t,a){if(e||(e=0),t||(t=0),a||(a=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),z("number"==typeof e&&!isNaN(e),"value is not a number"),z(a>=t,"end < start"),a!==t&&0!==this.length){z(t>=0&&t<this.length,"start out of bounds"),z(a>=0&&a<=this.length,"end out of bounds");for(var n=t;n<a;n++)this[n]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=A(this[n]),n===a.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,a=e.length;t<a;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var V=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=V.get,e.set=V.set,e.write=V.write,e.toString=V.toString,e.toLocaleString=V.toString,e.toJSON=V.toJSON,e.copy=V.copy,e.slice=V.slice,e.readUInt8=V.readUInt8,e.readUInt16LE=V.readUInt16LE,e.readUInt16BE=V.readUInt16BE,e.readUInt32LE=V.readUInt32LE,e.readUInt32BE=V.readUInt32BE,e.readInt8=V.readInt8,e.readInt16LE=V.readInt16LE,e.readInt16BE=V.readInt16BE,e.readInt32LE=V.readInt32LE,e.readInt32BE=V.readInt32BE,e.readFloatLE=V.readFloatLE,e.readFloatBE=V.readFloatBE,e.readDoubleLE=V.readDoubleLE,e.readDoubleBE=V.readDoubleBE,e.writeUInt8=V.writeUInt8,e.writeUInt16LE=V.writeUInt16LE,e.writeUInt16BE=V.writeUInt16BE,e.writeUInt32LE=V.writeUInt32LE,e.writeUInt32BE=V.writeUInt32BE,e.writeInt8=V.writeInt8,e.writeInt16LE=V.writeInt16LE,e.writeInt16BE=V.writeInt16BE,e.writeInt32LE=V.writeInt32LE,e.writeInt32BE=V.writeInt32BE,e.writeFloatLE=V.writeFloatLE,e.writeFloatBE=V.writeFloatBE,e.writeDoubleLE=V.writeDoubleLE,e.writeDoubleBE=V.writeDoubleBE,e.fill=V.fill,e.inspect=V.inspect,e.toArrayBuffer=V.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){i=e("buffer").Buffer;var d=4,p=new i(d);p.fill(0);var m=8;t.exports={hash:function(e,t,a,n){return i.isBuffer(e)||(e=new i(e)),function(e,t,a){for(var n=new i(t),r=a?n.writeInt32BE:n.writeInt32LE,s=0;s<e.length;s++)r.call(n,e[s],4*s,!0);return n}(t(function(e,t){if(e.length%d!=0){var a=e.length+(d-e.length%d);e=i.concat([e,p],a)}for(var n=[],r=t?e.readInt32BE:e.readInt32LE,s=0;s<e.length;s+=d)n.push(r.call(e,s));return n}(e,n),e.length*m),a,n)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function d(e,t){var a=g[e=e||"sha1"],n=[];return a||p("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),n.push(e),e.length,this},digest:function(e){var r=i.concat(n),s=t?function(e,t,a){i.isBuffer(t)||(t=new i(t)),i.isBuffer(a)||(a=new i(a)),t.length>y?t=e(t):t.length<y&&(t=i.concat([t,h],y));for(var n=new i(y),r=new i(y),s=0;s<y;s++)n[s]=54^t[s],r[s]=92^t[s];var o=e(i.concat([n,a]));return e(i.concat([r,o]))}(a,t,r):a(r);return n=null,e?s.toString(e):s}}}function p(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}i=e("buffer").Buffer;var m=e("./sha"),f=e("./sha256"),b=e("./rng"),g={sha1:m,sha256:f,md5:e("./md5")},y=64,h=new i(y);h.fill(0),a.createHash=function(e){return d(e)},a.createHmac=function(e,t){return d(e,t)},a.randomBytes=function(e,t){if(!t||!t.call)return new i(b(e));try{t.call(this,void 0,new i(b(e)))}catch(e){t(e)}},function(e,t){for(var a in e)t(e[a],a)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){a[e]=function(){p("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,r=271733878,s=0;s<e.length;s+=16){var o=a,l=n,c=i,u=r;a=m(a,n,i,r,e[s+0],7,-680876936),r=m(r,a,n,i,e[s+1],12,-389564586),i=m(i,r,a,n,e[s+2],17,606105819),n=m(n,i,r,a,e[s+3],22,-1044525330),a=m(a,n,i,r,e[s+4],7,-176418897),r=m(r,a,n,i,e[s+5],12,1200080426),i=m(i,r,a,n,e[s+6],17,-1473231341),n=m(n,i,r,a,e[s+7],22,-45705983),a=m(a,n,i,r,e[s+8],7,1770035416),r=m(r,a,n,i,e[s+9],12,-1958414417),i=m(i,r,a,n,e[s+10],17,-42063),n=m(n,i,r,a,e[s+11],22,-1990404162),a=m(a,n,i,r,e[s+12],7,1804603682),r=m(r,a,n,i,e[s+13],12,-40341101),i=m(i,r,a,n,e[s+14],17,-1502002290),a=f(a,n=m(n,i,r,a,e[s+15],22,1236535329),i,r,e[s+1],5,-165796510),r=f(r,a,n,i,e[s+6],9,-1069501632),i=f(i,r,a,n,e[s+11],14,643717713),n=f(n,i,r,a,e[s+0],20,-373897302),a=f(a,n,i,r,e[s+5],5,-701558691),r=f(r,a,n,i,e[s+10],9,38016083),i=f(i,r,a,n,e[s+15],14,-660478335),n=f(n,i,r,a,e[s+4],20,-405537848),a=f(a,n,i,r,e[s+9],5,568446438),r=f(r,a,n,i,e[s+14],9,-1019803690),i=f(i,r,a,n,e[s+3],14,-187363961),n=f(n,i,r,a,e[s+8],20,1163531501),a=f(a,n,i,r,e[s+13],5,-1444681467),r=f(r,a,n,i,e[s+2],9,-51403784),i=f(i,r,a,n,e[s+7],14,1735328473),a=b(a,n=f(n,i,r,a,e[s+12],20,-1926607734),i,r,e[s+5],4,-378558),r=b(r,a,n,i,e[s+8],11,-2022574463),i=b(i,r,a,n,e[s+11],16,1839030562),n=b(n,i,r,a,e[s+14],23,-35309556),a=b(a,n,i,r,e[s+1],4,-1530992060),r=b(r,a,n,i,e[s+4],11,1272893353),i=b(i,r,a,n,e[s+7],16,-155497632),n=b(n,i,r,a,e[s+10],23,-1094730640),a=b(a,n,i,r,e[s+13],4,681279174),r=b(r,a,n,i,e[s+0],11,-358537222),i=b(i,r,a,n,e[s+3],16,-722521979),n=b(n,i,r,a,e[s+6],23,76029189),a=b(a,n,i,r,e[s+9],4,-640364487),r=b(r,a,n,i,e[s+12],11,-421815835),i=b(i,r,a,n,e[s+15],16,530742520),a=g(a,n=b(n,i,r,a,e[s+2],23,-995338651),i,r,e[s+0],6,-198630844),r=g(r,a,n,i,e[s+7],10,1126891415),i=g(i,r,a,n,e[s+14],15,-1416354905),n=g(n,i,r,a,e[s+5],21,-57434055),a=g(a,n,i,r,e[s+12],6,1700485571),r=g(r,a,n,i,e[s+3],10,-1894986606),i=g(i,r,a,n,e[s+10],15,-1051523),n=g(n,i,r,a,e[s+1],21,-2054922799),a=g(a,n,i,r,e[s+8],6,1873313359),r=g(r,a,n,i,e[s+15],10,-30611744),i=g(i,r,a,n,e[s+6],15,-1560198380),n=g(n,i,r,a,e[s+13],21,1309151649),a=g(a,n,i,r,e[s+4],6,-145523070),r=g(r,a,n,i,e[s+11],10,-1120210379),i=g(i,r,a,n,e[s+2],15,718787259),n=g(n,i,r,a,e[s+9],21,-343485551),a=y(a,o),n=y(n,l),i=y(i,c),r=y(r,u)}return Array(a,n,i,r)}function p(e,t,a,n,i,r){return y(function(e,t){return e<<t|e>>>32-t}(y(y(t,e),y(n,r)),i),a)}function m(e,t,a,n,i,r,s){return p(t&a|~t&n,e,t,i,r,s)}function f(e,t,a,n,i,r,s){return p(t&n|a&~n,e,t,i,r,s)}function b(e,t,a,n,i,r,s){return p(t^a^n,e,t,i,r,s)}function g(e,t,a,n,i,r,s){return p(a^(t|~n),e,t,i,r,s)}function y(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}var h=e("./helpers");t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){!function(){var e,a;e=function(e){for(var t,a=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),a[n]=t>>>((3&n)<<3)&255;return a},this.crypto&&crypto.getRandomValues&&(a=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=a||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var a=Array(80),n=1732584193,i=-271733879,r=-1732584194,s=271733878,o=-1009589776,l=0;l<e.length;l+=16){for(var c=n,u=i,d=r,g=s,y=o,h=0;h<80;h++){a[h]=h<16?e[l+h]:b(a[h-3]^a[h-8]^a[h-14]^a[h-16],1);var v=f(f(b(n,5),p(h,i,r,s)),f(f(o,a[h]),m(h)));o=s,s=r,r=b(i,30),i=n,n=v}n=f(n,c),i=f(i,u),r=f(r,d),s=f(s,g),o=f(o,y)}return Array(n,i,r,s,o)}function p(e,t,a,n){return e<20?t&a|~t&n:e<40?t^a^n:e<60?t&a|t&n|a&n:t^a^n}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function f(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function b(e,t){return e<<t|e>>>32-t}var g=e("./helpers");t.exports=function(e){return g.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){var d=e("./helpers"),p=function(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a},m=function(e,t){return e>>>t|e<<32-t},f=function(e,t){return e>>>t},b=function(e,t,a){return e&t^~e&a},g=function(e,t,a){return e&t^e&a^t&a},y=function(e){return m(e,2)^m(e,13)^m(e,22)},h=function(e){return m(e,6)^m(e,11)^m(e,25)},v=function(e){return m(e,7)^m(e,18)^f(e,3)},E=function(e){return m(e,17)^m(e,19)^f(e,10)},x=function(e,t){var a,n,i,r,s,o,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),f=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var j=0;j<e.length;j+=16){a=f[0],n=f[1],i=f[2],r=f[3],s=f[4],o=f[5],l=f[6],c=f[7];for(var S=0;S<64;S++)x[S]=S<16?e[S+j]:p(p(p(E(x[S-2]),x[S-7]),v(x[S-15])),x[S-16]),u=p(p(p(p(c,h(s)),b(s,o,l)),m[S]),x[S]),d=p(y(a),g(a,n,i)),c=l,l=o,o=s,s=p(r,u),r=i,i=n,n=a,a=p(u,d);f[0]=p(a,f[0]),f[1]=p(n,f[1]),f[2]=p(i,f[2]),f[3]=p(r,f[3]),f[4]=p(s,f[4]),f[5]=p(o,f[5]),f[6]=p(l,f[6]),f[7]=p(c,f[7])}return f};t.exports=function(e){return d.hash(e,x,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),a.length>0)&&a.shift()()}),!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){a.read=function(e,t,a,n,i){var r,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=a?i-1:0,p=a?-1:1,m=e[t+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(m?-1:1);s+=Math.pow(2,n),r-=c}return(m?-1:1)*s*Math.pow(2,r-n)},a.write=function(e,t,a,n,i,r){var s,o,l,c=8*r-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:r-1,f=n?1:-1,b=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[a+m]=255&o,m+=f,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[a+m]=255&s,m+=f,s/=256,c-=8);e[a+m-f]|=128*b}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1654);case"v8light":return a(1656)}},function(e,t,a){var n=a(332),i=a(1655);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,"[class*=options_list_popover_footer--OptionsListPopoverFooter],[data-test-subj=optionsListControl__sortingOptionsButton],[id^=control-popover] .euiPopoverTitle{display:none}.filter-group__wrapper .euiFlexGroup.controlGroup{min-height:34px}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout{height:34px}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout .euiFormLabel.controlFrame__formControlLayoutLabel{padding:8px!important}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout .euiButtonEmpty.euiFilterButton{height:32px}.filter-group__wrapper .euiText.errorEmbeddableCompact__button{padding:8px}.filter-group__wrapper .euiText.errorEmbeddableCompact__button .euiLink{display:flex;gap:8px}",""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1657);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,"[class*=options_list_popover_footer--OptionsListPopoverFooter],[data-test-subj=optionsListControl__sortingOptionsButton],[id^=control-popover] .euiPopoverTitle{display:none}.filter-group__wrapper .euiFlexGroup.controlGroup{min-height:34px}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout{height:34px}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout .euiFormLabel.controlFrame__formControlLayoutLabel{padding:8px!important}.filter-group__wrapper .euiFormControlLayout.euiFormControlLayout--group.controlFrame__formControlLayout .euiButtonEmpty.euiFilterButton{height:32px}.filter-group__wrapper .euiText.errorEmbeddableCompact__button{padding:8px}.filter-group__wrapper .euiText.errorEmbeddableCompact__button .euiLink{display:flex;gap:8px}",""]),e.exports=t},function(e,t,a){"use strict";const n=a(1659);e.exports=(e,t={})=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");t.colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);const a=[],i=(e,n,i,r)=>{if(!(0!==a.length&&t.colonNotation||0!==e||t.colonNotation&&"m"===i))return;let s,o;if(r=(r||e||"0").toString(),t.colonNotation){s=a.length>0?":":"",o="";const e=r.includes(".")?r.split(".")[0].length:r.length,t=a.length>0?2:1;r="0".repeat(Math.max(0,t-e))+r}else s="",o=t.verbose?" "+(l=n,1===e?l:`${l}s`):i;var l;a.push(s+r+o)};if(("number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1)<1){const t=1e3-e%1e3;t<500&&(e+=t)}if(e>=59950&&!t.separateMilliseconds&&!t.formatSubMilliseconds){const t=60-e%60;t<=50&&(e+=t)}const r=n(e);if(i(Math.trunc(r.days/365),"year","y"),i(r.days%365,"day","d"),i(r.hours,"hour","h"),i(r.minutes,"minute","m"),t.separateMilliseconds||t.formatSubMilliseconds||e<1e3)if(i(r.seconds,"second","s"),t.formatSubMilliseconds)i(r.milliseconds,"millisecond","ms"),i(r.microseconds,"microsecond","Âµs"),i(r.nanoseconds,"nanosecond","ns");else{const e=r.milliseconds+r.microseconds/1e3+r.nanoseconds/1e6,a="number"==typeof t.millisecondsDecimalDigits?t.millisecondsDecimalDigits:0,n=e>=1?Math.round(e):Math.ceil(e),s=a?e.toFixed(a):n;i(parseFloat(s,10),"millisecond","ms",s)}else{const a=e/1e3%60,n="number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1,r=a.toFixed(n),s=t.keepDecimalsOnWholeSeconds?r:r.replace(/\.0+$/,"");i(parseFloat(s,10),"second","s",s)}return 0===a.length?"0"+(t.verbose?" milliseconds":"ms"):t.compact?a[0]:"number"==typeof t.unitCount?a.slice(0,Math.max(t.unitCount,1)).join(" "):t.colonNotation?a.join(""):a.join(" ")}},function(e,t,a){"use strict";e.exports=e=>{if("number"!=typeof e)throw new TypeError("Expected a number");const t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3,microseconds:t(1e3*e)%1e3,nanoseconds:t(1e6*e)%1e3}}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1661);case"v8light":return a(1663)}},function(e,t,a){var n=a(332),i=a(1662);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,'.messageVariablesPanel{height:100%;-webkit-mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);max-height:320px;max-width:320px;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.messageVariablesPanel::-webkit-scrollbar{height:16px;width:16px}.messageVariablesPanel::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.messageVariablesPanel::-webkit-scrollbar-corner,.messageVariablesPanel::-webkit-scrollbar-track{background-color:#0000}.messageVariablesPanel:focus{outline:none}.messageVariablesPanel[tabindex="0"]:focus:focus-visible{outline-style:auto}',""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1664);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,'.messageVariablesPanel{height:100%;-webkit-mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);max-height:320px;max-width:320px;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.messageVariablesPanel::-webkit-scrollbar{height:16px;width:16px}.messageVariablesPanel::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.messageVariablesPanel::-webkit-scrollbar-corner,.messageVariablesPanel::-webkit-scrollbar-track{background-color:#0000}.messageVariablesPanel:focus{outline:none}.messageVariablesPanel[tabindex="0"]:focus:focus-visible{outline-style:auto}',""]),e.exports=t},function(e,t,a){var n="undefined"!=typeof JSON?JSON:a(1666);e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var a=t.space||"";"number"==typeof a&&(a=Array(a+1).join(" "));var s,o="boolean"==typeof t.cycles&&t.cycles,l=t.replacer||function(e,t){return t},c=t.cmp&&(s=t.cmp,function(e){return function(t,a){var n={key:t,value:e[t]},i={key:a,value:e[a]};return s(n,i)}}),u=[];return function e(t,s,d,p){var m=a?"\n"+new Array(p+1).join(a):"",f=a?": ":":";if(d&&d.toJSON&&"function"==typeof d.toJSON&&(d=d.toJSON()),void 0!==(d=l.call(t,s,d))){if("object"!=typeof d||null===d)return n.stringify(d);if(i(d)){for(var b=[],g=0;g<d.length;g++){var y=e(d,g,d[g],p+1)||n.stringify(null);b.push(m+a+y)}return"["+b.join(",")+m+"]"}if(-1!==u.indexOf(d)){if(o)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}u.push(d);var h=r(d).sort(c&&c(d));for(b=[],g=0;g<h.length;g++){var v=e(d,s=h[g],d[s],p+1);if(v){var E=n.stringify(s)+f+v;b.push(m+a+E)}}return u.splice(u.indexOf(d),1),"{"+b.join(",")+m+"}"}}({"":e},"",e,0)};var i=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},r=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},a=[];for(var n in e)t.call(e,n)&&a.push(n);return a}},function(e,t,a){t.parse=a(1667),t.stringify=a(1668)},function(e,t){var a,n,i,r,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},o=function(e){throw{name:"SyntaxError",message:e,at:a,text:i}},l=function(e){return e&&e!==n&&o("Expected '"+e+"' instead of '"+n+"'"),n=i.charAt(a),a+=1,n},c=function(){var e,t="";for("-"===n&&(t="-",l("-"));n>="0"&&n<="9";)t+=n,l();if("."===n)for(t+=".";l()&&n>="0"&&n<="9";)t+=n;if("e"===n||"E"===n)for(t+=n,l(),"-"!==n&&"+"!==n||(t+=n,l());n>="0"&&n<="9";)t+=n,l();if(e=+t,isFinite(e))return e;o("Bad number")},u=function(){var e,t,a,i="";if('"'===n)for(;l();){if('"'===n)return l(),i;if("\\"===n)if(l(),"u"===n){for(a=0,t=0;t<4&&(e=parseInt(l(),16),isFinite(e));t+=1)a=16*a+e;i+=String.fromCharCode(a)}else{if("string"!=typeof s[n])break;i+=s[n]}else i+=n}o("Bad string")},d=function(){for(;n&&n<=" ";)l()};r=function(){switch(d(),n){case"{":return function(){var e,t={};if("{"===n){if(l("{"),d(),"}"===n)return l("}"),t;for(;n;){if(e=u(),d(),l(":"),Object.hasOwnProperty.call(t,e)&&o('Duplicate key "'+e+'"'),t[e]=r(),d(),"}"===n)return l("}"),t;l(","),d()}}o("Bad object")}();case"[":return function(){var e=[];if("["===n){if(l("["),d(),"]"===n)return l("]"),e;for(;n;){if(e.push(r()),d(),"]"===n)return l("]"),e;l(","),d()}}o("Bad array")}();case'"':return u();case"-":return c();default:return n>="0"&&n<="9"?c():function(){switch(n){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}o("Unexpected '"+n+"'")}()}},e.exports=function(e,t){var s;return i=e,a=0,n=" ",s=r(),d(),n&&o("Syntax error"),"function"==typeof t?function e(a,n){var i,r,s=a[n];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(void 0!==(r=e(s,i))?s[i]=r:delete s[i]);return t.call(a,n,s)}({"":s},""):s}},function(e,t){var a,n,i,r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function o(e){return r.lastIndex=0,r.test(e)?'"'+e.replace(r,(function(e){var t=s[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function l(e,t){var r,s,c,u,d,p=a,m=t[e];switch(m&&"object"==typeof m&&"function"==typeof m.toJSON&&(m=m.toJSON(e)),"function"==typeof i&&(m=i.call(t,e,m)),typeof m){case"string":return o(m);case"number":return isFinite(m)?String(m):"null";case"boolean":case"null":return String(m);case"object":if(!m)return"null";if(a+=n,d=[],"[object Array]"===Object.prototype.toString.apply(m)){for(u=m.length,r=0;r<u;r+=1)d[r]=l(r,m)||"null";return c=0===d.length?"[]":a?"[\n"+a+d.join(",\n"+a)+"\n"+p+"]":"["+d.join(",")+"]",a=p,c}if(i&&"object"==typeof i)for(u=i.length,r=0;r<u;r+=1)"string"==typeof(s=i[r])&&(c=l(s,m))&&d.push(o(s)+(a?": ":":")+c);else for(s in m)Object.prototype.hasOwnProperty.call(m,s)&&(c=l(s,m))&&d.push(o(s)+(a?": ":":")+c);return c=0===d.length?"{}":a?"{\n"+a+d.join(",\n"+a)+"\n"+p+"}":"{"+d.join(",")+"}",a=p,c}}e.exports=function(e,t,r){var s;if(a="",n="","number"==typeof r)for(s=0;s<r;s+=1)n+=" ";else"string"==typeof r&&(n=r);if(i=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return l("",{"":e})}},function(e,t,a){var n=a(332),i=a(1670);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,':root{--diff-background-color:initial;--diff-text-color:initial;--diff-font-family:Consolas,Courier,monospace;--diff-selection-background-color:#b3d7ff;--diff-selection-text-color:var(--diff-text-color);--diff-gutter-insert-background-color:#d6fedb;--diff-gutter-insert-text-color:var(--diff-text-color);--diff-gutter-delete-background-color:#fadde0;--diff-gutter-delete-text-color:var(--diff-text-color);--diff-gutter-selected-background-color:#fffce0;--diff-gutter-selected-text-color:var(--diff-text-color);--diff-code-insert-background-color:#eaffee;--diff-code-insert-text-color:var(--diff-text-color);--diff-code-delete-background-color:#fdeff0;--diff-code-delete-text-color:var(--diff-text-color);--diff-code-insert-edit-background-color:#c0dc91;--diff-code-insert-edit-text-color:var(--diff-text-color);--diff-code-delete-edit-background-color:#f39ea2;--diff-code-delete-edit-text-color:var(--diff-text-color);--diff-code-selected-background-color:#fffce0;--diff-code-selected-text-color:var(--diff-text-color);--diff-omit-gutter-line-color:#cb2a1d}.diff{background-color:var(--diff-background-color);border-collapse:collapse;color:var(--diff-text-color);table-layout:fixed;width:100%}.diff::selection{background-color:#b3d7ff;background-color:var(--diff-selection-background-color);color:var(--diff-text-color);color:var(--diff-selection-text-color)}.diff td{padding-bottom:0;padding-top:0;vertical-align:top}.diff-line{font-family:Consolas,Courier,monospace;font-family:var(--diff-font-family);line-height:1.5}.diff-gutter>a{color:inherit;display:block}.diff-gutter{cursor:pointer;padding:0 1ch;text-align:right;-webkit-user-select:none;user-select:none}.diff-gutter-insert{background-color:#d6fedb;background-color:var(--diff-gutter-insert-background-color);color:var(--diff-text-color);color:var(--diff-gutter-insert-text-color)}.diff-gutter-delete{background-color:#fadde0;background-color:var(--diff-gutter-delete-background-color);color:var(--diff-text-color);color:var(--diff-gutter-delete-text-color)}.diff-gutter-omit{cursor:default}.diff-gutter-selected{background-color:#fffce0;background-color:var(--diff-gutter-selected-background-color);color:var(--diff-text-color);color:var(--diff-gutter-selected-text-color)}.diff-code{word-wrap:break-word;padding:0 0 0 .5em;white-space:pre-wrap;word-break:break-all}.diff-code-edit{color:inherit}.diff-code-insert{background-color:#eaffee;background-color:var(--diff-code-insert-background-color);color:var(--diff-text-color);color:var(--diff-code-insert-text-color)}.diff-code-insert .diff-code-edit{background-color:#c0dc91;background-color:var(--diff-code-insert-edit-background-color);color:var(--diff-text-color);color:var(--diff-code-insert-edit-text-color)}.diff-code-delete{background-color:#fdeff0;background-color:var(--diff-code-delete-background-color);color:var(--diff-text-color);color:var(--diff-code-delete-text-color)}.diff-code-delete .diff-code-edit{background-color:#f39ea2;background-color:var(--diff-code-delete-edit-background-color);color:var(--diff-text-color);color:var(--diff-code-delete-edit-text-color)}.diff-code-selected{background-color:#fffce0;background-color:var(--diff-code-selected-background-color);color:var(--diff-text-color);color:var(--diff-code-selected-text-color)}.diff-widget-content{vertical-align:top}.diff-gutter-col{width:7ch}.diff-gutter-omit{height:0}.diff-gutter-omit:before{background-color:#cb2a1d;background-color:var(--diff-omit-gutter-line-color);content:" ";display:block;height:100%;margin-left:4.6ch;overflow:hidden;white-space:pre;width:2px}.diff-decoration{line-height:1.5;-webkit-user-select:none;user-select:none}.diff-decoration-content{font-family:Consolas,Courier,monospace;font-family:var(--diff-font-family);padding:0}',""]),e.exports=t},function(e,t,a){"use strict";let n=a(1516),i=a(1672);function r(e){return e.added?i.ADDED:e.removed?i.REMOVED:i.UNMODIFIED}function s(e,t){!function(e){0===e.length||(e[0].type=r(e[0]),e.reduce((function(e,t,a){if(t.type=r(t),e.type===t.type)throw Error("repeating change types are not handled: "+e.type+" (at "+(a-1)+" and "+a+")");return t})))}(e),(t=t||{}).aname=t.aname||"a",t.bname=t.bname||"b";let a=t.context||0===t.context?t.context:0;t.pre_context=t.pre_context||0===t.pre_context?t.pre_context:a,t.post_context=t.post_context||0===t.post_context?t.post_context:a;let n=i.makeHunks(e,t.pre_context,t.post_context);if(n.length){let e=[];return e.push("--- "+t.aname),e.push("+++ "+t.bname),n.forEach((function(t){e.push(t.unified())})),e.join("\n")}return""}function o(e,t,a){e=Array.isArray(e)?e.join("\n")+"\n":e,t=Array.isArray(t)?t.join("\n")+"\n":t;let i=n.diffLines(e,t,a);return 1!==i.length||i[0].added||i[0].removed?i:[]}function l(e,t,a){return s(o(e,t),a)}t.assertEqual=function(e,t,a,n,i){i=i||console.log,a=a.ok||a;let r=l(e,t,{context:3,aname:n+" (actual)",bname:n+" (expected)"});a(!r,n),r&&r.split("\n").forEach((function(e){i("  "+e)}))},t.diffAsText=l,t.formatLines=s,t.diffLines=o,Object.keys(n).forEach((function(e){t[e]||(t[e]=n[e])}))},function(e,t,a){"use strict";function n(e,t){let a=0;for(let n=0;n<e.length;n++)switch(e[n].type){case s:a+=t[0];break;case r:a+=t[1];break;case o:a++;break;default:throw Error("unknown change type: "+e[n].type)}return a}function i(e,t,a){this.changes=a,this.aoff=e,this.boff=t,this._alen=-1,this._blen=-1}Object.defineProperty(i.prototype,"alen",{get:function(){return-1===this._alen?this._alen=n(this.changes,[1,0]):this._alen}}),Object.defineProperty(i.prototype,"blen",{get:function(){return-1===this._blen?this._blen=n(this.changes,[0,1]):this._blen}}),i.prototype.unified=function(){let e=[this.unifiedHeader()];return this.changes.forEach((function(t){e.push(t.unified())})),e.join("\n")},i.prototype.unifiedHeader=function(){let e=1===this.alen?"":","+this.alen,t=1===this.blen?"":","+this.blen,a=0===this.alen?0:1,n=0===this.blen?0:1;return"@@ -"+(this.aoff+a)+e+" +"+(this.boff+n)+t+" @@"},i.prototype.shorthand=function(){return this.changes.reduce((function(e,t){return e+t.type}),"")},i.prototype.toString=function(){return"{"+this.shorthand()+"} "+this.unifiedHeader()};const r="+",s="-",o="s";function l(e){return"s"===e?" ":e}function c(e,t){this.type=e,this.text=t}function u(e,t){if(0===t)return[];let a=[],n=e.value;if(void 0===t)a=n.split("\n"),a[a.length-1]||a.pop();else if(t>0){let e=p(n,"\n",0,t,!1);a=n.substring(0,e).split("\n")}else{let e="\n"===n[n.length-1]?n.length-1:n.length,i=p(n,"\n",e-1,-t,!0);a=n.substring(i+1,e).split("\n")}return a.map((function(t){return new c(e.type,t)}))}function d(e,t){return Array.prototype.push.apply(t,e),t}function p(e,t,a,n,i){let r=i?-1:1;a-=r;for(let s=0;s<n;s++)a=i?e.lastIndexOf(t,a+r):e.indexOf(t,a+r);return a}c.prototype.unified=function(){return l(this.type)+this.text},c.prototype.toString=function(){return this.unified()},t.hunk=function(e,t,a){return new i(e,t,a)},t.linechange=function(e,t){return new c(e,t)},t.lineChanges=u,t.change2string=function(e,t){t=t||60;let a=e.count+": "+l(e.type),n=Math.min(t-a.length,e.value.length-1);return a+(e.value.substring(0,n).replace(/\n/g,",")+(e.value.length>n+1?"...":""))},t.changes2shorthand=function(e){return"{"+e.reduce((function(e,t){for(let a=0;a<t.count;a++)e+=t.type;return e}),"")+"}"},t.nthIndexOf=p,t.makeHunks=function(e,t,a){let n=[],r=[],s=0;function l(){if(r.length){let e=s,t=s;if(n.length){let a=n[n.length-1];e+=a.aoff+a.alen,t+=a.boff+a.blen}n.push(new i(e,t,r)),r=[],s=0}}for(let n=0;n<e.length;n++){let i=e[n];if(i.type===o){let o=n>0?a:0,c=n<e.length-1?t:0,p=Math.max(i.count-(o+c),0);p>0?(d(u(i,o),r),l(),d(u(i,-c),r),s=p):d(u(i),r)}else d(u(i),r)}return l(),n},t.ADDED=r,t.REMOVED=s,t.UNMODIFIED=o},function(e,t,a){"use strict";e.exports=a(1674)},function(e,t,a){"use strict";
/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */a(1675);var n=a(2),i=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;i=r("react.element"),t.Fragment=r("react.fragment")}var s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var n,r={},c=null,u=null;for(n in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,n)&&!l.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:u,props:r,_owner:s.current}}t.jsx=c,t.jsxs=c},function(e,t,a){e.exports=a(24)(1168)},function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1678);case"v8light":return a(1680)}},function(e,t,a){var n=a(332),i=a(1679);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,a){var n=a(332),i=a(1681);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,a){e.exports=a.p+"ae37f7e28b2ba3954b127510d84d3ac5.svg"},function(e,t,a){!function(t){"use strict";const a="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${a}\\.${a}\\.${a}\\.${a}$`,"i"),threeOctet:new RegExp(`^${a}\\.${a}\\.${a}$`,"i"),twoOctet:new RegExp(`^${a}\\.${a}$`,"i"),longValue:new RegExp(`^${a}$`,"i")},i=new RegExp("^0[0-7]+$","i"),r=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${a}\\.${a}\\.${a}\\.${a}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${a}\\.${a}\\.${a}\\.${a}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let a,n,i=0,r=-1,s=(e.match(l.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(r=e.indexOf(":",r+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,a=":";n--;)a+="0:";return":"===(e=e.replace("::",a))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),a=[];for(let e=0;e<t.length;e++)a.push(parseInt(t[e],16));return a}(),zoneId:s}}function u(e,t,a,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,r=0;for(;n>0;){if(i=a-n,i<0&&(i=0),e[r]>>i!=t[r]>>i)return!1;n-=a,r+=1}return!0}function d(e){if(r.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const m={};m.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,a;for(t=0;t<e.length;t++)if(a=e[t],!(0<=a&&a<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,r;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in a))return null;if(r=a[i],t&&0!==r)return null;8!==r&&(t=!0),e+=r}return 32-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return m.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),m.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),a=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let r=0;for(;r<4;)i.push(parseInt(a[r],10)|255^parseInt(n[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.isIPv4=function(e){return null!==this.parser(e)},m.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},m.IPv4.isValidFourPartDecimal=function(e){return!(!m.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},m.IPv4.networkAddressFromCIDR=function(e){let t,a,n,i,r;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(n[a],10)&parseInt(r[a],10)),a++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},m.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const a=[this.parse(t[1]),e];return Object.defineProperty(a,"toString",{value:function(){return this.join("/")}}),a}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},m.IPv4.parser=function(e){let t,a,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)a=e[t],n.push(d(a));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),a=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(i>>16&255),a.push(i>>8&255),a.push(255&i),a}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),a=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(d(e[1])),a.push(i>>8&255),a.push(255&i),a}():null},m.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let a=0;const n=Math.floor(e/8);for(;a<n;)t[a]=255,a++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},m.IPv6=function(){function e(e,t){let a,n;if(16===e.length)for(this.parts=[],a=0;a<=14;a+=2)this.parts.push(e[a]<<8|e[a+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(a=0;a<this.parts.length;a++)if(n=this.parts[a],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let r=7;r>=0;r-=1){if(n=this.parts[r],!(n in a))return null;if(i=a[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],a=this.parts;for(let n=0;n<a.length;n++)e=a[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],a=e[1];return new m.IPv4([t>>8,255&t,a>>8,255&a])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let a,n=0,i=-1;for(;a=e.exec(t);)a[0].length>i&&(n=a.index,i=a[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),m.IPv6.isIPv6=function(e){return null!==this.parser(e)},m.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},m.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},m.IPv6.parseCIDR=function(e){let t,a,n;if((a=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(a[2]),t>=0&&t<=128))return n=[this.parse(a[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},m.IPv6.parser=function(e){let t,a,n,i,r,s;if(n=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(l.native.test(e))return c(e,8);if((n=e.match(l.transitional))&&(s=n[6]||"",t=c(n[1].slice(0,-1)+s,6),t.parts)){for(r=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],a=0;a<r.length;a++)if(i=r[a],!(0<=i&&i<=255))return null;return t.parts.push(r[0]<<8|r[1]),t.parts.push(r[2]<<8|r[3]),{parts:t.parts,zoneId:t.zoneId}}return null},m.fromByteArray=function(e){const t=e.length;if(4===t)return new m.IPv4(e);if(16===t)return new m.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},m.isValid=function(e){return m.IPv6.isValid(e)||m.IPv4.isValid(e)},m.parse=function(e){if(m.IPv6.isValid(e))return m.IPv6.parse(e);if(m.IPv4.isValid(e))return m.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},m.parseCIDR=function(e){try{return m.IPv6.parseCIDR(e)}catch(t){try{return m.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},m.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},m.subnetMatch=function(e,t,a){let n,i,r,s;for(i in null==a&&(a="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(r=t[i],!r[0]||r[0]instanceof Array||(r=[r]),n=0;n<r.length;n++)if(s=r[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return a},e.exports?e.exports=m:t.ipaddr=m}(this)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"subPluginClasses",(function(){return wX}));var n={};a.r(n),a.d(n,"updateTableActivePage",(function(){return Be})),a.d(n,"setHostTablesActivePageToZero",(function(){return ze})),a.d(n,"setHostDetailsTablesActivePageToZero",(function(){return qe})),a.d(n,"updateTableLimit",(function(){return $e})),a.d(n,"updateHostsSort",(function(){return Ve})),a.d(n,"updateHostRiskScoreSort",(function(){return Ue})),a.d(n,"updateHostRiskScoreSeverityFilter",(function(){return He})),a.d(n,"updateHostsAnomaliesJobIdFilter",(function(){return Qe})),a.d(n,"updateHostsAnomaliesInterval",(function(){return Ge}));var i={};a.r(i),a.d(i,"authenticationsSelector",(function(){return Ke})),a.d(i,"hostsSelector",(function(){return Je})),a.d(i,"hostRiskScoreSelector",(function(){return Ye})),a.d(i,"hostRiskScoreSeverityFilterSelector",(function(){return Xe})),a.d(i,"uncommonProcessesSelector",(function(){return et})),a.d(i,"hostsAnomaliesJobIdFilterSelector",(function(){return tt})),a.d(i,"hostsAnomaliesIntervalSelector",(function(){return at}));var r=a(2),s=a.n(r),o=a(77),l=a(4),c=a(48),u=a(68),d=a(63),p=a(144),m=a(956),f=a(526),b=a(266),g=a(122),y=a(164),h=a(110),v=a(118),E=a(121),x=a(116),j=a(1508),S=a(205),O=a(238),k=a(49),w=a(136),T=a.n(w),I=a(9),C=a(202);const M=Object(r.memo)((({location:{pathname:e,search:t},history:a,match:{params:{detailName:n,tabName:i,flowTarget:s}},pageName:o,state:l})=>{const[c,u]=Object(r.useState)(!0),[d,p]=Object(C.a)();return Object(r.useEffect)((()=>{c&&""!==t?(p({type:"updateSearch",search:t}),u(!1)):""!==t&&t!==d.search&&p({type:"updateSearch",search:t})}),[t]),Object(r.useEffect)((()=>{if(!o||d.pathName===e&&T()(l,d.state))return;const r={detailName:n,flowTarget:s,history:a,pageName:o,pathName:e,search:t,state:l,tabName:i};if(c&&null==n)return p({type:"updateRouteWithOutSearch",route:Object(I.omit)(r,"search")}),void u(!1);p({type:"updateRoute",route:r})}),[e,t,o,n,i,s,l]),null}));M.displayName="SpyRouteComponent";const _=Object(k.withRouter)(M);var A=a(45),F=a(112),P=a(129),D=a(14);const N=(e,t)=>{const a=Object(c.useDispatch)(),{formatUrl:n}=Object(y.l)(P.a.timelines),i=Object(F.b)(v.b.selectInsertTimeline),s=Object(r.useCallback)(((a,i,r)=>{let s=`[${a}](${n(Object(y.k)(null!=i?i:"",r),{absolute:!0,skipSearch:!0})})`;Object(A.isEmpty)(e)||(s=`${e} ${s}`),t(s)}),[e,t,n]);return Object(r.useEffect)((()=>{null!=i&&null!=e&&(a(v.a.showTimeline({id:i.timelineId,show:!1})),s(i.timelineTitle,i.timelineSavedObjectId,i.graphEventId),a(Object(D.setInsertTimeline)(null)))}),[i,a,s,e]),{handleOnTimelineChange:s}};var R=a(747),L=a(745),B=a(298),z=a(297),q=a(755);const $=e=>{const{selectedPatterns:t}=Object(E.d)(x.SourcererScopeName.detections),a=Object(r.useMemo)((()=>Object(q.a)(e)),[e]),{loading:n,data:i}=Object(B.a)({query:a,indexName:t[0],queryName:z.a.CASES});return[n,Object(r.useMemo)((()=>{var e;return null!==(e=null==i?void 0:i.hits.hits.reduce(((e,{_id:t,_index:a,_source:n})=>({...e,[t]:{...Object(q.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}})),{}))&&void 0!==e?e:{}}),[null==i?void 0:i.hits.hits])]},V=()=>{const{browserFields:e,runtimeMappings:t}=Object(E.d)(x.SourcererScopeName.detections);return s.a.createElement(L.a,{browserFields:e,entityType:"events",isFlyoutView:!0,runtimeMappings:t,scopeId:g.c.casePage})},U=()=>{const{cases:e}=Object(h.i)().services,{getAppUrl:t,navigateTo:a}=Object(h.k)(),n=e.helpers.canUseCases([l.i]),i=Object(c.useDispatch)(),{formatUrl:o,search:E}=Object(y.l)(l.yc.rules),{openFlyout:x}=Object(p.d)(),[k]=Object(d.useUiSetting$)(l.nb),w=Object(r.useCallback)((e=>o(Object(y.h)(null!=e?e:"",E))),[o,E]),T=Object(r.useCallback)(((e,t)=>{k?x({right:{id:m.a,params:{id:e,indexName:t,scopeId:g.c.casePage}}}):i(v.a.toggleDetailPanel({panelView:"eventDetail",id:g.c.casePage,params:{eventId:e,indexName:t}}))}),[i,k,x]),I=Object(r.useCallback)((()=>{i(v.a.createTimeline({id:g.c.casePage,columns:[],dataViewId:null,indexNames:[],expandedDetail:{},show:!1}))}),[i]),C=Object(r.useRef)(null),{activeStep:M,endTourStep:A,isTourShown:F}=Object(f.b)(),P=Object(r.useMemo)((()=>M===b.a.viewCase&&F(b.b.alertsCases)),[M,F]);return Object(r.useEffect)((()=>{P&&A(b.b.alertsCases)}),[A,P]),s.a.createElement(S.a,{noPadding:!0},s.a.createElement(j.a.Provider,{value:C},e.ui.getCases({basePath:l.s,owner:[l.i],features:{metrics:[u.CaseMetricsFeature.ALERTS_COUNT,u.CaseMetricsFeature.ALERTS_USERS,u.CaseMetricsFeature.ALERTS_HOSTS,u.CaseMetricsFeature.CONNECTORS,u.CaseMetricsFeature.LIFESPAN],alerts:{isExperimental:!1}},refreshRef:C,onComponentInitialized:I,actionsNavigation:{href:e=>t({path:Object(O.d)({name:"endpointActivityLog",selected_endpoint:e})}),onClick:(e,t)=>(t&&t.preventDefault(),a({path:Object(O.d)({name:"endpointActivityLog",selected_endpoint:e})}))},ruleDetailsNavigation:{href:w,onClick:async(e,t)=>(t&&t.preventDefault(),a({deepLinkId:l.yc.rules,path:Object(y.h)(null!=e?e:"")}))},showAlertDetails:T,timelineIntegration:{editor_plugins:{parsingPlugin:R.a,processingPluginRenderer:R.c,uiPlugin:R.b},hooks:{useInsertTimeline:N},ui:{renderTimelineDetailsPanel:V}},useFetchAlertData:$,permissions:n})),s.a.createElement(_,{pageName:l.yc.case}))},H=s.a.memo(U),Q=({children:e,...t})=>{const{services:{securityLayout:{getPluginWrapper:a}}}=Object(h.i)(),n=a();return s.a.createElement(n,t,e)},G=[{path:l.s,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:"case"},s.a.createElement(H,null)))}];var W=a(124),Z=a(587),K=a(246),J=a(434),Y=a(5);const X=Y.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.tooltip",{defaultMessage:"Unable to update alerts"});var ee=a(17),te=a(44),ae=a.n(te),ne=a(66);const ie="filter-group__items",re="filter-group__loading",se="filter-group__add-control",oe="filter-group__save",le="filter-group__save-popover",ce="filter-group--changed-banner",ue="filter-group__discard",de={BTN:"filter-group__context",MENU:"filter-group__context-menu",RESET:"filter-group__context--reset",EDIT:"filter-group__context--edit",DISCARD:"filter-group__context--discard"},pe="filter-popover-button-assignees",me={hideExclude:!0,hideSort:!0,hidePanelTitles:!0,placeholder:"",ignoreParentSettings:{ignoreValidations:!0}};var fe=a(1494),be=a(18),ge=a(317);const ye=Object(r.memo)((({assignedUserIds:e,onSelectionChange:t})=>{const a=Object(be.b)().isPlatinumPlus(),n=Object(ge.b)("alert_assignments"),[i,o]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>o((e=>!e))),[]),[c,u]=Object(r.useState)(e),d=Object(r.useCallback)((e=>{u(e),null==t||t(e)}),[t]);return s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(fe.a,{assignedUserIds:e,showUnassignedOption:!0,button:s.a.createElement(ee.EuiToolTip,{position:"bottom",content:null!=n?n:Y.i18n.translate("xpack.securitySolution.filtersGroup.assignees.popoverTooltip",{defaultMessage:"Filter by assignee"})},s.a.createElement(ee.EuiFilterButton,{"data-test-subj":pe,iconType:"arrowDown",badgeColor:"subdued",disabled:!a,onClick:l,isSelected:i,hasActiveFilters:c.length>0,numActiveFilters:c.length},Y.i18n.translate("xpack.securitySolution.filtersGroup.assignees.buttonTitle",{defaultMessage:"Assignees"}))),isPopoverOpen:i,closePopover:l,onSelectionChange:d}))}));ye.displayName="FilterByAssigneesPopover";var he=a(1313),ve=a(130),Ee=a(119),xe=a(147),je=a(395),Se=a(1402);const Oe=ae.a.header.withConfig({displayName:"FiltersGlobalContainer",componentId:"sc-sjn739-0"})(["display:",";"],(({show:e})=>e?"block":"none"));Oe.displayName="FiltersGlobalContainer";const ke=s.a.memo((({children:e,show:t=!0})=>{const{globalKQLHeaderPortalNode:a}=Object(Se.a)();return s.a.createElement(je.a,{node:a},s.a.createElement(ee.EuiPanel,{borderRadius:"none",color:"subdued",paddingSize:"none"},s.a.createElement(Oe,{"data-test-subj":"filters-global-container",show:t},e)))}));ke.displayName="FiltersGlobal";var we=a(237),Te=a(448),Ie=a(3),Ce=a(87),Me=a(138),_e=a(360),Ae=a(57),Fe=a(361);const Pe=e=>e.query,De=e=>e.savedQuery;var Ne=a(329),Re=a(26);const Le=a.n(Re)()("x-pack/security_solution/local/hosts"),Be=Le("UPDATE_HOST_TABLE_ACTIVE_PAGE"),ze=Le("SET_HOST_TABLES_ACTIVE_PAGE_TO_ZERO"),qe=Le("SET_HOST_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),$e=Le("UPDATE_HOST_TABLE_LIMIT"),Ve=Le("UPDATE_HOSTS_SORT"),Ue=Le("UPDATE_HOST_RISK_SCORE_SORT"),He=Le("UPDATE_HOST_RISK_SCORE_SEVERITY"),Qe=Le("UPDATE_HOSTS_ANOMALIES_JOB_ID_FILTER"),Ge=Le("UPDATE_HOSTS_ANOMALIES_INTERVAL");var We=a(230);const Ze=(e,t)=>Object(A.get)(t,e.hosts),Ke=()=>Object(Ae.createSelector)(Ze,(e=>e.queries.authentications)),Je=()=>Object(Ae.createSelector)(Ze,(e=>e.queries[We.HostsTableType.hosts])),Ye=()=>Object(Ae.createSelector)(Ze,(e=>e.queries[We.HostsTableType.risk])),Xe=()=>Object(Ae.createSelector)(Ze,(e=>e.queries[We.HostsTableType.risk].severitySelection)),et=()=>Object(Ae.createSelector)(Ze,(e=>e.queries.uncommonProcesses)),tt=()=>Object(Ae.createSelector)(Ze,(e=>e.queries[We.HostsTableType.anomalies].jobIdSelection)),at=()=>Object(Ae.createSelector)(Ze,(e=>e.queries[We.HostsTableType.anomalies].intervalSelection));var nt=a(187),it=a(227),rt=a(125),st=a(409);const ot=e=>({...e.page.queries,[We.HostsTableType.authentications]:{...e.page.queries[We.HostsTableType.authentications],activePage:st.a},[We.HostsTableType.hosts]:{...e.page.queries[We.HostsTableType.hosts],activePage:st.a},[We.HostsTableType.events]:{...e.page.queries[We.HostsTableType.events],activePage:st.a},[We.HostsTableType.uncommonProcesses]:{...e.page.queries[We.HostsTableType.uncommonProcesses],activePage:st.a}}),lt=e=>({...e.details.queries,[We.HostsTableType.authentications]:{...e.details.queries[We.HostsTableType.authentications],activePage:st.a},[We.HostsTableType.hosts]:{...e.details.queries[We.HostsTableType.hosts],activePage:st.a},[We.HostsTableType.events]:{...e.details.queries[We.HostsTableType.events],activePage:st.a},[We.HostsTableType.uncommonProcesses]:{...e.details.queries[We.HostsTableType.uncommonProcesses],activePage:st.a}}),ct=(e,t)=>e.length>0?[{query:{bool:{should:e.map((e=>({match_phrase:{[t===rt.v.user?rt.w.userRisk:rt.w.hostRisk]:{query:e}}})))}},meta:{alias:null,disabled:!1,negate:!1}}]:[],ut={page:{queries:{[We.HostsTableType.authentications]:{activePage:st.a,limit:st.b},[We.HostsTableType.hosts]:{activePage:st.a,limit:st.b,direction:rt.b.desc,sortField:it.a.lastSeen},[We.HostsTableType.events]:{activePage:st.a,limit:st.b},[We.HostsTableType.uncommonProcesses]:{activePage:st.a,limit:st.b},[We.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[We.HostsTableType.risk]:{activePage:st.a,limit:st.b,sort:{field:rt.w.hostRiskScore,direction:rt.b.desc},severitySelection:[]},[We.HostsTableType.sessions]:{activePage:st.a,limit:st.b}}},details:{queries:{[We.HostsTableType.authentications]:{activePage:st.a,limit:st.b},[We.HostsTableType.hosts]:{activePage:st.a,direction:rt.b.desc,limit:st.b,sortField:it.a.lastSeen},[We.HostsTableType.events]:{activePage:st.a,limit:st.b},[We.HostsTableType.uncommonProcesses]:{activePage:st.a,limit:st.b},[We.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[We.HostsTableType.risk]:{activePage:st.a,limit:st.b,sort:{field:rt.w.hostRiskScore,direction:rt.b.desc},severitySelection:[]},[We.HostsTableType.sessions]:{activePage:st.a,limit:st.b}}}},dt=Object(nt.reducerWithInitialState)(ut).case(ze,(e=>({...e,page:{...e.page,queries:ot(e)},details:{...e.details,queries:lt(e)}}))).case(qe,(e=>({...e,details:{...e.details,queries:lt(e)}}))).case(Be,((e,{activePage:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],activePage:t}}}}))).case($e,((e,{limit:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],limit:t}}}}))).case(Ve,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[We.HostsTableType.hosts]:{...e[a].queries[We.HostsTableType.hosts],direction:t.direction,sortField:t.field,activePage:st.a}}}}))).case(Ue,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[We.HostsTableType.risk]:{...e[a].queries[We.HostsTableType.risk],sort:t}}}}))).case(He,((e,{severitySelection:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[We.HostsTableType.risk]:{...e[a].queries[We.HostsTableType.risk],severitySelection:t,activePage:st.a}}}}))).case(Qe,((e,{jobIds:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[We.HostsTableType.anomalies]:{...e[a].queries[We.HostsTableType.anomalies],jobIdSelection:t}}}}))).case(Ge,((e,{interval:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[We.HostsTableType.anomalies]:{...e[a].queries[We.HostsTableType.anomalies],intervalSelection:t}}}}))).build();var pt=a(308),mt=a(128),ft=a(157),bt=a(218);const gt=Object(r.memo)((({end:e,filterQuery:t,fromStr:a,hideFilterBar:i=!1,hideQueryInput:o=!1,id:l,isLoading:u=!1,pollForSignalIndex:d,queries:p,savedQuery:m,setSavedQuery:f,setSearchBarFilter:b,sourcererDataView:g,start:y,toStr:v,updateSearch:E,dataTestSubj:x})=>{const{data:{query:{timefilter:{timefilter:j},filterManager:S}},unifiedSearch:{ui:{SearchBar:O}},fieldFormats:k}=Object(h.i)().services,w=Object(c.useDispatch)(),I=Object(r.useCallback)((()=>{w(Ne.c.setUsersTablesActivePageToZero()),w(n.setHostTablesActivePageToZero()),w(pt.b.setNetworkTablesActivePageToZero())}),[w]);(()=>{const e=Object(ft.d)(bt.a.savedQuery),t=Object(ft.d)(bt.a.appQuery),a=Object(ft.d)(bt.a.filters),n=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),i=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),s=Object(r.useMemo)((()=>mt.d.globalSavedQuerySelector()),[]),o=Object(c.useSelector)(n),l=Object(c.useSelector)(i),u=Object(c.useSelector)(s);Object(r.useEffect)((()=>{var n;null!=u&&""!==u.id?(e(null!==(n=null==u?void 0:u.id)&&void 0!==n?n:null),t(null),a(null)):(e(null),t(Object(A.isEmpty)(o.query)?null:o),a(Object(A.isEmpty)(l)?null:l))}),[u,o,l,e,t,a])})(),(()=>{const e=Object(ft.d)(bt.a.timerange),t=Object(r.useMemo)((()=>Me.d.inputsSelector()),[]),a=Object(c.useSelector)(t),n=Object(ve.a)("socTrendsEnabled"),{linkTo:i,timerange:s}=a.global,{linkTo:o,timerange:l}=a.timeline,u=Object(r.useMemo)((()=>{if(n&&a.socTrends){const{linkTo:e,timerange:t}=a.socTrends;return{socTrends:{[bt.a.timerange]:t,linkTo:e}}}return{}}),[a.socTrends,n]);Object(r.useEffect)((()=>{e({global:{[bt.a.timerange]:s,linkTo:i},timeline:{[bt.a.timerange]:l,linkTo:o},...u})}),[e,i,s,o,l,u])})(),Object(r.useEffect)((()=>{null!=a&&null!=v?j.setTime({from:a,to:v}):null!=y&&null!=e&&(I(),j.setTime({from:new Date(y).toISOString(),to:new Date(e).toISOString()}))}),[e,a,y,j,v,I]);const C=Object(r.useCallback)((n=>{null!=d&&d();const i=n.dateRange.from.includes("now")||n.dateRange.to.includes("now");let r={id:l,end:null!=v?v:new Date(e).toISOString(),start:null!=a?a:new Date(y).toISOString(),isInvalid:!1,isQuickSelection:i,updateTime:!1,filterManager:S,setTablesActivePageToZero:I},s=!1;(!i||a===n.dateRange.from&&v===n.dateRange.to)&&(i||y===Object(_e.c)(n.dateRange.from)&&e===Object(_e.c)(n.dateRange.to))||(s=!0,r.updateTime=!0,r.end=n.dateRange.to,r.start=n.dateRange.from),null==n.query||T()(n.query,t)||(s=!0,r=Object(Te.set)("query",n.query,r)),s||(i&&n.dateRange.to!==n.dateRange.from?(r.updateTime=!0,r.end=n.dateRange.to,r.start=n.dateRange.from):p.forEach((e=>e.refetch&&e.refetch()))),window.setTimeout((()=>E(r)),0)}),[l,d,v,e,a,y,S,t,p,E,I]),M=Object(r.useCallback)((e=>{e.dateRange.from.includes("now")||e.dateRange.to.includes("now")?E({id:l,end:e.dateRange.to,start:e.dateRange.from,isInvalid:!1,isQuickSelection:!0,updateTime:!0,filterManager:S,setTablesActivePageToZero:I}):p.forEach((e=>e.refetch&&e.refetch()))}),[E,l,S,p,I]),_=Object(r.useCallback)((e=>{f({id:l,savedQuery:e})}),[l,f]),F=Object(r.useCallback)((t=>{const n=!!t.attributes.timefilter&&(t.attributes.timefilter.from.includes("now")||t.attributes.timefilter.to.includes("now"));let i={id:l,filters:t.attributes.filters||[],end:null!=v?v:new Date(e).toISOString(),start:null!=a?a:new Date(y).toISOString(),isInvalid:!1,isQuickSelection:n,updateTime:!1,filterManager:S,setTablesActivePageToZero:I};t.attributes.timefilter&&(i.end=t.attributes.timefilter?t.attributes.timefilter.to:i.end,i.start=t.attributes.timefilter?t.attributes.timefilter.from:i.start,i.updateTime=!0),i=Object(Te.set)("query",t.attributes.query,i),i=Object(Te.set)("savedQuery",t,i),E(i)}),[l,v,e,a,y,S,E,I]),P=Object(r.useCallback)((()=>{null!=m&&E({id:l,filters:[],end:null!=v?v:new Date(e).toISOString(),start:null!=a?a:new Date(y).toISOString(),isInvalid:!1,isQuickSelection:!1,updateTime:!1,query:{query:"",language:m.attributes.query.language},resetSavedQuery:!0,savedQuery:void 0,filterManager:S,setTablesActivePageToZero:I})}),[m,E,l,v,e,a,y,S,I]);Object(r.useEffect)((()=>{let e=!0;const t=new Ie.Subscription;return t.add(S.getUpdates$().subscribe({next:()=>{if(e){const e=S.getFilters();b({id:l,filters:e}),I()}}})),()=>{e=!1,t.unsubscribe()}}),[]);const D=Object(r.useMemo)((()=>null!=g?[new Ce.DataView({spec:g,fieldFormats:k})]:null),[g,k]),N=Object(r.useCallback)((({query:e,dateRange:t})=>{const a=t.from.includes("now")||t.to.includes("now");E({end:t.to,filterManager:S,id:l,isInvalid:!1,isQuickSelection:a,query:e,setTablesActivePageToZero:I,start:t.from,updateTime:!0})}),[S,l,I,E]);return D?s.a.createElement("div",{"data-test-subj":`${l}DatePicker`},s.a.createElement(O,{appName:"siem",isLoading:u,indexPatterns:D,query:t,onClearSavedQuery:P,onQuerySubmit:C,onRefresh:M,onSaved:_,onTimeRangeChange:N,onSavedQueryUpdated:F,savedQuery:m,showFilterBar:!i,showDatePicker:!0,showQueryInput:!o,saveQueryMenuVisibility:"allowed_by_app_privilege",dataTestSubj:x})):null}),((e,t)=>e.end===t.end&&e.filterQuery===t.filterQuery&&e.fromStr===t.fromStr&&T()(e.sourcererDataView,t.sourcererDataView)&&e.id===t.id&&e.isLoading===t.isLoading&&e.savedQuery===t.savedQuery&&e.setSavedQuery===t.setSavedQuery&&e.setSearchBarFilter===t.setSearchBarFilter&&e.start===t.start&&e.toStr===t.toStr&&e.updateSearch===t.updateSearch&&e.dataTestSubj===t.dataTestSubj&&T()(e.queries,t.queries)));gt.displayName="SiemSearchBar";const yt=e=>({end:t,filters:a,id:n,isQuickSelection:i,query:r,resetSavedQuery:s,savedQuery:o,start:l,timelineId:c,updateTime:u=!1,filterManager:d,setTablesActivePageToZero:p})=>{if(u){const a=Object(_e.c)(l);let r=Object(_e.c)(t,{roundUp:!0});i?e(t===l?Me.b.setAbsoluteRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:r}):Me.b.setRelativeRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:r})):(r=Object(_e.c)(t),e(Me.b.setAbsoluteRangeDatePicker({id:n,from:Object(_e.c)(l),to:Object(_e.c)(t)}))),null!=c&&e(v.a.updateRange({id:c,start:a,end:r}))}null!=r&&e(Me.b.setFilterQuery({id:n,...r})),null!=a&&d.setFilters(a),(null!=o||s)&&e(Me.b.setSavedQuery({id:n,savedQuery:o})),p()},ht=Object(c.connect)((()=>{const e=Object(Fe.b)(),t=Object(Fe.c)(),a=Object(Fe.d)(),n=Object(Fe.h)(),i=Object(Fe.i)(),r=Object(Fe.j)(),s=Object(Ae.createSelector)(Pe,(e=>e)),o=Object(Ae.createSelector)(De,(e=>e));return(l,{id:c})=>{const u=Object(A.getOr)({},`inputs.${c}`,l);return{end:e(u),fromStr:t(u),filterQuery:s(u),isLoading:a(u),queries:n(l,c),savedQuery:o(u),start:i(u),toStr:r(u)}}}),(e=>({updateSearch:yt(e),setSavedQuery:({id:t,savedQuery:a})=>e(Me.b.setSavedQuery({id:t,savedQuery:a})),setSearchBarFilter:({id:t,filters:a})=>e(Me.b.setSearchBarFilter({id:t,filters:a}))})))(gt);var vt=a(158);const Et=Y.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),xt=Y.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),jt=Y.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),St=()=>{const[e,t]=Object(r.useState)(!0),a=Object(r.useCallback)((()=>t(!1)),[t]);return e?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{title:Et,color:"danger",iconType:"warning"},s.a.createElement("p",null,xt),s.a.createElement(ee.EuiButton,{color:"danger",onClick:a},jt)),s.a.createElement(ee.EuiSpacer,{size:"l"})):null},Ot=Object(r.memo)(St);var kt=a(213),wt=a(867),Tt=a(923);const It=({needsListsIndex:e,needsSignalsIndex:t})=>{const a=Object(h.i)().services.docLinks,n=Object(r.useMemo)((()=>({detections:{icon:"documents",label:Tt.c,url:`${a.links.siem.detectionsReq}`,target:"_blank"}})),[a]),i=((e,t)=>t&&e?Tt.f(Tt.h):t?Tt.f(Tt.i):e?Tt.f(Tt.g):Tt.f(""))(e,t);return s.a.createElement(wt.a,{actions:n,"data-test-subj":"no_index",message:i,title:Tt.j})},Ct=s.a.memo(It);var Mt=a(114),_t=a(387);const At=Y.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),Ft=Y.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var Pt=a(117),Dt=a(135);const Nt=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},Rt=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},Lt=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},Bt=()=>{const[e,t]=Object(r.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(Dt.a)();return Object(r.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:i}}=a.result;t({isAuthenticated:e,canReadIndex:Rt(n)&&Rt(i),canManageIndex:Nt(n)&&Nt(i),canWriteIndex:Lt(n)&&Lt(i)})}}),[a.result]),Object(r.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}},zt=()=>{var e,t;const{createIndex:a,indexExists:n,loading:i,error:s}=(()=>{const[e,t]=Object(r.useState)(null),[a,n]=Object(r.useState)(null),{lists:i}=Object(h.i)().services,s=Object(h.h)(),{addError:o}=Object(Pt.a)(),{canReadIndex:l,canManageIndex:c,canWriteIndex:u}=Bt(),{loading:d,start:p,...m}=Object(_t.k)(),{loading:f,start:b,...g}=Object(_t.d)(),y=d||f,v=Object(r.useCallback)((()=>{i&&l&&c&&p({http:s})}),[s,i,p,l,c]),E=Object(r.useCallback)((()=>{i&&c&&u&&b({http:s})}),[b,s,i,c,u]);return Object(r.useEffect)((()=>{d||a||null!==e||v()}),[a,e,v,d]),Object(r.useEffect)((()=>{null!=m.result&&t(m.result.list_index&&m.result.list_item_index)}),[m.result]),Object(r.useEffect)((()=>{null!=g.result&&v()}),[g.result,v]),Object(r.useEffect)((()=>{const e=m.error;null!=e&&(Object(Mt.v)(e)&&404===e.body.status_code?t(!1):(n(e),o(e,{title:At})))}),[o,m.error]),Object(r.useEffect)((()=>{const e=g.error;null!=e&&(n(e),o(e,{title:Ft}))}),[o,g.error]),{createIndex:E,error:a,indexExists:e,loading:y}})(),{canManageIndex:o,canWriteIndex:l,loading:c}=Bt(),{detectionEnginePrivileges:u}=Object(Dt.a)(),{lists:d}=Object(h.i)().services,p=null!==(e=null===(t=u.result)||void 0===t?void 0:t.cluster.manage)&&void 0!==e?e:null,m=null!=d,f=i||c,b=!1===n,g=!m||b&&(!1===o||!0===o&&null!=s),y=o&&p;return Object(r.useEffect)((()=>{b&&y&&a()}),[a,b,y]),{canManageIndex:o,canWriteIndex:l,enabled:m,loading:f,needsConfiguration:g,needsIndex:b,canCreateIndex:y}},qt=s.a.memo((()=>{const e=Object(h.i)().services.docLinks,t=Object(r.useMemo)((()=>({detectionUnauthenticated:{icon:"documents",label:Tt.c,url:`${e.links.siem.detectionsReq}`,target:"_blank"}})),[e]);return s.a.createElement(wt.a,{actions:t,message:Tt.l,"data-test-subj":"no_index",title:Tt.m})}));qt.displayName="DetectionEngineUserUnauthenticated";var $t=a(137),Vt=a(189);const Ut=ae.a.div.withConfig({displayName:"Display",componentId:"sc-1f84jld-0"})(["",";"],(({show:e})=>e?"":"display: none;"));Ut.displayName="Display";var Ht=a(145),Qt=a(400),Gt=a(561);const Wt=({category:e,page:t,setting:a})=>`${t}.${e}.${a}`,Zt=e=>"string"!=typeof e||Object(A.isEmpty)(e.trim()),Kt="alerts",Jt="table",Yt="treemap",Xt="stack-by-0",ea="stack-by-1",ta="view";var aa=a(432);const na=Y.i18n.translate("xpack.securitySolution.components.chartSelect.selectAChartAriaLabel",{defaultMessage:"Select a chart"}),ia=Y.i18n.translate("xpack.securitySolution.components.chartSelect.tableOption",{defaultMessage:"Table"}),ra=Y.i18n.translate("xpack.securitySolution.components.chartSelect.trendOption",{defaultMessage:"Trend"}),sa=Y.i18n.translate("xpack.securitySolution.components.chartSelect.treemapOption",{defaultMessage:"Treemap"}),oa=Y.i18n.translate("xpack.securitySolution.components.chartSelect.chartsOption",{defaultMessage:"Charts"}),la=Y.i18n.translate("xpack.securitySolution.components.chartSelect.tableOptionTitle",{defaultMessage:"Counts"}),ca=Y.i18n.translate("xpack.securitySolution.components.chartSelect.chartsOptionTitle",{defaultMessage:"Summary"}),ua=Y.i18n.translate("xpack.securitySolution.components.chartSelect.legendTitle",{defaultMessage:"Select a tab"}),da="table",pa="trend",ma="treemap",fa="charts",ba=e=>{const t={"data-test-subj":e,icon:"visTable",name:ia};switch(e){case da:return t;case pa:return{"data-test-subj":e,icon:"visBarVerticalStacked",name:ra};case ma:return{"data-test-subj":e,icon:"grid",name:sa};case fa:return{"data-test-subj":e,icon:"visPie",name:oa};default:return t}};var ga=a(159);const ya=Y.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.ariaLabel",{defaultMessage:"Chart settings"}),ha=({initialPanelId:e,isPopoverOpen:t,panels:a,setIsPopoverOpen:n})=>{const i=Object(r.useCallback)((()=>n((e=>!e))),[n]),o=Object(r.useCallback)((()=>n(!1)),[n]),l=Object(r.useMemo)((()=>s.a.createElement(ee.EuiButtonIcon,{"aria-label":ya,color:"text",iconType:"boxesHorizontal",onClick:i,size:"xs"})),[i]);return s.a.createElement(ee.EuiPopover,{anchorPosition:"downCenter",button:l,className:ga.a,closePopover:o,isOpen:t,panelPaddingSize:"none"},s.a.createElement(ee.EuiContextMenu,{initialPanelId:e,panels:a}))};ha.displayName="ChartSettingsPopoverComponent";const va=s.a.memo(ha);var Ea=a(465),xa=a(727);const ja="default-initial-panel",Sa=({defaultStackByField:e,defaultStackByField1:t,onReset:a=A.noop,queryId:n,setStackBy:i,setStackByField1:o})=>{const l=Object(r.useCallback)((()=>{a(),i(e),null!=o&&o(t)}),[e,t,a,i,o]),{defaultInitialPanelId:c,defaultMenuItems:u,isPopoverOpen:d,setIsPopoverOpen:p}=(({onResetStackByFields:e,queryId:t})=>{const[a,n]=Object(r.useState)(!1),{handleClick:i}=Object(Ea.a)({queryId:t}),s=Object(r.useMemo)((()=>[{id:ja,items:[{icon:"inspect",name:xa.a,onClick:()=>{n(!1),i()}},{name:xa.b,onClick:()=>{n(!1),e()}}]}]),[i,e]);return{defaultInitialPanelId:ja,defaultMenuItems:s,isPopoverOpen:a,setIsPopoverOpen:n}})({onResetStackByFields:l,queryId:n});return s.a.createElement(va,{initialPanelId:c,isPopoverOpen:d,panels:u,setIsPopoverOpen:p})};Sa.displayName="ChartContextMenuComponent";const Oa=s.a.memo(Sa),ka=ae()(ee.EuiIcon).withConfig({displayName:"ChartTypeIcon",componentId:"sc-1h1vv4p-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),wa=["charts","trend","table","treemap"],Ta=({alertViewSelection:e,setAlertViewSelection:t})=>{const[a,n]=Object(r.useState)(!1),i=Object(r.useCallback)((()=>n(!1)),[]),o=Object(r.useCallback)((()=>n((e=>!e))),[]),l=Object(r.useMemo)((()=>{const t=ba(e);return s.a.createElement(ee.EuiButton,{"aria-label":na,className:"kbnToolbarButton",color:"text","data-test-subj":"chartSelect",iconSide:"right",iconType:"arrowDown",onClick:o},s.a.createElement(ka,{type:t.icon}),s.a.createElement("span",null,t.name))}),[e,o]),c=Object(ve.a)("alertsPageChartsEnabled"),u=Object(r.useMemo)((()=>wa.map((e=>(e=>{const t={id:fa,"data-test-subj":`chart-select-${fa}`,label:ca,value:fa};switch(e){case da:return{id:da,"data-test-subj":`chart-select-${da}`,label:la,value:da};case pa:return{id:pa,"data-test-subj":`chart-select-${pa}`,label:ra,value:pa};case ma:return{id:ma,"data-test-subj":`chart-select-${ma}`,label:sa,value:ma};default:return t}})(e)))),[]),d=Object(r.useMemo)((()=>(({alertViewSelection:e,closePopover:t,setAlertViewSelection:a,isAlertsPageChartsEnabled:n})=>[{id:0,items:[{...ba("table"),onClick:()=>{t(),a("table")}},{...ba("trend"),onClick:()=>{t(),a("trend")}},{...ba("treemap"),onClick:()=>{t(),a("treemap")}},...n?[{...ba("charts"),onClick:()=>{t(),a("charts")}}]:[]]}])({alertViewSelection:e,closePopover:i,setAlertViewSelection:t,isAlertsPageChartsEnabled:c})),[e,i,t,c]);return s.a.createElement(s.a.Fragment,null,c?s.a.createElement(ee.EuiButtonGroup,{name:"chart-select",legend:ua,options:u,idSelected:e,onChange:e=>t(e),buttonSize:"compressed",color:"primary","data-test-subj":"chart-select-tabs"}):s.a.createElement(ee.EuiPopover,{anchorPosition:"downLeft",button:l,closePopover:i,isOpen:a,panelPaddingSize:"none"},s.a.createElement(ee.EuiContextMenu,{initialPanelId:0,panels:d})))};Ta.displayName="ChartSelectComponent";const Ia=s.a.memo(Ta);var Ca=a(142),Ma=a(51);const _a=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.chartTitle",{defaultMessage:"Top alerts by"}),Aa=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.noItemsFoundMessage",{defaultMessage:"No items found"}),Fa=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.otherGroup",{defaultMessage:"Other"}),Pa=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.hostNameLabel",{defaultMessage:"host"}),Da=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.userNameLabel",{defaultMessage:"user"}),Na=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.destinationLabel",{defaultMessage:"destination"}),Ra=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.sourceLabel",{defaultMessage:"source"}),La=e=>e>0&&e<.01?"<1%":`${(Math.round(1e3*e)/10).toString()}%`,Ba={"host.name":Pa,"user.name":Da,"source.ip":Ra,"destination.ip":Na};var za=a(53),qa=a(398),$a=a(206);const Va=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.criticalLabel",{defaultMessage:"Critical"}),Ua=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.highLabel",{defaultMessage:"High"}),Ha=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.mediumLabel",{defaultMessage:"Medium"}),Qa=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.lowLabel",{defaultMessage:"Low"}),Ga=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.status.acknowledged",{defaultMessage:"Acknowledged"}),Wa=Y.i18n.translate("xpack.securitySolution.detectionResponse.status.open",{defaultMessage:"Open"}),Za=Y.i18n.translate("xpack.securitySolution.detectionResponse.status.closed",{defaultMessage:"Closed"}),Ka=Y.i18n.translate("xpack.securitySolution.detectionResponse.status.inProgress",{defaultMessage:"In progress"}),Ja=Y.i18n.translate("xpack.securitySolution.detectionResponse.alerts",{defaultMessage:"Alerts"}),Ya=Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsBySeverity",{defaultMessage:"Alerts by Severity"}),Xa=(Y.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),Y.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),Y.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTitle",{defaultMessage:"Cases"})),en=Y.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTooltip",{defaultMessage:"The cases table is not filterable via the SIEM global KQL search."}),tn=Y.i18n.translate("xpack.securitySolution.detectionResponse.viewCases",{defaultMessage:"View cases"}),an=Y.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsSectionTitle",{defaultMessage:"Open alerts by rule"}),nn=Y.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsSectionTitle",{defaultMessage:"Hosts by alert severity"}),rn=Y.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsSectionTitle",{defaultMessage:"Users by alert severity"}),sn=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTitle",{defaultMessage:"Recently created cases"}),on=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTooltip",{defaultMessage:"The recently created cases table is not filterable via the SIEM global KQL search."}),ln=Y.i18n.translate("xpack.securitySolution.detectionResponse.noRuleAlerts",{defaultMessage:"No alerts to display"}),cn=Y.i18n.translate("xpack.securitySolution.detectionResponse.noRecentCases",{defaultMessage:"No cases to display"}),un=Y.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnRuleName",{defaultMessage:"Rule name"}),dn=Y.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnLastAlert",{defaultMessage:"Last alert"}),pn=Y.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnAlertCount",{defaultMessage:"Alert count"}),mn=Y.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnSeverity",{defaultMessage:"Severity"}),fn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openRuleDetailTooltip",{defaultMessage:"Open rule detail"}),bn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openCaseDetailTooltip",{defaultMessage:"Open case detail"}),gn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openHostDetailTooltip",{defaultMessage:"Open host detail"}),yn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openUserDetailTooltip",{defaultMessage:"Open user detail"}),hn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openAllAlertsButton",{defaultMessage:"View all open alerts"}),vn=Y.i18n.translate("xpack.securitySolution.detectionResponse.viewRecentCases",{defaultMessage:"View recent cases"}),En=Y.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsHostName",{defaultMessage:"Host name"}),xn=Y.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsUserName",{defaultMessage:"User name"}),jn=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnName",{defaultMessage:"Name"}),Sn=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnTime",{defaultMessage:"Time"}),On=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnCreatedBy",{defaultMessage:"Created by"}),kn=Y.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnStatus",{defaultMessage:"Status"}),wn=Y.i18n.translate("xpack.securitySolution.detectionResponse.errorMessage",{defaultMessage:"Error fetching case data"}),Tn=Y.i18n.translate("xpack.securitySolution.detectionResponse.hostSectionTooltip",{defaultMessage:"Maximum of 100 hosts. Please consult Alerts page for further information."}),In=Y.i18n.translate("xpack.securitySolution.detectionResponse.userSectionTooltip",{defaultMessage:"Maximum of 100 users. Please consult Alerts page for further information."}),Cn=Y.i18n.translate("xpack.securitySolution.detectionResponse.investigateInTimeline",{defaultMessage:"Investigate in Timeline"}),Mn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openInAlertsSeverity",{defaultMessage:"Severity"}),_n=Y.i18n.translate("xpack.securitySolution.detectionResponse.openInAlertsStatus",{defaultMessage:"Status"}),An=Y.i18n.translate("xpack.securitySolution.detectionResponse.openInAlertsRuleName",{defaultMessage:"Rule name"}),Fn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openInAlertsHostName",{defaultMessage:"Host name"}),Pn=Y.i18n.translate("xpack.securitySolution.detectionResponse.openInAlertsUserName",{defaultMessage:"Username"}),Dn={critical:Va,high:Ua,medium:Ha,low:Qa},Nn=({additionalFilters:e=[],from:t,to:a,entityFilter:n})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},...n?[{term:{[n.field]:n.value}}]:[]]}},aggs:{alertsByStatus:{terms:{field:"kibana.alert.workflow_status"},aggs:{statusBySeverity:{terms:{field:"kibana.alert.severity"}}}}}});var Rn=a(597),Ln=a(668);const Bn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.severity.severityDonutTitle",{defaultMessage:"Severity levels"}),zn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.severity.unknown",{defaultMessage:"Unknown"}),qn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.severity.severityTableLevelColumn",{defaultMessage:"Levels"}),$n=e=>{var t;return null!==(t=Ln.b[e.toLocaleLowerCase()])&&void 0!==t?t:Rn.b},Vn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.alertTypeChartTitle",{defaultMessage:"Alerts by type"}),Un=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.alertRuleChartTitle",{defaultMessage:"Alerts by name"}),Hn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.typeColumn",{defaultMessage:"Type"}),Qn=(Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.preventions",{defaultMessage:"Preventions"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.detections",{defaultMessage:"Detections"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.prevention",{defaultMessage:"Prevention"})),Gn=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByType.detection",{defaultMessage:"Detection"}),Wn={Detection:"#D36086",Prevention:"#54B399"},Zn={Detection:Gn,Prevention:Qn},Kn=e=>(e=>Object(I.has)(e,"aggregations.statusBySeverity"))(e)?(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.statusBySeverity)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?[]:i.map((e=>{var t;return{key:e.key,value:e.doc_count,label:null!==(t=Dn[e.key])&&void 0!==t?t:zn}}))})(e):(e=>Object(I.has)(e,"aggregations.alertsByType"))(e)?(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByType)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?[]:i.flatMap((e=>{var t,a;const n=null!==(t=null===(a=e.ruleByEventType)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[];return((e,t,a)=>{const n=a.find((e=>"denied"===e.key));if(!n)return[{rule:e,type:"Detection",value:t,color:Wn.Detection}];const i=[];return n.doc_count<t&&i.push({rule:e,type:"Detection",value:t-n.doc_count,color:Wn.Detection}),i.push({rule:e,type:"Prevention",value:n.doc_count,color:Wn.Prevention}),i})(e.key,e.doc_count,n)}))})(e):(e=>Object(I.has)(e,"aggregations.alertsByRule"))(e)?(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByRule)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?[]:i.map((e=>({rule:e.key,type:"Detection",value:e.doc_count,color:Wn.Detection})))})(e):(e=>Object(I.has)(e,"aggregations.alertsByGrouping"))(e)?(e=>{var t,a,n,i,r,s,o,l,c;const u=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByGrouping)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[],d=null!==(i=null==e||null===(r=e.aggregations)||void 0===r||null===(s=r.missingFields)||void 0===s?void 0:s.doc_count)&&void 0!==i?i:0;if(0===u.length&&0===d)return[];const p=null!==(o=null==e||null===(l=e.aggregations)||void 0===l||null===(c=l.alertsByGrouping)||void 0===c?void 0:c.sum_other_doc_count)&&void 0!==o?o:0,m=u.reduce(((e,t)=>e+t.doc_count),0)+p+d,f=u.map((e=>({key:e.key,value:e.doc_count,percentage:e.doc_count/m,percentageLabel:La(e.doc_count/m),label:e.key})));return p>0&&f.push({key:"Other",value:p,percentage:p/m,percentageLabel:La(p/m),label:Fa}),d>0&&f.push({key:"-",value:d,percentage:d/m,percentageLabel:La(d/m),label:"-"}),f})(e):(e=>Object(I.has)(e,"aggregations.severities")&&Object(I.has)(e,"aggregations.topRule")&&Object(I.has)(e,"aggregations.topGrouping"))(e)?(e=>{var t,a,n,i,r,s,o,l,c,u,d,p,m;const f={rule:null,group:null,severities:[]};f.rule=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.topRule)||void 0===n||null===(i=n.buckets)||void 0===i||null===(r=i.at(0))||void 0===r?void 0:r.key)&&void 0!==t?t:null,f.group=null!==(s=null==e||null===(o=e.aggregations)||void 0===o||null===(l=o.topGrouping)||void 0===l||null===(c=l.buckets)||void 0===c||null===(u=c.at(0))||void 0===u?void 0:u.key)&&void 0!==s?s:null;const b=null!==(d=null==e||null===(p=e.aggregations)||void 0===p||null===(m=p.severities)||void 0===m?void 0:m.buckets)&&void 0!==d?d:[];return b.length>0?(f.severities=b.map((e=>{var t;return{key:e.key,value:e.doc_count,label:null!==(t=Dn[e.key])&&void 0!==t?t:zn}})),[f]):[]})(e):[],Jn=({additionalFilters:e=[],from:t,to:a,entityFilter:n,runtimeMappings:i,aggregations:r})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},...n?[{term:{[n.field]:n.value}}]:[]]}},aggs:r,runtime_mappings:i}),Yn=({aggregations:e,uniqueQueryId:t,entityFilter:a,query:n,filters:i,runtimeMappings:s,signalIndexName:o,skip:l=!1})=>{const{to:c,from:u,deleteQuery:d,setQuery:p}=Object(xe.a)(),[m,f]=Object(r.useState)(Date.now()),[b,g]=Object(r.useState)([]),y=Object(r.useMemo)((()=>{try{var e;return[Object(za.buildEsQuery)(void 0,null!=n?[n]:[],null!==(e=null==i?void 0:i.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[n,i]),{data:h,loading:v,refetch:E,request:x,response:j,setQuery:S}=Object(B.a)({query:Jn({from:u,to:c,entityFilter:a,additionalFilters:y,runtimeMappings:s,aggregations:e}),indexName:o,skip:l,queryName:z.a.COUNT});Object(r.useEffect)((()=>{S(Jn({from:u,to:c,entityFilter:a,additionalFilters:y,runtimeMappings:s,aggregations:e}))}),[S,u,c,a,y,s,e]),Object(r.useEffect)((()=>{g(null==h?[]:Kn(h)),f(Date.now())}),[h]);const O=Object(r.useCallback)((()=>{!l&&E&&E()}),[l,E]);return Object(qa.a)({deleteQuery:d,loading:v,response:j,setQuery:p,refetch:O,request:x,uniqueQueryId:t}),{items:b,isLoading:v,updatedAt:m}};var Xn=a(236);const ei=Y.i18n.translate("xpack.securitySolution.components.chartCollapse.topRule",{defaultMessage:"Top alerted rule: "}),ti=Y.i18n.translate("xpack.securitySolution.components.chartCollapse.topGroup",{defaultMessage:"Top alerted"}),ai=Y.i18n.translate("xpack.securitySolution.components.chartCollapse.noResultMessage",{defaultMessage:"None"}),ni=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-7qk19-0"})(["margin-top:",";@media only screen and (min-width:",");"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiBreakpoints.l)),ii=ae()(ee.EuiFlexItem).withConfig({displayName:"SeverityWrapper",componentId:"sc-7qk19-1"})(["min-width:380px;"]),ri=ae()(ee.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-7qk19-2"})(["border-left:1px solid ",";padding-left:",";max-width:250px;"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeL)),si=({groupBySelection:e,filters:t,query:a,signalIndexName:n,runtimeMappings:i})=>{const o=Object(r.useMemo)((()=>`detectioin-alerts-collapsed-chart-${Object(Ma.v4)()}`),[]),l=Object(r.useMemo)((()=>(e=>({severities:{terms:{field:Ca.X,min_doc_count:0}},topRule:{terms:{field:Ca.G,size:1}},topGrouping:{terms:{field:e,size:1}}}))(e)),[e]),{items:c,isLoading:u}=Yn({aggregations:l,filters:t,query:a,signalIndexName:n,runtimeMappings:i,uniqueQueryId:o}),d=Object(r.useMemo)((()=>(e=>null==e?void 0:e.every((e=>Object(I.has)(e,"rule")&&Object(I.has)(e,"group")&&Object(I.has)(e,"severities"))))(c)?c:[]),[c]),p=Object(r.useMemo)((()=>{var e,t;return null!==(e=null===(t=d.at(0))||void 0===t?void 0:t.rule)&&void 0!==e?e:ai}),[d]),m=Object(r.useMemo)((()=>{var e,t;return null!==(e=null===(t=d.at(0))||void 0===t?void 0:t.group)&&void 0!==e?e:ai}),[d]),f=Object(r.useMemo)((()=>{var e,t;const a=null!==(e=null===(t=d.at(0))||void 0===t?void 0:t.severities)&&void 0!==e?e:[];return Object.keys(Ln.b).map((e=>{const t=a.find((t=>t.key===e));return t?{key:t.key,label:t.label,value:t.value}:{key:e,label:Object(I.capitalize)(e),value:0}}))}),[d]),b=Object(r.useMemo)((()=>Ba[e]),[e]);return s.a.createElement(ga.c,null,!u&&s.a.createElement(ni,{alignItems:"center","data-test-subj":"chart-collapse",wrap:!0},s.a.createElement(ii,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"chart-collapse-severities"},f.map((e=>s.a.createElement(ee.EuiFlexItem,{key:e.key,grow:!1},s.a.createElement(ee.EuiHealth,{color:$n(e.key)},s.a.createElement(ee.EuiText,{size:"xs"},`${e.label}: `,s.a.createElement(Xn.a,{count:e.value||0})))))))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ri,{size:"xs",className:"eui-textTruncate","data-test-subj":"chart-collapse-top-rule"},s.a.createElement("strong",null,ei),p)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ri,{size:"xs",className:"eui-textTruncate","data-test-subj":"chart-collapse-top-group"},s.a.createElement("strong",null,`${ti} ${b}: `),m)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ga.b,{isDisabled:!1,queryId:o,title:"chart collapse"}))))))};si.displayName="ChartCollapse";var oi=a(62),li=a(265),ci=a(351),ui=a(1369);const di=({riskScore:e,colorPalette:t})=>{const a=Math.min(100,t.length);return t[Object(A.clamp)(0,a,e)]};var pi=a(556);const mi=({buckets:e,maxRiskSubAggregations:t,stackByField0:a})=>e.flatMap((e=>(({bucket:e,maxRiskSubAggregations:t})=>{var a,n,i;return null!==(a=null===(n=e.stackByField1)||void 0===n||null===(i=n.buckets)||void 0===i?void 0:i.map((t=>{var a,n;return{doc_count:e.doc_count,key:null!==(a=e.key_as_string)&&void 0!==a?a:e.key,maxRiskSubAggregation:e.maxRiskSubAggregation,stackByField1Key:null!==(n=t.key_as_string)&&void 0!==n?n:Object(pi.a)(t.key),stackByField1DocCount:t.doc_count}})))&&void 0!==a?a:[]})({bucket:e,maxRiskSubAggregations:t})));var fi=a(174);const bi=Y.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataLabel",{defaultMessage:"No data to display"}),gi=e=>Y.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataReasonLabel",{values:{stackByField1:e},defaultMessage:"The {stackByField1} field was not present in any groups"}),yi=({baseLabel:e,riskScore:t})=>null!=t?`${e} ${(e=>Y.i18n.translate("xpack.securitySolution.components.alertsTreemap.riskLabel",{values:{riskScore:e},defaultMessage:"(Risk {riskScore})"}))(t)}`:e,hi=({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:n,stackByField0:i})=>{var r,s,o,l;return{color:n?di({riskScore:null!==(r=a[null!==(s=Object(pi.a)(e.key))&&void 0!==s?s:""])&&void 0!==r?r:0,colorPalette:t}):void 0,count:e.doc_count,dataProviderId:Object(fi.i)(`draggable-legend-item-treemap-${i}-${e.key}-${Object(Ma.v4)()}`),render:()=>{var t,a,n;return yi({baseLabel:null!==(t=null!==(a=e.key_as_string)&&void 0!==a?a:Object(pi.a)(e.key))&&void 0!==t?t:"",riskScore:null===(n=e.maxRiskSubAggregation)||void 0===n?void 0:n.value})},field:i,value:null!==(o=null!==(l=e.key_as_string)&&void 0!==l?l:Object(pi.a)(e.key))&&void 0!==o?o:0}},vi=({colorPalette:e,flattenedBucket:{key:t,stackByField1Key:a,stackByField1DocCount:n},maxRiskSubAggregations:i,stackByField0:r,stackByField1:s})=>{var o,l;return{color:di({riskScore:null!==(o=i[null!==(l=Object(pi.a)(t))&&void 0!==l?l:""])&&void 0!==o?o:0,colorPalette:e}),count:n,dataProviderId:Object(fi.i)(`draggable-legend-item-treemap-${t}-${a}-${Object(Ma.v4)()}`),render:()=>`${a}`,field:`${s}`,value:`${a}`}},Ei=({buckets:e,maxItems:t})=>{var a;return null!==(a=null==e?void 0:e.slice(0,t))&&void 0!==a?a:[]},xi=e=>e.reduce(((e,t)=>{var a,n,i;return{...e,[null!==(a=Object(pi.a)(t.key))&&void 0!==a?a:""]:null!==(n=null===(i=t.maxRiskSubAggregation)||void 0===i?void 0:i.value)&&void 0!==n?n:void 0}}),{}),ji=e=>{const t=e.flat(2);return{groupByField0:t.length>0&&"groupByRollup"in t[0]&&null!=t[0].groupByRollup?`${t[0].groupByRollup}`:"",groupByField1:t.length>1&&"groupByRollup"in t[1]&&null!=t[1].groupByRollup?`${t[1].groupByRollup}`:""}},Si=e=>null!=e&&""!==e.trim(),Oi=e=>`${e}`,ki=e=>e.key,wi=ae()(ee.EuiText).withConfig({displayName:"NoDataLabel",componentId:"sc-17b7hy-0"})(["text-align:center;"]),Ti=({reason:e})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(wi,{color:"subdued","data-test-subj":"noDataLabel",size:"xs"},bi),null!=e&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(wi,{color:"subdued","data-test-subj":"reasonLabel",size:"xs"},e))));Ti.displayName="NoDataComponent";const Ii=s.a.memo(Ti),Ci=ae.a.div.withConfig({displayName:"LegendContainer",componentId:"sc-1evqobh-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Mi=ae()(ee.EuiFlexItem).withConfig({displayName:"ChartFlexItem",componentId:"sc-1evqobh-1"})(["min-height:",";"],(({$minChartHeight:e})=>`${e}px`)),_i=({addFilter:e,data:t,maxBuckets:a,minChartHeight:n=240,stackByField0:i,stackByField1:o})=>{var l,c,u;const{theme:d,baseTheme:p}=Object(li.i)(),m=Object(r.useMemo)((()=>{var e,t;return null!==(e=null==d||null===(t=d.background)||void 0===t?void 0:t.color)&&void 0!==e?e:p.background.color}),[null==d||null===(l=d.background)||void 0===l?void 0:l.color,p.background.color]),f=Object(r.useMemo)((()=>({partition:{fillLabel:{valueFont:{fontWeight:700}},idealFontSizeJump:1.15,maxFontSize:16,minFontSize:4,sectorLineStroke:m,sectorLineWidth:1.5}})),[m]),b=Object(r.useMemo)((()=>{var e,n;return Ei({buckets:null===(e=t.aggregations)||void 0===e||null===(n=e.stackByField0)||void 0===n?void 0:n.buckets,maxItems:a})}),[null===(c=t.aggregations)||void 0===c||null===(u=c.stackByField0)||void 0===u?void 0:u.buckets,a]),g=Object(r.useMemo)((()=>xi(b)),[b]),y=Object(r.useMemo)((()=>mi({buckets:b,maxRiskSubAggregations:g,stackByField0:i})),[b,g,i]),h=Object(r.useMemo)((()=>Array(101).fill(0).map(((e,t)=>t>=ui.e?ui.a:t>=ui.f?ui.b:t>=ui.g?ui.d:ui.c))),[]),v=Object(r.useMemo)((()=>0===y.length?(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.map((e=>hi({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:!0,stackByField0:n}))))({buckets:b,colorPalette:h,maxRiskSubAggregations:g,stackByField0:i}):(({buckets:e,colorPalette:t,flattenedBuckets:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:r})=>{const s=(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.reduce(((e,i)=>{var r;return{...e,[null!==(r=Object(pi.a)(i.key))&&void 0!==r?r:""]:[hi({bucket:i,colorPalette:t,maxRiskSubAggregations:a,showColor:!1,stackByField0:n})]}}),{}))({buckets:e,colorPalette:t,maxRiskSubAggregations:n,stackByField0:i}),o=a.reduce(((e,a)=>{var s,o,l;return{...e,[null!==(s=Object(pi.a)(a.key))&&void 0!==s?s:""]:[...null!==(o=e[null!==(l=Object(pi.a)(a.key))&&void 0!==l?l:""])&&void 0!==o?o:[],vi({colorPalette:t,flattenedBucket:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:r})]}}),s);return e.reduce(((e,t)=>{var a;return[...e,...o[null!==(a=Object(pi.a)(t.key))&&void 0!==a?a:""]]}),[])})({buckets:b,colorPalette:h,flattenedBuckets:y,maxRiskSubAggregations:g,stackByField0:i,stackByField1:o})),[b,h,y,g,i,o]),E=Object(r.useCallback)((t=>{const{groupByField0:a,groupByField1:n}=ji(t);null==e||Object(A.isEmpty)(a.trim())||e({field:i,value:a}),null==e||Object(A.isEmpty)(null==o?void 0:o.trim())||Object(A.isEmpty)(n.trim())||e({field:`${o}`,value:n})}),[e,i,o]),x=Object(r.useMemo)((()=>Si(o)?(({colorPalette:e,layer0FillColor:t,maxRiskSubAggregations:a})=>[{fillLabel:{valueFormatter:Oi},groupByRollup:ki,nodeLabel:e=>yi({baseLabel:e,riskScore:a[e]}),shape:{fillColor:t}},{fillLabel:{valueFormatter:Oi},groupByRollup:e=>e.stackByField1Key,nodeLabel:e=>`${e}`,shape:{fillColor:(t,n,i)=>{var r,s;const o=null!==(r=(e=>{const t=e.length-2;return t>0?e[t].value:void 0})(i.path))&&void 0!==r?r:"";return di({riskScore:null!==(s=a[o])&&void 0!==s?s:0,colorPalette:e})}}}])({colorPalette:h,layer0FillColor:m,maxRiskSubAggregations:g}):(({colorPalette:e,maxRiskSubAggregations:t})=>[{fillLabel:{valueFormatter:Oi},groupByRollup:ki,nodeLabel:e=>yi({baseLabel:e,riskScore:t[e]}),shape:{fillColor:a=>{var n;return di({riskScore:null!==(n=t[a])&&void 0!==n?n:0,colorPalette:e})}}}])({colorPalette:h,maxRiskSubAggregations:g})),[h,m,g,o]),j=Object(r.useMemo)((()=>Si(o)?e=>e.stackByField1DocCount:e=>e.doc_count),[o]),S=Si(o)?y:b;return 0===b.length?s.a.createElement(Ii,null):s.a.createElement("div",{"data-test-subj":"alerts-treemap"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(Mi,{grow:!0,$minChartHeight:n},null==o||Object(A.isEmpty)(o)||0!==S.length?s.a.createElement(oi.Chart,null,s.a.createElement(oi.Settings,{baseTheme:p,showLegend:!1,theme:[f,d],onElementClick:E,locale:Y.i18n.getLocale()}),s.a.createElement(oi.Partition,{data:S,id:"spec_1",layers:x,layout:oi.PartitionLayout.treemap,valueAccessor:j})):s.a.createElement(Ii,{reason:gi(o)})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Ci,null,v.length>0&&s.a.createElement(ci.a,{className:"eui-yScroll",height:n,legendItems:v,minWidth:300})))))},Ai=s.a.memo(_i);var Fi=a(528),Pi=a(399);const Di=ae()(ee.EuiFlexItem).withConfig({displayName:"ChartOptionsFlexItem",componentId:"sc-vvwo8c-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Ni=({chartOptionsContextMenu:e,setStackByField0:t,setStackByField0ComboboxInputRef:a,setStackByField1:n,setStackByField1ComboboxInputRef:i,stackByField0:r,stackByField0ComboboxRef:o,stackByField1:l,stackByField1ComboboxRef:c,stackByWidth:u,uniqueQueryId:d,useLensCompatibleFields:p})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"fieldSelection",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Fi.b,{"aria-label":Pi.a,ref:o,"data-test-subj":"groupBy",onSelect:t,prepend:Pi.a,selected:r,inputRef:a,width:u,useLensCompatibleFields:p}),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(Fi.b,{"aria-label":Pi.b,ref:c,"data-test-subj":"groupByTop",onSelect:n,prepend:Pi.b,selected:null!=l?l:"",inputRef:i,width:u,useLensCompatibleFields:p})),s.a.createElement(ee.EuiFlexItem,{grow:!1},null!=e&&s.a.createElement(Di,{grow:!1},e(d))));Ni.displayName="FieldSelectionComponent";const Ri=s.a.memo(Ni);var Li=a(170);const Bi=({stackByField1:e,stackByField1Size:t})=>null==e||Object(A.isEmpty)(e.trim())?{}:{stackByField1:{terms:{field:e,order:{_count:"desc"},size:t}}},zi=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField0Size:i=1e3,stackByField1:r,stackByField1Size:s=1e3,riskSubAggregationField:o,to:l})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:i},aggs:{...Bi({stackByField1:r,stackByField1Size:s}),maxRiskSubAggregation:{max:{field:o}}}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:l}}}]}},runtime_mappings:a}),qi=({addFilter:e,alignHeader:t,chartOptionsContextMenu:a,inspectTitle:n,isPanelExpanded:i,filters:o,height:l=374,query:c,riskSubAggregationField:u,runtimeMappings:d,setIsPanelExpanded:p,setStackByField0:m,setStackByField0ComboboxInputRef:f,setStackByField1:b,setStackByField1ComboboxInputRef:g,signalIndexName:y,stackByField0:h,stackByField0ComboboxRef:v,stackByField1:E,stackByField1ComboboxRef:x,stackByWidth:j,title:S})=>{const{to:O,from:k,deleteQuery:w,setQuery:T}=Object(xe.a)(),I=Object(r.useMemo)((()=>`alerts-treemap-${Object(Ma.v4)()}`),[]),C=Object(r.useMemo)((()=>{try{var e;return[Object(za.buildEsQuery)(void 0,null!=c?[c]:[],null!==(e=null==o?void 0:o.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[c,o]),{data:M,loading:_,refetch:A,request:F,response:P,setQuery:D}=Object(B.a)({query:zi({additionalFilters:C,from:k,riskSubAggregationField:u,runtimeMappings:d,stackByField0:h,stackByField1:E,to:O}),skip:!i,indexName:y,queryName:z.a.TREE_MAP});return Object(r.useEffect)((()=>{D(zi({additionalFilters:C,from:k,riskSubAggregationField:u,runtimeMappings:d,stackByField0:h,stackByField1:E,to:O}))}),[C,k,u,d,D,h,E,O]),Object(qa.a)({deleteQuery:w,loading:_,response:P,setQuery:T,refetch:A,request:F,uniqueQueryId:I}),s.a.createElement(ga.c,null,s.a.createElement(Fi.a,{className:"eui-yScroll","data-test-subj":"treemapPanel",hasBorder:!0,height:i?l:64,$overflowY:i?"auto":"hidden",$toggleStatus:!0},s.a.createElement(Li.a,{alignHeader:t,hideSubtitle:!0,id:I,inspectTitle:n,outerDirection:"row",showInspectButton:null==a,title:S,titleSize:"s",toggleQuery:p,toggleStatus:i},i&&s.a.createElement(Ri,{chartOptionsContextMenu:a,setStackByField0:m,setStackByField0ComboboxInputRef:f,setStackByField1:b,setStackByField1ComboboxInputRef:g,stackByField0:h,stackByField0ComboboxRef:v,stackByField1:E,stackByField1ComboboxRef:x,stackByWidth:j,uniqueQueryId:I})),_&&i?s.a.createElement(ee.EuiProgress,{color:"accent","data-test-subj":"progress",position:"absolute",size:"xs"}):s.a.createElement(s.a.Fragment,null,null!=M&&i&&s.a.createElement(Ai,{addFilter:e,data:M,maxBuckets:1e3,stackByField0:h,stackByField1:E}))))};qi.displayName="AlertsTreemapPanelComponent";const $i=s.a.memo(qi),Vi=()=>{const e=Object(r.useRef)(null),[t,a]=Object(r.useState)(null),n=Object(r.useCallback)((()=>{var a;null===(a=e.current)||void 0===a||a.clearSearchValue(),null!=t&&(t.value="")}),[t]);return{comboboxRef:e,onReset:n,setComboboxInputRef:a}};var Ui=a(688);const Hi=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.chartsTitle",{defaultMessage:"Charts"}),Qi=1e3,Gi={statusBySeverity:{terms:{field:Ca.X}}},Wi={alertsByType:{terms:{field:Ca.G,size:Qi},aggs:{ruleByEventType:{terms:{field:"event.type",size:Qi}}}}},Zi={alertsByRule:{terms:{field:Ca.G,size:Qi}}};var Ki=a(596),Ji=a(595),Yi=a(166);const Xi=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableColumnTitle",{defaultMessage:"Count of records"}),er=Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableTitle",{defaultMessage:"Count"}),tr=({fieldName:e,topN:t})=>Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.columnLabel",{values:{fieldName:e,topN:t},defaultMessage:"Top {topN} values of {fieldName}"});var ar=a(197);const nr=ae()(ee.EuiLoadingSpinner).withConfig({displayName:"StyledEuiLoadingSpinner",componentId:"sc-1jn2elx-0"})(["margin:auto;"]),ir=({data:e,isLoading:t,addFilter:a})=>{const n=Object(r.useMemo)((()=>[{field:"key",name:qn,"data-test-subj":"severityTable-severity",render:e=>s.a.createElement(ee.EuiHealth,{color:Ln.b[e],textSize:"xs"},s.a.createElement(Yi.b,{isDraggable:!1,field:Ca.X,hideTopN:!0,id:`alert-severity-draggable-${e}`,value:Object(I.capitalize)(e),queryValue:e,tooltipContent:null}))},{field:"value",name:er,sortable:!0,dataType:"number","data-test-subj":"severityTable-alertCount",width:"45%",render:e=>s.a.createElement(ee.EuiText,{grow:!1,size:"xs"},s.a.createElement(Xn.a,{count:e}))}]),[]),i=Object(r.useMemo)((()=>e?e.reduce((function(e,t){return e+t.value}),0):0),[e]),o=Object(r.useCallback)((e=>$n(e)),[]),l=Object(r.useCallback)((e=>{a&&a({field:Ca.X,value:e.toLowerCase()})}),[a]);return s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s","data-test-subj":"severity-level-chart"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiInMemoryTable,{"data-test-subj":"severity-level-table",columns:n,items:e,loading:t,sorting:{sort:{field:"value",direction:"desc"}}})),s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"severity-level-donut"},t?s.a.createElement(nr,{size:"l"}):s.a.createElement(Ki.a,{data:e,fillColor:o,height:150,label:ar.W,title:s.a.createElement(Ji.a,{count:i}),totalCount:i,onPartitionClick:l})))};ir.displayName="SeverityLevelChart";const rr=({filters:e,query:t,signalIndexName:a,runtimeMappings:n,addFilter:i,skip:o})=>{const l=Object(r.useMemo)((()=>`alerts-summary-severity-donut-${Object(Ma.v4)()}`),[]),{items:c,isLoading:u}=Yn({aggregations:Gi,filters:e,query:t,signalIndexName:a,runtimeMappings:n,skip:o,uniqueQueryId:l}),d=Object(r.useMemo)((()=>(e=>null==e?void 0:e.every((e=>Object(I.has)(e,"key"))))(c)?c:[]),[c]);return s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,hasShadow:!1,"data-test-subj":"severty-level-panel"},s.a.createElement(Li.a,{id:l,inspectTitle:Bn,outerDirection:"row",title:Bn,titleSize:"xs",hideSubtitle:!0}),s.a.createElement(ir,{data:d,isLoading:u,addFilter:i})))};rr.displayName="SeverityLevelPanel";var sr=a(275);const or=ae.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1jqzjbv-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeM)),lr=ae.a.div.withConfig({displayName:"TableWrapper",componentId:"sc-1jqzjbv-1"})(["height:178px;"]),cr=ae()(ee.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-1jqzjbv-2"})(["border:none;border-radius:0;"]),ur=({data:e,isLoading:t})=>{const a=Object(ve.a)("alertTypeEnabled"),n=Object(r.useMemo)((()=>(e=>[{field:"rule",name:ar.t,"data-test-subj":"detectionsTable-rule",truncateText:!0,render:e=>s.a.createElement(ee.EuiText,{size:"xs",className:"eui-textTruncate"},s.a.createElement(Yi.b,{isDraggable:!1,field:Ca.G,hideTopN:!0,id:`alert-detection-draggable-${e}`,value:e,queryValue:e,tooltipContent:null,truncate:!0}))},...e?[{field:"type",name:Hn,"data-test-subj":"detectionsTable-type",truncateText:!0,render:e=>s.a.createElement(ee.EuiHealth,{color:Wn[e]},s.a.createElement(ee.EuiText,{grow:!1,size:"xs"},s.a.createElement(sr.c,{mode:sr.a.HOVER_DOWN,visibleCellActions:4,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:"denied",field:"event.type"},sourcererScopeId:x.SourcererScopeName.detections,metadata:{negateFilters:"Detection"===e}},Zn[e]))),width:"30%"}]:[],{field:"value",name:er,dataType:"number",sortable:!0,"data-test-subj":"detectionsTable-count",render:e=>s.a.createElement(ee.EuiText,{grow:!1,size:"xs"},s.a.createElement(Xn.a,{count:e})),width:"22%"}])(a)),[a]),i=Object(r.useMemo)((()=>e.reduce(((e,t)=>("Detection"===t.type&&(e.Detection+=t.value),"Prevention"===t.type&&(e.Prevention+=t.value),e)),{Detection:0,Prevention:0})),[e]),o=Object(r.useMemo)((()=>Object.keys(i).reduce(((e,t)=>{const a=e.length>0?e[e.length-1].stop:0;if(i[t]){const n={stop:a+(i[t]||0),color:Wn[t]};e.push(n)}return e}),[])),[i]);return s.a.createElement(or,{"data-test-subj":"alerts-by-type"},a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs","data-test-subj":"alerts-by-type-palette-display"},Object.keys(i).map((e=>s.a.createElement(ee.EuiFlexItem,{key:e,grow:!1},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiHealth,{className:"eui-alignMiddle",color:Wn[e]},s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement("h4",null,`${e}:`)))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement(Xn.a,{count:i[e]||0}))))))),s.a.createElement(ee.EuiSpacer,{size:"xs"})),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(cr,{size:"xs",palette:o})),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(lr,{className:"eui-yScroll"},s.a.createElement(ee.EuiInMemoryTable,{"data-test-subj":"alerts-by-type-table",columns:n,items:e,loading:t,sorting:{sort:{field:"value",direction:"desc"}},pagination:{pageSize:25,showPerPageOptions:!1}})))};ur.displayName="AlertsByType";const dr=({filters:e,query:t,signalIndexName:a,runtimeMappings:n,skip:i})=>{const o=Object(ve.a)("alertTypeEnabled"),l=Object(r.useMemo)((()=>`alerts-summary-alert_by_type-${Object(Ma.v4)()}`),[]),{items:c,isLoading:u}=Yn({aggregations:o?Wi:Zi,filters:e,query:t,signalIndexName:a,runtimeMappings:n,skip:i,uniqueQueryId:l}),d=Object(r.useMemo)((()=>(e=>null==e?void 0:e.every((e=>Object(I.has)(e,"type"))))(c)?c:[]),[c]);return s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,hasShadow:!1,"data-test-subj":"alerts-by-type-panel"},s.a.createElement(Li.a,{id:l,inspectTitle:o?Vn:Un,outerDirection:"row",title:o?Vn:Un,titleSize:"xs",hideSubtitle:!0}),s.a.createElement(ur,{data:d,isLoading:u})))};dr.displayName="AlertsByTypePanel";const pr=ae.a.div.withConfig({displayName:"ProgressWrapper",componentId:"sc-inoj9t-0"})(["height:160px;"]),mr=ae()(ee.EuiHorizontalRule).withConfig({displayName:"StyledEuiHorizontalRule",componentId:"sc-inoj9t-1"})(["margin-top:0;margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeS)),fr=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-inoj9t-2"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeM)),br=ae()(ee.EuiProgress).withConfig({displayName:"StyledEuiProgress",componentId:"sc-inoj9t-3"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeS)),gr=ae.a.div.withConfig({displayName:"DataStatsWrapper",componentId:"sc-inoj9t-4"})(["width:250px;"]),yr=({data:e,isLoading:t,addFilter:a,groupBySelection:n})=>{const[i,o]=Object(r.useState)(!1),[l,c]=(e=>{const{total:t,nonEmpty:a}=e.reduce(((e,t)=>(e.total+=t.value,"-"!==t.key&&(e.nonEmpty+=t.value),e)),{total:0,nonEmpty:0});return[a,La(0===t?0:a/t)]})(e),u=s.a.createElement(ee.EuiButtonIcon,{color:"text",iconType:"iInCircle","aria-label":"info",size:"xs",onClick:()=>o(!i)}),d=s.a.createElement(gr,null,s.a.createElement(ee.EuiPopoverTitle,null,(m=c,Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.dataStatsTitle",{values:{percent:m},defaultMessage:"This field exists in {percent} of alerts."}))),s.a.createElement(ee.EuiText,{size:"s"},(p=n,Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.dataStatsMessage",{values:{groupbySelection:p},defaultMessage:"To see alerts without {groupbySelection} you can filter in by "})),s.a.createElement(ee.EuiLink,{color:"primary",onClick:()=>{o(!1),a&&a({field:n,value:null,negate:!0})}},(e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.alerts.alertsByGrouping.nonEmptyFilter",{values:{groupBySelection:e},defaultMessage:"NOT {groupBySelection}: exists"}))(n))));var p,m;return s.a.createElement(s.a.Fragment,null,s.a.createElement(fr,{alignItems:"center",gutterSize:"xs"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"alerts-progress-bar-title"},s.a.createElement("h5",null,n))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiPopover,{button:u,isOpen:i,closePopover:()=>o(!1),anchorPosition:"rightCenter",panelPaddingSize:"s"},d))),t?s.a.createElement(br,{size:"xs",color:"primary"}):s.a.createElement(s.a.Fragment,null,s.a.createElement(mr,null),s.a.createElement(pr,{"data-test-subj":"progress-bar",className:"eui-yScroll"},0===l?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiText,{size:"s",textAlign:"center","data-test-subj":"empty-proress-bar"},Aa),s.a.createElement(ee.EuiSpacer,{size:"l"})):s.a.createElement(s.a.Fragment,null,e.map((e=>{return"-"!==e.key&&s.a.createElement("div",{key:`${e.key}`,"data-test-subj":`progress-bar-${e.key}`},s.a.createElement(ee.EuiProgress,{valueText:s.a.createElement(ee.EuiText,{size:"xs",color:"default"},s.a.createElement("strong",null,e.percentageLabel)),max:1,color:"vis9",size:"s",value:e.percentage,label:"Other"===e.key?e.label:(t=e.key,s.a.createElement(Yi.b,{isDraggable:!1,field:n,hideTopN:!0,id:`top-alerts-${t}`,value:t,queryValue:t,tooltipContent:null},s.a.createElement(ee.EuiText,{size:"xs",className:"eui-textTruncate"},t)))}),s.a.createElement(ee.EuiSpacer,{size:"s"}));var t}))),s.a.createElement(ee.EuiSpacer,{size:"s"}))))};yr.displayName="AlertsProgressBar";const hr=["host.name","user.name","source.ip","destination.ip"],vr=({filters:e,query:t,signalIndexName:a,runtimeMappings:n,skip:i,groupBySelection:o,setGroupBySelection:l,addFilter:c})=>{const u=Object(r.useMemo)((()=>`alerts-summary-top-alerts-${Object(Ma.v4)()}`),[]),d=hr.map((e=>({value:e,label:e}))),p=Object(r.useMemo)((()=>{return{alertsByGrouping:{terms:{field:e=o,size:10}},missingFields:{missing:{field:e}}};var e}),[o]),m=Object(r.useCallback)((e=>{l(e)}),[l]),{items:f,isLoading:b}=Yn({aggregations:p,filters:e,query:t,signalIndexName:a,runtimeMappings:n,skip:i,uniqueQueryId:u}),g=Object(r.useMemo)((()=>(e=>null==e?void 0:e.every((e=>Object(I.has)(e,"percentage"))))(f)?f:[]),[f]);return s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,hasShadow:!1,"data-test-subj":"alerts-progress-bar-panel"},s.a.createElement(Li.a,{id:u,inspectTitle:`${_a} ${o}`,outerDirection:"row",title:_a,titleSize:"xs",hideSubtitle:!0},s.a.createElement(Fi.b,{"data-test-subj":"stackByComboBox",selected:o,onSelect:m,prepend:"",width:150,dropDownoptions:d})),s.a.createElement(yr,{data:g,isLoading:b,groupBySelection:o,addFilter:c})))};vr.displayName="AlertsProgressBarPanel";var Er=a(160);const xr=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-1p6f4e6-0"})(["@media only screen and (min-width:",");"],(({theme:e})=>e.eui.euiBreakpoints.l)),jr=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-1p6f4e6-1"})(["min-width:355px;"]),Sr=({alignHeader:e,filters:t,addFilter:a,panelHeight:n,query:i,runtimeMappings:o,signalIndexName:l,title:c=Hi,isExpanded:u,setIsExpanded:d,groupBySelection:p,setGroupBySelection:m})=>{const f=Object(ve.a)("alertsPageChartsEnabled"),{toggleStatus:b,setToggleStatus:g}=Object(Er.a)("detections-alerts-charts"),y=Object(r.useCallback)((e=>{f&&d?d(e):g(e)}),[g,d,f]),h=Object(r.useMemo)((()=>f?!u:!b),[f,u,b]),v=Object(r.useMemo)((()=>!(!f||!u)||!(f||!b)),[f,u,b]);return s.a.createElement(Fi.a,{$toggleStatus:f&&void 0!==u?u:b,"data-test-subj":"alerts-charts-panel",hasBorder:!0,height:n},s.a.createElement(Li.a,{alignHeader:e,outerDirection:"row",title:c,titleSize:"s",hideSubtitle:!0,showInspectButton:!1,toggleStatus:f?u:b,toggleQuery:y}),v&&s.a.createElement(xr,{"data-test-subj":"alerts-charts-container",className:"eui-yScroll",wrap:!0,gutterSize:"m"},s.a.createElement(jr,null,s.a.createElement(rr,{filters:t,query:i,signalIndexName:l,runtimeMappings:o,skip:h,addFilter:a})),s.a.createElement(jr,null,s.a.createElement(dr,{filters:t,query:i,signalIndexName:l,runtimeMappings:o,skip:h})),s.a.createElement(jr,null,s.a.createElement(vr,{filters:t,query:i,signalIndexName:l,runtimeMappings:o,skip:h,groupBySelection:p,setGroupBySelection:m,addFilter:a}))))};Sr.displayName="AlertsSummaryChartsPanel";const Or=1e3,kr=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField1:i,to:r})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:Or},aggs:{...Bi({stackByField1:i,stackByField1Size:1e3})}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:r}}}]}},runtime_mappings:a});var wr=a(198);const Tr=Object(Ma.v4)(),Ir=Object(Ma.v4)(),Cr=Object(Ma.v4)(),Mr=Object(Ma.v4)(),_r=[{columnId:Ir,isTransposed:!1,width:362},{columnId:Cr,isTransposed:!1}],Ar=[{columnId:Mr,isTransposed:!1}],Fr=[Ir],Pr=(e="kibana.alert.rule.name",t)=>{const a=!Object(I.isEmpty)(null==t?void 0:t.breakdownField),n=null!=t&&t.breakdownField&&a?null==t?void 0:t.breakdownField:e,i=a?[...Fr,Mr,Cr]:[...Fr,Cr],r={[Ir]:{label:Object(wr.p)(e),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:Cr},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},include:[],exclude:[],includeIsRegex:!1,excludeIsRegex:!1}},[Cr]:{label:Object(wr.h)(n),dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:n,params:{emptyAsNull:!0}},...null!=t&&t.breakdownField&&a?(s=null==t?void 0:t.breakdownField,{[Mr]:{label:Object(wr.p)(s),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:s,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:Cr},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},include:[],exclude:[],includeIsRegex:!1,excludeIsRegex:!1}}}):{}};var s;return{title:"Alerts",description:"",visualizationType:"lnsDatatable",state:{visualization:{columns:a?[..._r,...Ar]:_r,layerId:Tr,layerType:"data"},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[Tr]:{columns:i.reduce(((e,t)=>(t&&r[t]&&(e[t]=r[t]),e)),{}),columnOrder:i,sampling:1,incompleteColumns:{}}}},textBased:{layers:{}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${Tr}`}]}};var Dr=a(330),Nr=a(61),Rr=a.n(Nr);const Lr=ae.a.div.withConfig({displayName:"Wrapper",componentId:"sc-13jp899-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeS)),Br=({data:e,loading:t,stackByField0:a,stackByField1:n})=>{var i,o;const[c]=Object(h.o)(l.P),u=Object(r.useMemo)((()=>Object(A.isEmpty)(null==n?void 0:n.trim())?(({defaultNumberFormat:e,stackByField0:t})=>[{"data-test-subj":"stackByField0Key",field:"key",name:t,render:function(e){return s.a.createElement(Yi.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"doc_count",dataType:"number",field:"doc_count",name:Xi,render:t=>Rr()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a}):(({defaultNumberFormat:e,stackByField0:t,stackByField1:a})=>[{"data-test-subj":"stackByField0Key",field:"key",name:tr({fieldName:t,topN:Or}),render:function(e){return s.a.createElement(Yi.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1Key",field:"stackByField1Key",name:tr({fieldName:null!=a?a:"",topN:1e3}),render:function(e){return s.a.createElement(Yi.b,{isDraggable:!1,field:null!=a?a:"",hideTopN:!0,id:`alert-count-draggable-stackByField1-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1DocCount",dataType:"number",field:"stackByField1DocCount",name:Xi,render:t=>Rr()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a,stackByField1:n})),[c,a,n]),d=Object(r.useMemo)((()=>{var t,a;return Ei({buckets:null===(t=e.aggregations)||void 0===t||null===(a=t.stackByField0)||void 0===a?void 0:a.buckets,maxItems:Or})}),[null===(i=e.aggregations)||void 0===i||null===(o=i.stackByField0)||void 0===o?void 0:o.buckets]),p=Object(r.useMemo)((()=>xi(d)),[d]),m=Object(r.useMemo)((()=>Object(A.isEmpty)(null==n?void 0:n.trim())?d:mi({buckets:d,maxRiskSubAggregations:p,stackByField0:a})),[d,p,a,n]);return s.a.createElement(Lr,{"data-test-subj":"alertsCountTable",className:"eui-yScroll"},s.a.createElement(ee.EuiInMemoryTable,{isSelectable:!1,columns:u,items:m,loading:t,sorting:!0}))};Br.displayName="AlertsCountComponent";const zr=s.a.memo(Br),qr=({alertsData:e,extraActions:t,extraOptions:a,getLensAttributes:n,height:i,id:r,inspectTitle:o,isChartEmbeddablesEnabled:l,isLoadingAlerts:c,scopeId:u,stackByField0:d,stackByField1:p,timerange:m})=>l?s.a.createElement(Dr.a,{"data-test-subj":"embeddable-alerts-count",extraActions:t,extraOptions:a,getLensAttributes:n,height:i,id:r,inspectTitle:o,scopeId:u,stackByField:d,timerange:m}):null!=e?s.a.createElement(zr,{data:e,loading:c,stackByField0:d,stackByField1:p}):null,$r=s.a.memo(qr),Vr="detections-alerts-count",Ur=Object(r.memo)((({alignHeader:e,chartOptionsContextMenu:t,extraActions:a,filters:n,inspectTitle:i,panelHeight:o,query:l,runtimeMappings:c,setStackByField0:u,setStackByField0ComboboxInputRef:d,setStackByField1:p,setStackByField1ComboboxInputRef:m,signalIndexName:f,stackByField0:b,stackByField0ComboboxRef:g,stackByField1:y,stackByField1ComboboxRef:h,stackByWidth:v,title:E=er,isExpanded:j,setIsExpanded:S})=>{const{to:O,from:k,deleteQuery:w,setQuery:T}=Object(xe.a)(),I=Object(ve.a)("chartEmbeddablesEnabled"),C=Object(ve.a)("alertsPageChartsEnabled"),M=Object(r.useMemo)((()=>`${Vr}-${Object(Ma.v4)()}`),[]),_=Object(r.useMemo)((()=>{try{var e;return[Object(za.buildEsQuery)(void 0,null!=l?[l]:[],null!==(e=null==n?void 0:n.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[l,n]),{toggleStatus:A,setToggleStatus:F}=Object(Er.a)(Vr),P=Object(r.useCallback)((e=>{C&&S?S(e):F(e)}),[F,S,C]),D=Object(r.useMemo)((()=>C?!j:!A),[C,j,A]),N=Object(r.useMemo)((()=>({from:k,to:O})),[k,O]),R=Object(r.useMemo)((()=>({breakdownField:y,filters:n})),[n,y]),{loading:L,data:q,setQuery:$,response:V,request:U,refetch:H}=Object(B.a)({query:kr({stackByField0:b,stackByField1:y,from:k,to:O,additionalFilters:_,runtimeMappings:c}),indexName:f,skip:D||I,queryName:z.a.COUNT});Object(r.useEffect)((()=>{$(kr({additionalFilters:_,from:k,runtimeMappings:c,stackByField0:b,stackByField1:y,to:O}))}),[_,k,c,$,b,y,O]),Object(qa.a)({deleteQuery:w,loading:L,refetch:H,request:U,response:V,setQuery:T,uniqueQueryId:M});const Q=Object(r.useMemo)((()=>C?j:A),[C,A,j]);return s.a.createElement(ga.c,{show:C?j:A},s.a.createElement(Fi.a,{$toggleStatus:C&&void 0!==j?j:A,"data-test-subj":"alertsCountPanel",hasBorder:!0,height:o},s.a.createElement(Li.a,{alignHeader:e,id:M,inspectTitle:i,outerDirection:"row",title:E,titleSize:"s",hideSubtitle:!0,showInspectButton:null==t,toggleStatus:C?j:A,toggleQuery:P},s.a.createElement(Ri,{chartOptionsContextMenu:I?void 0:t,setStackByField0:u,setStackByField0ComboboxInputRef:d,setStackByField1:p,setStackByField1ComboboxInputRef:m,stackByField0:b,stackByField0ComboboxRef:g,stackByField1:y,stackByField1ComboboxRef:h,stackByWidth:v,uniqueQueryId:M,useLensCompatibleFields:I})),Q&&(L?s.a.createElement(ee.EuiProgress,{color:"accent","data-test-subj":"progress",position:"absolute",size:"xs"}):s.a.createElement($r,{alertsData:q,"data-test-subj":"embeddable-count-table",extraActions:a,extraOptions:R,getLensAttributes:Pr,height:218,id:`${M}-embeddable`,inspectTitle:i,isChartEmbeddablesEnabled:I,isLoadingAlerts:L,scopeId:x.SourcererScopeName.detections,stackByField0:b,stackByField1:y,stackByField:b,timerange:N}))))}));Ur.displayName="AlertsCountPanel";var Hr=a(726);const Qr=375,Gr=ae()(ee.EuiFlexItem).withConfig({displayName:"FullHeightFlexItem",componentId:"sc-1ap19zo-0"})(["height:100%;"]),Wr=ae.a.div.withConfig({displayName:"ChartSelectContainer",componentId:"sc-1ap19zo-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Zr=({addFilter:e,alertsDefaultFilters:t,isLoadingIndexPattern:a,query:n,runtimeMappings:i,signalIndexName:o,updateDateRangeCallback:l})=>{const{toggleStatus:c,setToggleStatus:u}=Object(Er.a)("detection-alerts-charts-panel"),d=Object(ve.a)("alertsPageChartsEnabled"),{alertViewSelection:p,countTableStackBy0:m,countTableStackBy1:f,groupBySelection:b,isTreemapPanelExpanded:g,riskChartStackBy0:y,riskChartStackBy1:h,setAlertViewSelection:v,setCountTableStackBy0:E,setCountTableStackBy1:x,setGroupBySelection:j,setIsTreemapPanelExpanded:S,setRiskChartStackBy0:O,setRiskChartStackBy1:k,setTrendChartStackBy:w,trendChartStackBy:T}=(()=>{const e=Object(ve.a)("alertsPageChartsEnabled"),[t,a]=Object(Gt.a)({defaultValue:e?fa:pa,key:Wt({category:ta,page:Kt,setting:"alert-view-selection"}),isInvalidDefault:Zt}),[n,i]=Object(Gt.a)({defaultValue:"host.name",key:Wt({category:ta,page:Kt,setting:"group-by"}),isInvalidDefault:Zt}),[r,s]=Object(Gt.a)({defaultValue:!0,key:Wt({category:Yt,page:Kt,setting:"expand"})}),[o,l]=Object(Gt.a)({defaultValue:aa.a,key:Wt({category:Yt,page:Kt,setting:Xt}),isInvalidDefault:Zt}),[c,u]=Object(Gt.a)({defaultValue:aa.b,key:Wt({category:Yt,page:Kt,setting:ea})}),[d,p]=Object(Gt.a)({defaultValue:aa.a,key:Wt({category:Jt,page:Kt,setting:Xt}),isInvalidDefault:Zt}),[m,f]=Object(Gt.a)({defaultValue:aa.b,key:Wt({category:Jt,page:Kt,setting:ea})}),[b,g]=Object(Gt.a)({defaultValue:aa.a,key:Wt({category:"trend",page:Kt,setting:"stack-by"}),isInvalidDefault:Zt});return{alertViewSelection:t,countTableStackBy0:d,countTableStackBy1:m,groupBySelection:n,isTreemapPanelExpanded:r,riskChartStackBy0:o,riskChartStackBy1:c,setAlertViewSelection:a,setCountTableStackBy0:p,setCountTableStackBy1:f,setGroupBySelection:i,setIsTreemapPanelExpanded:s,setRiskChartStackBy0:l,setRiskChartStackBy1:u,setTrendChartStackBy:g,trendChartStackBy:b}})(),I=Object(r.useCallback)((e=>{w(e),E(e),O(e)}),[E,O,w]),C=Object(r.useCallback)((e=>{x(e),k(e)}),[x,k]),{comboboxRef:M,onReset:_,setComboboxInputRef:A}=Vi(),{comboboxRef:F,onReset:P,setComboboxInputRef:D}=Vi(),N=Object(r.useCallback)((()=>{_(),P()}),[_,P]),R=Object(r.useCallback)((()=>{N(),I(aa.a),null!=C&&C(aa.b)}),[N,I,C]),L=Object(r.useMemo)((()=>[Object(Hr.b)({callback:R,order:5})]),[R]),B=Object(r.useCallback)((e=>s.a.createElement(Oa,{defaultStackByField:aa.a,defaultStackByField1:aa.b,onReset:N,queryId:e,setStackBy:I,setStackByField1:C})),[N,I,C]),z=Object(r.useMemo)((()=>d?c?s.a.createElement(Wr,null,s.a.createElement(Ia,{alertViewSelection:p,setAlertViewSelection:v})):s.a.createElement(si,{groupBySelection:b,filters:t,query:n,signalIndexName:o,runtimeMappings:i}):s.a.createElement(Wr,null,s.a.createElement(Ia,{alertViewSelection:p,setAlertViewSelection:v}))),[p,v,d,c,b,t,n,o,i]);return s.a.createElement("div",{"data-test-subj":"chartPanels"},"trend"===p&&s.a.createElement(Gr,{grow:2},a?s.a.createElement(ee.EuiSkeletonText,{lines:10,"data-test-subj":"trendLoadingSpinner"}):s.a.createElement(Ui.a,{alignHeader:"flexStart",chartHeight:240,chartOptionsContextMenu:B,comboboxRef:M,defaultStackByOption:T,extraActions:L,filters:t,inspectTitle:ra,onFieldSelected:I,panelHeight:Qr,query:n,runtimeMappings:i,setComboboxInputRef:A,showCountsInLegend:!0,showGroupByPlaceholder:!1,showTotalAlertsCount:!1,signalIndexName:o,stackByLabel:Pi.a,title:z,titleSize:"s",updateDateRange:l,isExpanded:c,setIsExpanded:u})),"table"===p&&s.a.createElement(Gr,{grow:1},a?s.a.createElement(ee.EuiSkeletonText,{lines:10,"data-test-subj":"tableLoadingSpinner"}):s.a.createElement(Ur,{alignHeader:"flexStart",chartOptionsContextMenu:B,extraActions:L,filters:t,inspectTitle:d?la:ia,panelHeight:Qr,query:n,runtimeMappings:i,setStackByField0:I,setStackByField0ComboboxInputRef:A,setStackByField1:C,setStackByField1ComboboxInputRef:D,signalIndexName:o,stackByField0:m,stackByField0ComboboxRef:M,stackByField1:f,stackByField1ComboboxRef:F,title:z,isExpanded:c,setIsExpanded:u})),"treemap"===p&&s.a.createElement(Gr,{grow:1},a?s.a.createElement(ee.EuiSkeletonText,{lines:10,"data-test-subj":"treemapLoadingSpinner"}):s.a.createElement($i,{addFilter:e,alignHeader:"flexStart",chartOptionsContextMenu:B,height:Qr,inspectTitle:sa,isPanelExpanded:d?c:g,filters:t,query:n,riskSubAggregationField:"kibana.alert.risk_score",setIsPanelExpanded:d?u:S,setStackByField0:I,setStackByField0ComboboxInputRef:A,setStackByField1:C,setStackByField1ComboboxInputRef:D,signalIndexName:o,stackByField0:y,stackByField0ComboboxRef:M,stackByField1:h,stackByField1ComboboxRef:F,title:z})),d&&"charts"===p&&s.a.createElement(Gr,{grow:1},a?s.a.createElement(ee.EuiSkeletonText,{lines:10,"data-test-subj":"chartsLoadingSpinner"}):s.a.createElement(Sr,{alignHeader:"flexStart",addFilter:e,filters:t,query:n,panelHeight:Qr,signalIndexName:o,title:z,runtimeMappings:i,isExpanded:c,setIsExpanded:u,groupBySelection:b,setGroupBySelection:j})))},Kr=s.a.memo(Zr);var Jr=a(1123),Yr=a(143);const Xr=Y.i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),es=({message:e,text:t,onClick:a=A.noop})=>{const{type:n}=e,i=n,o=null!=t?t:Xr,l=Object(r.useCallback)((()=>a(e)),[a,e]);return s.a.createElement(ee.EuiButton,{color:i,"data-test-subj":"callout-dismiss-btn",onClick:l},o)},ts=({message:e,iconType:t,dismissButtonText:a,onDismiss:n,showDismissButton:i=!0})=>{const{type:r,id:o,title:l,description:c}=e,u=null!=t?t:as(r);return s.a.createElement(ee.EuiCallOut,{color:r,title:l,iconType:u,"data-test-subj":`callout-${o}`,"data-test-messages":`[${o}]`},c,i&&s.a.createElement(es,{message:e,text:a,onClick:n}))},as=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"warning";default:return Object(Yr.a)(e)}},ns=Object(r.memo)(ts);var is=a(705),rs=a.n(is);const ss=()=>{const{storage:e}=Object(h.i)().services,t=Object(r.useCallback)((t=>{var a;return null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]}),[e]),a=Object(r.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i,a])}),[e]),n=Object(r.useCallback)(((t,a)=>{var n;return(null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]).filter((e=>e===a)).length>0}),[e]),i=Object(r.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i.filter((e=>e!==a))])}),[e]);return{getMessages:t,addMessage:a,clearAllMessages:Object(r.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:i,hasMessage:n}},os=(e,t)=>ls(e,A.identity,(()=>t)),ls=(e,t,a)=>{const n=e.map((e=>[t(e),a(e)]));return Object(A.fromPairs)(n)},cs=({namespace:e,condition:t,message:a})=>{const{isVisible:n,dismiss:i}=((e,t="common")=>{const{getMessages:a,addMessage:n}=ss(),[i,s]=rs()({}),o=(e=>`kibana.securitySolution.${e}.callouts.dismissed`)(t),l=Object(r.useCallback)((()=>Object.entries(i).filter((([e,t])=>t)).map((([e,t])=>e))),[i]),c=Object(r.useCallback)((e=>{var t;return null!==(t=i[e.id])&&void 0!==t&&t}),[i]),u=Object(r.useCallback)((e=>{const{id:t,type:a}=e;s.set(t,!1),"primary"!==a&&"success"!==a||n(o,t)}),[s,n,o]),d=Object(r.useCallback)((e=>{const t=a(o),n=Object(A.difference)(e,t),i=Object(A.intersection)(e,t);s.setAll({...os(n,!0),...os(i,!1)})}),[a,o,s]);return Object(r.useEffect)((()=>{const t=e.map((e=>e.id)),a=Object.keys(i);Object(A.isEqual)(t,a)||d(t)}),[e,i,d]),{getVisibleMessageIds:l,isVisible:c,dismiss:u}})([a],e);return t&&n(a)?s.a.createElement(s.a.Fragment,null,s.a.createElement(ns,{message:a,onDismiss:i}),s.a.createElement(ee.EuiSpacer,{size:"l"})):null},us=Object(r.memo)(cs),ds=({condition:e,message:t})=>e?s.a.createElement(ns,{message:t,showDismissButton:!1}):null,ps=Object(r.memo)(ds);var ms=a(47);const fs=({url:e,children:t,ariaLabel:a})=>t?s.a.createElement(ee.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},s.a.createElement(ee.EuiLink,{href:e,"aria-label":a,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null,bs=Y.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),gs=Y.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),ys=Y.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),hs=Y.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"}),vs=Y.i18n.translate("xpack.securitySolution.documentationLinks.coverageOverview.text",{defaultMessage:"Learn more."}),Es=({guidePath:e="security",docPath:t,linkText:a})=>{const{services:n}=Object(h.i)(),{ELASTIC_WEBSITE_URL:i,DOC_LINK_VERSION:r}=n.docLinks,o=`${i}guide/en/${e}/${r}/${t}`,l=`${a} - ${bs}`;return s.a.createElement(fs,{url:o,ariaLabel:l},a)},xs=Object(r.memo)(Es),js=()=>s.a.createElement(xs,{docPath:"sec-requirements.html",linkText:gs}),Ss=()=>s.a.createElement(xs,{docPath:"detections-permissions-section.html",linkText:ys}),Os=()=>s.a.createElement(xs,{docPath:"alerts-ui-monitor.html#ml-job-compatibility",linkText:hs}),ks=()=>s.a.createElement(xs,{docPath:"rules-coverage.html",linkText:vs}),ws={type:"primary",id:"need-admin-for-update-rules",title:Y.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(Ss,null)),s.a.createElement("li",null,s.a.createElement(js,null)))}})},Ts=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(kt.b)();return null!=e&&e&&null!=t&&!t?s.a.createElement(s.a.Fragment,null,s.a.createElement(ps,{condition:!0,message:ws}),s.a.createElement(ee.EuiSpacer,{size:"l"})):null},Is=Object(r.memo)(Ts);var Cs=a(1652),Ms=a.n(Cs);const _s=({values:e})=>s.a.createElement(s.a.Fragment,null,e.map(((t,a)=>s.a.createElement(s.a.Fragment,{key:a},s.a.createElement(ee.EuiCode,null,t),a<e.length-1?", ":"")))),As=Y.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),Fs=Y.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),Ps=Y.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),Ds=Y.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),Ns=({indexPrivileges:e,featurePrivileges:t=[]})=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),s.a.createElement("ul",null,e.map((([e,t])=>s.a.createElement("li",{key:e},Bs(e,t)))))):null,featurePrivileges:t.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),s.a.createElement("ul",null,t.map((([e,t])=>s.a.createElement("li",{key:e},$s(e,t)))))):null,docs:s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(Ss,null)),s.a.createElement("li",null,s.a.createElement(js,null)))}}),Rs={[l.sc]:{all:Fs},[l.T]:{write:Ds},[l.N]:{write:Ps},[l.M]:{write:Ps}},Ls=(e,t)=>{var a;const n=null===(a=Object.entries(Rs).find((([e])=>t.startsWith(e))))||void 0===a?void 0:a[1];return e.map((e=>null==n?void 0:n[e])).filter(Boolean).join(" ")},Bs=(e,t)=>[l.N,l.M].some((t=>e.startsWith(t)))?qs(e,t):zs(e,t),zs=(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:s.a.createElement(_s,{values:t}),index:s.a.createElement(ee.EuiCode,null,e),explanation:Ls(t,e)}}),qs=(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingDataStreamPrivileges",defaultMessage:"Missing {privileges} privileges for the {dataStream} data stream. {explanation}",values:{privileges:s.a.createElement(_s,{values:t}),dataStream:s.a.createElement(ee.EuiCode,null,e),explanation:Ls(t,e)}}),$s=(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:s.a.createElement(_s,{values:t}),index:s.a.createElement(ee.EuiCode,null,e),explanation:Ls(t,e)}}),Vs=["read","write","view_index_metadata","manage"],Us=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),a=e[t],n=Vs.filter((e=>!a[e]));if(n.length)return[t,n]},Hs=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(Dt.a)(),[{canUserCRUD:a}]=Object(kt.b)();return Object(r.useMemo)((()=>{const n=[],i=[];if(null==a||null==t.result||null==e.result)return{featurePrivileges:n,indexPrivileges:i};!1===a&&n.push([l.sc,["all"]]);const r=Us(t.result.listItems.index);r&&i.push(r);const s=Us(t.result.lists.index);s&&i.push(s);const o=Us(e.result.index);return o&&i.push(o),{featurePrivileges:n,indexPrivileges:i}}),[a,t,e])})(),t=Object(r.useMemo)((()=>e.indexPrivileges.length>0||e.featurePrivileges.length>0?{type:"primary",id:`missing-user-privileges-${Ms()(e)}`,title:As,description:Ns(e)}:null),[e]);return t&&s.a.createElement(us,{namespace:"detections",condition:!0,message:t})},Qs=Object(r.memo)(Hs);var Gs=a(574),Ws=a(13),Zs=a(713),Ks=a(716),Js=a(439);const Ys=ae.a.h1.withConfig({displayName:"Header",componentId:"sc-1epdllw-0"})(["display:grid;grid-gap:12px;grid-template-columns:auto auto;align-items:center;justify-items:start;justify-content:start;"]);Ys.displayName="Header";const Xs=ae.a.span.withConfig({displayName:"TitleWrapper",componentId:"sc-1epdllw-1"})(["min-width:0;max-width:100%;"]);Xs.displayName="TitleWrapper";const eo=({title:e,badgeOptions:t})=>s.a.createElement(ee.EuiTitle,{size:"l"},s.a.createElement(Ys,{"data-test-subj":"header-page-title"},s.a.createElement(Xs,null,s.a.createElement(Js.b,{tooltipContent:e},e)),t&&s.a.createElement(s.a.Fragment,null,t.beta?s.a.createElement(ee.EuiBetaBadge,{label:t.text,tooltipContent:t.tooltip,tooltipPosition:"bottom",size:t.size}):s.a.createElement(ee.EuiBadge,{color:t.color||"hollow",title:""},t.text)))),to=s.a.memo(eo),ao=ae.a.div.attrs({className:"securitySolutionHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-1acc7vc-0"})(["",""],(({theme:e})=>Object(te.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));ao.displayName="LinkBack";const no=ae()(ee.EuiPageHeaderSection).withConfig({displayName:"HeaderSection",componentId:"sc-1acc7vc-1"})(["min-width:0;max-width:100%;"]);function io(){const{euiTheme:e}=Object(ee.useEuiTheme)();return s.a.createElement(lo,{$_css:e.border.thin})}no.displayName="HeaderSection";const ro=s.a.memo((({backOptions:e})=>{var t,a;const{navigateToUrl:n}=Object(h.i)().services.application,{formatUrl:i}=Object(y.l)(e.pageId),r=i(null!==(t=e.path)&&void 0!==t?t:"");return s.a.createElement(ao,null,s.a.createElement(Zs.a,{dataTestSubj:null!==(a=e.dataTestSubj)&&void 0!==a?a:"link-back",onClick:e=>{e.preventDefault(),n(r)},href:r,iconType:"arrowLeft"},e.text))}));ro.displayName="HeaderLinkBack";const so=({backOptions:e,backComponent:t,badgeOptions:a,border:n,children:i,isLoading:r,rightSideItems:o,subtitle:l,subtitle2:c,title:u,titleNode:d})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiPageHeader,{alignItems:"center",rightSideItems:o},s.a.createElement(no,null,e&&s.a.createElement(ro,{backOptions:e}),!e&&t&&s.a.createElement(s.a.Fragment,null,t),d||s.a.createElement(to,{title:u,badgeOptions:a}),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(Ks.a,{"data-test-subj":"header-page-subtitle",items:l})),n&&r&&s.a.createElement(ee.EuiProgress,{size:"xs",color:"accent"})),i&&s.a.createElement(ee.EuiPageHeaderSection,{"data-test-subj":"header-page-supplements"},i)),c&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(Ks.a,{"data-test-subj":"header-page-subtitle-2",items:c})),n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(io,null)),s.a.createElement(ee.EuiSpacer,{size:"l"})),oo=s.a.memo(so);var lo=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1acc7vc-2"})(["border-bottom:",";"],(e=>e.$_css)),co=a(435),uo=a(151);const po=({status:e=uo.d,onFilterGroupChanged:t})=>{const a=[{id:"open",label:ar.J,"data-test-subj":"openAlerts"},{id:"acknowledged",label:ar.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:ar.A,"data-test-subj":"closedAlerts"}],n=Object(r.useCallback)((e=>{t(e)}),[t]);return s.a.createElement(ee.EuiButtonGroup,{legend:"filter status",color:"primary",options:a,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:n})},mo=s.a.memo(po);var fo=a(23),bo=a.n(fo),go=a(740),yo=a(1406),ho=a(762);ae.a.span.withConfig({displayName:"UnitCount",componentId:"sc-1p6k0dy-0"})(["font-size:",";font-weight:",";border-right:",";margin-right:",";padding-right:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM));const vo=e=>{return t=e,Y.i18n.translate("xpack.securitySolution.eventsTab.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {alert} other {alerts}}"});var t},Eo=s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"smallDot"},s.a.createElement(ee.EuiIcon,{type:"dot",color:"#54b399"})),s.a.createElement("span",{className:"smallDot"},s.a.createElement(ee.EuiIcon,{type:"dot",color:"#d6bf57"})),s.a.createElement("span",{className:"smallDot"},s.a.createElement(ee.EuiIcon,{type:"dot",color:"#da8b45"})),s.a.createElement("span",null,s.a.createElement(ee.EuiIcon,{type:"dot",color:"#e7664c"})),ar.U),xo=(e,t)=>{var a,n,i,r,o,l,c,u,d,p,m,f,b,g,y,h,v,E,x,j,S,O,k,w;const T=null!==(a=t.severitiesSubAggregation)&&void 0!==a&&a.buckets&&null!==(n=t.severitiesSubAggregation)&&void 0!==n&&null!==(i=n.buckets)&&void 0!==i&&i.length?(e=>{switch(e){case"low":return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiIcon,{type:"dot",color:"#54b399"}),ar.S);case"medium":return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiIcon,{type:"dot",color:"#d6bf57"}),ar.T);case"high":return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiIcon,{type:"dot",color:"#da8b45"}),ar.R);case"critical":return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiIcon,{type:"dot",color:"#e7664c"}),ar.Q)}return null})(null===(r=t.severitiesSubAggregation)||void 0===r?void 0:r.buckets[0].key.toString()):null,I=null!==(o=t.countSeveritySubAggregation)&&void 0!==o&&o.value&&(null===(l=t.countSeveritySubAggregation)||void 0===l?void 0:l.value)>1?Eo:T,C=I?[{title:ar.P,renderer:I}]:[],M=[{title:ar.M,badge:{value:t.doc_count,width:50,color:"#a83632"}}];switch(e){case"kibana.alert.rule.name":return[...C,{title:ar.V,badge:{value:null!==(c=null===(u=t.usersCountAggregation)||void 0===u?void 0:u.value)&&void 0!==c?c:0}},{title:ar.N,badge:{value:null!==(d=null===(p=t.hostsCountAggregation)||void 0===p?void 0:p.value)&&void 0!==d?d:0}},...M];case"host.name":return[...C,{title:ar.V,badge:{value:null!==(m=null===(f=t.usersCountAggregation)||void 0===f?void 0:f.value)&&void 0!==m?m:0}},{title:ar.O,badge:{value:null!==(b=null===(g=t.rulesCountAggregation)||void 0===g?void 0:g.value)&&void 0!==b?b:0}},...M];case"user.name":return[...C,{title:ar.N,badge:{value:null!==(y=null===(h=t.hostsCountAggregation)||void 0===h?void 0:h.value)&&void 0!==y?y:0}},{title:ar.O,badge:{value:null!==(v=null===(E=t.rulesCountAggregation)||void 0===E?void 0:E.value)&&void 0!==v?v:0}},...M];case"source.ip":return[...C,{title:ar.N,badge:{value:null!==(x=null===(j=t.hostsCountAggregation)||void 0===j?void 0:j.value)&&void 0!==x?x:0}},{title:ar.O,badge:{value:null!==(S=null===(O=t.rulesCountAggregation)||void 0===O?void 0:O.value)&&void 0!==S?S:0}},...M]}return[...C,{title:ar.O,badge:{value:null!==(k=null===(w=t.rulesCountAggregation)||void 0===w?void 0:w.value)&&void 0!==k?k:0}},...M]};var jo=a(55),So=a(1104),Oo=a(154);const ko=(e,t,a)=>{var n,i,r,o;switch(e){case"kibana.alert.rule.name":return Object(A.isArray)(t.key)?s.a.createElement(wo,{ruleName:t.key[0],ruleDescription:null!==(n=Object(pi.a)(null===(i=Object(pi.a)(null===(r=t.description)||void 0===r?void 0:r.buckets))||void 0===i?void 0:i.key))&&void 0!==n?n:"",tags:null===(o=t.ruleTags)||void 0===o?void 0:o.buckets}):void 0;case"host.name":return s.a.createElement(To,{hostName:t.key,nullGroupMessage:a});case"user.name":return s.a.createElement(Io,{userName:t.key,nullGroupMessage:a});case"source.ip":return s.a.createElement(Co,{sourceIp:t.key,nullGroupMessage:a})}},wo=s.a.memo((({ruleName:e,ruleDescription:t,tags:a})=>s.a.createElement("div",{style:{display:"table",tableLayout:"fixed",width:"100%"}},s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"rule-name-group-renderer",gutterSize:"m",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1,style:{display:"contents"}},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h5",{className:"eui-textTruncate"},e.trim()))),a&&a.length>0?s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(So.a,{items:a.map((e=>e.key.toString())),popoverTitle:Oo.pb,popoverButtonTitle:a.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>s.a.createElement(ee.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)})):null),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("p",{className:"eui-textTruncate"},s.a.createElement(ee.EuiTextColor,{color:"subdued"},t))))));wo.displayName="RuleNameGroup";const To=s.a.memo((({hostName:e,nullGroupMessage:t})=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"host-name-group-renderer",gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1,style:{backgroundColor:jo.euiThemeVars.euiColorVis1_behindText,borderRadius:"50%"}},s.a.createElement(ee.EuiIcon,{type:"database",size:"l",style:{padding:4}})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h5",null,e))),t&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiIconTip,{content:t,position:"right"})))));To.displayName="HostNameGroupContent";const Io=s.a.memo((({userName:e,nullGroupMessage:t})=>{var a;const n=null!==(a=Object(pi.a)(e))&&void 0!==a?a:"-";return s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"user-name-group-renderer",gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiAvatar,{name:n,color:jo.euiThemeVars.euiColorVis0})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h5",null,e))),t&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiIconTip,{content:t,position:"right"})))}));Io.displayName="UserNameGroupContent";const Co=s.a.memo((({sourceIp:e,nullGroupMessage:t})=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"source-ip-group-renderer",gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1,style:{backgroundColor:jo.euiThemeVars.euiColorVis3_behindText,borderRadius:"50%"}},s.a.createElement(ee.EuiIcon,{style:{padding:4},type:"ip",size:"l"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h5",null,e))),t&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiIconTip,{content:t,position:"right"})))));Co.displayName="SourceIpGroupContent";var Mo=a(184),_o=a(1387),Ao=a(1158),Fo=a(925),Po=a(22),Do=a(21);const No=e=>{const t=[{unitsCount:{cardinality:{field:"kibana.alert.uuid"}}}];switch(e){case"kibana.alert.rule.name":t.push({description:{terms:{field:"kibana.alert.rule.description",size:1}}},{countSeveritySubAggregation:{cardinality:{field:"kibana.alert.severity"}}},{severitiesSubAggregation:{terms:{field:"kibana.alert.severity"}}},{usersCountAggregation:{cardinality:{field:"user.name"}}},{hostsCountAggregation:{cardinality:{field:"host.name"}}},{ruleTags:{terms:{field:"kibana.alert.rule.tags"}}});break;case"host.name":t.push({rulesCountAggregation:{cardinality:{field:"kibana.alert.rule.rule_id"}}},{countSeveritySubAggregation:{cardinality:{field:"kibana.alert.severity"}}},{severitiesSubAggregation:{terms:{field:"kibana.alert.severity"}}},{usersCountAggregation:{cardinality:{field:"user.name"}}});break;case"user.name":case"source.ip":t.push({rulesCountAggregation:{cardinality:{field:"kibana.alert.rule.rule_id"}}},{countSeveritySubAggregation:{cardinality:{field:"kibana.alert.severity"}}},{severitiesSubAggregation:{terms:{field:"kibana.alert.severity"}}},{hostsCountAggregation:{cardinality:{field:"host.name"}}});break;default:t.push({rulesCountAggregation:{cardinality:{field:"kibana.alert.rule.rule_id"}}})}return t};var Ro=a(54),Lo=a(172),Bo=a(319),zo=a(1169);const qo=({currentAlertStatusFilterValue:e,defaultFilters:t=[],from:a,getGrouping:n,globalFilters:i,globalQuery:o,groupingLevel:l,hasIndexMaintenance:c,hasIndexWrite:u,loading:p,onGroupClose:m,pageIndex:f,pageSize:b,parentGroupingFilter:g,renderChildComponent:y,runtimeMappings:v,selectedGroup:j,setPageIndex:S,setPageSize:O,signalIndexName:k,tableId:w,to:T})=>{const{services:{uiSettings:I}}=Object(h.i)(),{browserFields:C,indexPattern:M}=Object(E.d)(x.SourcererScopeName.detections),_=Object(r.useCallback)((e=>null!=C&&null!=M?Object(Lo.d)({config:Object(Ro.getEsQueryConfig)(I),dataProviders:[],indexPattern:M,browserFields:C,filters:[...null!=t?t:[],...i,...e,...g?JSON.parse(g):[],...Object(zo.a)(a,T)],kqlQuery:o,kqlMode:o.language}):null),[C,t,a,i,o,M,g,T,I]),A=Object(r.useMemo)((()=>{try{var e;return[Object(za.buildEsQuery)(void 0,null!=o?[o]:[],[...null!==(e=null==i?void 0:i.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],...null!=t?t:[],...g?JSON.parse(g):[]])]}catch(e){return[]}}),[t,i,o,g]),P=Object(r.useMemo)((()=>`SuperUniqueValue-${Object(Ma.v4)()}`),[]),D=Object(r.useMemo)((()=>(({additionalFilters:e,from:t,pageIndex:a,pageSize:n,runtimeMappings:i,selectedGroup:r,uniqueValue:s,to:o})=>Object(go.d)({additionalFilters:e,from:t,groupByField:r,statsAggregations:Object(go.e)([r])?[]:No(r),pageNumber:a*n,runtimeMappings:i,uniqueValue:s,size:n,sort:[{unitsCount:{order:"desc"}}],to:o}))({additionalFilters:A,selectedGroup:j,uniqueValue:P,from:a,runtimeMappings:v,to:T,pageSize:b,pageIndex:f})),[A,a,f,b,v,j,T,P]),N=Object(r.useMemo)((()=>_([])),[_]);Object(Bo.a)({id:w,filterQuery:null==N?void 0:N.filterQuery,kqlError:null==N?void 0:N.kqlError,query:o,startDate:a,endDate:T});const{data:R,loading:L,refetch:q,request:$,response:V,setQuery:U}=Object(B.a)({query:D,indexName:k,queryName:z.a.ALERTS_GROUPING,skip:Object(go.e)([j])}),H=Object(r.useRef)(null),Q=Object(r.useMemo)((()=>Object(go.f)(null===H.current?j:H.current,P,null==R?void 0:R.aggregations)),[null==R?void 0:R.aggregations,j,P]);Object(r.useEffect)((()=>{var e,t,a,n,i;Object(go.e)([j])||(H.current=null!==(e=null==D||null===(t=D.runtime_mappings)||void 0===t||null===(a=t.groupByField)||void 0===a||null===(n=a.script)||void 0===n||null===(i=n.params)||void 0===i?void 0:i.selectedGroup)&&void 0!==e?e:"",U(D))}),[D,j,U]);const{deleteQuery:G,setQuery:W}=Object(xe.a)(),Z=Object(r.useMemo)((()=>`alerts-grouping-${Object(Ma.v4)()}`),[]);Object(qa.a)({deleteQuery:G,loading:L,refetch:q,request:$,response:V,setQuery:W,uniqueQueryId:Z});const K=Object(r.useMemo)((()=>s.a.createElement(ga.b,{queryId:Z,inspectIndex:0,title:ar.E})),[Z]),J=(({currentStatus:e,showAlertStatusActions:t=!0})=>{const{addSuccess:a,addError:n,addWarning:i}=Object(Pt.a)(),{startTransaction:o}=Object(Mo.b)(),l=mt.d.globalQuery(),c=Object(F.a)(l),u=Object(r.useCallback)((()=>{c.forEach((e=>e.refetch&&e.refetch()))}),[c]),{services:{telemetry:p}}=Object(d.useKibana)(),m=Object(r.useCallback)((e=>{p.reportAlertsGroupingTakeAction(e)}),[p]),f=Object(r.useCallback)(((e,t,a)=>{u()}),[u]),b=Object(r.useCallback)(((e,t)=>{u()}),[u]),g=Object(r.useCallback)(((e,t,n)=>{if(t>0)i({title:Object(Po.f)(t),text:Object(Po.g)(e,t)});else{let t;switch(n){case"closed":t=ar.C(e);break;case"open":t=ar.I(e);break;case"acknowledged":t=ar.c(e)}a({title:t})}f&&f(e,t,n)}),[a,i,f]),y=Object(r.useCallback)(((e,t)=>{let a;switch(e){case"closed":a=ar.B;break;case"open":a=ar.H;break;case"acknowledged":a=ar.b}n(t.message,{title:a}),b&&b(e,t)}),[n,b]),h=Object(r.useCallback)((async({groupNumber:e,query:t,status:a,tableId:n,selectedGroup:i})=>{o(t?{name:_o.a.BULK_QUERY_STATUS_UPDATE}:{name:_o.a.STATUS_UPDATE}),Object(Do.h)(Do.a.CLICK,Do.e.groupedAlertsTakeAction({tableId:n,groupNumber:e,status:a})),m({tableId:n,groupNumber:e,status:a,groupByField:i});try{var r,s;const e=await Object(Ao.a)({status:a,query:t?JSON.parse(t):{}});g(null!==(r=e.updated)&&void 0!==r?r:0,null!==(s=e.version_conflicts)&&void 0!==s?s:0,a)}catch(e){y(a,e)}}),[o,m,g,y]);return Object(r.useMemo)((()=>({query:a,tableId:n,groupNumber:i,selectedGroup:r})=>{const o=[];if(t)if(e&&1===e.length){const t=e[0];t!==uo.d&&o.push(s.a.createElement(ee.EuiContextMenuItem,{key:"open","data-test-subj":"open-alert-status",onClick:()=>h({groupNumber:i,query:a,selectedGroup:r,status:uo.d,tableId:n})},Fo.m)),t!==uo.b&&o.push(s.a.createElement(ee.EuiContextMenuItem,{key:"acknowledge","data-test-subj":"acknowledged-alert-status",onClick:()=>h({groupNumber:i,query:a,selectedGroup:r,status:uo.b,tableId:n})},Fo.j)),t!==uo.c&&o.push(s.a.createElement(ee.EuiContextMenuItem,{key:"close","data-test-subj":"close-alert-status",onClick:()=>h({groupNumber:i,query:a,selectedGroup:r,status:uo.c,tableId:n})},Fo.k))}else{const e={[uo.d]:Fo.m,[uo.b]:Fo.j,[uo.c]:Fo.k};Object.keys(e).forEach((t=>o.push(s.a.createElement(ee.EuiContextMenuItem,{key:t,"data-test-subj":`${t}-alert-status`,onClick:()=>h({groupNumber:i,query:a,selectedGroup:r,status:t,tableId:n})},e[t]))))}return o}),[e,h,t])})({currentStatus:e,showAlertStatusActions:u&&c}),Y=Object(r.useCallback)(((e,a)=>{var n;return J({groupNumber:a,query:null===(n=_([...null!=t?t:[],...e]))||void 0===n?void 0:n.filterQuery,selectedGroup:j,tableId:w})}),[t,_,j,w,J]);return Object(r.useMemo)((()=>n({activePage:f,data:Q,groupingLevel:l,inspectButton:K,isLoading:p||L,itemsPerPage:b,onChangeGroupsItemsPerPage:e=>O(e),onChangeGroupsPage:e=>S(e),onGroupClose:m,renderChildComponent:y,selectedGroup:j,takeActionItems:Y})),[Q,n,Y,l,K,L,p,m,f,b,y,j,S,O])},$o=s.a.memo(qo),Vo=e=>{const t=Object(c.useDispatch)(),{indexPattern:a,selectedPatterns:n}=Object(E.d)(x.SourcererScopeName.detections),{services:{storage:i,telemetry:o}}=Object(h.i)(),{getStoragePageSize:l,setStoragePageSize:u}=((e,t)=>Object(r.useMemo)((()=>({getStoragePageSize:()=>e.get(`grouping-table-${t}`)||Array(3).fill(25),setStoragePageSize:a=>{e.set(`grouping-table-${t}`,a)}})),[e,t]))(i,e.tableId),{onGroupChange:d,onGroupToggle:p}=Object(r.useMemo)((()=>({onGroupChange:e=>{o.reportAlertsGroupingChanged(e)},onGroupToggle:e=>o.reportAlertsGroupingToggled({...e,tableId:e.groupingId})})),[o]),m=Object(r.useCallback)((a=>{t(Object(ho.a)({tableId:e.tableId,options:a}))}),[t,e.tableId]),{getGrouping:f,selectedGroups:b,setSelectedGroups:g}=Object(go.g)({componentProps:{groupPanelRenderer:ko,groupStatsRenderer:xo,onGroupToggle:p,unit:vo},defaultGroupingOptions:Object(q.c)(e.tableId),fields:a.fields,groupingId:e.tableId,maxGroupingLevels:3,onGroupChange:d,onOptionsChange:m,tracker:Do.h}),y=Object(F.a)((t=>Object(yo.a)()(t,e.tableId)));Object(r.useEffect)((()=>{Object(go.e)(b)&&t(Object(ho.a)({activeGroups:b,tableId:e.tableId}))}),[t,e.tableId,b]),Object(r.useEffect)((()=>{null==y||Object(go.e)(y.activeGroups)||g(y.activeGroups)}),[y,g]);const[v,j]=Object(r.useState)(Array(3).fill(0)),[S,O]=Object(r.useState)(l),k=Object(r.useCallback)((()=>{j((e=>e.map((()=>0))))}),[]),w=Object(r.useCallback)(((e,t,a)=>{"index"===a&&j((a=>{const n=[...a];return n[t]=e,n})),"size"===a&&(O((a=>{const n=[...a];return n[t]=e,u(n),n})),j((e=>{const a=[...e];return a[t]=0,a})))}),[u]),T=Object(r.useRef)({defaultFilters:e.defaultFilters,globalFilters:e.globalFilters,globalQuery:e.globalQuery,selectedGroups:b});Object(r.useEffect)((()=>{const t={defaultFilters:e.defaultFilters,globalFilters:e.globalFilters,globalQuery:e.globalQuery,selectedGroups:b};Object(A.isEqual)(T.current,t)||(k(),T.current=t)}),[e.defaultFilters,e.globalFilters,e.globalQuery,k,b]);const I=Object(r.useCallback)(((t,a,n)=>{var i,r;let o;return o=t<b.length-1?e=>I(t+1,b[t+1],JSON.stringify([...e,...n?JSON.parse(n):[]])):t=>e.renderChildComponent([...t,...n?JSON.parse(n):[]]),s.a.createElement($o,bo()({},e,{getGrouping:f,groupingLevel:t,onGroupClose:()=>{return e=t,void j((t=>{const a=t.splice(e+1,t.length);return[...t,...a.map((()=>0))]}));var e},pageIndex:null!==(i=v[t])&&void 0!==i?i:0,pageSize:null!==(r=S[t])&&void 0!==r?r:25,parentGroupingFilter:n,renderChildComponent:o,selectedGroup:a,setPageIndex:e=>w(e,t,"index"),setPageSize:e=>w(e,t,"size")}))}),[f,v,S,e,b,w]);return Object(A.isEmpty)(n)?null:I(0,b[0])},Uo=s.a.memo(Vo);var Ho=a(19),Qo=a(204),Go=a(196);const Wo=[{columnHeaderType:Go.a,id:"@timestamp",initialWidth:Qo.b,esTypes:["date"],type:"date"},{columnHeaderType:Go.a,id:"message"},{columnHeaderType:Go.a,id:"host.name"},{columnHeaderType:Go.a,id:"event.module"},{columnHeaderType:Go.a,id:"agent.type"},{columnHeaderType:Go.a,id:"event.dataset"},{columnHeaderType:Go.a,id:"event.action"},{columnHeaderType:Go.a,id:"user.name"},{columnHeaderType:Go.a,id:"source.ip"},{columnHeaderType:Go.a,id:"destination.ip"}],Zo={...W.q,columns:Wo};var Ko=a(1315),Jo=a(1134),Yo=a(1066),Xo=a(1316),el=a(1298),tl=a(357);const{updateIsLoading:al,updateTotalCount:nl}=W.h,il=e=>!!e[Ca.b],rl=ae()(ee.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroupTable",componentId:"sc-ikpuyo-0"})(["overflow:hidden;margin:0;display:",";"],(({$visible:e})=>e?"flex":"none")),sl=ae.a.div.withConfig({displayName:"EuiDataGridContainer",componentId:"sc-ikpuyo-1"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}div .euiDataGridRowCell__contentWrapper{display:flex;align-items:center;}div .euiDataGridRowCell__content{width:100%;}div .euiDataGridRowCell--lastColumn .euiDataGridRowCell__content{flex-grow:0;}div .siemEventsTable__trSupplement--summary{display:block;}width:100%;"],(({hideLastPage:e})=>e?"display:none":"")),ol=({configId:e,inputFilters:t,tableId:a=W.e.alertsOnAlertsPage,sourcererScope:n=x.SourcererScopeName.detections,isLoading:i,onRuleChange:o})=>{const{triggersActionsUi:u,uiSettings:d}=Object(h.i)().services,{from:p,to:m,setQuery:f}=Object(xe.a)(),b=Object(r.useRef)(null),g=Object(c.useDispatch)(),[y]=Object(r.useState)({timelineID:a,tabType:"query",enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0,onRuleChange:o}),{browserFields:v,indexPattern:j,runtimeMappings:S}=Object(E.d)(n),O=Object(be.b)(),k=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),w=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),T=Object(F.a)(w),I=Object(F.a)(k),C=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),M=Object(F.b)((e=>{var t;return(null!==(t=C(e,a))&&void 0!==t?t:W.q).initialized})),_=Object(r.useMemo)((()=>Object(zo.a)(p,m)),[p,m]),A=Object(r.useMemo)((()=>[...t,...null!=I?I:[],...null!=_?_:[]]),[t,I,_]),{dataTable:{graphEventId:P,sessionViewConfig:D,viewMode:N=Zo.viewMode,columns:R}=Object(Qt.g)(O)}=Object(F.b)((e=>Object(el.a)(e,a))),L=Object(r.useMemo)((()=>null!=v&&null!=j?Object(Lo.d)({config:Object(Ho.getEsQueryConfig)(d),dataProviders:[],indexPattern:j,browserFields:v,filters:[...A],kqlQuery:T,kqlMode:T.language}):null),[v,T,j,d,A]);Object(Bo.a)({id:a,filterQuery:null==L?void 0:L.filterQuery,kqlError:null==L?void 0:L.kqlError,query:T,startDate:p,endDate:m});const B=Object(r.useMemo)((()=>null!=L&&L.kqlError||null==L||!L.filterQuery?{bool:{}}:{bool:{filter:JSON.parse(null==L?void 0:L.filterQuery)}}),[null==L?void 0:L.filterQuery,null==L?void 0:L.kqlError]),z=N===l.Mc.eventRenderedView,q=Object(r.useMemo)((()=>({border:"none",fontSize:"s",header:"underline",stripes:z})),[z]),$=Object(r.useMemo)((()=>{if(z)return{defaultHeight:"auto"}}),[z]),V=Object(r.useMemo)((()=>R.length?R:Object(Xo.b)(O)),[R,O]),U=Object(r.useMemo)((()=>z?{}:v),[z,v]),H=Object(r.useMemo)((()=>z?tl.b:V),[V,z]),Q=Object(r.useCallback)((({isLoading:e,totalCount:t,refresh:n})=>{g(al({id:a,isLoading:e})),g(nl({id:a,totalCount:t})),b.current=n,f({id:a,loading:e,refetch:n,inspect:null})}),[g,a,b,f]),G=Object(r.useMemo)((()=>({alertsTableConfigurationRegistry:u.alertsTableConfigurationRegistry,configurationId:e,id:`detection-engine-alert-table-${e}-${N}`,featureIds:["siem"],query:B,gridStyle:q,shouldHighlightRow:il,rowHeightsOptions:$,columns:H,browserFields:U,onUpdate:Q,runtimeMappings:S,toolbarVisibility:{showColumnSelector:!z,showSortSelector:!z},dynamicRowHeight:z})),[u.alertsTableConfigurationRegistry,e,N,B,q,$,H,U,Q,S,z]);Object(r.useEffect)((()=>{M||g(W.h.initializeDataTableSettings({id:a,title:ar.K,defaultColumns:H.map((e=>({initialWidth:Qo.a,...e})))}))}),[g,a,H,M]);const Z=Object(r.useMemo)((()=>u.getAlertsStateTable(G)),[G,u]),{Navigation:K}=Object(Jo.b)({scopeId:a}),{DetailsPanel:J,SessionView:Y}=Object(Jo.a)({entityType:"events",scopeId:a}),X=Object(r.useMemo)((()=>null!=P&&P.length>0||null!=D?s.a.createElement(Ko.a,{scopeId:a,SessionView:Y,Navigation:K}):null),[P,a,D,Y,K]);return i?null:s.a.createElement("div",null,X,s.a.createElement(rl,{$visible:!P&&null==X,gutterSize:"none"},s.a.createElement(Yo.a.Provider,{value:y},s.a.createElement(sl,{hideLastPage:!1},Z))),J)},ll=ae()(ee.EuiButton).withConfig({displayName:"FilterGroupLoadingButton",componentId:"sc-10d8hps-0"})(["height:34px;"]),cl=()=>s.a.createElement(ll,{color:"text"},s.a.createElement(ee.EuiLoadingChart,{className:"filter-group__loading","data-test-subj":re}));var ul=a(102),dl=a(103),pl=a(75);const ml=e=>e.map((({title:e,fieldName:t,selectedOptions:a=[],existsSelected:n=!1,exclude:i=!1})=>({title:null!=e?e:t,selectedOptions:a,fieldName:t,existsSelected:n,exclude:i})));var fl=a(421);const bl=e=>{const t=(e=>{const t=e.panels;return Object.values(t).sort(((e,t)=>e.order-t.order))})(e);return t.map((e=>{const{explicitInput:{fieldName:t,selectedOptions:a,title:n,existsSelected:i,exclude:r,hideActionBar:s}}=e;return{fieldName:t,selectedOptions:null!=a?a:[],title:n,existsSelected:null!=i&&i,exclude:null!=r&&r,hideActionBar:null!=s&&s}}))},gl=e=>{const{controls:t,defaultControls:a}=e,n=t.reduce(((e,t)=>(e[t.fieldName]=t,e)),{}),i=a.reduce(((e,t)=>(e[t.fieldName]=t,e)),{});return[...a.filter((e=>e.persist)).map((e=>{var t;return{...e,...null!==(t=n[e.fieldName])&&void 0!==t?t:{}}})),...t.filter((e=>{var t;return!(null!==(t=i[e.fieldName])&&void 0!==t&&t.persist)})).map((e=>{var t;return{...null!==(t=i[e.fieldName])&&void 0!==t?t:{},...e}}))]},yl=(...e)=>(t,a)=>{if(t.length!==a.length)return!1;const n=t.map((t=>Object(I.pick)(t,e))),i=a.map((t=>Object(I.pick)(t,e)));return Object(I.isEqual)(n,i)};a(1653);var hl=a(620),vl=a(15);const El=Object(r.createContext)(void 0),xl=()=>{const e=Object(r.useContext)(El);if(!e)throw new Error("FilterContext should only be used inside FilterGroup Wrapper");return e},jl=Y.i18n.translate("xpack.securitySolution.filtersGroup.pendingChanges",{defaultMessage:"Save pending changes"}),Sl=Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.editControls",{defaultMessage:"Edit Controls"}),Ol=Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.addControls",{defaultMessage:"Add Controls"}),kl=(Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.saveControls",{defaultMessage:"Save Controls"}),Y.i18n.translate("xpack.securitySolution.filtersGroup.discardChanges",{defaultMessage:"Discard Changes"})),wl=Y.i18n.translate("xpack.securitySolution.filterGroup.groupMenuTitle",{defaultMessage:"Filter group menu"}),Tl=Y.i18n.translate("xpack.securitySolution.filterGroup.filtersChangedBanner",{defaultMessage:"Filter Controls have changed"}),Il=Y.i18n.translate("xpack.securitySolution.filterGroup.filtersChangedTitle",{defaultMessage:"New filter controls on this page are different from what you have previously saved. You can either save the changes or discard them. \n       Navigating away will automatically discard these changes"}),Cl=Y.i18n.translate("xpack.securitySolution.filterGroup.contextMenu.resetTooltip",{defaultMessage:"Reset Controls to factory settings"}),Ml=Y.i18n.translate("xpack.securitySolution.filterGroup.contextMenu.reset",{defaultMessage:"Reset Controls"}),_l=Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.saveChanges",{defaultMessage:"Save Changes"}),Al=Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.revertChanges",{defaultMessage:"Revert Changes"}),Fl=Y.i18n.translate("xpack.securitySolution.filtersGroup.contextMenu.addControls.maxLimit",{defaultMessage:"Maximum of 4 controls can be added."}),Pl=Y.i18n.translate("xpack.securitySolution.filtersGroup.urlParam.arrayError",{defaultMessage:"Page filter URL Params must be an array"}),Dl=()=>{const[e,t]=Object(r.useState)(!1),{isViewMode:a,controlGroupInputUpdates:n,controlGroup:i,switchToViewMode:o,switchToEditMode:l,initialControls:c,dataViewId:u,setShowFiltersChangedBanner:d,discardChangesHandler:p}=xl(),m=Object(r.useCallback)((()=>{t((e=>!e))}),[]),f=Object(r.useCallback)((e=>()=>{"function"==typeof e&&e(),m()}),[m]),b=Object(r.useCallback)((async()=>{if(n){null==i||i.updateInput({panels:{}});for(let e=0;e<c.length;e++){const t=c[e];await(null==i?void 0:i.addOptionsListControl({controlId:String(e),...me,dataViewId:null!=u?u:"",...t}))}o(),d(!1)}}),[n,i,c,u,o,d]),g=Object(r.useMemo)((()=>s.a.createElement(ee.EuiContextMenuItem,{key:"reset",icon:"eraser","aria-label":Ml,onClick:f(b),"data-test-subj":de.RESET,toolTipContent:Cl},Ml)),[f,b]),y=Object(r.useMemo)((()=>s.a.createElement(ee.EuiContextMenuItem,{key:"edit",icon:a?"pencil":"minusInCircle","aria-label":a?Sl:kl,onClick:f(a?l:p),"data-test-subj":a?de.EDIT:de.DISCARD},a?Sl:kl)),[f,a,l,p]),h=Object(r.useMemo)((()=>[g,y]),[g,y]);return s.a.createElement(ee.EuiPopover,{id:de.MENU,button:s.a.createElement(ee.EuiButtonIcon,{"aria-label":wl,display:"empty",size:"s",iconType:"boxesHorizontal",onClick:m,"data-test-subj":de.BTN}),isOpen:e,closePopover:m,panelPaddingSize:"none",anchorPosition:"downLeft",panelProps:{"data-test-subj":de.MENU}},s.a.createElement(ee.EuiContextMenuPanel,{items:h}))},Nl=({onClick:e,...t})=>{const{isDisabled:a}=t;return s.a.createElement(ee.EuiToolTip,{content:a?Fl:Ol},s.a.createElement(ee.EuiButtonIcon,bo()({size:"s",iconSize:"m",display:"base","aria-label":a?Fl:Ol,"data-test-subj":se,onClick:e},t,{iconType:"plusInCircle"})))},Rl=({onClick:e})=>{const{hasPendingChanges:t,openPendingChangesPopover:a,closePendingChangesPopover:n,pendingChangesPopoverOpen:i}=xl();return s.a.createElement(ee.EuiPopover,{button:s.a.createElement(ee.EuiButtonIcon,{"aria-label":_l,size:"s",iconSize:"m",display:"base",color:"primary",iconType:"save","data-test-subj":oe,onClick:e,onFocus:a,onBlur:n,onMouseOver:a,onMouseOut:n,disabled:!t}),isOpen:i,anchorPosition:"upCenter",panelPaddingSize:"none",closePopover:n,panelProps:{"data-test-subj":le}},s.a.createElement("div",{style:{maxWidth:"200px"}},s.a.createElement(ee.EuiCallOut,{title:jl,color:"warning",iconType:"alert",size:"s"})))},Ll=({saveChangesHandler:e,discardChangesHandler:t})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiCallOut,{"data-test-subj":ce,title:Tl,iconType:"iInCircle"},s.a.createElement("p",null,Il),s.a.createElement(ee.EuiButton,{"data-test-subj":"filter-group__save",color:"primary",onClick:e},_l),s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":ue,onClick:t},Al)))),Bl=ae.a.div.attrs((e=>({className:e.className}))).withConfig({displayName:"FilterWrapper",componentId:"sc-n9v3gv-0"})(["& .euiFilterButton-hasActiveFilters{font-weight:400;}& .controlGroup{min-height:40px;}"]),zl=(ql=e=>{const{dataViewId:t,onFilterChange:a,timeRange:n,filters:i,query:o,chainingSystem:u,initialControls:d,spaceId:p,onInit:m}=e,f=Object(r.useRef)(),b=Object(r.useRef)(),g=Object(r.useMemo)((()=>d.reduce(((e,t)=>(e[t.fieldName]=t,e)),{})),[d]),[y,h]=Object(r.useState)(),v=Object(r.useMemo)((()=>`${l.i}.${p}.${bt.a.pageFilter}`),[p]),E=Object(r.useRef)(),{isViewMode:x,hasPendingChanges:j,pendingChangesPopoverOpen:S,closePendingChangesPopover:O,openPendingChangesPopover:k,switchToViewMode:w,switchToEditMode:T,setHasPendingChanges:C}=(({controlGroup:e,initialMode:t=pl.ViewMode.VIEW})=>{const[a,n]=Object(r.useState)(t),[i,s]=Object(r.useState)(!1),[o,l]=Object(r.useState)(!1);Object(r.useEffect)((()=>{e&&e.getInput().viewMode!==a&&e.updateInput({viewMode:a})}),[e,a]),Object(r.useEffect)((()=>{l(i)}),[i]);const c=Object(r.useCallback)((()=>{l(!1)}),[]),u=Object(r.useCallback)((()=>{i&&l(!0)}),[i]),d=Object(r.useCallback)((()=>{null==e||e.updateInput({viewMode:pl.ViewMode.EDIT}),n(pl.ViewMode.EDIT)}),[e]),p=Object(r.useCallback)((()=>{null==e||e.updateInput({viewMode:pl.ViewMode.VIEW}),s(!1),n(pl.ViewMode.VIEW)}),[e]);return{isViewMode:a===pl.ViewMode.VIEW,hasPendingChanges:i,pendingChangesPopoverOpen:o,closePendingChangesPopover:c,openPendingChangesPopover:u,switchToEditMode:d,switchToViewMode:p,setHasPendingChanges:s}})({controlGroup:y}),{controlGroupInput:M,setControlGroupInput:_,getStoredControlGroupInput:A}=(({storageKey:e,shouldSync:t})=>{const a=Object(r.useRef)(new vl.Storage(localStorage)),[n,i]=Object(r.useState)((()=>{var t;return null!==(t=a.current.get(e))&&void 0!==t?t:void 0}));return Object(r.useEffect)((()=>{t&&n&&a.current.set(e,n)}),[t,n,e]),{controlGroupInput:n,setControlGroupInput:i,getStoredControlGroupInput:()=>{var t;return null!==(t=a.current.get(e))&&void 0!==t?t:void 0}}})({storageKey:v,shouldSync:x}),[F,P]=Object(r.useState)(),[D,N]=Object(r.useState)(!1),R=Object(r.useRef)(!1);Object(ft.b)(bt.a.pageFilter,(e=>{if(e)try{if(!Array.isArray(e))throw new Error(Pl);const t=A();if(t){const a=bl(t);Object(I.isEqualWith)(a,e,yl("fieldName","title"))||(N(!0),T())}P(e)}catch(e){console.error(e),P([])}else P([])})),Object(r.useEffect)((()=>()=>{[f.current,b.current].forEach((e=>{e&&e.unsubscribe()}))}),[]);const{filters:L,query:B}=Object(r.useMemo)((()=>{const[e,t]=Object(Lo.i)({config:{},queries:o?[o]:[],filters:null!=i?i:[],indexPattern:{fields:[],title:""}});return t?{filters:[],query:void 0}:{filters:i,query:o}}),[i,o]);Object(r.useEffect)((()=>{null==y||y.updateInput({filters:L,query:B,timeRange:n,chainingSystem:u})}),[n,u,y,B,L]);const z=Object(r.useCallback)((e=>{var t;Object(I.isEqual)(A(),e)||(Object(I.isEqual)(e.panels,null===(t=A())||void 0===t?void 0:t.panels)||x||C(!0),_(e))}),[_,A,x,C]),q=Object(r.useCallback)((({filters:e,embeddableLoaded:t})=>{const n=Object.values(t).every((e=>Boolean(null==e||e)));Object(I.isEqual)(E.current,e)||n&&(a&&a(null!=e?e:[]),E.current=null!=e?e:[])}),[a]),$=Object(r.useMemo)((()=>Object(I.debounce)(q,0)),[q]);Object(r.useEffect)((()=>{if(y)return f.current=y.getOutput$().subscribe({next:$}),b.current=y.getInput$().subscribe({next:z}),()=>{[f.current,b.current].forEach((e=>{e&&e.unsubscribe()}))}}),[y,$,z]);const V=Object(r.useCallback)((e=>{e&&(m&&m(e),h(e))}),[m]),U=Object(r.useCallback)((()=>{const e=null!=F?F:[];let t=[];const a=A();a&&(t=bl(a));let n=(({controlsWithPriority:e,defaultControlsObj:t})=>{const a=e.find((e=>!Object(I.isEmpty)(e)));return null==a?void 0:a.map((e=>e.fieldName in t?{...t[e.fieldName],...e}:e))})({controlsWithPriority:[e,t],defaultControlsObj:g});return n&&0!==n.length?(n=n.map((e=>{var t,a;return{fieldName:e.fieldName,title:e.title,selectedOptions:null!==(t=e.selectedOptions)&&void 0!==t?t:[],existsSelected:null!==(a=e.existsSelected)&&void 0!==a&&a,exclude:e.exclude}})),gl({controls:n,defaultControls:d})):d}),[F,d,A,g]),H=Object(r.useCallback)((e=>"number"!==e.type),[]),Q=Object(r.useCallback)((async(e,{addOptionsListControl:a})=>{const r={...e,defaultControlWidth:"small",viewMode:pl.ViewMode.VIEW,timeRange:n,filters:i,query:o,chainingSystem:u},s=U();return R.current=!0,s.forEach(((e,n)=>{a(r,{controlId:String(n),...me,dataViewId:null!=t?t:"",...e})})),{initialInput:r,settings:{showAddButton:!1,staticDataViewId:null!=t?t:"",editorConfig:{hideWidthSettings:!0,hideDataViewSelector:!0,hideAdditionalSettings:!0}},fieldFilterPredicate:H}}),[t,n,i,u,o,U,H]);(({controlGroupInput:e})=>{const t=Object(c.useDispatch)(),a=Object(r.useMemo)((()=>{if(e)return bl(e)}),[e]);Object(r.useEffect)((()=>{a&&(null==e?void 0:e.viewMode)===pl.ViewMode.VIEW&&t(Object(fl.updateUrlParam)({key:bt.a.pageFilter,value:ml(a)}))}),[a,t,e])})({controlGroupInput:M});const G=Object(r.useCallback)((()=>{var e;j&&(null==y||y.updateInput({panels:null===(e=A())||void 0===e?void 0:e.panels})),w(),N(!1)}),[y,w,A,j]),W=Object(r.useCallback)((async()=>{if(!y)return;const e=bl(y.getInput()),a=gl({controls:e,defaultControls:d});if(!Object(I.isEqualWith)(a,e,yl("fieldName"))){null==y||y.updateInput({panels:{}});for(const e of a)await(null==y?void 0:y.addOptionsListControl({title:e.title,...me,dataViewId:null!=t?t:"",selectedOptions:e.selectedOptions,...e}))}}),[y,t,d]),Z=Object(r.useCallback)((async()=>{await W(),w(),N(!1)}),[w,W]),K=Object(r.useCallback)(((e,t)=>{let a=e;var n;return t===ul.OPTIONS_LIST_CONTROL&&(a={...e,...me},e.fieldName in g&&(a={...a,...g[e.fieldName],title:null!==(n=e.title)&&void 0!==n?n:a.title})),a}),[g]),J=Object(r.useCallback)((()=>{null==y||y.openAddDataControlFlyout({controlInputTransform:K})}),[y,K]);return s.a.createElement(El.Provider,{value:{dataViewId:null!=t?t:"",initialControls:d,isViewMode:x,controlGroup:y,controlGroupInputUpdates:M,hasPendingChanges:j,pendingChangesPopoverOpen:S,setHasPendingChanges:C,switchToEditMode:T,switchToViewMode:w,openPendingChangesPopover:k,closePendingChangesPopover:O,setShowFiltersChangedBanner:N,saveChangesHandler:Z,discardChangesHandler:G}},s.a.createElement(Bl,{className:"filter-group__wrapper"},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"s"},Array.isArray(F)?s.a.createElement(ee.EuiFlexItem,{grow:!0,"data-test-subj":ie},s.a.createElement(dl.ControlGroupRenderer,{ref:V,getCreationOptions:Q}),y?null:s.a.createElement(cl,null)):null,x||D?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Nl,{onClick:J,isDisabled:M&&Object.values(M.panels).length>=4})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Rl,{onClick:Z}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Dl,null))),D?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(Ll,{saveChangesHandler:Z,discardChangesHandler:G})):null))},$l=s.a.createElement(cl,null),e=>{const t=Object(hl.a)();return t?s.a.createElement(ql,bo()({},e,{spaceId:t})):null!=$l?$l:s.a.createElement(ee.EuiButton,{color:"text"},s.a.createElement(ee.EuiLoadingSpinner,{"data-test-subj":"filter-group__loading"}))});var ql,$l;const Vl="security_solution_alerts_dv",Ul=e=>{const{onFilterChange:t,...a}=e,{indexPattern:{title:n},dataViewId:i}=Object(E.d)(x.SourcererScopeName.detections),[o,c]=Object(r.useState)(!0),{services:{dataViews:u}}=Object(h.i)();Object(r.useEffect)((()=>((async()=>{const{timeFieldName:e="@timestamp"}=await u.get(null!=i?i:"");await u.create({id:Vl,name:"Security Solution Alerts DataView",title:n,allowNoIndex:!0,timeFieldName:e}),c(!1)})(),()=>u.clearInstanceCache())),[n,u,i]);const[d]=Object(r.useState)(l.G),p=Object(r.useCallback)((e=>{if(!t)return;const a=e.map((e=>({...e,meta:{...e.meta,disabled:!1}})));t(a)}),[t]);return o?s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(cl,null)):s.a.createElement(zl,bo()({dataViewId:Vl,onFilterChange:p,initialControls:d},a))},Hl=(e,t)=>Object(I.isEqual)(e,t),Ql=s.a.memo(Ul,Hl),Gl=ae.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7qbqfc-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Wl=({clearEventsLoading:e,clearEventsDeleted:t})=>{const a=Object(c.useDispatch)(),n=Object(r.useRef)(null),i=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),o=Object(F.b)((e=>{var t;return(null!==(t=i(e,W.e.alertsOnAlertsPage))&&void 0!==t?t:W.q).graphEventId})),u=Object(F.b)((e=>{var t;return(null!==(t=i(e,W.e.alertsOnAlertsPage))&&void 0!==t?t:W.q).isLoading})),d=Object(r.useMemo)((()=>Me.d.globalFiltersQuerySelector()),[]),p=Object(r.useMemo)((()=>Me.d.globalQuerySelector()),[]),m=Object(F.a)(p),f=Object(F.a)(d),{to:b,from:g}=Object(xe.a)(),{globalFullScreen:v}=Object(Vt.a)(),[{loading:j,isAuthenticated:O,hasEncryptionKey:k,signalIndexName:w,canUserREAD:T,hasIndexRead:C,hasIndexWrite:M,hasIndexMaintenance:_}]=Object(kt.b)(),{loading:D,needsConfiguration:N}=zt(),[R,L]=Object(r.useState)([]),B=Object(r.useCallback)((e=>{Object(I.isEqual)(e,R)||L(e)}),[R]),z=Object(ve.a)("alertsPageFiltersEnabled"),[q,$]=Object(r.useState)([]),V=Object(F.b)((e=>{var t;return(null!==(t=i(e,W.e.alertsOnAlertsPage))&&void 0!==t?t:W.q).updated})),[U,H]=Object(r.useState)(),[Q,G]=Object(r.useState)(),{sourcererDataView:Z,runtimeMappings:K,loading:J}=Object(E.d)(x.SourcererScopeName.detections),{formatUrl:Y}=Object(y.l)(P.a.rules),{showBuildingBlockAlerts:X,showOnlyThreatIndicatorAlerts:te}=Object(he.a)(W.e.alertsOnAlertsPage),ae=j||D,{application:{navigateToUrl:ie},timelines:re,data:se}=Object(h.i)().services,{filterManager:oe}=se.query,le=Object(r.useMemo)((()=>[...f,...Object(Qt.e)(X),...Object(Qt.f)(te),...Object(Qt.a)(R)]),[R,X,te,f]),ce=Object(r.useMemo)((()=>{var e;return z?U:Object(Qt.b)(null!==(e=q[0])&&void 0!==e?e:"open")}),[q,U,z]);Object(r.useEffect)((()=>{Q&&(u||Q.reload())}),[u,Q]);const ue=Object(r.useCallback)((({field:e,value:t,negate:a})=>{oe.addFilters([{meta:{alias:null,disabled:!1,negate:null!=a&&a},...null!=t?{query:{match_phrase:{[e]:t}}}:{exists:{field:e}}}])}),[oe]),de=Object(r.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),pe=Object(r.useCallback)((e=>{e.preventDefault(),ie(Y(Object(we.e)()))}),[Y,ie]),me=Object(r.useMemo)((()=>[...le,...null!=ce?ce:[]]),[le,ce]),fe=Object(r.useMemo)((()=>[...Object(Qt.e)(X),...Object(Qt.f)(te),...null!=ce?ce:[],...Object(Qt.a)(R)]),[R,X,te,ce]),{signalIndexNeedsInit:be,pollForSignalIndex:ge}=Object(Jr.a)(),je=Object(r.useCallback)((()=>{Object(Ht.j)(n.current)}),[n]),Se=Object(r.useCallback)((()=>{Object(Ht.m)()}),[]),Oe=Object(r.useCallback)((e=>{Object(ne.isTab)(e)&&Object(Ht.l)({containerElement:n.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:je,onSkipFocusAfterEventsTable:Se})}),[n,je,Se]),Te=Object(r.useCallback)((e=>{if(H(e),e.length){const a=e.find((e=>"kibana.alert.workflow_status"===e.meta.key));if(a){var t;const e=a.meta.params?a.meta.params:[null===(t=a.query)||void 0===t?void 0:t.match_phrase["kibana.alert.workflow_status"]];$(e)}else $([])}}),[]),Ie=Object(r.useCallback)((a=>{const n=W.e.alertsOnAlertsPage;e({id:n}),t({id:n}),$([a])}),[e,t,$]),Ce=Object(r.useMemo)((()=>!!z&&!Array.isArray(U)),[U,z]),_e=Object(r.useMemo)((()=>ae||Ce),[ae,Ce]),Ae=Object(r.useMemo)((()=>J||Ce),[J,Ce]),Fe=Object(r.useMemo)((()=>_e||ae),[_e,ae]),Pe=Object(r.useMemo)((()=>{var e;return z?s.a.createElement(Ql,{onFilterChange:Te,filters:le,query:m,timeRange:{from:g,to:b,mode:"absolute"},chainingSystem:"HIERARCHICAL",onInit:G}):s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(mo,{status:null!==(e=q[0])&&void 0!==e?e:"open",onFilterGroupChanged:Ie})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!1},V&&re.getLastUpdated({updatedAt:V||Date.now(),showUpdating:Fe})))))}),[z,g,Ie,Te,m,Fe,q,re,b,le,V]),De=Object(r.useCallback)((e=>s.a.createElement(ol,{configId:l.e.ALERTS_PAGE,inputFilters:[...fe,...e],tableId:W.e.alertsOnAlertsPage,isLoading:_e})),[fe,_e]);return ae?s.a.createElement(S.a,null,s.a.createElement(oo,{border:!0,title:Tt.k,isLoading:ae}),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},s.a.createElement(ee.EuiLoadingSpinner,{size:"xl"}))):null==O||O||ae?!ae&&be||N?s.a.createElement(S.a,null,s.a.createElement(oo,{border:!0,title:Tt.k}),s.a.createElement(Ct,{needsSignalsIndex:be,needsListsIndex:N})):s.a.createElement(s.a.Fragment,null,null!=k&&!k&&s.a.createElement(Ot,null),s.a.createElement(Is,null),s.a.createElement(Qs,null),be||!1!==C&&!1!==T?!be&&C&&T?s.a.createElement(Gl,{onKeyDown:Oe,ref:n},s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:v,graphEventId:o})},s.a.createElement(ht,{id:Ee.a.global,pollForSignalIndex:ge,sourcererDataView:Z})),s.a.createElement(S.a,{noPadding:v,"data-test-subj":"detectionsAlertsPage"},s.a.createElement(Ut,{show:!v},s.a.createElement(oo,{title:Tt.k},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ye,{assignedUserIds:R,onSelectionChange:B})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.l,{onClick:pe,deepLinkId:P.a.rules,"data-test-subj":"manage-alert-detection-rules",fill:!0},Tt.b)))),s.a.createElement(ee.EuiHorizontalRule,{margin:"none"}),s.a.createElement(ee.EuiSpacer,{size:"l"}),Pe,s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(Kr,{addFilter:ue,alertsDefaultFilters:me,isLoadingIndexPattern:Ae,query:m,runtimeMappings:K,signalIndexName:w,updateDateRangeCallback:de}),s.a.createElement(ee.EuiSpacer,{size:"l"})),s.a.createElement(Uo,{currentAlertStatusFilterValue:q,defaultFilters:fe,from:g,globalFilters:f,globalQuery:m,hasIndexMaintenance:null!=_&&_,hasIndexWrite:null!=M&&M,loading:_e,renderChildComponent:De,runtimeMappings:K,signalIndexName:w,tableId:W.e.alertsOnAlertsPage,to:b}))):s.a.createElement(co.a,null):s.a.createElement(Gs.a,{pageName:Tt.k.toLowerCase(),docLinkSelector:e=>e.siem.privileges})):s.a.createElement(S.a,null,s.a.createElement(oo,{border:!0,title:Tt.k}),s.a.createElement(qt,null))},Zl=Object(c.connect)(null,(e=>({clearSelected:({id:t})=>e(W.h.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(W.h.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(W.h.clearEventsDeleted({id:t}))})))(s.a.memo(Wl)),Kl=Y.i18n.translate("xpack.securitySolution.badge.readOnly.text",{defaultMessage:"Read only"});var Jl=a(262);function Yl(e){const{hasKibanaREAD:t,hasKibanaCRUD:a}=Object(Jl.a)(),n=Object(h.i)().services.chrome;Object(r.useEffect)((()=>(t&&!a&&n.setBadge({text:Kl,tooltip:e,iconType:"glasses"}),()=>{n.setBadge()})),[n,t,a,e])}var Xl=a(56),ec=a.n(Xl),tc=a(60);const ac=({index:e,alertId:t,isSecurityFlyoutEnabled:a},n)=>{if(!a)return Object(tc.encode)({panelView:"eventDetail",params:{eventId:t,indexName:e}});if(n)return n;const i=Object(tc.encode)((({index:e,eventId:t,scopeId:a})=>({right:{id:m.a,params:{id:t,indexName:e,scopeId:a}},left:void 0,preview:[]}))({index:e,eventId:t,scopeId:"alerts-page"}));return i},nc=()=>{var e;const{alertId:t}=Object(k.useParams)(),{search:a}=Object(k.useLocation)(),n=new URLSearchParams(a),i=n.get("timestamp"),o=null!==(e=n.get("index"))&&void 0!==e?e:`.internal${l.w}-default`,u=Object(r.useMemo)((()=>mt.d.inputsSelector()),[]),p=Object(c.useSelector)(u),{linkTo:m,timerange:f}=p.global,{linkTo:b,timerange:g}=p.timeline,y=null!=i?i:f.from,h=ec()(null!=i?i:f.to).add("5","minutes"),v=Object(tc.encode)({global:{[bt.a.timerange]:{kind:"absolute",from:y,to:h},linkTo:m},timeline:{[bt.a.timerange]:g,linkTo:b}}),E=Object(tc.encode)({language:"kuery",query:`_id: ${t}`}),x={fieldName:Ca.ob,title:"Status",selectedOptions:[],existsSelected:!1},j=Object(tc.encode)(ml([x])),S=n.get(bt.a.eventFlyout),[O]=Object(d.useUiSetting$)(l.nb),w=new URLSearchParams({[bt.a.appQuery]:E,[bt.a.timerange]:v,[bt.a.pageFilter]:j,[bt.a.eventFlyout]:ac({index:o,alertId:t,isSecurityFlyoutEnabled:O},S)}),T=`${l.d}?${w.toString()}`;return s.a.createElement(k.Redirect,{to:T})},ic=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.alerts},s.a.createElement(Zl,null),s.a.createElement(_,{pageName:l.yc.alerts})),rc=()=>(Yl(X),s.a.createElement(K.c,null,s.a.createElement(K.a,{path:l.d,exact:!0,component:ic}),s.a.createElement(K.a,{path:`${l.g}/:alertId`,component:nc}),s.a.createElement(K.a,{component:J.a}))),sc=s.a.memo(rc),oc=[{path:l.Z,render:({location:e})=>e.pathname===l.Z?s.a.createElement(k.Redirect,{to:{...e,pathname:l.d}}):s.a.createElement(k.Redirect,{to:{...e,pathname:e.pathname.replace(l.Z,"")}})},{path:l.d,component:()=>s.a.createElement(Q,null,s.a.createElement(sc,null))}],lc=[W.e.alertsOnRuleDetailsPage,W.e.alertsOnAlertsPage];var cc=a(576),uc=a(139),dc=a(738);const pc=ae.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-1v7ri7a-0"})(["display:none;"]),mc=({blob:e,name:t,onDownload:a})=>{const n=Object(r.useRef)(null);return Object(r.useEffect)((()=>{if(e&&null!=n&&n.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e);else{const a=window.URL.createObjectURL(e);n.current.href=a,n.current.download=null!=t?t:"download.txt",n.current.click(),window.URL.revokeObjectURL(a)}a&&a()}}),[e,t,a]),s.a.createElement(pc,{ref:n})};var fc=a(1373),bc=a(1319),gc=a(1375),yc=a(345);const hc=ae.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-zuly7q-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(yc.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),vc=({cancelText:e,confirmText:t,contentText:a,onClose:n,onCancel:i,onConfirm:r,references:o=[],showModal:l,titleText:c})=>l?s.a.createElement(ee.EuiConfirmModal,{maxWidth:460,title:c,onCancel:i,onConfirm:r,cancelButtonText:e,confirmButtonText:t,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},s.a.createElement("p",null,a),s.a.createElement(hc,null,s.a.createElement(ee.EuiListGroup,{gutterSize:"none",showToolTips:!0},o.map(((e,t)=>s.a.createElement(ee.EuiListGroupItem,{key:`${t}-${e}`,label:e})))))):null;vc.displayName="ReferenceErrorModalComponent";const Ec=s.a.memo(vc);Ec.displayName="ReferenceErrorModal";var xc=a(163);const jc=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),Sc=async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t)},Oc=async e=>{const t=await Sc(e);return{skipped:0,succeeded:t.exported_rules_count,failed:t.missing_rules_count,total:t.exported_rules_count+t.missing_rules_count}},kc={low:0,medium:1,high:2,critical:3},wc=e=>{var t;return null!==(t=kc[e])&&void 0!==t?t:-1};var Tc=a(531),Ic=a(1272),Cc=a(1159);const Mc={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},_c=[{field:"created_at",label:fc.V,defaultOrder:"desc"}],Ac=s.a.memo((()=>{const[{loading:e,canUserCRUD:t,canUserREAD:a}]=Object(kt.b)(),{loading:n}=zt(),i=e||n,o=Object(Cc.a)("showEndpointExceptions"),{services:{http:l,notifications:c,timelines:u,application:{navigateToApp:d}}}=Object(h.i)(),{exportExceptionList:p,deleteExceptionList:m,duplicateExceptionList:f}=Object(_t.c)(l),[b,g]=Object(r.useState)(!1),[y,v]=Object(r.useState)(Mc),[E,x]=Object(r.useState)(),[j,S]=Object(r.useState)(dc.i.LOADING),O=Object(r.useMemo)((()=>{const e=[uc.b.DETECTION];return o&&e.push(uc.b.ENDPOINT),e}),[o]),[k,w,T,I,C,M,_]=Object(_t.g)({errorMessage:fc.n,filterOptions:{...E,types:O},http:l,namespaceTypes:["single","agnostic"],notifications:c,hideLists:Tc.a}),[A,F,P]=Object(gc.a)({exceptionLists:null!=w?w:[]}),[D,N]=Object(r.useState)(!0),[R,L]=Object(r.useState)(Date.now()),[B,z]=Object(r.useState)({}),[q,$]=Object(r.useState)(!1),{addError:V,addSuccess:U}=Object(Pt.a)(),H=!A&&!D,Q=!k&&!F.length,G=j===dc.i.SEARCHING,W=j===dc.i.LOADING,Z=Object(r.useCallback)((e=>()=>{c.toasts.addSuccess({title:fc.cb(null!=e?e:y.listId)})}),[c.toasts,y.listId]),K=Object(r.useCallback)((e=>{V(e,{title:fc.q})}),[V]),J=Object(r.useCallback)((({id:e,namespaceType:t})=>async()=>{try{null!=P[e]&&(v({contentText:P[e].rules.length>0?fc.eb(P[e].rules.length):fc.bb(P[e].name),rulesReferences:P[e].rules.map((({name:e})=>e)),isLoading:!0,listId:e,listNamespaceType:t}),g(!0))}catch(e){K(e)}}),[P,K]),Y=Object(r.useCallback)(((e,t)=>a=>{U(fc.u(t)),z({name:e,blob:a})}),[U]),X=Object(r.useCallback)((e=>{V(e,{title:fc.s})}),[V]),te=Object(r.useCallback)((({id:e,listId:t,name:a,namespaceType:n,includeExpiredExceptions:i})=>async()=>{await p({id:e,includeExpiredExceptions:i,listId:t,namespaceType:n,onError:X,onSuccess:Y(t,a)})}),[p,X,Y]),ae=Object(r.useCallback)((()=>{null!=C&&(L(Date.now()),C())}),[C]);Object(r.useEffect)((()=>{!D||i||k||A||N(!1)}),[D,i,k,A]);const ne=Object(r.useCallback)((async({query:e,queryText:t})=>{S(dc.i.SEARCHING);const a=(({query:e,searchValue:t,filterOptions:a,defaultSearchTerm:n})=>{const i=null==e?void 0:e.ast.getFieldClauses();return null!=i&&i.length>0?i.reduce(((e,{field:t,value:a})=>(e[t]=`${a}`,e)),a):{[n]:t}})({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:e,searchValue:t});x(a)}),[]),ie=Object(r.useCallback)((e=>{V(e,{title:fc.r})}),[V]),re=Object(r.useCallback)((e=>()=>{U(fc.t(e)),ae()}),[U,ae]),se=Object(r.useCallback)((({listId:e,name:t,namespaceType:a,includeExpiredExceptions:n})=>async()=>{await f({includeExpiredExceptions:n,listId:e,namespaceType:a,onError:ie,onSuccess:re(t)})}),[f,re,ie]),oe=Object(r.useCallback)((()=>{g(!1),v({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),le=Object(r.useCallback)((async()=>{const e=y.listId,t=y.listNamespaceType,a=P[e].rules;try{await Promise.all(a.map((t=>{var a;const n=new AbortController,i=(null!==(a=t.exceptions_list)&&void 0!==a?a:[]).filter((({id:t})=>t!==e));return Object(xc.p)({ruleProperties:{rule_id:t.rule_id,exceptions_list:i},signal:n.signal})}))),await m({id:e,namespaceType:t,onError:K,onSuccess:Z()})}catch(e){K(e)}finally{v(Mc),g(!1),null!=C&&C()}}),[y.listId,y.listNamespaceType,P,m,K,Z,C]),ce=Object(r.useCallback)((()=>{z({})}),[]),[ue,de]=Object(r.useState)(0),[pe,me]=Object(r.useState)(5),[fe,be]=Object(r.useState)(!1),ge=()=>be(!1),ye=s.a.createElement(ee.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>be((e=>!e))},fc.ab(pe)),he=e=>e===pe?"check":"empty",ve=Object(r.useCallback)((e=>{ge(),me(e),de(0)}),[]),Ee=[s.a.createElement(ee.EuiContextMenuItem,{key:"5 rows",icon:he(5),onClick:()=>ve(5)},"5 rows"),s.a.createElement(ee.EuiContextMenuItem,{key:"10 rows",icon:he(10),onClick:()=>ve(10)},"10 rows"),s.a.createElement(ee.EuiContextMenuItem,{key:"25 rows",icon:he(25),onClick:()=>ve(25)},"25 rows")];Object(r.useEffect)((()=>{I({page:ue+1,perPage:pe,total:0})}),[ue,pe,I]);const[xe,je]=Object(r.useState)(!1),[Se,Oe]=Object(r.useState)(!1),[ke,we]=Object(r.useState)(!1),Te=()=>{Oe(!1),je(!1)},Ie=()=>we(!0),Ce=Object(r.useMemo)((()=>{var e;return null===(e=a&&!t)||void 0===e||e}),[a,t]);return Object(r.useEffect)((()=>{G&&Q?S(dc.i.EMPTY_SEARCH):H?W&&Q?S(dc.i.EMPTY):W&&H&&S(null):S(dc.i.LOADING)}),[G,Q,H,W]),s.a.createElement(s.a.Fragment,null,s.a.createElement(Qs,null),s.a.createElement(ee.EuiPageHeader,{pageTitle:fc.a,description:s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"row"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,null,fc.b)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiButtonIcon,{iconType:"popout","aria-label":"go-to-rules",color:"primary",onClick:()=>d("security",{openInNewTab:!0,path:"/rules"})})))),s.a.createElement(ee.EuiFlexItem,null,u.getLastUpdated({showUpdating:i,updatedAt:R}))),rightSideItems:[s.a.createElement(ee.EuiPopover,{"data-test-subj":"manageExceptionListCreateButton",button:s.a.createElement(ee.EuiButton,{iconType:"arrowDown",onClick:()=>je((e=>!e))},fc.e),isOpen:xe,closePopover:Te},s.a.createElement(ee.EuiContextMenuPanel,{items:[s.a.createElement(ee.EuiContextMenuItem,{key:"createList","data-test-subj":"manageExceptionListCreateExceptionListButton",onClick:()=>{Te(),Ie()}},fc.g),s.a.createElement(ee.EuiContextMenuItem,{key:"createItem","data-test-subj":"manageExceptionListCreateExceptionButton",onClick:()=>{Te(),Oe(!0)}},fc.f)]})),s.a.createElement(ee.EuiButton,{"data-test-subj":"importSharedExceptionList",iconType:"importAction",onClick:()=>$(!0)},fc.G)]}),ke&&s.a.createElement(bc.a,{handleRefresh:ae,http:l,addSuccess:U,addError:V,handleCloseFlyout:()=>we(!1)}),Se&&s.a.createElement(Ic.a,{rules:null,isEndpointItem:!1,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:()=>Oe(!1),onConfirm:e=>{Oe(!1),e&&ae()}}),q&&s.a.createElement(bc.d,{handleRefresh:ae,http:l,addSuccess:U,addError:V,setDisplayImportListFlyout:$}),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement("div",{"data-test-subj":"allExceptionListsPanel"},!D&&s.a.createElement(bc.i,{onSearch:ne}),s.a.createElement(ee.EuiSpacer,{size:"m"}),null!=j?s.a.createElement(dc.a,{isReadOnly:Ce,title:fc.L,viewerStatus:j,buttonText:fc.g,body:fc.M,onEmptyButtonStateClick:Ie}):s.a.createElement(s.a.Fragment,null,s.a.createElement(bc.c,{totalExceptionLists:F.length,onRefresh:ae,setSort:_,sort:M,sortFields:_c}),F.length>0&&s.a.createElement("div",{"data-test-subj":"exceptionsTable"},F.map((e=>s.a.createElement(bc.b,{key:e.list_id,"data-test-subj":"exceptionsListCard",readOnly:Ce,exceptionsList:e,handleDelete:J,handleExport:te,handleDuplicate:se}))))),s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{style:{flex:"1 1 auto"}},s.a.createElement(ee.EuiFlexGroup,{alignItems:"flexStart"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiPopover,{button:ye,isOpen:fe,closePopover:ge},s.a.createElement(ee.EuiContextMenuPanel,{items:Ee}))))),s.a.createElement(ee.EuiFlexItem,{style:{alignItems:"flex-end"}},s.a.createElement(ee.EuiFlexGroup,{alignItems:"flexEnd"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiPagination,{"aria-label":"Custom pagination example",pageCount:T.total?Math.ceil(T.total/pe):0,activePage:ue,onPageClick:e=>de(e)}))))),s.a.createElement(mc,{blob:B.blob,name:`${B.name}.ndjson`,onDownload:ce}),s.a.createElement(Ec,{cancelText:fc.O,confirmText:fc.P,contentText:y.contentText,onCancel:oe,onClose:oe,onConfirm:le,references:y.rulesReferences,showModal:b,titleText:fc.Q})))}));Ac.displayName="SharedLists";var Fc=a(1437),Pc=a(1378);const Dc=()=>{const{detailName:e}=Object(k.useParams)(),{isLoading:t,invalidListId:a,isReadOnly:n,list:i,canUserEditList:o,listId:c,linkedRules:u,exportedList:d,handleOnDownload:p,viewerStatus:m,listName:f,listDescription:b,showManageRulesFlyout:g,headerBackOptions:y,showReferenceErrorModal:h,referenceModalState:v,showManageButtonLoader:E,refreshExceptions:x,disableManageButton:j,onEditListDetails:S,onDuplicateList:O,onExportList:w,onManageRules:T,onSaveManageRules:I,onCancelManageRules:C,onRuleSelectionChange:M,handleDelete:A,handleCloseReferenceErrorModal:F,handleReferenceDelete:P}=Object(Fc.a)(e),[D,N]=Object(r.useState)(null),R=Object(r.useCallback)((()=>N(null)),[N]),L=Object(r.useCallback)((e=>{N(e)}),[N]),B=Object(r.useCallback)((()=>{(null==i?void 0:i.type)===uc.b.ENDPOINT?w(!0):L("export")}),[L,i,w]),z=Object(r.useCallback)((()=>{L("duplicate")}),[L]),q=Object(r.useMemo)((()=>m===dc.i.ERROR?s.a.createElement(dc.a,{isReadOnly:n,viewerStatus:m}):t?s.a.createElement(ee.EuiSkeletonText,{lines:4,"data-test-subj":"loading"}):!a&&f&&i?s.a.createElement(s.a.Fragment,null,s.a.createElement(Qs,null),s.a.createElement(dc.d,{name:f,description:b,listId:c,linkedRules:u,isReadonly:n,canUserEditList:o,backOptions:y,securityLinkAnchorComponent:bc.f,onEditListDetails:S,onExportList:B,onDeleteList:A,onManageRules:T,onDuplicateList:z,dataTestSubj:"exceptionListManagement"}),s.a.createElement(mc,{blob:d,name:`${c}.ndjson`,onDownload:p}),s.a.createElement(bc.h,{list:i,refreshExceptions:x,isReadOnly:n}),s.a.createElement(Ec,{cancelText:cc.bb,confirmText:cc.cb,contentText:v.contentText,onCancel:F,onClose:F,onConfirm:P,references:v.rulesReferences,showModal:h,titleText:cc.db}),g?s.a.createElement(bc.j,{linkedRules:u,showButtonLoader:E,saveIsDisabled:j,onSave:I,onCancel:C,onRuleSelectionChange:M}):null,D&&s.a.createElement(Pc.b,{onModalConfirm:"export"===D?w:O,handleCloseModal:R,action:D})):s.a.createElement(J.a,null)),[m,n,t,a,f,i,b,c,u,o,y,S,B,A,T,z,d,p,x,v.contentText,v.rulesReferences,F,P,h,g,E,j,I,C,M,D,w,O,R]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(_,{pageName:l.yc.exceptions,state:{listName:f}}),q)};Dc.displayName="ListsDetailViewComponent";const Nc=s.a.memo(Dc);Nc.displayName="ListsDetailView";var Rc=a(20);const Lc=({children:e,pageName:t})=>{const a=Object(Rc.f)(t),n=Object(ge.c)(t);return a?s.a.createElement(o.TrackApplicationView,{viewId:t},e):n?s.a.createElement(s.a.Fragment,null,s.a.createElement(_,{pageName:t}),s.a.createElement(n,null)):s.a.createElement(s.a.Fragment,null,s.a.createElement(_,{pageName:t}),s.a.createElement(Gs.b,{pageName:t,docLinkSelector:e=>e.siem.privileges}))},Bc=()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.exceptions},s.a.createElement(Ac,null),s.a.createElement(_,{pageName:l.yc.exceptions}))),zc=()=>s.a.createElement(Q,null,s.a.createElement(Lc,{pageName:l.yc.exceptions},s.a.createElement(Nc,null))),qc=()=>(Yl(cc.ab),s.a.createElement(K.c,null,s.a.createElement(K.a,{path:l.vb,exact:!0,component:Bc}),s.a.createElement(K.a,{path:l.wb,component:zc}),s.a.createElement(K.a,{component:J.a}))),$c=s.a.memo(qc),Vc=[{path:l.vb,render:()=>s.a.createElement($c,null)}];var Uc=a(176);const Hc=({disabled:e,hrefWithSearch:t,id:a,name:n,isSelected:i,isBeta:o,betaOptions:l})=>{var c;const{getAppUrl:u,navigateTo:d}=Object(h.k)(),p=Object(r.useCallback)((e=>{e.preventDefault(),d({path:t,restoreScroll:!0}),Object(Do.h)(Do.a.CLICK,`${Do.c.TAB_CLICKED}${a}`)}),[d,t,a]),m=u({path:t});return s.a.createElement(ee.EuiTab,{"data-href":m,"data-test-subj":`navigation-${a}`,disabled:e,isSelected:i,href:m,onClick:p,append:o&&s.a.createElement(ee.EuiBadge,{color:"#E0E5EE"},null!==(c=null==l?void 0:l.text)&&void 0!==c?c:Po.a)},n)},Qc=s.a.memo(Hc),Gc=({navTabs:e})=>{const[{tabName:t}]=Object(C.a)(),a=Object(r.useCallback)((()=>Object(A.getOr)("","id",Object.values(e).find((e=>t===e.id)))),[t,e]),[n,i]=Object(r.useState)(a());Object(r.useEffect)((()=>{const e=a();e!==n&&i(e)}),[t,e,a,n]);const{search:o}=Object(k.useLocation)(),l=Object(r.useMemo)((()=>Object.values(e).map((e=>{const t=n===e.id;return s.a.createElement(Qc,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+o,name:e.name,disabled:e.disabled,isSelected:t,isBeta:e.isBeta,betaOptions:e.betaOptions})}))),[e,n,o]);return s.a.createElement(ee.EuiTabs,null,l)};Gc.displayName="TabNavigationComponent";const Wc=s.a.memo(Gc,((e,t)=>T()(e.navTabs,t.navTabs)));Wc.displayName="TabNavigation";var Zc=a(573);const Kc=Y.i18n.translate("xpack.securitySolution.lastEventTime.failSearchDescription",{defaultMessage:"Failed to run search on last event time"});var Jc=a(126),Yc=a(155);const Xc=Object(r.memo)((({hostName:e,userName:t,indexKey:a,ip:n,indexNames:i})=>{const[o,{lastSeen:l,errorMessage:c}]=(({indexKey:e,indexNames:t,details:a})=>{const{data:n}=Object(h.i)().services,i=Object(r.useRef)(A.noop),s=Object(r.useRef)(new AbortController),o=Object(r.useRef)(new Ie.Subscription),[l,c]=Object(r.useState)(!1),[u,d]=Object(r.useState)({defaultIndex:t,factoryQueryType:Zc.c.lastEventTime,indexKey:e,details:a}),[p,m]=Object(r.useState)({lastSeen:null,refetch:i.current,errorMessage:void 0}),{addError:f}=Object(Pt.a)(),b=Object(r.useCallback)((e=>{const t=async()=>{s.current=new AbortController,c(!0),o.current=n.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:s.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(c(!1),m((t=>({...t,errorMessage:void 0,lastSeen:e.lastSeen,refetch:i.current}))))},error:e=>{c(!1),f(e,{title:Kc}),m((t=>({...t,errorMessage:e.message})))}})};o.current.unsubscribe(),s.current.abort(),t(),i.current=t}),[n.search,f]);return Object(r.useEffect)((()=>{d((n=>{const i={...n,defaultIndex:t,indexKey:e,details:a};return T()(n,i)?n:i}))}),[t,a,e]),Object(r.useEffect)((()=>(b(u),()=>{o.current.unsubscribe(),s.current.abort()})),[u,b]),[l,p]})({indexKey:a,indexNames:i,details:{hostName:e,ip:n,userName:t}});return null!=c?s.a.createElement(ee.EuiToolTip,{position:"top",content:c,"data-test-subj":"last_event_time_error","aria-label":"last_event_time_error",id:`last_event_time_error-${a}`},s.a.createElement(ee.EuiIcon,{"aria-describedby":`last_event_time_error-${a}`,type:"warning"})):s.a.createElement(s.a.Fragment,null,o&&s.a.createElement(ee.EuiLoadingSpinner,{size:"m"}),o||null==l||"Invalid Date"!==new Date(l).toString()?!o&&null!=l&&s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.headerPage.pageSubtitle",defaultMessage:"Last event: {beat}",values:{beat:s.a.createElement(Yc.b,{value:l})}}):l,!o&&null==l&&Object(Jc.d)())}));Xc.displayName="LastEventTime";var eu=a(529),tu=a(480);const au=Y.i18n.translate("xpack.securitySolution.paginatedTable.showingSubtitle",{defaultMessage:"Showing"}),nu=Y.i18n.translate("xpack.securitySolution.paginatedTable.rowsButtonLabel",{defaultMessage:"Rows per page"}),iu=Y.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastTitle",{defaultMessage:" - too many results"}),ru=Y.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastText",{defaultMessage:"Narrow your query to better filter the results"});var su=a(431);const ou=({activePage:e,columns:t,dataTestSubj:a="paginated-table",headerCount:n,headerFilters:i,headerSupplement:o,headerTitle:c,headerTooltip:u,headerUnit:d,headerSubtitle:p,id:m,isInspect:f,itemsPerRow:b,limit:g,loading:y,loadPage:h,onChange:v=A.noop,pageOfItems:E,setQuerySkip:x,showMorePagesIndicator:j,sorting:S=null,split:O,stackHeader:k,totalCount:w,updateActivePage:T,updateLimitPagination:I})=>{const[C,M]=Object(r.useState)(y),[_,F]=Object(r.useState)(e),[P,D]=Object(r.useState)(-1===n),[N,R]=Object(r.useState)(!1),L=Math.ceil(w/g),B=Object(tu.f)()[1];Object(r.useEffect)((()=>{F(e)}),[e]),Object(r.useEffect)((()=>{n>=0&&P&&D(!1)}),[P,n]),Object(r.useEffect)((()=>{M(y)}),[y]);const z=()=>{R(!1)},q=s.a.createElement(ee.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>{R(!N)}},`${nu}: ${g}`),$=b&&b.map((e=>s.a.createElement(ee.EuiContextMenuItem,{key:e.text,icon:g===e.numberOfRow?"check":"empty",onClick:()=>{z(),I(e.numberOfRow),T(0)}},e.text))),V=j?du:ee.EuiFlexItem,U=Object(r.useMemo)((()=>S?{sort:{field:S.field,direction:S.direction}}:void 0),[S]),{toggleStatus:H,setToggleStatus:Q}=Object(Er.a)(m),G=Object(r.useCallback)((e=>{Q(e),x(!e)}),[x,Q]);return s.a.createElement(ga.c,{show:!P},s.a.createElement(su.a,{"data-test-subj":`${a}-loading-${y}`,loading:y},s.a.createElement(Li.a,{toggleStatus:H,toggleQuery:G,headerFilters:i,id:m,split:O,stackHeader:k,subtitle:!P&&p?`${au}: ${p}`:d&&`${au}: ${n>=0?n.toLocaleString():0} ${d}`,title:c,tooltip:u},!P&&o),H&&(P?s.a.createElement(ee.EuiSkeletonText,{"data-test-subj":"initialLoadingPanelPaginatedTable",lines:10}):s.a.createElement(s.a.Fragment,null,s.a.createElement(cu,{"data-test-subj":"paginated-basic-table",columns:t,items:E,onChange:v,sorting:U}),s.a.createElement(uu,null,s.a.createElement(ee.EuiFlexItem,null,b&&b.length>0&&w>=b[0].numberOfRow&&s.a.createElement(ee.EuiPopover,{id:"customizablePagination","data-test-subj":"loadingMoreSizeRowPopover",button:q,isOpen:N,closePopover:z,panelPaddingSize:"none",repositionOnScroll:!0},s.a.createElement(ee.EuiContextMenuPanel,{items:$,"data-test-subj":"loadingMorePickSizeRow"}))),s.a.createElement(V,{grow:!1},w>0&&s.a.createElement(ee.EuiPagination,{"data-test-subj":"numberedPagination",pageCount:L,activePage:_,onPageClick:e=>{if((e+1)*g>=l.O)return B({type:"addToaster",toast:{id:"PaginationWarningMsg",title:c+iu,color:"warning",iconType:"warning",toastLifeTimeMs:1e4,text:ru}});F(e),h(e),T(e)}}))),(f||C)&&s.a.createElement(eu.a,{"data-test-subj":"loadingPanelPaginatedTable",overlay:!0,size:"xl"})))))},lu=Object(r.memo)(ou),cu=ae()(ee.EuiBasicTable).withConfig({displayName:"BasicTable",componentId:"sc-7nngg3-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);cu.displayName="BasicTable";const uu=ae()(ee.EuiFlexGroup).attrs((()=>({alignItems:"center",responsive:!1}))).withConfig({displayName:"FooterAction",componentId:"sc-7nngg3-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeXS));uu.displayName="FooterAction";const du=ae()(ee.EuiFlexItem).withConfig({displayName:"PaginationEuiFlexItem",componentId:"sc-7nngg3-2"})(["@media only screen and (min-width:","){.euiButtonIcon:last-child{margin-left:28px;}.euiPagination{position:relative;}.euiPagination::before{bottom:0;color:",";content:'\\2026';font-size:",";padding:5px ",";position:absolute;right:",";}}"],(({theme:e})=>e.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiButtonColorDisabled),(({theme:e})=>e.eui.euiFontSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeL));du.displayName="PaginationEuiFlexItem";var pu=a(569);const mu=Y.i18n.translate("xpack.securitySolution.usersTable.title",{defaultMessage:"Users"}),fu=Y.i18n.translate("xpack.securitySolution.usersTable.userNameTitle",{defaultMessage:"User name"}),bu=Y.i18n.translate("xpack.securitySolution.usersTable.lastSeenTitle",{defaultMessage:"Last seen"}),gu=Y.i18n.translate("xpack.securitySolution.usersTable.domainTitle",{defaultMessage:"Domain"}),yu=Y.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),hu=Y.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),vu=e=>Y.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Eu=Y.i18n.translate("xpack.securitySolution.usersTable.riskTitle",{defaultMessage:"User risk level"});var xu=a(306),ju=a(210);const Su=Y.i18n.translate("xpack.securitySolution.usersRiskTable.userNameTitle",{defaultMessage:"User Name"}),Ou=Y.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskScoreTitle",{defaultMessage:"User risk score"}),ku=e=>Y.i18n.translate("xpack.securitySolution.usersRiskTable.filteredUsersTitle",{values:{severity:e},defaultMessage:"View {severity} risk users"}),wu=e=>Y.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Tu=Y.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Iu=Y.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Cu=Y.i18n.translate("xpack.securitySolution.usersTable.lastUpdatedTitle",{defaultMessage:"Last updated"}),Mu=Ne.d.UsersTableType.allUsers,_u=[{text:yu,numberOfRow:5},{text:hu,numberOfRow:10}],Au=({users:e,totalCount:t,type:a,id:n,fakeTotalCount:i,loading:o,loadPage:l,showMorePagesIndicator:u,sort:d,setQuerySkip:p})=>{const m=Object(c.useDispatch)(),f=Object(r.useMemo)((()=>Ne.e.allUsersSelector()),[]),{activePage:b,limit:g}=Object(F.a)((e=>f(e))),y=Object(ju.a)().isPlatinumOrTrialLicense,{navigateTo:v}=Object(h.j)(),E=Object(r.useCallback)((e=>{m(Ne.c.updateTableLimit({usersType:a,limit:e,tableType:Mu}))}),[a,m]),x=Object(r.useCallback)((e=>{m(Ne.c.updateTableActivePage({activePage:e,usersType:a,tableType:Mu}))}),[a,m]),j=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===d.direction&&t.field===d.field||m(Ne.c.updateTableSorting({sort:t,tableType:Mu}))}}),[m,d]),S=Object(r.useCallback)((e=>{m(Ne.c.updateUserRiskScoreSeverityFilter({severitySelection:[e]})),v({deepLinkId:P.a.users,path:Uc.UsersTableType.risk})}),[m,v]),O=Object(r.useMemo)((()=>((e,t)=>{const a=[{field:"name",name:fu,truncateText:!1,sortable:!0,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(pu.b)({fieldName:"user.name",values:[e],idPrefix:`users-table-${e}-name`,render:e=>s.a.createElement($t.m,{userName:e})}):Object(Jc.f)(e)},{field:"lastSeen",name:bu,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>s.a.createElement(Yc.b,{value:e})},{field:"domain",name:gu,sortable:!1,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(pu.b)({fieldName:"user.domain",values:[e],idPrefix:`users-table-${e}-domain`}):Object(Jc.f)(e)}];return e&&a.push({field:"risk",name:Eu,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?s.a.createElement(xu.a,{toolTipContent:s.a.createElement(ee.EuiLink,{onClick:()=>t(e)},s.a.createElement(ee.EuiText,{size:"xs"},ku(e.toLowerCase()))),severity:e}):Object(Jc.d)()}),a})(y,S)),[y,S]);return s.a.createElement(lu,{activePage:b,columns:O,dataTestSubj:`table-${Mu}`,headerCount:t,headerTitle:mu,headerUnit:vu(t),id:n,itemsPerRow:_u,limit:g,loading:o,loadPage:l,pageOfItems:e,showMorePagesIndicator:u,totalCount:i,updateLimitPagination:E,updateActivePage:x,sorting:d,onChange:j,setQuerySkip:p})};Au.displayName="UsersTableComponent";const Fu=s.a.memo(Au);var Pu=a(279),Du=a(545);const Nu=Y.i18n.translate("xpack.securitySolution.userTab.errorFetchingsData",{defaultMessage:"Failed to query users data"}),Ru=(e,t,a)=>{const n=e*t;return{activePage:e,cursorStart:n,fakePossibleCount:4<=e&&e>0?t*(e+2):5*t,querySize:a?t:t+n}};var Lu=a(386);const Bu=Object($a.a)(Fu),zu="UsersTable",qu=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:i,startDate:o,type:l,deleteQuery:c})=>{const{toggleStatus:u}=Object(Er.a)(zu),[d,p]=Object(r.useState)(n||!u);Object(r.useEffect)((()=>{p(n||!u)}),[n,u]);const m=Object(r.useMemo)((()=>Ne.e.allUsersSelector()),[]),{activePage:f,limit:b,sort:g}=Object(F.a)((e=>m(e))),y=Object(Lu.b)(),{loading:h,result:{users:v,pageInfo:E,totalCount:x},search:j,refetch:S,inspect:O}=Object(Pu.a)({factoryQueryType:Du.c.users,initialResult:{users:[],totalCount:0,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Nu,abort:d});return Object(r.useEffect)((()=>{d||j({filterQuery:t,defaultIndex:a,timerange:{interval:"12h",from:o,to:e},pagination:Ru(f,b),sort:g,isNewRiskScoreModuleInstalled:y})}),[j,o,e,t,a,d,f,b,g,y]),s.a.createElement(Bu,{users:v,deleteQuery:c,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",E),id:zu,inspect:O,loading:h,loadPage:A.noop,refetch:S,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",E),setQuery:i,totalCount:x,type:l,sort:g,setQuerySkip:p})};qu.displayName="AllUsersQueryTabBody";var $u=a(584);const Vu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.authentications",{defaultMessage:"Authentications"}),Uu=e=>Y.i18n.translate("xpack.securitySolution.authenticationsTable.usersUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Hu=e=>Y.i18n.translate("xpack.securitySolution.authenticationsTable.hostsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Qu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulSource",{defaultMessage:"Last successful source"}),Gu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulDestination",{defaultMessage:"Last successful destination"}),Wu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulTime",{defaultMessage:"Last success"}),Zu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedSource",{defaultMessage:"Last failed source"}),Ku=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedDestination",{defaultMessage:"Last failed destination"}),Ju=Y.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedTime",{defaultMessage:"Last failure"}),Yu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.successes",{defaultMessage:"Successes"}),Xu=Y.i18n.translate("xpack.securitySolution.authenticationsTable.failures",{defaultMessage:"Failures"}),ed=Y.i18n.translate("xpack.securitySolution.authenticationsTable.user",{defaultMessage:"User"}),td=Y.i18n.translate("xpack.securitySolution.authenticationsTable.host",{defaultMessage:"Host"}),ad=Y.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),nd=Y.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),id=Y.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),rd=Y.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingAuthenticationsData",{defaultMessage:"Failed to query authentications data"}),sd={title:"Authentication",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"3fd0c5d5-f762-4a27-8c56-14eee0223e13",accessors:["5417777d-d9d9-4268-9cdc-eb29b873bd65"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"b41a2958-650b-470a-84c4-c6fd8f0c6d37",yConfig:[{forAccessor:"5417777d-d9d9-4268-9cdc-eb29b873bd65",color:"#54b399"}]},{layerId:"bef502be-e5ff-442f-9e3e-229f86ca2afa",seriesType:"bar_stacked",accessors:["a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],layerType:"data",xAccessor:"cded27f7-8ef8-458c-8d9b-70db48ae340d",yConfig:[{forAccessor:"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e",color:"#da8b45"}]}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{index:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"must":[{"term":{"event.category":"authentication"}}]}}'},$state:{store:"appState"},query:{bool:{must:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"3fd0c5d5-f762-4a27-8c56-14eee0223e13":{columns:{"b41a2958-650b-470a-84c4-c6fd8f0c6d37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5417777d-d9d9-4268-9cdc-eb29b873bd65":{label:wr.f,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "success"',language:"kuery"},customLabel:!0}},columnOrder:["b41a2958-650b-470a-84c4-c6fd8f0c6d37","5417777d-d9d9-4268-9cdc-eb29b873bd65"],incompleteColumns:{}},"bef502be-e5ff-442f-9e3e-229f86ca2afa":{columns:{"cded27f7-8ef8-458c-8d9b-70db48ae340d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e":{label:wr.e,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "failure"',language:"kuery"},customLabel:!0}},columnOrder:["cded27f7-8ef8-458c-8d9b-70db48ae340d","a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-3fd0c5d5-f762-4a27-8c56-14eee0223e13"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-bef502be-e5ff-442f-9e3e-229f86ca2afa"},{type:"index-pattern",name:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",id:"{dataViewId}"}]};var od;const ld=()=>[yd,vd,ud,dd,pd,md,fd,bd,gd],cd=[{text:ad,numberOfRow:5},{text:nd,numberOfRow:10}],ud={name:Xu,field:"node.failures",truncateText:!1,mobileOptions:{show:!0},width:"8%"},dd={name:Wu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(A.has)("lastSuccess.timestamp",e)&&null!=(null===(t=e.lastSuccess)||void 0===t?void 0:t.timestamp)?s.a.createElement(Yc.b,{value:null===(a=e.lastSuccess)||void 0===a?void 0:a.timestamp}):Object(Jc.d)()}},pd={name:Qu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(pu.b)({values:(null===(t=e.lastSuccess)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,fieldName:"source.ip",idPrefix:`authentications-table-${e._id}-lastSuccessSource`,render:e=>s.a.createElement($t.h,{ip:e})})}},md={name:Gu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a,n;return Object(pu.b)({values:null!==(t=null===(a=e.lastSuccess)||void 0===a||null===(n=a.host)||void 0===n?void 0:n.name)&&void 0!==t?t:null,fieldName:"host.name",idPrefix:`authentications-table-${e._id}-lastSuccessfulDestination`,render:e=>s.a.createElement($t.d,{hostName:e})})}},fd={name:Ju,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(A.has)("lastFailure.timestamp",e)&&null!=(null===(t=e.lastFailure)||void 0===t?void 0:t.timestamp)?s.a.createElement(Yc.b,{value:null===(a=e.lastFailure)||void 0===a?void 0:a.timestamp}):Object(Jc.d)()}},bd={name:Zu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(pu.b)({values:(null===(t=e.lastFailure)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,fieldName:"source.ip",idPrefix:`authentications-table-${e._id}-lastFailureSource`,render:e=>s.a.createElement($t.h,{ip:e})})}},gd={name:Ku,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(pu.b)({values:(null===(t=e.lastFailure)||void 0===t||null===(a=t.host)||void 0===a?void 0:a.name)||null,fieldName:"host.name",idPrefix:`authentications-table-${e._id}-lastFailureDestination`,render:e=>s.a.createElement($t.d,{hostName:e})})}},yd={name:ed,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(pu.b)({values:e.stackedValue,fieldName:"user.name",idPrefix:`authentications-table-${e._id}-userName`,render:e=>s.a.createElement($t.m,{userName:e})})},hd={name:td,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(pu.b)({values:e.stackedValue,fieldName:"host.name",idPrefix:`authentications-table-${e._id}-hostName`,render:e=>s.a.createElement($t.d,{hostName:e})})},vd={name:Yu,field:"node.successes",truncateText:!1,mobileOptions:{show:!0},width:"8%"},Ed=[{text:"event.outcome",value:"event.outcome"}];var xd;let jd;!function(e){e.authenticationsSuccess="success",e.authenticationsFailure="failure"}(xd||(xd={})),function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(jd||(jd={}));const Sd={[xd.authenticationsSuccess]:{key:xd.authenticationsSuccess,value:null,color:jd.authenticationsSuccess},[xd.authenticationsFailure]:{key:xd.authenticationsFailure,value:null,color:jd.authenticationsFailure}},Od={defaultStackByOption:null!==(od=Ed.find((e=>"event.outcome"===e.text)))&&void 0!==od?od:Ed[0],errorMessage:rd,histogramType:rt.k.authentications,mapping:Sd,stackByOptions:Ed,title:id,lensAttributes:sd};var kd=a(294),wd=a(209);const Td=Y.i18n.translate("xpack.securitySolution.authentications.failSearchDescription",{defaultMessage:"Failed to run search on authentications"}),Id=({activePage:e,endDate:t,filterQuery:a,indexNames:n,limit:i,skip:s,stackByField:o,startDate:l})=>{const[c,u]=Object(r.useState)(null),d=Object(r.useCallback)((e=>{u((t=>t?{...t,pagination:Ru(e,i)}:t))}),[i]),{loading:p,result:m,search:f,refetch:b,inspect:g}=Object(Pu.a)({factoryQueryType:kd.x.authentications,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Td,abort:s}),y=Object(r.useMemo)((()=>({endDate:t,authentications:m.edges,inspect:g,isInspected:!1,loadPage:d,pageInfo:m.pageInfo,refetch:b,startDate:l,totalCount:m.totalCount})),[t,g,b,m.edges,m.pageInfo,m.totalCount,l,d]);return Object(r.useEffect)((()=>{u((r=>{const s={...null!=r?r:{},defaultIndex:n,factoryQueryType:kd.x.authentications,filterQuery:Object(wd.a)(a),stackByField:o,pagination:Ru(e,i),timerange:{interval:"12h",from:l,to:t},sort:{}};return T()(r,s)?r:s}))}),[e,t,a,n,o,i,l]),Object(r.useEffect)((()=>{!s&&c&&f(c)}),[c,f,s]),[p,y]},Cd="authenticationsUsersTableQuery",Md=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:i,type:o,setQuery:l,deleteQuery:u,userName:d})=>{const p=Object(c.useDispatch)(),{toggleStatus:m}=Object(Er.a)(Cd),[f,b]=Object(r.useState)(n||!m);Object(r.useEffect)((()=>{b(n||!m)}),[n,m]);const g=Object(r.useMemo)((()=>Ne.e.authenticationsSelector()),[]),{activePage:y,limit:h}=Object(F.a)((e=>g(e))),[v,{authentications:E,totalCount:x,pageInfo:j,loadPage:S,inspect:O,isInspected:k,refetch:w}]=Id({endDate:e,filterQuery:t,indexNames:a,skip:f,startDate:i,activePage:y,limit:h,stackByField:d?$u.a.hostName:$u.a.userName}),T=Object(r.useMemo)((()=>d?[hd,vd,ud,dd,pd,fd,bd]:ld()),[d]),I=Object(r.useCallback)((e=>p(Ne.c.updateTableLimit({usersType:o,limit:e,tableType:Ne.d.UsersTableType.authentications}))),[o,p]),C=Object(r.useCallback)((e=>p(Ne.c.updateTableActivePage({activePage:e,usersType:o,tableType:Ne.d.UsersTableType.authentications}))),[o,p]);return Object($a.b)({queryId:Cd,loading:v,refetch:w,setQuery:l,deleteQuery:u,inspect:O}),s.a.createElement(lu,{activePage:y,columns:T,dataTestSubj:"table-users-authentications",headerCount:x,headerTitle:Vu,headerUnit:d?Hu(x):Uu(x),id:Cd,isInspect:k,itemsPerRow:cd,limit:h,loading:v,loadPage:S,pageOfItems:E,setQuerySkip:b,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",j),totalCount:Object(A.getOr)(50,"fakeTotalCount",j),updateLimitPagination:I,updateActivePage:C})};Md.displayName="AuthenticationsUserTableComponent";const _d=s.a.memo(Md);var Ad=a(546);const Fd=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:i,startDate:r,type:o,deleteQuery:l,userName:c})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(Ad.a,bo()({endDate:e,filterQuery:t,id:"usersAuthenticationsHistogramQuery",indexNames:a,setQuery:i,startDate:r},Od)),s.a.createElement(_d,{endDate:e,filterQuery:t,indexNames:a,setQuery:i,deleteQuery:l,startDate:r,type:o,skip:n,userName:c}));Fd.displayName="AllUsersQueryTabBody";var Pd=a(324),Dd=a.n(Pd),Nd=a(577);const Rd=Y.i18n.translate("xpack.securitySolution.containers.anomalies.stackByJobId",{defaultMessage:"job"}),Ld=Y.i18n.translate("xpack.securitySolution.containers.anomalies.title",{defaultMessage:"Anomalies"}),Bd=Y.i18n.translate("xpack.securitySolution.containers.anomalies.errorFetchingAnomaliesData",{defaultMessage:"Failed to query anomalies data"});var zd,qd=a(606);const $d=[{text:Rd,value:"job_id"}],Vd=Rd,Ud={defaultStackByOption:null!==(zd=$d.find((e=>e.text===Vd)))&&void 0!==zd?zd:$d[0],errorMessage:Bd,hideHistogramIfEmpty:!0,histogramType:qd.b.anomalies,stackByOptions:$d,subtitle:void 0,title:Ld},Hd="anomaliesHistogramQuery",Qd=({deleteQuery:e,endDate:t,setQuery:a,skip:n,startDate:i,type:o,filterQuery:c,anomaliesFilterQuery:u,AnomaliesTableComponent:d,flowTarget:p,ip:m,hostName:f,userName:b,indexNames:g})=>{const{jobs:y}=Object(Nd.b)(),[v]=Object(h.o)(l.y),E=((e,t={},a=[],n,i,r)=>{const s=a.map((e=>e.id)).map((e=>({match_phrase:{job_id:e}}))),o=Object(wd.a)(e),l=o?JSON.parse(o):{},c=Dd.a.all([l,t,{bool:{filter:[{bool:{should:s,minimum_should_match:1}},{match_phrase:{result_type:"record"}},i&&r&&{match_phrase:{[`${i}.ip`]:r}},{range:{record_score:{gte:n}}}]}}]);return JSON.stringify(c)})(c,u,y,v,p,m);return Object(r.useEffect)((()=>()=>{e&&e({id:Hd})}),[]),s.a.createElement(s.a.Fragment,null,s.a.createElement(Ad.a,bo()({endDate:t,filterQuery:E,id:Hd,indexNames:g,setQuery:a,startDate:i},Ud)),s.a.createElement(d,{startDate:i,endDate:t,skip:n,type:o,flowTarget:p,ip:m,hostName:f,userName:b}))};Qd.displayName="AnomaliesQueryTabBodyComponent";const Gd=s.a.memo(Qd);Gd.displayName="AnomaliesQueryTabBody";var Wd=a(1087),Zd=a(385);const Kd=Y.i18n.translate("xpack.securitySolution.anomaliesTable.table.showingDescription",{defaultMessage:"Showing"}),Jd=Y.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesDescription",{defaultMessage:"Anomalies"}),Yd=e=>Y.i18n.translate("xpack.securitySolution.anomaliesTable.table.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {anomaly} other {anomalies}}"}),Xd=Y.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),ep=Y.i18n.translate("xpack.securitySolution.ml.table.scoreTitle",{defaultMessage:"Anomaly score"}),tp=Y.i18n.translate("xpack.securitySolution.ml.table.hostNameTitle",{defaultMessage:"Host name"}),ap=Y.i18n.translate("xpack.securitySolution.ml.table.userNameTitle",{defaultMessage:"User name"}),np=Y.i18n.translate("xpack.securitySolution.ml.table.influencedByTitle",{defaultMessage:"Influenced by"}),ip=Y.i18n.translate("xpack.securitySolution.ml.table.entityTitle",{defaultMessage:"Entity"}),rp=Y.i18n.translate("xpack.securitySolution.ml.table.detectorTitle",{defaultMessage:"Job"}),sp=Y.i18n.translate("xpack.securitySolution.ml.table.networkNameTitle",{defaultMessage:"Network IP"}),op=Y.i18n.translate("xpack.securitySolution.ml.table.timestampTitle",{defaultMessage:"Timestamp"}),lp=Y.i18n.translate("xpack.securitySolution.ml.table.jobIdFilter",{defaultMessage:"Job"}),cp=Y.i18n.translate("xpack.securitySolution.ml.table.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."}),up=Y.i18n.translate("xpack.securitySolution.ml.table.intervalLabel",{defaultMessage:"Interval"}),dp=Y.i18n.translate("xpack.securitySolution.ml.table.intervalAutoOption",{defaultMessage:"Auto"}),pp=Y.i18n.translate("xpack.securitySolution.ml.table.intervalHourOption",{defaultMessage:"1 hour"}),mp=Y.i18n.translate("xpack.securitySolution.ml.table.intervalDayOption",{defaultMessage:"1 day"}),fp=Y.i18n.translate("xpack.securitySolution.ml.table.intervalshowAllOption",{defaultMessage:"Show all"});var bp=a(1170),gp=a(1168),yp=a(1147);const hp=(e,t)=>"user.name"===e.entityName&&(null==t||e.entityValue===t),vp=e=>`${e.entityName}-${e.entityValue}-${e.severity}-${e.jobId}`,Ep=({entityName:e,entityValue:t})=>s.a.createElement(sr.c,{data:{field:e,value:t},triggerId:sr.d.DEFAULT,mode:sr.a.HOVER_DOWN,visibleCellActions:5},`${e}: "${t}"`);Ep.displayName="EntityComponent";const xp=s.a.memo(Ep);xp.displayName="Entity";var jp=a(1461),Sp=a(1463);const Op=(e,t)=>[{name:rp,field:"jobName",sortable:!0,render:(a,n)=>s.a.createElement(Sp.a,{score:n.anomaly,startDate:e,endDate:t,linkName:a})},{name:ep,field:"anomaly.severity",sortable:!0,render:(e,t)=>s.a.createElement(jp.a,{score:t.anomaly})},{name:ip,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>s.a.createElement(xp,{entityName:t.anomaly.entityName,entityValue:e})},{name:np,field:"anomaly.influencers",render:(e,t)=>s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[a,n]=Object(yp.a)(e),i=null!=a?a:"",r=null!=n?n:"";return s.a.createElement(ee.EuiFlexItem,{key:`${i}-${r}-${vp(t.anomaly)}`,grow:!1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(xp,{entityName:i,entityValue:r}))))})))},{name:op,field:"anomaly.time",sortable:!0,render:e=>s.a.createElement(Yc.b,{value:e})}],kp=({selectedJobIds:e,onSelect:t,title:a,jobIds:n,jobNameById:i})=>{const{euiTheme:o}=Object(ee.useEuiTheme)(),[l,c]=Object(r.useState)(!1),u=Object(r.useCallback)((()=>{c(!l)}),[l]),d=Object(r.useCallback)((()=>{c(!1)}),[]),p=Object(r.useCallback)((a=>{const n=null!=e?e:[],i=n.includes(a)?n.filter((e=>e!==a)):[...n,a];t(i)}),[e,t]),m=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFilterButton,{disabled:0===n.length,"data-test-subj":"job-id-filter-button",hasActiveFilters:e.length>0,iconType:"arrowDown",isSelected:l,numActiveFilters:e.length,onClick:u,contentProps:{style:{minWidth:112}}},a)),[n.length,e.length,l,u,a]);return s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiPopover,{button:m,isOpen:l,closePopover:d,panelPaddingSize:"none"},s.a.createElement(wp,{className:"eui-yScroll",$_css:30*o.base},n.map((t=>{var a;return s.a.createElement(ee.EuiFilterSelectItem,{"data-test-subj":`job-id-filter-item-${t}`,checked:e.includes(t)?"on":void 0,key:t,onClick:()=>p(t)},null!==(a=i[t])&&void 0!==a?a:t)})))))};var wp=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1ona4k8-0"})((e=>({maxHeight:e.$_css})));const Tp=[{value:"auto",text:dp},{value:"hour",text:pp},{value:"day",text:mp},{value:"second",text:fp}],Ip=({interval:e,onChange:t})=>{const a=Object(r.useCallback)((e=>{t(e.target.value)}),[t]);return s.a.createElement(ee.EuiSelect,{"data-test-subj":"selectInterval",prepend:up,append:s.a.createElement(ee.EuiToolTip,{content:cp},s.a.createElement(ee.EuiIcon,{type:"questionInCircle",color:"subdued"})),options:Tp,value:e,onChange:a})},Cp={sort:{field:"anomaly.severity",direction:"desc"}},Mp=({startDate:e,endDate:t,userName:a,skip:n,type:i})=>{const o=Object(c.useDispatch)(),l=Object(ju.a)(),{toggleStatus:u,setToggleStatus:d}=Object(Er.a)("AnomaliesUserTable"),[p,m]=Object(r.useState)(n||!u);Object(r.useEffect)((()=>{m(n||!u)}),[n,u]);const f=Object(r.useCallback)((e=>{d(e),m(!e)}),[m,d]),{jobNameById:b,loading:g}=Object(Nd.a)(),y=Object(r.useMemo)((()=>Object.keys(b)),[b]),h=Object(r.useMemo)((()=>Ne.e.usersAnomaliesJobIdFilterSelector()),[]),v=Object(F.a)((e=>h(e,i))),E=Object(r.useCallback)((e=>{o(Ne.c.updateUsersAnomaliesJobIdFilter({jobIds:e,usersType:i}))}),[o,i]),x=Object(r.useMemo)((()=>Ne.e.usersAnomaliesIntervalSelector()),[]),j=Object(F.a)((e=>x(e,i))),S=Object(r.useCallback)((e=>{o(Ne.c.updateUsersAnomaliesInterval({interval:e,usersType:i}))}),[o,i]),[O,k]=Object(Wd.a)({startDate:e,endDate:t,skip:p,criteriaFields:Object(gp.a)(i,a),filterQuery:{exists:{field:"user.name"}},jobIds:v.length>0?v:y,aggregationInterval:j}),w=((e,t,a)=>null==e?[]:e.anomalies.reduce(((e,n)=>{var i;if(hp(n,a))return[...e,{userName:n.entityValue,jobName:null!==(i=t[n.jobId])&&void 0!==i?i:n.jobId,anomaly:n}];{const i=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(yp.a)(e);return"user.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(n.influencers,a);var r;return null!=i?[...e,{userName:i,jobName:null!==(r=t[n.jobId])&&void 0!==r?r:n.jobId,anomaly:n}]:e}}),[]))(k,b,a),T=((e,t,a)=>{const n=((e,t)=>[{name:ap,field:"userName",sortable:!0,render:(e,t)=>Object(pu.b)({values:[e],fieldName:"user.name",idPrefix:`anomalies-user-table-userName-${vp(t.anomaly)}-userName`,render:e=>s.a.createElement($t.m,{userName:e})})},...Op(e,t)])(t,a);return e===Uc.UsersType.details?n.filter((e=>e.name!==ap)):n})(i,e,t),I={initialPageIndex:0,initialPageSize:10,totalItemCount:w.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(Zd.a)(l)?s.a.createElement(su.a,{loading:O||g,"data-test-subj":"user-anomalies-tab"},s.a.createElement(Li.a,{subtitle:`${Kd}: ${I.totalItemCount.toLocaleString()} ${Yd(I.totalItemCount)}`,title:Jd,toggleQuery:f,toggleStatus:u,tooltip:Xd,isInspectDisabled:n,headerFilters:s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Ip,{interval:j,onChange:S})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(kp,{title:lp,onSelect:E,selectedJobIds:v,jobIds:y,jobNameById:b})))}),u&&s.a.createElement(bp.a,{"data-test-subj":"user-anomalies-table",columns:T,items:w,pagination:I,sorting:Cp}),(O||g)&&s.a.createElement(eu.a,{"data-test-subj":"anomalies-user-table-loading-panel",overlay:!0,size:"xl"})):null},_p=s.a.memo(Mp);var Ap=a(311),Fp=a(553);var Pp=a(1097),Dp=a(1148),Np=a(1132);const Rp=ae()(ee.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-t4dw34-0"})(["float:right;"]),Lp=e=>{const t=Object(r.useCallback)((t=>s.a.createElement(s.a.Fragment,null,t," ",s.a.createElement(Dp.a,{riskScoreEntity:e}))),[e]),a=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,e,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(Rp,{href:t,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.risk_score.toast.viewDashboard",defaultMessage:"View dashboard"})))),[]);return Object(r.useMemo)((()=>({renderDocLink:t,renderDashboardLink:a})),[a,t])},Bp=(e,t="default")=>`ml_${e}riskscore_pivot_transform_${t}`,zp=(e,t="default")=>`ml_${e}riskscore_latest_transform_${t}`,qp=(Y.i18n.translate("xpack.securitySolution.riskScore.api.ingestPipeline.create.errorMessageTitle",{defaultMessage:"Failed to create Ingest pipeline"}),Y.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.create.errorMessageTitle",{defaultMessage:"Failed to create stored script"}),Y.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.delete.errorMessageTitle",{defaultMessage:"Failed to delete stored script"}),Y.i18n.translate("xpack.securitySolution.riskScore.api.transforms.create.errorMessageTitle",{defaultMessage:"Failed to create Transform"}),Y.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.errorMessageTitle",{defaultMessage:"Failed to get Transform state"})),$p=Y.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.notFoundMessageTitle",{defaultMessage:"Transform not found"}),Vp=e=>Y.i18n.translate("xpack.securitySolution.riskScore.api.transforms.start.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to start {totalCount, plural, =1 {Transform} other {Transforms}}"}),Up=e=>Y.i18n.translate("xpack.securitySolution.riskScore.api.transforms.stop.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to stop {totalCount, plural, =1 {Transform} other {Transforms}}"}),Hp=Y.i18n.translate("xpack.securitySolution.riskScore.install.errorMessageTitle",{defaultMessage:"Installation error"}),Qp=(Y.i18n.translate("xpack.securitySolution.riskScore.uninstall.errorMessageTitle",{defaultMessage:"Uninstallation error"}),Y.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateFailureTitle",{defaultMessage:"Failed to import saved objects"})),Gp=(Y.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkDeleteFailureTitle",{defaultMessage:"Failed to delete saved objects"}),Y.i18n.translate("xpack.securitySolution.riskScore.hostRiskScoresEnabledTitle",{defaultMessage:"Host Risk Scores enabled"})),Wp=Y.i18n.translate("xpack.securitySolution.riskScore.userRiskScoresEnabledTitle",{defaultMessage:"User Risk Scores enabled"}),Zp="/internal/transform",Kp=6e5,Jp=({messageBody:e,renderDocLink:t})=>t?t(e):e;async function Yp({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i,renderDocLink:r}){const s=await async function({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i}){const r=await Promise.all(i.map((i=>{const r=async function({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i=qp,transformId:r}){return await e.get(`${Zp}/transforms/${r}/_stats`,{version:"1",signal:n}).then((e=>{var n;return 0===e.count&&(null==t||null===(n=t.toasts)||void 0===n||n.addError(new Error(i),{title:i,toastMessage:Jp({messageBody:`${$p}: ${r}`,renderDocLink:a}),toastLifeTimeMs:Kp})),e})).catch((e=>{var n,r;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:i,toastMessage:Jp({messageBody:null==e||null===(r=e.body)||void 0===r?void 0:r.message,renderDocLink:a}),toastLifeTimeMs:Kp})}))}({http:e,notifications:t,signal:a,errorMessage:n,transformId:i});return r})));return r}({http:e,signal:a,transformIds:i});return await e.post(`${Zp}/stop_transforms`,{version:"1",body:JSON.stringify(s.reduce(((e,t)=>null!=t&&t.transforms.length>0?[...e,{id:t.transforms[0].id,state:t.transforms[0].state}]:e),[])),signal:a}).then((e=>{const a=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),i=null!=n?n:Up(a.length);var s;return a.length>0&&(null==t||null===(s=t.toasts)||void 0===s||s.addError(new Error(i),{title:i,toastMessage:Jp({messageBody:a.join(", "),renderDocLink:r}),toastLifeTimeMs:Kp})),e})).catch((e=>{var a,s;null==t||null===(a=t.toasts)||void 0===a||a.addError(e,{title:null!=n?n:Up(i.length),toastMessage:Jp({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:r}),toastLifeTimeMs:Kp})}))}const Xp="Current Risk Score for Hosts",em="Current Risk Score for Users",tm={component:"RiskScoreTable"},am=6e5,nm=async({dashboard:e,to:t,errorMessage:a,http:n,notifications:i,options:r,renderDashboardLink:s,renderDocLink:o,from:c,theme:u})=>await n.post(Object(l.Oc)(r.templateName),{version:"1"}).then((n=>{var l;const p=n[r.templateName],m=null==p||null===(l=p.error)||void 0===l?void 0:l.message;if(m){var f;null==i||null===(f=i.toasts)||void 0===f||f.addError(new Error(null!=a?a:Qp),{title:null!=a?a:Qp,toastMessage:o?o(m):m,toastLifeTimeMs:am})}else{var b,g,y,h,v;const a=r.templateName===`${rt.v.user}RiskScoreDashboards`?em:Xp,n=null==p||null===(b=p.body)||void 0===b?void 0:b.find((e=>"dashboard"===e.type&&(null==e?void 0:e.title)===a));let o;var E;null!=n&&n.id&&(o=null==e||null===(E=e.locator)||void 0===E?void 0:E.getRedirectUrl({dashboardId:null==n?void 0:n.id,timeRange:{to:t,from:c}}));const l=null==p||null===(g=p.body)||void 0===g?void 0:g.map((e=>{var t;return null!==(t=null==e?void 0:e.title)&&void 0!==t?t:null==e?void 0:e.name})).join(", ");if(null==l||null==(null==p||null===(y=p.body)||void 0===y?void 0:y.length))return;null==i||null===(h=i.toasts)||void 0===h||h.addSuccess({"data-test-subj":`${r.templateName}SuccessToast`,title:(x=null==p||null===(v=p.body)||void 0===v?void 0:v.length,Y.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateSuccessTitle",{values:{totalCount:x},defaultMessage:"{totalCount} {totalCount, plural, =1 {saved object} other {saved objects}} imported successfully"})),text:Object(d.toMountPoint)(s&&o?s(l,o):l,{theme$:null==u?void 0:u.theme$}),toastLifeTimeMs:am})}var x})).catch((e=>{var t,n,r;null==i||null===(t=i.toasts)||void 0===t||t.addError(new Error(null!=a?a:Qp),{title:null!=a?a:Qp,toastMessage:o?o(null==e||null===(n=e.body)||void 0===n?void 0:n.message):null==e||null===(r=e.body)||void 0===r?void 0:r.message,toastLifeTimeMs:am})})),im=6e5,rm=({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:r})=>t.post(l.Eb,{version:"1",body:JSON.stringify(n),signal:r}).then((t=>{const r=t.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return n.success?null!=n.success?{...e,success:[...e.success,`${a}`]}:e:null!=n.error?{...e,error:[...e.error,`${a}: ${null==n||null===(i=n.error)||void 0===i?void 0:i.message}`]}:e;var i}),{success:[],error:[]});var s,o,l;r.error.length>0?null==a||null===(s=a.toasts)||void 0===s||s.addError(new Error(null!=e?e:Hp),{title:null!=e?e:Hp,toastMessage:i?i(r.error.join(", ")):r.error.join(", "),toastLifeTimeMs:im}):null==a||null===(o=a.toasts)||void 0===o||o.addSuccess({"data-test-subj":`${n.riskScoreEntity}EnableSuccessToast`,title:n.riskScoreEntity===rt.v.user?Wp:Gp,text:(l=r.success.join(", "),Y.i18n.translate("xpack.securitySolution.riskScore.savedObjects.enableRiskScoreSuccessTitle",{values:{items:l},defaultMessage:"{items} imported successfully"}))})})).catch((t=>{var n,r,s;null==a||null===(n=a.toasts)||void 0===n||n.addError(new Error(null!=e?e:Hp),{title:null!=e?e:Hp,toastMessage:i?i(null==t||null===(r=t.body)||void 0===r?void 0:r.message):null==t||null===(s=t.body)||void 0===s?void 0:s.message,toastLifeTimeMs:im})})),sm=async e=>{e.riskScoreEntity===rt.v.user?await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,spaceId:s="default",theme:o,timerange:l})=>{await rm({http:t,renderDocLink:r,notifications:a,options:{riskScoreEntity:rt.v.user}}),await nm({dashboard:e,http:t,notifications:a,options:{templateName:`${rt.v.user}RiskScoreDashboards`},renderDashboardLink:i,renderDocLink:r,...l,theme:o}),n&&n()})(e):await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,theme:s,timerange:o})=>{await rm({http:t,renderDocLink:r,notifications:a,options:{riskScoreEntity:rt.v.host}}),await nm({http:t,theme:s,dashboard:e,renderDashboardLink:i,renderDocLink:r,...o,notifications:a,options:{templateName:`${rt.v.host}RiskScoreDashboards`}}),n&&n()})(e)},om=async({http:e,notifications:t,refetch:a,renderDocLink:n,riskScoreEntity:i,spaceId:r})=>{const s=[Bp(i,r),zp(i,r)];await Yp({http:e,notifications:t,renderDocLink:n,transformIds:s});const o=await async function({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i,transformIds:r}){return await e.post(`${Zp}/start_transforms`,{body:JSON.stringify(r.map((e=>({id:e})))),version:"1",signal:n}).then((e=>{const n=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),r=null!=i?i:Vp(n.length);var s;return n.length>0&&(null==t||null===(s=t.toasts)||void 0===s||s.addError(new Error(r),{title:r,toastMessage:Jp({messageBody:n.join(", "),renderDocLink:a}),toastLifeTimeMs:Kp})),e})).catch((e=>{var n,s;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:null!=i?i:Vp(r.length),toastMessage:Jp({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:a}),toastLifeTimeMs:Kp})}))}({http:e,notifications:t,renderDocLink:n,transformIds:s});return a&&a(),o},lm=({refetch:e,riskScoreEntity:t,disabled:a=!1,timerange:n})=>{const i=Object(hl.a)(),{http:o,notifications:c,theme:u,dashboard:d}=Object(h.i)().services,{renderDocLink:p,renderDashboardLink:m}=Lp(t),{fetch:f,isLoading:b}=Object(Np.b)(Np.a.ENABLE_RISK_SCORE,sm),g=Object(ve.a)("riskScoringRoutesEnabled"),y=Object(r.useCallback)((()=>{f({dashboard:d,http:o,notifications:c,refetch:e,renderDashboardLink:m,renderDocLink:p,riskScoreEntity:t,spaceId:i,theme:u,timerange:n})}),[d,f,o,c,e,m,p,t,i,u,n]);return s.a.createElement(s.a.Fragment,null,g?s.a.createElement($t.l,{color:"primary",fill:!0,deepLinkId:l.yc.entityAnalyticsManagement,"data-test-subj":`enable_${t}_risk_score`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.enableButtonTitle",defaultMessage:"Enable"})):s.a.createElement(ee.EuiButton,{color:"primary",fill:!0,onClick:y,isLoading:b,"data-test-subj":`enable_${t}_risk_score`,disabled:a},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.enableButtonTitle",defaultMessage:"Enable"})))},cm=s.a.memo(lm);cm.displayName="RiskScoreEnableButton";var um=a(348);const dm=Y.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScorePopoverTitle",{defaultMessage:"Alerts need to be available before enabling module"}),pm=Y.i18n.translate("xpack.securitySolution.riskDeprecated.entity.upgradeRiskScoreDescription",{defaultMessage:"Current data is no longer supported. Please migrate your data and upgrade the module. The data might need an hour to be generated after enabling the module."}),mm=e=>Y.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScore",{defaultMessage:"Enable {riskEntity} Risk Score",values:{riskEntity:Object(um.d)(e)}}),fm=e=>Y.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScoreDescription",{defaultMessage:"Once you have enabled this feature you can get quick access to the {riskEntity} risk scores in this section. The data might need an hour to be generated after enabling the module.",values:{riskEntity:Object(um.d)(e,!0)}}),bm=({isDeprecated:e,isDisabled:t,entityType:a,refetch:n,timerange:i})=>{const{signalIndexExists:o}=(()=>{const[e,t]=Object(r.useState)(!0),[a,n]=Object(r.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null}),{addError:i}=Object(Pt.a)(),{hasIndexRead:s}=Object(Jl.a)();return Object(r.useEffect)((()=>{let e=!0;const a=new AbortController;return s?(async()=>{try{t(!0);const i=await Object(Ap.a)({signal:a.signal});e&&null!=i&&n({signalIndexExists:null==i?void 0:i.indexExists,signalIndexName:i.name,signalIndexMappingOutdated:i.index_mapping_outdated})}catch(t){e&&(n({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null}),Object(Mt.v)(t)&&404!==t.body.status_code&&i(t,{title:Fp.c}))}e&&t(!1)})():t(!1),()=>{e=!1,a.abort()}}),[i,s]),{loading:e,...a}})();if(!e&&!t)return null;const l=e?{cta:(c=a,Y.i18n.translate("xpack.securitySolution.enableRiskScore.upgradeRiskScore",{defaultMessage:"Upgrade {riskEntity} Risk Score",values:{riskEntity:Object(um.d)(c)}})),body:pm}:{cta:mm(a),body:fm(a)};var c;return s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(Li.a,{title:s.a.createElement(Pp.a,{riskScoreEntity:a}),titleSize:"s"}),s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h2",null,l.cta),body:s.a.createElement(s.a.Fragment,null,l.body," ",s.a.createElement(Dp.a,{riskScoreEntity:a})),actions:s.a.createElement(ee.EuiToolTip,{content:o?null:dm},s.a.createElement(cm,{disabled:!o,refetch:n,riskScoreEntity:a,timerange:i}))}))},gm=s.a.memo(bm);gm.displayName="EnableRiskScore";var ym=a(1122),hm=a(1061);const vm=s.a.memo((({severityCount:e})=>s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m","data-test-subj":"risk-score-severity-badges"},s.a.createElement(ee.EuiFlexItem,{grow:!1}),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m"},Object.keys(hm.b).map((t=>s.a.createElement(ee.EuiFlexItem,{key:t,grow:!1},s.a.createElement(Em,{status:t,count:e[t]||0})))))))));vm.displayName="SeverityBadges";const Em=s.a.memo((({status:e,count:t})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(xu.a,{severity:e})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiNotificationBadge,{size:"s",color:"subdued"},t)))));Em.displayName="SeverityBadge";const xm=ae()(ee.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-glmy4v-0"})(["&.risk-score-severity-bar{border:none;border-radius:0;&:after{border:none;}}"]),jm=({severityCount:e})=>{const t=Object(r.useMemo)((()=>Object.keys(hm.b).reduce(((t,a)=>{const n={stop:(t.length>0?t[t.length-1].stop:0)+(e[a]||0),color:hm.b[a]};return t.push(n),t}),[])),[e]);return s.a.createElement(xm,{className:"risk-score-severity-bar","data-test-subj":"risk-score-severity-bar",size:"s",palette:t})},Sm=({severityCount:e,selectedSeverities:t,onSelect:a,riskEntity:n})=>{const{euiTheme:i}=Object(ee.useEuiTheme)(),{telemetry:o}=Object(h.i)().services,[l,c]=Object(r.useState)(!1),u=Object(r.useCallback)((()=>{c(!l)}),[l]),d=Object(r.useCallback)((()=>{c(!1)}),[]),p=Object(ee.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),m=Object(r.useMemo)((()=>hm.c.map((a=>({risk:a,count:e[a],checked:t.includes(a)?"on":void 0})))),[e,t]),f=Object(r.useCallback)((e=>{const i=null!=t?t:[],r=!i.includes(e),s=r?[...i,e]:i.filter((t=>t!==e));r&&o.reportEntityRiskFiltered({entity:n,selectedSeverity:e}),a(s)}),[t,a,o,n]),b=Object(r.useMemo)((()=>m.reduce(((e,t)=>"on"===t.checked?e+t.count:e),0)),[m]),g=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFilterButton,{"data-test-subj":"risk-filter-button",hasActiveFilters:!!m.find((e=>"on"===e.checked)),iconType:"arrowDown",isSelected:l,numActiveFilters:b,onClick:u},Object(um.b)(n))),[l,m,u,b,n]);return s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiPopover,{id:p,button:g,isOpen:l,closePopover:d,panelPaddingSize:"none"},s.a.createElement(Om,{className:"eui-yScroll",$_css:30*i.base},m.map(((e,t)=>s.a.createElement(ee.EuiFilterSelectItem,{"data-test-subj":`risk-filter-item-${e.risk}`,checked:e.checked,key:t+e.risk,onClick:()=>f(e.risk)},s.a.createElement(xu.a,{severity:e.risk})))))))};var Om=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-mfc9a3-0"})((e=>({maxHeight:e.$_css})));const km=Y.i18n.translate("xpack.securitySolution.riskInformation.levelHeader",{defaultMessage:"Level"}),wm=(Y.i18n.translate("xpack.securitySolution.riskInformation.informationAriaLabel",{defaultMessage:"Information"}),e=>Y.i18n.translate("xpack.securitySolution.riskInformation.riskHeader",{defaultMessage:"{riskEntity} risk score range",values:{riskEntity:Object(um.d)(e)}})),Tm=Y.i18n.translate("xpack.securitySolution.riskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),Im=Y.i18n.translate("xpack.securitySolution.riskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),Cm=Y.i18n.translate("xpack.securitySolution.riskInformation.title",{defaultMessage:"Entity Risk Analytics"}),Mm=Y.i18n.translate("xpack.securitySolution.riskInformation.closeBtn",{defaultMessage:"Close"}),_m=Y.i18n.translate("xpack.securitySolution.riskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"});var Am=a(413);const Fm=Y.i18n.translate("xpack.securitySolution.riskScore.technicalPreviewLabel",{defaultMessage:"Beta"}),Pm=Y.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelTitle",{defaultMessage:"No host risk score data available to display"}),Dm=Y.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelTitle",{defaultMessage:"No user risk score data available to display"}),Nm=Y.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelBody",{defaultMessage:"We havenâ€™t found any host risk score data. Check if you have any global filters in the global KQL search bar. If you have just enabled the host risk module, the risk engine might need an hour to generate host risk score data and display in this panel."}),Rm=Y.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelBody",{defaultMessage:"We havenâ€™t found any user risk score data. Check if you have any global filters in the global KQL search bar. If you have just enabled the user risk module, the risk engine might need an hour to generate user risk score data and display in this panel."}),Lm=Y.i18n.translate("xpack.securitySolution.riskScore.usersDashboardRestartTooltip",{defaultMessage:"The risk score calculation might take a while to run. However, by pressing restart, you can force it to run immediately."}),Bm=[{level:rt.x.critical,range:Im},{level:rt.x.high,range:"70 - 90 "},{level:rt.x.moderate,range:"40 - 70"},{level:rt.x.low,range:"20 - 40"},{level:rt.x.unknown,range:Tm}],zm=({riskEntity:e})=>{const[t,a,n]=Object(Am.b)();return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiButtonEmpty,{onClick:a,"data-test-subj":"open-risk-information-flyout-trigger"},_m),t&&s.a.createElement(qm,{handleOnClose:n}))},qm=({handleOnClose:e})=>{const{euiTheme:t}=Object(ee.useEuiTheme)(),a=Object(ee.useGeneratedHtmlId)({prefix:"RiskInformation"});return s.a.createElement(ee.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":a,size:450,"data-test-subj":"open-risk-information-flyout"},s.a.createElement(ee.EuiFlyoutHeader,{hasBorder:!0},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",{id:a},Cm))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($m,{label:Fm,size:"s",$_css:t.colors.text,$_css2:t.size.xxs})))),s.a.createElement(ee.EuiFlyoutBody,null,s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.introText",defaultMessage:"Entity Risk Analytics surfaces risky hosts and users from within your environment."})),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.riskScoreFieldText",defaultMessage:"The {riskScoreField} field represents the normalized risk of the Entity as a single numerical value. You can use this value as a relative indicator of risk in triaging and response playbooks.",values:{riskScoreField:s.a.createElement("b",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.riskScoreFieldLabel",defaultMessage:"Entity risk score"}))}})),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.riskScoreLevelText",defaultMessage:"The {riskLevelField} field represents one of the six risk level of the Entity based on a predefined risk metrics.",values:{riskLevelField:s.a.createElement("b",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.riskScoreLevelLabel",defaultMessage:"Entity risk level"}))}})),s.a.createElement(ee.EuiTitle,{size:"xxs"},s.a.createElement("h3",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.howOftenTitle",defaultMessage:"How often is risk calculated?"}))),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.howOftenText",defaultMessage:"The risk engine runs hourly and aggregates alerts with an â€œopenâ€ status from the last 30 days."})),s.a.createElement(ee.EuiTitle,{size:"s"},s.a.createElement("h3",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.howCalculatedTitle",defaultMessage:"How is risk calculated?"}))),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.howCalculatedText",defaultMessage:"The Entity Risk engine runs hourly to aggregate â€œOpenâ€ and â€œAcknowledgedâ€ alerts from the last 30 days and assigns risk score to the host or user. It then aggregates the individual risk scores and normalizes to the 0-100 range using the {riemannZetaLink}.",values:{riemannZetaLink:s.a.createElement(ee.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:"https://en.wikipedia.org/wiki/Riemann_zeta_function"},"Riemann Zeta function")}})),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.intro",defaultMessage:"Finally, the engine assigns a risk level by mapping the normalized risk score to the below 5 risk levels."}))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiBasicTable,{columns:[{field:"level",name:km,render:e=>{if(null!=e)return s.a.createElement(xu.a,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:wm(undefined)}],items:Bm,"data-test-subj":"risk-information-table"}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(Dp.a,{title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskInformation.learnMore",defaultMessage:"Learn more about Entity risk"})})),s.a.createElement(ee.EuiFlyoutFooter,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{onClick:e},Mm)))))};var $m=ae()(ee.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-8m2suk-0"})(["color:",";margin-top:",";"],(e=>e.$_css),(e=>e.$_css2));const Vm=[{text:Tu,numberOfRow:5},{text:Iu,numberOfRow:10}],Um=Ne.d.UsersTableType.risk,Hm=({data:e,id:t,isInspect:a,loading:n,loadPage:i,setQuerySkip:o,severityCount:l,totalCount:u,type:d})=>{const p=Object(c.useDispatch)(),m=Object(r.useMemo)((()=>Ne.e.userRiskScoreSelector()),[]),{activePage:f,limit:b,sort:g}=Object(F.a)((e=>m(e))),y=Object(r.useCallback)((e=>{p(Ne.c.updateTableLimit({usersType:d,limit:e,tableType:Um}))}),[d,p]),h=Object(r.useCallback)((e=>{p(Ne.c.updateTableActivePage({activePage:e,usersType:d,tableType:Um}))}),[d,p]),v=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===g.direction&&t.field===g.field||p(Ne.c.updateTableSorting({sort:t,tableType:Um}))}}),[p,g]),E=Object(r.useCallback)((e=>{p(Ne.c.updateUserRiskScoreSeverityFilter({severitySelection:[e]}))}),[p]),x=Object(r.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"user.name",name:Su,truncateText:!1,mobileOptions:{show:!0},sortable:!0,width:"35%",render:e=>{if(null!=e&&e.length>0){const t=Object(fi.i)(`user-risk-score-table-userName-${e}`);return s.a.createElement(sr.c,{key:t,mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e,field:"user.name"},metadata:{telemetry:tm}},s.a.createElement($t.m,{userName:e,userTab:Uc.UsersTableType.risk}))}return Object(Jc.d)()}},{field:rt.w.timestamp,name:Cu,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?s.a.createElement(Yc.b,{value:e}):Object(Jc.d)()},{field:rt.w.userRiskScore,name:Ou,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?s.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Jc.d)()},{field:rt.w.userRisk,name:Object(um.b)(rt.v.user),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?s.a.createElement(xu.a,{toolTipContent:s.a.createElement(ee.EuiLink,{onClick:()=>e(t)},s.a.createElement(ee.EuiText,{size:"xs"},ku(t.toLowerCase()))),severity:t}):Object(Jc.d)()}])({dispatchSeverityUpdate:E})),[E]),j=s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(vm,{severityCount:l})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(jm,{severityCount:l}))),S=Object(r.useMemo)((()=>Ne.e.userRiskScoreSeverityFilterSelector()),[]),O=Object(F.a)((e=>S(e))),k=Object(r.useCallback)((e=>{p(Ne.c.updateUserRiskScoreSeverityFilter({severitySelection:e}))}),[p]);return s.a.createElement(lu,{activePage:f,columns:x,dataTestSubj:`table-${Um}`,headerCount:u,headerFilters:s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zm,{riskEntity:rt.v.user})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Sm,{selectedSeverities:O,severityCount:l,onSelect:k,riskEntity:rt.v.user}))),headerSupplement:j,headerTitle:ym.e,headerUnit:wu(u),id:t,isInspect:a,itemsPerRow:Vm,limit:b,loading:n,loadPage:i,onChange:v,pageOfItems:e,setQuerySkip:o,showMorePagesIndicator:!1,sorting:g,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:y,updateActivePage:h})};Hm.displayName="UserRiskScoreTableComponent";const Qm=s.a.memo(Hm);Qm.displayName="UserRiskScoreTable";var Gm=a(479);const Wm=({refetch:e,riskScoreEntity:t})=>{const{fetch:a,isLoading:n}=Object(Np.b)(Np.a.REFRESH_RISK_SCORE,om),i=Object(hl.a)(),{renderDocLink:o}=Lp(t),{http:l,notifications:c}=Object(h.i)().services,u=Object(r.useCallback)((async()=>{a({http:l,notifications:c,refetch:e,renderDocLink:o,riskScoreEntity:t,spaceId:i})}),[a,l,c,e,o,t,i]);return s.a.createElement(ee.EuiButton,{color:"primary",fill:!0,onClick:u,isLoading:n,"data-test-subj":`restart_${t}_risk_score`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.restartButtonTitle",defaultMessage:"Restart"}))},Zm=s.a.memo(Wm);Zm.displayName="RiskScoreRestartButton";const Km=({entityType:e,refetch:t})=>{const a=Object(Lu.b)(),n=Object(r.useMemo)((()=>({title:e===rt.v.user?Dm:Pm,body:e===rt.v.user?Rm:Nm})),[e]);return s.a.createElement(ee.EuiPanel,{"data-test-subj":`${e}-risk-score-no-data-detected`,hasBorder:!0},s.a.createElement(Li.a,{title:s.a.createElement(Pp.a,{riskScoreEntity:e}),titleSize:"s"}),s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h2",null,n.title),body:n.body,actions:s.a.createElement(s.a.Fragment,null,!a&&s.a.createElement(ee.EuiToolTip,{content:Lm},s.a.createElement(Zm,{refetch:t,riskScoreEntity:e})))}))},Jm=s.a.memo(Km);Jm.displayName="RiskScoresNoDataDetected";const Ym=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.hosts.show",{defaultMessage:"Show hosts"}),Xm=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.hosts.hide",{defaultMessage:"Hide hosts"}),ef=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.users.show",{defaultMessage:"Show users"}),tf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.users.hide",{defaultMessage:"Hide users"}),af=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.status",{defaultMessage:"Status"}),nf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.statusOn",{defaultMessage:"On"}),rf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.statusOff",{defaultMessage:"Off"}),sf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.entityRiskScoring",{defaultMessage:"Entity risk score"}),of=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.usefulLinks",{defaultMessage:"Useful links"}),lf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.eaDocsDashboard",{defaultMessage:"Entity Analytics dashboard"}),cf=(Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.eaDocsHosts",{defaultMessage:"Host risk score"}),Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.eaDocsUsers",{defaultMessage:"User risk score"}),Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.eaDocsEntities",{defaultMessage:"How is the risk score calculated?"})),uf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.preview",{defaultMessage:"Preview"}),df=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.previewDescription",{defaultMessage:"The entities shown in the preview are the riskiest found in the 1000 sampled during your chosen timeframe. They may not be the riskiest entities across all of your data."}),pf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.errorTitle",{defaultMessage:"Preview failed"}),mf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.errorMessage",{defaultMessage:"Something went wrong when creating the preview. Please try again."}),ff=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.tryAgain",{defaultMessage:"Try again"}),bf=Y.i18n.translate("xpack.securitySolution.riskScore.riskScorePreview.queryErrorTitle",{defaultMessage:"Invalid query"}),gf=Y.i18n.translate("xpack.securitySolution.riskScore.updateAvailable",{defaultMessage:"Update available"}),yf=Y.i18n.translate("xpack.securitySolution.riskScore.startUpdate",{defaultMessage:"Start update"}),hf=Y.i18n.translate("xpack.securitySolution.riskScore.updatingRiskEngine",{defaultMessage:"Updating risk engine..."}),vf=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModa.title",{defaultMessage:"Do you want to update the entity risk engine?"}),Ef=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.existingUserHost_1",{defaultMessage:"Existing user and host risk score transforms will be deleted"}),xf=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.existingUserHost_2",{defaultMessage:", as they are no longer required."}),jf=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.existingData_1",{defaultMessage:"Legacy risk score data will not be deleted"}),Sf=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.existingData_2",{defaultMessage:", it will still exist in the index but will no longer be available in the user interface. You will need to remove legacy risk score data manually."}),Of=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.buttonNo",{defaultMessage:"No, not yet"}),kf=Y.i18n.translate("xpack.securitySolution.riskScore.updateRiskEngineModal.buttonYes",{defaultMessage:"Yes, update now!"}),wf=Y.i18n.translate("xpack.securitySolution.riskScore.errorPanel.title",{defaultMessage:"There was an error"}),Tf=Y.i18n.translate("xpack.securitySolution.riskScore.errorPanel.message",{defaultMessage:"The risk engine status could not be changed. Fix the following and try again:"}),If=Y.i18n.translate("xpack.securitySolution.riskScore.errorPanel.errors",{defaultMessage:"Errors"}),Cf=Y.i18n.translate("xpack.securitySolution.riskScore.updatePanel.title",{defaultMessage:"New entity risk scoring engine available"}),Mf=Y.i18n.translate("xpack.securitySolution.riskScore.updatePanel.message",{defaultMessage:"A new entity risk scoring engine is available. Update now to get the latest features."}),_f=Y.i18n.translate("xpack.securitySolution.riskScore.updatePanel.goToManage",{defaultMessage:"Manage"}),Af=(Y.i18n.translate("xpack.securitySolution.riskScore.updatePanel.Dismiss",{defaultMessage:"Dismiss"}),Y.i18n.translate("xpack.securitySolution.riskScore.maxSpacePanel.message",{defaultMessage:"You can disable entity risk scoring in the space it is currently enabled before enabling it in this space"})),Ff=Y.i18n.translate("xpack.securitySolution.riskScore.errors.privileges.check",{defaultMessage:"Check privileges"}),Pf=Y.i18n.translate("xpack.securitySolution.riskScore.errors.privileges.needToHave",{defaultMessage:"You need to have:"}),Df=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{title:Cf,color:"primary",iconType:"starEmpty"},s.a.createElement(ee.EuiText,null,Mf),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m"},s.a.createElement($t.l,{color:"primary",fill:!0,deepLinkId:l.yc.entityAnalyticsManagement,"data-test-subj":"update-risk-score-button"},_f))),s.a.createElement(ee.EuiSpacer,{size:"m"})),Nf=Object($a.a)(Qm),Rf=({deleteQuery:e,endDate:t,filterQuery:a,setQuery:n,skip:i,startDate:o,type:l})=>{const{data:c}=Object(Lu.c)(),u=Object(r.useMemo)((()=>Ne.e.userRiskScoreSelector()),[]),{activePage:d,limit:p,sort:m}=Object(F.a)((e=>u(e))),f=Object(r.useMemo)((()=>Ne.e.userRiskScoreSeverityFilterSelector()),[]),b=Object(F.a)((e=>f(e))),g=Object(r.useMemo)((()=>({cursorStart:d*p,querySize:p})),[d,p]),{toggleStatus:y}=Object(Er.a)(Gm.b.USERS_BY_RISK),[h,v]=Object(r.useState)(i||!y);Object(r.useEffect)((()=>{v(i||!y)}),[i,y]);const E=Object(r.useMemo)((()=>({from:o,to:t})),[o,t]),{data:x,inspect:j,isDeprecated:S,isInspected:O,isModuleEnabled:k,loading:w,refetch:T,totalCount:I}=Object(Gm.c)({filterQuery:a,pagination:g,riskEntity:rt.v.user,skip:h,sort:m,timerange:E}),{severityCount:C,loading:M}=Object(Gm.d)({filterQuery:a,riskEntity:rt.v.user,skip:h}),_={isDisabled:!k&&!w,isDeprecated:S&&!w};return _.isDisabled||_.isDeprecated?s.a.createElement(gm,bo()({},_,{entityType:rt.v.user,refetch:T,timerange:E})):k&&0===b.length&&x&&0===x.length?s.a.createElement(Jm,{entityType:rt.v.user,refetch:T}):s.a.createElement(s.a.Fragment,null,(null==c?void 0:c.isUpdateAvailable)&&s.a.createElement(Df,null),s.a.createElement(Nf,{deleteQuery:e,data:null!=x?x:[],id:Gm.b.USERS_BY_RISK,inspect:j,isInspect:O,loading:w||M,loadPage:A.noop,refetch:T,setQuery:n,setQuerySkip:v,severityCount:null!=C?C:rt.c,totalCount:I,type:l}))};Rf.displayName="UserRiskScoreQueryTabBody";var Lf=a(113),Bf=a(181),zf=a(1424),qf=a(1268);const $f=[W.e.alertsOnAlertsPage,W.e.alertsOnRuleDetailsPage],Vf=e=>Object(A.isString)(e)?e:JSON.stringify(e),Uf=(e,t)=>{var a,n,i;return{dsl:null!==(a=null!==(n=null==e||null===(i=e.inspect)||void 0===i?void 0:i.dsl)&&void 0!==n?n:null==t?void 0:t.dsl)&&void 0!==a?a:[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}},Hf="eventsQuery",Qf=[{direction:W.b.desc,esTypes:["date"],field:"@timestamp",type:"date"}],Gf=[];var Wf=a(729);const Zf=({ariaRowindex:e,columnValues:t,checked:a})=>Y.i18n.translate("xpack.securitySolution.controlColumns.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:a,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"});var Kf=a(1407);const Jf=()=>null,Yf={id:"checkbox-control-column",width:32,headerCellRender:({onSelectAll:e,isSelectAllChecked:t})=>{const a=Object(r.useCallback)((t=>{e({isSelected:t.currentTarget.checked})}),[e]);return s.a.createElement(ee.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:t,onChange:a})},rowCellRender:({eventId:e,onRowSelected:t,checked:a,ariaRowindex:n,columnValues:i,disabled:o,loadingEventIds:l})=>{const c=Object(r.useCallback)((a=>{o||t({eventIds:[e],isSelected:a.currentTarget.checked})}),[e,t,o]);return l.includes(e)?s.a.createElement(ee.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):s.a.createElement(ee.EuiCheckbox,{"data-test-subj":`select-event select-event-${e}`,id:e,checked:a&&!o,disabled:o,onChange:c,"aria-label":Zf({ariaRowindex:n,columnValues:i,checked:a})})}};var Xf=a(1432);const eb=Object(r.lazy)((()=>a.e(48).then(a.bind(null,1736))));var tb=a(1361);const ab=new vl.Storage(localStorage),nb=[Ca.sb.SIEM],ib={clearSelected:W.h.clearSelected,setSelected:W.h.setSelected},rb=Object(c.connect)(void 0,ib)((({additionalFilters:e,additionalRightMenuOptions:t,bulkActions:a,cellActionsTriggerId:n,clearSelected:i,currentFilter:o,defaultModel:u,end:d,entityType:p="events",hasCrudPermissions:m=!0,indexNames:f,leadingControlColumns:b,onRuleChange:g,pageFilters:y,renderCellValue:v,rowRenderers:x,setSelected:j,sourcererScope:S,start:O,tableId:k,unit:w=vo})=>{const C=Object(c.useDispatch)(),M=Object(r.useContext)(te.ThemeContext),_=Object(r.useMemo)((()=>({tableId:k})),[k]),{filters:F,query:P,dataTable:{columns:D,defaultColumns:N,deletedEventIds:R,graphEventId:L,itemsPerPage:B,itemsPerPageOptions:z,sessionViewConfig:q,showCheckboxes:$,sort:V,queryFields:U,selectAll:H,selectedEventIds:Q,isSelectAllChecked:G,loadingEventIds:Z,title:K}=u}=Object(c.useSelector)((e=>Object(el.a)(e,k))),{uiSettings:J,data:Y,triggersActionsUi:{getFieldBrowser:X}}=Object(h.i)().services,[ae,ne]=Object(r.useState)((({tableId:e,value:t})=>(e=>e===W.e.alertsOnAlertsPage||e===W.e.alertsOnRuleDetailsPage)(e)&&(e=>"gridView"===e||"eventRenderedView"===e)(t)?t:"gridView")({tableId:k,value:ab.get(l.f)})),{browserFields:ie,dataViewId:re,indexPattern:se,runtimeMappings:oe,selectedPatterns:le,dataViewId:ce,loading:ue}=Object(E.d)(S),de=Object(tb.a)(S),{globalFullScreen:pe}=Object(Vt.a)(),me=Object(r.useRef)(null);Object(r.useEffect)((()=>(C(W.h.createDataTable({columns:D,dataViewId:ce,defaultColumns:N,id:k,indexNames:null!=f?f:le,itemsPerPage:B,showCheckboxes:$,sort:V})),()=>{C(Bf.c.deleteOneQuery({id:k,inputId:Ee.a.global})),me.current&&me.current.closeEditor()})),[]);const fe=Object(r.useMemo)((()=>[...F,...null!=y?y:[]]),[F,y]),{Navigation:be}=Object(Jo.b)({scopeId:k}),{DetailsPanel:ge,SessionView:ye}=Object(Jo.a)({entityType:p,scopeId:k}),he=Object(r.useMemo)((()=>null!=L&&L.length>0||null!=q?s.a.createElement(Ko.a,{scopeId:k,SessionView:ye,Navigation:be}):null),[L,k,q,ye,be]),ve=Object(r.useCallback)((({id:e,inspect:t,loading:a,refetch:n})=>C(Bf.c.setQuery({id:e,inputId:Ee.a.global,inspect:t,loading:a,refetch:n}))),[C]),xe=Object(zf.a)({sourcererScope:S,editorActionsRef:me,upsertColumn:Object(r.useCallback)(((e,t)=>C(W.h.upsertColumn({column:e,id:k,index:t}))),[C,k]),removeColumn:Object(r.useCallback)((e=>C(W.h.removeColumn({columnId:e,id:k}))),[C,k])}),je=Object(I.isEmpty)(D)?W.l:D,Se=Object(Ro.getEsQueryConfig)(J),Oe=Object(r.useMemo)((()=>(({from:e,to:t,filters:a,...n})=>{const i=Object(Lo.d)({...n,filters:[...a,Object(Lo.a)(e,t)]});return i?i.filterQuery:void 0})({config:Se,browserFields:ie,dataProviders:[],filters:fe,from:O,indexPattern:se,kqlMode:"filter",kqlQuery:P,to:d})),[Se,ie,fe,O,se,P,d]),ke=Object(r.useMemo)((()=>null!=Oe&&null!=ue&&!ue&&!Object(I.isEmpty)(O)&&!Object(I.isEmpty)(d)),[ue,Oe,O,d]),we=Object(r.useMemo)((()=>[...je.map((e=>e.id)),...null!=U?U:[]]),[je,U]),Te=Object(r.useMemo)((()=>V.map((({columnId:e,columnType:t,esTypes:a,sortDirection:n})=>({field:e,type:t,direction:n,esTypes:null!=a?a:[]})))),[V]),[Ce,{events:Me,loadPage:_e,pageInfo:Ae,refetch:Fe,totalCount:Pe=0,inspect:De}]=(({alertConsumers:e=Gf,dataViewId:t,endDate:a,entityType:n,excludeEcsData:i=!1,id:s=Hf,indexNames:o,fields:l,filterQuery:u,filterStatus:d,startDate:p,language:m="kuery",limit:f,runtimeMappings:b,sort:g=Qf,skip:y=!1,timerangeKind:h,data:v})=>{const[E,x,j]=(({alertConsumers:e=Gf,dataViewId:t,endDate:a,entityType:n,excludeEcsData:i=!1,id:s=Hf,indexNames:o,fields:l,filterQuery:u,startDate:d,language:p="kuery",limit:m,runtimeMappings:f,sort:b=Qf,skip:g=!1,data:y,filterStatus:h})=>{const v=Object(c.useDispatch)(),{startTracking:E}=(e=>{const{startTransaction:t}=Object(Mo.b)();return{startTracking:Object(r.useCallback)((()=>{const a=t({name:Object(Mo.a)(e),type:"http-request",options:{managed:!1}}),n=null==a?void 0:a.startSpan("batched search","http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==n||n.end()}}}),[t,e])}})(s),x=Object(r.useRef)(A.noop),j=Object(r.useRef)(new AbortController),S=Object(r.useRef)(new Ie.Subscription),[O,k]=Object(r.useState)(!0),[w,I]=Object(r.useState)(0),[C,M]=Object(r.useState)(null),[_,F]=Object(r.useState)(h),P=Object(r.useRef)(null),D=Object(r.useCallback)((()=>{null!=s&&$f.some((e=>e===s))&&(v(W.h.clearEventsLoading({id:s})),v(W.h.clearEventsDeleted({id:s})))}),[v,s]),N=Object(r.useCallback)((e=>{D(),I(e)}),[D]),R=Object(r.useCallback)((()=>{null!=x.current&&x.current(),N(0)}),[N]),L=Object(r.useCallback)((e=>{v(W.h.setTableUpdatedAt({id:s,updated:e}))}),[v,s]),B=Object(r.useCallback)((e=>v(W.h.updateTotalCount({id:s,totalCount:e}))),[v,s]),[z,q]=Object(r.useState)({consumers:{},id:s,inspect:{dsl:[],response:[]},refetch:R,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:N,updatedAt:0}),$=Object(r.useCallback)(((e,a)=>{if(null==e||g)return;const i=async()=>{if(P.current=e,j.current=new AbortController,k(!0),y&&y.search){E();const i=j.current.signal;S.current=y.search.search({...e,entityType:n},{strategy:"eql"===e.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:i,indexPattern:{id:t}}).subscribe({next:t=>{Object(Ro.isRunningResponse)(t)||(q((e=>{const n={...e,consumers:t.consumers,events:(i=t.edges,i.map((e=>e.node))),inspect:Uf(t,e.inspect),pageInfo:t.pageInfo,totalCount:t.totalCount,updatedAt:Date.now()};var i;return a&&a(n),n})),_!==e.filterStatus&&v(W.h.updateGraphEventId({id:s,graphEventId:""})),F(e.filterStatus),k(!1),S.current.unsubscribe())},error:e=>{k(!1),y.search.showError(e),S.current.unsubscribe()}})}};S.current.unsubscribe(),j.current.abort(),i(),x.current=i}),[g,y,n,t,E,v,s,_]);Object(r.useEffect)((()=>{0!==o.length&&M((t=>{var n,r,s,c,g,y,v;const E={defaultIndex:null!==(n=null==t?void 0:t.defaultIndex)&&void 0!==n?n:[],filterQuery:null!==(r=null==t?void 0:t.filterQuery)&&void 0!==r?r:"",querySize:null!==(s=null==t||null===(c=t.pagination)||void 0===c?void 0:c.querySize)&&void 0!==s?s:0,sort:null!==(g=null==t?void 0:t.sort)&&void 0!==g?g:Qf,timerange:null!==(y=null==t?void 0:t.timerange)&&void 0!==y?y:{},runtimeMappings:null!==(v=null==t?void 0:t.runtimeMappings)&&void 0!==v?v:{},filterStatus:null==t?void 0:t.filterStatus},x={defaultIndex:o,filterQuery:Vf(u),querySize:m,sort:b,runtimeMappings:f,timerange:{interval:"12h",from:d,to:a},filterStatus:h},j=T()(E,x)?w:0,S={alertConsumers:e,defaultIndex:o,excludeEcsData:i,factoryQueryType:rt.y.all,fieldRequested:l,fields:[],filterQuery:Vf(u),pagination:{activePage:j,querySize:m},language:p,runtimeMappings:f,sort:b,timerange:{interval:"12h",from:d,to:a},filterStatus:h};return w!==j&&I(j),T()(t,S)?t:S}))}),[e,v,o,w,a,i,u,s,p,m,d,b,l,f,h]),Object(r.useEffect)((()=>{z.totalCount>-1&&(L(z.updatedAt),B(z.totalCount))}),[B,L,z]);const V=Object(r.useCallback)((e=>{T()(P.current,C)||$(C,e)}),[C,$]);return Object(r.useEffect)((()=>{Object(A.isEmpty)(u)&&q({consumers:{},id:s,inspect:{dsl:[],response:[]},refetch:R,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:N,updatedAt:0})}),[u,s,R,N]),[O,z,V]})({alertConsumers:e,dataViewId:t,endDate:a,entityType:n,excludeEcsData:i,filterStatus:d,id:s,indexNames:o,fields:l,filterQuery:u,startDate:p,language:m,limit:f,runtimeMappings:b,sort:g,skip:y,timerangeKind:h,data:v});return Object(r.useEffect)((()=>{j&&j()}),[j]),[E,x]})({alertConsumers:nb,data:Y,dataViewId:re,endDate:d,entityType:p,fields:we,filterQuery:Oe,id:k,indexNames:null!=f?f:le,limit:B,runtimeMappings:oe,skip:!ke,sort:Te,startDate:O,filterStatus:o});Object(r.useEffect)((()=>{C(W.h.updateIsLoading({id:k,isLoading:Ce}))}),[C,k,Ce]);const Ne=Object(r.useCallback)((({id:e})=>C(Bf.c.deleteOneQuery({inputId:Ee.a.global,id:e}))),[C]);Object($a.b)({queryId:k,loading:Ce,refetch:Fe,setQuery:ve,deleteQuery:Ne,inspect:De});const Re=Object(r.useMemo)((()=>Pe>0?Pe-R.length:0),[R.length,Pe]),Le=Re>0,Be=Ce&&!Le,ze=Object(r.useMemo)((()=>Me.filter((e=>!R.includes(e._id)))),[R,Me]);Object(r.useEffect)((()=>{ve({id:k,inspect:De,loading:Ce,refetch:Fe})}),[De,Ce,Fe,ve,k]),Object(r.useEffect)((()=>{C(W.h.clearSelected({id:k})),C(W.h.setDataTableSelectAll({id:k,selectAll:!1}))}),[ze,C,k]);const qe=Object(r.useCallback)((e=>{C(W.h.updateItemsPerPage({id:k,itemsPerPage:e}))}),[k,C]),$e=Object(r.useCallback)((e=>{_e(e)}),[_e]),Ve=Object(r.useCallback)((({eventIds:e,isLoading:t})=>{C(W.h.setEventsLoading({id:k,eventIds:e,isLoading:t}))}),[C,k]),Ue=Object(r.useCallback)((({eventIds:e,isDeleted:t})=>{C(W.h.setEventsDeleted({id:k,eventIds:e,isDeleted:t}))}),[C,k]),He=Object(r.useMemo)((()=>Object.keys(Q).length),[Q]),Qe=Object(r.useCallback)((({eventIds:e,isSelected:t})=>{j({id:k,eventIds:Object(W.m)(ze,e,U,m),isSelected:t,isSelectAllChecked:t&&He+1===ze.length})}),[j,k,ze,U,m,He]),Ge=Object(r.useCallback)((({isSelected:e})=>e?j({id:k,eventIds:Object(W.m)(ze,ze.map((e=>e._id)),U,m),isSelected:e,isSelectAllChecked:e}):i({id:k})),[j,k,ze,U,m,i]);Object(r.useEffect)((()=>{H&&!G&&Ge({isSelected:!0})}),[G,Ge,H]);const[We]=Object(r.useMemo)((()=>[$?[Yf,...b]:b].map((e=>(({columnHeaders:e,controlColumns:t,data:a,fieldBrowserOptions:n,loadingEventIds:i,onRowSelected:r,onRuleChange:o,selectedEventIds:l,showCheckboxes:c,tabType:u,timelineId:d,isSelectAllChecked:p,onSelectPage:m,browserFields:f,pageSize:b,sort:g,theme:y,setEventsLoading:h,setEventsDeleted:v})=>t.map((({id:E,headerCellRender:x=Jf,rowCellRender:j,width:S},O)=>({id:`${E}`,headerCellRender:()=>{const t=x;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(t,{width:S,browserFields:f,fieldBrowserOptions:n,columnHeaders:e,isEventViewer:!1,isSelectAllChecked:p,onSelectAll:m,showEventsSelect:!1,showSelectAllCheckbox:c,sort:g,tabType:u,timelineId:d}))},rowCellRender:({isDetails:n,isExpandable:p,isExpanded:m,rowIndex:f,colIndex:g,setCellProps:x})=>{const j=Object(W.n)(f,b),k=a[j];return k?Object(W.g)(k.ecs,y,x):x({style:{display:"none"}}),s.a.createElement(Kf.a,{columnId:null!=E?E:"",columnHeaders:e,controlColumn:t[O],data:a[j],disabled:!1,index:O,isDetails:n,isExpanded:m,isEventViewer:!1,isExpandable:p,loadingEventIds:i,onRowSelected:r,onRuleChange:o,rowIndex:f,colIndex:g,pageRowIndex:j,selectedEventIds:l,setCellProps:x,showCheckboxes:c,tabType:u,tableId:d,width:S,setEventsLoading:h,setEventsDeleted:v})},width:S}))))({columnHeaders:je,controlColumns:e,data:ze,fieldBrowserOptions:xe,loadingEventIds:Z,onRowSelected:Qe,onRuleChange:g,selectedEventIds:Q,showCheckboxes:$,tabType:"query",timelineId:k,isSelectAllChecked:G,sort:V,browserFields:ie,onSelectPage:Ge,theme:M,setEventsLoading:Ve,setEventsDeleted:Ue,pageSize:B})))),[$,b,je,ze,xe,Z,Qe,g,Q,k,G,V,ie,Ge,M,Ve,Ue,B]),Ze=(({tableId:e,data:t,totalItems:a,hasAlertsCrud:n,showCheckboxes:i,filterStatus:o,filterQuery:l,bulkActions:c,selectedCount:u})=>{const d=Object(r.useMemo)((()=>{var e,t;return!!n&&!(0===u||!i)&&("boolean"==typeof c?c:null===(e=(null==c||null===(t=c.customBulkActions)||void 0===t?void 0:t.length)||(null==c?void 0:c.alertStatusActions))||void 0===e||e)}),[n,u,i,c]),p=Object(r.useMemo)((()=>{if(c&&!0!==c)return c.onAlertStatusActionSuccess}),[c]),m=Object(r.useMemo)((()=>{if(c&&!0!==c)return c.onAlertStatusActionFailure}),[c]),f=Object(r.useMemo)((()=>{var e;return!!n&&("boolean"==typeof c?c:null===(e=c&&c.alertStatusActions)||void 0===e||e)}),[c,n]),b=Object(r.useMemo)((()=>{if(c&&!0!==c&&void 0!==c.customBulkActions)return c.customBulkActions.map((e=>({...e,onClick:a=>{const n=t.filter((e=>a.find((t=>e._id===t))));e.onClick(n)}})))}),[c,t]);return Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,d&&s.a.createElement(r.Suspense,{fallback:s.a.createElement(ee.EuiLoadingSpinner,null)},s.a.createElement(eb,{showAlertStatusActions:f,"data-test-subj":"bulk-actions",id:e,totalItems:a,filterStatus:o,query:l,onActionSuccess:p,onActionFailure:m,customBulkActions:b})))),[b,l,o,m,p,f,d,e,a])})({tableId:k,data:ze,totalItems:Re,hasAlertsCrud:m,showCheckboxes:$,filterStatus:o,filterQuery:Oe,bulkActions:a,selectedCount:He}),[Ke]=Object(r.useState)({timelineID:k,tabType:"query",enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0}),Je=Object(r.useMemo)((()=>`${Re.toLocaleString()} ${w(Re)}`),[Re,w]),Ye=Object(r.useMemo)((()=>{if("eventRenderedView"===ae)return{defaultHeight:"auto"}}),[ae]),Xe=Object(r.useMemo)((()=>({pageIndex:Ae.activePage,pageSize:B,pageSizeOptions:z,onChangeItemsPerPage:qe,onChangePage:$e})),[B,z,qe,$e,Ae.activePage]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(qf.c,{$isFullScreen:pe},s.a.createElement(ga.c,null,s.a.createElement(qf.f,{hasBorder:!1,hasShadow:!1,paddingSize:"none","data-test-subj":"events-viewer-panel",$isFullScreen:pe},Be&&s.a.createElement(Wf.c,{height:"short"}),he,ke&&s.a.createElement(Wf.b.Provider,{value:_},s.a.createElement(qf.b,{"data-timeline-id":k,"data-test-subj":`events-container-loading-${Ce}`},s.a.createElement(Xf.a,{tableView:ae,loading:Ce,tableId:k,title:K,onViewChange:e=>ne(e),additionalFilters:e,hasRightOffset:"gridView"===ae&&ze.length>0,additionalMenuOptions:t}),!Le&&!Ce&&!he&&s.a.createElement(Wf.a,null),Le&&s.a.createElement(qf.d,{$visible:!L&&null==he,gutterSize:"none"},s.a.createElement(qf.e,{grow:1},s.a.createElement(Yo.a.Provider,{value:Ke},s.a.createElement(W.a,{cellActionsTriggerId:n,additionalControls:Ze,unitCountText:Je,browserFields:ie,data:ze,id:k,loadPage:_e,renderCellValue:v,rowRenderers:x,totalItems:Re,bulkActions:a,fieldBrowserOptions:xe,hasCrudPermissions:m,leadingControlColumns:We,pagination:Xe,isEventRenderedView:"eventRenderedView"===ae,rowHeightsOptions:Ye,getFieldBrowser:X,getFieldSpec:de}))))))))),ge)}));var sb=a(725),ob=a(484),lb=a(951),cb=a(572),ub=a(1081);const db={meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{bool:{filter:[{bool:{should:[{match:{"event.kind":"alert"}}],minimum_should_match:1}}]}}};var pb=a(1297),mb=a(203);const fb="alertsOrEventsHistogramQuery",bb="onlyExternalAlerts",gb=({additionalFilters:e,deleteQuery:t,endDate:a,filterQuery:n,indexNames:i,setQuery:o,startDate:u,tableId:d})=>{const p=Object(c.useDispatch)(),{globalFullScreen:m}=Object(Vt.a)(),f=Object(ve.a)("tGridEnabled"),[b]=Object(h.o)(l.P),g=Object(be.b)().isEnterprise()?5:4,y=Object(r.useMemo)((()=>Object(lb.a)(g)),[g]),v=hb(),[E,j]=Object(r.useState)(null!=v&&v);vb(E);const S=Object(r.useCallback)((()=>j((e=>!e))),[]),O=Object(r.useMemo)((()=>Object(ob.d)(b,E)),[b,E]);Object(r.useEffect)((()=>{p(W.h.initializeDataTableSettings({id:d,defaultColumns:Zo.columns.map((e=>f||null!=e.initialWidth?e:{...e,initialWidth:Qo.a})),title:sb.d,showCheckboxes:!0,selectAll:!0}))}),[p,E,f,d]),Object(r.useEffect)((()=>()=>{t&&t({id:fb})}),[t]);const k=Object(r.useMemo)((()=>s.a.createElement(ee.EuiCheckbox,{id:"showExternalAlertsCheckbox","data-test-subj":"showExternalAlertsCheckbox","aria-label":sb.h,checked:E,color:"text",label:sb.h,onChange:S})),[E,S]),w=Object(r.useMemo)((()=>({...Zo,excludedRowRendererIds:E?Object.values(Lf.d):[]})),[E]),T=Object(r.useMemo)((()=>E?[db,...e]:e),[e,E]),I=Object(pb.a)({localFilters:T,tableId:d,from:u,to:a,scopeId:x.SourcererScopeName.default}),C=Object(r.useMemo)((()=>({alertStatusActions:!1,customBulkActions:[I]})),[I]);return s.a.createElement(s.a.Fragment,null,!m&&s.a.createElement(Ad.a,bo()({id:fb,startDate:u,endDate:a,filterQuery:n,indexNames:i,setQuery:o},E?ob.a:ob.b,{subtitle:O})),s.a.createElement(rb,{additionalFilters:k,cellActionsTriggerId:sr.d.DEFAULT,start:u,end:a,leadingControlColumns:y,renderCellValue:ub.a,rowRenderers:cb.b,sourcererScope:x.SourcererScopeName.default,tableId:d,unit:E?sb.f:sb.e,defaultModel:w,pageFilters:T,bulkActions:C}))};gb.displayName="EventsQueryTabBodyComponent";const yb=s.a.memo(gb);yb.displayName="EventsQueryTabBody";const hb=()=>{const e=Object(mb.g)(),t=Object(mb.f)(bb),a=Object(r.useMemo)((()=>t()),[t]);return Object(r.useEffect)((()=>()=>{e({[bb]:null})}),[e]),a},vb=e=>{const t=Object(mb.g)();Object(r.useEffect)((()=>{t({[bb]:!!e||null})}),[e,t])},Eb=[{query:{bool:{filter:[{bool:{should:[{exists:{field:"user.name"}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "user.name"}}],"minimum_should_match": 1}}]}}}'}}],xb=Object(r.memo)((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:i,setQuery:r,to:o,type:c})=>{const u={deleteQuery:e,endDate:o,filterQuery:t,indexNames:n,skip:i||void 0===t,setQuery:r,startDate:a,type:c};return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${l.Lc}/:tabName(${Uc.UsersTableType.allUsers})`},s.a.createElement(qu,u)),s.a.createElement(K.a,{path:`${l.Lc}/:tabName(${Uc.UsersTableType.authentications})`},s.a.createElement(Fd,u)),s.a.createElement(K.a,{path:`${l.Lc}/:tabName(${Uc.UsersTableType.anomalies})`},s.a.createElement(Gd,bo()({},u,{AnomaliesTableComponent:_p}))),s.a.createElement(K.a,{path:`${l.Lc}/:tabName(${Uc.UsersTableType.risk})`},s.a.createElement(Rf,u)),s.a.createElement(K.a,{path:`${l.Lc}/:tabName(${Uc.UsersTableType.events})`},s.a.createElement(yb,bo()({additionalFilters:Eb,tableId:W.e.usersPageEvents},u))))}));xb.displayName="UsersTabs";const jb=e=>`${l.Lc}/${e}`,Sb={title:"[Host] User authentications - area ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["0eb97c09-a351-4280-97da-944e4bd30dd7"],layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data",seriesType:"area",xAccessor:"49a42fe6-ebe8-4adb-8eed-1966a5297b7e",yConfig:[{color:"#54b399",forAccessor:"0eb97c09-a351-4280-97da-944e4bd30dd7"}]},{accessors:["2b27c80e-a20d-46f1-8fb2-79626ef4563c"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"area",xAccessor:"33a6163d-0c0a-451d-aa38-8ca6010dd5bf",yConfig:[{color:"#e7664c",forAccessor:"2b27c80e-a20d-46f1-8fb2-79626ef4563c"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["33a6163d-0c0a-451d-aa38-8ca6010dd5bf","2b27c80e-a20d-46f1-8fb2-79626ef4563c"],columns:{"2b27c80e-a20d-46f1-8fb2-79626ef4563c":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome: "failure" '},isBucketed:!1,label:wr.j,operationType:"count",scale:"ratio",sourceField:"___records___"},"33a6163d-0c0a-451d-aa38-8ca6010dd5bf":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}},"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["49a42fe6-ebe8-4adb-8eed-1966a5297b7e","0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:wr.o,operationType:"count",scale:"ratio",sourceField:"___records___"},"49a42fe6-ebe8-4adb-8eed-1966a5297b7e":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]},Ob={title:"[Host] User authentications - bar ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["938b445a-a291-4bbc-84fe-4f47b69c20e4"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"430e690c-9992-414f-9bce-00812d99a5e7",yConfig:[]},{accessors:["c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],layerId:"b9acd453-f476-4467-ad38-203e37b73e55",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"e959c351-a3a2-4525-b244-9623f215a8fd",yConfig:[{color:"#e7664c",forAccessor:"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["430e690c-9992-414f-9bce-00812d99a5e7","938b445a-a291-4bbc-84fe-4f47b69c20e4"],columns:{"430e690c-9992-414f-9bce-00812d99a5e7":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome : "success" '},label:wr.o}]},scale:"ordinal"},"938b445a-a291-4bbc-84fe-4f47b69c20e4":{dataType:"number",isBucketed:!1,label:wr.o,operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}},"b9acd453-f476-4467-ad38-203e37b73e55":{columnOrder:["e959c351-a3a2-4525-b244-9623f215a8fd","c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],columns:{"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7":{dataType:"number",isBucketed:!1,label:"Fail",operationType:"count",scale:"ratio",sourceField:"___records___"},"e959c351-a3a2-4525-b244-9623f215a8fd":{customLabel:!0,dataType:"string",isBucketed:!0,label:wr.j,operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome:"failure" '},label:wr.j}]},scale:"ordinal"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b9acd453-f476-4467-ad38-203e37b73e55"}]},kb=Y.i18n.translate("xpack.securitySolution.usersKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on users kpi authentications search"}),wb=Y.i18n.translate("xpack.securitySolution.usersKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on users kpi authentications"});var Tb=a(127);const Ib="usersKpiAuthenticationsQuery";var Cb=a(283),Mb=a(724),_b=a(339),Ab=a(276),Fb=a(190);const Pb=e=>!!Object(A.get)("value.length",e)&&Object(A.get)("value",e).every((({x:e,y:t})=>!Object(A.isNull)(e)&&Object(A.isNumber)(t)&&t>0)),Db={tickLine:{visible:!1},tickLabel:{padding:3}},Nb=({data:e,...t})=>{const a=Object(li.i)(),n=Object(h.l)(),i=Object(A.get)("configs.axis.xTickFormatter",t),r=Object(A.get)("configs.axis.yTickFormatter",t),o=`group-${e[0].key}-x`,l=`group-${e[0].key}-y`,c={locale:Y.i18n.getLocale(),...li.e,...a,...Object(A.get)("configs.settings",t)};return t.width&&t.height?s.a.createElement("div",{style:{height:t.height,width:t.width,position:"relative"}},s.a.createElement(oi.Chart,null,s.a.createElement(oi.Settings,c),e.map((e=>{const a=e.key;return Pb(e)?s.a.createElement(oi.AreaSeries,{id:a,key:a,name:e.key.replace("Histogram",""),data:e.value||[],xScaleType:Object(A.getOr)(oi.ScaleType.Linear,"configs.series.xScaleType",t),yScaleType:Object(A.getOr)(oi.ScaleType.Linear,"configs.series.yScaleType",t),timeZone:n,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:e.color?e.color:void 0}):null})),s.a.createElement(oi.Axis,{id:o,position:oi.Position.Bottom,showOverlappingTicks:!1,tickFormat:i,style:Db}),s.a.createElement(oi.Axis,{id:l,position:oi.Position.Left,style:Db,tickFormat:r}))):null};Nb.displayName="AreaChartBaseComponent";const Rb=s.a.memo(Nb);Rb.displayName="AreaChartBase";const Lb=({areaChart:e,configs:t,visualizationActionsOptions:a})=>{const{ref:n,width:i,height:o}=Object(Cb.b)(),l=Object(A.get)("customHeight",t),c=Object(A.get)("customWidth",t),u=Object(li.g)(l,o),d=Object(li.h)(c,i),p=Object(r.useMemo)((()=>{return t=e,Array.isArray(t)&&t.some(Pb);var t}),[e]);return s.a.createElement(li.d,null,s.a.createElement(Ab.a,{targetClassNames:[Fb.a]},p&&e&&s.a.createElement(li.b,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(li.c,{ref:n,height:u},s.a.createElement(Rb,{data:e,height:u,width:d,configs:t})))),!p&&s.a.createElement(Mb.a,{height:u,width:d,data:e}),null!=a&&s.a.createElement(_b.a,bo()({},a,{className:"viz-actions"}))))},Bb=s.a.memo(Lb);var zb=a(598);const qb=ae()(ee.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1wwyh1g-0"})([".no-margin{margin-top:0 !important;margin-bottom:0 !important;}"]),$b=ae()(ee.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1wwyh1g-1"})(["min-width:0;position:relative;"]);$b.displayName="FlexItem";const Vb=ae()(ee.EuiFlexItem).withConfig({displayName:"MetricItem",componentId:"sc-1wwyh1g-2"})(["&.euiFlexItem{flex-basis:0;flex-grow:0;}"]);Vb.displayName="MetricItem";const Ub=ae()(ee.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1wwyh1g-3"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);Ub.displayName="StatValue";const Hb=ae.a.h6.withConfig({displayName:"StyledTitle",componentId:"sc-1wwyh1g-4"})(["line-height:200%;"]),Qb=e=>e.toLocaleString(),Gb=e=>({series:{xScaleType:oi.ScaleType.Time,yScaleType:oi.ScaleType.Linear},axis:{xTickFormatter:Object(A.get)("xTickFormatter",e),yTickFormatter:Qb},settings:{onBrushEnd:Object(A.getOr)((()=>{}),"onBrushEnd",e)},customHeight:74}),Wb=(e,t)=>e.map((e=>({...e,value:Object(A.get)(e.key,t)}))),Zb=(e,t)=>e.filter((e=>null!=Object(A.get)(`${e.key}Histogram`,t))).map((({lensAttributes:e,...a})=>({...a,value:Object(A.get)(`${a.key}Histogram`,t),key:`${a.key}Histogram`}))),Kb=(e,t)=>0===e.length?[]:e.reduce(((a,n,i)=>{const{key:r,color:s}=n,o=Object(A.getOr)(null,r,t);return[...a,{key:r,color:s,value:[{x:Object(A.get)(`${i}.name`,e)||Object(A.getOr)("",`${i}.description`,e),y:o,g:r,y0:0}]}]}),[]);var Jb=a(717);const Yb=({onToggle:e,isToggleExpanded:t,description:a})=>s.a.createElement(qb,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{className:t?"":"no-margin"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonIcon,{"aria-label":Jb.a(t),"data-test-subj":"query-toggle-stat",color:"text",display:"empty",iconType:t?"arrowDown":"arrowRight",onClick:e,size:"xs",title:Jb.a(t)})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiTitle,{size:"xxxs"},s.a.createElement(Hb,null,a)))))),Xb=s.a.memo(Yb);Xb.displayName="StatItemHeader";const eg=({fields:e,id:t,timerange:a,isAreaChartDataAvailable:n,isBarChartDataAvailable:i,inspectTitle:r,inspectIndex:o})=>s.a.createElement(ee.EuiFlexGroup,null,e.map((e=>s.a.createElement($b,{key:`stat-items-field-${e.key}`},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(n||i)&&e.icon&&s.a.createElement($b,{grow:!1},s.a.createElement(ee.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),s.a.createElement($b,null,s.a.createElement(Ab.a,{targetClassNames:[Fb.a]},s.a.createElement(Ub,null,s.a.createElement("p",{"data-test-subj":"stat-title"},null!=e.value?e.value.toLocaleString():Object(Jc.d)()," ",e.description)),e.lensAttributes&&a&&s.a.createElement(_b.a,{lensAttributes:e.lensAttributes,queryId:t,inspectIndex:o,timerange:a,title:r,className:"viz-actions"})))))))),tg=s.a.memo(eg),ag=({fields:e,id:t,timerange:a,inspectTitle:n})=>s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",className:"metricEmbeddable"},e.map((e=>s.a.createElement($b,{key:`stat-items-field-${e.key}`},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},e.icon&&s.a.createElement($b,{grow:!1},s.a.createElement(ee.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),s.a.createElement(Vb,null,e.lensAttributes&&s.a.createElement("div",{"data-test-subj":"stat-title"},s.a.createElement(Dr.a,{"data-test-subj":"embeddable-metric",height:36,id:`${t}-${e.key}-metric-embeddable`,lensAttributes:e.lensAttributes,timerange:a,inspectTitle:n}))),null!=e.description&&s.a.createElement($b,null,s.a.createElement(Ub,null,s.a.createElement("p",{"data-test-subj":"stat-title"},e.description)))))))),ng=s.a.memo(ag),ig=s.a.memo((({areaChart:e,barChart:t,description:a,enableAreaChart:n,enableBarChart:i,fields:o,from:l,grow:c,id:u,loading:d=!1,index:p,updateDateRange:m,statKey:f="item",to:b,barChartLensAttributes:g,areaChartLensAttributes:y,setQuerySkip:h})=>{const v=!!(t&&t.length&&t.every((e=>null!=e.value&&e.value.length>0))),E=!!(e&&e.length&&e.every((e=>null!=e.value&&e.value.length>0))),x=Object(r.useMemo)((()=>({from:l,to:b})),[l,b]),{isToggleExpanded:j,onToggle:S}=(({id:e,setQuerySkip:t})=>{const{toggleStatus:a,setToggleStatus:n}=Object(Er.a)(e),i=Object(r.useCallback)((e=>{n(e),t(!e)}),[t,n]),s=Object(r.useCallback)((()=>i(!a)),[i,a]);return{isToggleExpanded:a,onToggle:s}})({id:u,setQuerySkip:h}),O=Object(ve.a)("chartEmbeddablesEnabled");return s.a.createElement($b,{grow:c,"data-test-subj":`stat-${f}`},s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(Xb,{onToggle:S,isToggleExpanded:j,description:a}),d&&s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiLoadingSpinner,{size:"l","data-test-subj":"loading-spinner"}))),j&&!d&&s.a.createElement(s.a.Fragment,null,O?s.a.createElement(ng,{fields:o,id:u,timerange:x,inspectTitle:a}):s.a.createElement(tg,{fields:o,id:u,timerange:x,isAreaChartDataAvailable:E,isBarChartDataAvailable:v,inspectTitle:a,inspectIndex:p}),(n||i)&&s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiFlexGroup,{gutterSize:O?"none":"l"},i&&s.a.createElement($b,null,O&&g?s.a.createElement(Dr.a,{"data-test-subj":"embeddable-bar-chart",lensAttributes:g,timerange:x,id:`${u}-bar-embeddable`,height:120,inspectTitle:a}):s.a.createElement(zb.a,{barChart:t,configs:{series:{xScaleType:oi.ScaleType.Ordinal,yScaleType:oi.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:Qb},settings:{onElementClick:Object(A.getOr)((()=>{}),"onElementClick",undefined),rotation:90},customHeight:74},visualizationActionsOptions:{lensAttributes:g,queryId:u,inspectIndex:p,timerange:x,title:a}})),n&&null!=l&&null!=b&&s.a.createElement(s.a.Fragment,null,s.a.createElement($b,null,O&&y?s.a.createElement(Dr.a,{"data-test-subj":"embeddable-area-chart",lensAttributes:y,timerange:x,id:`${u}-area-embeddable`,height:120,inspectTitle:a}):s.a.createElement(Bb,{areaChart:e,configs:Gb({xTickFormatter:Object(Cb.a)([l,b]),onBrushEnd:m}),visualizationActionsOptions:{lensAttributes:y,queryId:u,inspectIndex:p,timerange:x,title:a}})))))))}),((e,t)=>e.description===t.description&&e.enableAreaChart===t.enableAreaChart&&e.enableBarChart===t.enableBarChart&&e.from===t.from&&e.grow===t.grow&&e.loading===t.loading&&e.setQuerySkip===t.setQuerySkip&&e.id===t.id&&e.index===t.index&&e.updateDateRange===t.updateDateRange&&e.statKey===t.statKey&&e.to===t.to&&T()(e.areaChart,t.areaChart)&&T()(e.barChart,t.barChart)&&T()(e.fields,t.fields)));ig.displayName="StatItemsComponent",ae()(ee.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-nwd2ek-0"})(["min-height:","px;"],247).displayName="FlexGroup";const rg=s.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:i,to:r,updateDateRange:o,setQuerySkip:l})=>{const c=((e,t,a,n,i,r,s,o)=>e.map((e=>({...e,areaChart:e.enableAreaChart?Zb(e.fields,t):void 0,barChart:e.enableBarChart?Kb(e.fields,t):void 0,fields:Wb(e.fields,t),id:a,key:`kpi-summary-${e.key}`,statKey:`${e.key}`,from:n,to:i,updateDateRange:r,setQuerySkip:s,loading:o}))))(e,t,a,i,r,o,l,n);return s.a.createElement(ee.EuiFlexGroup,{wrap:!0},c.map((e=>s.a.createElement(ig,e))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.id===t.id&&e.loading===t.loading&&e.from===t.from&&e.to===t.to&&e.updateDateRange===t.updateDateRange&&T()(e.data,t.data)));rg.displayName="KpiBaseComponent";const sg=Object($a.a)(rg),og=Y.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),lg=Y.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),cg=Y.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),ug=Y.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),dg=Y.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"});var pg,mg=a(396);!function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(pg||(pg={}));const fg=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:ug,description:lg,value:null,color:pg.authenticationsSuccess,icon:"check",lensAttributes:{title:"[Host] User authentications - metric success ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:" ",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}},{key:"authenticationsFailure",name:dg,description:cg,value:null,color:pg.authenticationsFailure,icon:"cross",lensAttributes:{title:"[Host] User authentications - metric failure ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{dataType:"number",filter:{language:"kuery",query:'event.outcome : "failure" '},isBucketed:!1,label:" ",operationType:"count",scale:"ratio",sourceField:"___records___",customLabel:!0}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}}],enableAreaChart:!0,enableBarChart:!0,description:og,areaChartLensAttributes:Sb,barChartLensAttributes:Ob}],bg=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Ib),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:Ib,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g,addWarning:y}=Object(Pt.a)(),v=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),y(kb),c.current.unsubscribe()):(d(!1),b((t=>({...t,authenticationsSuccess:e.authenticationsSuccess,authenticationsSuccessHistogram:e.authenticationsSuccessHistogram,authenticationsFailure:e.authenticationsFailure,authenticationsFailureHistogram:e.authenticationsFailureHistogram,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:wb}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,y,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.z.kpiAuthentications,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:fg,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})};bg.displayName="UsersKpiAuthenticationsComponent";const gg=s.a.memo(bg),yg={description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(wr.q)("user.name"),operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[User] Users - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]},hg=Y.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.title",{defaultMessage:"Users"}),vg=Y.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.errorSearchDescription",{defaultMessage:"An error has occurred on total users kpi search"}),Eg=[{key:"users",fields:[{key:"users",value:null,color:Object(ee.euiPaletteColorBlind)()[1],icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["3e51b035-872c-4b44-824b-fe069c222e91"],columns:{"3e51b035-872c-4b44-824b-fe069c222e91":{dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"user.name",customLabel:!0}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"3e51b035-872c-4b44-824b-fe069c222e91",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[User] Users - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:hg,areaChartLensAttributes:yg}],xg="TotalUsersKpiQuery",jg=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(xg),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const{loading:m,result:f,search:b,refetch:g,inspect:y}=Object(Pu.a)({factoryQueryType:Du.c.kpiTotalUsers,initialResult:{users:0,usersHistogram:[]},errorMessage:vg,abort:u||p}),{session:h,refetchByRestartingSession:v}=Object(mg.a)({inputId:Ee.a.global,queryId:xg});return Object(r.useEffect)((()=>{u||b({filterQuery:e,defaultIndex:a,timerange:{interval:"12h",from:t,to:n}})}),[b,t,n,e,a,u]),s.a.createElement(sg,{data:f,id:xg,inspect:y,loading:m,fieldsMapping:Eg,from:t,to:n,updateDateRange:i,refetch:p?v:g,setQuery:o,setQuerySkip:d,session:p?h:void 0})},Sg=s.a.memo(jg),Og=s.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:r,updateDateRange:o})=>s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Sg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})),s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(gg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})))));Og.displayName="UsersKpiComponent";const kg=ae.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1dz707e-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),wg=()=>{const e=Object(c.useDispatch)(),t=Object(r.useRef)(null),a=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),n=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),i=Object(F.a)(n),o=Object(F.a)(a),l=Object(r.useMemo)((()=>Ne.e.userRiskScoreSeverityFilterSelector()),[]),u=Object(F.a)((e=>l(e))),{to:d,from:p,deleteQuery:m,setQuery:f,isInitializing:b}=Object(xe.a)(),{globalFullScreen:g}=Object(Vt.a)(),{uiSettings:y}=Object(h.i)().services,{tabName:v}=Object(k.useParams)(),x=s.a.useMemo((()=>v===Uc.UsersTableType.events?[...o,...Eb]:v===Uc.UsersTableType.risk?[...ct(u,rt.v.user),...o]:o),[u,v,o]),{indicesExist:j,indexPattern:O,selectedPatterns:w,sourcererDataView:T}=Object(E.d)(),[I,C]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(y),indexPattern:O,queries:[i],filters:o})),[o,O,y,i]),[M]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(y),indexPattern:O,queries:[i],filters:x})),[O,i,x,y]);Object(Bo.a)({id:"UsersQueryId",filterQuery:I,kqlError:C,query:i,startDate:p,endDate:d});const D=Object(r.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),N=Object(r.useCallback)((()=>{Object(Ht.m)()}),[]),R=Object(r.useCallback)((e=>{Object(ne.isTab)(e)&&Object(Ht.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:D,onSkipFocusAfterEventsTable:N})}),[t,D,N]),L=Object(r.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),B=Object(ju.a)(),z=Object(Am.a)("entity-analytics"),q=Object(r.useMemo)((()=>((e,t)=>{const a=[],n={[Uc.UsersTableType.allUsers]:{id:Uc.UsersTableType.allUsers,name:ym.a,href:jb(Uc.UsersTableType.allUsers),disabled:!1},[Uc.UsersTableType.authentications]:{id:Uc.UsersTableType.authentications,name:ym.c,href:jb(Uc.UsersTableType.authentications),disabled:!1},[Uc.UsersTableType.anomalies]:{id:Uc.UsersTableType.anomalies,name:ym.b,href:jb(Uc.UsersTableType.anomalies),disabled:!1},[Uc.UsersTableType.events]:{id:Uc.UsersTableType.events,name:ym.d,href:jb(Uc.UsersTableType.events),disabled:!1},[Uc.UsersTableType.risk]:{id:Uc.UsersTableType.risk,name:ym.e,href:jb(Uc.UsersTableType.risk),disabled:!1}};return e||a.push(Uc.UsersTableType.anomalies),t||a.push(Uc.UsersTableType.risk),Object(A.omit)(a,n)})(Object(Zd.a)(B),z)),[B,z]);return s.a.createElement(s.a.Fragment,null,j?s.a.createElement(kg,{onKeyDown:R,ref:t},s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,null,s.a.createElement(ht,{sourcererDataView:T,id:Ee.a.global})),s.a.createElement(S.a,{noPadding:g},s.a.createElement(oo,{subtitle:s.a.createElement(Xc,{indexKey:rt.j.users,indexNames:w}),border:!0,title:ym.f}),s.a.createElement(Og,{filterQuery:I,indexNames:w,from:p,setQuery:f,to:d,skip:b||!!C,updateDateRange:L}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Wc,{navTabs:q}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(xb,{deleteQuery:m,filterQuery:M,from:p,indexNames:w,isInitializing:b,setQuery:f,to:d,type:Ne.d.UsersType.page}))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.users}))};wg.displayName="UsersComponent";const Tg=s.a.memo(wg),Ig=()=>{const{navigateTo:e}=Object(h.k)();return t=>{const a=Object(tc.encode)(ml(Array.isArray(t)?t:[t]));e({deepLinkId:l.yc.alerts,path:`?${bt.a.pageFilter}=${a}`})}};var Cg=a(384),Mg=a(293),_g=a(226);const Ag=ae.a.span.withConfig({displayName:"LegendText",componentId:"sc-17lxi1z-0"})(["font-size:10.5px;"]),Fg=s.a.memo((({value:e})=>Object(_g.a)(e)?s.a.createElement(Ag,null,e):s.a.createElement(Ag,{"data-test-subj":"value-wrapper-empty"},Mg.c)));Fg.displayName="ValueWrapper";const Pg=({legendItem:e})=>{const{color:t,value:a}=e;return s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=t&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiHealth,{"data-test-subj":"legend-color",color:t})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Fg,{value:a}))))};Pg.displayName="LegendItemComponent";const Dg=s.a.memo(Pg),Ng=({legendItems:e})=>0===e.length?null:s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":"legend"},s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map(((e,t)=>s.a.createElement(ee.EuiFlexItem,{key:`legend-item-${t}`,grow:!1},s.a.createElement(Dg,{legendItem:e}),s.a.createElement(ee.EuiSpacer,{"data-test-subj":"legend-spacer",size:"s"}))))));Ng.displayName="LegendComponent";const Rg=s.a.memo(Ng),Lg=Y.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),Bg=Y.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),zg=({isUpdating:e,updatedAt:t})=>s.a.createElement(ee.EuiFlexGroup,null,e?s.a.createElement(ee.EuiFlexItem,{grow:!1},Lg):s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(s.a.Fragment,null,Bg," "),s.a.createElement(ms.FormattedRelative,{"data-test-subj":"last-updated-at-date",value:new Date(t)})));var qg=a(149),$g=a(670),Vg=a(228);const Ug=()=>{const e=Object(c.useDispatch)(),t=Object(r.useMemo)((()=>mt.e.getSourcererDataViewsSelector()),[]),{defaultDataView:a,signalIndexName:n}=Object(F.a)((e=>t(e))),i=Object(Vg.a)({timelineId:g.c.active,timelineType:Lf.l.default}),s=Object(r.useCallback)(((t,r)=>{i({timeRange:r}),e(Object(D.updateProviders)({id:g.c.active,providers:t})),e(qg.a.setSelectedDataView({id:x.SourcererScopeName.timeline,selectedDataViewId:a.id,selectedPatterns:[n||""]}))}),[i,a.id,e,n]);return{openTimelineWithFilters:Object(r.useCallback)(((e,t)=>{const a=[];for(const t of e){const e=t[0];if(e){const n=Object($g.a)(e.field,Object(Ma.v4)(),e.value,e.operator);for(const e of t.slice(1))n.and.push(Object($g.b)(e.field,Object(Ma.v4)(),e.value,e.operator));a.push(n)}}s(a,t)}),[s])}};var Hg=a(347);const Qg="detection-response-alerts-by-status",Gg=`${Qg}-open`,Wg=`${Qg}- acknowledged`,Zg=`${Qg}-closed`,Kg=Object(Ma.v4)(),Jg=(e="kibana.alert.workflow_status",t)=>({title:"Alerts",description:"",visualizationType:"lnsPie",state:{visualization:{shape:"donut",layers:[{layerId:Kg,primaryGroups:["a9b43606-7ff7-46ae-a47c-85bed80fab9a"],metrics:["21cc4a49-3780-4b1a-be28-f02fa5303d24"],numberDisplay:"value",categoryDisplay:"hide",legendDisplay:"hide",nestedLegend:!0,layerType:"data",emptySizeRatio:.85,percentDecimals:2}]},query:{query:"",language:"kuery"},filters:[...null!=t&&t.status&&e?[{meta:{disabled:!1,negate:!1,alias:null,index:"a1aaa83b-5026-444e-9465-50e0afade01c",key:e,field:e,params:{query:null==t?void 0:t.status},type:"phrase"},query:{match_phrase:{[e]:null==t?void 0:t.status}}}]:[],...null!=t&&t.filters?t.filters:[]],datasourceStates:{formBased:{layers:{[Kg]:{columns:{"a9b43606-7ff7-46ae-a47c-85bed80fab9a":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:'kibana.alert.severity: "critical"',language:"kuery"},label:"Critical"},{label:"High",input:{query:'kibana.alert.severity : "high" ',language:"kuery"}},{input:{query:'kibana.alert.severity: "medium"',language:"kuery"},label:"Medium"},{input:{query:'kibana.alert.severity : "low" ',language:"kuery"},label:"Low"}]}},"21cc4a49-3780-4b1a-be28-f02fa5303d24":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:"",language:"kuery"},params:{emptyAsNull:!0}}},columnOrder:["a9b43606-7ff7-46ae-a47c-85bed80fab9a","21cc4a49-3780-4b1a-be28-f02fa5303d24"],sampling:1,incompleteColumns:{}}}},textBased:{layers:{}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${Kg}`},{type:"index-pattern",name:"a1aaa83b-5026-444e-9465-50e0afade01c",id:"{dataViewId}"}]}),Yg=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-af0tmj-0"})(["padding:0 4px;"]),Xg=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledLegendFlexItem",componentId:"sc-af0tmj-1"})(["padding-left:32px;padding-top:45px;"]),ey=120,ty=[{key:"critical",label:Va,color:Ln.b.critical},{key:"high",label:Ua,color:Ln.b.high},{key:"medium",label:Ha,color:Ln.b.medium},{key:"low",label:Qa,color:Ln.b.low}],ay={field:"event.kind",value:"signal"},ny={status:"open"},iy={status:"acknowledged"},ry={status:"closed"},sy=({additionalFilters:e,applyGlobalQueriesAndFilters:t=!0,signalIndexName:a,entityFilter:n})=>{var i,o,u,d,p,m,f,b,g;const{toggleStatus:y,setToggleStatus:h}=Object(Er.a)(Qg),{openTimelineWithFilters:v}=Ug(),E=Ig(),{onClick:j,href:S}=Object($t.o)()({deepLinkId:l.yc.alerts}),O=Object(ve.a)("donutChartEmbeddablesEnabled"),{to:k,from:w}=Object(xe.a)(),T=Object(r.useMemo)((()=>({from:w,to:k})),[w,k]),I=Object(ee.useIsWithinMinBreakpoint)("xl"),C=Object(ee.useIsWithinMaxBreakpoint)("s")||I?120:90,M=Object(r.useMemo)((()=>({name:n?Cn:Cg.n,href:n?void 0:S,onClick:n?()=>v([[n,ay]]):j})),[n,S,j,v]),{items:_,isLoading:A,updatedAt:F}=(({additionalFilters:e,entityFilter:t,queryId:a,signalIndexName:n,skip:i=!1,to:s,from:o})=>{const l=Object(c.useDispatch)(),[u,d]=Object(r.useState)(Date.now()),[p,m]=Object(r.useState)(null),f=Object(r.useCallback)((({id:e,inspect:t,loading:a,refetch:n,searchSessionId:i})=>l(Me.b.setQuery({inputId:Ee.a.global,id:e,inspect:t,loading:a,refetch:n,searchSessionId:i}))),[l]),b=Object(r.useCallback)((({id:e})=>l(Me.b.deleteOneQuery({inputId:Ee.a.global,id:e}))),[l]),{data:g,loading:y,refetch:h,request:v,response:E,setQuery:x}=Object(B.a)({query:Nn({from:o,to:s,entityFilter:t,additionalFilters:e}),indexName:n,skip:i,queryName:z.a.BY_STATUS});Object(r.useEffect)((()=>{x(Nn({from:o,to:s,entityFilter:t,additionalFilters:e}))}),[x,o,s,t,e]),Object(r.useEffect)((()=>{m(null==g?null:(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByStatus)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?null:i.reduce(((e,t)=>{var a,n;const i=null!==(a=null===(n=t.statusBySeverity)||void 0===n?void 0:n.buckets)&&void 0!==a?a:[];return{...e,[t.key]:{total:t.doc_count,severities:i.map((e=>({key:e.key,value:e.doc_count,label:Dn[e.key]})))}}}),{})})(g)),d(Date.now())}),[g]);const j=Object(r.useCallback)((()=>{!i&&h&&h()}),[i,h]);return Object($a.b)({deleteQuery:b,inspect:{dsl:[v],response:[E]},refetch:j,setQuery:f,queryId:a,loading:y}),{items:p,isLoading:y,updatedAt:u}})({additionalFilters:e,entityFilter:n,signalIndexName:a,skip:!y||O,queryId:Qg,to:k,from:w}),P=Object(r.useMemo)((()=>ty.map((e=>({color:e.color,field:Ca.X,value:e.label})))),[]),D=Object(r.useCallback)(((e,t)=>E([{title:_n,selectedOptions:[e],fieldName:Ca.ob},...t?[{title:Mn,selectedOptions:[t],fieldName:Ca.X}]:[],...n?[{selectedOptions:[n.value],fieldName:n.field}]:[]])),[n,E]),N=Object(r.useCallback)((e=>D(uo.d,e)),[D]),R=Object(r.useCallback)((e=>D(uo.b,e)),[D]),L=Object(r.useCallback)((e=>D(uo.c,e)),[D]),q=null!==(i=null==_||null===(o=_.open)||void 0===o?void 0:o.total)&&void 0!==i?i:0,$=null!==(u=null==_||null===(d=_.acknowledged)||void 0===d?void 0:d.total)&&void 0!==u?u:0,V=null!==(p=null==_||null===(m=_.closed)||void 0===m?void 0:m.total)&&void 0!==p?p:0,U=A||null==_?0:q+$+V,{total:H}=(()=>{var e;const t=Object(Hg.a)({visualizationId:Gg}),a=Object(Hg.a)({visualizationId:Wg}),n=Object(Hg.a)({visualizationId:Zg}),i=null!=t?t[0].hits.total:0,r=null!=a?a[0].hits.total:0,s=null!=n?n[0].hits.total:0;return{open:i,acknowledged:r,closed:s,total:null!==(e=i+r+s)&&void 0!==e?e:0}})(),Q=O?H:U,G=Object(r.useCallback)((e=>{var t,a;return null!==(t=null===(a=ty.find((t=>t.label===e)))||void 0===a?void 0:a.color)&&void 0!==t?t:Rn.b}),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":`${Qg}-panel`},A&&s.a.createElement(ee.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(Li.a,{id:Qg,title:n?Ya:Ja,titleSize:"m",subtitle:s.a.createElement(zg,{isUpdating:A,updatedAt:F}),inspectMultiple:!0,toggleStatus:y,toggleQuery:h,showInspectButton:!O},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($t.g,{"data-test-subj":"view-details-button",onClick:M.onClick,href:M.href},M.name)))),y&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:O},s.a.createElement(ee.EuiText,{className:"eui-textCenter",size:"s"},0!==U||0!==H&&s.a.createElement(s.a.Fragment,null,s.a.createElement("b",null,s.a.createElement(Xn.a,{count:Q})),s.a.createElement(s.a.Fragment,null," "),s.a.createElement("small",null,(e=>Y.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.totalAlerts",{values:{totalAlerts:e},defaultMessage:"total {totalAlerts, plural, =1 {alert} other {alerts}}"}))(Q)))),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center"},s.a.createElement(Yg,{key:"alerts-status-open",grow:O},O?s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:t,extraOptions:ny,getLensAttributes:Jg,height:ey,id:`${Qg}-open`,isDonut:!0,label:Wa,scopeId:x.SourcererScopeName.detections,stackByField:Ca.ob,timerange:T,width:ey}):s.a.createElement(Ki.a,{onPartitionClick:N,data:null==_||null===(f=_.open)||void 0===f?void 0:f.severities,fillColor:G,height:C,label:Wa,title:s.a.createElement(Ji.a,{onClick:N,count:q}),totalCount:q})),s.a.createElement(Yg,{key:"alerts-status-acknowledged",grow:O},O?s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:t,extraOptions:iy,getLensAttributes:Jg,height:ey,id:`${Qg}-acknowledged`,isDonut:!0,label:Ga,scopeId:x.SourcererScopeName.detections,stackByField:Ca.ob,timerange:T,width:ey}):s.a.createElement(Ki.a,{data:null==_||null===(b=_.acknowledged)||void 0===b?void 0:b.severities,fillColor:G,height:C,label:Ga,onPartitionClick:R,title:s.a.createElement(Ji.a,{onClick:R,count:$}),totalCount:$})),s.a.createElement(Yg,{key:"alerts-status-closed",grow:O},O?s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:t,extraOptions:ry,getLensAttributes:Jg,height:ey,id:`${Qg}-closed`,isDonut:!0,label:Za,scopeId:x.SourcererScopeName.detections,stackByField:Ca.ob,timerange:T,width:ey}):s.a.createElement(Ki.a,{data:null==_||null===(g=_.closed)||void 0===g?void 0:g.severities,fillColor:G,height:C,label:Za,onPartitionClick:L,title:s.a.createElement(Ji.a,{onClick:L,count:V}),totalCount:V})))),!O&&s.a.createElement(Xg,{grow:!1},P.length>0&&s.a.createElement(Rg,{legendItems:P}))),s.a.createElement(ee.EuiSpacer,{size:"m"})))))};var oy=a(322),ly=a(69),cy=a(285);const uy=s.a.memo((({allItems:e,selectedItems:t,title:a,onSelectedItemsChange:n})=>{const[i,o]=Object(r.useState)(!1),l=Object(r.useCallback)((e=>n(dy(e,t))),[t,n]),c=Object(r.useMemo)((()=>e.map(((e,a)=>s.a.createElement(ee.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${a}-${e}`,onClick:()=>l(e),title:e},e)))),[e,t,l]),u=Object(r.useCallback)((e=>{o((t=>e||!t))}),[o]);return s.a.createElement(ee.EuiPopover,{ownFocus:!0,button:s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiFilterButton,{grow:!1,"data-test-subj":"multiselect-popover-button",iconType:"arrowDown",onClick:()=>u(),numFilters:e.length,isSelected:i,hasActiveFilters:t.length>0,numActiveFilters:t.length},a)),isOpen:i,closePopover:()=>u(!1),panelPaddingSize:"none"},c)}));uy.displayName="MultiSelectPopover";const dy=(e,t)=>{const a=t.indexOf(e),n=[...t];return a>=0?n.splice(a,1):n.push(e),n},py=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.status",{defaultMessage:"Status"}),my=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.alertsByRule",{defaultMessage:"Alerts by Rule"}),fy=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.ruleName",{defaultMessage:"kibana.alert.rule.name"}),by=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.count",{defaultMessage:"count"}),gy=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.tooltipTitle",{defaultMessage:"Rule name"}),yy=Y.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.noRuleAlerts",{defaultMessage:"No alerts to display"}),hy="alertsByRuleAggregation",vy="kibana.alert.rule.uuid",Ey=({additionalFilters:e=[],from:t,to:a,field:n,value:i,statuses:r})=>({size:0,_source:!1,fields:[vy],query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},...(null==r?void 0:r.length)>0?[{terms:{"kibana.alert.workflow_status":r}}]:[],{term:{[n]:i}}]}},aggs:{[hy]:{terms:{field:"kibana.alert.rule.name",size:100},aggs:{ruleUuid:{top_hits:{_source:!1,fields:[vy],size:1}}}}}}),xy=["open","acknowledged","closed"],jy=Object(ly.euiStyled)(ee.EuiPanel)`
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  max-height: 308px;
`,Sy=s.a.memo((({entityFilter:e,signalIndexName:t,additionalFilters:a})=>{const{field:n,value:i}=e,o=`alerts-by-status-by-rule-by-${n}`,{toggleStatus:l,setToggleStatus:c}=Object(Er.a)(o),{openTimelineWithFilters:u}=Ug(),[d,p]=Object(Gt.a)({defaultValue:{[n]:["open"]},key:"alertCountByFieldNameWidgetSettings",isInvalidDefault:e=>!e}),m=Object(r.useMemo)((()=>Oy((t=>{const a=[];for(const i of d[n])a.push([e,{field:cy.n,value:t},{field:cy.o,value:i}]);u(a)}))),[e,n,u,d]),f=Object(r.useCallback)((e=>{p({...d,[n]:e})}),[n,d,p]),{items:b,isLoading:g,updatedAt:y}=(({additionalFilters:e,field:t,value:a,queryId:n,statuses:i,skip:s=!1,signalIndexName:o})=>{const[l,c]=Object(r.useState)(Date.now()),[u,d]=Object(r.useState)([]),{to:p,from:m,deleteQuery:f,setQuery:b}=Object(xe.a)(),{loading:g,data:y,setQuery:h,response:v,request:E,refetch:x}=Object(B.a)({query:Ey({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:i}),skip:s,queryName:z.a.ALERTS_COUNT_BY_STATUS,indexName:o});Object(r.useEffect)((()=>{h(Ey({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:i}))}),[h,m,p,t,a,i,e]),Object(r.useEffect)((()=>{var e,t;d(y?(e=y.aggregations,(null!==(t=null==e?void 0:e[hy].buckets)&&void 0!==t?t:[]).map((e=>{var t,a,n,i;const r=null!==(t=Object(pi.a)(null===(a=e.ruleUuid.hits)||void 0===a||null===(n=a.hits[0])||void 0===n?void 0:n.fields["kibana.alert.rule.uuid"]))&&void 0!==t?t:"";return{ruleName:null!==(i=Object(pi.a)(e.key))&&void 0!==i?i:"-",count:e.doc_count,uuid:r}}))):[]),c(Date.now())}),[y]);const j=Object(r.useCallback)((()=>{!s&&x&&x()}),[s,x]);return Object($a.b)({deleteQuery:f,inspect:{dsl:[E],response:[v]},refetch:j,setQuery:b,queryId:n,loading:g}),{items:u,isLoading:g,updatedAt:l}})({additionalFilters:a,field:n,value:i,queryId:o,statuses:d[n],skip:!l,signalIndexName:t});return s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(jy,{hasBorder:!0,"data-test-subj":"alertCountByRulePanel"},s.a.createElement(s.a.Fragment,null,s.a.createElement(Li.a,{id:o,title:my,titleSize:"m",toggleStatus:l,toggleQuery:c,subtitle:s.a.createElement(zg,{updatedAt:y,isUpdating:g})},s.a.createElement(uy,{title:py,allItems:xy,selectedItems:d[n]||["open"],onSelectedItemsChange:e=>f(e)})),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiBasicTable,{className:"eui-yScroll","data-test-subj":"alertCountByRuleTable",columns:m,items:b,loading:g,noItemsMessage:s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,yy),titleSize:"xs"})})))))}));Sy.displayName="AlertCountByStatus";const Oy=e=>[{field:"ruleName",name:fy,"data-test-subj":fy,align:"left",width:"67%",sortable:!1,render:(e,{uuid:t})=>s.a.createElement(ee.EuiToolTip,{"data-test-subj":`${e}-tooltip`,title:gy,content:e,anchorClassName:"eui-textTruncate"},s.a.createElement($t.k,{"data-test-subj":"severityRuleAlertsTable-name",deepLinkId:l.yc.rules,path:`id/${t}`},e))},{field:"count",name:by,width:"33%","data-test-subj":by,sortable:!0,align:"right",render:(t,{ruleName:a})=>s.a.createElement(ee.EuiLink,{disabled:0===t,onClick:()=>e(a)},s.a.createElement(Xn.a,{count:t}))}];var ky=a(426);const wy=e=>Y.i18n.translate("xpack.securitySolution.riskTabBody.scoreOverTimeTitle",{defaultMessage:"{riskEntity} risk score over time",values:{riskEntity:Object(um.d)(e)}}),Ty=Y.i18n.translate("xpack.securitySolution.riskTabBody.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"}),Iy=Y.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyThresholdHeader",{defaultMessage:"Risky threshold"}),Cy=Y.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyLabel",{defaultMessage:"Risky"}),My=Y.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskScore",{defaultMessage:"Risk score"}),_y={host:Object(Ma.v4)(),user:Object(Ma.v4)()},Ay=(e="host",t={spaceId:"default"})=>{const a=[Object(Ma.v4)(),Object(Ma.v4)()],n=Object(Ma.v4)(),i=_y[e];return{title:`${e} risk score over time`,description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!1,position:"right"},valueLabels:"hide",preferredSeriesType:"line",layers:[{layerId:a[0],accessors:["8886a925-4419-4d9a-8498-3bda4ecf1b0a"],position:"top",seriesType:"line",showGridlines:!1,layerType:"data",xAccessor:"02a55c97-d7a4-440d-ac77-33b941c16189",yConfig:[{forAccessor:"8886a925-4419-4d9a-8498-3bda4ecf1b0a",axisMode:"left"}]},{layerId:a[1],layerType:"referenceLine",accessors:[n],yConfig:[{forAccessor:n,axisMode:"left",lineWidth:2,color:"#aa6556",icon:"alert",textVisibility:!0,fill:"none",iconPosition:"left"}]}],xTitle:"",axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},yTitle:"",yRightTitle:"",valuesInLegend:!0,labelsOrientation:{x:0,yLeft:0,yRight:0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},yLeftExtent:{mode:"custom",lowerBound:0,upperBound:100}},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{[a[0]]:{columns:{"02a55c97-d7a4-440d-ac77-33b941c16189":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0,dropPartials:!1}},"8886a925-4419-4d9a-8498-3bda4ecf1b0a":{label:"Risk score",dataType:"number",operationType:"max",sourceField:`${e}.risk.calculated_score_norm`,isBucketed:!1,scale:"ratio",params:{format:{id:"number",params:{decimals:0}},emptyAsNull:!0},customLabel:!0}},columnOrder:["02a55c97-d7a4-440d-ac77-33b941c16189","8886a925-4419-4d9a-8498-3bda4ecf1b0a"],sampling:1,incompleteColumns:{}},[a[1]]:{linkToLayers:[],columns:{[n]:{label:"Risky threshold",dataType:"number",operationType:"static_value",isStaticValue:!0,isBucketed:!1,scale:"ratio",params:{value:"70"},references:[],customLabel:!0}},columnOrder:[n],sampling:1,incompleteColumns:{}}}},textBased:{layers:{}}},internalReferences:[{type:"index-pattern",id:i,name:`indexpattern-datasource-layer-${a[0]}`},{type:"index-pattern",id:i,name:`indexpattern-datasource-layer-${a[1]}`}],adHocDataViews:{[i]:{id:i,title:`ml_${e}_risk_score_${t.spaceId}`,timeFieldName:"@timestamp",sourceFilters:[],fieldFormats:{},runtimeFieldMap:{},fieldAttrs:{},allowNoIndex:!1,name:`ml_${e}_risk_score_${t.spaceId}`}}},references:[]}},Fy=ae()(ee.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-ggkz6s-0"})(["font-size:9px;font-weight:",";margin-right:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiSizeXS)),Py=ae()(ee.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-ggkz6s-1"})(["display:block;text-align:center;"]),Dy=e=>Math.round(e).toString(),Ny=({from:e,to:t,riskScore:a,loading:n,queryId:i,riskEntity:o,title:l,toggleStatus:c,toggleQuery:u})=>{const d=Object(h.l)(),p=Object(r.useMemo)((()=>Object(Cb.a)([e,t])),[e,t]),m=Object(r.useCallback)((({value:e})=>s.a.createElement(Yc.c,{value:e})),[]),{baseTheme:f,theme:b}=Object(li.i)(),g=Object(r.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((e=>({x:e["@timestamp"],y:(Object(rt.F)(e)?e.user:e.host).risk.calculated_score_norm}))).reverse())&&void 0!==e?e:[]}),[a]),y=Object(hl.a)(),v=Object(ve.a)("chartEmbeddablesEnabled"),E=Object(r.useMemo)((()=>({from:e,to:t})),[e,t]);return s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"RiskScoreOverTime"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Li.a,{title:l,hideSubtitle:!0,toggleQuery:u,toggleStatus:c})),c&&!v&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ga.b,{queryId:i,title:l}))),c&&s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:1},v&&y?s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:!1,timerange:E,getLensAttributes:Ay,stackByField:o,id:`${i}-embeddable`,height:180,extraOptions:{spaceId:y}}):s.a.createElement("div",{style:{height:250}},n?s.a.createElement(Py,{size:"l","data-test-subj":"RiskScoreOverTime-loading"}):s.a.createElement(oi.Chart,null,s.a.createElement(oi.Tooltip,{headerFormatter:m}),s.a.createElement(oi.Settings,bo()({},li.e,{baseTheme:f,theme:b,locale:Y.i18n.getLocale()})),s.a.createElement(oi.Axis,{id:"bottom",position:oi.Position.Bottom,tickFormat:p,gridLine:{visible:!0,strokeWidth:1,opacity:1,dash:[3,5]}}),s.a.createElement(oi.Axis,{domain:{min:0,max:100},id:"left",position:oi.Position.Left,ticks:3,style:{tickLine:{visible:!1},tickLabel:{padding:10}}}),s.a.createElement(oi.LineSeries,{id:"RiskOverTime",name:My,xScaleType:oi.ScaleType.Time,yScaleType:oi.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],timeZone:d,data:g,tickFormat:Dy}),s.a.createElement(oi.LineAnnotation,{id:"RiskOverTime_annotation",domainType:oi.AnnotationDomainType.YDomain,dataValues:[{dataValue:70,details:"70",header:Iy}],markerPosition:"left",style:{line:{strokeWidth:1,stroke:jo.euiThemeVars.euiColorDanger,opacity:1}},marker:s.a.createElement(Fy,{color:jo.euiThemeVars.euiColorDarkestShade},Cy)})))))))};Ny.displayName="RiskScoreOverTimeComponent";const Ry=s.a.memo(Ny);Ry.displayName="RiskScoreOverTime";const Ly=Y.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.title",{defaultMessage:"Top risk score contributors"}),By=Y.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.rankColumnTitle",{defaultMessage:"Rank"}),zy=Y.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.ruleNameColumnTitle",{defaultMessage:"Rule name"});var qy=a(232),$y=a(1082),Vy=a(415),Uy=a(1083),Hy=a(1140),Qy=a(882);const Gy=ae()(ee.EuiFlexGroup).withConfig({displayName:"IntegrationsPopoverWrapper",componentId:"sc-1x92pc2-0"})(["width:100%;"]),Wy=ae()(ee.EuiPopoverTitle).withConfig({displayName:"PopoverTitleWrapper",componentId:"sc-1x92pc2-1"})(["max-width:390px;"]),Zy=ae()("div").withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1x92pc2-2"})(["max-height:400px;max-width:390px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),Ky=ae()("li").withConfig({displayName:"IntegrationListItem",componentId:"sc-1x92pc2-3"})(["list-style-type:disc;margin-left:25px;margin-bottom:5px;"]),Jy=({relatedIntegrations:e})=>{const[t,a]=Object(r.useState)(!1),{integrations:n,isLoaded:i}=Object(Hy.a)(e),o=Object(r.useMemo)((()=>n.filter((e=>e.installationStatus.isKnown&&e.installationStatus.isEnabled))),[n]),l=n.length,c=o.length,u=Object(r.useMemo)((()=>i?`${c}/${l} ${Qy.a}`:`${l} ${Qy.a}`),[i,l,c]);return s.a.createElement(Gy,{alignItems:"center",gutterSize:"s","data-test-subj":"IntegrationsWrapper"},s.a.createElement(ee.EuiPopover,{ownFocus:!0,"data-test-subj":"IntegrationsDisplayPopover",button:s.a.createElement(ee.EuiBadge,{iconType:"package",color:"hollow","data-test-subj":"IntegrationsDisplayPopoverButton",onClick:()=>a(!t),onClickAriaLabel:u},u),isOpen:t,closePopover:()=>a(!t),repositionOnScroll:!0},s.a.createElement(Wy,{"data-test-subj":"IntegrationsPopoverTitle"},Qy.h(l)),s.a.createElement(Zy,{"data-test-subj":"IntegrationsPopoverContentWrapper"},s.a.createElement(ee.EuiText,{size:"s"},Qy.g(l)),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement("ul",null,n.map(((e,t)=>s.a.createElement(Ky,{key:`${e.packageName}-${t}`},s.a.createElement(Uy.a,{integration:e}))))))))},Yy=s.a.memo(Jy);Yy.displayName="IntegrationsPopover";const Xy=Yy;var eh=a(1426),th=a(191),ah=a(224),nh=a(406),ih=a(50),rh=a(532),sh=a(1060),oh=a(472),lh=a(604),ch=a(886),uh=a(885),dh=a(483);const ph=["POST",l.hb];function mh(e){switch(e){case th.b.export:return Oo.Dc;case th.b.duplicate:return Oo.pc;case th.b.delete:return Oo.hc;case th.b.enable:return Oo.yc;case th.b.disable:return Oo.lc;case th.b.edit:return Oo.tc}}function fh(e){switch(e){case th.b.export:return Oo.Ac;case th.b.duplicate:return Oo.nc;case th.b.delete:return Oo.fc;case th.b.enable:return Oo.wc;case th.b.disable:return Oo.jc;case th.b.edit:return Oo.rc}}function bh(e,t){var a,n;const i=null===(a=t.body)||void 0===a||null===(n=a.attributes)||void 0===n?void 0:n.summary;if(!i)return"";switch(e){case th.b.export:return Oo.Bc(i.failed);case th.b.duplicate:return Oo.oc(i.failed);case th.b.delete:return Oo.gc(i.failed);case th.b.enable:return Oo.xc(i.failed);case th.b.disable:return Oo.kc(i.failed);case th.b.edit:return Oo.sc(i.failed,i.skipped)}}const gh=(e,t)=>{const a=[Oo.Ec(e,t)];return t>e&&a.push(Oo.Cc),a.join(" ")};function yh(){const e=Object(Pt.a)();return Object(r.useCallback)((({actionType:t,error:a})=>{e.addError(function(e){return e.stack=JSON.stringify(e.body,null,2),e}(a),{title:fh(t),toastMessage:bh(t,a)})}),[e])}function hh(){const e=Object(Pt.a)();return Object(r.useCallback)((({actionType:t,summary:a,editPayload:n})=>{const i=t===th.b.edit?function(e,t){const a=t.skipped>0?` ${Oo.uc}`:null;return e.some((e=>e.type===th.a.add_index_patterns||e.type===th.a.set_index_patterns||e.type===th.a.delete_index_patterns))?`${Oo.vc(t.succeeded,t.skipped)}${a}`:Oo.vc(t.succeeded,t.skipped)}(null!=n?n:[],a):function(e,t){switch(e){case th.b.export:return gh(t.succeeded,t.total);case th.b.duplicate:return Oo.qc(t.succeeded);case th.b.delete:return Oo.ic(t.succeeded);case th.b.enable:return Oo.zc(t.succeeded);case th.b.disable:return Oo.mc(t.succeeded)}}(t,a);e.addSuccess({title:mh(t),text:i})}),[e])}function vh(){const e=Object(nh.c)();return Object(r.useCallback)((t=>{const a=null!=e&&e.state.isAllSelected?e.state.rules:[];return(t===th.b.enable?a.filter((e=>!e.enabled)):t===th.b.disable?a.filter((e=>e.enabled)):a).map((e=>e.id))}),[e])}const Eh=(e,t)=>{t(l.l,{deepLinkId:P.a.rules,path:Object(we.b)(null!=e?e:"")})},xh=e=>{const{mutateAsync:t}=(e=>{const t=Object(rh.b)(),a=Object(sh.b)(),n=Object(oh.b)(),i=Object(lh.b)(),r=Object(uh.b)(),s=Object(ch.b)(),o=Object(dh.b)(),l=Object(rh.c)();return Object(ih.useMutation)((e=>Object(xc.q)(e)),{...e,mutationKey:ph,onSettled:(...e)=>{var c,u,d,p,m,f;const[b,g,{bulkAction:{type:y}}]=e,h=null!==(c=null==b||null===(u=b.attributes)||void 0===u||null===(d=u.results)||void 0===d?void 0:d.updated)&&void 0!==c?c:null==g||null===(p=g.body)||void 0===p||null===(m=p.attributes)||void 0===m||null===(f=m.results)||void 0===f?void 0:f.updated;switch(y){case th.b.enable:case th.b.disable:a(),o(),h?l(h):t();break;case th.b.delete:t(),a(),n(),i(),r(),s(),o();break;case th.b.duplicate:t(),n(),o();break;case th.b.edit:h?l(h):t(),a(),n(),o()}}})})(),a=hh(),n=yh(),i=vh(),s=Object(nh.c)(),o=null==s?void 0:s.actions.setLoadingRules;return{executeBulkAction:Object(r.useCallback)((async r=>{try{var s;null==o||o({ids:null!==(s=r.ids)&&void 0!==s?s:i(r.type),action:r.type});const n=await t({bulkAction:r});return function(e,t){e!==th.b.disable&&e!==th.b.enable||(t.attributes.results.updated.some((e=>e.immutable))&&Object(Do.h)(Do.a.COUNT,e===th.b.enable?Do.c.SIEM_RULE_ENABLED:Do.c.SIEM_RULE_DISABLED),t.attributes.results.updated.some((e=>!e.immutable))&&Object(Do.h)(Do.a.COUNT,e===th.b.disable?Do.c.CUSTOM_RULE_DISABLED:Do.c.CUSTOM_RULE_ENABLED))}(r.type,n),null!=e&&e.suppressSuccessToast||a({actionType:r.type,summary:n.attributes.summary,editPayload:r.type===th.b.edit?r.editPayload:void 0}),n}catch(e){n({actionType:r.type,error:e})}finally{null==o||o({ids:[],action:null})}}),[null==e?void 0:e.suppressSuccessToast,i,o,t,a,n])}},jh=ae()(ee.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1s9ljiu-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);jh.displayName="StaticSwitch";const Sh=({id:e,isDisabled:t,isLoading:a,enabled:n,startMlJobsIfNeeded:i,onChange:o})=>{const[l,c]=Object(r.useState)(!1),u=Object(nh.c)(),{startTransaction:d}=Object(Mo.b)(),{executeBulkAction:p}=xh({suppressSuccessToast:!u}),m=Object(r.useCallback)((async t=>{c(!0),d({name:n?ah.e.DISABLE:ah.e.ENABLE});const a=t.target.checked;a&&await(null==i?void 0:i());const r=await p({type:a?th.b.enable:th.b.disable,ids:[e]});null!=r&&r.attributes.results.updated.length&&(null==o||o(r.attributes.results.updated[0].enabled)),c(!1)}),[n,p,e,o,i,d]),f=Object(r.useMemo)((()=>l!==a&&a||l),[l,a]);return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround",id:`rule-switch-${e}`},s.a.createElement(ee.EuiFlexItem,{grow:!1},f?s.a.createElement(ee.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):s.a.createElement(jh,{"data-test-subj":"ruleSwitch",showLabel:!1,label:"",disabled:t,checked:n,onChange:m})))},Oh=s.a.memo(Sh);Oh.displayName="RuleSwitch";var kh=a(567),wh=a(922);const Th=({columnName:e,children:t})=>{const[a,n]=Object(r.useState)(!1);return s.a.createElement(ee.EuiPopover,{anchorPosition:"upCenter",isOpen:a,closePopover:()=>n(!1),button:s.a.createElement(ee.EuiButtonIcon,{"aria-label":Oo.cc(e),onClick:e=>{n(!a),e.stopPropagation()},size:"xs",color:"primary",iconType:"questionInCircle",style:{height:"auto"}})},t)},Ih=s.a.memo(Th);Ih.displayName="PopoverTooltip";const Ch=({title:e,tooltipContent:t,customTooltip:a})=>s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{style:{width:"calc(100% - 20px)"}},s.a.createElement("span",{className:"eui-textTruncate"},e)),null!=a?a:s.a.createElement(ee.EuiToolTip,{content:t},s.a.createElement(ee.EuiIcon,{"data-test-subj":"tableHeaderIcon",size:"m",color:"subdued",type:"questionInCircle",style:{marginLeft:4}}))),Mh=s.a.memo(Ch);Mh.displayName="TableHeaderTooltipCell";const _h=()=>{const{services:{application:{capabilities:{actions:e}}}}=Object(h.i)();return!Object(Vy.d)(e.show)||e.show};var Ah=a(1065),Fh=a(731);const Ph=()=>{const e=Object(ju.a)();return Object(Fh.a)(e)&&Object(Ah.a)(e)};let Dh;!function(e){e.withExceptions="withExceptions",e.withExceptionsExcludeExpiredExceptions="withExceptionsExcludeExpiredExceptions",e.withoutExceptions="withoutExceptions"}(Dh||(Dh={}));const Nh=["POST",l.hb],Rh=e=>Object(ih.useMutation)((e=>Object(xc.b)(e)),{...e,mutationKey:Nh});function Lh(){const{mutateAsync:e}=Rh(),t=yh(),a=vh(),n=Object(nh.c)(),i=null==n?void 0:n.actions.setLoadingRules;return{bulkExport:Object(r.useCallback)((async n=>{try{var r;return null==i||i({ids:null!==(r=n.ids)&&void 0!==r?r:a(th.b.export),action:th.b.export}),await e(n)}catch(e){t({actionType:th.b.export,error:e})}finally{null==i||i({ids:[],action:null})}}),[a,i,e,t])}}var Bh=a(714);const zh=`${Oo.Gb}.ndjson`;function qh(){const e=hh(),t=yh();return Object(r.useCallback)((async a=>{try{Object(Bh.a)(a,zh),e({actionType:th.b.export,summary:await Oc(a)})}catch(e){t({actionType:th.b.export,error:e})}}),[e,t])}var $h=a(290);const Vh=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.mlJobsWarning.popover.description",{defaultMessage:"The following jobs are not running and might cause the rule to generate wrong results:"}),Uh=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.mlJobsWarning.popover.buttonLabel",{defaultMessage:"Visit rule details page to investigate"}),Hh=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.allRules.tabs.rules",{defaultMessage:"Installed Rules"}),Qh=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),Gh=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.allRules.tabs.updates",{defaultMessage:"Rule Updates"});Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.allRules.tabs.addRules",{defaultMessage:"Add Rules"});var Wh=a(671),Zh=a(231),Kh=a(1160),Jh=a(340);const Yh=({rule:e,loadingJobs:t,jobs:a})=>{const[n,,i,r]=Object(Wh.a)(),o=Object(Jh.g)(e);if(!Object(Zh.d)(e.type)||t||!o)return null;const c=a.filter((e=>o.includes(e.id)&&!Object(qy.c)(e.jobState,e.datafeedState)));if(!c.length)return null;const u=s.a.createElement(ee.EuiButtonIcon,{display:"empty",color:"warning",iconType:"warning",onClick:r}),d=Object(Kh.a)($h.g["partial failure"]);return s.a.createElement(ee.EuiPopover,{button:u,isOpen:n,closePopover:i,anchorPosition:"leftCenter"},s.a.createElement(ee.EuiPopoverTitle,null,d),s.a.createElement("div",{style:{width:"340px"}},s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("p",null,Vh))),s.a.createElement(ee.EuiSpacer,{size:"s"}),c.map((e=>{var t,a;return s.a.createElement(ee.EuiText,{key:e.id},null!==(t=null===(a=e.customSettings)||void 0===a?void 0:a.security_app_display_name)&&void 0!==t?t:e.id)})),s.a.createElement(ee.EuiPopoverFooter,null,s.a.createElement($t.l,{"data-test-subj":"open-rule-details",fullWidth:!0,deepLinkId:l.yc.rules,path:Object(we.c)(e.id,wh.b.alerts)},Uh)))},Xh=s.a.memo(Yh);Xh.displayName="MlRuleWarningPopover";const ev=({hasCRUDPermissions:e,startMlJobs:t})=>{const a=Ph(),n=_h(),{loadingRulesAction:i,loadingRuleIds:o}=Object(nh.b)().state,l=Object(r.useMemo)((()=>["disable","enable","edit","delete"].includes(null!=i?i:"")?o:[]),[o,i]);return Object(r.useMemo)((()=>({field:"enabled",name:Oo.bb,render:(i,r)=>s.a.createElement(ee.EuiToolTip,{position:"top",content:Object(Vy.b)(r,a,n,e)},s.a.createElement(Oh,{id:r.id,enabled:r.enabled,startMlJobsIfNeeded:()=>t(Object(Jh.g)(r)),isDisabled:!Object(Vy.a)(r,n)||!e||Object(qy.d)(r.type)&&!a,isLoading:l.includes(r.id)})),width:"95px",sortable:!0})),[a,n,e,l,t])},tv=({name:e,id:t})=>s.a.createElement(ee.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},s.a.createElement($t.k,{"data-test-subj":"ruleName",deepLinkId:l.yc.rules,path:Object(we.c)(t,wh.b.alerts)},e)),av=()=>Object(r.useMemo)((()=>({field:"name",name:Oo.mb,render:(e,t)=>s.a.createElement(tv,{id:t.id,name:e}),sortable:!0,truncateText:!0,width:"38%"})),[]),nv=({sortable:e,width:t,isLoadingJobs:a,mlJobs:n})=>Object(r.useMemo)((()=>({field:"execution_summary.last_execution.status",name:Oo.hb,render:(e,t)=>{var i;return s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(eh.b,{status:e,message:null===(i=t.execution_summary)||void 0===i?void 0:i.last_execution.message})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Xh,{rule:t,loadingJobs:a,jobs:n})))},sortable:e,truncateText:!0,width:t})),[a,n,e,t]),iv={field:"tags",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(So.a,{items:e,popoverTitle:Oo.pb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>s.a.createElement(ee.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},rv={field:"related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(Xy,{relatedIntegrations:e}),width:"143px",truncateText:!0},sv=({showExceptionsDuplicateConfirmation:e,confirmDeletion:t})=>{const a=(({showExceptionsDuplicateConfirmation:e,confirmDeletion:t})=>{const{navigateToApp:a}=Object(h.i)().services.application,n=_h(),{startTransaction:i}=Object(Mo.b)(),{executeBulkAction:r}=xh(),{bulkExport:o}=Lh(),l=qh();return[{type:"icon","data-test-subj":"editRuleAction",description:Oo.Cb,name:n?Oo.Cb:s.a.createElement(ee.EuiToolTip,{position:"left",content:Oo.Qb},s.a.createElement(s.a.Fragment,null,Oo.Cb)),icon:"controlsHorizontal",onClick:e=>Eh(e.id,a),enabled:e=>Object(Vy.a)(e,n)},{type:"icon","data-test-subj":"duplicateRuleAction",description:Oo.Ab,icon:"copy",name:n?Oo.Ab:s.a.createElement(ee.EuiToolTip,{position:"left",content:Oo.Qb},s.a.createElement(s.a.Fragment,null,Oo.Ab)),enabled:e=>Object(Vy.a)(e,n),onClick:async t=>{i({name:ah.e.DUPLICATE});const n=await e();if(null===n)return;const s=await r({type:th.b.duplicate,ids:[t.id],duplicatePayload:{include_exceptions:n===Dh.withExceptions||n===Dh.withExceptionsExcludeExpiredExceptions,include_expired_exceptions:!(n===Dh.withExceptionsExcludeExpiredExceptions)}}),o=null==s?void 0:s.attributes.results.created;null!=o&&o.length&&Eh(o[0].id,a)}},{type:"icon","data-test-subj":"exportRuleAction",description:Oo.Hb,icon:"exportAction",name:Oo.Hb,onClick:async e=>{i({name:ah.e.EXPORT});const t=await o({ids:[e.id]});t&&await l(t)},enabled:e=>!e.immutable},{type:"icon","data-test-subj":"deleteRuleAction",description:Oo.xb,icon:"trash",name:Oo.xb,onClick:async e=>{!1!==await t()&&(i({name:ah.e.DELETE}),await r({type:th.b.delete,ids:[e.id]}))}}]})({showExceptionsDuplicateConfirmation:e,confirmDeletion:t});return Object(r.useMemo)((()=>({actions:a,width:"40px"})),[a])},ov=[{name:By,field:"rank",width:"45px",align:"right"},{name:zy,field:"name",sortable:!0,truncateText:!0,render:(e,{id:t})=>t?s.a.createElement(tv,{id:t,name:e}):e}],lv=({rules:e=[],loading:t,queryId:a,toggleStatus:n,toggleQuery:i})=>{const o=Object(r.useMemo)((()=>null==e?void 0:e.sort(((e,t)=>t.rule_risk-e.rule_risk)).map((({rule_name:e,rule_id:t},a)=>({rank:a+1,name:e,id:t})))),[e]),l=Object(r.useMemo)((()=>({showPerPageOptions:!1,pageSize:5,totalItemCount:o.length})),[o.length]);return s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"topRiskScoreContributors"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Li.a,{title:Ly,hideSubtitle:!0,toggleQuery:i,toggleStatus:n})),n&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ga.b,{queryId:a,title:Ly}))),n&&s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"topRiskScoreContributors-table",gutterSize:"none",direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiInMemoryTable,{items:o,columns:ov,pagination:l,loading:t})))))},cv=s.a.memo(lv);cv.displayName="TopRiskScoreContributors";const uv=Y.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributorsTable.title",{defaultMessage:"Top risk score contributors"});var dv=a(403);const pv=({toggleStatus:e,toggleQuery:t,riskScore:a,riskEntity:n,loading:i})=>{const{to:o,from:c}=Object(xe.a)(),[{loading:u,signalIndexName:d,hasIndexWrite:p,hasIndexMaintenance:m}]=Object(kt.b)(),{runtimeMappings:f}=Object(E.d)(x.SourcererScopeName.detections),b=Object(r.useMemo)((()=>Me.d.globalFiltersQuerySelector()),[]),g=Object(r.useMemo)((()=>Me.d.globalQuerySelector()),[]),y=Object(F.a)(g),h=Object(F.a)(b),v=Object(r.useMemo)((()=>{var e,t;const i=n===dv.e.host?a.host:a.user;return[{meta:{alias:null,negate:!1,disabled:!1},query:{terms:{_id:(null!==(e=null==i||null===(t=i.risk)||void 0===t?void 0:t.inputs)&&void 0!==e?e:[]).map((e=>e.id))}}}]}),[a,n]),j=Object(r.useCallback)((e=>s.a.createElement(ol,{configId:l.e.RISK_INPUTS,inputFilters:[...v,...h,...e],tableId:W.e.alertsRiskInputs})),[v,h]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"topRiskScoreContributorsAlerts"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Li.a,{title:uv,hideSubtitle:!0,toggleQuery:t,toggleStatus:e,headerFilters:s.a.createElement(zm,{riskEntity:n})}))),e&&s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"topRiskScoreContributorsAlerts-table",gutterSize:"none",direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Uo,{defaultFilters:[...v,...h],from:c,globalFilters:h,globalQuery:y,hasIndexMaintenance:null!=m&&m,hasIndexWrite:null!=p&&p,loading:u||i,renderChildComponent:j,runtimeMappings:f,signalIndexName:d,tableId:W.e.alertsRiskInputs,to:o}))))};var mv=a(486);const fv=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-n8fpjk-0"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeL)),bv=e=>e===rt.v.host?Xp:em,gv=({entityName:e,startDate:t,endDate:a,setQuery:n,deleteQuery:o,riskEntity:c})=>{const u=Object(r.useMemo)((()=>c===rt.v.host?Gm.a.HOST_DETAILS_RISK_SCORE:Gm.b.USER_DETAILS_RISK_SCORE),[c]),d=Object(F.a)((e=>c===rt.v.host?i.hostRiskScoreSeverityFilterSelector()(e,We.HostsType.details):Ne.e.userRiskScoreSeverityFilterSelector()(e))),p=(({title:e})=>{const{dashboard:t}=Object(h.i)().services,{getAppUrl:a}=Object(h.c)(),[n,i]=Object(r.useState)(),s=Object(mv.b)(l.yc.dashboards);return Object(r.useEffect)((()=>{let a=!1;return(async()=>{if(t&&e){var n;const r=await(null==t?void 0:t.findDashboardsService()),{id:s}=null!==(n=await r.findByTitle(e))&&void 0!==n?n:{};a||i(s)}})(),()=>{a=!0}}),[t,e]),Object(r.useMemo)((()=>n?a({deepLinkId:l.yc.dashboards,path:`${n}${s}`}):void 0),[n,a,s])})({title:bv(c)}),m=Object(r.useMemo)((()=>({from:t,to:a})),[t,a]),{toggleStatus:f,setToggleStatus:b}=Object(Er.a)(`${u} overTime`),{toggleStatus:g,setToggleStatus:y}=Object(Er.a)(`${u} contributors`),v=Object(r.useMemo)((()=>e?Object(rt.A)([e],c):{}),[e,c]),{data:E,loading:x,refetch:j,inspect:S,isDeprecated:O,isModuleEnabled:k}=Object(Gm.c)({filterQuery:v,onlyLatest:!1,riskEntity:c,skip:!f&&!g,timerange:m}),{data:w}=Object(Lu.c)(),T=Object(r.useMemo)((()=>{const e=E&&E.length>0?E[E.length-1]:null;return e?c===rt.v.host?e.host.risk.rule_risks:e.user.risk.rule_risks:[]}),[E,c]);Object($a.b)({queryId:u,loading:x,refetch:j,setQuery:n,deleteQuery:o,inspect:S});const I=Object(r.useCallback)((e=>{y(e)}),[y]),C=Object(r.useCallback)((e=>{b(e)}),[b]),M={isDisabled:!k&&!x,isDeprecated:O&&!x};return M.isDisabled||M.isDeprecated?s.a.createElement(gm,bo()({},M,{entityType:c,refetch:j,timerange:m})):k&&0===d.length&&E&&0===E.length?s.a.createElement(Jm,{entityType:c,refetch:j}):s.a.createElement(s.a.Fragment,null,(null==w?void 0:w.isUpdateAvailable)&&s.a.createElement(Df,null),null!=w&&w.isNewRiskScoreModuleInstalled?s.a.createElement(fv,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,(null==E?void 0:E[0])&&s.a.createElement(pv,{toggleStatus:g,toggleQuery:I,riskScore:E[0],riskEntity:c,loading:x}))):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{direction:"row"},s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(Ry,{from:t,loading:x,queryId:u,riskEntity:c,riskScore:E,title:wy(c),to:a,toggleQuery:C,toggleStatus:f})),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(cv,{loading:x,queryId:u,toggleStatus:g,toggleQuery:I,rules:T}))),s.a.createElement(fv,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{href:p,isDisabled:!p,"data-test-subj":`risky-${c}s-view-dashboard-button`,target:"_blank",iconType:"popout",iconSide:"right"},Ty)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zm,{riskEntity:c})))))};gv.displayName="RiskDetailsTabBodyComponent";const yv=s.a.memo(gv);yv.displayName="RiskDetailsTabBody";const hv=`${l.Lc}/name/:detailName`,vv=`${l.Lc}/:tabName(${Uc.UsersTableType.allUsers}|${Uc.UsersTableType.authentications}|${Uc.UsersTableType.anomalies}|${Uc.UsersTableType.risk}|${Uc.UsersTableType.events}|)`,Ev=`${hv}/:tabName(${Uc.UsersTableType.authentications}|${Uc.UsersTableType.anomalies}|${Uc.UsersTableType.events}|${Uc.UsersTableType.risk})`,xv=s.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:i,setQuery:r,to:o,type:l,detailName:c,userDetailFilter:u})=>{const d={deleteQuery:e,endDate:o,filterQuery:t,indexNames:n,skip:i||void 0===t,setQuery:r,startDate:a,type:l,userName:c};return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${hv}/:tabName(${Uc.UsersTableType.authentications})`},s.a.createElement(Fd,d)),s.a.createElement(K.a,{path:`${hv}/:tabName(${Uc.UsersTableType.anomalies})`},s.a.createElement(Gd,bo()({},d,{AnomaliesTableComponent:_p}))),s.a.createElement(K.a,{path:`${hv}/:tabName(${Uc.UsersTableType.events})`},s.a.createElement(yb,bo()({additionalFilters:u,tableId:W.e.usersPageEvents},d))),s.a.createElement(K.a,{path:`${hv}/:tabName(${Uc.UsersTableType.risk})`},s.a.createElement(yv,bo()({},d,{riskEntity:rt.v.user,entityName:d.userName}))))}));xv.displayName="UsersDetailsTabs";const jv=(e,t)=>`${l.Lc}/name/${e}/${t}`,Sv=(e,t,a)=>{const n=[],i={[Uc.UsersTableType.authentications]:{id:Uc.UsersTableType.authentications,name:ym.c,href:jv(e,Uc.UsersTableType.authentications),disabled:!1},[Uc.UsersTableType.anomalies]:{id:Uc.UsersTableType.anomalies,name:ym.b,href:jv(e,Uc.UsersTableType.anomalies),disabled:!1},[Uc.UsersTableType.events]:{id:Uc.UsersTableType.events,name:ym.d,href:jv(e,Uc.UsersTableType.events),disabled:!1},[Uc.UsersTableType.risk]:{id:Uc.UsersTableType.risk,name:ym.e,href:jv(e,Uc.UsersTableType.risk),disabled:!1}};return t||n.push(Uc.UsersTableType.anomalies),a||n.push(Uc.UsersTableType.risk),Object(A.omit)(n,i)};var Ov=a(134),kv=a(565),wv=a(1095),Tv=a(693),Iv=a(433);const Cv="UsersDetailsQueryId",Mv=({detailName:e,usersDetailsPagePath:t})=>{const a=Object(c.useDispatch)(),n=Object(Am.a)("entity-analytics"),i=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),o=Object(F.b)((e=>{var t;return(null!==(t=i(e,W.e.hostsPageEvents))&&void 0!==t?t:Ov.b).graphEventId})),l=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),u=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),d=Object(F.a)(u),p=Object(F.a)(l),{signalIndexName:m}=Object(oy.a)(),{hasKibanaREAD:f,hasIndexRead:b}=Object(Jl.a)(),g=f&&b,{to:y,from:v,deleteQuery:x,setQuery:j,isInitializing:O}=Object(xe.a)(),{globalFullScreen:k}=Object(Vt.a)(),{services:{uiSettings:w}}=Object(h.i)(),T=Object(r.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"user.name",value:t=e,params:{query:t}},query:{match:{"user.name":{query:t,type:"phrase"}}}}];var t}),[e]),{indicesExist:I,indexPattern:C,selectedPatterns:M,sourcererDataView:D}=Object(E.d)(),[N,R]=Object(r.useMemo)((()=>{try{return[Object(za.buildEsQuery)(C,[d],[...T,...p],Object(Ro.getEsQueryConfig)(w))]}catch(e){return[void 0,e]}}),[p,C,d,w,T]),L=JSON.stringify(N);Object(Bo.a)({id:Cv,filterQuery:L,kqlError:R,query:d,startDate:v,endDate:y}),Object(r.useEffect)((()=>{a(Object(ky.setUsersDetailsTablesActivePageToZero)())}),[a,e]);const[B,{inspect:z,userDetails:q,refetch:$}]=Object(Tv.b)({id:Cv,endDate:y,startDate:v,userName:e,indexNames:M,skip:0===M.length}),V=Object(ju.a)();Object($a.b)({setQuery:j,deleteQuery:x,refetch:$,inspect:z,loading:B,queryId:Cv});const U=Object(r.useCallback)(((e,t)=>{const n=Object(Iv.a)(e,t);a(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:n.from,to:n.to}))}),[a]),H=Object(r.useMemo)((()=>({field:"user.name",value:e})),[e]);return s.a.createElement(s.a.Fragment,null,I?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:k,graphEventId:o})},s.a.createElement(ht,{sourcererDataView:D,id:Ee.a.global})),s.a.createElement(S.a,{noPadding:k},s.a.createElement(oo,{subtitle:s.a.createElement(Xc,{indexKey:rt.j.userDetails,indexNames:M,userName:e}),title:e}),s.a.createElement(kv.a,{criteriaFields:Object(gp.a)(Uc.UsersType.details,e),startDate:v,endDate:y,skip:O},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>s.a.createElement(wv.a,{userName:e,id:Cv,isInDetailsSidePanel:!1,data:q,anomaliesData:a,isLoadingAnomaliesData:t,loading:B,startDate:v,endDate:y,narrowDateRange:U,indexPatterns:M,jobNameById:n}))),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiSpacer,null),g&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(sy,{signalIndexName:m,entityFilter:H,additionalFilters:N?[N]:[]})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Sy,{entityFilter:H,signalIndexName:m,additionalFilters:N?[N]:[]}))),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(Wc,{navTabs:Sv(e,Object(Zd.a)(V),n)}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(xv,{deleteQuery:x,detailName:e,filterQuery:L,from:v,indexNames:M,indexPattern:C,isInitializing:O,userDetailFilter:T,setQuery:j,to:y,type:Uc.UsersType.details,usersDetailsPagePath:t}))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.users}))};Mv.displayName="UsersDetailsComponent";const _v=s.a.memo(Mv),Av=s.a.memo((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:vv},s.a.createElement(Tg,null)),s.a.createElement(K.a,{path:`${l.Lc}/externalAlerts`,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Lc}/${Uc.UsersTableType.events}`,search:`${e}&onlyExternalAlerts=true`}})}),s.a.createElement(K.a,{path:Ev,render:({match:{params:{detailName:e}}})=>s.a.createElement(_v,{usersDetailsPagePath:hv,detailName:decodeURIComponent(e)})}),s.a.createElement(K.a,{path:hv,render:({match:{params:{detailName:e}},location:{search:t=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Lc}/name/${e}/${Uc.UsersTableType.authentications}`,search:t}})}),s.a.createElement(K.a,{path:`${l.Lc}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=Uc.UsersTableType.authentications}},location:{search:a=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Lc}/name/${e}/${t}`,search:a}})}),s.a.createElement(K.a,{path:l.Lc,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Lc}/${Uc.UsersTableType.allUsers}`,search:e}})}))));Av.displayName="UsersContainer";var Fv=a(874),Pv=a(1133);const Dv=(e,t)=>"host.name"===e.entityName&&(null==t||e.entityValue===t),Nv=(e,t)=>e===We.HostsType.details&&null!=t?[{fieldName:"host.name",fieldValue:t}]:[],Rv={sort:{field:"anomaly.severity",direction:"desc"}},Lv=({startDate:e,endDate:t,hostName:a,skip:o,type:l})=>{const u=Object(c.useDispatch)(),d=Object(ju.a)(),{toggleStatus:p,setToggleStatus:m}=Object(Er.a)("AnomaliesHostTable"),[f,b]=Object(r.useState)(o||!p);Object(r.useEffect)((()=>{b(o||!p)}),[o,p]);const g=Object(r.useCallback)((e=>{m(e),b(!e)}),[b,m]),{jobNameById:y,loading:h}=Object(Nd.a)(),v=Object(r.useMemo)((()=>Object.keys(y)),[y]),E=Object(r.useMemo)((()=>i.hostsAnomaliesJobIdFilterSelector()),[]),x=Object(F.a)((e=>E(e,l))),j=Object(r.useCallback)((e=>{u(n.updateHostsAnomaliesJobIdFilter({jobIds:e,hostsType:l}))}),[u,l]),S=Object(r.useMemo)((()=>i.hostsAnomaliesIntervalSelector()),[]),O=Object(F.a)((e=>S(e,l))),k=Object(r.useCallback)((e=>{u(n.updateHostsAnomaliesInterval({interval:e,hostsType:l}))}),[u,l]),[w,T]=Object(Wd.a)({startDate:e,endDate:t,skip:f,criteriaFields:Nv(l,a),filterQuery:{exists:{field:"host.name"}},jobIds:x.length>0?x:v,aggregationInterval:O}),I=((e,t,a)=>null==e?[]:e.anomalies.reduce(((e,n)=>{var i;if(Dv(n,a))return[...e,{hostName:n.entityValue,jobName:null!==(i=t[n.jobId])&&void 0!==i?i:n.jobId,anomaly:n}];{const i=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(yp.a)(e);return"host.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(n.influencers,a);var r;return null!=i?[...e,{hostName:i,jobName:null!==(r=t[n.jobId])&&void 0!==r?r:n.jobId,anomaly:n}]:e}}),[]))(T,y,a),C=((e,t,a)=>{const n=((e,t)=>[{name:tp,field:"hostName",sortable:!0,render:(e,t)=>Object(pu.b)({values:[e],fieldName:"host.name",idPrefix:`anomalies-host-table-hostName-${vp(t.anomaly)}-hostName`,render:e=>s.a.createElement($t.d,{hostName:e})})},...Op(e,t)])(t,a);return e===We.HostsType.details?n.filter((e=>e.name!==tp)):n})(l,e,t),M={initialPageIndex:0,initialPageSize:10,totalItemCount:I.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(Zd.a)(d)?s.a.createElement(su.a,{loading:w||h},s.a.createElement(Li.a,{subtitle:`${Kd}: ${M.totalItemCount.toLocaleString()} ${Yd(M.totalItemCount)}`,title:Jd,toggleQuery:g,toggleStatus:p,tooltip:Xd,isInspectDisabled:o,headerFilters:s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Ip,{interval:O,onChange:k})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(kp,{title:lp,onSelect:j,selectedJobIds:x,jobIds:v,jobNameById:y})))}),p&&s.a.createElement(bp.a,{"data-test-subj":"host-anomalies-table",columns:C,items:I,pagination:M,sorting:Rv}),(w||h)&&s.a.createElement(eu.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},Bv=s.a.memo(Lv),zv="authenticationsHostsTableQuery",qv=We.HostsTableType.authentications,$v=({endDate:e,filterQuery:t,indexNames:a,skip:o,startDate:l,type:u,setQuery:d,deleteQuery:p})=>{const m=Object(c.useDispatch)(),{toggleStatus:f}=Object(Er.a)(zv),[b,g]=Object(r.useState)(o||!f);Object(r.useEffect)((()=>{g(o||!f)}),[o,f]);const y=i.authenticationsSelector(),{activePage:h,limit:v}=Object(F.a)((e=>y(e,u))),[E,{authentications:x,totalCount:j,pageInfo:S,loadPage:O,inspect:k,isInspected:w,refetch:T}]=Id({endDate:e,filterQuery:t,indexNames:a,skip:b,startDate:l,stackByField:rt.a.userName,activePage:h,limit:v}),I=u===We.HostsType.details?[yd,vd,ud,dd,pd,fd,bd]:ld(),C=Object(r.useCallback)((e=>m(n.updateTableLimit({hostsType:u,limit:e,tableType:qv}))),[u,m]),M=Object(r.useCallback)((e=>m(n.updateTableActivePage({activePage:e,hostsType:u,tableType:qv}))),[u,m]);return Object($a.b)({queryId:zv,loading:E,refetch:T,setQuery:d,deleteQuery:p,inspect:k}),s.a.createElement(lu,{activePage:h,columns:I,dataTestSubj:"authentications-host-table",headerCount:j,headerTitle:Vu,headerUnit:Uu(j),id:zv,isInspect:w,itemsPerRow:cd,limit:v,loading:E,loadPage:O,pageOfItems:x,setQuerySkip:g,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",S),totalCount:Object(A.getOr)(50,"fakeTotalCount",S),updateLimitPagination:C,updateActivePage:M})};$v.displayName="AuthenticationsHostTableComponent";const Vv=s.a.memo($v),Uv=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:i,setQuery:r,startDate:o,type:l})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(Ad.a,bo()({endDate:t,filterQuery:a,id:"authenticationsHistogramQuery",indexNames:n,setQuery:r,startDate:o},Od)),s.a.createElement(Vv,{endDate:t,filterQuery:a,indexNames:n,setQuery:r,deleteQuery:e,startDate:o,type:l,skip:i}));Uv.displayName="AuthenticationsQueryTabBodyComponent";const Hv=s.a.memo(Uv);Hv.displayName="AuthenticationsQueryTabBody";const Qv=Y.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),Gv="hostsAllQuery",Wv=Y.i18n.translate("xpack.securitySolution.hostsTable.hostsTitle",{defaultMessage:"All hosts"}),Zv=e=>Y.i18n.translate("xpack.securitySolution.hostsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Kv=(Y.i18n.translate("xpack.securitySolution.hostsRiskTable.tableTitle",{defaultMessage:"Host risk"}),Y.i18n.translate("xpack.securitySolution.hostsTable.nameTitle",{defaultMessage:"Host name"})),Jv=Y.i18n.translate("xpack.securitySolution.hostsTable.lastSeenTitle",{defaultMessage:"Last seen"}),Yv=Y.i18n.translate("xpack.securitySolution.hostsTable.firstLastSeenToolTip",{defaultMessage:"Relative to the selected date range"}),Xv=Y.i18n.translate("xpack.securitySolution.hostsTable.osLastSeenToolTip",{defaultMessage:"Last observed operating system"}),eE=Y.i18n.translate("xpack.securitySolution.hostsTable.osTitle",{defaultMessage:"Operating system"}),tE=Y.i18n.translate("xpack.securitySolution.hostsTable.versionTitle",{defaultMessage:"Version"}),aE=Y.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),nE=Y.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),iE=Y.i18n.translate("xpack.securitySolution.hostsRiskTable.hostNameTitle",{defaultMessage:"Host Name"}),rE=Y.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),sE=(Y.i18n.translate("xpack.securitySolution.hostsRiskTable.riskTitle",{defaultMessage:"Host risk level"}),Y.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskTitle",{defaultMessage:"Host risk"})),oE=e=>Y.i18n.translate("xpack.securitySolution.hostsRiskTable.filteredHostsTitle",{values:{severity:e},defaultMessage:"View {severity} risk hosts"}),lE=Y.i18n.translate("xpack.securitySolution.hostsRiskTable.lastUpdatedTitle",{defaultMessage:"Last updated"});var cE=a(352);const uE=We.HostsTableType.hosts,dE=[{text:aE,numberOfRow:5},{text:nE,numberOfRow:10}],pE=({data:e,fakeTotalCount:t,id:a,isInspect:o,loading:u,loadPage:d,setQuerySkip:p,showMorePagesIndicator:m,totalCount:f,type:b})=>{const g=Object(c.useDispatch)(),{navigateTo:y}=Object(cE.g)(),h=Object(r.useMemo)((()=>i.hostsSelector()),[]),{activePage:v,direction:E,limit:x,sortField:j}=Object(F.a)((e=>h(e,b))),S=Object(r.useCallback)((e=>g(n.updateTableLimit({hostsType:b,limit:e,tableType:uE}))),[b,g]),O=Object(r.useCallback)((e=>g(n.updateTableActivePage({activePage:e,hostsType:b,tableType:uE}))),[b,g]),k=Object(r.useCallback)((e=>{if(null!=e.sort){const t={field:mE(e.sort.field),direction:e.sort.direction};t.direction===E&&t.field===j||g(n.updateHostsSort({sort:t,hostsType:b}))}}),[E,j,b,g]),w=Object(Am.a)("entity-analytics"),T=Object(ju.a)().isPlatinumOrTrialLicense,I=Object(r.useCallback)((e=>{g(n.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:b})),y({deepLinkId:l.yc.hosts,path:We.HostsTableType.risk})}),[g,y,b]),C=Object(r.useMemo)((()=>((e,t)=>{const a=[{field:"node.host.name",name:Kv,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e&&e.length>0?s.a.createElement(sr.c,{mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e[0],field:"host.name"}},s.a.createElement($t.d,{hostName:e[0]})):Object(Jc.d)(),width:"35%"},{field:"node.lastSeen",name:s.a.createElement(ee.EuiToolTip,{content:Yv},s.a.createElement(s.a.Fragment,null,Jv," ",s.a.createElement(ee.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e&&e.length>0?s.a.createElement(Yc.b,{value:Array.isArray(e)?e[0]:e}):Object(Jc.d)()},{field:"node.host.os.name",name:s.a.createElement(ee.EuiToolTip,{content:Xv},s.a.createElement(s.a.Fragment,null,eE," ",s.a.createElement(ee.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?s.a.createElement(sr.c,{mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e[0],field:"host.os.name"}},e):Object(Jc.d)()},{field:"node.host.os.version",name:tE,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?s.a.createElement(sr.c,{mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e[0],field:"host.os.version"}},e):Object(Jc.d)()}];return e&&a.push({field:"node.risk",name:Object(um.b)(rt.v.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?s.a.createElement(xu.a,{toolTipContent:s.a.createElement(ee.EuiLink,{onClick:()=>t(e)},s.a.createElement(ee.EuiText,{size:"xs"},oE(e.toLowerCase()))),severity:e}):Object(Jc.d)()}),a})(T&&w,I)),[I,T,w]),M=Object(r.useMemo)((()=>((e,t)=>({field:fE(e),direction:t}))(j,E)),[j,E]);return s.a.createElement(lu,{activePage:v,columns:C,dataTestSubj:`table-${uE}`,headerCount:f,headerTitle:Wv,headerUnit:Zv(f),id:a,isInspect:o,itemsPerRow:dE,limit:x,loading:u,loadPage:d,onChange:k,pageOfItems:e,setQuerySkip:p,showMorePagesIndicator:m,sorting:M,totalCount:t,updateLimitPagination:S,updateActivePage:O})};pE.displayName="HostsTableComponent";const mE=e=>"node.host.name"===e?it.a.hostName:it.a.lastSeen,fE=e=>{switch(e){case it.a.hostName:return"node.host.name";case it.a.lastSeen:return"node.lastSeen";default:return""}},bE=s.a.memo(pE);bE.displayName="HostsTable";const gE=Object($a.a)(bE),yE=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:o,setQuery:l,startDate:c,type:u})=>{const{toggleStatus:d}=Object(Er.a)(Gv),[p,m]=Object(r.useState)(o||!d);Object(r.useEffect)((()=>{m(o||!d)}),[o,d]);const[f,{hosts:b,totalCount:g,pageInfo:y,loadPage:h,id:v,inspect:E,isInspected:x,refetch:j}]=(({endDate:e,filterQuery:t,indexNames:a,skip:n=!1,startDate:s,type:o})=>{const l=Object(r.useMemo)((()=>i.hostsSelector()),[]),{activePage:c,direction:u,limit:d,sortField:p}=Object(F.a)((e=>l(e,o))),m=Object(Lu.b)(),[f,b]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Ru(e,d)}:t))}),[d]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(Pu.a)({factoryQueryType:rt.i.hosts,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Qv,abort:n}),j=Object(r.useMemo)((()=>({endDate:e,hosts:h.edges,id:Gv,inspect:x,isInspected:!1,loadPage:g,pageInfo:h.pageInfo,refetch:E,startDate:s,totalCount:h.totalCount})),[e,x,E,h.edges,h.pageInfo,h.totalCount,s,g]);return Object(r.useEffect)((()=>{b((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.i.hosts,filterQuery:Object(wd.a)(t),pagination:Ru(c,d),timerange:{interval:"12h",from:s,to:e},sort:{direction:u,field:p},isNewRiskScoreModuleInstalled:m};return T()(n,i)?n:i}))}),[c,u,e,t,a,d,s,p,m]),Object(r.useEffect)((()=>{!n&&f&&v(f)}),[f,v,n]),[y,j]})({endDate:t,filterQuery:a,indexNames:n,skip:p,startDate:c,type:u});return s.a.createElement(gE,{deleteQuery:e,data:b,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",y),id:v,inspect:E,isInspect:x,loading:f,loadPage:h,refetch:j,setQuery:l,setQuerySkip:m,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",y),totalCount:g,type:u})};yE.displayName="HostsQueryTabBody";const hE=Y.i18n.translate("xpack.securitySolution.uncommonProcesses.failSearchDescription",{defaultMessage:"Failed to run search on uncommon processes"}),vE="hostsUncommonProcessesQuery",EE=Y.i18n.translate("xpack.securitySolution.authenticationsTable.uncommonProcessTable",{defaultMessage:"Uncommon processes"}),xE=e=>Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {process} other {processes}}"}),jE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.hostsTitle",{defaultMessage:"Host names"}),SE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfHostsTitle",{defaultMessage:"Hosts"}),OE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfInstances",{defaultMessage:"Instances"}),kE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastCommandTitle",{defaultMessage:"Last command"}),wE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastUserTitle",{defaultMessage:"Last user"}),TE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.nameTitle",{defaultMessage:"Process name"}),IE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),CE=Y.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ME=We.HostsTableType.uncommonProcesses,_E=[{text:IE,numberOfRow:5},{text:CE,numberOfRow:10}],AE=s.a.memo((({data:e,fakeTotalCount:t,id:a,isInspect:o,loading:l,loadPage:u,totalCount:d,setQuerySkip:p,showMorePagesIndicator:m,type:f})=>{const b=Object(c.useDispatch)(),g=Object(r.useMemo)((()=>i.uncommonProcessesSelector()),[]),{activePage:y,limit:h}=Object(F.a)((e=>g(e,f))),v=Object(r.useCallback)((e=>b(n.updateTableLimit({hostsType:f,limit:e,tableType:ME}))),[f,b]),E=Object(r.useCallback)((e=>b(n.updateTableActivePage({activePage:e,hostsType:f,tableType:ME}))),[f,b]),x=Object(r.useMemo)((()=>PE(f)),[f]);return s.a.createElement(lu,{activePage:y,columns:x,dataTestSubj:`table-${ME}`,headerCount:d,headerTitle:EE,headerUnit:xE(d),id:a,isInspect:o,itemsPerRow:_E,limit:h,loading:l,loadPage:u,pageOfItems:e,setQuerySkip:p,showMorePagesIndicator:m,totalCount:t,updateLimitPagination:v,updateActivePage:E})}));AE.displayName="UncommonProcessTableComponent";const FE=s.a.memo(AE);FE.displayName="UncommonProcessTable";const PE=e=>{const t=[{name:TE,truncateText:!1,mobileOptions:{show:!0},width:"20%",render:({node:e})=>Object(pu.b)({values:e.process.name,fieldName:"process.name",idPrefix:`uncommon-process-table-${e._id}-processName`})},{align:"right",name:SE,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>s.a.createElement(s.a.Fragment,null,null!=e.hosts?e.hosts.length:Object(Jc.e)()),width:"8%"},{align:"right",name:OE,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Jc.a)(e.instances),width:"8%"},{name:jE,truncateText:!1,mobileOptions:{show:!0},width:"25%",render:({node:e})=>{return Object(pu.b)({values:(t=e.hosts,null!=t?t.filter((e=>null!=e.name&&null!=e.name[0])).map((e=>null!=e.name&&null!=e.name[0]?e.name[0]:"")):[]),fieldName:"host.name",idPrefix:`uncommon-process-table-${e._id}-processHost`,render:e=>s.a.createElement($t.d,{hostName:e})});var t}},{name:kE,truncateText:!1,mobileOptions:{show:!0},width:"25%",render:({node:e})=>Object(pu.b)({values:null!=e.process?e.process.args:null,fieldName:"process.args",idPrefix:`uncommon-process-table-${e._id}-processArgs`,render:e=>s.a.createElement($t.d,{hostName:e}),displayCount:1})},{name:wE,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(pu.b)({values:null!=e.user?e.user.name:null,fieldName:"user.name",idPrefix:`uncommon-process-table-${e._id}-processUser`})}];return e===We.HostsType.details?[jE,SE].reduce(((e,t)=>(e.splice(e.findIndex((e=>e.name===t)),1),e)),t):t},DE=Object($a.a)(FE),NE=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:o,setQuery:l,startDate:c,type:u})=>{const{toggleStatus:d}=Object(Er.a)(vE),[p,m]=Object(r.useState)(o||!d);Object(r.useEffect)((()=>{m(o||!d)}),[o,d]);const[f,{uncommonProcesses:b,totalCount:g,pageInfo:y,loadPage:h,id:v,inspect:E,isInspected:x,refetch:j}]=(({endDate:e,filterQuery:t,indexNames:a,skip:n=!1,startDate:s,type:o})=>{const l=Object(r.useMemo)((()=>i.uncommonProcessesSelector()),[]),{activePage:c,limit:u}=Object(F.a)((e=>l(e,o))),[d,p]=Object(r.useState)(null),m=Object(r.useCallback)((e=>{p((t=>t?{...t,pagination:Ru(e,u)}:t))}),[u]),{loading:f,result:b,search:g,refetch:y,inspect:h}=Object(Pu.a)({factoryQueryType:rt.i.uncommonProcesses,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:hE,abort:n}),v=Object(r.useMemo)((()=>({id:vE,inspect:h,isInspected:!1,loadPage:m,pageInfo:b.pageInfo,refetch:y,totalCount:b.totalCount,uncommonProcesses:b.edges})),[h,y,b.edges,b.pageInfo,b.totalCount,m]);return Object(r.useEffect)((()=>{p((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.i.uncommonProcesses,filterQuery:Object(wd.a)(t),pagination:Ru(c,u),timerange:{interval:"12h",from:s,to:e},sort:{}};return T()(n,i)?n:i}))}),[c,a,e,t,u,s]),Object(r.useEffect)((()=>{!n&&d&&g(d)}),[g,n,d]),[f,v]})({endDate:t,filterQuery:a,indexNames:n,skip:p,startDate:c,type:u});return s.a.createElement(DE,{deleteQuery:e,data:b,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",y),id:v,inspect:E,isInspect:x,loading:f,loadPage:h,refetch:j,setQuery:l,setQuerySkip:m,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",y),totalCount:g,type:u})};NE.dispalyName="UncommonProcessQueryTabBody";const RE=[{text:aE,numberOfRow:5},{text:nE,numberOfRow:10}],LE=We.HostsTableType.risk,BE=({data:e,id:t,isInspect:a,loading:o,loadPage:l,setQuerySkip:u,severityCount:d,totalCount:p,type:m})=>{const f=Object(c.useDispatch)(),b=Object(r.useMemo)((()=>i.hostRiskScoreSelector()),[]),{activePage:g,limit:y,sort:h}=Object(F.a)((e=>b(e,We.HostsType.page))),v=Object(r.useCallback)((e=>f(n.updateTableLimit({hostsType:m,limit:e,tableType:LE}))),[m,f]),E=Object(r.useCallback)((e=>f(n.updateTableActivePage({activePage:e,hostsType:m,tableType:LE}))),[m,f]),x=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===h.direction&&t.field===h.field||f(n.updateHostRiskScoreSort({sort:t,hostsType:m}))}}),[f,h,m]),j=Object(r.useCallback)((e=>{f(n.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:m}))}),[f,m]),S=Object(r.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"host.name",name:iE,truncateText:!1,mobileOptions:{show:!0},sortable:!0,width:"35%",render:e=>null!=e&&e.length>0?s.a.createElement(sr.c,{mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e,field:"host.name"},metadata:{telemetry:tm}},s.a.createElement($t.d,{hostName:e,hostTab:We.HostsTableType.risk})):Object(Jc.d)()},{field:rt.w.timestamp,name:lE,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?s.a.createElement(Yc.b,{value:e}):Object(Jc.d)()},{field:rt.w.hostRiskScore,name:rE,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?s.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Jc.d)()},{field:rt.w.hostRisk,name:Object(um.b)(rt.v.host),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?s.a.createElement(xu.a,{toolTipContent:s.a.createElement(ee.EuiLink,{onClick:()=>e(t)},s.a.createElement(ee.EuiText,{size:"xs"},oE(t.toLowerCase()))),severity:t}):Object(Jc.d)()}])({dispatchSeverityUpdate:j})),[j]),O=s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(vm,{severityCount:d})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(jm,{severityCount:d}))),k=Object(r.useMemo)((()=>i.hostRiskScoreSeverityFilterSelector()),[]),w=Object(F.a)((e=>k(e,m))),T=Object(r.useCallback)((e=>{f(n.updateHostRiskScoreSeverityFilter({severitySelection:e,hostsType:m}))}),[f,m]);return s.a.createElement(lu,{activePage:g,columns:S,dataTestSubj:`table-${LE}`,headerCount:p,headerFilters:s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zm,{riskEntity:rt.v.host})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Sm,{selectedSeverities:w,severityCount:d,onSelect:T,riskEntity:rt.v.host}))),headerSupplement:O,headerTitle:sE,headerUnit:Zv(p),id:t,isInspect:a,itemsPerRow:RE,limit:y,loading:o,loadPage:l,onChange:x,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:!1,sorting:h,split:!0,stackHeader:!0,totalCount:p,updateLimitPagination:v,updateActivePage:E})};BE.displayName="HostRiskScoreTableComponent";const zE=s.a.memo(BE);zE.displayName="HostRiskScoreTable";const qE=Object($a.a)(zE),$E=({deleteQuery:e,endDate:t,filterQuery:a,setQuery:n,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>i.hostRiskScoreSelector()),[]),{activePage:d,limit:p,sort:m}=Object(F.a)((e=>u(e,We.HostsType.page))),f=Object(r.useMemo)((()=>i.hostRiskScoreSeverityFilterSelector()),[]),b=Object(F.a)((e=>f(e,We.HostsType.page))),{data:g}=Object(Lu.c)(),y=Object(r.useMemo)((()=>({cursorStart:d*p,querySize:p})),[d,p]),{toggleStatus:h}=Object(Er.a)(Gm.a.HOSTS_BY_RISK),[v,E]=Object(r.useState)(o||!h);Object(r.useEffect)((()=>{E(!h)}),[h]);const x=Object(r.useMemo)((()=>({from:l,to:t})),[l,t]),{data:j,inspect:S,isDeprecated:O,isInspected:k,isModuleEnabled:w,loading:T,refetch:I,totalCount:C}=Object(Gm.c)({filterQuery:a,pagination:y,riskEntity:rt.v.host,skip:v,sort:m,timerange:x}),{severityCount:M,loading:_}=Object(Gm.d)({filterQuery:a,skip:v,riskEntity:rt.v.host}),P={isDisabled:!w&&!T,isDeprecated:O&&!T};return P.isDisabled||P.isDeprecated?s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(gm,bo()({},P,{entityType:rt.v.host,refetch:I,timerange:x}))):!T&&w&&0===b.length&&j&&0===j.length?s.a.createElement(Jm,{entityType:rt.v.host,refetch:I}):s.a.createElement(s.a.Fragment,null,(null==g?void 0:g.isUpdateAvailable)&&s.a.createElement(Df,null),s.a.createElement(qE,{deleteQuery:e,data:null!=j?j:[],id:Gm.a.HOSTS_BY_RISK,inspect:S,isInspect:k,loading:T||_,loadPage:A.noop,refetch:I,setQuery:n,setQuerySkip:E,severityCount:null!=M?M:rt.c,totalCount:C,type:c}))};$E.displayName="HostRiskScoreQueryTabBody";var VE=a(104);const UE=Y.i18n.translate("xpack.securitySolution.sessionsView.sessionsTitle",{defaultMessage:"Sessions"}),HE=Y.i18n.translate("xpack.securitySolution.sessionsView.totalCountOfSessions",{defaultMessage:"sessions"}),QE=Y.i18n.translate("xpack.securitySolution.sessionsView.singleCountOfSessions",{defaultMessage:"session"}),GE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnSessionStart",{defaultMessage:"Started"}),WE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnExecutable",{defaultMessage:"Executable"}),ZE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnEntryUserID",{defaultMessage:"User ID"}),KE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnInteractive",{defaultMessage:"Interactive"}),JE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnHostName",{defaultMessage:"Hostname"}),YE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnEntryType",{defaultMessage:"Type"}),XE=Y.i18n.translate("xpack.securitySolution.sessionsView.columnEntrySourceIp",{defaultMessage:"Source IP"}),ex=[{columnHeaderType:Go.a,id:"process.entry_leader.start",initialWidth:Qo.b,display:GE},{columnHeaderType:Go.a,id:"process.entry_leader.executable",display:WE},{columnHeaderType:Go.a,id:"process.entry_leader.user.id",display:ZE},{columnHeaderType:Go.a,id:"process.entry_leader.interactive",display:KE},{columnHeaderType:Go.a,id:"host.hostname",display:JE},{columnHeaderType:Go.a,id:"process.entry_leader.entry_meta.type",display:YE},{id:"process.entry_leader.entry_meta.source.ip",columnHeaderType:Go.a,display:XE}],tx=(e,t)=>({...W.q,columns:e,defaultColumns:t,sort:[{columnId:"process.entry_leader.start",columnType:"date",sortDirection:"desc"}]}),ax={query:{bool:{filter:[{bool:{should:[{term:{[Ca.ub]:"exec"}},{term:{[Ca.ub]:"fork"}},{term:{[Ca.ub]:"end"}}]}},{bool:{filter:{exists:{field:VE.ENTRY_SESSION_ENTITY_ID_PROPERTY}}}}]}},meta:{alias:null,disabled:!1,key:VE.ENTRY_SESSION_ENTITY_ID_PROPERTY,negate:!1,params:{},type:"string"}},nx=({tableId:e,endDate:t,entityType:a="sessions",pageFilters:n,startDate:i,filterQuery:o,columns:l=ex,defaultColumns:u=ex})=>{const d=Object(c.useDispatch)(),p=Object(ve.a)("tGridEnabled"),m=Object(r.useMemo)((()=>o&&""!==o?JSON.parse(o):{}),[o]),f=Object(r.useMemo)((()=>[{...ax,query:{...ax.query,bool:{...ax.query.bool,filter:ax.query.bool.filter.concat(m)}}},...n]),[n,m]);Object(r.useEffect)((()=>{d(W.h.initializeDataTableSettings({id:e,title:UE,defaultColumns:Zo.columns.map((e=>p||null!=e.initialWidth?e:{...e,initialWidth:Qo.a})),showCheckboxes:!0,selectAll:!0}))}),[d,p,e]);const b=Object(be.b)().isEnterprise()||e===W.e.kubernetesPageSessions?5:4,g=Object(r.useMemo)((()=>Object(lb.a)(b)),[b]),y=Object(pb.a)({localFilters:f,tableId:e,from:i,to:t,scopeId:x.SourcererScopeName.default}),h=Object(r.useMemo)((()=>({alertStatusActions:!1,customBulkActions:[y]})),[y]);return s.a.createElement("div",{"data-test-subj":"security_solution:sessions_viewer:sessions_view"},s.a.createElement(rb,{cellActionsTriggerId:sr.d.DEFAULT,pageFilters:f,defaultModel:tx(l,u),end:t,bulkActions:h,entityType:a,tableId:e,leadingControlColumns:g,renderCellValue:ub.a,rowRenderers:cb.b,sourcererScope:x.SourcererScopeName.default,start:i,unit:e=>e>1?HE:QE}))};nx.displayName="SessionsViewComponent";const ix=s.a.memo(nx),rx=s.a.memo((e=>{const{pageFilters:t,filterQuery:a,...n}=e,i=Object(r.useMemo)((()=>{const e=Object(Fb.b)(P.a.hosts);return null!=t?[...e,...t]:e}),[t]);return Object(be.b)().isEnterprise()?s.a.createElement(ix,bo()({entityType:"sessions",tableId:W.e.hostsPageSessions},n,{pageFilters:i,filterQuery:a})):null}));rx.displayName="SessionsTabBody";const sx=s.a.memo((({detailName:e,filterQuery:t,indexNames:a,indexPattern:n,hostDetailsPagePath:i,hostDetailsFilter:r})=>{const{from:o,to:l,isInitializing:c,deleteQuery:u,setQuery:d}=Object(xe.a)(),p={deleteQuery:u,endDate:l,filterQuery:t,skip:c||void 0===t,setQuery:d,startDate:o,type:We.HostsType.details,indexPattern:n,indexNames:a,hostName:e};return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.authentications})`},s.a.createElement(Hv,p)),s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.uncommonProcesses})`},s.a.createElement(NE,p)),s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.anomalies})`},s.a.createElement(Gd,bo()({},p,{AnomaliesTableComponent:Bv}))),s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.events})`},s.a.createElement(yb,bo()({additionalFilters:r,tableId:W.e.hostsPageEvents},p))),s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.risk})`},s.a.createElement(yv,bo()({},p,{riskEntity:rt.v.host,entityName:p.hostName}))),s.a.createElement(K.a,{path:`${i}/:tabName(${We.HostsTableType.sessions})`},s.a.createElement(rx,p)))}));sx.displayName="HostDetailsTabs";var ox=a(1261);const lx=(e,t)=>`${l.Ab}/name/${e}/${t}`,cx=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,hostName:a,isEnterprise:n})=>{const i=[],r={[We.HostsTableType.authentications]:{id:We.HostsTableType.authentications,name:ox.c,href:lx(a,We.HostsTableType.authentications),disabled:!1},[We.HostsTableType.uncommonProcesses]:{id:We.HostsTableType.uncommonProcesses,name:ox.g,href:lx(a,We.HostsTableType.uncommonProcesses),disabled:!1},[We.HostsTableType.anomalies]:{id:We.HostsTableType.anomalies,name:ox.b,href:lx(a,We.HostsTableType.anomalies),disabled:!1},[We.HostsTableType.events]:{id:We.HostsTableType.events,name:ox.d,href:lx(a,We.HostsTableType.events),disabled:!1},[We.HostsTableType.risk]:{id:We.HostsTableType.risk,name:ox.e,href:lx(a,We.HostsTableType.risk),disabled:!1},[We.HostsTableType.sessions]:{id:We.HostsTableType.sessions,name:ox.f,href:lx(a,We.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||i.push(We.HostsTableType.anomalies),t||i.push(We.HostsTableType.risk),n||i.push(We.HostsTableType.sessions),Object(A.omit)(i,r)};var ux=a(896),dx=a(1552);const px=Object(r.memo)((({endpointId:e,onClick:t})=>{const{handleResponseActionsClick:a,isDisabled:n,tooltip:i}=Object(dx.a)({endpointId:e,onClick:t});if(!Object(Dt.a)().endpointPrivileges.canAccessResponseConsole)return null;const r="endpointResponseActions-action-button";return s.a.createElement(ee.EuiToolTip,{position:"top",content:i},s.a.createElement(ee.EuiButton,{fill:!0,key:r,"data-test-subj":r,disabled:n,onClick:a},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})))}));px.displayName="ResponderActionButton";const mx=Object($a.a)(Pv.a),fx=({detailName:e,hostDetailsPagePath:t})=>{var a,n,i,o;const l=Object(c.useDispatch)(),u=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),d=Object(F.b)((e=>{var t;return(null!==(t=u(e,W.e.hostsPageEvents))&&void 0!==t?t:W.q).graphEventId})),p=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),m=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),f=Object(F.a)(m),b=Object(F.a)(p),{to:g,from:y,deleteQuery:v,setQuery:x,isInitializing:j}=Object(xe.a)(),{globalFullScreen:O}=Object(Vt.a)(),{signalIndexName:k}=Object(oy.a)(),w=Object(ju.a)(),{services:{uiSettings:T}}=Object(h.i)(),I=Object(r.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),C=Object(be.b)().isEnterprise(),M=Object(r.useCallback)(((e,t)=>{const a=Object(Iv.a)(e,t);l(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:a.from,to:a.to}))}),[l]),{indexPattern:D,indicesExist:N,selectedPatterns:R,sourcererDataView:L}=Object(E.d)(),[B,{inspect:z,hostDetails:q,id:$,refetch:V}]=Object(ux.b)({endDate:g,startDate:y,hostName:e,indexNames:R,skip:0===R.length}),[U,H]=Object(r.useMemo)((()=>{try{return[Object(za.buildEsQuery)(D,[f],[...I,...b],Object(Ro.getEsQueryConfig)(T))]}catch(e){return[void 0,e]}}),[b,D,f,T,I]),Q=JSON.stringify(U);Object(Bo.a)({id:ux.a,filterQuery:Q,kqlError:H,query:f,startDate:y,endDate:g}),Object(r.useEffect)((()=>{l(qe())}),[l,e]);const G=Object(Am.a)("entity-analytics"),{hasKibanaREAD:Z,hasIndexRead:K}=Object(Jl.a)(),J=Z&&K,Y=Object(r.useMemo)((()=>({field:"host.name",value:e})),[e]);return s.a.createElement(s.a.Fragment,null,N?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:O,graphEventId:d})},s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:L})),s.a.createElement(S.a,{noPadding:O,"data-test-subj":"hostDetailsPage"},s.a.createElement(Ut,{show:!O},s.a.createElement(oo,{border:!0,subtitle:s.a.createElement(Xc,{indexKey:rt.j.hostDetails,hostName:e,indexNames:R}),title:e,rightSideItems:[(null===(a=q.endpoint)||void 0===a||null===(n=a.hostInfo)||void 0===n?void 0:n.metadata.elastic.agent.id)&&s.a.createElement(px,{endpointId:null===(i=q.endpoint)||void 0===i||null===(o=i.hostInfo)||void 0===o?void 0:o.metadata.elastic.agent.id})]}),s.a.createElement(kv.a,{criteriaFields:Object(Fv.a)(q),startDate:y,endDate:g,skip:j},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>s.a.createElement(mx,{id:$,isInDetailsSidePanel:!1,data:q,anomaliesData:a,isLoadingAnomaliesData:t,loading:B,startDate:y,endDate:g,narrowDateRange:M,setQuery:x,refetch:V,inspect:z,hostName:e,indexNames:R,jobNameById:n}))),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiSpacer,null),J&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(sy,{signalIndexName:k,entityFilter:Y,additionalFilters:U?[U]:[]})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Sy,{entityFilter:Y,signalIndexName:k,additionalFilters:U?[U]:[]}))),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(Wc,{navTabs:cx({hasMlUserPermissions:Object(Zd.a)(w),isRiskyHostsEnabled:G,hostName:e,isEnterprise:C})}),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(sx,{indexNames:R,isInitializing:j,deleteQuery:v,hostDetailsFilter:I,to:g,from:y,detailName:e,type:We.HostsType.details,setQuery:x,filterQuery:Q,hostDetailsPagePath:t,indexPattern:D}))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.hosts}))};fx.displayName="HostDetailsComponent";const bx=s.a.memo(fx);var gx=a(310);const yx=e=>{try{return Object(tc.decode)(e)}catch(e){return null}},hx=e=>Object(A.isObject)(e),vx=e=>Object(A.isString)(e),Ex=(e,t)=>t.reduce(((t,a,n)=>{const i=((e,t)=>1===e.length?`${e[0]}: "${t}"`:e.reduce(((e,a,n,i)=>0===n?`(${a}: "${t}"`:n===i.length-1?`${e} or ${a}: "${t}")`:`${e} or ${a}: "${t}"`),""))(e,a);return 0===n?i:`${t} or ${i}`}),""),xx=(e,t,a)=>{const n=yx(a);if(hx(n)){const a=n;if(hx(a)&&vx(a.query)){const i=Ex(e,t);return""!==a.query&&""!==i?a.query=`(${i}) and (${a.query})`:""===a.query&&""!==i&&(a.query=`(${i})`),Object(tc.encode)(n)}}else if(null==n){const a=Ex(e,t);return Object(tc.encode)({query:`(${a})`,language:"kuery"})}return a},jx=(e,t,a)=>`(${a.split(",").reduce(((e,a,n)=>0===n?`${t}: "${a}"`:`${e} or ${t}: "${a}"`),"")})`,Sx=e=>{const t=yx(e);if(hx(t)){const e=t;if(hx(e)&&vx(e.query))return e.query=e.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,jx),Object(tc.encode)(t)}return e},Ox=["and","or","not"],kx=(e,...t)=>{if(null==t)return"";const a=t.reduce(((e,t)=>null!=t&&Ox.includes(t)?[...e,t]:e),[]);return a.length>1?` ${a[a.length-1].trim()} `:""},wx=e=>{const t=yx(e);if(hx(t)){const e=t;if(hx(e)&&vx(e.query))return e.query=e.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,kx),Object(tc.encode)(t)}return e},Tx=e=>Object(A.flow)(Sx,wx)(e),Ix=e=>""===e.trim()||e.startsWith("$")&&e.endsWith("$"),Cx=e=>e.split(",").length>1,Mx=e=>e.split(","),_x=s.a.memo((()=>{const{path:e}=Object(k.useRouteMatch)();return s.a.createElement(K.c,null,s.a.createElement(K.a,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(gx.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Tx(t.query));const a=Object(gx.stringify)(vl.url.encodeQuery(t),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ab}?${a}`})}}),s.a.createElement(K.a,{path:`${e}/:hostName`,render:({location:e,match:{params:{hostName:t}}})=>{const a=Object(gx.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Tx(a.query)),Ix(t)){const e=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ab}/${We.HostsTableType.anomalies}?${e}`})}if(Cx(t)){const e=Mx(t);a.query=xx(["host.name"],e,a.query||"");const n=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ab}/${We.HostsTableType.anomalies}?${n}`})}{const e=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ab}/name/${t}/${We.HostsTableType.anomalies}?${e}`})}}}),s.a.createElement(K.a,{path:`${l.Ab}/ml-hosts/`,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{from:`${l.Ab}/ml-hosts/`,to:`${l.Ab}/ml-hosts${e}`})}))}));_x.displayName="MlHostConditionalContainer";const Ax={description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(wr.q)("host.name"),operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!1,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Hosts - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]},Fx=Y.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),Px=Y.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"}),Dx="hostsKpiHostsQuery";let Nx;!function(e){e.uniqueSourceIps="#D36086",e.uniqueDestinationIps="#9170B8",e.hosts="#6092C0"}(Nx||(Nx={}));const Rx=Y.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"}),Lx=[{key:"hosts",fields:[{key:"hosts",value:null,color:Nx.hosts,icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"b00c65ea-32be-4163-bfc8-f795b1ef9d06",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[Host] Hosts - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:Rx,areaChartLensAttributes:Ax}],Bx=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Dx),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({hosts:0,hostsHistogram:[],id:Dx,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g,addWarning:y}=Object(Pt.a)(),v=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),y(Fx),c.current.unsubscribe()):(d(!1),b((t=>({...t,hosts:e.hosts,hostsHistogram:e.hostsHistogram,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:Px}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,y,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.h.kpiHosts,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Lx,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},zx=s.a.memo(Bx),qx={description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["a0cb6400-f708-46c3-ad96-24788f12dae4","d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"a0cb6400-f708-46c3-ad96-24788f12dae4":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:wr.n,operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}},"ca05ecdb-0fa4-49a8-9305-b23d91012a46":{columnOrder:["f95e74e6-99dd-4b11-8faf-439b4d959df9","e7052671-fb9e-481f-8df3-7724c98cfc6f"],columns:{"e7052671-fb9e-481f-8df3-7724c98cfc6f":{customLabel:!0,dataType:"number",isBucketed:!1,label:wr.i,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"f95e74e6-99dd-4b11-8faf-439b4d959df9":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"area",xAccessor:"a0cb6400-f708-46c3-ad96-24788f12dae4",yConfig:[{color:"#d36186",forAccessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"}]},{accessors:["e7052671-fb9e-481f-8df3-7724c98cfc6f"],layerId:"ca05ecdb-0fa4-49a8-9305-b23d91012a46",layerType:"data",seriesType:"area",xAccessor:"f95e74e6-99dd-4b11-8faf-439b4d959df9",yConfig:[{color:"#9170b8",forAccessor:"e7052671-fb9e-481f-8df3-7724c98cfc6f"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ca05ecdb-0fa4-49a8-9305-b23d91012a46",type:"index-pattern"}],type:"lens",updated_at:"2022-02-09T17:44:03.359Z",version:"WzI5MTI5OSwzXQ=="},$x={description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["f8bfa719-5c1c-4bf2-896e-c318d77fc08e","32f66676-f4e1-48fd-b7f8-d4de38318601"],columns:{"32f66676-f4e1-48fd-b7f8-d4de38318601":{dataType:"number",isBucketed:!1,label:Object(wr.q)("source.ip"),operationType:"unique_count",scale:"ratio",sourceField:"source.ip"},"f8bfa719-5c1c-4bf2-896e-c318d77fc08e":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:"source.ip: *"},label:wr.n}]},scale:"ordinal"}},incompleteColumns:{}},"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e":{columnOrder:["c72aad6a-fc9c-43dc-9194-e13ca3ee8aff","b7e59b08-96e6-40d1-84fd-e97b977d1c47"],columns:{"b7e59b08-96e6-40d1-84fd-e97b977d1c47":{dataType:"number",isBucketed:!1,label:Object(wr.q)("destination.ip"),operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff":{customLabel:!0,dataType:"string",isBucketed:!0,label:wr.i,operationType:"filters",params:{filters:[{input:{language:"kuery",query:"destination.ip: *"},label:"Dest."}]},scale:"ordinal"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["32f66676-f4e1-48fd-b7f8-d4de38318601"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"f8bfa719-5c1c-4bf2-896e-c318d77fc08e",yConfig:[{color:"#d36186",forAccessor:"32f66676-f4e1-48fd-b7f8-d4de38318601"}]},{accessors:["b7e59b08-96e6-40d1-84fd-e97b977d1c47"],layerId:"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff",yConfig:[{color:"#9170b8",forAccessor:"b7e59b08-96e6-40d1-84fd-e97b977d1c47"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - bar chart",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",type:"index-pattern"}]},Vx=Y.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),Ux=Y.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),Hx="hostsKpiUniqueIpsQuery",Qx=Y.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),Gx=Y.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),Wx=Y.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),Zx=Y.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),Kx=Y.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),Jx=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:Zx,description:Gx,value:null,color:Nx.uniqueSourceIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}},{key:"uniqueDestinationIps",name:Kx,description:Wx,value:null,color:Nx.uniqueDestinationIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}}],enableAreaChart:!0,enableBarChart:!0,description:Qx,areaChartLensAttributes:qx,barChartLensAttributes:$x}],Yx=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Hx),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:Hx,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g,addWarning:y}=Object(Pt.a)(),v=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),y(Vx),c.current.unsubscribe()):(d(!1),b((t=>({...t,uniqueSourceIps:e.uniqueSourceIps,uniqueSourceIpsHistogram:e.uniqueSourceIpsHistogram,uniqueDestinationIps:e.uniqueDestinationIps,uniqueDestinationIpsHistogram:e.uniqueDestinationIpsHistogram,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:Ux}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,y,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.h.kpiUniqueIps,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,n,i]),Object(r.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Jx,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},Xx=s.a.memo(Yx),ej=s.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:r,updateDateRange:o})=>s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(zx,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})),s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(Xx,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})))));ej.displayName="HostsKpiComponent",s.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:r,updateDateRange:o})=>s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Xx,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r}))))).displayName="HostsDetailsKpiComponent";const tj=s.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:i,setQuery:o,to:c,type:u})=>{const d={deleteQuery:e,endDate:c,filterQuery:t,indexNames:n,skip:i||void 0===t,setQuery:o,startDate:a,type:u},p=Object(r.useMemo)((()=>Object(Fb.b)(l.yc.hosts)),[]);return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.hosts})`},s.a.createElement(yE,d)),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.risk})`},s.a.createElement($E,d)),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.uncommonProcesses})`},s.a.createElement(NE,d)),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.anomalies})`},s.a.createElement(Gd,bo()({},d,{AnomaliesTableComponent:Bv}))),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.events})`},s.a.createElement(yb,bo()({additionalFilters:p,tableId:W.e.hostsPageEvents},d))),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.sessions})`},s.a.createElement(rx,d)))}));tj.displayName="HostsTabs";const aj=e=>`${l.Ab}/${e}`,nj=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,isEnterprise:a})=>{const n=[],i={[We.HostsTableType.hosts]:{id:We.HostsTableType.hosts,name:ox.a,href:aj(We.HostsTableType.hosts),disabled:!1},[We.HostsTableType.uncommonProcesses]:{id:We.HostsTableType.uncommonProcesses,name:ox.g,href:aj(We.HostsTableType.uncommonProcesses),disabled:!1},[We.HostsTableType.anomalies]:{id:We.HostsTableType.anomalies,name:ox.b,href:aj(We.HostsTableType.anomalies),disabled:!1},[We.HostsTableType.events]:{id:We.HostsTableType.events,name:ox.d,href:aj(We.HostsTableType.events),disabled:!1},[We.HostsTableType.risk]:{id:We.HostsTableType.risk,name:ox.e,href:aj(We.HostsTableType.risk),disabled:!1},[We.HostsTableType.sessions]:{id:We.HostsTableType.sessions,name:ox.f,href:aj(We.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||n.push(We.HostsTableType.anomalies),t||n.push(We.HostsTableType.risk),a||n.push(We.HostsTableType.sessions),Object(A.omit)(n,i)},ij=ae.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-2687cy-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),rj=()=>{const e=Object(c.useDispatch)(),t=Object(r.useRef)(null),a=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),n=Object(F.b)((e=>{var t;return(null!==(t=a(e,W.e.hostsPageEvents))&&void 0!==t?t:W.q).graphEventId})),o=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),l=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),u=Object(F.a)(l),d=Object(F.a)(o),p=Object(r.useMemo)((()=>i.hostRiskScoreSeverityFilterSelector()),[]),m=Object(F.a)((e=>p(e,We.HostsType.page))),{to:f,from:b,deleteQuery:g,setQuery:y,isInitializing:v}=Object(xe.a)(),{globalFullScreen:x}=Object(Vt.a)(),j=Object(ju.a)(),{uiSettings:O}=Object(h.i)().services,{tabName:w}=Object(k.useParams)(),T=s.a.useMemo((()=>{const e=Object(Fb.b)(P.a.hosts);if(w===We.HostsTableType.events)return[...d,...e];if(w===We.HostsTableType.risk){const t=ct(m,rt.v.host);return[...d,...e,...t]}return d}),[d,m,w]),I=Object(r.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),{indicesExist:C,indexPattern:M,selectedPatterns:D,sourcererDataView:N}=Object(E.d)(),[R,L]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(O),indexPattern:M,queries:[u],filters:d})),[d,M,O,u]),[B]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(O),indexPattern:M,queries:[u],filters:T})),[M,u,T,O]);Object(Bo.a)({id:Gv,filterQuery:R,kqlError:L,query:u,startDate:b,endDate:f});const z=Object(be.b)().isEnterprise(),q=Object(Am.a)("entity-analytics"),$=Object(r.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),V=Object(r.useCallback)((()=>{Object(Ht.m)()}),[]),U=Object(r.useCallback)((e=>{Object(ne.isTab)(e)&&Object(Ht.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:$,onSkipFocusAfterEventsTable:V})}),[t,$,V]);return s.a.createElement(s.a.Fragment,null,C?s.a.createElement(ij,{onKeyDown:U,ref:t},s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:x,graphEventId:n})},s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:N})),s.a.createElement(S.a,{noPadding:x},s.a.createElement(Ut,{show:!x},s.a.createElement(oo,{subtitle:s.a.createElement(Xc,{indexKey:rt.j.hosts,indexNames:D}),title:ox.h,border:!0}),s.a.createElement(ej,{filterQuery:R,indexNames:D,from:b,setQuery:y,to:f,skip:v||!!L,updateDateRange:I}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Wc,{navTabs:nj({hasMlUserPermissions:Object(Zd.a)(j),isRiskyHostsEnabled:q,isEnterprise:z})}),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(tj,{deleteQuery:g,to:f,filterQuery:B,isInitializing:v,indexNames:D,setQuery:y,from:b,type:We.HostsType.page}))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.hosts}))};rj.displayName="HostsComponent";const sj=s.a.memo(rj),oj=`${l.Ab}/name/:detailName`,lj=s.a.memo((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${l.Ab}/ml-hosts`},s.a.createElement(_x,null)),s.a.createElement(K.a,{path:`${l.Ab}/externalAlerts`,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Ab}/${We.HostsTableType.events}`,search:`${e}&onlyExternalAlerts=true`}})}),s.a.createElement(K.a,{path:`${l.Ab}/:tabName(${We.HostsTableType.hosts}|${We.HostsTableType.uncommonProcesses}|${We.HostsTableType.anomalies}|${We.HostsTableType.events}|${We.HostsTableType.risk}|${We.HostsTableType.sessions})`},s.a.createElement(sj,null)),s.a.createElement(K.a,{path:`${oj}/:tabName(${We.HostsTableType.authentications}|${We.HostsTableType.uncommonProcesses}|${We.HostsTableType.anomalies}|${We.HostsTableType.events}|${We.HostsTableType.risk}|${We.HostsTableType.sessions})`,render:({match:{params:{detailName:e}}})=>s.a.createElement(bx,{hostDetailsPagePath:oj,detailName:decodeURIComponent(e)})}),s.a.createElement(K.a,{path:oj,render:({match:{params:{detailName:e}},location:{search:t=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Ab}/name/${e}/${We.HostsTableType.authentications}`,search:t}})}),s.a.createElement(K.a,{path:`${l.Ab}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=We.HostsTableType.authentications}},location:{search:a=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Ab}/name/${e}/${t}`,search:a}})}),s.a.createElement(K.a,{path:l.Ab,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Ab}/${We.HostsTableType.hosts}`,search:e}})}))));lj.displayName="HostsContainer";var cj=a(1311),uj=a(397);const dj=Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.sourceDropDownOptionLabel",{defaultMessage:"Source"}),pj=Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.destinationDropDownOptionLabel",{defaultMessage:"Destination"}),mj=Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.clientDropDownOptionLabel",{defaultMessage:"CLIENT"}),fj=Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.serverDropDownOptionLabel",{defaultMessage:"SERVER"}),bj=(Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.unidirectionalButtonLabel",{defaultMessage:"Unidirectional"}),Y.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.bidirectionalButtonLabel",{defaultMessage:"Bidirectional"}),(e,t)=>[{id:`${e}-select-flow-target-${rt.f.source}`,value:rt.f.source,inputDisplay:t[0]||dj,directions:[rt.e.uniDirectional,rt.e.biDirectional]},{id:`${e}-select-flow-target-${rt.f.destination}`,value:rt.f.destination,inputDisplay:t[1]||pj,directions:[rt.e.uniDirectional,rt.e.biDirectional]},{id:`${e}-select-flow-target-${rt.f.client}`,value:rt.f.client,inputDisplay:t[2]||mj,directions:[rt.e.biDirectional]},{id:`${e}-select-flow-target-${rt.f.server}`,value:rt.f.server,inputDisplay:t[3]||fj,directions:[rt.e.biDirectional]}]),gj=({id:e,isLoading:t=!1,selectedDirection:a,selectedTarget:n,displayTextOverride:i=[],updateFlowTargetAction:r})=>s.a.createElement(ee.EuiSuperSelect,{options:a?bj(e,i).filter((e=>e.directions.includes(a))):bj(e,i),valueOfSelected:n,onChange:r,isLoading:t}),yj=s.a.memo(gj);var hj=a(464);const vj=ae()(ee.EuiFlexItem).withConfig({displayName:"SelectTypeItem",componentId:"sc-loe16c-0"})(["min-width:180px;"]);vj.displayName="SelectTypeItem";const Ej=({flowTarget:e})=>{const t=Object(k.useHistory)(),a=Object(k.useLocation)(),n=Object(r.useCallback)((n=>{const i=((e,t,a)=>`${e.pathname.replace(t,a)}${e.search}`)(a,e,n);t.push(i)}),[t,a,e]);return s.a.createElement(vj,{grow:!1,"data-test-subj":`${hj.b}-select-flow-target`},s.a.createElement(yj,{id:hj.b,isLoading:!e,selectedDirection:rt.e.uniDirectional,selectedTarget:e,displayTextOverride:[uj.b,uj.a],updateFlowTargetAction:n}))},xj=s.a.memo(Ej);var jj=a(1310),Sj=a(1333),Oj=a(563),kj=a(950),wj=a(1262),Tj=a(558);const Ij=(e,t,a)=>`${l.Ob}/ip/${e}/${a}/${t}`,Cj=(e,t,a)=>{const n={[Tj.a.flows]:{id:Tj.a.flows,name:wj.d,href:Ij(e,Tj.a.flows,a),disabled:!1},[Tj.a.users]:{id:Tj.a.users,name:wj.g,href:Ij(e,Tj.a.users,a),disabled:!1},[Tj.a.http]:{id:Tj.a.http,name:wj.e,href:Ij(e,Tj.a.http,a),disabled:!1},[Tj.a.tls]:{id:Tj.a.tls,name:wj.f,href:Ij(e,Tj.a.tls,a),disabled:!1},[Tj.a.anomalies]:{id:Tj.a.anomalies,name:wj.a,href:Ij(e,Tj.a.anomalies,a),disabled:!1},[Tj.a.events]:{id:Tj.a.events,name:wj.c,href:Ij(e,Tj.a.events,a),disabled:!1}};return t||delete n.anomalies,n},Mj=["source.ip","destination.ip"],_j=e=>null!=e&&Mj.includes(e),Aj=(e,t)=>!!_j(e.entityName)&&(null==t||e.entityValue===t);var Fj=a(338);const Pj=(e,t,a)=>e===Fj.NetworkType.details&&null!=t?a===rt.f.source?[{fieldName:"source.ip",fieldValue:t}]:a===rt.f.destination?[{fieldName:"destination.ip",fieldValue:t}]:[]:[],Dj={sort:{field:"anomaly.severity",direction:"desc"}},Nj=({startDate:e,endDate:t,skip:a,ip:n,type:i,flowTarget:o})=>{const l=Object(ju.a)(),u=Object(c.useDispatch)(),{toggleStatus:d,setToggleStatus:p}=Object(Er.a)(`AnomaliesNetwork-${o}`),[m,f]=Object(r.useState)(a||!d);Object(r.useEffect)((()=>{f(a||!d)}),[a,d]);const b=Object(r.useCallback)((e=>{p(e),f(!e)}),[f,p]),{jobNameById:g,loading:y}=Object(Nd.a)(),h=Object(r.useMemo)((()=>Object.keys(g)),[g]),v=Object(r.useMemo)((()=>pt.e.networkAnomaliesJobIdFilterSelector()),[]),E=Object(F.a)((e=>v(e,i))),x=Object(r.useCallback)((e=>{u(pt.b.updateNetworkAnomaliesJobIdFilter({jobIds:e,networkType:i}))}),[u,i]),j=Object(r.useMemo)((()=>pt.e.networkAnomaliesIntervalSelector()),[]),S=Object(F.a)((e=>j(e,i))),O=Object(r.useCallback)((e=>{u(pt.b.updateNetworkAnomaliesInterval({interval:e,networkType:i}))}),[u,i]),[k,w]=Object(Wd.a)({startDate:e,endDate:t,skip:m,criteriaFields:Pj(i,n,o),jobIds:E.length>0?E:h,aggregationInterval:S}),T=((e,t,a)=>null==e?[]:e.anomalies.reduce(((e,n)=>{var i;if(_j(n.entityName)&&Aj(n,a))return[...e,{ip:n.entityValue,type:n.entityName,jobName:null!==(i=t[n.jobId])&&void 0!==i?i:n.jobId,anomaly:n}];{const i=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(yp.a)(e);return!!_j(a)&&(null==t||n===t)}));if(null!=a){const[e]=Object(yp.a)(a);return _j(e)?{ip:Object.values(a)[0],type:e}:{ip:Object.values(a)[0],type:"destination.ip"}}return null})(n.influencers,a);var r;return null!=i?[...e,{ip:i.ip,type:i.type,jobName:null!==(r=t[n.jobId])&&void 0!==r?r:n.jobId,anomaly:n}]:e}}),[]))(w,g,n),I=((e,t,a,n)=>{const i=((e,t,a)=>[{name:sp,field:"ip",sortable:!0,render:(e,t)=>Object(pu.b)({values:[e],fieldName:t.type,idPrefix:`anomalies-network-table-ip-${vp(t.anomaly)}`,render:e=>s.a.createElement($t.h,{ip:e,flowTarget:a})})},...Op(e,t)])(t,a,n);return e===Fj.NetworkType.details?i.filter((e=>e.name!==sp)):i})(i,e,t,o),C={initialPageIndex:0,initialPageSize:10,totalItemCount:T.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(Zd.a)(l)?s.a.createElement(su.a,{loading:k||y},s.a.createElement(Li.a,{subtitle:`${Kd}: ${C.totalItemCount.toLocaleString()} ${Yd(C.totalItemCount)}`,title:Jd,tooltip:Xd,toggleQuery:b,toggleStatus:d,isInspectDisabled:a,headerFilters:s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Ip,{interval:S,onChange:O})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(kp,{title:lp,onSelect:x,selectedJobIds:E,jobIds:h,jobNameById:g})))}),d&&s.a.createElement(bp.a,{"data-test-subj":"network-anomalies-table",columns:I,items:T,pagination:C,sorting:Dj}),(k||y)&&s.a.createElement(eu.a,{"data-test-subj":"anomalies-network-table-loading-panel",overlay:!0,size:"xl"})):null},Rj=s.a.memo(Nj);var Lj=a(245),Bj=a(469);const zj=[Bj.a.flows,Bj.a.dns,Bj.a.http,Bj.a.tls,Bj.a.events],qj=zj.join("|"),$j=[...zj,Bj.a.anomalies].join("|"),Vj=`${l.Ob}/:tabName(${$j})`,Uj=`${l.Ob}/:tabName(${qj})`,Hj=[Tj.a.flows,Tj.a.http,Tj.a.tls,Tj.a.anomalies,Tj.a.events,Tj.a.users].join("|"),Qj=[rt.g.source,rt.g.destination].join("|"),Gj=`${l.Ob}/ip/:detailName`,Wj=`${Gj}/:flowTarget(${Qj})/:tabName(${Hj})`,Zj=ae()(ee.EuiFlexGroup).withConfig({displayName:"ConditionalFlexGroup",componentId:"sc-ivhqnd-0"})(["@media only screen and (min-width:1441px){flex-direction:row !important;}"]);Zj.displayName="ConditionalFlexGroup";const Kj=s.a.memo((({type:e,to:t,filterQuery:a,isInitializing:n,from:i,indexPattern:r,indexNames:o,setQuery:c})=>{const u={startDate:i,endDate:t,indexNames:o,skip:n,type:e,setQuery:c,filterQuery:a},d={...u,indexPattern:r},p={...u,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:Rj};return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.dns})`},s.a.createElement(HS,d)),s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.flows})`},s.a.createElement(s.a.Fragment,null,s.a.createElement(Zj,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(wO,bo()({},d,{flowTarget:Lj.b.source}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(wO,bo()({},d,{flowTarget:Lj.b.destination})))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Zj,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ES,bo()({},d,{flowTarget:Lj.b.source}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ES,bo()({},d,{flowTarget:Lj.b.destination})))))),s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.http})`},s.a.createElement(sO,d)),s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.tls})`},s.a.createElement(VO,bo()({},d,{flowTarget:Lj.b.source}))),s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.anomalies})`},s.a.createElement(Gd,bo()({},p,{AnomaliesTableComponent:Rj}))),s.a.createElement(K.a,{path:`${l.Ob}/:tabName(${Bj.a.events})`},s.a.createElement(yb,bo()({additionalFilters:Fb.h,tableId:W.e.networkPageEvents},d))))}));Kj.displayName="NetworkRoutes";const Jj=ae()(ee.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1bc33a1-0"})(["min-height:200px;"]);Jj.displayName="FlexGroup";const Yj=()=>s.a.createElement(Jj,{justifyContent:"center",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiLoadingSpinner,{size:"xl"})));Yj.displayName="NetworkRoutesLoading";const Xj=e=>`${l.Ob}/${e}`,eS=e=>{const t={[Bj.a.flows]:{id:Bj.a.flows,name:wj.d,href:Xj(Bj.a.flows),disabled:!1},[Bj.a.dns]:{id:Bj.a.dns,name:wj.b,href:Xj(Bj.a.dns),disabled:!1},[Bj.a.http]:{id:Bj.a.http,name:wj.e,href:Xj(Bj.a.http),disabled:!1},[Bj.a.tls]:{id:Bj.a.tls,name:wj.f,href:Xj(Bj.a.tls),disabled:!1},[Bj.a.anomalies]:{id:Bj.a.anomalies,name:wj.a,href:Xj(Bj.a.anomalies),disabled:!1},[Bj.a.events]:{id:Bj.a.events,name:wj.c,href:Xj(Bj.a.events),disabled:!1}};return e?t:Object(A.omit)([Bj.a.anomalies],t)};var tS=a(1396);const aS=e=>Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {Country} other {Countries}}"}),nS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.countryTitle",{defaultMessage:"Country"}),iS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),rS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),sS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.flows",{defaultMessage:"Flows"}),oS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.destinationCountries",{defaultMessage:"Destination countries"}),lS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.sourceCountries",{defaultMessage:"Source countries"}),cS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.destinationIps",{defaultMessage:"Destination IPs"}),uS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.sourceIps",{defaultMessage:"Source IPs"}),dS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),pS=Y.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var mS=a(1100);const fS=e=>e===Lj.b.source?Lj.b.destination:Lj.b.source,bS=[{text:dS,numberOfRow:5},{text:pS,numberOfRow:10}],gS=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,indexPattern:i,isInspect:o,loading:l,loadPage:u,setQuerySkip:d,showMorePagesIndicator:p,totalCount:m,type:f})=>{const b=Object(c.useDispatch)(),g=Object(r.useMemo)((()=>pt.e.topCountriesSelector()),[]),{activePage:y,limit:h,sort:v}=Object(F.a)((e=>g(e,f,a))),E=Object(r.useMemo)((()=>a===rt.g.source?lS:oS),[a]),x=Object(r.useMemo)((()=>f===pt.c.NetworkType.page?a===rt.g.source?pt.c.NetworkTableType.topCountriesSource:pt.c.NetworkTableType.topCountriesDestination:a===rt.g.source?pt.c.NetworkDetailsTableType.topCountriesSource:pt.c.NetworkDetailsTableType.topCountriesDestination),[a,f]),j=v.field===rt.s.bytes_out||v.field===rt.s.bytes_in?`node.network.${v.field}`:`node.${a}.${v.field}`,S=Object(r.useCallback)((e=>b(pt.b.updateNetworkTable({networkType:f,tableType:x,updates:{limit:e}}))),[b,f,x]),O=Object(r.useCallback)((e=>b(pt.b.updateNetworkTable({networkType:f,tableType:x,updates:{activePage:e}}))),[b,f,x]),k=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(A.last)(t),n={field:a,direction:a!==v.field?rt.b.desc:e.sort.direction};T()(n,v)||b(pt.b.updateNetworkTable({networkType:f,tableType:x,updates:{sort:n}}))}}),[v,b,f,x]),w=Object(r.useMemo)((()=>((e,t,a,n)=>{const i=((e,t,a,n)=>[{name:nS,render:({node:e})=>{const a=Object(A.get)(`${t}.country`,e),i=`${t}.geo.country_iso_code`,r=Object(fi.i)(`${n}-table-${t}-country-${a}`);return null!=a?s.a.createElement(sr.c,{key:r,mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:a,field:i}},s.a.createElement(tS.b,{countryCode:a})):Object(Jc.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:iS,sortable:!0,render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()},{align:"right",field:"node.network.bytes_out",name:rS,sortable:!0,render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()},{align:"right",field:`node.${t}.flows`,name:sS,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()},{align:"right",field:`node.${t}.${t}_ips`,name:t===Lj.b.source?uS:cS,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()},{align:"right",field:`node.${t}.${fS(t)}_ips`,name:fS(t)===Lj.b.source?uS:cS,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()}])(0,t,0,n);return a===pt.c.NetworkType.details?(i.pop(),i):i})(0,a,f,"networkTopCountries-top-talkers")),[i,a,f]);return s.a.createElement(lu,{activePage:y,columns:w,dataTestSubj:`table-${x}`,headerCount:m,headerTitle:E,headerUnit:aS(m),id:n,isInspect:o,itemsPerRow:bS,limit:h,loading:l,loadPage:u,onChange:k,pageOfItems:e,setQuerySkip:d,showMorePagesIndicator:p,sorting:{field:j,direction:v.direction},totalCount:t,updateActivePage:O,updateLimitPagination:S})};gS.displayName="NetworkTopCountriesTableComponent";const yS=s.a.memo(gS),hS=Y.i18n.translate("xpack.securitySolution.networkTopCountries.failSearchDescription",{defaultMessage:"Failed to run search on network top countries"}),vS=Object($a.a)(yS),ES=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,indexPattern:i,ip:o,setQuery:l,skip:c,startDate:u,type:d})=>{const p=`networkTopCountriesQuery-${a}-${d}`,{toggleStatus:m}=Object(Er.a)(p),[f,b]=Object(r.useState)(c||!m);Object(r.useEffect)((()=>{b(c||!m)}),[c,m]);const[g,{id:y,inspect:h,isInspected:v,loadPage:E,networkTopCountries:x,pageInfo:j,refetch:S,totalCount:O}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>pt.e.topCountriesSelector()),[]),{activePage:d,limit:p,sort:m}=Object(F.a)((e=>u(e,c,a))),[f,b]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Ru(e,p)}:t))}),[p]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(Pu.a)({factoryQueryType:rt.q.topCountries,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:hS,abort:o}),j=Object(r.useMemo)((()=>({endDate:e,networkTopCountries:h.edges,id:n,inspect:x,isInspected:!1,loadPage:g,pageInfo:h.pageInfo,refetch:E,startDate:l,totalCount:h.totalCount})),[e,n,x,E,h.edges,h.pageInfo,h.totalCount,l,g]);return Object(r.useEffect)((()=>{b((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:rt.q.topCountries,filterQuery:Object(wd.a)(t),flowTarget:a,ip:s,pagination:Ru(d,p),sort:m,timerange:{interval:"12h",from:l,to:e}};return T()(n,r)?n:r}))}),[d,i,e,t,s,p,l,m,a]),Object(r.useEffect)((()=>{!o&&f&&v(f)}),[f,v,o]),[y,j]})({endDate:e,flowTarget:a,filterQuery:t,id:p,indexNames:n,ip:o,skip:f,startDate:u,type:d});return s.a.createElement(vS,{data:x,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",j),flowTargeted:a,id:y,indexPattern:i,inspect:h,isInspect:v,loading:g,loadPage:E,refetch:S,setQuery:l,setQuerySkip:b,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",j),totalCount:O,type:d})};ES.displayName="CountriesQueryTabBody";const xS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),jS=e=>Y.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),SS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),OS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),kS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),wS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),TS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),IS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),CS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),MS=Y.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),_S=Y.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),AS=s.a.memo((({isPtrIncluded:e,onChange:t})=>s.a.createElement(ee.EuiSwitch,{name:"switch-ptr-included",label:CS,checked:e,onChange:t})));AS.displayName="IsPtrIncluded";const FS=pt.c.NetworkTableType.dns,PS=[{text:MS,numberOfRow:5},{text:_S,numberOfRow:10}],DS=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,showMorePagesIndicator:l,setQuerySkip:u,totalCount:d,type:p})=>{const m=Object(c.useDispatch)(),f=Object(r.useMemo)((()=>pt.e.dnsSelector()),[]),{activePage:b,isPtrIncluded:g,limit:y,sort:h}=Object(F.a)(f),v=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:FS,updates:{limit:e}}))),[p,m]),E=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:FS,updates:{activePage:e}}))),[m,p]),x=Object(r.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};T()(t,h)||m(pt.b.updateNetworkTable({networkType:p,tableType:FS,updates:{sort:t}}))}}),[h,p,m]),j=Object(r.useCallback)((()=>m(pt.b.updateNetworkTable({networkType:p,tableType:FS,updates:{isPtrIncluded:!g}}))),[m,p,g]),S=Object(r.useMemo)((()=>[{field:`node.${rt.n.dnsName}`,name:OS,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?s.a.createElement(sr.c,{key:Object(fi.i)(`networkDns-table--name-${e}`),mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:e,field:"dns.question.registered_domain"}},Object(Jc.a)(e)):Object(Jc.d)()},{align:"right",field:`node.${rt.n.queryCount}`,name:kS,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?Rr()(e).format("0"):Object(Jc.d)()},{align:"right",field:`node.${rt.n.uniqueDomains}`,name:wS,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?Rr()(e).format("0"):Object(Jc.d)()},{align:"right",field:`node.${rt.n.dnsBytesIn}`,name:TS,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()},{align:"right",field:`node.${rt.n.dnsBytesOut}`,name:IS,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()}]),[]),O=Object(r.useMemo)((()=>({field:`node.${h.field}`,direction:h.direction})),[h.direction,h.field]),k=Object(r.useMemo)((()=>s.a.createElement(AS,{isPtrIncluded:g,onChange:j})),[g,j]);return s.a.createElement(lu,{activePage:b,columns:S,dataTestSubj:`table-${FS}`,headerCount:d,headerSupplement:k,headerTitle:xS,headerTooltip:SS,headerUnit:jS(d),id:a,itemsPerRow:PS,isInspect:n,limit:y,loading:i,loadPage:o,onChange:x,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:l,sorting:O,totalCount:t,updateActivePage:E,updateLimitPagination:v})};DS.displayName="NetworkDnsTableComponent";const NS=s.a.memo(DS),RS=Y.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),LS=Y.i18n.translate("xpack.securitySolution.hosts.navigation.dns.histogram.errorFetchingDnsData",{defaultMessage:"Failed to query DNS data"});var BS;const zS="networkDnsHistogramQuery",qS=Object($a.a)(NS),$S=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],VS={defaultStackByOption:null!==(BS=$S.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==BS?BS:$S[0],errorMessage:LS,histogramType:kd.i.dns,stackByOptions:$S,subtitle:void 0,getLensAttributes:(e="dns.question.registered_domain",t)=>({title:"Top domains by dns.question.registered_domain",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},valuesInLegend:!0,tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar_stacked",layers:[{layerId:"b1c3efc6-c886-4fba-978f-3b6bb5e7948a",accessors:["2a4d5e20-f570-48e4-b9ab-ff3068919377"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"d1452b87-0e9e-4fc0-a725-3727a18e0b37",splitAccessor:"e8842815-2a45-4c74-86de-c19a391e2424"}]},query:{query:"",language:"kuery"},filters:null!=t&&t.dnsIsPtrIncluded?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"phrase",key:"dns.question.type",params:{query:"PTR"},indexRefName:"filter-index-pattern-0"},query:{match_phrase:{"dns.question.type":"PTR"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"b1c3efc6-c886-4fba-978f-3b6bb5e7948a":{columns:{"e8842815-2a45-4c74-86de-c19a391e2424":{label:Object(wr.p)(e),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"2a4d5e20-f570-48e4-b9ab-ff3068919377"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,secondaryFields:[],parentFormat:{id:"terms"},accuracyMode:!0}},"d1452b87-0e9e-4fc0-a725-3727a18e0b37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"2a4d5e20-f570-48e4-b9ab-ff3068919377":{label:Object(wr.q)("dns.question.name"),dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"dns.question.name",isBucketed:!1}},columnOrder:["e8842815-2a45-4c74-86de-c19a391e2424","d1452b87-0e9e-4fc0-a725-3727a18e0b37","2a4d5e20-f570-48e4-b9ab-ff3068919377"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b1c3efc6-c886-4fba-978f-3b6bb5e7948a"}]})},US=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:i,startDate:o,setQuery:l,type:c})=>{const u=pt.e.dnsSelector(),d=Object(F.b)((e=>u(e).isPtrIncluded));Object(r.useEffect)((()=>()=>{e&&e({id:zS})}),[e]);const p=`networkDnsQuery-${c}`,{toggleStatus:m}=Object(Er.a)(p),[f,b]=Object(r.useState)(i||!m);Object(r.useEffect)((()=>{b(i||!m)}),[i,m]);const[g,{totalCount:y,networkDns:h,pageInfo:v,loadPage:E,id:x,inspect:j,isInspected:S,refetch:O}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,skip:i,startDate:s})=>{const o=Object(r.useMemo)((()=>pt.e.dnsSelector()),[]),{activePage:l,sort:c,isPtrIncluded:u,limit:d}=Object(F.a)(o),[p,m]=Object(r.useState)(null),f=Object(r.useCallback)((e=>{m((t=>t?{...t,pagination:Ru(e,d)}:t))}),[d]),{loading:b,result:g,search:y,refetch:h,inspect:v}=Object(Pu.a)({factoryQueryType:rt.q.dns,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:RS,abort:i}),E=Object(r.useMemo)((()=>({id:a,inspect:v,isInspected:!1,loadPage:f,networkDns:g.edges,pageInfo:g.pageInfo,refetch:h,totalCount:g.totalCount})),[a,v,h,g.edges,g.pageInfo,g.totalCount,f]);return Object(r.useEffect)((()=>{m((a=>{const i={...null!=a?a:{},defaultIndex:n,isPtrIncluded:u,factoryQueryType:rt.q.dns,filterQuery:Object(wd.a)(t),pagination:Ru(l,d,!0),sort:c,timerange:{interval:"12h",from:s,to:e}};return T()(a,i)?a:i}))}),[l,n,e,t,d,s,c,u]),Object(r.useEffect)((()=>{!i&&p&&y(p)}),[p,y,i]),[b,E]})({endDate:t,filterQuery:a,id:p,indexNames:n,skip:f,startDate:o}),k=Object(r.useCallback)((e=>{return t=e.text,Y.i18n.translate("xpack.securitySolution.network.dns.stackByUniqueSubdomain",{values:{groupByField:t},defaultMessage:"Top domains by {groupByField}"});var t}),[]),w=Object(r.useMemo)((()=>({...VS,title:k})),[k]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ad.a,bo()({id:zS,isPtrIncluded:d,endDate:t,filterQuery:a,indexNames:n,setQuery:l,showLegend:!0,startDate:o},w)),s.a.createElement(qS,{data:h,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",v),id:x,inspect:j,isInspect:S,loading:g,loadPage:E,refetch:O,setQuery:l,setQuerySkip:b,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",v),totalCount:y,type:c}))};US.displayName="DnsQueryTabBodyComponent";const HS=s.a.memo(US),QS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.title",{defaultMessage:"HTTP Requests"}),GS=e=>Y.i18n.translate("xpack.securitySolution.networkHttpTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {request} other {requests}}"}),WS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.methodTitle",{defaultMessage:"Method"}),ZS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.domainTitle",{defaultMessage:"Domain"}),KS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.pathTitle",{defaultMessage:"Path"}),JS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.statusTitle",{defaultMessage:"Status"}),YS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastHostTitle",{defaultMessage:"Last host"}),XS=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastSourceIpTitle",{defaultMessage:"Last source Ip"}),eO=Y.i18n.translate("xpack.securitySolution.networkHttpTable.column.requestsTitle",{defaultMessage:"Requests"}),tO=[{text:Y.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:Y.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],aO=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(c.useDispatch)(),f=Object(r.useMemo)((()=>pt.e.httpSelector()),[]),{activePage:b,limit:g,sort:y}=Object(F.a)((e=>f(e,p))),h=p===pt.c.NetworkType.page?pt.c.NetworkTableType.http:pt.c.NetworkDetailsTableType.http,v=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{limit:e}}))),[m,p,h]),E=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{activePage:e}}))),[m,p,h]),x=Object(r.useCallback)((e=>{null!=e.sort&&e.sort.direction!==y.direction&&m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{sort:{direction:e.sort.direction}}}))}),[y.direction,m,p,h]),j={field:`node.${rt.o.requestCount}`,direction:y.direction},S=Object(r.useMemo)((()=>{return e=h,[{name:WS,render:({node:{methods:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(pu.b)({fieldName:"http.request.method",values:t,idPrefix:Object(fi.i)(`${e}-table-methods-${a}`),displayCount:3}):Object(Jc.d)()},{name:ZS,render:({node:{domains:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(pu.b)({values:t,fieldName:"url.domain",idPrefix:Object(fi.i)(`${e}-table-domains-${a}`)}):Object(Jc.d)()},{field:`node.${Lj.e.path}`,name:KS,render:t=>null!=t?Object(pu.b)({values:[t],fieldName:"url.path",idPrefix:Object(fi.i)(`${e}-table-path-${t}`)}):Object(Jc.d)()},{name:JS,render:({node:{statuses:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(pu.b)({values:t,fieldName:"http.response.status_code",idPrefix:Object(fi.i)(`${e}-table-statuses-${a}`),displayCount:3}):Object(Jc.d)()},{name:YS,render:({node:{lastHost:t,path:a}})=>null!=t?Object(pu.b)({values:[t],fieldName:"host.name",idPrefix:Object(fi.i)(`${e}-table-lastHost-${a}`)}):Object(Jc.d)()},{name:XS,render:({node:{lastSourceIp:t,path:a}})=>null!=t?Object(pu.b)({values:[t],fieldName:"source.ip",idPrefix:Object(fi.i)(`${e}-table-lastSourceIp-${a}`),render:()=>s.a.createElement($t.h,{ip:t})}):Object(Jc.d)()},{align:"right",field:`node.${Lj.e.requestCount}`,name:eO,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()}];var e}),[h]);return s.a.createElement(lu,{activePage:b,columns:S,dataTestSubj:`table-${h}`,headerCount:d,headerTitle:QS,headerUnit:GS(d),id:a,itemsPerRow:tO,isInspect:n,limit:g,loading:i,loadPage:o,onChange:x,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:u,sorting:j,totalCount:t,updateActivePage:E,updateLimitPagination:v})};aO.displayName="NetworkHttpTableComponent";const nO=s.a.memo(aO),iO=Y.i18n.translate("xpack.securitySolution.networkHttp.failSearchDescription",{defaultMessage:"Failed to run search on network http"}),rO=Object($a.a)(nO),sO=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:i,setQuery:o,type:l})=>{const c=`networkHttpQuery-${l}`,{toggleStatus:u}=Object(Er.a)(c),[d,p]=Object(r.useState)(n||!u);Object(r.useEffect)((()=>{p(n||!u)}),[n,u]);const[m,{id:f,inspect:b,isInspected:g,loadPage:y,networkHttp:h,pageInfo:v,refetch:E,totalCount:x}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,ip:i,skip:s,startDate:o,type:l})=>{const c=Object(r.useMemo)((()=>pt.e.httpSelector()),[]),{activePage:u,limit:d,sort:p}=Object(F.a)((e=>c(e,l))),[m,f]=Object(r.useState)(null),b=Object(r.useCallback)((e=>{f((t=>t?{...t,pagination:Ru(e,d)}:t))}),[d]),{loading:g,result:y,search:h,refetch:v,inspect:E}=Object(Pu.a)({factoryQueryType:rt.q.http,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:iO,abort:s}),x=Object(r.useMemo)((()=>({endDate:e,networkHttp:y.edges,id:a,inspect:E,isInspected:!1,loadPage:b,pageInfo:y.pageInfo,refetch:v,startDate:o,totalCount:y.totalCount})),[e,a,E,v,y.edges,y.pageInfo,y.totalCount,o,b]);return Object(r.useEffect)((()=>{f((a=>{const r={...null!=a?a:{},defaultIndex:n,factoryQueryType:rt.q.http,filterQuery:Object(wd.a)(t),ip:i,pagination:Ru(u,d),sort:p,timerange:{interval:"12h",from:o,to:e}};return T()(a,r)?a:r}))}),[u,n,e,t,i,d,o,p]),Object(r.useEffect)((()=>{!s&&m&&h(m)}),[m,h,s]),[g,x]})({endDate:e,filterQuery:t,id:c,indexNames:a,skip:d,startDate:i,type:l});return s.a.createElement(rO,{data:h,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",v),id:f,inspect:b,isInspect:g,loading:m,loadPage:y,refetch:E,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",v),totalCount:x,type:l})};sO.displayName="HttpQueryTabBody";const oO=e=>Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {IP} other {IPs}}"}),lO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.sourceIpTitle",{defaultMessage:"Source IPs"}),cO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.destinationIpTitle",{defaultMessage:"Destination IPs"}),uO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.IpTitle",{defaultMessage:"IP"}),dO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.domainTitle",{defaultMessage:"Domain"}),pO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),mO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),fO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.asTitle",{defaultMessage:"Autonomous system"}),bO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.flows",{defaultMessage:"Flows"}),gO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.destinationIps",{defaultMessage:"Destination IPs"}),yO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.sourceIps",{defaultMessage:"Source IPs"}),hO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),vO=Y.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),EO=e=>e===rt.g.source?rt.g.destination:rt.g.source,xO=[{text:hO,numberOfRow:5},{text:vO,numberOfRow:10}],jO=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:u,showMorePagesIndicator:d,totalCount:p,type:m})=>{const f=Object(c.useDispatch)(),b=Object(r.useMemo)((()=>pt.e.topNFlowSelector()),[]),{activePage:g,limit:y,sort:h}=Object(F.a)((e=>b(e,m,a))),v=Object(r.useMemo)((()=>((e,t,a)=>{const n=((e,t)=>[{name:uO,render:({node:a})=>{const n=`${e}.ip`,i=Object(A.get)(n,a),r=`${e}.location.geo.country_iso_code[0]`,o=`${e}.geo.country_iso_code`,l=Object(A.get)(r,a),c=Object(fi.i)(`${t}-table-${e}-ip-${i}`);return null!=i?s.a.createElement(s.a.Fragment,null,s.a.createElement(sr.c,{key:c,mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:i,field:n}},s.a.createElement($t.h,{ip:i,flowTarget:e})),l&&s.a.createElement(sr.c,{key:`${c}-${l}`,mode:sr.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:sr.d.DEFAULT,data:{value:l,field:o}}," ",s.a.createElement(tS.a,{countryCode:l})," ",l)):Object(Jc.d)()},width:"20%"},{name:dO,render:({node:a})=>{const n=`${e}.domain`,i=`${e}.ip`,r=Object(A.get)(n,a),s=Object(A.get)(i,a);if(Array.isArray(r)&&r.length>0){const e=Object(fi.i)(`${t}-table-${s}`);return Object(pu.b)({values:r,fieldName:n,idPrefix:e,displayCount:1})}return Object(Jc.d)()},width:"20%"},{name:fO,render:({node:a,cursor:{value:n}})=>{const i=`${e}.autonomous_system`,r=Object(A.get)(i,a);if(null!=r){const a=Object(fi.i)(`${t}-table-${e}-ip-${n}`);return s.a.createElement(s.a.Fragment,null,r.name&&Object(pu.b)({values:[r.name],fieldName:`${e}.as.organization.name`,idPrefix:`${a}-name`}),r.number&&s.a.createElement(s.a.Fragment,null," ",Object(pu.b)({values:[`${r.number}`],fieldName:`${e}.as.number`,idPrefix:`${a}-number`})))}return Object(Jc.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:pO,sortable:!0,render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()},{align:"right",field:"node.network.bytes_out",name:mO,sortable:!0,render:e=>null!=e?s.a.createElement(mS.a,{value:e}):Object(Jc.d)()},{align:"right",field:`node.${e}.flows`,name:bO,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()},{align:"right",field:`node.${e}.${EO(e)}_ips`,name:e===rt.g.source?gO:yO,sortable:!0,render:e=>null!=e?Rr()(e).format("0,000"):Object(Jc.d)()}])(e,a);return t===pt.c.NetworkType.details?(n.pop(),n):n})(a,m,"networkTopSourceFlow-top-talkers")),[a,m]);let E;const x=a===rt.g.source?lO:cO;E=m===pt.c.NetworkType.page?a===rt.g.source?pt.c.NetworkTableType.topNFlowSource:pt.c.NetworkTableType.topNFlowDestination:a===rt.g.source?pt.c.NetworkDetailsTableType.topNFlowSource:pt.c.NetworkDetailsTableType.topNFlowDestination;const j=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(A.last)(t),n={field:a,direction:a!==h.field?rt.b.desc:e.sort.direction};T()(n,h)||f(pt.b.updateNetworkTable({networkType:m,tableType:E,updates:{sort:n}}))}}),[h,f,m,E]),S=Object(r.useMemo)((()=>({field:h.field===rt.s.bytes_out||h.field===rt.s.bytes_in?`node.network.${h.field}`:`node.${a}.${h.field}`,direction:h.direction})),[a,h]),O=Object(r.useCallback)((e=>f(pt.b.updateNetworkTable({networkType:m,tableType:E,updates:{activePage:e}}))),[f,m,E]),k=Object(r.useCallback)((e=>f(pt.b.updateNetworkTable({networkType:m,tableType:E,updates:{limit:e}}))),[f,m,E]);return s.a.createElement(lu,{activePage:g,columns:v,dataTestSubj:`table-${E}`,headerCount:p,headerTitle:x,headerUnit:oO(p),id:n,isInspect:i,itemsPerRow:xO,limit:y,loading:o,loadPage:l,onChange:j,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,sorting:S,totalCount:t,updateActivePage:O,updateLimitPagination:k})},SO=s.a.memo(jO),OO=Y.i18n.translate("xpack.securitySolution.networkTopNFlow.failSearchDescription",{defaultMessage:"Failed to run search on network top n flow"}),kO=Object($a.a)(SO),wO=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i,setQuery:o,skip:l,startDate:c,type:u})=>{const d=`networkTopNFlowQuery-${a}-${u}`,{toggleStatus:p}=Object(Er.a)(d),[m,f]=Object(r.useState)(l||!p);Object(r.useEffect)((()=>{f(l||!p)}),[l,p]);const[b,{id:g,inspect:y,isInspected:h,loadPage:v,networkTopNFlow:E,pageInfo:x,refetch:j,totalCount:S}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>pt.e.topNFlowSelector()),[]),{activePage:d,limit:p,sort:m}=Object(F.a)((e=>u(e,c,a))),[f,b]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Ru(e,p)}:t))}),[p]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(Pu.a)({factoryQueryType:rt.q.topNFlow,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:OO,abort:o}),j=Object(r.useMemo)((()=>({endDate:e,networkTopNFlow:h.edges,id:n,inspect:x,isInspected:!1,loadPage:g,pageInfo:h.pageInfo,refetch:E,startDate:l,totalCount:h.totalCount})),[e,n,x,E,h.edges,h.pageInfo,h.totalCount,l,g]);return Object(r.useEffect)((()=>{b((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:rt.q.topNFlow,filterQuery:Object(wd.a)(t),flowTarget:a,ip:s,pagination:Ru(d,p),timerange:{interval:"12h",from:l,to:e},sort:m};return T()(n,r)?n:r}))}),[d,e,t,i,s,p,l,m,a]),Object(r.useEffect)((()=>{!o&&f&&v(f)}),[f,v,o]),[y,j]})({endDate:e,flowTarget:a,filterQuery:t,id:d,indexNames:n,ip:i,skip:m,startDate:c,type:u});return s.a.createElement(kO,{data:E,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",x),flowTargeted:a,id:g,inspect:y,isInspect:h,loading:b,loadPage:v,refetch:j,setQuery:o,setQuerySkip:f,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",x),totalCount:S,type:u})};wO.displayName="IPsQueryTabBody",Y.i18n.translate("xpack.securitySolution.networkTls.errorSearchDescription",{defaultMessage:"An error has occurred on network tls search"});const TO=Y.i18n.translate("xpack.securitySolution.networkTls.failSearchDescription",{defaultMessage:"Failed to run search on network tls"});var IO=a(715);const CO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.transportLayerSecurityTitle",{defaultMessage:"Transport Layer Security"}),MO=e=>Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {server certificate} other {server certificates}}"}),_O=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.issuerTitle",{defaultMessage:"Issuer"}),AO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.subjectTitle",{defaultMessage:"Subject"}),FO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.sha1FingerPrintTitle",{defaultMessage:"SHA1 fingerprint"}),PO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.ja3FingerPrintTitle",{defaultMessage:"JA3 fingerprint"}),DO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.validUntilTitle",{defaultMessage:"Valid until"}),NO=[{text:Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:Y.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],RO=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(c.useDispatch)(),f=Object(r.useMemo)((()=>pt.e.tlsSelector()),[]),{activePage:b,limit:g,sort:y}=Object(F.a)((e=>f(e,p))),h=p===pt.c.NetworkType.page?pt.c.NetworkTableType.tls:pt.c.NetworkDetailsTableType.tls,v=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{limit:e}}))),[m,p,h]),E=Object(r.useCallback)((e=>m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{activePage:e}}))),[m,p,h]),x=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:zO(t[t.length-1]),direction:e.sort.direction};T()(a,y)||m(pt.b.updateNetworkTable({networkType:p,tableType:h,updates:{sort:a}}))}}),[y,m,p,h]),j=Object(r.useMemo)((()=>{return e="tls-table",[{field:"node",name:_O,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:t,issuers:a})=>Object(pu.b)({values:a,fieldName:"tls.server.issuer",idPrefix:`${e}-${t}-table-issuers`})},{field:"node",name:AO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:t,subjects:a})=>Object(pu.b)({values:a,fieldName:"tls.server.subject",idPrefix:`${e}-${t}-table-subjects`})},{field:"node._id",name:FO,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>Object(pu.b)({values:t?[t]:void 0,fieldName:"tls.server.hash.sha1",idPrefix:`${e}-${t}-table-sha1`})},{field:"node",name:PO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:t,ja3:a})=>Object(pu.b)({values:a,fieldName:"tls.server.ja3s",idPrefix:`${e}-${t}-table-ja3`})},{field:"node",name:DO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:t,notAfter:a})=>Object(pu.b)({values:a,fieldName:"tls.server.not_after",idPrefix:`${e}-${t}-table-notAfter`,render:e=>s.a.createElement(IO.a,{date:ec()(new Date(e)).toDate()},s.a.createElement(Yc.c,{value:new Date(e)}))})}];var e}),[]);return s.a.createElement(lu,{activePage:b,columns:j,dataTestSubj:`table-${h}`,showMorePagesIndicator:u,headerCount:d,headerTitle:CO,headerUnit:MO(d),id:a,isInspect:n,itemsPerRow:NO,limit:g,loading:i,loadPage:o,onChange:x,pageOfItems:e,setQuerySkip:l,sorting:BO(y),totalCount:t,updateActivePage:E,updateLimitPagination:v})};RO.displayName="TlsTableComponent";const LO=s.a.memo(RO),BO=e=>({field:`node.${e.field}`,direction:e.direction}),zO=e=>rt.r._id,qO=Object($a.a)(LO),$O=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i="",setQuery:o,skip:l,startDate:c,type:u})=>{const d=`networkTlsQuery-${u}`,{toggleStatus:p}=Object(Er.a)(d),[m,f]=Object(r.useState)(l||!p);Object(r.useEffect)((()=>{f(l||!p)}),[l,p]);const[b,{id:g,inspect:y,isInspected:h,tls:v,totalCount:E,pageInfo:x,loadPage:j,refetch:S}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>pt.e.tlsSelector()),[]),{activePage:d,limit:p,sort:m}=Object(F.a)((e=>u(e,c))),[f,b]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Ru(e,p)}:t))}),[p]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(Pu.a)({factoryQueryType:Lj.g.tls,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:TO,abort:o}),j=Object(r.useMemo)((()=>({endDate:e,tls:h.edges,id:n,inspect:x,isInspected:!1,loadPage:g,pageInfo:h.pageInfo,refetch:E,startDate:l,totalCount:h.totalCount})),[e,n,x,E,h.edges,h.pageInfo,h.totalCount,l,g]);return Object(r.useEffect)((()=>{b((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:Lj.g.tls,filterQuery:Object(wd.a)(t),flowTarget:a,ip:s,pagination:Ru(d,p),timerange:{interval:"12h",from:l,to:e},sort:m};return T()(n,r)?n:r}))}),[d,i,e,t,p,l,m,a,s,n]),Object(r.useEffect)((()=>{!o&&f&&v(f)}),[f,v,o]),[y,j]})({endDate:e,filterQuery:t,flowTarget:a,id:d,indexNames:n,ip:i,skip:m,startDate:c,type:u});return s.a.createElement(qO,{data:v,id:g,inspect:y,isInspect:h,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",x),loading:b,loadPage:j,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",x),refetch:S,setQuery:o,setQuerySkip:f,totalCount:E,type:u})};$O.displayName="TlsQueryTabBodyComponent";const VO=s.a.memo($O),UO=(Y.i18n.translate("xpack.securitySolution.networkUsers.errorSearchDescription",{defaultMessage:"An error has occurred on network users search"}),Y.i18n.translate("xpack.securitySolution.networkUsers.failSearchDescription",{defaultMessage:"Failed to run search on network users"})),HO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.usersTitle",{defaultMessage:"Users"}),QO=e=>Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),GO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userNameTitle",{defaultMessage:"User"}),WO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userIdTitle",{defaultMessage:"ID"}),ZO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupNameTitle",{defaultMessage:"Group name"}),KO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupIdTitle",{defaultMessage:"Group ID"}),JO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.documentCountTitle",{defaultMessage:"Document count"}),YO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),XO=Y.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ek=pt.c.NetworkDetailsTableType.users,tk=[{text:YO,numberOfRow:5},{text:XO,numberOfRow:10}],ak="users-table",nk=({data:e,fakeTotalCount:t,flowTarget:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:u,showMorePagesIndicator:d,totalCount:p,type:m})=>{const f=Object(c.useDispatch)(),b=Object(r.useMemo)((()=>pt.e.usersSelector()),[]),{activePage:g,sort:y,limit:h}=Object(F.a)(b),v=Object(r.useCallback)((e=>f(pt.b.updateNetworkTable({networkType:m,tableType:ek,updates:{limit:e}}))),[f,m]),E=Object(r.useCallback)((e=>f(pt.b.updateNetworkTable({networkType:m,tableType:ek,updates:{activePage:e}}))),[f,m]),x=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:sk(t[t.length-1]),direction:e.sort.direction};T()(a,y)||f(pt.b.updateNetworkTable({networkType:m,tableType:ek,updates:{sort:a}}))}}),[f,y,m]),j=Object(r.useMemo)((()=>((e,t)=>[{field:"node.user.name",name:GO,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:a=>Object(pu.b)({values:a?[a]:void 0,fieldName:"user.name",idPrefix:`${t}-table-${e}-user`})},{field:"node.user.id",name:WO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(pu.b)({values:a,fieldName:"user.id",idPrefix:`${t}-table-${e}`})},{field:"node.user.groupName",name:ZO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(pu.b)({values:a,fieldName:"user.group.name",idPrefix:`${t}-table-${e}`})},{field:"node.user.groupId",name:KO,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(pu.b)({values:a,fieldName:"user.group.id",idPrefix:`${t}-table-${e}`})},{align:"right",field:"node.user.count",name:JO,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(Jc.a)(e)}])(a,ak)),[a,ak]);return s.a.createElement(lu,{activePage:g,columns:j,dataTestSubj:`table-${ek}`,showMorePagesIndicator:d,headerCount:p,headerTitle:HO,headerUnit:QO(p),id:n,isInspect:i,itemsPerRow:tk,limit:h,loading:o,loadPage:l,onChange:x,pageOfItems:e,setQuerySkip:u,sorting:rk(y),totalCount:t,updateActivePage:E,updateLimitPagination:v})};nk.displayName="UsersTableComponent";const ik=s.a.memo(nk),rk=e=>{switch(e.field){case rt.t.name:case rt.t.count:return{field:`node.user.${e.field}`,direction:e.direction}}return Object(Yr.a)(e.field)},sk=e=>{switch(e){case rt.t.name.valueOf():return rt.t.name;case rt.t.count.valueOf():return rt.t.count;default:return rt.t.name}},ok=Object($a.a)(ik),lk=({endDate:e,filterQuery:t,flowTarget:a,ip:n,setQuery:i,skip:o,startDate:c,type:u})=>{const d=`networkUsersQuery-${u}`,{toggleStatus:p}=Object(Er.a)(d),[m,f]=Object(r.useState)(o||!p);Object(r.useEffect)((()=>{f(o||!p)}),[o,p]);const[b,{id:g,inspect:y,isInspected:v,networkUsers:E,totalCount:x,pageInfo:j,loadPage:S,refetch:O}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,ip:i,skip:s,startDate:o})=>{const c=Object(r.useMemo)((()=>pt.e.usersSelector()),[]),{activePage:u,sort:d,limit:p}=Object(F.a)(c),{uiSettings:m}=Object(h.i)().services,f=m.get(l.I),[b,g]=Object(r.useState)(null),y=Object(r.useCallback)((e=>{g((t=>t?{...t,pagination:Ru(e,p)}:t))}),[p]),{loading:v,result:E,search:x,refetch:j,inspect:S}=Object(Pu.a)({factoryQueryType:Lj.g.users,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:UO,abort:s}),O=Object(r.useMemo)((()=>({endDate:e,networkUsers:E.edges,id:n,inspect:S,isInspected:!1,loadPage:y,pageInfo:E.pageInfo,refetch:j,startDate:o,totalCount:E.totalCount})),[e,n,S,j,E.edges,E.pageInfo,E.totalCount,o,y]);return Object(r.useEffect)((()=>{g((n=>{const r={...null!=n?n:{},ip:i,defaultIndex:f,factoryQueryType:Lj.g.users,filterQuery:Object(wd.a)(t),flowTarget:a,pagination:Ru(u,p),sort:d,timerange:{interval:"12h",from:o,to:e}};return T()(n,r)?n:r}))}),[u,f,e,t,p,o,d,i,a]),Object(r.useEffect)((()=>{!s&&b&&x(b)}),[b,x,s]),[v,O]})({endDate:e,filterQuery:t,flowTarget:a,id:d,ip:n,skip:m,startDate:c});return s.a.createElement(ok,{data:E,id:g,inspect:y,isInspect:v,flowTarget:a,fakeTotalCount:Object(A.getOr)(50,"fakeTotalCount",j),loading:b,loadPage:S,showMorePagesIndicator:Object(A.getOr)(!1,"showMorePagesIndicator",j),refetch:O,setQuery:i,setQuerySkip:f,totalCount:x,type:u})};lk.displayName="UsersQueryTable";const ck=s.a.memo((({flowTarget:e,indexPattern:t,networkDetailsFilter:a,...n})=>{const i={...n,type:pt.c.NetworkType.details},r={...i,indexPattern:t},o={...i,flowTarget:e};return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.flows})`},s.a.createElement(s.a.Fragment,null,s.a.createElement(Zj,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(wO,bo()({},r,{flowTarget:Lj.b.source}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(wO,bo()({},r,{flowTarget:Lj.b.destination})))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Zj,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ES,bo()({},r,{flowTarget:Lj.b.source}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ES,bo()({},r,{flowTarget:Lj.b.destination})))))),s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.users})`},s.a.createElement(lk,o)),s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.http})`},s.a.createElement(sO,i)),s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.tls})`},s.a.createElement(VO,o)),s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.anomalies})`},s.a.createElement(Gd,bo()({},o,{hideHistogramIfEmpty:!0,AnomaliesTableComponent:Rj}))),s.a.createElement(K.a,{path:`${Gj}/:flowTarget/:tabName(${Tj.a.events})`},s.a.createElement(yb,bo()({additionalFilters:a},i,{tableId:W.e.networkPageEvents}))))}));ck.displayName="UsersDetailsTabs";const uk=Object($a.a)(jj.a),dk=()=>{const e=Object(c.useDispatch)(),t=Object(ju.a)(),{to:a,from:n,setQuery:i,isInitializing:o}=Object(xe.a)(),{detailName:l,flowTarget:u}=Object(k.useParams)(),d=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),p=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),{signalIndexName:m}=Object(oy.a)(),{hasKibanaREAD:f,hasIndexRead:b}=Object(Jl.a)(),g=f&&b,y=Object(F.a)(d),v=Object(F.a)(p),x=pt.c.NetworkType.details,j=Object(r.useCallback)(((t,a)=>{const n=Object(Iv.a)(t,a);e(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:n.from,to:n.to}))}),[e]),{services:{uiSettings:O}}=Object(h.i)();Object(r.useEffect)((()=>{e(Object(kj.setNetworkDetailsTablesActivePageToZero)())}),[l,e]);const{indicesExist:w,indexPattern:T,selectedPatterns:I,sourcererDataView:C}=Object(E.d)(),M=Object(Oj.b)(l),A=Object(r.useMemo)((()=>Object(Fb.e)(M)),[M]),[D,N]=Object(r.useMemo)((()=>{try{return[Object(za.buildEsQuery)(T,[y],[...A,...v],Object(Ro.getEsQueryConfig)(O))]}catch(e){return[void 0,e]}}),[v,T,A,y,O]),R=JSON.stringify(D);Object(Bo.a)({id:Sj.a,filterQuery:R,kqlError:N,query:y,startDate:n,endDate:a});const[L,{id:B,inspect:z,networkDetails:q,refetch:$}]=Object(Sj.b)({skip:o,filterQuery:R,indexNames:I,ip:M}),{jobNameById:V}=Object(Nd.a)(),U=Object(r.useMemo)((()=>Object.keys(V)),[V]),[H,Q]=Object(Wd.a)({criteriaFields:Object(cj.a)(l,u),startDate:n,endDate:a,skip:o,jobIds:U,aggregationInterval:"auto"}),G=Object(r.useMemo)((()=>({field:`${u}.ip`,value:l})),[l,u]);return s.a.createElement("div",{"data-test-subj":"network-details-page"},w?s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,null,s.a.createElement(ht,{sourcererDataView:C,id:Ee.a.global})),s.a.createElement(S.a,null,s.a.createElement(oo,{border:!0,"data-test-subj":"network-details-headline",subtitle:s.a.createElement(Xc,{indexKey:rt.j.ipDetails,indexNames:I,ip:M}),title:s.a.createElement(sr.c,{data:{value:M,field:`${u}.ip`},mode:sr.a.HOVER_DOWN,visibleCellActions:5,triggerId:sr.d.DEFAULT},M)},s.a.createElement(xj,{flowTarget:u})),s.a.createElement(uk,{id:B,inspect:z,ip:M,isInDetailsSidePanel:!1,data:q,anomaliesData:Q,loading:L,isLoadingAnomaliesData:H,type:x,flowTarget:u,refetch:$,setQuery:i,startDate:n,endDate:a,narrowDateRange:j,indexPatterns:I,jobNameById:V}),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiSpacer,null),g&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(sy,{signalIndexName:m,entityFilter:G,additionalFilters:D?[D]:[]})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Sy,{entityFilter:G,signalIndexName:m,additionalFilters:D?[D]:[]}))),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(Wc,{navTabs:Cj(M,Object(Zd.a)(t),u)}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ck,{ip:M,endDate:a,startDate:n,filterQuery:R,indexNames:I,skip:o||!!N,setQuery:i,indexPattern:T,flowTarget:u,networkDetailsFilter:A}))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.network}))};dk.displayName="NetworkDetailsComponent";const pk=s.a.memo(dk);var mk=a(234),fk=a.n(mk),bk=a(105);const gk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),yk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),hk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),vk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),Ek=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),xk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),jk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),Sk=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),Ok=Y.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"}),kk=Y.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),wk=Y.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),Tk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"}),Ik=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),Ck=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),Mk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),_k=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),Ak=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),Fk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),Pk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),Dk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),Nk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),Rk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),Lk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),Bk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),zk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),qk=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),$k=Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"}),Vk=Object(ee.euiPaletteColorBlind)(),Uk={"host.name":Ik,"source.ip":Ck,"source.domain":Fk,"source.geo.country_iso_code":Rk,"source.as.organization.name":Lk},Hk={"host.name":Ik,"destination.ip":Mk,"destination.domain":Pk,"destination.geo.country_iso_code":Rk,"destination.as.organization.name":Lk},Qk={"host.name":Ik,"client.ip":_k,"client.domain":Dk,"client.geo.country_iso_code":Rk,"client.as.organization.name":Lk},Gk={"host.name":Ik,"server.ip":Ak,"server.domain":Nk,"server.geo.country_iso_code":Rk,"server.as.organization.name":Lk},Wk={...Uk,...Hk,...Qk,...Gk},Zk="sum_of_source.bytes",Kk={source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(Qk),label:xk},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(Gk),label:jk}},Jk={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(Uk),label:vk},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(Hk),label:Ek}},"apm-*":Kk,"traces-apm*,logs-apm*,metrics-apm*,apm-*":Kk},Yk=e=>[{sourceDescriptor:{type:bk.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:Object(Ma.v4)(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:bk.LAYER_TYPE.EMS_VECTOR_TILE},...e.reduce(((e,{title:t,id:a})=>{var n,i,r,s,o;const l={id:Object(Ma.v4)(),label:t,sourceDescriptor:null,type:bk.LAYER_TYPE.LAYER_GROUP,visible:!0};return[...e,tw(t,a,l.id,null!==(n=Jk[t])&&void 0!==n?n:Jk.default),ew(t,a,l.id,null!==(i=null===(r=Jk[t])||void 0===r?void 0:r.destination)&&void 0!==i?i:Jk.default.destination),Xk(t,a,l.id,null!==(s=null===(o=Jk[t])||void 0===o?void 0:o.source)&&void 0!==s?s:Jk.default.source),l]}),[])],Xk=(e,t,a,n)=>({sourceDescriptor:{id:Object(Ma.v4)(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:n.geoField,filterByMapBounds:!1,tooltipProperties:n.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Vk[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:Object(Ma.v4)(),parent:a,label:`${e} | ${n.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:bk.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"},joins:[]}),ew=(e,t,a,n)=>({sourceDescriptor:{id:Object(Ma.v4)(),type:"ES_SEARCH",scalingType:bk.SCALING_TYPES.LIMIT,applyGlobalQuery:!0,geoField:n.geoField,filterByMapBounds:!0,tooltipProperties:n.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Vk[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:Object(Ma.v4)(),parent:a,label:`${e} | ${n.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:bk.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),tw=(e,t,a,n)=>({sourceDescriptor:{type:bk.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:Object(Ma.v4)(),indexPatternId:t,sourceGeoField:n.source.geoField,destGeoField:n.destination.geoField,metrics:[{type:"sum",field:n.source.metricField,label:n.source.metricField},{type:"sum",field:n.destination.metricField,label:n.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:Vk[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:Object(Ma.v4)(),parent:a,label:`${e} | ${Sk}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:bk.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),aw=ae()(ee.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-10c2ivb-0"})(["overflow:hidden;"]);aw.displayName="Panel";const nw=s.a.memo((({children:e})=>s.a.createElement("section",{className:"siemEmbeddable","data-test-subj":"siemEmbeddable"},s.a.createElement(aw,{paddingSize:"none",hasBorder:!0},e))));nw.displayName="Embeddable";var iw=a(106);const rw=()=>{const{docLinks:e}=Object(h.i)().services,t=`${Object(h.d)()}/app`;return s.a.createElement(ee.EuiEmptyPrompt,{iconType:"gisApp",title:s.a.createElement("h2",null,kk),titleSize:"xs",body:s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:s.a.createElement("a",{href:`${t}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:s.a.createElement("a",{href:`${e.links.libbeat.getStarted}`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:s.a.createElement(ee.EuiCode,null,"setup"),example:s.a.createElement(ee.EuiCode,null,"./packetbeat setup")}})),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:s.a.createElement(ee.EuiButton,{href:`${t}/management/kibana/dataViews`,color:"primary",target:"_blank",fill:!0},wk)})};rw.displayName="IndexPatternsMissingPromptComponent";const sw=s.a.memo(rw);sw.displayName="IndexPatternsMissingPrompt",ae()(ee.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1qkenu9-0"})(["margin-right:",";"],jo.euiLightVars.euiSizeS).displayName="Icon";const ow=({featureIndex:e,totalFeatures:t,previousFeature:a,nextFeature:n})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"xs"},((e,t)=>Y.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:e,totalFeatures:t},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(e+1,t))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement("span",null,s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:a,iconType:"arrowLeft","aria-label":"Next",isDisabled:e<=0}),s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:n,iconType:"arrowRight","aria-label":"Next",isDisabled:e>=t-1})))));ow.displayName="ToolTipFooterComponent";const lw=s.a.memo(ow);lw.displayName="ToolTipFooter";var cw=a(1328);const uw=ae()(ee.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-c1u5cx-0"})(["height:45px;min-width:85px;"]),dw=ae()(ee.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-c1u5cx-1"})(["margin:0 auto;"]),pw=({contextId:e,featureProps:t})=>{const a=t.reduce(((e,t)=>{var a;const n=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{...e,[t.getPropertyKey()]:Array.isArray(n)?n:[n]}}),{}),n=Object.keys(a).includes(Zk);return s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(uw,{color:"hollow"},s.a.createElement(dw,{direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:!1},n?Bk:qk)))),s.a.createElement(cw.e,{contextId:e,destinationBytes:n?a["sum_of_destination.bytes"]:a["sum_of_server.bytes"],eventId:`map-line-tooltip-${e}`,sourceBytes:n?a[Zk]:a["sum_of_client.bytes"]}),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(uw,{color:"hollow"},s.a.createElement(dw,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},n?zk:$k)))))};pw.displayName="LineToolTipContentComponent";const mw=s.a.memo(pw);mw.displayName="LineToolTipContent";var fw=a(214);const bw=({contextId:e,featureProps:t})=>{const a=Object(r.useMemo)((()=>t.map((t=>{var a;const n=t.getPropertyKey(),i=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{title:Wk[n],description:s.a.createElement(s.a.Fragment,null,null!=i?s.a.createElement(hj.a,{rowItems:Array.isArray(i)?i:[i],attrName:n,idPrefix:`map-point-tooltip-${e}-${n}-${i}`,render:e=>yw(n,e)}):Object(Jc.d)())}}))),[e,t]);return s.a.createElement(fw.d,{listItems:a})};bw.displayName="PointToolTipContentComponent";const gw=s.a.memo(bw);gw.displayName="PointToolTipContent";const yw=(e,t)=>{if(""===t)return Object(Jc.f)(t);if(["host.name"].includes(e))return s.a.createElement($t.d,{hostName:t});if(["source.ip","destination.ip"].includes(e)){const a=e.split(".")[0];return s.a.createElement($t.h,{ip:t,flowTarget:a})}return s.a.createElement(s.a.Fragment,null,t)},hw=({closeTooltip:e,features:t=[],getLayerName:a,loadFeatureProperties:n,loadFeatureGeometry:i})=>{const[o,l]=Object(r.useState)(!0),[c,u]=Object(r.useState)(!1),[d,p]=Object(r.useState)(!1),[m,f]=Object(r.useState)(0),[b,g]=Object(r.useState)([]),[y,h]=Object(r.useState)(null),[,v]=Object(r.useState)(""),E=Object(r.useCallback)((()=>{null!=e&&(e(),f(0))}),[e]),x=Object(r.useCallback)((()=>{f((e=>e-1)),u(!0)}),[]),j=Object(r.useCallback)((()=>{f((e=>e+1)),u(!0)}),[]),S=Object(r.useMemo)((()=>d?s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(ee.EuiFlexItem,{grow:!1},Tk)):o&&!c?s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiLoadingSpinner,{size:"m"}))):s.a.createElement("div",null,null!=y&&"LineString"===y.type?s.a.createElement(mw,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:b}):s.a.createElement(gw,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:b}),t.length>1&&s.a.createElement(lw,{featureIndex:m,totalFeatures:t.length,previousFeature:x,nextFeature:j}),c&&s.a.createElement(eu.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"}))),[y,m,b,t,j,x,d,o,c]);return Object(r.useEffect)((()=>{0!==t.length&&null!=a&&null!=n&&null!=i&&(c||l(!0),p(!1),(async()=>{if(null!=t[m]){const e=t[m].layerId,r=t[m].id;try{const s=i({layerId:e,featureId:r}),[o,l]=await Promise.all([n({layerId:e,properties:t[m].mbProperties}),a(e)]);g(o),h(s),l&&v(l)}catch(e){p(!0)}finally{l(!1),u(!1)}}})())}),[m,t,a,c,i,n]),s.a.createElement(ee.EuiOutsideClickDetector,{onOutsideClick:E},S)};hw.displayName="MapToolTipComponent";const vw=s.a.memo(hw);vw.displayName="MapToolTip";const Ew="network_map_visbile",xw=ae.a.div.attrs((()=>({className:"siemEmbeddable__map"}))).withConfig({displayName:"EmbeddableMap",componentId:"sc-128e6d0-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],(({maintainRatio:e})=>e&&Object(te.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],(({theme:e})=>e.eui.euiBreakpoints.m)))),jw=ae()(ee.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-128e6d0-1"})(["margin-right:16px;"]),Sw=ae()(ee.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-128e6d0-2"})(["& .euiAccordion__triggerWrapper{padding:16px;}"]);xw.displayName="EmbeddableMap";const Ow=({endDate:e,filters:t,query:a,setQuery:n,startDate:i})=>{var o;const[l,c]=s.a.useState(void 0),{services:u}=Object(h.i)(),{storage:d}=u,[p,m]=Object(r.useState)(!1),[f,b]=Object(r.useState)(!1),[g,y]=Object(r.useState)(null===(o=d.get(Ew))||void 0===o||o),{addError:v}=Object(Pt.a)(),j=Object(r.useMemo)((()=>qg.d.getSourcererDataViewsSelector()),[]),{kibanaDataViews:S}=Object(F.a)((e=>j(e))),{selectedPatterns:O}=Object(E.d)(x.SourcererScopeName.default),k=(()=>{const{dataViews:e}=Object(h.i)().services.data;return Object(r.useMemo)((()=>fk()((async t=>{const a=(e=>{var t;const a=null!==(t=Jk[e])&&void 0!==t?t:Jk.default;return[a.source.metricField,a.source.geoField,a.destination.metricField,a.destination.geoField]})(t),n=(await e.getFieldsForWildcard({pattern:t,fields:a})).map((e=>e.name));return a.every((e=>n.includes(e)))}),((e,t)=>e[0]===t[0]))),[e])})(),[w,T]=Object(r.useState)([]),[I,C]=Object(r.useState)([]);Object(r.useEffect)((()=>{let e=!1;return I.length&&(async()=>{try{const t=await Promise.all(I.map((async({title:e})=>k(e)))),a=I.filter(((e,a)=>{var n;return null!==(n=t[a])&&void 0!==n&&n}));e||T(a)}catch(t){e||(T([]),v(t,{title:Ok}),m(!0))}})(),()=>{e=!0}}),[v,I,k]),Object(r.useEffect)((()=>{const e=S.filter((e=>O.includes(e.title)));O.length>0&&0===e.length&&b(!0),C((t=>Object(A.isEqual)(t,e)?t:e))}),[S,O]);const M=s.a.useMemo((()=>Object(je.c)()),[]);Object(r.useEffect)((()=>{let r=!0;return null==l&&O.length>0&&!f&&async function(){try{const o=await(async(e,t,a,n,i,r,o,l)=>{const c=l.getEmbeddableFactory(iw.MAP_SAVED_OBJECT_TYPE);if(!c)throw new Error("Map embeddable factory undefined");const u={title:hk,attributes:{title:""},id:Object(Ma.v4)(),filters:e,hidePanelTitles:!0,query:a,timeRange:{from:new Date(n).toISOString(),to:new Date(i).toISOString()},viewMode:pl.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},d=await c.create(u);if(!d)throw new Error("Map embeddable is undefined");return Object(pl.isErrorEmbeddable)(d)||(d.setRenderTooltipContent((({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:i,loadFeatureProperties:r,loadFeatureGeometry:l})=>{const c={addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:i,loadFeatureProperties:r,loadFeatureGeometry:l};return s.a.createElement(je.b,bo()({node:o},c))})),d.setLayerList(Yk(t))),r({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>d.reload()}),d})(t,w,a,i,e,n,M,u.embeddable);r&&c(o)}catch(e){r&&(v(e,{title:Ok}),m(!0))}}(),()=>{r=!1}}),[v,e,l,t,w,a,M,u.embeddable,O,n,i,f]),Object(r.useEffect)((()=>{null==l||Object(pl.isErrorEmbeddable)(l)||(async()=>{null!=l&&w.length&&(await l.setLayerList(Yk(w)),l.reload())})()}),[l,w]),Object(r.useEffect)((()=>{null!=l&&l.updateInput({query:a})}),[l,a]);const _=Object(r.useMemo)((()=>Object(zo.a)(i,e)),[i,e]);Object(r.useEffect)((()=>{null!=l&&l.updateInput({filters:[...t,..._]})}),[l,t,_]);const P=Object(r.useCallback)((e=>{d.set(Ew,e),y(e)}),[d]),D=Object(r.useMemo)((()=>g?s.a.createElement(nw,null,s.a.createElement(je.a,{node:M},s.a.createElement(vw,null)),s.a.createElement(xw,{maintainRatio:!f},f?s.a.createElement(sw,{"data-test-subj":"missing-prompt"}):null!=l?s.a.createElement(pl.EmbeddablePanel,{embeddable:l}):s.a.createElement(eu.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"}))):null),[l,f,M,g]);return p?null:s.a.createElement(Sw,{"data-test-subj":"EmbeddedMapComponent",onToggle:P,id:"network-map",arrowDisplay:"right",arrowProps:{color:"primary","data-test-subj":`${g}-toggle-network-map`},buttonContent:s.a.createElement("strong",null,gk),extraAction:s.a.createElement(jw,{size:"xs"},s.a.createElement(ee.EuiLink,{href:`${u.docLinks.links.siem.networkMap}`,target:"_blank"},yk)),paddingSize:"none",initialIsOpen:g},D)};Ow.displayName="EmbeddedMapComponent";const kw=s.a.memo(Ow);kw.displayName="EmbeddedMap",Y.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"});const ww=Y.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"}),Tw="networkKpiDnsQuery",Iw=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null,lensAttributes:{title:"[Network] DNS metric",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",accessor:"0374e520-eae0-4ac1-bcfe-37565e7fc9e3",layerType:"data",colorMode:"None",autoScaleMetricAlignment:"left"},query:{query:"",language:"kuery"},filters:[{meta:{index:"196d783b-3779-4c39-898e-6606fe633d05",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"dns.question.name"}},{"term":{"suricata.eve.dns.type":{"value":"query"}}},{"exists":{"field":"zeek.dns.query"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"dns.question.name"}},{term:{"suricata.eve.dns.type":{value:"query"}}},{exists:{field:"zeek.dns.query"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columns:{"0374e520-eae0-4ac1-bcfe-37565e7fc9e3":{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["0374e520-eae0-4ac1-bcfe-37565e7fc9e3"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3"},{type:"index-pattern",name:"196d783b-3779-4c39-898e-6606fe633d05",id:"{dataViewId}"}]}}],description:Y.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],Cw=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Tw),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({dnsQueries:0,id:Tw,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g}=Object(Pt.a)(),y=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(d(!1),b((t=>({...t,dnsQueries:e.dnsQueries,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:ww}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.p.dns,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(y(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,y]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Iw,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},Mw=s.a.memo(Cw),_w=(Y.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),Y.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"})),Aw="networkKpiNetworkEventsQuery",Fw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),Pw=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(ee.euiPaletteColorBlind)()[1],lensAttributes:{title:"[Network] Network events",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"eaadfec7-deaa-4aeb-a403-3b4e516416d2",accessor:"370ebd07-5ce0-4f46-a847-0e363c50d037",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"",language:"kuery"},filters:[{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"source.ip",value:"exists"},query:{exists:{field:"source.ip"}},$state:{store:"appState"}},{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"destination.ip",value:"exists"},query:{exists:{field:"destination.ip"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"eaadfec7-deaa-4aeb-a403-3b4e516416d2":{columns:{"370ebd07-5ce0-4f46-a847-0e363c50d037":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["370ebd07-5ce0-4f46-a847-0e363c50d037"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-eaadfec7-deaa-4aeb-a403-3b4e516416d2"},{type:"index-pattern",name:"861af17d-be25-45a3-a82d-d6e697b76e51",id:"{dataViewId}"},{type:"index-pattern",name:"09617767-f732-410e-af53-bebcbd0bf4b9",id:"{dataViewId}"}]}}],description:Fw}],Dw=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Aw),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({networkEvents:0,id:Aw,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g}=Object(Pt.a)(),y=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(d(!1),b((t=>({...t,networkEvents:e.networkEvents,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:_w}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.p.networkEvents,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(y(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,y]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Pw,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},Nw=s.a.memo(Dw),Rw=(Y.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),Y.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"})),Lw="networkKpiTlsHandshakesQuery",Bw=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null,lensAttributes:{title:"[Network] TLS handshakes",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"1f48a633-8eee-45ae-9471-861227e9ca03",accessor:"21052b6b-5504-4084-a2e2-c17f772345cf",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"(source.ip: * or destination.ip: *) and (tls.version: * or suricata.eve.tls.version: * or zeek.ssl.version: * )",language:"kuery"},filters:[{meta:{index:"32ee22d9-2e77-4aee-8073-87750e92c3ee",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}},{meta:{index:"1e93f984-9374-4755-a198-de57751533c6",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"tls.version"}},{"exists":{"field":"suricata.eve.tls.version"}},{"exists":{"field":"zeek.ssl.version"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"tls.version"}},{exists:{field:"suricata.eve.tls.version"}},{exists:{field:"zeek.ssl.version"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"1f48a633-8eee-45ae-9471-861227e9ca03":{columns:{"21052b6b-5504-4084-a2e2-c17f772345cf":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["21052b6b-5504-4084-a2e2-c17f772345cf"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-1f48a633-8eee-45ae-9471-861227e9ca03"}]}}],description:Y.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],zw=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Lw),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({tlsHandshakes:0,id:Lw,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g}=Object(Pt.a)(),y=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(d(!1),b((t=>({...t,tlsHandshakes:e.tlsHandshakes,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:Rw}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.p.tlsHandshakes,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(y(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,y]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Bw,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},qw=s.a.memo(zw),$w=(Y.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),Y.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"})),Vw="networkKpiUniqueFlowsQuery",Uw=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null,lensAttributes:{title:"[Network] Unique flow IDs",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"5d46d48f-6ce8-46be-a797-17ad50642564",accessor:"a27f3503-9c73-4fc1-86bb-12461dae4b70",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"source.ip: * or destination.ip: * ",language:"kuery"},filters:[{meta:{index:"c01edc8a-90ce-4d49-95f0-76954a034eb2",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"5d46d48f-6ce8-46be-a797-17ad50642564":{columns:{"a27f3503-9c73-4fc1-86bb-12461dae4b70":{label:" ",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"network.community_id",isBucketed:!1,customLabel:!0}},columnOrder:["a27f3503-9c73-4fc1-86bb-12461dae4b70"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-5d46d48f-6ce8-46be-a797-17ad50642564"}]}}],description:Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],Hw=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Vw),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({uniqueFlowId:0,id:Vw,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g}=Object(Pt.a)(),y=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(d(!1),b((t=>({...t,uniqueFlowId:e.uniqueFlowId,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:$w}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.p.uniqueFlows,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(y(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,y]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:Uw,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},Qw=s.a.memo(Hw),Gw=(Y.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),Y.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"})),Ww="networkKpiUniquePrivateIpsQuery",Zw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),Kw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),Jw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),Yw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),Xw=Y.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),eT={title:"[Network] Unique private IPs - area chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"area",layers:[{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"area",accessors:["5f317308-cfbb-4ee5-bfb9-07653184fabf"],layerType:"data",xAccessor:"662cd5e5-82bf-4325-a703-273f84b97e09",yConfig:[{forAccessor:"5f317308-cfbb-4ee5-bfb9-07653184fabf",color:"#d36186"}]},{layerId:"72dc4b99-b07d-4dc9-958b-081d259e11fa",seriesType:"area",accessors:["ac1eb80c-ddde-46c4-a90c-400261926762"],layerType:"data",xAccessor:"36444b8c-7e10-4069-8298-6c1b46912be2",yConfig:[{forAccessor:"ac1eb80c-ddde-46c4-a90c-400261926762",color:"#9170b8"}]}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"662cd5e5-82bf-4325-a703-273f84b97e09":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5f317308-cfbb-4ee5-bfb9-07653184fabf":{label:wr.n,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",isBucketed:!1,customLabel:!0,filter:{query:'"source.ip": "10.0.0.0/8" or "source.ip": "192.168.0.0/16" or "source.ip": "172.16.0.0/12" or "source.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["662cd5e5-82bf-4325-a703-273f84b97e09","5f317308-cfbb-4ee5-bfb9-07653184fabf"],incompleteColumns:{}},"72dc4b99-b07d-4dc9-958b-081d259e11fa":{columns:{"36444b8c-7e10-4069-8298-6c1b46912be2":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"ac1eb80c-ddde-46c4-a90c-400261926762":{label:wr.i,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",isBucketed:!1,filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["36444b8c-7e10-4069-8298-6c1b46912be2","ac1eb80c-ddde-46c4-a90c-400261926762"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-72dc4b99-b07d-4dc9-958b-081d259e11fa"}]},tT={title:"[Network] Unique private IPs - bar chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar_horizontal_stacked",layers:[{layerId:"e406bf4f-942b-41ac-b516-edb5cef06ec8",accessors:["5acd4c9d-dc3b-4b21-9632-e4407944c36d"],position:"top",seriesType:"bar_horizontal_stacked",showGridlines:!1,layerType:"data",yConfig:[{forAccessor:"5acd4c9d-dc3b-4b21-9632-e4407944c36d",color:"#d36186"}],xAccessor:"d9c438c5-f776-4436-9d20-d62dc8c03be8"},{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"bar_horizontal_stacked",accessors:["d27e0966-daf9-41f4-9033-230cf1e76dc9"],layerType:"data",yConfig:[{forAccessor:"d27e0966-daf9-41f4-9033-230cf1e76dc9",color:"#9170b8"}],xAccessor:"4607c585-3af3-43b9-804f-e49b27796d79"}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"e406bf4f-942b-41ac-b516-edb5cef06ec8":{columns:{"5acd4c9d-dc3b-4b21-9632-e4407944c36d":{label:Object(wr.q)("source.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}},"d9c438c5-f776-4436-9d20-d62dc8c03be8":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{language:"kuery",query:"source.ip: *"},label:wr.n}]}}},columnOrder:["d9c438c5-f776-4436-9d20-d62dc8c03be8","5acd4c9d-dc3b-4b21-9632-e4407944c36d"],incompleteColumns:{}},"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"d27e0966-daf9-41f4-9033-230cf1e76dc9":{label:Object(wr.q)("destination.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}},"4607c585-3af3-43b9-804f-e49b27796d79":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{language:"kuery",query:"destination.ip: *"},label:wr.i}]}}},columnOrder:["4607c585-3af3-43b9-804f-e49b27796d79","d27e0966-daf9-41f4-9033-230cf1e76dc9"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-e406bf4f-942b-41ac-b516-edb5cef06ec8"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"}]},aT=Object(ee.euiPaletteColorBlind)(),nT=[{key:"uniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:Yw,description:Kw,color:aT[2],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}},{key:"uniqueDestinationPrivateIps",value:null,name:Xw,description:Jw,color:aT[3],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{language:"kuery",query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"'}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}}],description:Zw,enableAreaChart:!0,enableBarChart:!0,areaChartLensAttributes:eT,barChartLensAttributes:tT}],iT=({filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:i,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Er.a)(Ww),[u,d]=Object(r.useState)(l||!c),p=Object(ve.a)("chartEmbeddablesEnabled");Object(r.useEffect)((()=>{d(l||!c)}),[l,c]);const[m,{refetch:f,id:b,inspect:g,...y}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{data:s}=Object(h.i)().services,o=Object(r.useRef)(A.noop),l=Object(r.useRef)(new AbortController),c=Object(r.useRef)(new Ie.Subscription),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(null),[f,b]=Object(r.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:Ww,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:g}=Object(Pt.a)(),y=Object(r.useCallback)((e=>{if(null==e||n)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ro.isRunningResponse)(e)||(d(!1),b((t=>({...t,uniqueDestinationPrivateIps:e.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:e.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:e.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:e.uniqueSourcePrivateIpsHistogram,inspect:Object(Tb.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),g(e,{title:Gw}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,g,n]);return Object(r.useEffect)((()=>{m((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:rt.p.uniquePrivateIps,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}};return T()(n,r)?n:r}))}),[a,t,e,i]),Object(r.useEffect)((()=>(y(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,y]),Object(r.useEffect)((()=>{n&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[n]),[u,f]})({filterQuery:e,endDate:n,indexNames:a,startDate:t,skip:u||p}),{session:v,refetchByRestartingSession:E}=Object(mg.a)({inputId:Ee.a.global,queryId:b});return s.a.createElement(sg,{data:y,id:b,inspect:g,loading:m,fieldsMapping:nT,from:t,to:n,updateDateRange:i,refetch:p?E:f,setQuery:o,setQuerySkip:d,session:p?v:void 0})},rT=s.a.memo(iT),sT=s.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:i,skip:r,updateDateRange:o})=>s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Nw,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Mw,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r}))),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFlexGroup,{wrap:!0},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Qw,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(qw,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})))),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(rT,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:i,skip:r})))));sT.displayName="NetworkKpiComponent";const oT=ae.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-v7oybx-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),lT=s.a.memo((({hasMlUserPermissions:e,capabilitiesFetched:t})=>{const a=Object(c.useDispatch)(),n=Object(r.useRef)(null),i=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),o=Object(F.b)((e=>{var t;return(null!==(t=i(e,W.e.networkPageEvents))&&void 0!==t?t:W.q).graphEventId})),l=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),u=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),d=Object(F.a)(u),p=Object(F.a)(l),{to:m,from:f,setQuery:b,isInitializing:g}=Object(xe.a)(),{globalFullScreen:y}=Object(Vt.a)(),v=Object(h.i)(),{tabName:x}=Object(k.useParams)(),j=v.services.application.capabilities.maps.show,O=Object(r.useMemo)((()=>x===Bj.a.events?[...p,...Fb.h]:p),[x,p]),w=Object(r.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{indicesExist:T,indexPattern:I,selectedPatterns:C,sourcererDataView:M}=Object(E.d)(),D=Object(r.useCallback)((()=>{var e,t;null===(e=n.current)||void 0===e||null===(t=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===t||t.focus()}),[n]),N=Object(r.useCallback)((()=>{Object(Ht.m)()}),[]),R=Object(r.useCallback)((e=>{Object(ne.isTab)(e)&&Object(Ht.l)({containerElement:n.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:D,onSkipFocusAfterEventsTable:N})}),[n,D,N]),[L,B]=Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(v.services.uiSettings),indexPattern:I,queries:[d],filters:p}),[z]=Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(v.services.uiSettings),indexPattern:I,queries:[d],filters:O});return Object(Bo.a)({id:"NetworkQueryId",filterQuery:L,kqlError:B,query:d,startDate:f,endDate:m}),s.a.createElement(s.a.Fragment,null,T?s.a.createElement(oT,{onKeyDown:R,ref:n},s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:y,graphEventId:o})},s.a.createElement(ht,{sourcererDataView:M,id:Ee.a.global})),s.a.createElement(S.a,{noPadding:y},s.a.createElement(Ut,{show:!y},s.a.createElement(oo,{subtitle:s.a.createElement(Xc,{indexKey:rt.j.network,indexNames:C}),title:wj.h,border:!0}),j&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0,paddingSize:"none","data-test-subj":"conditional-embeddable-map"},s.a.createElement(kw,{query:d,filters:p,startDate:f,endDate:m,setQuery:b})),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(sT,{filterQuery:L,from:f,indexNames:C,updateDateRange:w,setQuery:b,skip:g||void 0===L,to:m})),t&&!g?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ut,{show:!y},s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Wc,{navTabs:eS(e)}),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(Kj,{filterQuery:z,from:f,isInitializing:g,indexPattern:I,indexNames:C,setQuery:b,type:pt.c.NetworkType.page,to:m})):s.a.createElement(Yj,null))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.network}))}));lT.displayName="NetworkComponent";const cT=s.a.memo(lT),uT=s.a.memo((()=>{const{path:e}=Object(k.useRouteMatch)();return s.a.createElement(K.c,null,s.a.createElement(K.a,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(gx.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Tx(t.query));const a=Object(gx.stringify)(vl.url.encodeQuery(t),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ob}?${a}`})}}),s.a.createElement(K.a,{path:`${e}/ip/:ip`,render:({location:e,match:{params:{ip:t}}})=>{const a=Object(gx.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Tx(a.query)),Ix(t)){const e=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ob}?${e}`})}if(Cx(t)){const e=Mx(t);a.query=xx(["source.ip","destination.ip"],e,a.query||"");const n=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ob}?${n}`})}{const e=Object(gx.stringify)(vl.url.encodeQuery(a),{sort:!1,encode:!1});return s.a.createElement(k.Redirect,{to:`${l.Ob}/ip/${t}?${e}`})}}}),s.a.createElement(K.a,{path:`${l.Ob}/ml-network/`,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{from:`${l.Ob}/ml-network/`,to:{pathname:`${l.Ob}/ml-network`,search:e}})}))}));uT.displayName="MlNetworkConditionalContainer";const dT=(e,t)=>`${l.Ob}/ip/${e}/${t||rt.g.source}/${Bj.a.flows}`,pT=()=>{const e=Object(ju.a)(),t=e.capabilitiesFetched,a=Object(r.useMemo)((()=>Object(Zd.a)(e)),[e]),n=Object(r.useMemo)((()=>((e,t)=>e&&!t?Uj:Vj)(t,a)),[t,a]);return s.a.createElement(K.c,null,s.a.createElement(K.a,{exact:!0,strict:!0,path:l.Ob,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:{pathname:`${l.Ob}/${Bj.a.flows}`,search:e}})}),s.a.createElement(K.a,{path:`${l.Ob}/ml-network`},s.a.createElement(uT,null)),s.a.createElement(K.a,{strict:!0,path:n},s.a.createElement(cT,{capabilitiesFetched:e.capabilitiesFetched,hasMlUserPermissions:a})),s.a.createElement(K.a,{path:Wj},s.a.createElement(pk,null)),s.a.createElement(K.a,{path:`${Gj}/:flowTarget(${Qj})?`,render:({match:{params:{detailName:e,flowTarget:t}},location:{search:a=""}})=>s.a.createElement(k.Redirect,{to:{pathname:dT(e,t),search:a}})}),s.a.createElement(K.a,null,s.a.createElement(k.Redirect,{to:{pathname:l.Ob}})))},mT=s.a.memo(pT),fT={display:"flex",margin:"auto"},bT=e=>function(t){return Object(Ws.jsx)(r.Suspense,{fallback:Object(Ws.jsx)(ee.EuiLoadingSpinner,{size:"xl",style:fT})},Object(Ws.jsx)(e,t))},gT=bT(Object(r.lazy)((()=>a.e(33).then(a.bind(null,1714))))),yT=(bT(Object(r.lazy)((()=>a.e(35).then(a.bind(null,1318))))),bT(Object(r.lazy)((()=>a.e(34).then(a.bind(null,1715))))),bT(Object(r.lazy)((()=>a.e(39).then(a.bind(null,1716)))))),hT=bT(Object(r.lazy)((()=>a.e(40).then(a.bind(null,1717)))));bT(Object(r.lazy)((()=>a.e(41).then(a.bind(null,1718)))));var vT=a(31),ET=a(35),xT=a(1);const jT=e=>{Object(ET.b)(xT.a.CLICK,`${xT.c.LANDING_CARD}${e}`)},ST=Y.i18n.translate("xpack.securitySolution.explore.landing.pageTitle",{defaultMessage:"Explore"}),OT=()=>{var e;const{links:t=[]}=null!==(e=Object(vT.c)(P.a.exploreLanding))&&void 0!==e?e:{},a=Object(ft.a)();return s.a.createElement(S.a,null,s.a.createElement(oo,{title:ST}),s.a.createElement(yT,{items:t,urlState:a,onLinkClick:jT}),s.a.createElement(_,{pageName:P.a.exploreLanding}))},kT=[{path:l.xb,exact:!0,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.exploreLanding},s.a.createElement(OT,null)))},{path:l.Ob,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.network},s.a.createElement(mT,null)))},{path:l.Lc,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.users},s.a.createElement(Av,null)))},{path:l.Ab,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.hosts},s.a.createElement(lj,null)))}],wT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnSessionStart",{defaultMessage:"Date started"}),TT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnExecutable",{defaultMessage:"Executable"}),IT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnNode",{defaultMessage:"Node"}),CT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnEntryUser",{defaultMessage:"User ID"}),MT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnInteractive",{defaultMessage:"Interactive"}),_T=Y.i18n.translate("xpack.securitySolution.kubernetes.columnContainer",{defaultMessage:"Container"}),AT=Y.i18n.translate("xpack.securitySolution.kubernetes.columnPod",{defaultMessage:"Pod"}),FT=[{columnHeaderType:Go.a,id:"process.entry_leader.start",initialWidth:Qo.b,display:wT},{columnHeaderType:Go.a,id:"process.entry_leader.executable",display:TT},{columnHeaderType:Go.a,id:"process.entry_leader.user.id",display:CT},{columnHeaderType:Go.a,id:"process.entry_leader.interactive",display:MT},{columnHeaderType:Go.a,id:"cloud.instance.name",display:IT},{columnHeaderType:Go.a,id:"orchestrator.resource.name",display:AT},{columnHeaderType:Go.a,id:"container.name",display:_T}],PT=s.a.memo((()=>{const{kubernetesSecurity:e,uiSettings:t}=Object(h.i)().services,{globalFullScreen:a}=Object(Vt.a)(),{indexPattern:n,sourcererDataView:i}=Object(E.d)(),{from:o,to:c}=Object(xe.a)(),u=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),d=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),p=Object(F.a)(d),m=Object(F.a)(u),[f,b]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(t),indexPattern:n,queries:[p],filters:m})),[m,n,t,p]);Object(Bo.a)({id:"kubernetesQuery",filterQuery:f,kqlError:b,query:p,startDate:o,endDate:c});const g=Object(r.useCallback)((e=>s.a.createElement(ix,{tableId:W.e.kubernetesPageSessions,endDate:c,pageFilters:[],startDate:o,filterQuery:e,columns:FT,defaultColumns:FT})),[o,c]);return s.a.createElement(S.a,{noPadding:!0},e.getKubernetesPage({filter:s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:a,graphEventId:void 0})},s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:i})),indexPattern:n,globalFilter:{filterQuery:f,startDate:o,endDate:c},renderSessionsView:g}),s.a.createElement(_,{pageName:l.yc.kubernetes}))}));PT.displayName="KubernetesContainer";const DT=[{path:l.Hb,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.kubernetes},s.a.createElement(PT,null)))}];var NT=a(241),RT=a(723);const LT=Y.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),BT="overviewHostQuery",zT=ae.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-soprzh-0"})(["margin-left:8px;min-width:100px;@media only screen and (min-width:1400px){min-width:200px;}"]),qT=({count:e,isGroupStat:t,isLoading:a,max:n})=>{const[i]=Object(h.o)(l.P),[o,c]=Object(r.useState)(!0);return Object(r.useEffect)((()=>{o&&!a&&c(!1)}),[a,o,c]),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1,justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},!o&&s.a.createElement(ee.EuiText,{color:t?"default":"subdued",size:t?"m":"s"},Rr()(e).format(i))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zT,null,a?s.a.createElement(ee.EuiSkeletonText,{"data-test-subj":"stat-value-loading-spinner",lines:1}):s.a.createElement(ee.EuiProgress,{color:t?"primary":"subdued",max:n,size:"m",value:e}))))};qT.displayName="StatValueComponent";const $T=s.a.memo(qT),VT=e=>{var t,a,n,i,r,o,l,c,u,d,p,m,f,b,g,y;return[{count:null!==(t=e.auditbeatAuditd)&&void 0!==t?t:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(a=e.auditbeatFIM)&&void 0!==a?a:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(n=e.auditbeatLogin)&&void 0!==n?n:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(i=e.auditbeatPackage)&&void 0!==i?i:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(r=e.auditbeatProcess)&&void 0!==r?r:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(o=e.auditbeatUser)&&void 0!==o?o:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(l=e.endgameDns)&&void 0!==l?l:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(c=e.endgameFile)&&void 0!==c?c:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(u=e.endgameImageLoad)&&void 0!==u?u:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(d=e.endgameNetwork)&&void 0!==d?d:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(p=e.endgameProcess)&&void 0!==p?p:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(m=e.endgameRegistry)&&void 0!==m?m:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(f=e.endgameSecurity)&&void 0!==f?f:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(b=e.filebeatSystemModule)&&void 0!==b?b:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(g=e.winlogbeatSecurity)&&void 0!==g?g:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(y=e.winlogbeatMWSysmonOperational)&&void 0!==y?y:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},UT=ae.a.div.withConfig({displayName:"HostStatsContainer",componentId:"sc-11y71zp-0"})([".accordion-button{width:100%;}"]),HT=[{groupId:"auditbeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],QT=ae.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-11y71zp-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),GT=ae.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-11y71zp-2"})(["margin-left:24px;"]),WT=ae()(ee.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-11y71zp-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),ZT=ae.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-11y71zp-4"})(["padding-top:8px;"]),KT=({data:e,loading:t})=>{const a=VT(e),n=a.reduce(((e,t)=>e+t.count),0);return s.a.createElement(UT,{"data-test-subj":"overview-hosts-stats"},HT.map(((e,i)=>{const r=a.filter((t=>e.statIds.includes(t.id))),o=r.reduce(((e,t)=>e+t.count),0);return s.a.createElement(s.a.Fragment,{key:e.groupId},s.a.createElement(ee.EuiHorizontalRule,{margin:"xs"}),s.a.createElement(ee.EuiAccordion,{id:`host-stat-accordion-group${e.groupId}`,buttonContent:s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,null,e.name)),s.a.createElement(WT,{grow:!1},s.a.createElement($T,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},s.a.createElement(ZT,null,r.map((e=>s.a.createElement(ee.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},s.a.createElement(QT,null,e.title))),s.a.createElement(WT,{"data-test-subj":`host-stat-${e.id}`,grow:!1},s.a.createElement(GT,null,s.a.createElement($T,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},JT=s.a.memo(KT),YT=Object($a.a)(JT),XT=({endDate:e,filterQuery:t,indexNames:a,startDate:n,setQuery:i})=>{const[o]=Object(h.o)(l.P),{toggleStatus:c,setToggleStatus:u}=Object(Er.a)(BT),[d,p]=Object(r.useState)(void 0===t||!c);Object(r.useEffect)((()=>{p(void 0===t||!c)}),[t,c]);const m=Object(r.useCallback)((e=>{u(e),p(!e)}),[p,u]),[f,{overviewHost:b,id:g,inspect:y,refetch:v}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{loading:s,result:o,search:l,refetch:c,inspect:u}=Object(Pu.a)({factoryQueryType:kd.g.overview,initialResult:{overviewHost:{}},errorMessage:LT,abort:n}),d=Object(r.useMemo)((()=>({endDate:t,overviewHost:o.overviewHost,id:BT,inspect:u,isInspected:!1,refetch:c,startDate:i})),[t,u,c,o.overviewHost,i]),p=Object(r.useMemo)((()=>({defaultIndex:a,factoryQueryType:kd.g.overview,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}})),[t,e,a,i]);return Object(r.useEffect)((()=>{n||l(p)}),[p,l,n]),[s,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:n,skip:d}),E=Object(r.useMemo)((()=>VT(b).reduce(((e,t)=>e+t.count),0)),[b]),x=Object(r.useMemo)((()=>Rr()(E).format(o)),[o,E]),j=Object(r.useMemo)((()=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})),[]),S=Object(r.useMemo)((()=>Object(A.isEmpty)(b)?s.a.createElement(s.a.Fragment,null,""):s.a.createElement(ms.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:E,formattedHostEventsCount:x}})),[x,E,b]);return s.a.createElement(ga.c,{show:c},s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(Li.a,{id:BT,subtitle:S,toggleStatus:c,toggleQuery:m,title:j,isInspectDisabled:void 0===t},s.a.createElement($t.l,{deepLinkId:P.a.hosts},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"}))),c&&s.a.createElement(YT,{loading:f,data:b,setQuery:i,id:g,inspect:y,refetch:v})))};XT.displayName="OverviewHostComponent";const eI=s.a.memo(XT),tI=(Y.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),Y.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"})),aI="overviewNetworkQuery",nI=e=>{var t,a,n,i,r,o,l,c,u;return[{count:null!==(t=e.auditbeatSocket)&&void 0!==t?t:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(a=e.filebeatCisco)&&void 0!==a?a:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(n=e.filebeatNetflow)&&void 0!==n?n:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(i=e.filebeatPanw)&&void 0!==i?i:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(r=e.filebeatSuricata)&&void 0!==r?r:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(o=e.filebeatZeek)&&void 0!==o?o:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(l=e.packetbeatDNS)&&void 0!==l?l:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(c=e.packetbeatFlow)&&void 0!==c?c:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(u=e.packetbeatTLS)&&void 0!==u?u:0,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},iI=[{groupId:"auditbeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],rI=ae.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-d9mimb-0"})([".accordion-button{width:100%;}"]),sI=ae.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-d9mimb-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),oI=ae.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-d9mimb-2"})(["margin-left:24px;"]),lI=ae()(ee.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-d9mimb-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),cI=ae.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-d9mimb-4"})(["padding-top:8px;"]),uI=({data:e,loading:t})=>{const a=nI(e),n=a.reduce(((e,t)=>e+t.count),0);return s.a.createElement(rI,{"data-test-subj":"overview-network-stats"},iI.map(((e,i)=>{const r=a.filter((t=>e.statIds.includes(t.id))),o=r.reduce(((e,t)=>e+t.count),0);return s.a.createElement(s.a.Fragment,{key:e.groupId},s.a.createElement(ee.EuiHorizontalRule,{margin:"xs"}),s.a.createElement(ee.EuiAccordion,{id:`network-stat-accordion-group${e.groupId}`,buttonContent:s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":`network-stat-group-${e.groupId}`,justifyContent:"spaceBetween",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,null,e.name)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($T,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},s.a.createElement(cI,null,r.map((e=>s.a.createElement(ee.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},s.a.createElement(sI,null,e.title))),s.a.createElement(lI,{"data-test-subj":`network-stat-${e.id}`,grow:!1},s.a.createElement(oI,null,s.a.createElement($T,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},dI=s.a.memo(uI),pI=Object($a.a)(dI),mI=({endDate:e,filterQuery:t,indexNames:a,startDate:n,setQuery:i})=>{const{formatUrl:o,search:c}=Object(y.l)(P.a.network),{navigateToApp:u}=Object(h.i)().services.application,[d]=Object(h.o)(l.P),{toggleStatus:p,setToggleStatus:m}=Object(Er.a)(aI),[f,b]=Object(r.useState)(void 0===t||!p);Object(r.useEffect)((()=>{b(void 0===t||!p)}),[t,p]);const g=Object(r.useCallback)((e=>{m(e),b(!e)}),[b,m]),[v,{overviewNetwork:E,id:x,inspect:j,refetch:S}]=(({filterQuery:e,endDate:t,indexNames:a,skip:n=!1,startDate:i})=>{const{loading:s,result:o,search:l,refetch:c,inspect:u}=Object(Pu.a)({factoryQueryType:kd.p.overview,initialResult:{overviewNetwork:{}},errorMessage:tI,abort:n}),d=Object(r.useMemo)((()=>({endDate:t,overviewNetwork:o.overviewNetwork,id:aI,inspect:u,isInspected:!1,refetch:c,startDate:i})),[t,u,c,o.overviewNetwork,i]),p=Object(r.useMemo)((()=>({defaultIndex:a,factoryQueryType:kd.p.overview,filterQuery:Object(wd.a)(e),timerange:{interval:"12h",from:i,to:t}})),[t,e,a,i]);return Object(r.useEffect)((()=>{n||l(p)}),[p,l,n]),[s,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:n,skip:f}),O=Object(r.useCallback)((e=>{e.preventDefault(),u(l.l,{deepLinkId:P.a.network,path:Object(y.g)(c)})}),[u,c]),k=Object(r.useMemo)((()=>nI(E).reduce(((e,t)=>e+t.count),0)),[E]),w=Object(r.useMemo)((()=>Rr()(k).format(d)),[d,k]),T=Object(r.useMemo)((()=>s.a.createElement($t.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:O,href:o(Object(y.g)())},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"}))),[O,o]),I=Object(r.useMemo)((()=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})),[]),C=Object(r.useMemo)((()=>Object(A.isEmpty)(E)?s.a.createElement(s.a.Fragment,null,""):s.a.createElement(ms.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:w,networkEventsCount:k}})),[w,k,E]);return s.a.createElement(ga.c,{show:p},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"overview-network-query"},s.a.createElement(s.a.Fragment,null,s.a.createElement(Li.a,{id:aI,subtitle:C,title:I,toggleStatus:p,toggleQuery:g,isInspectDisabled:void 0===t},T),p&&s.a.createElement(pI,{loading:v,data:E,id:x,inspect:j,setQuery:i,refetch:S}))))};mI.displayName="OverviewNetworkComponent";const fI=s.a.memo(mI),bI=({filters:e,from:t,indexNames:a,indexPattern:n,query:i,setQuery:o,to:c})=>{const{uiSettings:u}=Object(h.i)().services,[d,p]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(u),indexPattern:n,queries:[i],filters:[...e,...Object(Fb.b)(l.yc.hosts)]})),[e,n,i,u]),[m]=Object(r.useMemo)((()=>Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(u),indexPattern:n,queries:[i],filters:[...e,...Fb.h]})),[e,n,u,i]);return Object(Bo.a)({id:BT,filterQuery:d||m,kqlError:p,query:i,startDate:t,endDate:c}),s.a.createElement(ee.EuiFlexGroup,{direction:"row"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(eI,{endDate:c,filterQuery:d,indexNames:a,startDate:t,setQuery:o})),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(fI,{endDate:c,filterQuery:m,indexNames:a,startDate:t,setQuery:o})))},gI=s.a.memo(bI);var yI=a(212);const hI=Y.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"}),vI=Y.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),EI=Y.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),xI=Y.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),jI=Y.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),SI=Y.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),OI=Y.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),kI=Y.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),wI=Y.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),TI=Y.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),II=Y.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),CI=[{id:"favorites",label:hI,iconType:"starFilled"},{id:"recently-updated",label:EI,iconType:"documentEdit"}],MI=s.a.memo((({filterBy:e,setFilterBy:t})=>s.a.createElement(ee.EuiButtonGroup,{options:CI,idSelected:e,onChange:e=>{t(e)},isIconOnly:!0,legend:II})));MI.displayName="Filters";var _I=a(393),AI=a(162);const FI=s.a.memo((({onOpenTimeline:e,timeline:t,timeline:{title:a,savedObjectId:n}})=>{const i=Object(r.useCallback)((()=>e({duplicate:!1,timelineId:`${n}`})),[e,n]);return s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement(ee.EuiLink,{onClick:i},Object(AI.f)(t)?wI:a))}));FI.displayName="RecentTimelineHeader";var PI=a(666);const DI=ae()(ee.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-hm3nav-0"})(["margin-right:8px;"]),NI=ae()(ee.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-hm3nav-1"})(["margin-right:16px;"]),RI=s.a.memo((({count:e,icon:t,tooltip:a})=>s.a.createElement(ee.EuiToolTip,{content:a},s.a.createElement(NI,{alignItems:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(DI,{color:"subdued",size:"s",type:t})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{color:"subdued",size:"xs"},e))))));RI.displayName="IconWithCount";const LI=s.a.memo((({timeline:e})=>s.a.createElement("div",null,s.a.createElement(RI,{count:Object(AI.e)(e),icon:"pinFilled",tooltip:kI}),s.a.createElement(RI,{count:Object(AI.d)(e),icon:"editorComment",tooltip:jI}))));LI.displayName="RecentTimelineCounts";const BI=ae.a.div.withConfig({displayName:"ClampText",componentId:"sc-ehtgjx-0"})(["display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),zI=s.a.memo((({timeline:e,onOpenTimeline:t,isLastItem:a})=>{const n=Object(r.useCallback)((()=>t({duplicate:!0,timelineId:`${e.savedObjectId}`})),[t,e.savedObjectId]),i=Object(r.useCallback)((a=>s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween","data-test-subj":"overview-recent-timelines"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(FI,{onOpenTimeline:t,timeline:e}),s.a.createElement(LI,{timeline:e}),e.description&&e.description.length&&s.a.createElement(ee.EuiText,{color:"subdued",size:"xs"},s.a.createElement(BI,null,e.description))),a&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiToolTip,{content:e.timelineType===Lf.l.default?SI:OI},s.a.createElement(ee.EuiButtonIcon,{"aria-label":e.timelineType===Lf.l.default?SI:OI,"data-test-subj":"open-duplicate",isDisabled:null==e.savedObjectId,iconSize:"s",iconType:"copy",onClick:n,size:"s"}))))),[n,t,e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(PI.a,{render:i}),s.a.createElement(s.a.Fragment,null,!a&&s.a.createElement(ee.EuiSpacer,{size:"l"})))}));zI.displayName="RecentTimelinesItem";const qI=s.a.memo((({noTimelinesMessage:e,onOpenTimeline:t,timelines:a})=>{const n=Object(r.useMemo)((()=>a.map(((e,n)=>s.a.createElement(zI,{key:`${e.savedObjectId}-${e.title}`,timeline:e,onOpenTimeline:t,isLastItem:n===a.length-1})))),[t,a]);return 0===a.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},e)):s.a.createElement(s.a.Fragment,null,n)}));qI.displayName="RecentTimelines";const $I=({lines:e,placeholders:t})=>s.a.createElement(s.a.Fragment,null,[...Array(t).keys()].map(((a,n)=>s.a.createElement(s.a.Fragment,{key:n},s.a.createElement(ee.EuiSkeletonText,{lines:e}),n!==t-1&&s.a.createElement(ee.EuiSpacer,{size:"l"})))));$I.displayName="LoadingPlaceholdersComponent";const VI=s.a.memo($I);var UI=a(718);const HI=({filterBy:e})=>{const t=Object(c.useDispatch)(),a=Object(r.useCallback)((e=>t(Object(D.updateIsLoading)(e))),[t]),n=Object(r.useMemo)((()=>Object(AI.b)(t)),[t]),{formatUrl:i}=Object(y.l)(P.a.timelines),{navigateToApp:o}=Object(h.i)().services.application,u=Object(r.useCallback)((({duplicate:e,timelineId:t})=>{Object(AI.h)({duplicate:e,timelineId:t,updateIsLoading:a,updateTimeline:n})}),[a,n]),d=Object(r.useCallback)((e=>{e.preventDefault(),o(l.l,{deepLinkId:P.a.timelines})}),[o]),p="favorites"===e?vI:xI,m=Object(r.useMemo)((()=>s.a.createElement($t.f,{onClick:d,href:i("")},TI)),[d,i]),f=Object(r.useMemo)((()=>s.a.createElement(VI,{lines:2,placeholders:"favorites"===e?1:3})),[e]),{fetchAllTimeline:b,timelines:g,loading:v}=Object(_I.b)(),E=Lf.l.default,{timelineStatus:x}=Object(UI.a)({timelineType:E});return Object(r.useEffect)((()=>{b({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:Lf.f.updated,sortOrder:rt.b.desc},onlyUserFavorite:"favorites"===e,status:x,timelineType:E})}),[b,e,x,E]),s.a.createElement(s.a.Fragment,null,v?f:s.a.createElement(qI,{noTimelinesMessage:p,onOpenTimeline:u,timelines:null!=g?g:[]}),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}),s.a.createElement(ee.EuiText,{size:"xs"},m))};HI.displayName="StatefulRecentTimelinesComponent";const QI=s.a.memo(HI);var GI=a(1116),WI=a.n(GI);const ZI="en",KI=[],JI=s.a.memo((({children:e,title:t})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h2",null,t))),s.a.createElement(ee.EuiFlexItem,{grow:!1},e)),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}))));JI.displayName="SidebarHeader";const YI=Y.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),XI=Y.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),eC=Y.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"Security Solution advanced settings"}),tC=s.a.memo((()=>{var e;const{getUrlForApp:t,navigateToApp:a,capabilities:n}=Object(h.i)().services.application,i=null!==(e=n.management.kibana.settings)&&void 0!==e&&e,o=Object(r.useCallback)((()=>a("management",{path:"/kibana/settings"})),[a]);return s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},i?XI:YI,i&&s.a.createElement(s.a.Fragment,null," ",s.a.createElement($t.f,{onClick:o,href:`${t("management",{path:"/kibana/settings"})}`},eC),"."))}));tC.displayName="NoNews";const aC=({href:e,children:t})=>s.a.createElement(ee.EuiLink,{href:e,rel:"noopener nofollow noreferrer",target:"_blank"},t),nC=ae.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"sc-wdv9uf-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),iC=s.a.memo((({newsItem:e})=>{const{linkUrl:t,title:a,publishOn:n,description:i,imageUrl:r}=e;return(({publishOn:e,expireOn:t})=>ec()(Date.now()).isAfter(e)&&ec()(Date.now()).isBefore(t))(e)?s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement(aC,{href:t},a)),s.a.createElement(ee.EuiText,{color:"subdued",size:"xs"},s.a.createElement(Yc.e,{value:n}),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement("div",null,i),s.a.createElement(ee.EuiSpacer,{size:"l"}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement("div",null,r&&s.a.createElement(nC,{alt:a,className:"euiPanel",src:r})))):null}));iC.displayName="Post";const rC=({news:e})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(JI,{title:Cg.j}),null==e?s.a.createElement(VI,{lines:4,placeholders:5}):0===e.length?s.a.createElement(tC,null):e.map((e=>s.a.createElement(iC,{key:e.hash,newsItem:e}))));rC.displayName="NewsFeedComponent";const sC=s.a.memo(rC),oC=s.a.memo((({enableNewsFeedSetting:e,newsFeedSetting:t})=>{const a=Object(h.i)().services.newsfeed,[n]=Object(h.o)(e),[i]=Object(h.o)(t),[o,l]=Object(r.useState)(null),c=a&&n,u=(({newsFeedUrlSetting:e,getKibanaVersion:t})=>{return[null==e?void 0:e.trim().replace(/\/$/,""),`v${a=t(),null!==(n=null===(i=WI()(a))||void 0===i?void 0:i.version)&&void 0!==n?n:a}.json`].join("/");var a,n,i})({newsFeedUrlSetting:i,getKibanaVersion:()=>h.b.getKibanaVersion()});return Object(r.useEffect)((()=>{let e=!1;return c&&(async()=>{try{const t=await(async({newsFeedUrl:e})=>h.b.get().http.fetch(e,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:u});e||l((e=>{const t=(e=>{var t;return""===document.documentElement.lang?e:null!==(t=document.documentElement.lang)&&void 0!==t?t:e})(ZI);return null==e||null==e.items?KI:e.items.filter((e=>null!=e)).map((e=>{var a,n,i,r,s,o,l,c,u,d,p;return{description:null!==(a=null!==(n=Object(A.get)(t,e.description))&&void 0!==n?n:Object(A.get)(ZI,e.description))&&void 0!==a?a:"",expireOn:new Date(null!==(i=e.expire_on)&&void 0!==i?i:""),hash:null!==(r=e.hash)&&void 0!==r?r:Object(Ma.v4)(),imageUrl:null!==(s=null!==(o=Object(A.get)(t,e.image_url))&&void 0!==o?o:Object(A.get)(ZI,e.image_url))&&void 0!==s?s:null,linkUrl:null!==(l=null!==(c=Object(A.get)(t,e.link_url))&&void 0!==c?c:Object(A.get)(ZI,e.link_url))&&void 0!==l?l:"",publishOn:new Date(null!==(u=e.publish_on)&&void 0!==u?u:""),title:null!==(d=null!==(p=Object(A.get)(t,e.title))&&void 0!==p?p:Object(A.get)(ZI,e.title))&&void 0!==d?d:""}}))})(t))}catch{e||l([])}})(),()=>{e=!0}}),[c,u]),s.a.createElement(s.a.Fragment,null,c?s.a.createElement(sC,{news:o}):null)}));oC.displayName="StatefulNewsFeed";const lC=()=>{const{cases:e}=Object(h.i)().services,t=e.helpers.canUseCases([l.i]);return e.ui.getRecentCases({permissions:t,maxCasesToShow:3,owner:[l.i]})};lC.displayName="RecentCasesComponent";const cC=s.a.memo(lC),uC=s.a.memo((({recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})=>{const{cases:a}=Object(yI.b)().services,n=Object(r.useMemo)((()=>s.a.createElement(MI,{filterBy:e,setFilterBy:t})),[e,t]),i=a.helpers.canUseCases([l.i]).read;return s.a.createElement(ee.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"l"},i&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(cC,null)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(JI,{title:Cg.k},n),s.a.createElement(QI,{filterBy:e})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(oC,{enableNewsFeedSetting:l.ob,newsFeedSetting:l.Pb})))}));uC.displayName="Sidebar";const dC=s.a.memo((()=>{const[e,t]=Object(r.useState)("favorites");return s.a.createElement(uC,{recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})}));dC.displayName="StatefulSidebar";var pC=a(752),mC=a(733);const fC=Object(r.memo)((({onDismiss:e})=>{const{getUrlForApp:t}=Object(h.i)().services.application,a=Object(O.e)({name:"endpointList"}),n=t(l.l,{path:a}),i=Object(mC.a)(l.l,{path:a});return s.a.createElement(ee.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:s.a.createElement(s.a.Fragment,null,s.a.createElement("b",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security"}))},s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),s.a.createElement(ee.EuiButton,{onClick:i,href:n},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security"})),s.a.createElement(ee.EuiButtonEmpty,{onClick:e},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))}));fC.displayName="EndpointNotice";var bC=a(64),gC=a(152),yC=a(490);const hC=Y.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerPanelTitle",{defaultMessage:"No threat intelligence data"}),vC=Y.i18n.translate("xpack.securitySolution.overview.ctiDashboardEnableThreatIntel",{defaultMessage:"You need to enable threat intel sources in order to view data."}),EC=Y.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerButton",{defaultMessage:"Enable sources"}),xC=Y.i18n.translate("xpack.securitySolution.overview.ctiDashboardTitle",{defaultMessage:"Threat Intelligence"}),jC=(Y.i18n.translate("xpack.securitySolution.overview.ctiViewDasboard",{defaultMessage:"View dashboard"}),Y.i18n.translate("xpack.securitySolution.overview.ctiDashboardOtherDatasourceTitle",{defaultMessage:"Others"})),SC=Y.i18n.translate("xpack.securitySolution.overview.ctiLinkSource",{defaultMessage:"Source"});var OC=a(272);const kC="ctiEventCountQuery",wC=Object(gC.d)((e=>(({data:e,defaultIndex:t,timerange:a,signal:n})=>e.search.search({defaultIndex:t,factoryQueryType:yC.a.dataSource,timerange:a},{strategy:"securitySolutionSearchStrategy",abortSignal:n}))(e).pipe(Object(bC.filter)((e=>!Object(Ho.isRunningResponse)(e)))))),TC=({to:e,from:t,allTiDataSources:a,setQuery:n,deleteQuery:i})=>{const[s,o]=Object(r.useState)([]),[c,u]=Object(r.useState)(!1),{data:d,uiSettings:p}=Object(h.i)().services,m=p.get(l.U),{result:f,start:b,loading:g}=Object(gC.c)(wC);Object(r.useEffect)((()=>{b({data:d,timerange:e&&t?{to:e,from:t,interval:""}:void 0,defaultIndex:m})}),[e,t,b,d,m]),Object(r.useEffect)((()=>{var e,t;!g&&null!=f&&f.rawResponse&&null!=f&&f.inspect&&n&&n({id:kC,inspect:{dsl:null!==(e=null==f||null===(t=f.inspect)||void 0===t?void 0:t.dsl)&&void 0!==e?e:[],response:[JSON.stringify(f.rawResponse,null,2)]},loading:g,refetch:()=>{}})}),[n,g,f]),Object(r.useEffect)((()=>()=>{i&&i({id:kC})}),[i]),Object(r.useEffect)((()=>{f&&!c&&u(!0)}),[c,f]),Object(r.useEffect)((()=>{if(!g&&f){var e,t,n,i;const r=null!==(e=null==f||null===(t=f.rawResponse)||void 0===t||null===(n=t.aggregations)||void 0===n||null===(i=n.dataset)||void 0===i?void 0:i.buckets)&&void 0!==e?e:[],s=e=>{var t,a;return null==e||null===(t=e.buckets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.key},l=r.reduce(((e,t)=>{const a=s(null==t?void 0:t.name);if(a)return{...e,[t.key]:{dataset:null==t?void 0:t.key,name:a,dashboardId:s(null==t?void 0:t.dashboard),count:null==t?void 0:t.doc_count}};{var n,i,r;const a=OC.o,s=null!==(n=null===(i=e[a])||void 0===i?void 0:i.count)&&void 0!==n?n:0;return{...e,[a]:{dataset:a,name:jC,count:s+(null!==(r=null==t?void 0:t.doc_count)&&void 0!==r?r:0)}}}}),{});Array.isArray(a)&&a.forEach((e=>{l[e.dataset]||(l[e.dataset]={...e,count:0})})),o(Object.values(l))}}),[f,g,a]);const y=s.reduce(((e,t)=>e+t.count),0);return{tiDataSources:s,totalCount:y,isInitiallyLoaded:c}},IC=({http:e,tagIds:t},a)=>e.post(l.Cb,{version:"1",body:JSON.stringify({tagIds:t}),signal:a}),CC=({http:e,tagName:t},a)=>e.get(l.Fb,{version:"1",query:{name:t},signal:a}),MC=({savedObjectsTaggingClient:e,tag:t})=>e.create(t),_C=Y.i18n.translate("xpack.securitySolution.overview.linkPanelLearnMoreButton",{defaultMessage:"Learn More"}),AC=ae()(ee.EuiFlexGroup).withConfig({displayName:"ButtonContainer",componentId:"sc-1mnynj-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),FC=ae()(ee.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1mnynj-1"})(["padding:0;margin-top:",";margin-left:12px;transform:scale(",");"],(({theme:e})=>e.eui.euiSizeM),(({color:e})=>"primary"===e?1.4:1)),PC=ae()(ee.EuiSplitPanel.Inner).withConfig({displayName:"PanelContainer",componentId:"sc-1mnynj-2"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM)),DC=ae()(ee.EuiText).withConfig({displayName:"Title",componentId:"sc-1mnynj-3"})(["color:",";margin-bottom:",";"],(({theme:e,textcolor:t})=>"primary"===t?e.eui.euiColorPrimary:e.eui.euiColorWarningText),(({theme:e})=>e.eui.euiSizeM)),NC=({body:e,button:t,color:a,dataTestSubj:n,learnMoreLink:i,title:r})=>s.a.createElement(PC,{grow:!1,color:a},s.a.createElement(ee.EuiFlexGroup,{direction:"column","data-test-subj":n},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{direction:"row"},s.a.createElement(FC,{type:"primary"===a?"iInCircle":"help",size:"m",color:a}),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(DC,{"data-test-subj":"inner-link-panel-title",textcolor:a},r))),s.a.createElement("p",null,e," ",i&&s.a.createElement(ee.EuiLink,{href:i,target:"_blank","data-test-subj":`${n}-learn-more`,external:!0},_C))),t&&s.a.createElement(AC,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},t))));NC.displayName="InnerLinkPanel";const RC=ae()(ee.EuiBasicTable).withConfig({displayName:"StyledTable",componentId:"sc-1uwt3ks-0"})(["[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:0;}tr:hover{[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:1;}}"]),LC=({button:e,columns:t,dataTestSubj:a,defaultSortField:n,defaultSortOrder:i,infoPanel:o,inspectQueryId:l,listItems:c,panelTitle:u,splitPanel:d,subtitle:p})=>{const[m,f]=Object(r.useState)(0),[b,g]=Object(r.useState)(null!=n?n:"title"),[y,h]=Object(r.useState)(null!=i?i:"asc"),v=Object(r.useMemo)((()=>((e,t,a)=>{const n=[...e].sort(((e,a)=>{const n=e[t],i=a[t];return void 0!==n&&void 0!==i?n===i?e.title>a.title?1:e.title<a.title?-1:0:n>i?1:n<i?-1:0:0}));return"desc"===a&&n.reverse(),Object(I.chunk)(n,5)})(c,b,y)),[c,y,b]),E=Object(r.useMemo)((()=>({showPerPageOptions:!1,pageIndex:m,pageSize:5,totalItemCount:c.length})),[m,c.length]),x=Object(r.useMemo)((()=>({sort:{direction:y,field:b}})),[b,y]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{"data-test-subj":"spacer",size:"l"}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceBetween","data-test-subj":a},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ga.c,null,s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(Li.a,{id:l,subtitle:p,title:u},s.a.createElement(s.a.Fragment,null,e)),d,o,v.length>0&&s.a.createElement(RC,{columns:t,itemId:"id",items:v[m]||[],onChange:({page:e,sort:t})=>{const{index:a}=e;if(f(a),t){const{field:e,direction:a}=t;g(e),h(a)}},pagination:E,sorting:x}))))))},BC=s.a.memo(LC);BC.displayName="LinkPanel";const zC=({path:e,copy:t})=>e?s.a.createElement(ee.EuiLink,{href:e,target:"_blank","data-test-subj":"panel-link"},t):s.a.createElement(ee.EuiText,{color:"subdued",size:"s","data-test-subj":"panel-no-link"},t);zC.displayName="Link";const qC=[{name:"Name",field:"title",sortable:!0,truncateText:!0,width:"100%"},{name:"Indicator",field:"count",render:e=>{var t;if(e<1e4)return e.toString();const{magnitude:a,unit:n}=null!==(t=[{magnitude:1e18,unit:"E"},{magnitude:1e15,unit:"P"},{magnitude:1e12,unit:"T"},{magnitude:1e9,unit:"B"},{magnitude:1e6,unit:"M"},{magnitude:1e3,unit:"K"}].find((t=>e>=t.magnitude)))&&void 0!==t?t:{magnitude:1,unit:""};return((e,t)=>{const a=e.toFixed(t);return+a<=e?a:(+a-Math.pow(.1,t)).toFixed(t)})(e/a,1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n},sortable:!0,truncateText:!0,width:"70px",align:"right"},{name:"",field:"path",truncateText:!0,width:"80px",render:e=>s.a.createElement(zC,{path:e,copy:SC})}],$C=({isInspectEnabled:e=!0,listItems:t,splitPanel:a,totalCount:n=0})=>s.a.createElement(BC,{columns:qC,dataTestSubj:"cti-dashboard-links",inspectQueryId:e?kC:void 0,listItems:t,panelTitle:xC,splitPanel:a,subtitle:Object(r.useMemo)((()=>s.a.createElement(ms.FormattedMessage,{"data-test-subj":"cti-total-event-count",defaultMessage:"Showing: {totalCount} {totalCount, plural, one {indicator} other {indicators}}",id:"xpack.securitySolution.overview.ctiDashboardSubtitle",values:{totalCount:n}})),[n]),button:Object(r.useMemo)((()=>s.a.createElement($t.l,{"data-test-subj":"cti-view-indicators",deepLinkId:l.yc.threatIntelligence},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.overview.threatIndicatorsAction",defaultMessage:"View indicators"}))),[])}),VC=e=>{const{to:t,from:a,allTiDataSources:n,setQuery:i,deleteQuery:o}=e,{tiDataSources:c,totalCount:u}=TC({to:t,from:a,allTiDataSources:n,setQuery:i,deleteQuery:o}),{listItems:d}=(({tiDataSources:e=[]})=>{const{dashboards:t}=(()=>{const{http:e}=Object(h.i)().services,{data:t,isLoading:a,error:n}=Object(Np.b)(Np.a.CTI_TAGS,CC,{initialParameters:{http:e,tagName:"threat intel"}}),{fetch:i,data:s,isLoading:o}=Object(Np.b)(Np.a.CTI_TAGS,IC);return Object(r.useEffect)((()=>{a||n||null==t||!t.length||i({http:e,tagIds:t.map((e=>e.id))})}),[n,i,e,a,t]),{dashboards:s,isLoading:o||a}})(),a=Object(y.m)();return{listItems:Object(r.useMemo)((()=>{var n;const i=null!==(n=null==t?void 0:t.map((({id:e})=>e)))&&void 0!==n?n:[];return e.map((e=>{let t="";return e.dashboardId&&i.includes(e.dashboardId)&&(t=`${a({deepLinkId:l.yc.dashboards,path:e.dashboardId})}`),{title:e.name,count:e.count,path:t}}))}),[t,e,a])}})({tiDataSources:c});return s.a.createElement($C,{listItems:d,totalCount:u})},UC=s.a.memo(VC);UC.displayName="CtiEnabledModule";const HC=({bodyCopy:e,buttonCopy:t,dataTestSubjPrefix:a,docLink:n,learnMoreUrl:i,LinkPanelViewComponent:r,listItems:o,moreButtons:l,titleCopy:c})=>s.a.createElement(r,{listItems:o,splitPanel:s.a.createElement(NC,{body:e,button:s.a.createElement(ee.EuiFlexGroup,null,t&&n&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.g,{color:"warning",href:n,target:"_blank","data-test-subj":`${a}-enable-module-button`},t)),l&&l),color:"warning",dataTestSubj:`${a}-inner-panel-danger`,learnMoreLink:i,title:c})}),QC=Object(r.memo)(HC);QC.displayName="DisabledLinkPanel";const GC=()=>{const e=`${Object(h.d)()}/app/integrations/browse/threat_intel`;return s.a.createElement(QC,{bodyCopy:vC,buttonCopy:EC,dataTestSubjPrefix:"cti",docLink:e,listItems:[],titleCopy:hC,LinkPanelViewComponent:$C})},WC=s.a.memo(GC);WC.displayName="CtiDisabledModule";const ZC=e=>{const{allTiDataSources:t}=e;return t.length>0?s.a.createElement("div",{"data-test-subj":"cti-enabled-module"},s.a.createElement(UC,bo()({},e,{allTiDataSources:t}))):s.a.createElement("div",{"data-test-subj":"cti-disabled-module"},s.a.createElement(WC,null))},KC=s.a.memo(ZC);KC.displayName="ThreatIntelDashboardLinksComponent";const JC=()=>{const e=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),t=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),a=Object(F.a)(t),n=Object(F.a)(e),{from:i,deleteQuery:o,setQuery:c,to:u}=Object(xe.a)(),{indicesExist:d,sourcererDataView:p,indexPattern:m,selectedPatterns:f}=Object(E.d)(),b=Object(r.useMemo)((()=>[l.qb]),[]),[,{indexExists:g}]=Object(NT.b)(b,!0),{addMessage:y,hasMessage:h}=ss(),v=Object(r.useMemo)((()=>h("management","dismissEndpointNotice")),[h]),[x,j]=Object(r.useState)(v),O=Object(r.useCallback)((()=>{j(!0),y("management","dismissEndpointNotice")}),[y]),{endpointPrivileges:{canAccessFleet:k}}=Object(Dt.a)(),{hasIndexRead:w,hasKibanaREAD:T}=Object(Jl.a)(),{tiDataSources:I,isInitiallyLoaded:C}=(()=>{const{to:e,from:t}=Object(r.useMemo)((()=>({to:(new Date).toISOString(),from:new Date(0).toISOString()})),[]),{tiDataSources:a,isInitiallyLoaded:n}=TC({to:e,from:t});return{tiDataSources:a,isInitiallyLoaded:n}})();return s.a.createElement(s.a.Fragment,null,d?s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,null,s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:p})),s.a.createElement(S.a,null,!x&&!g&&k&&s.a.createElement(s.a.Fragment,null,s.a.createElement(fC,{onDismiss:O}),s.a.createElement(ee.EuiSpacer,{size:"l"})),s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiShowFor,{sizes:["xl"]},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(dC,null))),s.a.createElement(ee.EuiFlexItem,{grow:3},s.a.createElement(ee.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none"},w&&T&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(pC.a,{filters:n,query:a}),s.a.createElement(ee.EuiSpacer,{size:"l"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(RT.a,{deleteQuery:o,filters:n,from:i,indexPattern:m,indexNames:f,query:a,queryType:"overview",setQuery:c,to:u})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(gI,{filters:n,from:i,indexNames:f,indexPattern:m,query:a,setQuery:c,to:u})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{direction:"row"},s.a.createElement(ee.EuiFlexItem,{grow:1},C&&s.a.createElement(KC,{allTiDataSources:I,deleteQuery:o,from:i,setQuery:c,to:u}))))))))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.overview}))},YC=s.a.memo(JC);var XC=a(1518),eM=a(377);const tM={width:"322px"},aM=ae()(ee.EuiFormControlLayout).withConfig({displayName:"FormControlLayout",componentId:"sc-1q85sh-0"})(["max-width:500px;height:42px;.euiFormControlLayout__childrenWrapper{overflow:visible;}"]),nM=ae.a.div.withConfig({displayName:"Option",componentId:"sc-1q85sh-1"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;"]),iM=ae.a.span.withConfig({displayName:"OptionLabel",componentId:"sc-1q85sh-2"})(["font-weight:bold;"]),rM=[{label:Cg.i,value:"hot"},{label:Cg.p,value:"warm"},{disabled:!0,label:Cg.c,value:"cold"},{disabled:!0,label:Cg.h,value:"frozen"},{label:Cg.m,value:"unmanaged"}],sM=[{label:Cg.i,value:"hot"},{label:Cg.p,value:"warm"},{label:Cg.m,value:"unmanaged"}],oM=e=>s.a.createElement(ee.EuiToolTip,{content:`${e.label}: ${Object(XC.j)(e.label)}`},s.a.createElement(nM,null,s.a.createElement(iM,null,`${e.label}`),": ",s.a.createElement("span",null,Object(XC.j)(e.label)))),lM=()=>{const{hasAssistantPrivilege:e}=Object(eM.a)(),t=h.b.get().http.fetch,{baseTheme:a,theme:n}=Object(li.i)(),i=Object(h.m)(),o=Object(r.useCallback)((e=>{i.addSuccess(e)}),[i]),[c]=Object(h.o)(l.B),[d]=Object(h.o)(l.P),p=Object(ee.useGeneratedHtmlId)({prefix:"labelInput"}),[m,f]=Object(r.useState)(sM),{indicesExist:b,loading:g,selectedPatterns:y}=Object(E.d)(),{signalIndexName:v,loading:x}=Object(oy.a)(),{configSettings:j,cases:O,telemetry:k}=Object(h.i)().services,w=j.ILMEnabled,[T,I]=Object(r.useState)(),[C,M]=Object(r.useState)();Object(r.useEffect)((()=>{w||(I("now-7d"),M("now"))}),[w]);const A=Object(r.useMemo)((()=>null!=v?[v,...y]:[...y]),[y,v]),F=Object(r.useMemo)((()=>s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},s.a.createElement("span",null,XC.c)," ",s.a.createElement(ee.EuiLink,{external:!0,href:XC.f,rel:"noopener noreferrer",target:"_blank"},Cg.g))),[]),D=Object(r.useMemo)((()=>m.map((({label:e})=>e))),[m]),N=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFormLabel,{htmlFor:p},XC.g)),[p]),[R,L]=Object(Gt.a)({defaultValue:"",key:"dataQualityDashboardLastChecked"}),B=O.helpers.canUseCases([l.i]),z=Object(r.useCallback)((()=>B.create&&B.read),[B.create,B.read]),q=O.hooks.useCasesAddToNewCaseFlyout({toastContent:Cg.a}),$=Object(r.useCallback)((({comments:e,headerContent:t})=>{const a=e.map((e=>({comment:e,type:u.AttachmentType.user})));q.open({attachments:a,headerContent:t})}),[q]),V=Object(r.useCallback)((e=>{k.reportDataQualityIndexChecked(e)}),[k]),U=Object(r.useCallback)((e=>{k.reportDataQualityCheckAllCompleted(e)}),[k]);return g||x?s.a.createElement(ee.EuiLoadingSpinner,{size:"l","data-test-subj":"ecsDataQualityDashboardLoader"}):s.a.createElement(s.a.Fragment,null,b?s.a.createElement(S.a,{"data-test-subj":"ecsDataQualityDashboardPage"},s.a.createElement(oo,{subtitle:F,title:Cg.d},w&&s.a.createElement(ee.EuiToolTip,{content:XC.h},s.a.createElement(aM,{prepend:N},s.a.createElement(ee.EuiComboBox,{id:p,"data-test-subj":"selectIlmPhases",placeholder:XC.i,renderOption:oM,selectedOptions:m,style:tM,options:rM,onChange:f}))),!w&&T&&C&&s.a.createElement(ee.EuiToolTip,{content:Cg.e},s.a.createElement(ee.EuiSuperDatePicker,{start:T,end:C,onTimeChange:({start:e,end:t,isInvalid:a})=>{a||(I(e),M(t))},showUpdateButton:!1,isDisabled:!0,"data-test-subj":"dataQualityDatePicker"}))),s.a.createElement(XC.e,{addSuccessToast:o,baseTheme:a,canUserCreateAndReadCases:z,defaultBytesFormat:c,defaultNumberFormat:d,endDate:C,getGroupByFieldsOnClick:ji,reportDataQualityCheckAllCompleted:U,reportDataQualityIndexChecked:V,httpFetch:t,ilmPhases:D,isAssistantEnabled:e,isILMAvailable:w,lastChecked:R,openCreateCaseFlyout:$,patterns:A,setLastChecked:L,startDate:T,theme:n})):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.dataQuality}))};lM.displayName="DataQualityComponent";const cM=s.a.memo(lM);var uM=a(39);const dM=Y.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and SOC Trends"}),pM=Y.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and SOC Trends"}),mM=Y.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to SOC Trends date picker"}),fM=Y.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from SOC Trends date picker"}),bM=()=>{const e=Object(c.useDispatch)(),t=Object(r.useMemo)((()=>Me.d.globalSelector()),[]),a=Object(F.b)((e=>t(e).linkTo.includes(Ee.a.socTrends))),n=Object(r.useCallback)((()=>e(Me.b.toggleSocTrendsLinkTo())),[e]);return s.a.createElement(ee.EuiToolTip,{"data-test-subj":"socTrends-date-picker-lock-tooltip",position:"top",content:a?dM:pM},s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":`socTrends-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:n,iconType:a?"lock":"lockOpen","aria-label":a?fM:mM}))};bM.displayName="SocTrendsDatePickerLockComponent";const gM=s.a.memo(bM),yM=Y.i18n.translate("xpack.securitySolution.detectionResponse.socTrends",{defaultMessage:"SOC Trends"}),hM=Y.i18n.translate("xpack.securitySolution.detectionResponse.mttr",{defaultMessage:"Average case response time"}),vM=Y.i18n.translate("xpack.securitySolution.detectionResponse.mttrDescription",{defaultMessage:"The average duration (from creation to closure) for your current cases"}),EM=Y.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlerts",{defaultMessage:"Open critical alerts"}),xM=Y.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlertsDescription",{defaultMessage:"The count of open critical alerts for the current time range"}),jM=e=>Y.i18n.translate("xpack.securitySolution.detectionResponse.noChange",{defaultMessage:"Your {dataType} is unchanged",values:{dataType:e}}),SM=e=>Y.i18n.translate("xpack.securitySolution.detectionResponse.noData",{defaultMessage:"There is no {dataType} data to compare",values:{dataType:e}}),OM=e=>Y.i18n.translate("xpack.securitySolution.detectionResponse.noDataCompare",{defaultMessage:"There is no {dataType} data to compare from the compare time range",values:{dataType:e}}),kM=e=>Y.i18n.translate("xpack.securitySolution.detectionResponse.noDataCurrent",{defaultMessage:"There is no {dataType} data to compare from the current time range",values:{dataType:e}}),wM=({upOrDown:e,percentageChange:t,stat:a,statType:n})=>Y.i18n.translate("xpack.securitySolution.detectionResponse.timeDifference",{defaultMessage:"Your {statType} is {upOrDown} by {percentageChange} from {stat}",values:{upOrDown:e,percentageChange:t,stat:a,statType:n}}),TM=(e,t)=>{switch(t.type){case"setIsLoading":return{...e,isLoading:t.isLoading};case"setUpdatedAt":return{...e,updatedAt:t.updatedAt};case"setStat":return{...e,stat:t.stat};case"setPercentage":return{...e,percentage:t.percentage};default:throw new Error}};var IM=a(1658),CM=a.n(IM);const MM=(e,t)=>null!=e&&0!==e&&null!=t&&0!==t?`${((e-t)/t*100).toFixed(1)}%`:null,_M=e=>CM()(1e3*e,{compact:!0,verbose:!1}),AM=({from:e,to:t})=>({size:0,query:{bool:{filter:[{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{open:{filter:{term:{"kibana.alert.workflow_status":"open"}},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}}}}}}),FM="socTrends",PM=ae()(ee.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-h2q72s-0"})(["min-width:300px;"]),DM=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-h2q72s-1"})(["max-width:300px;"]),NM=({signalIndexName:e})=>{const{toggleStatus:t,setToggleStatus:a}=Object(Er.a)(FM),{stats:n,latestUpdate:i,isUpdating:o}=(({skip:e=!1,signalIndexName:t})=>{const{to:a,from:n,setQuery:i,deleteQuery:s}=Object(xe.a)(),{from:o="",to:c=""}=Object(F.a)((e=>Object(A.pick)(["from","to"],mt.d.socTrendsTimeRangeSelector(e)))),d=(({deleteQuery:e,from:t,fromCompare:a,setQuery:n,skip:i=!1,to:s,toCompare:o})=>{const{services:{cases:c}}=Object(h.i)(),d=Object(r.useMemo)((()=>`useCasesMttr-${Object(Ma.v4)()}`),[]),[p,m]=Object(r.useReducer)(TM,{description:vM,isLoading:!0,percentage:{percent:null,color:"hollow",note:SM("case")},stat:"-",testRef:"casesMttr",title:hM,updatedAt:Date.now()});return Object(r.useEffect)((()=>{let r=!0;const p=new AbortController,f=async()=>{try{const[e,n]=await Promise.all([c.api.cases.getCasesMetrics({from:t,to:s,owner:l.i,features:[u.CaseMetricsFeature.MTTR]},p.signal),c.api.cases.getCasesMetrics({from:a,to:o,owner:l.i,features:[u.CaseMetricsFeature.MTTR]},p.signal)]),i=MM(e.mttr,n.mttr);if(r&&null!=e.mttr?m({type:"setStat",stat:_M(e.mttr)}):r&&m({type:"setStat",stat:"-"}),null!=e.mttr&&null!=n.mttr&&null!=i){const e="-"===i.charAt(0),t="0.0%"===i;m({type:"setPercentage",percentage:{percent:e||t?i:`+${i}`,color:t?"hollow":e?"success":"danger",note:t?jM("case resolution time"):wM({upOrDown:e?"down":"up",percentageChange:e?i.substring(1):i,stat:_M(n.mttr),statType:"case resolution time"})}})}else{const t=null==e.mttr,a=null==n.mttr,i=t&&a?SM("case"):t?kM("case"):OM("case");m({type:"setPercentage",percentage:{percent:null,color:"hollow",note:i}})}}catch(e){r&&m({type:"setStat",stat:"-"})}r&&(m({type:"setIsLoading",isLoading:!1}),m({type:"setUpdatedAt",updatedAt:Date.now()}))};return i||(f(),n({id:d,inspect:null,loading:!1,refetch:f})),i&&(m({type:"setIsLoading",isLoading:!1}),r=!1,p.abort()),()=>{r=!1,p.abort(),e&&e({id:d})}}),[c.api.cases,t,i,s,n,e,d,a,o]),p})({deleteQuery:s,from:n,fromCompare:o,setQuery:i,skip:e,to:a,toCompare:c}),p=(({from:e,fromCompare:t,skip:a=!1,signalIndexName:n,to:i,toCompare:s})=>{var o,l;const[c,u]=Object(r.useReducer)(TM,{description:xM,isLoading:!0,percentage:{percent:null,color:"hollow",note:SM("alerts")},stat:"-",testRef:"criticalAlerts",title:EM,updatedAt:Date.now()}),d=Object(r.useMemo)((()=>AM({from:e,to:i})),[e,i]),p=Object(r.useMemo)((()=>AM({from:t,to:s})),[t,s]),{data:m,loading:f,setQuery:b}=Object(B.a)({query:d,indexName:n,skip:a,queryName:z.a.SOC_TRENDS}),{data:g,loading:y,setQuery:h}=Object(B.a)({query:p,indexName:n,skip:a,queryName:z.a.SOC_TRENDS});Object(r.useEffect)((()=>{b(d)}),[d,b]),Object(r.useEffect)((()=>{h(p)}),[p,h]),Object(r.useEffect)((()=>{u({type:"setIsLoading",isLoading:f||y})}),[f,y]);const v=Object(r.useMemo)((()=>{var e,t;return null!==(e=null==m||null===(t=m.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==m||null===(o=m.aggregations)||void 0===o?void 0:o.open.critical.doc_count]),E=Object(r.useMemo)((()=>{var e,t;return null!==(e=null==g||null===(t=g.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==g||null===(l=g.aggregations)||void 0===l?void 0:l.open.critical.doc_count]);return Object(r.useEffect)((()=>{const e=MM(v,E);if(u(null!=v?{type:"setStat",stat:`${v}`}:{type:"setStat",stat:"-"}),null!=v&&null!=E&&0!==v&&0!==E&&null!=e){const t="-"===e.charAt(0),a="0.0%"===e;u({type:"setPercentage",percentage:{percent:t||a?e:`+${e}`,color:a?"hollow":t?"success":"danger",note:a?jM("open critical alert count"):wM({upOrDown:t?"down":"up",percentageChange:t?e.substring(1):e,stat:`${E}`,statType:"open critical alert count"})}})}else{const e=null==v||0===v,t=!e||null!=E&&0!==E?e?kM("alerts"):OM("alerts"):SM("alerts");u({type:"setPercentage",percentage:{percent:null,color:"hollow",note:t}})}u({type:"setUpdatedAt",updatedAt:Date.now()})}),[v,E]),c})({from:n,fromCompare:o,skip:e,signalIndexName:t,to:a,toCompare:c}),m=Object(r.useMemo)((()=>Math.max(d.updatedAt,p.updatedAt)),[d.updatedAt,p.updatedAt]),f=Object(r.useMemo)((()=>d.isLoading||p.isLoading),[d.isLoading,p.isLoading]);return{stats:[d,p],isUpdating:f,latestUpdate:m}})({skip:!t,signalIndexName:e}),c=Object(r.useMemo)((()=>n.map((e=>(e=>({title:s.a.createElement(ee.EuiToolTip,{content:e.description},s.a.createElement(ee.EuiText,null,s.a.createElement("h6",null,e.title," ",s.a.createElement(ee.EuiIcon,{type:"questionInCircle"})))),description:e.isLoading?s.a.createElement(ee.EuiLoadingSpinner,{"data-test-subj":`${e.testRef}-stat-loading-spinner`}):s.a.createElement(s.a.Fragment,null,e.stat," ",s.a.createElement(ee.EuiToolTip,{content:e.percentage.note},s.a.createElement(ee.EuiBadge,{color:e.percentage.color},null!=e.percentage.percent?e.percentage.percent:"-")))}))(e)))),[n]);return s.a.createElement(PM,{hasBorder:!0},s.a.createElement(Li.a,{id:FM,showInspectButton:!1,stackHeader:!0,subtitle:s.a.createElement(zg,{updatedAt:i,isUpdating:o}),title:yM,titleSize:"s",toggleQuery:a,toggleStatus:t},s.a.createElement(DM,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(_e.a,{id:Ee.a.socTrends,showUpdateButton:"iconOnly",width:"auto",compressed:!0})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(gM,null)))),t&&s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiDescriptionList,{"data-test-subj":"statsList",textStyle:"reverse",listItems:c}))))},RM=s.a.memo(NM);var LM=a(320);const BM="hostsBySeverity",zM={pageCount:0,currentPage:0},qM=({from:e,to:t,currentPage:a,filterQuery:n})=>{const i=Ln.a*a;return{query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}},...n?[n]:[]]}},size:0,aggs:{host_count:{cardinality:{field:"host.name"}},[BM]:{terms:{size:100,field:"host.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:i,size:4}}}}}}},$M=({extraFilter:e,dataView:t}={})=>{const{from:a,to:n}=Object(xe.a)(),i=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),s=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),o=Object(F.a)(s),l=Object(F.a)(i),{uiSettings:c}=Object(h.i)().services,u=Object(r.useMemo)((()=>{const t=l.filter((e=>!1===e.meta.disabled));return e?[...t,e]:t}),[e,l]),{filterQuery:d,kqlError:p}=Object(r.useMemo)((()=>VM(o,u,Object(Ro.getEsQueryConfig)(c),t)),[t,o,u,c]),m=Object(r.useMemo)((()=>d?JSON.stringify(d):void 0),[d]);return Object(Bo.a)({id:"GlobalFilterQuery",filterQuery:m,kqlError:p,query:o,startDate:a,endDate:n}),{filterQuery:d}},VM=(e,t,a,n)=>{try{return{filterQuery:Object(za.buildEsQuery)(n,[e],t,a)}}catch(e){return{kqlError:e}}},UM="vulnerableHostsBySeverityQuery",HM=s.a.memo((({signalIndexName:e})=>{const t=Ig(),{filterQuery:a}=$M(),n=Object(r.useCallback)((({hostName:e,severity:a})=>t([{title:Fn,selectedOptions:[e],fieldName:"host.name"},...a?[{title:Mn,selectedOptions:[a],fieldName:Ca.X}]:[]])),[t]),{toggleStatus:i,setToggleStatus:o}=Object(Er.a)(UM),{items:l,isLoading:c,updatedAt:u,pagination:d}=(({skip:e,queryId:t,signalIndexName:a,filterQuery:n})=>{const[i,s]=Object(r.useState)(Date.now()),[o,l]=Object(r.useState)([]),[c,u]=Object(r.useState)(zM),{to:d,from:p,setQuery:m,deleteQuery:f}=Object(xe.a)(),b=Object(r.useMemo)((()=>qM({from:p,to:d,currentPage:c.currentPage,filterQuery:n})),[n,p,c.currentPage,d]),{data:g,request:y,response:h,setQuery:v,loading:E,refetch:x}=Object(B.a)({query:b,indexName:a,skip:e,queryName:z.a.VULNERABLE_HOSTS});Object(r.useEffect)((()=>{v(b)}),[v,c.currentPage,b]),Object(r.useEffect)((()=>{var e,t;null!=g&&g.aggregations?(l((null!==(t=null==(e=g.aggregations)?void 0:e[BM].buckets)&&void 0!==t?t:[]).reduce(((e,t)=>{var a;return e.push({hostName:null!==(a=Object(pi.a)(t.key))&&void 0!==a?a:"-",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e}),[])),u((e=>{var t;return{...e,pageCount:Object(Ln.c)(null===(t=g.aggregations)||void 0===t?void 0:t.host_count.value)}}))):l([]),s(Date.now())}),[g]);const j=Object(r.useCallback)((()=>{!e&&x&&x()}),[e,x]);return Object($a.b)({deleteQuery:f,inspect:{dsl:[y],response:[h]},refetch:j,setQuery:m,queryId:t,loading:E}),{items:o,isLoading:E,updatedAt:i,pagination:{...c,setPage:e=>{u((t=>({...t,currentPage:e})))}}}})({skip:!i,queryId:UM,signalIndexName:e,filterQuery:a}),p=Object(r.useMemo)((()=>QM(n)),[n]);return s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"severityHostAlertsPanel"},s.a.createElement(Li.a,{id:UM,title:nn,subtitle:s.a.createElement(zg,{updatedAt:u,isUpdating:c}),titleSize:"s",toggleQuery:o,toggleStatus:i,tooltip:Tn}),i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiBasicTable,{items:l,columns:p,loading:c,"data-test-subj":"severityHostAlertsTable",noItemsMessage:s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,ln),titleSize:"xs"})}),s.a.createElement(ee.EuiSpacer,{size:"m"}),d.pageCount>1&&s.a.createElement(ee.EuiTablePagination,{"data-test-subj":"hostTablePaginator",activePage:d.currentPage,itemsPerPage:Ln.a,pageCount:d.pageCount,onChangePage:d.setPage,showPerPageOptions:!1}))))}));HM.displayName="HostAlertsTable";const QM=e=>[{field:"hostName",name:En,"data-test-subj":"hostSeverityAlertsTable-hostName",render:e=>s.a.createElement(ee.EuiToolTip,{title:gn,content:e,anchorClassName:"eui-textTruncate"},s.a.createElement($t.d,{hostName:e}))},{field:"totalAlerts",name:Ja,"data-test-subj":"hostSeverityAlertsTable-totalAlerts",render:(t,{hostName:a})=>s.a.createElement(sr.c,{data:{value:a,field:"host.name"},mode:LM.b.HOVER_RIGHT,triggerId:sr.d.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({hostName:a})},s.a.createElement(Xn.a,{count:t})))},{field:"critical",name:Va,render:(t,{hostName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-critical",color:Ln.b.critical},t>0?s.a.createElement(sr.c,{data:{value:a,field:"host.name"},mode:LM.b.HOVER_RIGHT,triggerId:sr.d.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"critical"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-criticalLink",onClick:()=>e({hostName:a,severity:"critical"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"high",name:Ua,render:(t,{hostName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-high",color:Ln.b.high},t>0?s.a.createElement(sr.c,{data:{value:a,field:"host.name"},mode:LM.b.HOVER_RIGHT,triggerId:sr.d.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"high"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({hostName:a,severity:"high"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"medium",name:Ha,render:(t,{hostName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-medium",color:Ln.b.medium},t>0?s.a.createElement(sr.c,{data:{value:a,field:"host.name"},mode:LM.b.HOVER_RIGHT,triggerId:sr.d.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"medium"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({hostName:a,severity:"medium"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"low",name:Qa,render:(t,{hostName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-low",color:Ln.b.low},t>0?s.a.createElement(sr.c,{data:{value:a,field:"host.name"},mode:LM.b.HOVER_RIGHT,triggerId:sr.d.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"low"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({hostName:a,severity:"low"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))}];var GM=a(321);const WM="kibana.alert.rule.name",ZM="kibana.alert.rule.uuid",KM="kibana.alert.severity",JM="@timestamp",YM="detection-response-rule-alerts-severity-table",XM=s.a.memo((({signalIndexName:e})=>{const{getAppUrl:t,navigateTo:a}=Object(h.k)(),{toggleStatus:n,setToggleStatus:i}=Object(Er.a)(YM),{filterQuery:o}=$M(),{items:c,isLoading:u,updatedAt:d}=(({queryId:e,signalIndexName:t,skip:a=!1,filterQuery:n})=>{const[i,s]=Object(r.useState)([]),[o,l]=Object(r.useState)(Date.now()),{to:c,from:u,deleteQuery:d,setQuery:p}=Object(xe.a)(),m=Object(r.useMemo)((()=>(({from:e,to:t,filterQuery:a})=>({_source:!1,fields:[WM,ZM,KM,JM],size:0,query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}},...a?[a]:[]]}},aggs:{alertsByRule:{terms:{field:"kibana.alert.rule.name",size:4,order:[{critical:"desc"},{high:"desc"},{medium:"desc"},{low:"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},lastRuleAlert:{top_hits:{size:1,sort:{"@timestamp":"desc"}}}}}}}))({from:u,to:c,filterQuery:n})),[n,u,c]),{loading:f,data:b,setQuery:g,response:y,request:h,refetch:v}=Object(B.a)({query:m,indexName:t,skip:a,queryName:z.a.BY_SEVERITY});Object(r.useEffect)((()=>{g(m)}),[g,m]),Object(r.useEffect)((()=>{var e,t;s(null==b?[]:(null!==(t=null==(e=b.aggregations)?void 0:e.alertsByRule.buckets)&&void 0!==t?t:[]).map((e=>{var t,a,n,i;const r=e.lastRuleAlert.hits.hits[0].fields;return{id:null!==(t=Object(pi.a)(r[ZM]))&&void 0!==t?t:"",alert_count:e.lastRuleAlert.hits.total.value,name:null!==(a=Object(pi.a)(r[WM]))&&void 0!==a?a:"",last_alert_at:null!==(n=Object(pi.a)(r[JM]))&&void 0!==n?n:"",severity:null!==(i=Object(pi.a)(r[KM]))&&void 0!==i?i:"low"}}))),l(Date.now())}),[b]);const E=Object(r.useCallback)((()=>{!a&&v&&v()}),[a,v]);return Object($a.b)({deleteQuery:d,inspect:{dsl:[h],response:[y]},refetch:E,setQuery:p,queryId:e,loading:f}),{items:i,isLoading:f,updatedAt:o}})({signalIndexName:e,queryId:YM,skip:!n,filterQuery:o}),p=Ig(),m=Object(r.useCallback)((e=>p({title:An,selectedOptions:[e],fieldName:Ca.G})),[p]),f=Object(r.useCallback)((()=>{p({title:_n,selectedOptions:["open"],fieldName:Ca.ob})}),[p]),b=Object(r.useMemo)((()=>(({getAppUrl:e,navigateTo:t,openRuleInAlertsPage:a})=>[{field:"name",name:un,render:(a,{id:n})=>{const i=e({deepLinkId:l.yc.rules,path:`id/${n}`});return s.a.createElement(ee.EuiToolTip,{"data-test-subj":`${n}-tooltip`,title:fn,content:a,anchorClassName:"eui-textTruncate"},s.a.createElement(ee.EuiLink,{"data-test-subj":"severityRuleAlertsTable-name",href:i,onClick:e=>{e&&e.preventDefault(),t({url:i})}},a))}},{field:"last_alert_at",name:dn,"data-test-subj":"severityRuleAlertsTable-lastAlertAt",render:e=>s.a.createElement(ms.FormattedRelative,{value:new Date(e)})},{field:"alert_count",name:pn,"data-test-subj":"severityRuleAlertsTable-alertCount",render:(e,{name:t})=>s.a.createElement(sr.c,{data:{value:t,field:Ca.G},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{"data-test-subj":"severityRuleAlertsTable-alertCountLink",disabled:0===e,onClick:()=>a(t)},s.a.createElement(Xn.a,{count:e})))},{field:"severity",name:mn,"data-test-subj":"severityRuleAlertsTable-severity",render:e=>s.a.createElement(ee.EuiHealth,{color:Ln.b[e]},Object(I.capitalize)(e))}])({getAppUrl:t,navigateTo:a,openRuleInAlertsPage:m})),[t,a,m]);return s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"severityRuleAlertsPanel"},s.a.createElement(Li.a,{id:YM,title:an,titleSize:"s",toggleStatus:n,toggleQuery:i,subtitle:s.a.createElement(zg,{updatedAt:d,isUpdating:u})}),n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"severityRuleAlertsTable",columns:b,items:c,loading:u,noItemsMessage:s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,ln),titleSize:"xs"})}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiButton,{"data-test-subj":"severityRuleAlertsButton",onClick:f},hn))))}));XM.displayName="RuleAlertsTable";const e_="usersBySeverity",t_={pageCount:0,currentPage:0},a_=({from:e,to:t,currentPage:a,filterQuery:n})=>{const i=Ln.a*a;return{query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}},...n?[n]:[]]}},size:0,aggs:{user_count:{cardinality:{field:"user.name"}},[e_]:{terms:{size:100,field:"user.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:i,size:4}}}}}}},n_="vulnerableUsersBySeverityQuery",i_=s.a.memo((({signalIndexName:e})=>{const t=Ig(),{filterQuery:a}=$M(),n=Object(r.useCallback)((({userName:e,severity:a})=>t([{title:Pn,selectedOptions:[e],fieldName:"user.name"},...a?[{title:Mn,selectedOptions:[a],fieldName:Ca.X}]:[]])),[t]),{toggleStatus:i,setToggleStatus:o}=Object(Er.a)(n_),{items:l,isLoading:c,updatedAt:u,pagination:d}=(({skip:e,queryId:t,signalIndexName:a,filterQuery:n})=>{const[i,s]=Object(r.useState)(Date.now()),[o,l]=Object(r.useState)([]),[c,u]=Object(r.useState)(t_),{to:d,from:p,setQuery:m,deleteQuery:f}=Object(xe.a)(),b=Object(r.useMemo)((()=>a_({from:p,to:d,currentPage:c.currentPage,filterQuery:n})),[n,p,c.currentPage,d]),{setQuery:g,data:y,loading:h,request:v,response:E,refetch:x}=Object(B.a)({query:b,indexName:a,skip:e,queryName:z.a.VULNERABLE_USERS});Object(r.useEffect)((()=>{g(b)}),[g,c.currentPage,b]),Object(r.useEffect)((()=>{var e,t;null!=y&&y.aggregations?(l((null!==(t=null==(e=y.aggregations)?void 0:e[e_].buckets)&&void 0!==t?t:[]).reduce(((e,t)=>{var a;return e.push({userName:null!==(a=Object(pi.a)(t.key))&&void 0!==a?a:"-",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e}),[])),u((e=>{var t;return{...e,pageCount:Object(Ln.c)(null===(t=y.aggregations)||void 0===t?void 0:t.user_count.value)}}))):l([]),s(Date.now())}),[y]);const j=Object(r.useCallback)((()=>{!e&&x&&x()}),[e,x]);return Object($a.b)({deleteQuery:f,inspect:{dsl:[v],response:[E]},refetch:j,setQuery:m,queryId:t,loading:h}),{items:o,isLoading:h,updatedAt:i,pagination:{...c,setPage:e=>{u((t=>({...t,currentPage:e})))}}}})({skip:!i,queryId:n_,signalIndexName:e,filterQuery:a}),p=Object(r.useMemo)((()=>r_(n)),[n]);return s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"severityUserAlertsPanel"},s.a.createElement(Li.a,{id:n_,title:rn,titleSize:"s",toggleStatus:i,toggleQuery:o,subtitle:s.a.createElement(zg,{updatedAt:u,isUpdating:c}),tooltip:In}),i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"severityUserAlertsTable",columns:p,items:l,loading:c,noItemsMessage:s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,ln),titleSize:"xs"})}),s.a.createElement(ee.EuiSpacer,{size:"m"}),d.pageCount>1&&s.a.createElement(ee.EuiTablePagination,{"data-test-subj":"userTablePaginator",activePage:d.currentPage,itemsPerPage:Ln.a,pageCount:d.pageCount,onChangePage:d.setPage,showPerPageOptions:!1}))))}));i_.displayName="UserAlertsTable";const r_=e=>[{field:"userName",name:xn,"data-test-subj":"userSeverityAlertsTable-userName",render:e=>s.a.createElement(ee.EuiToolTip,{title:yn,content:e,anchorClassName:"eui-textTruncate"},s.a.createElement($t.m,{userName:e}))},{field:"totalAlerts",name:Ja,"data-test-subj":"userSeverityAlertsTable-totalAlerts",render:(t,{userName:a})=>s.a.createElement(sr.c,{data:{value:a,field:"user.name"},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{"data-test-subj":"userSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({userName:a})},s.a.createElement(Xn.a,{count:t})))},{field:"critical",name:Va,render:(t,{userName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-critical",color:Ln.b.critical},t>0?s.a.createElement(sr.c,{data:{value:a,field:"user.name"},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"critical"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{"data-test-subj":"userSeverityAlertsTable-criticalLink",onClick:()=>e({userName:a,severity:"critical"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"high",name:Ua,render:(t,{userName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-high",color:Ln.b.high},t>0?s.a.createElement(sr.c,{data:{value:a,field:"user.name"},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"high"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({userName:a,severity:"high"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"medium",name:Ha,render:(t,{userName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-medium",color:Ln.b.medium},t>0?s.a.createElement(sr.c,{data:{value:a,field:"user.name"},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"medium"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({userName:a,severity:"medium"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))},{field:"low",name:Qa,render:(t,{userName:a})=>s.a.createElement(ee.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-low",color:Ln.b.low},t>0?s.a.createElement(sr.c,{data:{value:a,field:"user.name"},mode:LM.b.HOVER_RIGHT,triggerId:GM.e.ALERTS_COUNT,sourcererScopeId:x.SourcererScopeName.detections,metadata:{andFilters:[{field:"kibana.alert.severity",value:"low"},{field:"kibana.alert.workflow_status",value:"open"}]}},s.a.createElement(ee.EuiLink,{onClick:()=>e({userName:a,severity:"low"})},s.a.createElement(Xn.a,{count:t}))):s.a.createElement(Xn.a,{count:t}))}],s_=Y.i18n.translate("cases.components.status.open",{defaultMessage:"Open"}),o_=Y.i18n.translate("cases.components.status.inProgress",{defaultMessage:"In progress"}),l_=Y.i18n.translate("cases.components.status.closed",{defaultMessage:"Closed"});let c_;!function(e){e.open="open",e["in-progress"]="in-progress",e.closed="closed"}(c_||(c_={}));const u_={[c_.open]:{color:"primary",label:s_,icon:"folderOpen"},[c_["in-progress"]]:{color:"warning",label:o_,icon:"folderExclamation"},[c_.closed]:{color:"default",label:l_,icon:"folderCheck"}},d_=({status:e,dataTestSubj:t})=>{var a,n;return Object(Ws.jsx)(ee.EuiBadge,{"data-test-subj":t||`case-status-badge-${e}`,color:null===(a=u_[e])||void 0===a?void 0:a.color},null===(n=u_[e])||void 0===n?void 0:n.label)};d_.displayName="Status";const p_=Object(r.memo)(d_);var m_={name:"1uc4sf3",styles:"margin-left:auto;flex-grow:0"},f_={name:"qamjgr",styles:"margin-right:4px"};const b_=s.a.memo((({count:e,icon:t})=>Object(Ws.jsx)(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none",css:m_},Object(Ws.jsx)(ee.EuiFlexItem,{grow:!1},Object(Ws.jsx)(ee.EuiIcon,{css:f_,size:"s",type:t,"data-test-subj":"comment-count-icon"})),Object(Ws.jsx)(ee.EuiFlexItem,{grow:!1},Object(Ws.jsx)(ee.EuiText,{size:"xs"},e)))));b_.displayName="IconWithCount";const g_=(e,t)=>t<=0||e.length<=t?e:e.slice(0,t).trim().concat("..."),y_=Y.i18n.translate("cases.components.tooltip.opened",{defaultMessage:"Opened"}),h_=Y.i18n.translate("cases.components.tooltip.closed",{defaultMessage:"Closed"}),v_=Y.i18n.translate("cases.components.tooltip.by",{defaultMessage:"by"}),E_=s.a.memo((({title:e,description:t,status:a,totalComments:n,createdAt:i,createdBy:r})=>{var o,l;return Object(Ws.jsx)(s.a.Fragment,null,Object(Ws.jsx)(ee.EuiFlexGroup,{gutterSize:"xs",direction:"column"},Object(Ws.jsx)(ee.EuiFlexGroup,{gutterSize:"xs",responsive:!1},Object(Ws.jsx)(ee.EuiFlexItem,{grow:!1},Object(Ws.jsx)(p_,{status:a})),Object(Ws.jsx)(b_,{count:n,icon:"editorComment"})),Object(Ws.jsx)(ee.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(Ws.jsx)(ee.EuiFlexItem,null,Object(Ws.jsx)(ee.EuiText,{size:"relative"},Object(Ws.jsx)("strong",null,g_(e,35)))),Object(Ws.jsx)(ee.EuiFlexItem,null,Object(Ws.jsx)(ee.EuiText,{size:"relative"},g_(t,80))))),Object(Ws.jsx)(ee.EuiHorizontalRule,{margin:"xs"}),Object(Ws.jsx)(ee.EuiText,{size:"relative"},a===c_.closed?h_:y_," ",Object(Ws.jsx)(ms.FormattedRelative,{value:i})," ",r.username||r.fullName?Object(Ws.jsx)(s.a.Fragment,null,v_," ",Object(Ws.jsx)("strong",{"data-test-subj":"tooltip-username"},g_(null!==(o=null!==(l=r.username)&&void 0!==l?l:r.fullName)&&void 0!==o?o:"",15))):null))}));E_.displayName="TooltipContent";const x_=Object(r.memo)(E_);var j_={name:"1tpdvqq",styles:"width:240px"},S_={name:"1o3679e",styles:"width:70px;margin-bottom:12px"};const O_=()=>Object(Ws.jsx)(ee.EuiFlexItem,{css:j_,"data-test-subj":"tooltip-loading-content"},Object(Ws.jsx)(ee.EuiSkeletonTitle,{size:"xxxs",css:S_}),Object(Ws.jsx)(ee.EuiSkeletonText,{lines:3}),Object(Ws.jsx)(ee.EuiHorizontalRule,{margin:"xs"}),Object(Ws.jsx)(ee.EuiSpacer,{size:"s"}));O_.displayName="Skeleton";const k_=O_;s.a.memo((e=>{const{dataTestSubj:t,children:a,loading:n=!1,className:i="",content:r}=e;return Object(Ws.jsx)(ee.EuiToolTip,{"data-test-subj":t||"cases-components-tooltip",anchorClassName:i,content:n?Object(Ws.jsx)(k_,null):Object(Ws.jsx)(x_,r)},Object(Ws.jsx)(s.a.Fragment,null,a))})).displayName="Tooltip";const w_={[c_.open]:{color:"primary",label:Wa},[c_["in-progress"]]:{color:"warning",label:Ka},[c_.closed]:{color:"default",label:Za}},T_=({status:e})=>s.a.createElement(ee.EuiBadge,{color:w_[e].color,"data-test-subj":"case-status-badge"},w_[e].label);T_.displayName="StatusBadge";var I_=a(208);const C_="recentlyCreatedCasesQuery",M_=s.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(h.k)(),{toggleStatus:a,setToggleStatus:n}=Object(Er.a)(C_),{items:i,isLoading:o,updatedAt:c}=(({skip:e})=>{const{services:{cases:t}}=Object(h.i)(),{to:a,from:n,setQuery:i,deleteQuery:s}=Object(xe.a)(),[o,c]=Object(r.useState)(!0),[u,d]=Object(r.useState)(Date.now()),[p,m]=Object(r.useState)([]),f=Object(r.useMemo)((()=>`useCaseItems-${Object(Ma.v4)()}`),[]);return Object(r.useEffect)((()=>{let r=!0;const o=new AbortController,u=async()=>{try{const e=await t.api.cases.find({from:n,to:a,owner:l.i,sortField:"createdAt",sortOrder:"desc",page:1,perPage:4});r&&(m(function(e){return(e.cases||[]).reduce(((e,t)=>(e.push({id:t.id,name:t.title,totalAlerts:t.totalAlerts,createdAt:t.createdAt,createdBy:t.createdBy.username||"â€”",status:t.status}),e)),[])}(e)),d(Date.now()))}catch(e){r&&Object(I_.addError)(e,{title:wn})}c(!1)};return e||(u(),i({id:f,inspect:null,loading:!1,refetch:u})),e&&(c(!1),r=!1,o.abort()),()=>{r=!1,o.abort(),s({id:f})}}),[t.api.cases,n,e,a,i,s,f]),{items:p,isLoading:o,updatedAt:u}})({skip:!a}),u=Object(r.useCallback)((()=>{t({deepLinkId:P.a.case})}),[t]),d=Object(r.useMemo)((()=>__({getAppUrl:e,navigateTo:t})),[e,t]);return s.a.createElement(Ab.a,{show:!0,targetClassNames:[ga.a]},s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":"recentlyCreatedCasesPanel"},s.a.createElement(Li.a,{id:C_,title:sn,titleSize:"s",toggleStatus:a,toggleQuery:n,subtitle:s.a.createElement(zg,{updatedAt:c,isUpdating:o}),showInspectButton:!1,tooltip:on}),a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"recentlyCreatedCasesTable",columns:d,items:i,loading:o,noItemsMessage:s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,cn),titleSize:"xs"})}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiButton,{"data-test-subj":"allCasesButton",onClick:u},vn))))}));M_.displayName="CasesTable";const __=()=>[{field:"id",name:jn,"data-test-subj":"recentlyCreatedCaseName",render:(e,{name:t})=>s.a.createElement(ee.EuiToolTip,{title:bn,content:t,anchorClassName:"eui-textTruncate"},s.a.createElement($t.a,{detailName:e},t))},{field:"totalAlerts",name:Ja,truncateText:!0,textOnly:!0,"data-test-subj":"recentlyCreatedCaseAlert",render:e=>s.a.createElement(Xn.a,{count:e})},{field:"createdAt",name:Sn,render:e=>s.a.createElement(Yc.a,{fieldName:Sn,value:e,className:"eui-textTruncate",dateFormat:"MMMM D, YYYY"}),"data-test-subj":"recentlyCreatedCaseTime"},{field:"createdBy",name:On,render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"recentlyCreatedCaseCreatedBy",size:"s"},e)},{field:"status",name:kn,render:e=>s.a.createElement(T_,{status:e}),"data-test-subj":"recentlyCreatedCaseStatus"}];var A_=a(185);const F_="casesByStatus",P_={series:{xScaleType:oi.ScaleType.Ordinal,yScaleType:oi.ScaleType.Linear,stackAccessors:["g"],barSeriesStyle:{rect:{widthPixel:22,opacity:1}}},axis:{xTickFormatter:e=>e.toLocaleString(),left:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:14}}},bottom:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:10.5}},labelFormat:e=>Rr()(e).format("0")}},settings:{rotation:90},customHeight:146},D_=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-txg0dl-0"})(["align-items:center;width:70%;"]),N_=ae.a.div.withConfig({displayName:"Wrapper",componentId:"sc-txg0dl-1"})(["width:100%;"]),R_=()=>{const{toggleStatus:e,setToggleStatus:t}=Object(Er.a)(F_),{getAppUrl:a,navigateTo:n}=Object(h.k)(),{search:i}=Object(y.l)(l.yc.case),o=a({deepLinkId:l.yc.case,path:Object(A_.a)(i)}),c=Object(r.useCallback)((e=>{e.preventDefault(),n({url:o})}),[o,n]),{closed:u,inProgress:d,isLoading:p,open:m,totalCounts:f,updatedAt:b}=(({skip:e=!1})=>{var t,a,n,i,s,o;const{services:{cases:c}}=Object(h.i)(),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(xe.a)(),f=Object(r.useMemo)((()=>`useCaseItems-${Object(Ma.v4)()}`),[]),[b,g]=Object(r.useState)(Date.now()),[y,v]=Object(r.useState)(!0),[E,x]=Object(r.useState)(null);return Object(r.useEffect)((()=>{let t=!0;const a=new AbortController,n=async()=>{try{const e=await c.api.cases.getCasesStatus({from:d,to:u,owner:l.i},a.signal);t&&x(e)}catch(e){t&&x(null)}t&&(v(!1),g(Date.now()))};return e||(n(),p({id:f,inspect:null,loading:!1,refetch:n})),e&&(v(!1),t=!1,a.abort()),()=>{t=!1,a.abort(),m({id:f})}}),[c.api.cases,d,e,u,p,m,f]),{closed:null!==(t=null==E?void 0:E.countClosedCases)&&void 0!==t?t:0,inProgress:null!==(a=null==E?void 0:E.countInProgressCases)&&void 0!==a?a:0,isLoading:y,open:null!==(n=null==E?void 0:E.countOpenCases)&&void 0!==n?n:0,totalCounts:(null!==(i=null==E?void 0:E.countClosedCases)&&void 0!==i?i:0)+(null!==(s=null==E?void 0:E.countInProgressCases)&&void 0!==s?s:0)+(null!==(o=null==E?void 0:E.countOpenCases)&&void 0!==o?o:0),updatedAt:b}})({skip:!e}),g=Object(r.useMemo)((()=>[{key:"open",value:[{y:m,x:Wa,g:Wa}],color:"#79aad9"},{key:"in-progress",value:[{y:d,x:Ka,g:Ka}],color:"#f1d86f"},{key:"closed",value:[{y:u,x:Za,g:Za}],color:"#d3dae6"}]),[u,d,m]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(Li.a,{id:F_,title:Xa,titleSize:"s",toggleStatus:e,toggleQuery:t,subtitle:s.a.createElement(zg,{updatedAt:b,isUpdating:p}),showInspectButton:!1,tooltip:en},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($t.g,{href:o,onClick:c},tn)))),!p&&e&&s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",alignItems:"center",direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,0!==f&&s.a.createElement(ee.EuiText,{className:"eui-textCenter",size:"s",grow:!1},s.a.createElement(s.a.Fragment,null,s.a.createElement("b",null,s.a.createElement(ms.FormattedNumber,{value:f}))," ",s.a.createElement("span",null," ",(v=f,Y.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatus.totalCases",{values:{totalCases:v},defaultMessage:"total {totalCases, plural, =1 {case} other {cases}}"})))))),s.a.createElement(D_,{grow:!1},s.a.createElement(N_,{"data-test-subj":"chart-wrapper"},s.a.createElement(zb.a,{configs:P_,barChart:g})))));var v},L_=s.a.memo(R_),B_=()=>{const{cases:e}=Object(h.i)().services,{filterQuery:t}=$M(),{indicesExist:a,loading:n,sourcererDataView:i}=Object(E.d)(),{signalIndexName:r}=Object(oy.a)(),{hasKibanaREAD:o,hasIndexRead:l}=Object(Jl.a)(),c=e.helpers.canUseCases([uM.APP_ID]).read,u=o&&l,d=Object(ve.a)("socTrendsEnabled");return u||c?s.a.createElement(s.a.Fragment,null,a?s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,null,s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:i})),s.a.createElement(S.a,{"data-test-subj":"detectionResponsePage"},s.a.createElement(oo,{title:Cg.f}),n?s.a.createElement(ee.EuiLoadingSpinner,{size:"l","data-test-subj":"detectionResponseLoader"}):s.a.createElement(ee.EuiFlexGroup,{direction:"column","data-test-subj":"detectionResponseSections"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,null,u&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(sy,{signalIndexName:r,additionalFilters:t?[t]:void 0})),c&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(L_,null)))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{direction:"column"},u&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(XM,{signalIndexName:r})),c&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(M_,null)))),d&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(RM,{signalIndexName:r})))),u&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(HM,{signalIndexName:r})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(i_,{signalIndexName:r}))))))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.detectionAndResponse})):s.a.createElement(Gs.a,{docLinkSelector:e=>e.siem.privileges})},z_=s.a.memo(B_);var q_=a(1287);const $_=ae()(sr.c).withConfig({displayName:"StyledCellActions",componentId:"sc-uvp78c-0"})(["padding-left:",";"],(({theme:e})=>e.eui.euiSizeS)),V_=ae()(ee.EuiBasicTable).withConfig({displayName:"StyledBasicTable",componentId:"sc-ihyued-0"})([".euiTableRow{.euiTableRowCell{border-bottom:none !important;}}.inlineActions{opacity:0;}.EntityAnalyticsTableHoverActions{.inlineActions-popoverOpen{opacity:1;}.inline-actions-table-cell:hover{.inlineActions{opacity:1;}}}"]);var U_=a(527),H_=a(229),Q_=a(608);const G_=({entityLinkProps:e,onSelectSeverityFilterGroup:t,riskEntity:a,selectedSeverity:n,severityCount:i,toggleStatus:o})=>{const l=Object($t.o)(),[c,u]=Object(r.useMemo)((()=>{const{onClick:t,href:a}=l(e);return[t,a]}),[e,l]);return o?s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"m","data-test-subj":`${a}-risk-score-header-content`},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(zm,{riskEntity:a})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Sm,{selectedSeverities:n,severityCount:null!=i?i:rt.c,riskEntity:a,onSelect:t})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($t.g,{"data-test-subj":"view-all-button",onClick:c,href:u},q_.g))):null},W_=s.a.memo(G_),Z_={host:Object(Ma.v4)(),user:Object(Ma.v4)()},K_=(e="host",t={spaceId:"default"})=>{var a;const n=Object(Ma.v4)(),i=Z_[e];return{title:`${e} risk donut`,description:"",visualizationType:"lnsPie",state:{visualization:{shape:"donut",layers:[{layerId:n,primaryGroups:["a2e8541a-c22f-4e43-8a12-caa33edc5de0"],metrics:["75179122-96fc-40e1-93b4-8e9310af5f06"],numberDisplay:"value",categoryDisplay:"hide",legendDisplay:"show",nestedLegend:!0,layerType:"data",legendSize:"medium",legendPosition:"left",percentDecimals:2,emptySizeRatio:.82}]},query:{query:"",language:"kuery"},filters:null!==(a=null==t?void 0:t.filters)&&void 0!==a?a:[],datasourceStates:{formBased:{layers:{[n]:{columns:{"a2e8541a-c22f-4e43-8a12-caa33edc5de0":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{label:"Unknown",input:{query:`${e}.risk.calculated_level : "Unknown"`,language:"kuery"}},{input:{query:`${e}.risk.calculated_level : "Low"`,language:"kuery"},label:"Low"},{input:{query:`${e}.risk.calculated_level : "Moderiate"`,language:"kuery"},label:"Moderiate"},{input:{query:`${e}.risk.calculated_level : "High"`,language:"kuery"},label:"High"},{input:{query:`${e}.risk.calculated_level : "Critical"`,language:"kuery"},label:"Critical"}]}},"75179122-96fc-40e1-93b4-8e9310af5f06":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!0}}},columnOrder:["a2e8541a-c22f-4e43-8a12-caa33edc5de0","75179122-96fc-40e1-93b4-8e9310af5f06"],sampling:1,incompleteColumns:{}}}},textBased:{layers:{}}},internalReferences:[{type:"index-pattern",id:i,name:`indexpattern-datasource-layer-${n}`}],adHocDataViews:{[i]:{id:i,title:`ml_${e}_risk_score_latest_${t.spaceId}`,timeFieldName:"",sourceFilters:[],fieldFormats:{},runtimeFieldMap:{},fieldAttrs:{},allowNoIndex:!1,name:`ml_${e}_risk_score_latest_${t.spaceId}_no_timestamp`}}},references:[]}};var J_=a(1362);const Y_=e=>Object.hasOwn(hm.b,e)?hm.b[e]:Rn.b,X_=ae()(ee.EuiFlexItem).withConfig({displayName:"DonutContainer",componentId:"sc-1b01ue2-0"})(["padding-right:",";padding-left:",";"],(({theme:e})=>e.eui.euiSizeXXL),(({theme:e})=>e.eui.euiSizeM)),eA=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledLegendItems",componentId:"sc-1b01ue2-1"})(["justify-content:center;"]),tA=({severityCount:e})=>{const[t,a,n]=(e=>{const[t,a,n]=Object(r.useMemo)((()=>{const t=Object.keys(hm.b);return[t.map((t=>({key:t,value:e[t]}))),t.map((e=>({color:hm.b[e],field:"kibana.alert.severity",value:e}))),Object(A.sum)(Object.values(e))]}),[e]);return[t,a,n]})(e);return s.a.createElement(ee.EuiFlexGroup,{responsive:!1,"data-test-subj":"risk-score-donut-chart"},s.a.createElement(eA,{grow:!1},a.length>0&&s.a.createElement(Rg,{legendItems:a})),s.a.createElement(X_,{grow:!1,className:"eui-textCenter"},s.a.createElement(Ki.a,{data:null!=t?t:null,fillColor:Y_,height:120,label:J_.b,title:s.a.createElement(Ji.a,{count:n}),totalCount:n})))},aA=({dataExists:e,kpiQueryId:t,riskEntity:a,severityCount:n,timerange:i,selectedSeverity:o})=>{const l=Object(ve.a)("donutChartEmbeddablesEnabled"),c=Object(hl.a)(),u=Object(r.useMemo)((()=>({spaceId:c,filters:ct(o,a)})),[c,o,a]);return s.a.createElement(s.a.Fragment,null,l&&c&&e&&s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:!1,donutTextWrapperClassName:"risk-score",extraOptions:u,getLensAttributes:K_,height:180,id:`${t}-donut`,isDonut:!0,label:J_.b,stackByField:a,timerange:i,width:"270px"}),!l&&s.a.createElement(tA,{severityCount:null!=n?n:rt.c}))},nA=s.a.memo(aA),iA=({riskEntity:e})=>{const{deleteQuery:t,setQuery:a,from:i,to:o}=Object(xe.a)(),[l,u]=Object(r.useState)(Date.now()),d=(e=>{const t=Object(c.useDispatch)();return e===Q_.c.host?{linkProps:{deepLinkId:P.a.hosts,path:Object(H_.c)(We.HostsTableType.risk),onClick:()=>{t(n.updateHostRiskScoreSeverityFilter({severitySelection:[],hostsType:We.HostsType.page}))}},tableQueryId:"hostRiskDashboardTable",kpiQueryId:"headerHostRiskScoreKpiQuery"}:{linkProps:{deepLinkId:P.a.users,path:Object(U_.b)(Uc.UsersTableType.risk),onClick:()=>{t(Ne.c.updateUserRiskScoreSeverityFilter({severitySelection:[]}))}},tableQueryId:"userRiskDashboardTable",kpiQueryId:"headerUserRiskScoreKpiQuery"}})(e),p=Ig(),{telemetry:m}=Object(h.i)().services,f=Object(r.useCallback)((t=>{m.reportEntityAlertsClicked({entity:e}),p([{title:Object(q_.h)(e),selectedOptions:[t],fieldName:e===rt.v.host?"host.name":"user.name"}])}),[m,e,p]),{toggleStatus:b,setToggleStatus:g}=Object(Er.a)(d.tableQueryId),y=Object(r.useMemo)((()=>((e,t)=>[{field:e===rt.v.host?"host.name":"user.name",name:q_.b(e),truncateText:!1,mobileOptions:{show:!0},className:"inline-actions-table-cell",render:t=>null!=t&&t.length>0?e===rt.v.host?s.a.createElement(s.a.Fragment,null,s.a.createElement($t.d,{hostName:t,hostTab:We.HostsTableType.risk}),s.a.createElement($_,{data:{value:t,field:"host.name"},triggerId:sr.d.DEFAULT,mode:sr.a.INLINE,visibleCellActions:2,disabledActionTypes:[sr.b.FILTER,sr.b.SHOW_TOP_N],metadata:{telemetry:tm}})):s.a.createElement(s.a.Fragment,null,s.a.createElement($t.m,{userName:t,userTab:Uc.UsersTableType.risk}),s.a.createElement($_,{data:{value:t,field:"user.name"},triggerId:sr.d.DEFAULT,mode:sr.a.INLINE,disabledActionTypes:[sr.b.FILTER,sr.b.SHOW_TOP_N]})):Object(Jc.d)()},{field:rt.w.timestamp,name:q_.d,truncateText:!1,mobileOptions:{show:!0},sortable:!0,width:"20%",render:e=>null!=e?s.a.createElement(Yc.b,{value:e}):Object(Jc.d)()},{field:e===rt.v.host?rt.w.hostRiskScore:rt.w.userRiskScore,width:"15%",name:q_.f(e),truncateText:!0,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Jc.d)()},{field:e===rt.v.host?rt.w.hostRisk:rt.w.userRisk,width:"25%",name:q_.c(e),truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement(xu.a,{severity:e}):Object(Jc.d)()},{field:rt.w.alertsCount,width:"10%",name:q_.a,truncateText:!1,mobileOptions:{show:!0},className:"inline-actions-table-cell",render:(a,n)=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiLink,{"data-test-subj":"risk-score-alerts",disabled:0===a,onClick:()=>t(e===rt.v.host?n.host.name:n.user.name)},s.a.createElement(Xn.a,{count:a})),s.a.createElement($_,{data:{value:e===rt.v.host?n.host.name:n.user.name,field:e===rt.v.host?"host.name":"user.name"},mode:sr.a.INLINE,triggerId:sr.d.ALERTS_COUNT,metadata:{andFilters:[{field:"kibana.alert.workflow_status",value:"open"}]}}))}])(e,f)),[e,f]),[v,E]=Object(r.useState)([]),x=Object(r.useCallback)((e=>{E(e)}),[]),j=Object(r.useMemo)((()=>{const[t]=ct(v,e);return t||void 0}),[e,v]),{filterQuery:S}=$M({extraFilter:j}),O=Object(r.useMemo)((()=>({from:i,to:o})),[i,o]),{severityCount:k,loading:w,refetch:T,inspect:I}=Object(Gm.d)({filterQuery:S,skip:!b,timerange:O,riskEntity:e});Object($a.b)({queryId:d.kpiQueryId,loading:w,refetch:T,setQuery:a,deleteQuery:t,inspect:I});const{data:C,loading:M,inspect:_,refetch:A,isDeprecated:D,isAuthorized:N,isModuleEnabled:R}=Object(Gm.c)({filterQuery:S,skip:!b,pagination:{cursorStart:0,querySize:5},timerange:O,riskEntity:e,includeAlertsCount:!0});Object($a.b)({queryId:d.tableQueryId,loading:M,refetch:A,setQuery:a,deleteQuery:t,inspect:_}),Object(r.useEffect)((()=>{u(Date.now())}),[M,w]);const L=(()=>{const e=Object(r.useMemo)((()=>Object(Fe.h)()),[]),t=Object(F.a)((t=>e(t,Ee.a.global)));return Object(r.useCallback)((()=>{t.forEach((e=>e.refetch&&e.refetch()))}),[t])})();if(!N)return null;const B={isDisabled:!R&&!M,isDeprecated:D&&!M};return B.isDisabled||B.isDeprecated?s.a.createElement(gm,bo()({},B,{entityType:e,refetch:L,timerange:O})):R&&0===v.length&&C&&0===C.length?s.a.createElement(Jm,{entityType:e,refetch:L}):s.a.createElement(ga.c,null,s.a.createElement(su.a,{hasBorder:!0,"data-test-subj":`entity_analytics_${e}s`},s.a.createElement(Li.a,{title:s.a.createElement(Pp.a,{riskScoreEntity:e}),titleSize:"s",subtitle:s.a.createElement(zg,{isUpdating:M||w,updatedAt:l}),id:d.tableQueryId,toggleStatus:b,toggleQuery:g},s.a.createElement(W_,{entityLinkProps:d.linkProps,onSelectSeverityFilterGroup:x,riskEntity:e,selectedSeverity:v,severityCount:k,toggleStatus:b})),b&&s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"entity_analytics_content"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(nA,{dataExists:C&&C.length>0,kpiQueryId:d.kpiQueryId,riskEntity:e,severityCount:k,timerange:O,selectedSeverity:v})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(V_,{responsive:!1,items:null!=C?C:[],columns:y,loading:M,id:d.tableQueryId,rowProps:{className:"EntityAnalyticsTableHoverActions"}}))),(M||w)&&s.a.createElement(eu.a,{"data-test-subj":"loadingPanelRiskScore",overlay:!0,size:"xl"})))},rA=s.a.memo(iA);rA.displayName="EntityAnalyticsRiskScores";var sA=a(605);const oA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalHosts",{defaultMessage:"Critical Hosts"}),lA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalUsers",{defaultMessage:"Critical Users"}),cA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.header.anomalies",{defaultMessage:"Anomalies"});var uA=a(1464);const dA=({from:e,to:t,jobIds:a,anomalyScoreThreshold:n})=>({size:0,query:{bool:{filter:[{term:{result_type:"record"}},{range:{record_score:{gte:n}}},{range:{timestamp:{gte:e,lte:t}}},{terms:{job_id:a}}]}},aggs:{number_of_anomalies:{terms:{field:"job_id",size:1e4},aggs:{entity:{top_hits:{_source:!1,fields:["host.name","user.name"],size:1}}}}}});var pA=a(690);let mA;!function(e){e[e.User=0]="User",e[e.Host=1]="Host"}(mA||(mA={}));const fA=({skip:e,from:t,to:a})=>{const[n,i]=Object(r.useState)([]),{loading:s,isMlAdmin:o,jobs:c,refetch:u}=Object(pA.a)(),[d,p]=Object(r.useState)(!0),{addError:m}=Object(Pt.a)(),[f]=Object(h.o)(l.y),{query:b}=Object(r.useMemo)((()=>({query:dA({jobIds:c.map((({id:e})=>e)),anomalyScoreThreshold:f,from:t,to:a})})),[c,f,t,a]);return Object(r.useEffect)((()=>{let t=!0;const a=new AbortController;return async function(){if(t)if(!e&&o&&0!==c.length){p(!0);try{const e=await(async(e,t)=>h.b.get().http.fetch("/internal/ml/results/anomaly_search",{method:"POST",version:"1",body:JSON.stringify(e),asSystemRequest:!0,signal:t}))({jobIds:c.filter((e=>e.isInstalled)).map((({id:e})=>e)),query:b},a.signal);if(t){var n,r;p(!1);const t=null!==(n=null===(r=e.aggregations)||void 0===r?void 0:r.number_of_anomalies.buckets)&&void 0!==n?n:[];i(function(e,t){const a=t.map((t=>{var a,n,i;const r=e.find((({key:e})=>e===(null==t?void 0:t.id))),s=Object(A.has)("entity.hits.hits[0].fields['user.name']",r);return{name:null!==(a=null==t||null===(n=t.customSettings)||void 0===n?void 0:n.security_app_display_name)&&void 0!==a?a:t.id,count:null!==(i=null==r?void 0:r.doc_count)&&void 0!==i?i:0,entity:s?mA.User:mA.Host,job:t}}));return Object(A.sortBy)(["name"],a)}(t,c))}}catch(e){t&&"AbortError"!==e.name&&(m(e,{title:uA.a}),p(!1))}}else p(!1)}(),()=>{t=!1,a.abort()}}),[e,o,m,b,c,u]),{isLoading:d||s,data:n,refetch:u}};var bA=a(86);const gA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomaliesTitle",{defaultMessage:"Anomalies"}),yA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyName",{defaultMessage:"Anomaly name"}),hA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyCount",{defaultMessage:"Count"}),vA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewUsersAnomalies",{defaultMessage:"View all user anomalies"}),EA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewHostsAnomalies",{defaultMessage:"View all host anomalies"}),xA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewAnomalies",{defaultMessage:"View all"}),jA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.enableJob",{defaultMessage:"Run job"}),SA=(Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusDisabled",{defaultMessage:"disabled"}),Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusUninstalled",{defaultMessage:"uninstalled"}),Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusFailed",{defaultMessage:"failed"})),OA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusLoading",{defaultMessage:"Waiting"}),kA=e=>Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job is} other {jobs are}} currently unavailable"}),wA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.AnomalyDetectionDocsTitle",{defaultMessage:"Anomaly Detection with Machine Learning"}),TA=Y.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),IA=({count:e,jobId:t,entity:a})=>{const i=Object(c.useDispatch)(),o=a===mA.User?P.a.usersAnomalies:P.a.hostsAnomalies,l=Object(r.useCallback)((()=>{t&&(a===mA.User?(i(Ne.c.updateUsersAnomaliesJobIdFilter({jobIds:[t],usersType:Uc.UsersType.page})),i(Ne.c.updateUsersAnomaliesInterval({interval:"second",usersType:Uc.UsersType.page}))):(i(n.updateHostsAnomaliesJobIdFilter({jobIds:[t],hostsType:We.HostsType.page})),i(n.updateHostsAnomaliesInterval({interval:"second",hostsType:We.HostsType.page}))))}),[t,i,a]);return s.a.createElement($t.k,{onClick:l,deepLinkId:o},e)};var CA=a(897);const MA=({job:e,isLoading:t,onJobEnabled:a})=>{const{enableDatafeed:n,isLoading:i}=Object(CA.a)(),o=Object(r.useCallback)((async()=>{(await n(e,e.latestTimestampMs||0)).enabled&&a(e)}),[n,e,a]);return t||i?s.a.createElement(ee.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):s.a.createElement($t.f,{onClick:o,"data-test-subj":"enable-job"},jA)},_A=({count:e,job:t,entity:a,recentlyEnabledJobIds:n,loading:i,onJobEnabled:r})=>Object(qy.b)(t.jobState,t.datafeedState)?s.a.createElement(s.a.Fragment,null,OA):Object(qy.a)(t.jobState,t.datafeedState)?s.a.createElement(s.a.Fragment,null,SA):e>0||Object(qy.c)(t.jobState,t.datafeedState)||n.includes(t.id)?s.a.createElement(IA,{count:e,jobId:t.id,entity:a}):t.isCompatible?s.a.createElement(MA,{job:t,isLoading:i,onJobEnabled:r}):s.a.createElement(ee.EuiIcon,{"aria-label":"Warning",size:"s",type:"warning",color:"warning"}),AA=ae.a.span.withConfig({displayName:"MediumShadeText",componentId:"sc-19sbgzu-0"})(["color:",";"],(({theme:e})=>e.eui.euiColorMediumShade)),FA="entityAnalyticsDashboardAnomaliesTable",PA={sort:{field:"count",direction:"desc"}},DA="entity_analytics_anomalies",NA=()=>{const[e,t]=Object(r.useState)([]),{services:{ml:a,http:n,docLinks:i}}=Object(h.i)(),o=Object(bA.useMlHref)(a,n.basePath.get(),{page:bA.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE}),[l,c]=Object(r.useState)(Date.now()),{toggleStatus:u,setToggleStatus:d}=Object(Er.a)(FA),{deleteQuery:p,setQuery:m,from:f,to:b}=Object(xe.a)(),{isLoading:g,data:y,refetch:v}=fA({skip:!u,from:f,to:b}),E=((e,t,a)=>Object(r.useMemo)((()=>[{field:"name",name:yA,truncateText:!0,mobileOptions:{show:!0},"data-test-subj":"anomalies-table-column-name",render:(e,{count:t,job:n})=>t>0||n&&(Object(qy.c)(n.jobState,n.datafeedState)||a.includes(n.id))?e:s.a.createElement(AA,null,e)},{field:"count",sortable:({count:e,job:t})=>e>0?e:t&&Object(qy.c)(t.jobState,t.datafeedState)?0:-1,truncateText:!0,align:"right",name:hA,mobileOptions:{show:!0},width:"15%","data-test-subj":"anomalies-table-column-count",render:(n,{entity:i,job:r})=>r?s.a.createElement(_A,{count:n,job:r,entity:i,loading:e,onJobEnabled:t,recentlyEnabledJobIds:a}):""}]),[e,t,a]))(g,Object(r.useCallback)((async e=>{t((t=>[...t,e.id]))}),[]),e),x=Object($t.o)();Object(r.useEffect)((()=>{c(Date.now())}),[g]),Object($a.b)({refetch:v,queryId:FA,loading:g,setQuery:m,deleteQuery:p});const[j,S]=Object(r.useMemo)((()=>{const{onClick:e,href:t}=x({deepLinkId:P.a.hosts,path:Object(H_.c)(We.HostsTableType.anomalies)});return[e,t]}),[x]),[O,k]=Object(r.useMemo)((()=>{const{onClick:e,href:t}=x({deepLinkId:P.a.users,path:Object(U_.b)(Uc.UsersTableType.anomalies)});return[e,t]}),[x]),w=Object(r.useMemo)((()=>y.filter((({job:e})=>!!e&&e.isInstalled)).map((({job:e})=>{var t;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""})).concat(e)),[y,e]),T=Object(r.useMemo)((()=>y.filter((({job:e})=>e&&!e.isCompatible)).length),[y]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0,"data-test-subj":DA},s.a.createElement(Li.a,{title:gA,titleSize:"s",subtitle:s.a.createElement(zg,{isUpdating:g,updatedAt:l}),toggleStatus:u,toggleQuery:d,tooltip:TA},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.f,{"data-test-subj":"anomalies_table_hosts_link",onClick:j,href:S,className:"eui-textNoWrap"},EA)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.f,{"data-test-subj":"anomalies_table_users_link",onClick:O,href:k,className:"eui-textNoWrap"},vA)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($t.g,{"data-test-subj":"anomalies_table_all",href:o,target:"_blank"},xA)))),u&&s.a.createElement(s.a.Fragment,null,T>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{title:kA(T),"data-test-subj":"incompatible_jobs_warnings",color:"warning",iconType:"warning",size:"s"},s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:s.a.createElement("a",{href:`${i.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},wA)}}))),s.a.createElement(ee.EuiSpacer,{size:"m"})),s.a.createElement(bA.MLJobsAwaitingNodeWarning,{jobIds:w}),s.a.createElement(ee.EuiInMemoryTable,{responsive:!1,items:y,columns:E,pagination:{showPerPageOptions:!0},loading:g,id:FA,sorting:PA})))},RA=ae()(ee.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-32r58o-0"})(["color:",";"],(({theme:{eui:e}})=>Ln.b.critical)),LA=()=>{const{from:e,to:t}=Object(xe.a)(),{filterQuery:a}=$M(),i=Object(r.useMemo)((()=>({from:e,to:t})),[e,t]),{severityCount:o,loading:l,inspect:u,refetch:d}=Object(Gm.d)({timerange:i,riskEntity:rt.v.host,filterQuery:a}),{severityCount:p,loading:m,refetch:f,inspect:b}=Object(Gm.d)({filterQuery:a,timerange:i,riskEntity:rt.v.user}),{data:g}=fA({skip:!1,from:e,to:t}),y=Object(c.useDispatch)(),h=Object($t.o)(),v=Object(ju.a)().isPlatinumOrTrialLicense,[E,x]=Object(r.useMemo)((()=>{const{onClick:e,href:t}=h({deepLinkId:P.a.hosts,path:Object(H_.c)(We.HostsTableType.risk),onClick:()=>{y(n.updateHostRiskScoreSeverityFilter({severitySelection:[rt.x.critical],hostsType:We.HostsType.page})),y(n.updateHostRiskScoreSort({sort:{field:rt.w.hostRiskScore,direction:rt.b.desc},hostsType:We.HostsType.page}))}});return[e,t]}),[y,h]),[j,S]=Object(r.useMemo)((()=>{const{onClick:e,href:t}=h({deepLinkId:P.a.users,path:Object(U_.b)(Uc.UsersTableType.risk),onClick:()=>{y(Ne.c.updateUserRiskScoreSeverityFilter({severitySelection:[rt.x.critical]})),y(Ne.c.updateTableSorting({sort:{field:rt.w.userRiskScore,direction:rt.b.desc},tableType:Uc.UsersTableType.risk}))}});return[e,t]}),[y,h]),{deleteQuery:O,setQuery:k}=Object(xe.a)();Object($a.b)({queryId:"userRiskScoreKpiQuery",loading:m,refetch:f,setQuery:k,deleteQuery:O,inspect:b}),Object($a.b)({queryId:"hostRiskScoreKpiQuery",loading:l,refetch:d,setQuery:k,deleteQuery:O,inspect:u});const w=Object(r.useMemo)((()=>g.some((({job:e,count:t})=>t>0||e&&Object(qy.c)(e.jobState,e.datafeedState)))),[g]),T=Object(r.useMemo)((()=>w?s.a.createElement(Xn.a,{count:Object(A.sumBy)("count",g)}):"-"),[g,w]),I=Object(r.useCallback)((()=>{const e=document.querySelector(`[data-test-subj="${DA}"]`);e&&e.scrollIntoView({behavior:"smooth"})}),[]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0,paddingSize:"l"},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceAround",responsive:!1},v&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(ee.EuiFlexItem,{className:"eui-textCenter"},s.a.createElement(RA,{"data-test-subj":"critical_hosts_quantity",size:"l"},s.a.createElement("span",null,o?s.a.createElement(Xn.a,{count:o[rt.x.critical]}):"-"))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.f,{onClick:E,href:x,"data-test-subj":"critical_hosts_link"},oA)))),v&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(ee.EuiFlexItem,{className:"eui-textCenter"},s.a.createElement(RA,{"data-test-subj":"critical_users_quantity",size:"l"},s.a.createElement("span",null,p?s.a.createElement(Xn.a,{count:p[rt.x.critical]}):"-"))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement($t.f,{onClick:j,href:S,"data-test-subj":"critical_users_link"},lA)))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},s.a.createElement(ee.EuiFlexItem,{className:"eui-textCenter"},s.a.createElement(ee.EuiTitle,{"data-test-subj":"anomalies_quantity",size:"l"},s.a.createElement("span",null,T))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiLink,{"data-test-subj":"all_anomalies_link",onClick:I},cA))))))},BA=()=>{const{data:e}=Object(Lu.c)(),{indicesExist:t,loading:a,sourcererDataView:n}=Object(E.d)(),i=Object(Am.a)("entity-analytics");return s.a.createElement(s.a.Fragment,null,t?s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,null,s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:n})),s.a.createElement(S.a,{"data-test-subj":"entityAnalyticsPage"},s.a.createElement(oo,{title:sA.j}),a?s.a.createElement(ee.EuiLoadingSpinner,{size:"l","data-test-subj":"entityAnalyticsLoader"}):s.a.createElement(ee.EuiFlexGroup,{direction:"column","data-test-subj":"entityAnalyticsSections"},(null==e?void 0:e.isUpdateAvailable)&&i&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(Df,null)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(LA,null)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(rA,{riskEntity:rt.v.host})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(rA,{riskEntity:rt.v.user})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(NA,null))))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.entityAnalytics}))},zA=s.a.memo(BA),qA=Object(r.memo)((()=>s.a.createElement($A,null,s.a.createElement(S.a,{noPadding:!0},s.a.createElement(co.a,null),s.a.createElement(_,{pageName:l.yc.landing})))));qA.displayName="LandingPage";var $A=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1qv8avm-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);const VA=[{path:l.Wb,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.overview},s.a.createElement(YC,null)))},{path:l.mb,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.detectionAndResponse},s.a.createElement(z_,null)))},{path:l.Ib,render:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.landing},s.a.createElement(qA,null)))},{path:l.tb,render:()=>s.a.createElement(Q,null,s.a.createElement(Lc,{pageName:l.yc.entityAnalytics},s.a.createElement(zA,null)))},{path:l.v,component:()=>s.a.createElement(Q,null,s.a.createElement(Lc,{pageName:l.yc.dataQuality},s.a.createElement(cM,null)))}],UA=Y.i18n.translate("xpack.securitySolution.rules.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete rules"}),HA=(Y.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.activeLabel",{defaultMessage:"Active"}),Y.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.recoveredLabel",{defaultMessage:"Recovered"}),Y.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.flappingLabel",{defaultMessage:"Flapping"}),Y.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.untrackedLabel",{defaultMessage:"Untracked"}),Object.freeze({kibana:{id:"kibana",label:Y.i18n.translate("core.ui.kibanaNavList.label",{defaultMessage:"Analytics"}),euiIconType:"logoKibana",order:1e3},enterpriseSearch:{id:"enterpriseSearch",label:Y.i18n.translate("core.ui.searchNavList.label",{defaultMessage:"Search"}),order:2e3,euiIconType:"logoEnterpriseSearch"},observability:{id:"observability",label:Y.i18n.translate("core.ui.observabilityNavList.label",{defaultMessage:"Observability"}),euiIconType:"logoObservability",order:3e3},security:{id:"securitySolution",label:Y.i18n.translate("core.ui.securityNavList.label",{defaultMessage:"Security"}),order:4e3,euiIconType:"logoSecurity"},management:{id:"management",label:Y.i18n.translate("core.ui.managementNavList.label",{defaultMessage:"Management"}),order:5e3,euiIconType:"managementApp"}}));let QA;!function(e){e.Running="running",e.Upcoming="upcoming",e.Finished="finished",e.Archived="archived"}(QA||(QA={}));const GA=({http:e,notifications:{toasts:t}},{enabled:a})=>Object(ih.useQuery)(["GET",WA],(({signal:t})=>(async(e,t)=>(await e.fetch("/internal/alerting/rules/maintenance_window/_active",{method:"GET",signal:t})).map((e=>(({expiration_date:e,r_rule:t,created_by:a,updated_by:n,created_at:i,updated_at:r,event_start_time:s,event_end_time:o,category_ids:l,...c})=>({...c,expirationDate:e,rRule:t,createdBy:a,updatedBy:n,createdAt:i,updatedAt:r,eventStartTime:s,eventEndTime:o,categoryIds:l}))(e))))(e,t)),{enabled:a,refetchInterval:6e4,onError:e=>{t.addError(e,{title:ZA,toastMessage:KA})}}),WA="/internal/alerting/rules/maintenance_window/_active",ZA=Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.fetchError",{defaultMessage:"Failed to check if maintenance windows are active"}),KA=Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.fetchErrorDescription",{defaultMessage:"Rule notifications are stopped while maintenance windows are running."}),JA="maintenanceWindow",YA=Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowActiveDescription",{defaultMessage:"Rule notifications are stopped while maintenance windows are running."}),XA=Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowActiveNoCategories",{defaultMessage:"One or more maintenance windows are running"}),eF=e=>Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowTwoCategoryNames",{defaultMessage:"{first} and {second}",values:{first:e[0],second:e[1]}}),tF=e=>Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowMultipleCategoryNames",{defaultMessage:"{commaSeparatedList}, and {last}",values:{commaSeparatedList:e.slice(0,-1).join(", "),last:e.slice(-1).join("")}}),aF={...HA,management:{...HA.management,label:Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.managementCategoryLabel",{defaultMessage:"Stack"})}};function nF({kibanaServices:e,categories:t}){const{application:{capabilities:a}}=e,n=!a[JA].show&&!a[JA].save,{data:i=[]}=GA(e,{enabled:!n}),s=Object(r.useMemo)((()=>!!i&&0!==i.length&&(!Array.isArray(t)||i.some((({status:e,categoryIds:a})=>e===QA.Running&&(!Array.isArray(a)||a.some((e=>t.includes(e)))))))),[t,i]),o=Object(r.useMemo)((()=>{const e=Array.from(new Set(i.map((({categoryIds:e})=>null==e?void 0:e.filter((e=>!t||t.includes(e))))).flat())).map((e=>{var t,a;return null!==(t=null===(a=Object.values(aF).find((t=>t.id===e)))||void 0===a?void 0:a.label)&&void 0!==t?t:e})).filter(Boolean);return 0===e.length?null:1===e.length?`${e}`:2===e.length?eF(e):tF(e)}),[i,t]);return n?null:s?Object(Ws.jsx)(ee.EuiCallOut,{title:o?Y.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowActive",{defaultMessage:"{activeWindowCount, plural, one {A maintenance window is} other {Maintenance windows are}} running for {categories} rules",values:{categories:o,activeWindowCount:i.length}}):XA,color:"warning",iconType:"iInCircle","data-test-subj":"maintenanceWindowCallout"},YA):null}a(1660);Y.i18n.translate("alertsUIShared.components.addMessageVariables.loadingMessage",{defaultMessage:"Loading variables"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.noVariablesFound",{defaultMessage:"No variables found"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.noVariablesAvailable",{defaultMessage:"No variables available"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.deprecatedVariablesAreShown",{defaultMessage:"Deprecated variables are shown"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.deprecatedVariablesAreHidden",{defaultMessage:"Deprecated variables are hidden"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.hideDeprecatedVariables",{defaultMessage:"Hide"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.showAllDeprecatedVariables",{defaultMessage:"Show all"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.addVariablePopoverButton",{defaultMessage:"Add variable"}),Y.i18n.translate("alertsUIShared.components.addMessageVariables.addRuleVariableTitle",{defaultMessage:"Add variable"}),Y.i18n.translate("alertsUIShared.component.alertsSearchBar.placeholder",{defaultMessage:"Search alerts (e.g. kibana.alert.evaluation.threshold > 75)"});var iF=a(750);const rF=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user","windows_rare_user_type10_remote_login"],sF=()=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules use ML jobs that in turn have dependencies on data fields populated by the Beats and Elastic Agent integrations that were current when the ML job was created. New ML jobs, prefixed with V3, have been released to operate on now-current ECS fields. If you're using multiple versions of Beats or Elastic Agent, you may need to duplicate or create new machine learning rules that specify the new ML (V3) jobs and enable them to run alongside your existing rules, to ensure continued rule coverage using V1/V2 jobs."})),docs:s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(Os,null)))}}),oF={type:"primary",id:"ml-job-compatibility",title:Y.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:s.a.createElement(sF,null)},lF=()=>{const{loading:e,jobs:t}=Object(Nd.b)(),a=t.some((e=>rF.includes(e.id)));return s.a.createElement(us,{namespace:"detections",condition:!e&&a,message:oF})},cF=Object(r.memo)(lF);var uF=a(11),dF=a.n(uF),pF=a(692);const mF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.installPrebuiltRules.title",{defaultMessage:"Install your first prebuilt rule"}),fF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.installPrebuiltRules.content",{defaultMessage:'Navigate to the Add Elastic Rules page and install the example "My First Rule".'}),bF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.searchFirstRule.title",{defaultMessage:"Find your first rule"}),gF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.enableFirstRule.title",{defaultMessage:"Enable the rule"}),yF=e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.enableFirstRule.content",{defaultMessage:'Enable "{name}" or click next.',values:{name:e}}),hF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.nextButton",{defaultMessage:"Next"});var vF=a(722);const EF="install-prebuilt-rules-anchor",xF="search-first-rule-anchor",jF={filter:"",showCustomRules:!1,showElasticRules:!0,tags:["Use Case: Guided Onboarding"]};let SF;!function(e){e.inactive="inactive",e.installRules="installRules",e.searchRules="searchRules",e.enableRules="enableRules",e.completed="completed"}(SF||(SF={}));const OF=()=>{var e,t;const{guidedOnboarding:a}=Object(h.i)().services,{executeBulkAction:n}=xh(),{actions:i}=Object(nh.b)(),o=dF()(null!==(e=null==a||null===(t=a.guidedOnboardingApi)||void 0===t?void 0:t.isGuideStepActive$(pF.a,"rules"))&&void 0!==e?e:Object(Ie.of)(!1),!1),{data:l}=Object(rh.a)({filterOptions:jF},{enabled:o}),c=Object(r.useMemo)((()=>{if(null!=l&&l.rules.length)return l.rules[0]}),[l]),u=c?`rule-switch-${c.id}`:"",d=Object(vF.a)(EF),p=Object(vF.a)(xF),m=Object(vF.a)(u),f=Object(r.useMemo)((()=>o&&l?0===l.total?SF.installRules:null!=c&&c.enabled?SF.completed:m?SF.enableRules:SF.searchRules:SF.inactive),[null==c?void 0:c.enabled,m,o,l]);Object(r.useEffect)((()=>{var e;o&&f===SF.completed&&(null==a||null===(e=a.guidedOnboardingApi)||void 0===e||e.completeGuideStep("siem","rules"))}),[a,o,f]);const b=Object(r.useCallback)((async()=>{c&&await n({type:th.b.enable,ids:[c.id]})}),[c,n]),g=Object(r.useCallback)((()=>{c&&i.setFilterOptions({filter:c.name})}),[i,c]);return s.a.createElement(s.a.Fragment,null,d&&s.a.createElement(ee.EuiTourStep,{title:mF,content:fF,onFinish:I.noop,step:1,stepsTotal:3,isOpen:f===SF.installRules,anchor:`#${EF}`,anchorPosition:"downCenter",footerAction:s.a.createElement("div",null)}),p&&c&&s.a.createElement(ee.EuiTourStep,{title:bF,content:(y=c.name,Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.searchFirstRule.content",{defaultMessage:'Search for "{name}" or click next.',values:{name:y}})),onFinish:I.noop,step:2,stepsTotal:3,isOpen:f===SF.searchRules,anchor:`#${xF}`,anchorPosition:"upCenter",footerAction:s.a.createElement(ee.EuiButtonEmpty,{size:"xs",color:"text",flush:"right",onClick:g},hF)}),m&&c&&s.a.createElement(ee.EuiTourStep,{title:gF,content:yF(c.name),onFinish:I.noop,step:3,stepsTotal:3,isOpen:f===SF.enableRules,anchor:`#${u}`,anchorPosition:"upCenter",footerAction:s.a.createElement(ee.EuiButtonEmpty,{size:"xs",color:"text",flush:"right",onClick:b},hF)}));var y},kF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),wF=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to enable."}),TF=(Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleUpdatesLinkTitle",{defaultMessage:"Rule Updates"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.addElasticRulesButtonTitle",{defaultMessage:"Add Elastic rules"}));Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.dismissTitle",{defaultMessage:"Dismiss"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedRulesButton",{defaultMessage:"Load Elastic prebuilt rules"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedTimelineTemplatesButton",{defaultMessage:"Load Elastic prebuilt timeline templates"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedRulesAndTemplatesButton",{defaultMessage:"Load Elastic prebuilt rules and timeline templates"});var IF=a(557);const CF=()=>{const{addError:e}=Object(Pt.a)();return Object(lh.a)({onError:t=>{e(t,{title:IF.b})}})},MF=({"data-test-subj":e="addElasticRulesButton",fill:t,isDisabled:a,showBadge:n=!0})=>{var i;const r=Object($t.o)(),{onClick:o}=r({deepLinkId:uM.SecurityPageName.rulesAdd}),{data:l}=CF(),c=null!==(i=null==l?void 0:l.num_prebuilt_rules_to_install)&&void 0!==i?i:0,u=t?ee.EuiButton:ee.EuiButtonEmpty;return s.a.createElement(u,{id:EF,fill:t,iconType:"plusInCircle",color:"primary",onClick:o,"data-test-subj":e,isDisabled:a},TF,c>0&&n&&s.a.createElement(_F,{color:"#E0E5EE"},c))};var _F=ae()(ee.EuiBadge).withConfig({displayName:"_StyledEuiBadge",componentId:"sc-vx1kco-0"})(["margin-left:5px;"]),AF=a(165);const FF=Y.i18n.translate("xpack.securitySolution.lists.importValueListTitle",{defaultMessage:"Import value lists"}),PF=Y.i18n.translate("xpack.securitySolution.lists.importValueListDescription",{defaultMessage:"Import single value lists to use while writing rule exceptions."}),DF=Y.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),NF=Y.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),RF=Y.i18n.translate("xpack.securitySolution.lists.cancelValueListsImportTitle",{defaultMessage:"Cancel import"}),LF=Y.i18n.translate("xpack.securitySolution.lists.valueListImportButton",{defaultMessage:"Import value list"}),BF=Y.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccessTitle",{defaultMessage:"Value list imported"}),zF=Y.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),qF=Y.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),$F=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),VF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),UF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.importDateColumn",{defaultMessage:"Import Date"}),HF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),QF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),GF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"}),WF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"}),ZF=Y.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),KF=Y.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),JF=Y.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),YF=Y.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),XF=Y.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),eP=Y.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),tP=Y.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),aP=Y.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),nP=Y.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),iP=[{value:"keyword",text:YF},{value:"ip",text:JF},{value:"ip_range",text:XF},{value:"text",text:eP}],rP="keyword",sP=["text/csv","text/plain"],oP=({onError:e,onSuccess:t})=>{const a=Object(r.useRef)(new AbortController),[n,i]=Object(r.useState)(null),[o,l]=Object(r.useState)(rP),c=Object(r.useRef)(null),{http:u}=Object(h.i)().services,{start:d,...p}=Object(_t.j)(),m=!n||sP.some((e=>n.type===e)),f=Object(r.useCallback)((e=>l(e.target.value)),[l]),b=Object(r.useCallback)((e=>{var t;i(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),g=Object(r.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),i(null),l(rP)}),[]),y=Object(r.useCallback)((()=>{a.current.abort()}),[]),v=Object(r.useCallback)((e=>{g(),t(e)}),[g,t]),E=Object(r.useCallback)((t=>{e(t)}),[e]),x=Object(r.useCallback)((()=>{!p.loading&&n&&(a.current=new AbortController,d({file:n,listId:void 0,http:u,signal:a.current.signal,type:o}))}),[p.loading,n,d,u,o]);return Object(r.useEffect)((()=>{!p.loading&&p.result?v(p.result):!p.loading&&p.error&&E(p.error)}),[E,v,p.error,p.loading,p.result]),Object(r.useEffect)((()=>y),[y]),s.a.createElement(ee.EuiForm,null,s.a.createElement(ee.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:PF,fullWidth:!0,isInvalid:!m,error:[(j=sP.join(", "),Y.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:j},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},s.a.createElement(ee.EuiFilePicker,{accept:sP.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:DF,ref:c,onChange:b,fullWidth:!0,isLoading:p.loading,isInvalid:!m})),s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFormRow,{label:KF},s.a.createElement(ee.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:iP,value:o,onChange:f,name:"valueListType"}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFormRow,{hasEmptyLabelSpace:!0},s.a.createElement(ee.EuiFlexGroup,{alignItems:"flexEnd"},s.a.createElement(ee.EuiFlexItem,null,p.loading&&s.a.createElement(ee.EuiButtonEmpty,{onClick:y},RF)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:x,disabled:null==n||!m||p.loading},LF))))))));var j};oP.displayName="ValueListsFormComponent";const lP=s.a.memo(oP);lP.displayName="ValueListsForm";const cP=ae()(ee.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"sc-clxq5z-0"})(["margin:",";vertical-align:middle;"],(({theme:e})=>e.eui.euiSizeXS)),uP={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},dP=({onClose:e,showFlyout:t})=>{var a,n,i,o;const[l,c]=Object(r.useState)(0),[u,d]=Object(r.useState)(5),[p,m]=Object(_t.e)({pageIndex:l,pageSize:u}),{http:f}=Object(h.i)().services,{start:b,...g}=Object(_t.h)(),{start:y,result:v,error:E}=Object(_t.f)(),[x,j]=Object(r.useState)([]),[S,O]=Object(r.useState)([]),[k,w]=Object(r.useState)({}),{addError:T,addSuccess:I}=Object(Pt.a)(),[C,M]=Object(r.useState)(!1),[_,F]=Object(r.useState)(uP),P=Object(r.useCallback)((()=>{b({cursor:p,http:f,pageIndex:l+1,pageSize:u,sortOrder:"desc",sortField:"created_at"})}),[p,f,b,l,u]),D=Object(r.useCallback)((({deleteReferences:e,id:t})=>{j([...x,t]),y({deleteReferences:e,http:f,id:t})}),[y,x,f]),N=Object(r.useCallback)((async()=>{M(!1),y({deleteReferences:!0,http:f,id:_.valueListId}),F(uP),j([])}),[y,f,_.valueListId]);Object(r.useEffect)((()=>{null!=v&&(j((e=>[...e.filter((e=>e!==v.id))])),P())}),[v,P]),Object(r.useEffect)((()=>{if(!Object(A.isEmpty)(E)){var e,t,a,n,i,r,s,o;const c=null!==(e=null==E||null===(t=E.body)||void 0===t||null===(a=t.message)||void 0===a||null===(n=a.error)||void 0===n||null===(i=n.references)||void 0===i?void 0:i.map((e=>null==e?void 0:e.exception_list.name)))&&void 0!==e?e:[],u=Array.from(new Set(c));M(!0),F({contentText:(l=u.length,Y.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:l}})),exceptionListReferences:u,isLoading:!1,valueListId:null==E||null===(r=E.body)||void 0===r||null===(s=r.message)||void 0===s||null===(o=s.error)||void 0===o?void 0:o.value_list_id})}var l}),[E]);const R=Object(r.useCallback)((async({id:e})=>{try{O((t=>[...t,e]));const t=await Object(AF.i)({http:f,listId:e,signal:(new AbortController).signal});w({name:e,blob:t})}catch(e){T(e,{title:qF})}finally{O((t=>[...t.filter((t=>t!==e))]))}}),[T,f]),L=Object(r.useCallback)((({page:{index:e,size:t}})=>{c(e),d(t)}),[c,d]),B=Object(r.useCallback)((e=>{"AbortError"!==e.name&&T(e,{title:zF})}),[T]),z=Object(r.useCallback)((e=>{var t;I({text:(t=e.name,Y.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccess",{defaultMessage:"Value list '{fileName}' was imported",values:{fileName:t}})),title:BF}),P(),c(0)}),[I]);Object(r.useEffect)((()=>{t&&P()}),[t,P]),Object(r.useEffect)((()=>{var e;!g.loading&&null!==(e=g.result)&&void 0!==e&&e.cursor&&m(g.result.cursor)}),[g.loading,g.result,m]);const q=Object(r.useCallback)((()=>{j([]),M(!1),F({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})}),[]);if(!t)return null;const $=(null!==(a=null===(n=g.result)||void 0===n?void 0:n.data)&&void 0!==a?a:[]).map((e=>({...e,isDeleting:x.includes(e.id),isExporting:S.includes(e.id)}))),V={pageIndex:l,pageSize:u,totalItemCount:null!==(i=null===(o=g.result)||void 0===o?void 0:o.total)&&void 0!==i?i:0,showPerPageOptions:!1},U=(H=R,Q=D,[{field:"name",name:$F,truncateText:!1},{field:"type",name:VF,width:"15%",truncateText:!0,render:e=>{const t=iP.find((({value:t})=>t===e));return s.a.createElement(s.a.Fragment,null,t?t.text:e)}},{field:"created_at",name:UF,render:e=>s.a.createElement(Yc.a,{value:e,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:HF,truncateText:!0,width:"20%"},{name:QF,actions:[{render:e=>s.a.createElement(ee.EuiToolTip,{content:GF},e.isExporting?s.a.createElement(cP,{size:"m"}):s.a.createElement(ee.EuiButtonIcon,{"aria-label":GF,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>H(e)}))},{render:e=>s.a.createElement(ee.EuiToolTip,{content:WF},e.isDeleting?s.a.createElement(cP,{size:"m"}):s.a.createElement(ee.EuiButtonIcon,{"aria-label":WF,"data-test-subj":`action-delete-value-list-${e.name}`,iconType:"trash",onClick:()=>Q(e)}))}],width:"15%"}]);var H,Q;return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlyout,{onClose:e,maxWidth:800},s.a.createElement(ee.EuiFlyoutHeader,null,s.a.createElement(ee.EuiTitle,null,s.a.createElement("h2",null,FF))),s.a.createElement(ee.EuiFlyoutBody,null,s.a.createElement(lP,{onSuccess:z,onError:B}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("h2",null,ZF)),s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:U,items:$,loading:g.loading,onChange:L,pagination:V})),s.a.createElement(ee.EuiFlyoutFooter,null,s.a.createElement(ee.EuiButton,{"data-test-subj":"value-lists-flyout-close-action",onClick:e},NF))),s.a.createElement(Ec,{cancelText:aP,confirmText:nP,contentText:_.contentText,onCancel:q,onClose:q,onConfirm:N,references:_.exceptionListReferences,showModal:C,titleText:tP}),s.a.createElement(mc,{blob:k.blob,name:k.name,onDownload:()=>w({})}))};dP.displayName="ValueListsFlyoutComponent";const pP=s.a.memo(dP);pP.displayName="ValueListsFlyout";var mP=a(607),fP=a(602),bP=a(881),gP=a(1115);const yP=ae()(ee.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-17fyd7j-0"})(["align-self:center;"]);yP.displayName="EmptyPrompt";const hP=()=>{const[{loading:e,canUserCRUD:t}]=Object(kt.b)();return s.a.createElement(yP,{"data-test-subj":"rulesEmptyPrompt",title:s.a.createElement("h2",null,kF),body:s.a.createElement("p",null,wF),actions:s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(MF,{isDisabled:!t||e,fill:!0,"data-test-subj":"add-elastc-rules-empty-empty-prompt-button",showBadge:!1})))})},vP=Object(r.memo)(hP),EP=({errorCode:e,message:t,rulesCount:a})=>{switch(e){case l.q.IMMUTABLE:return s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesEditDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (editing prebuilt rules is not supported)",values:{rulesCount:a}}));case l.q.MACHINE_LEARNING_INDEX_PATTERN:return s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesIndexEditDescription",defaultMessage:"{rulesCount, plural, =1 {# custom machine learning rule} other {# custom machine learning rules}} (these rules don't have index patterns)",values:{rulesCount:a}}));case l.q.MACHINE_LEARNING_AUTH:return s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesAuthDescription",defaultMessage:"{rulesCount, plural, =1 {# machine learning rule} other {# machine learning rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}));case l.q.ESQL_INDEX_PATTERN:return s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.esqlRulesIndexEditDescription",defaultMessage:"{rulesCount, plural, =1 {# custom ES|QL rule} other {# custom ES|QL rules}} (these rules don't have index patterns)",values:{rulesCount:a}}));default:return s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesEditFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}))}},xP=({errorCode:e,message:t,rulesCount:a})=>e===l.q.IMMUTABLE?s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesExportDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (exporting prebuilt rules is not supported)",values:{rulesCount:a}})):s.a.createElement("li",{key:t},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesExportFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be exported ({message})",values:{rulesCount:a,message:t}})),jP=({ruleErrors:e=[],bulkAction:t})=>0===e.length?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.actionRejectionDescription",defaultMessage:"This action can't be applied to the following rules in your selection:"}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement("ul",null,e.map((({message:e,errorCode:a,ruleIds:n})=>{const i=n.length;switch(t){case th.b.edit:return s.a.createElement(EP,{message:e,errorCode:a,rulesCount:i});case th.b.export:return s.a.createElement(xP,{message:e,errorCode:a,rulesCount:i});default:return null}})))),SP=s.a.memo(jP);SP.displayName="BulkActionRuleErrorsList";const OP=(e,t)=>{switch(e){case th.b.edit:return Oo.A(t);case th.b.export:return Oo.Y(t);default:Object(Yr.a)(e)}},kP=(e,t)=>{switch(e){case th.b.edit:return Oo.z(t);case th.b.export:return Oo.X(t);default:Object(Yr.a)(e)}},wP=({onCancel:e,onConfirm:t,result:a,bulkAction:n})=>{const{failedRulesCount:i=0,succeededRulesCount:r=0,ruleErrors:o=[]}=null!=a?a:{};return 0===r?s.a.createElement(ee.EuiConfirmModal,{title:OP(n,i),onCancel:e,onConfirm:e,confirmButtonText:Oo.k,defaultFocusedButton:"confirm","data-test-subj":"bulkActionRejectModal"},s.a.createElement(SP,{bulkAction:n,ruleErrors:o})):s.a.createElement(ee.EuiConfirmModal,{title:Oo.l(r),onCancel:e,onConfirm:t,confirmButtonText:kP(n,r),cancelButtonText:Oo.y,defaultFocusedButton:"confirm","data-test-subj":"bulkActionConfirmationModal"},s.a.createElement(SP,{bulkAction:n,ruleErrors:o}))},TP=s.a.memo(wP);TP.displayName="BulkActionDryRunConfirmation";var IP=a(146);const CP=({form:e,title:t,banner:a,children:n,onClose:i,onSubmit:r,flyoutSize:o="s"})=>{const l=Object(ee.useGeneratedHtmlId)({prefix:"RulesBulkEditForm"}),{isValid:c}=e;return s.a.createElement(ee.EuiFlyout,{ownFocus:!0,onClose:i,"aria-labelledby":l,size:o},s.a.createElement(ee.EuiFlyoutHeader,{hasBorder:!0},s.a.createElement(ee.EuiTitle,{size:"m","data-test-subj":"rulesBulkEditFormTitle"},s.a.createElement("h2",{id:l},t))),s.a.createElement(ee.EuiFlyoutBody,{banner:a},s.a.createElement(IP.c,{form:e},n)),s.a.createElement(ee.EuiFlyoutFooter,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{onClick:i,flush:"left","data-test-subj":"rulesBulkEditFormCancelBtn"},Oo.K)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{onClick:r,fill:!0,disabled:!1===c,"data-test-subj":"rulesBulkEditFormSaveBtn"},Oo.S)))))},MP=s.a.memo(CP);MP.displayName="BulkEditFormWrapper";const _P=Object(IP.j)({component:IP.b}),AP={index:{fieldsToValidateOnChange:["index"],type:IP.a.COMBO_BOX,validations:[{validator:IP.h.emptyField(Oo.E)}]},overwrite:{type:IP.a.CHECKBOX,label:Oo.D},overwriteDataViews:{type:IP.a.CHECKBOX,label:Oo.L}},FP={index:[],overwrite:!1,overwriteDataViews:!1},PP=({editAction:e,rulesCount:t,onClose:a,onConfirm:n})=>{const{form:i}=Object(IP.k)({defaultValue:FP,schema:AP}),{indexHelpText:r,indexLabel:o,formTitle:c}=(e=>e===th.a.add_index_patterns?{indexLabel:Oo.C,indexHelpText:Oo.B,formTitle:Oo.F}:{indexLabel:Oo.N,indexHelpText:Oo.M,formTitle:Oo.O})(e),[{overwrite:u,overwriteDataViews:d}]=Object(IP.m)({form:i,watch:["overwrite","overwriteDataViews"]}),{uiSettings:p}=Object(h.i)().services,m=p.get(l.I);return s.a.createElement(MP,{form:i,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await i.submit();a&&n({value:t.index,type:t.overwrite?th.a.set_index_patterns:e,overwrite_data_views:t.overwriteDataViews})},title:c},s.a.createElement(_P,{path:"index",config:{...AP.index,label:o,helpText:r},componentProps:{idAria:"bulkEditRulesIndexPatterns","data-test-subj":"bulkEditRulesIndexPatterns",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:m.map((e=>({label:e})))}}}),e===th.a.add_index_patterns&&s.a.createElement(_P,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteIndexPatterns","data-test-subj":"bulkEditRulesOverwriteIndexPatterns"}}),u&&s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(ee.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesIndexPatternsWarning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setIndexPatternsWarningCallout",defaultMessage:"Youâ€™re about to overwrite index patterns for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))),e===th.a.add_index_patterns&&s.a.createElement(_P,{path:"overwriteDataViews",componentProps:{idAria:"bulkEditRulesOverwriteRulesWithDataViews","data-test-subj":"bulkEditRulesOverwriteRulesWithDataViews"}}),d&&s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(ee.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will force those rules to read from the index pattern as defined after this update, not the dataview, and may result in broken rules."}))),e===th.a.delete_index_patterns&&s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(ee.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPattnersDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will not have any effect on those rules."}))))},DP=s.a.memo(PP);DP.displayName="IndexPatternsForm";const NP=()=>{const{addError:e}=Object(Pt.a)();return Object(oh.a)({onError:t=>{e(t,{title:IF.c})}})},RP=Object(IP.j)({component:IP.b}),LP={tags:{fieldsToValidateOnChange:["tags"],type:IP.a.COMBO_BOX,validations:[{validator:IP.h.emptyField(Oo.T)}]},overwrite:{type:IP.a.CHECKBOX,label:Oo.I}},BP={tags:[],overwrite:!1},zP=({editAction:e,rulesCount:t,onClose:a,onConfirm:n})=>{const{data:i}=NP(),{form:o}=Object(IP.k)({defaultValue:BP,schema:LP}),[{overwrite:l}]=Object(IP.m)({form:o,watch:["overwrite"]}),c=Object(r.useMemo)((()=>{var e;return jc(null!==(e=null==i?void 0:i.aggregated_fields.tags)&&void 0!==e?e:[])}),[i]),{tagsLabel:u,tagsHelpText:d,formTitle:p}=(e=>e===th.a.add_tags?{tagsLabel:Oo.H,tagsHelpText:Oo.G,formTitle:Oo.J}:{tagsLabel:Oo.Q,tagsHelpText:Oo.P,formTitle:Oo.R})(e);return s.a.createElement(MP,{form:o,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await o.submit();a&&n({value:t.tags,type:t.overwrite?th.a.set_tags:e})},title:p},s.a.createElement(RP,{path:"tags",config:{...LP.tags,label:u,helpText:d},componentProps:{idAria:"bulkEditRulesTags","data-test-subj":"bulkEditRulesTags",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:c.map((e=>({label:e})))}}}),e===th.a.add_tags?s.a.createElement(RP,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteTags","data-test-subj":"bulkEditRulesOverwriteTags"}}):null,l&&s.a.createElement(ee.EuiFormRow,null,s.a.createElement(ee.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesTagsWarning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setTagsWarningCallout",defaultMessage:"Youâ€™re about to overwrite tags for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))))},qP=s.a.memo(zP);qP.displayName="TagsForm";var $P=a(708),VP=a(296);const UP=ae()(ee.EuiInputPopover).withConfig({displayName:"StyledEuiInputPopover",componentId:"sc-1feu4fu-0"})([".rightArrowIcon{.euiFieldText{padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:",";background-image:linear-gradient( to top,",","," 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}}.euiFormControlLayoutIcons{left:unset;right:12px;}}"],(({theme:e})=>e.eui.euiFormBackgroundColor),(({theme:e})=>e.eui.euiFocusRingColor),(({theme:e})=>e.eui.euiFocusRingColor)),HP=e=>[{description:VP.a,favorite:[],label:VP.b,id:void 0,title:VP.b,checked:"-1"===e?"on":void 0}],QP=({isDisabled:e,hideUntitled:t=!1,timelineId:a,timelineTitle:n,timelineType:i=Lf.l.template,onTimelineChange:o,placeholder:l})=>{const[c,u]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>{u(!1)}),[]),p=Object(r.useCallback)((()=>{u(!0)}),[]),m=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFieldText,{readOnly:!0,disabled:e,onFocus:p,onClick:p,value:null!=n?n:VP.b,icon:"arrowDown"})),[p,e,n]),f=Object(r.useCallback)((({timelines:e,onlyFavorites:n,searchTimelineValue:r})=>[...n||""!==r?[]:HP(null==a?"-1":a),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:i===Lf.l.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(a)?"on":void 0})))]),[t,a,i]);return s.a.createElement(UP,{id:"searchTimelinePopover",input:m,isOpen:c,closePopover:d,anchorClassName:"rightArrowIcon"},s.a.createElement($P.a,{hideUntitled:t,getSelectableOptions:f,onClosePopover:d,onTimelineChange:o,timelineType:i,placeholder:l}))},GP=Object(r.memo)(QP),WP=({dataTestSubj:e,field:t,idAria:a,isDisabled:n=!1,placeholder:i})=>{const[o,l]=Object(r.useState)(null),[c,u]=Object(r.useState)(null),{isInvalid:d,errorMessage:p}=Object(IP.i)(t);Object(r.useEffect)((()=>{const{id:e,title:a}=t.value;o!==e&&(l(e),u(a))}),[t.value,o]);const m=Object(r.useCallback)(((e,a)=>{null===a?t.setValue({id:a,title:null}):o!==a&&t.setValue({id:a,title:e})}),[t,o]);return s.a.createElement(ee.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:p,isInvalid:d,"data-test-subj":e,describedByIds:a?[a]:void 0},s.a.createElement(GP,{isDisabled:n,hideUntitled:!0,timelineId:o,timelineTitle:c,onTimelineChange:m,placeholder:i}))},ZP={FORM_TITLE:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.formTitle",{defaultMessage:"Apply Timeline template"}),TEMPLATE_SELECTOR_LABEL:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorLabel",{defaultMessage:"Apply Timeline template to selected rules"}),TEMPLATE_SELECTOR_HELP_TEXT:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorHelpText",{defaultMessage:"Select which Timeline to apply to selected rules when investigating generated alerts."}),TEMPLATE_SELECTOR_PLACEHOLDER:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorPlaceholder",{defaultMessage:"Search Timeline template"}),TEMPLATE_SELECTOR_DEFAULT_VALUE:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorDefaultValue",{defaultMessage:"None"}),warningCalloutMessage:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. If you previously applied Timeline templates to these rules, they will be overwritten or (if you select 'None') reset to none.",values:{rulesCount:e}})},KP={FORM_TITLE:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.formTitle",{defaultMessage:"Add rule actions"}),OVERWRITE_LABEL:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.overwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules actions"}),RULE_VARIABLES_DETAIL:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.ruleVariablesDetail",{defaultMessage:"Rule variables may affect only some of the rules you select, based on the rule types (for example, \\u007b\\u007bcontext.rule.threshold\\u007d\\u007d will only display values for threshold rules)."})},JP={FORM_TITLE:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.formTitle",{defaultMessage:"Update rule schedules"}),INTERVAL_LABEL:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalLabel",{defaultMessage:"Runs every"}),INTERVAL_HELP_TEXT:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."}),LOOKBACK_LABEL:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackLabel",{defaultMessage:"Additional look-back time"}),LOOKBACK_HELP_TEXT:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."}),warningCalloutMessage:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. The changes you make will overwrite the existing rule schedules and additional look-back time (if any).",values:{rulesCount:e}})},YP={MODAL_TITLE:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exception.confirmation.modalTitle",defaultMessage:"Duplicate {rulesCount, plural, one {the rule} other {rules}}?",values:{rulesCount:e}}),MODAL_TEXT:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.modalBody",defaultMessage:"You're duplicating {rulesCount, plural, one {# rule} other {# rules}}. Choose what to duplicate:",values:{rulesCount:e}}),DUPLICATE_EXCEPTIONS_TEXT:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.with",defaultMessage:"The {rulesCount, plural, one {rule} other {rules}} and {rulesCount, plural, one {its} other {their}} active exceptions",values:{rulesCount:e}}),DUPLICATE_EXCEPTIONS_INCLUDE_EXPIRED_EXCEPTIONS_LABEL:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.includeExpiredExceptionsCheckboxLabel",defaultMessage:"The {rulesCount, plural, one {rule} other {rules}} and {rulesCount, plural, one {its} other {their}} exceptions",values:{rulesCount:e}}),DUPLICATE_WITHOUT_EXCEPTIONS_TEXT:e=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.without",defaultMessage:"Only the {rulesCount, plural, one {rule} other {rules}}",values:{rulesCount:e}}),CONTINUE_BUTTON:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.continueButton",{defaultMessage:"Duplicate"}),CANCEL_BUTTON:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.cancelButton",{defaultMessage:"Cancel"}),DUPLICATE_TOOLTIP:Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.tooltip",{defaultMessage:"Exception items associated with individual rules are duplicated. Exception items linked to shared exception lists are not. Instead, duplicated rules will reference the shared exception lists that contain the exception items."})},XP={timeline:{label:ZP.TEMPLATE_SELECTOR_LABEL,helpText:ZP.TEMPLATE_SELECTOR_HELP_TEXT}},eD={timeline:{id:null,title:ZP.TEMPLATE_SELECTOR_DEFAULT_VALUE}},tD=e=>{const{rulesCount:t,onClose:a,onConfirm:n}=e,{form:i}=Object(IP.k)({schema:XP,defaultValue:eD}),o=Object(r.useCallback)((async()=>{const{data:e,isValid:t}=await i.submit();if(!t)return;const a=e.timeline.id||"",r=a?e.timeline.title:"";n({type:th.a.set_timeline,value:{timeline_id:a,timeline_title:r}})}),[i,n]),l=s.a.createElement(ee.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesTimelineTemplateWarning"},ZP.warningCalloutMessage(t));return s.a.createElement(MP,{form:i,title:ZP.FORM_TITLE,banner:l,onClose:a,onSubmit:o},s.a.createElement(IP.e,{path:"timeline",component:WP,componentProps:{idAria:"bulkEditRulesTimelineTemplateSelector",dataTestSubj:"bulkEditRulesTimelineTemplateSelector",placeholder:ZP.TEMPLATE_SELECTOR_PLACEHOLDER}}))},aD=s.a.memo(tD);aD.displayName="TimelineTemplateForm";var nD=a(1156),iD=a(1114),rD=a(1130);const sD=Object(IP.j)({component:IP.b}),oD={actions:[],overwrite:!1},lD=({rulesCount:e,onClose:t,onConfirm:a})=>{const{services:{triggersActionsUi:{actionTypeRegistry:n}}}=Object(h.i)(),i=Object(r.useMemo)((()=>(e=>({actions:{validations:[{validator:Object(rD.a)(e)}]},overwrite:{type:IP.a.CHECKBOX,label:KP.OVERWRITE_LABEL}}))(n)),[n]),{form:o}=Object(IP.k)({schema:i,defaultValue:oD}),[{overwrite:l}]=Object(IP.m)({form:o,watch:["overwrite","throttle"]}),c=Object(r.useCallback)((async()=>{const{data:e,isValid:t}=await o.submit();if(!t)return;const{actions:n=[],overwrite:i}=e,r=i?th.a.set_rule_actions:th.a.add_rule_actions;a({type:r,value:{actions:n.map(nD.a)}})}),[o,a]),u=Object(r.useMemo)((()=>Object(Jh.e)()),[]);return s.a.createElement(MP,{form:o,title:KP.FORM_TITLE,onClose:t,onSubmit:c,flyoutSize:"l"},s.a.createElement(ee.EuiCallOut,{color:"primary","data-test-subj":"bulkEditRulesRuleActionInfo",title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.infoCalloutTitle",defaultMessage:"Configure actions for {rulesCount, plural, one {# rule} other {# rules}} youâ€™ve selected",values:{rulesCount:e}})},s.a.createElement("ul",null,s.a.createElement("li",null,KP.RULE_VARIABLES_DETAIL))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(IP.e,{path:"actions",component:iD.a,componentProps:{messageVariables:u,summaryMessageVariables:u}}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(sD,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteRuleActions","data-test-subj":"bulkEditRulesOverwriteRuleActions"}}),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesRuleActionsWarning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage",defaultMessage:"You're about to overwrite rule actions for {rulesCount, plural, one {# selected rule} other {# selected rules}}. Click {saveButton} to apply changes.",values:{rulesCount:e,saveButton:s.a.createElement("strong",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage.buttonLabel",defaultMessage:"Save"}))}}))))},cD=s.a.memo(lD);cD.displayName="RuleActionsForm";const uD=[{value:"s",text:Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"})},{value:"m",text:Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"})},{value:"h",text:Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"})},{value:"d",text:Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.daysOptionDescription",{defaultMessage:"Days"})}],dD=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-gbwqm5-0"})(["&.euiFlexItem{margin-left:31px;}"]),pD=ae()(ee.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-gbwqm5-1"})(["max-width:none;.euiFormControlLayout{max-width:auto;width:auto;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;width:100%;}.euiFormControlLayout__childrenWrapper > select{background-color:",";color:",";}.euiFormControlLayout--group .euiFormControlLayout{min-width:100px;}.euiFormControlLayoutIcons{color:",";}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>Object(ee.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorLightShade)),mD=ae()(ee.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-gbwqm5-2"})(["width:auto;"]),fD=({dataTestSubj:e,field:t,idAria:a,isDisabled:n,minimumValue:i=0,timeTypes:o=["s","m","h"],fullWidth:l=!1})=>{const[c,u]=Object(r.useState)(o[0]),[d,p]=Object(r.useState)(0),{isInvalid:m,errorMessage:f}=Object(IP.i)(t),{value:b,setValue:g}=t,y=Object(r.useCallback)((e=>{u(e.target.value),g(`${d}${e.target.value}`)}),[g,d]),h=Object(r.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.max(t,Math.min(a,Number.MAX_SAFE_INTEGER))})(e.target.value,i);p(t),g(`${t}${c}`)}),[i,g,c]);Object(r.useEffect)((()=>{if(b!==`${d}${c}`){const e=b.match(/\d+/g),t=b.match(/[a-zA-Z]+/g);Object(A.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(d)||p(Number(e[0])),!Object(A.isEmpty)(t)&&null!=t&&o.includes(t[0])&&t[0]!==c&&u(t[0])}}),[c,o,d,b]);const v={disabled:n},E=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1,component:"span"},t.label),s.a.createElement(dD,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return s.a.createElement(pD,{label:E,helpText:t.helpText,error:f,isInvalid:m,fullWidth:l,"data-test-subj":e,describedByIds:a?[a]:void 0},s.a.createElement(ee.EuiFormControlLayout,{append:s.a.createElement(mD,bo()({fullWidth:!1,options:uD.filter((e=>o.includes(e.value))),onChange:y,value:c,"aria-label":t.label,"data-test-subj":"timeType"},v))},s.a.createElement(ee.EuiFieldNumber,bo()({fullWidth:!0,min:i,max:Number.MAX_SAFE_INTEGER,onChange:h,value:d,"data-test-subj":"interval"},v))))},bD={interval:{label:JP.INTERVAL_LABEL,helpText:JP.INTERVAL_HELP_TEXT},lookback:{label:JP.LOOKBACK_LABEL,helpText:JP.LOOKBACK_HELP_TEXT}},gD={interval:"5m",lookback:"1m"},yD=({rulesCount:e,onClose:t,onConfirm:a})=>{const{form:n}=Object(IP.k)({schema:bD,defaultValue:gD}),i=Object(r.useCallback)((async()=>{const{data:e,isValid:t}=await n.submit();t&&a({type:th.a.set_schedule,value:{interval:e.interval,lookback:e.lookback}})}),[n,a]),o=s.a.createElement(ee.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesSchedulesWarning"},JP.warningCalloutMessage(e));return s.a.createElement(MP,{form:n,title:JP.FORM_TITLE,banner:o,onClose:t,onSubmit:i},s.a.createElement(IP.e,{path:"interval",component:fD,componentProps:{idAria:"bulkEditRulesScheduleIntervalSelector",dataTestSubj:"bulkEditRulesScheduleIntervalSelector",fullWidth:!0,minimumValue:1}}),s.a.createElement(IP.e,{path:"lookback",component:fD,componentProps:{idAria:"bulkEditRulesScheduleLookbackSelector",dataTestSubj:"bulkEditRulesScheduleLookbackSelector",fullWidth:!0,minimumValue:1}}))},hD=({editAction:e,...t})=>{switch(e){case th.a.add_index_patterns:case th.a.delete_index_patterns:case th.a.set_index_patterns:return s.a.createElement(DP,bo()({},t,{editAction:e}));case th.a.add_tags:case th.a.delete_tags:case th.a.set_tags:return s.a.createElement(qP,bo()({},t,{editAction:e}));case th.a.set_timeline:return s.a.createElement(aD,t);case th.a.add_rule_actions:case th.a.set_rule_actions:return s.a.createElement(cD,t);case th.a.set_schedule:return s.a.createElement(yD,t);default:return null}},vD=s.a.memo(hD);vD.displayName="BulkEditFlyout";var ED=a(663);function xD(e){switch(e){case th.a.add_index_patterns:case th.a.delete_index_patterns:case th.a.set_index_patterns:case th.a.add_tags:case th.a.delete_tags:case th.a.set_tags:return[{type:e,value:[]}];case th.a.set_timeline:return[{type:e,value:{timeline_id:"",timeline_title:""}}];case th.a.add_rule_actions:case th.a.set_rule_actions:return[{type:e,value:{actions:[]}}];case th.a.set_schedule:return[{type:e,value:{interval:"5m",lookback:"1m"}}];default:Object(Yr.a)(e)}return[{type:e,value:[]}]}const jD=({dryRunResult:e,...t})=>{if("selectedRuleIds"in t){const a=new Set(null==e?void 0:e.ruleErrors.flatMap((({ruleIds:e})=>e)));return{ids:t.selectedRuleIds.filter((e=>!a.has(e)))}}let a={...t.filterOptions};return null==e||e.ruleErrors.forEach((({errorCode:e})=>{var t,n;switch(e){case l.q.IMMUTABLE:a={...a,showCustomRules:!0};break;case l.q.MACHINE_LEARNING_INDEX_PATTERN:case l.q.MACHINE_LEARNING_AUTH:a={...a,excludeRuleTypes:[...null!==(t=a.excludeRuleTypes)&&void 0!==t?t:[],"machine_learning"]};break;case l.q.ESQL_INDEX_PATTERN:a={...a,excludeRuleTypes:[...null!==(n=a.excludeRuleTypes)&&void 0!==n?n:[],"esql"]}}})),{query:Object(ED.a)(a)}},SD=({onInit:e,onFinish:t})=>{const a=Object(r.useRef)(),n=Object(r.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!0)}),[]),i=Object(r.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!1)}),[]);return[Object(r.useCallback)((()=>(e(),new Promise((e=>{a.current=e})).finally((()=>{t()})))),[e,t]),n,i]};var OD=a(1403);const kD=({tags:e,selectedTags:t,onSelectedTagsChanged:a})=>{const n=Object(r.useMemo)((()=>jc(Array.from(new Set([...e,...t])))),[t,e]),[i,o]=Object(r.useState)(!1),[l,c]=Object(r.useState)((()=>{const e=new Set(t);return n.map((t=>({label:t,checked:e.has(t)?"on":void 0})))}));Object(r.useEffect)((()=>{const e=new Set(t),a=n.map((t=>({label:t,checked:e.has(t)?"on":void 0})));c(a)}),[n,t]);const u=s.a.createElement(ee.EuiFilterButton,{grow:!0,iconType:"arrowDown",onClick:()=>o(!i),numFilters:e.length,isSelected:i,hasActiveFilters:t.length>0,numActiveFilters:t.length,"data-test-subj":"tags-filter-popover-button"},Oo.Xc);return s.a.createElement(ee.EuiPopover,{ownFocus:!0,button:u,isOpen:i,closePopover:()=>o(!i),panelPaddingSize:"none",repositionOnScroll:!0,panelProps:{"data-test-subj":"tags-filter-popover"}},s.a.createElement(ee.EuiSelectable,{searchable:!0,searchProps:{placeholder:Oo.Qc},"aria-label":Oo.Fc,options:l,onChange:(e,n,i)=>{c(e),Object(OD.a)(i.label,t,a)},emptyMessage:Oo.Yb,noMatchesMessage:Oo.Yb},((e,t)=>s.a.createElement("div",{style:{width:274}},s.a.createElement(ee.EuiPopoverTitle,null,t),e))))};kD.displayName="TagsFilterPopoverComponent";const wD=s.a.memo(kD);wD.displayName="TagsFilterPopover";var TD=a(289),ID=a(1374);const CD=({selectedStatus:e,onSelectedStatusChanged:t})=>{const[a,n]=Object(r.useState)(!1),i=[{label:Object(Kh.a)(TD.f.succeeded)||"",data:{status:TD.f.succeeded},checked:e===TD.f.succeeded?"on":void 0},{label:Object(Kh.a)(TD.f["partial failure"])||"",data:{status:TD.f["partial failure"]},checked:e===TD.f["partial failure"]?"on":void 0},{label:Object(Kh.a)(TD.f.failed)||"",data:{status:TD.f.failed},checked:e===TD.f.failed?"on":void 0}],o=s.a.createElement(ee.EuiFilterButton,{grow:!0,iconType:"arrowDown",onClick:()=>{n(!a)},numFilters:i.length,isSelected:a,hasActiveFilters:void 0!==e,numActiveFilters:void 0!==e?1:0,"data-test-subj":"executionStatusFilterButton"},Oo.hb);return s.a.createElement(ee.EuiPopover,{ownFocus:!0,button:o,isOpen:a,closePopover:()=>{n(!a)},panelPaddingSize:"none",repositionOnScroll:!0},s.a.createElement(ee.EuiSelectable,{"aria-label":Oo.Hc,options:i,onChange:(e,a,i)=>{var r;n(!1),i.checked&&null!=i&&null!==(r=i.data)&&void 0!==r&&r.status?t(i.data.status):i.checked||t()},singleSelection:!0,listProps:{isVirtualized:!1},renderOption:e=>{const t=e.status;return s.a.createElement(_D,{"data-test-subj":"executionStatusFilterOption"},s.a.createElement(ID.a,{status:t,showTooltip:!1}))},"data-test-subj":"executionStatusFilterSelectableList"},(e=>s.a.createElement(AD,null,e))))};CD.displayName="RuleExecutionStatusSelectorComponent";const MD=s.a.memo(CD);MD.displayName="RuleExecutionStatusSelector";var _D=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-yxrzfj-0"})(["margin-top:4px;"]),AD=ae()("div").withConfig({displayName:"_StyledDiv2",componentId:"sc-yxrzfj-1"})(["width:200px;"]);const FD=ae()(ee.EuiFlexItem).withConfig({displayName:"SearchBarWrapper",componentId:"sc-a8228p-0"})(["min-width:200px;& .euiPopover,& .euiPopover__anchor{display:block;}"]);function PD({initialValue:e,onSearch:t,placeholder:a}){const[n,i]=Object(r.useState)(e),o=Object(r.useCallback)((e=>i(e.target.value)),[i]);return Object(r.useEffect)((()=>{i(e)}),[e]),s.a.createElement(FD,{grow:!0},s.a.createElement(ee.EuiFieldSearch,{id:xF,"aria-label":Oo.Pc,fullWidth:!0,incremental:!1,placeholder:null!=a?a:Oo.Oc,value:n,onChange:o,onSearch:t,"data-test-subj":"ruleSearchField"}))}const DD=ae()(ee.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-p9q2gl-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeXS)),ND=()=>{var e;const{startTransaction:t}=Object(Mo.b)(),{state:{filterOptions:a},actions:{setFilterOptions:n}}=Object(nh.b)(),{data:i}=NP(),o=null!==(e=null==i?void 0:i.aggregated_fields.tags)&&void 0!==e?e:[],l=null==i?void 0:i.rules_summary.custom_count,c=null==i?void 0:i.rules_summary.prebuilt_installed_count,{showCustomRules:u,showElasticRules:d,tags:p,enabled:m,ruleExecutionStatus:f}=a,b=Object(r.useCallback)((e=>{t({name:ah.d.FILTER}),n({filter:e.trim()})}),[n,t]),g=Object(r.useCallback)((()=>{t({name:ah.d.FILTER}),n({showElasticRules:!d,showCustomRules:!1})}),[n,d,t]),y=Object(r.useCallback)((()=>{t({name:ah.d.FILTER}),n({showCustomRules:!u,showElasticRules:!1})}),[n,u,t]),h=Object(r.useCallback)((()=>{t({name:ah.d.FILTER}),n(!0===m?{enabled:void 0}:{enabled:!0})}),[n,m,t]),v=Object(r.useCallback)((()=>{t({name:ah.d.FILTER}),n(!1===m?{enabled:void 0}:{enabled:!1})}),[n,m,t]),E=Object(r.useCallback)((e=>{Object(A.isEqual)(e,p)||(t({name:ah.d.FILTER}),n({tags:e}))}),[p,n,t]),x=Object(r.useCallback)((e=>{e!==f&&(t({name:ah.d.FILTER}),n({ruleExecutionStatus:e}))}),[f,n,t]);return s.a.createElement(DD,{gutterSize:"m",justifyContent:"flexEnd",wrap:!0},s.a.createElement(PD,{initialValue:a.filter,onSearch:b}),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(wD,{onSelectedTagsChanged:E,selectedTags:p,tags:o,"data-test-subj":"allRulesTagPopover"}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(MD,{onSelectedStatusChanged:x,selectedStatus:f}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiFilterButton,{hasActiveFilters:d,onClick:g,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},Oo.Db,null!=c?` (${null!=c?c:""})`:""),s.a.createElement(ee.EuiFilterButton,{hasActiveFilters:u,onClick:y,"data-test-subj":"showCustomRulesFilterButton"},Oo.rb,null!=l?` (${l})`:""))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiFilterButton,{hasActiveFilters:!0===m,onClick:h,"data-test-subj":"showEnabledRulesFilterButton",withNext:!0},Oo.Eb),s.a.createElement(ee.EuiFilterButton,{hasActiveFilters:!1===m,onClick:v,"data-test-subj":"showDisabledRulesFilterButton"},Oo.zb))))};ND.displayName="RulesTableFiltersComponent";const RD=s.a.memo(ND);RD.displayName="RulesTableFilters";var LD=a(194),BD=a(405);let zD;!function(e){e.management="management",e.monitoring="monitoring",e.updates="updates"}(zD||(zD={}));const qD=s.a.memo((()=>{var e,t,a;const{data:n}=NP(),{data:i}=CF(),[{loading:o,canUserCRUD:l}]=Object(kt.b)(),c=(null!==(e=null==n?void 0:n.rules_summary.custom_count)&&void 0!==e?e:0)+(null!==(t=null==n?void 0:n.rules_summary.prebuilt_installed_count)&&void 0!==t?t:0),u=null!==(a=null==i?void 0:i.num_prebuilt_rules_to_upgrade)&&void 0!==a?a:0,d=!o&&l&&u>0,p=Object(r.useMemo)((()=>({[zD.management]:{id:zD.management,name:Hh,disabled:!1,href:`/rules/${zD.management}`,isBeta:c>0,betaOptions:{text:`${c}`}},[zD.monitoring]:{id:zD.monitoring,name:Qh,disabled:!1,href:`/rules/${zD.monitoring}`,isBeta:c>0,betaOptions:{text:`${c}`}},...d?{[zD.updates]:{id:zD.updates,name:Gh,disabled:!1,href:`/rules/${zD.updates}`,isBeta:u>0,betaOptions:{text:`${u}`}}}:{}})),[c,u,d]),{hasAssistantPrivilege:m}=Object(eM.a)(),{state:{rules:f,selectedRuleIds:b}}=Object(nh.b)(),g=Object(r.useMemo)((()=>f.filter((e=>b.includes(e.id)))),[f,b]),y=Object(r.useCallback)((async()=>Object(BD.d)(g)),[g]);return s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(Wc,{navTabs:p})),s.a.createElement(ee.EuiFlexItem,{grow:!1},m&&g.length>0&&s.a.createElement(LD.f,{category:"detection-rules",conversationId:Oo.yb,description:Oo.Ic,getPromptContext:y,suggestedUserPrompt:Oo.Fb,tooltip:Oo.Jc})))}));qD.displayName="RulesTableToolbar";var $D=a(478);const VD=({isRefreshOn:e,isDisabled:t,reFetchRules:a,setIsRefreshOn:n})=>{const[i,o]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>o(!1)),[o]),c=Object(r.useCallback)((()=>o((e=>!e))),[o]),u=Object(r.useCallback)((e=>{const t=e.target.checked;t&&a(),n(t),l()}),[a,n,l]);return s.a.createElement(ee.EuiPopover,{isOpen:i,closePopover:l,button:s.a.createElement(HD,{"data-test-subj":"autoRefreshButton",color:"text",iconType:"timeRefresh",onClick:c,disabled:t},e?"On":"Off")},s.a.createElement(ee.EuiContextMenuPanel,{items:[s.a.createElement(ee.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:Oo.ec,checked:null!=e&&e,onChange:u,compressed:!0,disabled:t,"data-test-subj":"refreshSettingsSwitch"}),...t?[s.a.createElement("div",{key:"refreshSettingsSelectionNote"},s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiTextColor,{color:"subdued","data-test-subj":"refreshSettingsSelectionNote"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.refreshRulePopoverSelectionHelpText",defaultMessage:"Note: Refresh is disabled while there is an active selection."})))]:[]]}))};VD.displayName="AutoRefreshButtonComponent";const UD=s.a.memo(VD);UD.displayName="AutoRefreshButton";var HD=ae()(ee.EuiButtonEmpty).withConfig({displayName:"_StyledEuiButtonEmpty",componentId:"sc-ljfno4-0"})(["margin-left:10px;"]);const QD=s.a.memo((({canBulkEdit:e,onGetBulkItemsPopoverContent:t,onToggleSelectAll:a,isBulkActionInProgress:n})=>{const{timelines:i}=Object(h.i)().services,{startTransaction:o}=Object(Mo.b)(),l=Object(nh.b)(),{pagination:c,selectedRuleIds:u,isRefreshOn:d,isAllSelected:p,loadingRulesAction:m}=l.state,{reFetchRules:f,setIsRefreshOn:b}=l.actions,g=p?c.total:u.length,y=g>0,v=null!=m,E=Object(r.useCallback)((()=>{o({name:ah.d.REFRESH}),f()}),[f,o]),x=Object(r.useCallback)((e=>null!=t?s.a.createElement(ee.EuiContextMenu,{initialPanelId:0,panels:t(e)}):null),[t]);return s.a.createElement($D.a,{border:!0},s.a.createElement($D.d,null,s.a.createElement($D.c,null,s.a.createElement($D.e,{dataTestSubj:"showingRules"},Oo.Uc(...(({page:e,perPage:t,total:a})=>[0===a?0:(e-1)*t+1,e*t>a?a:e*t,a])(c)))),s.a.createElement(s.a.Fragment,null,s.a.createElement($D.c,{"data-test-subj":"tableBulkActions"},s.a.createElement($D.e,{dataTestSubj:"selectedRules"},Oo.Rc(g)),e&&s.a.createElement($D.b,{disabled:v,dataTestSubj:"selectAllRules",iconType:p?"cross":"pagesSelect",iconSide:"left",onClick:a},p?Oo.ab:Oo.Sc(c.total)),e&&s.a.createElement($D.b,{disabled:v,inProgress:n,dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverPanelPaddingSize:"none",popoverContent:x},Oo.f),s.a.createElement($D.b,{disabled:v,dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:E},Oo.dc),!l.state.isDefault&&s.a.createElement($D.b,{dataTestSubj:"clearTableFilters",iconSide:"left",iconType:"cross",onClick:l.actions.clearFilters},Oo.Z)))),s.a.createElement($D.d,{dataTestSubj:"refreshRulesStatus"},i.getLastUpdated({showUpdating:l.state.isFetching,updatedAt:l.state.lastUpdated}),s.a.createElement(UD,{isDisabled:v||y,isRefreshOn:d,reFetchRules:f,setIsRefreshOn:b})))}));QD.displayName="RulesTableUtilityBar";const GD=()=>{const[e,t,a]=Object(Wh.a)(),n=Object(r.useRef)(),i=Object(r.useCallback)((e=>{var t;null===(t=n.current)||void 0===t||t.call(n,e)}),[]),s=Object(r.useCallback)((()=>{var e;null===(e=n.current)||void 0===e||e.call(n,null)}),[]),o=Object(r.useCallback)((()=>(t(),new Promise((e=>{n.current=e})).finally((()=>{a()})))),[t,a]);return{isBulkDuplicateConfirmationVisible:e,showBulkDuplicateConfirmation:Object(r.useCallback)((async()=>{const e=await o();return e?i(e):s(),e}),[o,i,s]),cancelRuleDuplication:s,confirmRuleDuplication:i}},WD=({onCancel:e,onConfirm:t,rulesCount:a})=>{const[n,i]=Object(r.useState)(Dh.withExceptions),o=Object(r.useCallback)((e=>{i(e)}),[i]),l=Object(r.useCallback)((()=>{t(n)}),[t,n]);return s.a.createElement(ee.EuiConfirmModal,{title:YP.MODAL_TITLE(a),onConfirm:l,cancelButtonText:YP.CANCEL_BUTTON,confirmButtonText:YP.CONTINUE_BUTTON,defaultFocusedButton:"confirm",onCancel:e},s.a.createElement(ee.EuiText,null,YP.MODAL_TEXT(a)),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiRadioGroup,{options:[{id:Dh.withExceptions,label:s.a.createElement(ee.EuiText,{size:"s"},YP.DUPLICATE_EXCEPTIONS_INCLUDE_EXPIRED_EXCEPTIONS_LABEL(a),s.a.createElement(ee.EuiIconTip,{content:YP.DUPLICATE_TOOLTIP,position:"bottom"})),"data-test-subj":Dh.withExceptions},{id:Dh.withExceptionsExcludeExpiredExceptions,label:s.a.createElement(ee.EuiText,{size:"s"},YP.DUPLICATE_EXCEPTIONS_TEXT(a),s.a.createElement(ee.EuiIconTip,{content:YP.DUPLICATE_TOOLTIP,position:"bottom"})),"data-test-subj":Dh.withExceptionsExcludeExpiredExceptions},{id:Dh.withoutExceptions,label:YP.DUPLICATE_WITHOUT_EXCEPTIONS_TEXT(a),"data-test-subj":Dh.withoutExceptions}],idSelected:n,onChange:o}))},ZD=s.a.memo(WD);ZD.displayName="BulkActionDuplicateExceptionsConfirmation";const KD=()=>{const{enableDatafeed:e,isLoading:t}=Object(CA.a)(),{loading:a,jobs:n,refetch:i}=Object(pA.a)(),[s,o]=Object(r.useState)(!1),l=Object(r.useCallback)((async r=>{if(a||t)return;if(!r||!r.length)return;o(!0);const s=n.filter((e=>r.includes(e.id)));await Promise.all(s.map((async t=>{var a;if(Object(qy.c)(t.jobState,t.datafeedState))return!0;const n=null!==(a=t.latestTimestampMs)&&void 0!==a?a:0;await e(t,n)}))),i(),o(!1)}),[e,t,a,n,i]);return{loading:a,jobs:n,starting:s,startMlJobs:l}};var JD=a(1281);const YD=s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,Oo.Sb),titleSize:"xs",body:Oo.Xb}),XD=s.a.memo((({selectedTab:e})=>{var t,a;const[{canUserCRUD:n}]=Object(kt.b)(),i=Object(Vy.c)(n),o=Object(JD.a)(),c=Object(r.useRef)(null),u=Object(nh.b)(),{data:p}=NP(),{state:{rules:m,filterOptions:f,isPreflightInProgress:b,isAllSelected:g,isFetched:y,isLoading:v,isRefetching:E,loadingRuleIds:x,loadingRulesAction:j,pagination:S,selectedRuleIds:O,sortingOptions:k},actions:{setIsAllSelected:w,setPage:T,setPerPage:I,setSelectedRuleIds:C,setSortingOptions:M}}=u,[_,A,F]=Object(Wh.a)(),[P,D,N]=SD({onInit:A,onFinish:F}),R=g?S.total:O.length||1,{bulkActionsDryRunResult:L,bulkAction:B,isBulkActionConfirmationVisible:z,showBulkActionConfirmation:q,cancelBulkActionConfirmation:$,approveBulkActionConfirmation:V}=(()=>{const[e,t]=Object(r.useState)(),[a,n]=Object(r.useState)(),[i,s,o]=Object(Wh.a)(),[l,c,u]=SD({onInit:s,onFinish:o});return{bulkActionsDryRunResult:a,bulkAction:e,isBulkActionConfirmationVisible:i,showBulkActionConfirmation:Object(r.useCallback)((async(e,a)=>{var i;if(t(a),n(e),!((null!==(i=null==e?void 0:e.failedRulesCount)&&void 0!==i?i:0)>0))return!0;const r=await l();return r&&c(),r}),[l,c]),cancelBulkActionConfirmation:u,approveBulkActionConfirmation:c}})(),{isBulkDuplicateConfirmationVisible:U,showBulkDuplicateConfirmation:H,cancelRuleDuplication:Q,confirmRuleDuplication:G}=GD(),{bulkEditActionType:W,isBulkEditFlyoutVisible:Z,handleBulkEditFormConfirm:K,handleBulkEditFormCancel:J,completeBulkEditForm:Y}=(()=>{const e=Object(r.useRef)(null),[t,a]=Object(r.useState)(),[n,i,s]=Object(Wh.a)(),[o,l,c]=SD({onInit:i,onFinish:s}),u=Object(r.useCallback)((async t=>(a(t),!0===await o()?e.current:null)),[o]);return{bulkEditActionType:t,isBulkEditFlyoutVisible:n,handleBulkEditFormConfirm:Object(r.useCallback)((t=>{e.current=t,l()}),[l]),handleBulkEditFormCancel:c,completeBulkEditForm:u}})(),{isBulkActionsDryRunLoading:X,executeBulkActionsDryRun:te}=(()=>{const{data:e,mutateAsync:t,isLoading:a}=Object(ih.useMutation)(["bulkActionsDryRun"],(async e=>{let t;try{t=await Object(mP.d)({bulkAction:e,dryRun:!0})}catch(e){var a,n,i;if(void 0===(null===(a=e.body)||void 0===a||null===(n=a.attributes)||void 0===n||null===(i=n.summary)||void 0===i?void 0:i.total))return;t=e.body}return{succeededRulesCount:null==(r=t)?void 0:r.attributes.summary.succeeded,failedRulesCount:null==r?void 0:r.attributes.summary.failed,ruleErrors:null!==(s=null==r||null===(o=r.attributes.errors)||void 0===o?void 0:o.map((({message:e,err_code:t,rules:a})=>({message:e,errorCode:t,ruleIds:a.map((({id:e})=>e))}))))&&void 0!==s?s:[]};var r,s,o}));return{bulkActionsDryRunResult:e,isBulkActionsDryRunLoading:a,executeBulkActionsDryRun:t}})(),ae=(({filterOptions:e,confirmDeletion:t,showBulkActionConfirmation:a,showBulkDuplicateConfirmation:n,completeBulkEditForm:i,executeBulkActionsDryRun:o})=>{const c=Ph(),u=Object(nh.b)(),p=_h(),m=Object(Pt.a)(),f=Object(ED.a)(e),{startTransaction:b}=Object(Mo.b)(),{executeBulkAction:g}=xh(),{bulkExport:y}=Lh(),h=qh(),{state:{isAllSelected:v,rules:E,loadingRuleIds:x,selectedRuleIds:j},actions:{clearRulesSelection:S,setIsPreflightInProgress:O}}=u;return Object(r.useCallback)((r=>{const u=E.filter((({id:e})=>j.includes(e))),k=u.some((({enabled:e})=>e)),w=u.some((({enabled:e})=>!e)),T=j.some((e=>x.includes(e))),I=!p&&u.some((e=>!Object(Vy.a)(e,p))),C=t=>async()=>{let n,l=!1;r(),O(!0);const c=await o({type:th.b.edit,...v?{query:Object(ED.a)(e)}:{ids:j},editPayload:xD(t)});if(O(!1),!1===await a(c,th.b.edit))return;const u=await i(t);if(null==u)return;b({name:ah.b.EDIT});const p=()=>{n&&m.api.remove(n)};setTimeout((()=>{var e;l||(n=m.addWarning({title:Oo.W,text:Object(d.toMountPoint)(s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,Oo.U(null!==(e=null==c?void 0:c.succeededRulesCount)&&void 0!==e?e:0)),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{color:"warning",size:"s",onClick:p},Oo.V))))),iconType:void 0},{toastLifeTimeMs:6e5}))}),5e3),await g({type:th.b.edit,...jD({...v?{filterOptions:e}:{selectedRuleIds:j},dryRunResult:c}),editPayload:[u]}),p(),l=!0},M=T||0===j.length,_=I||T||0===j.length;return[{id:0,title:Oo.u,items:[{key:Oo.r,name:Oo.r,"data-test-subj":"enableRuleBulk",disabled:I||T||!w&&!v,onClick:async()=>{b({name:ah.b.ENABLE}),r();const e=u.filter((({enabled:e})=>!e)),t=e.filter((({type:e})=>!Object(qy.d)(e))),a=e.length-t.length;!c&&a>0&&m.addWarning(Tt.e(a));const n=c?e.map((({id:e})=>e)):t.map((({id:e})=>e));await g({type:th.b.enable,...v?{query:f}:{ids:n}})},toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right",icon:void 0},{key:Oo.q,name:Oo.q,"data-test-subj":"duplicateRuleBulk",disabled:_,onClick:async()=>{b({name:ah.b.DUPLICATE}),r();const e=await n();null!==e&&(await g({type:th.b.duplicate,duplicatePayload:{include_exceptions:e===Dh.withExceptions||e===Dh.withExceptionsExcludeExpiredExceptions,include_expired_exceptions:!(e===Dh.withExceptionsExcludeExpiredExceptions)},...v?{query:f}:{ids:j}}),S())},toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right",icon:void 0},{key:Oo.t,name:Oo.t,"data-test-subj":"indexPatternsBulkEditRule",disabled:_,panel:2},{key:Oo.w,name:Oo.w,"data-test-subj":"tagsBulkEditRule",disabled:_,panel:1},{key:Oo.h,name:Oo.h,"data-test-subj":"addRuleActionsBulk",disabled:!p||_,onClick:C(th.a.add_rule_actions),toolTipContent:p?void 0:Oo.Qb,toolTipPosition:"right",icon:void 0},{key:Oo.v,name:Oo.v,"data-test-subj":"setScheduleBulk",disabled:_,onClick:C(th.a.set_schedule),toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right",icon:void 0},{key:Oo.j,name:Oo.j,"data-test-subj":"applyTimelineTemplateBulk",disabled:_,onClick:C(th.a.set_timeline),toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right",icon:void 0},{key:Oo.s,name:Oo.s,"data-test-subj":"exportRuleBulk",disabled:T||0===j.length,onClick:async()=>{r(),b({name:ah.b.EXPORT});const e=await y(v?{query:f}:{ids:j});if(!e)return;const t=await Sc(e),n=await a((e=>({succeededRulesCount:e.exported_rules_count,failedRulesCount:e.missing_rules_count,ruleErrors:e.missing_rules.length?[{errorCode:l.q.IMMUTABLE,message:"Prebuilt rules can't be exported.",ruleIds:e.missing_rules.map((({rule_id:e})=>e))}]:[]}))(t),th.b.export);!1!==n&&await h(e)},icon:void 0},{key:Oo.p,name:Oo.p,"data-test-subj":"disableRuleBulk",disabled:I||T||!k&&!v,onClick:async()=>{b({name:ah.b.DISABLE}),r();const e=u.filter((({enabled:e})=>e)).map((({id:e})=>e));await g({type:th.b.disable,...v?{query:f}:{ids:e}})},toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right",icon:void 0},{key:Oo.m,name:s.a.createElement(ee.EuiTextColor,{color:M?jo.euiThemeVars.euiButtonColorDisabledText:"danger"},Oo.m),"data-test-subj":"deleteRuleBulk",disabled:M,onClick:async()=>{r(),!1!==await t()&&(b({name:ah.b.DELETE}),await g({type:th.b.delete,...v?{query:f}:{ids:j}}))},toolTipPosition:"right",icon:void 0}]},{id:1,title:Oo.u,items:[{key:Oo.i,name:Oo.i,"data-test-subj":"addTagsBulkEditRule",onClick:C(th.a.add_tags),disabled:_,toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right"},{key:Oo.o,name:Oo.o,"data-test-subj":"deleteTagsBulkEditRule",onClick:C(th.a.delete_tags),disabled:_,toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right"}]},{id:2,title:Oo.u,items:[{key:Oo.g,name:Oo.g,"data-test-subj":"addIndexPatternsBulkEditRule",onClick:C(th.a.add_index_patterns),disabled:_,toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right"},{key:Oo.n,name:Oo.n,"data-test-subj":"deleteIndexPatternsBulkEditRule",onClick:C(th.a.delete_index_patterns),disabled:_,toolTipContent:I?Oo.Qb:void 0,toolTipPosition:"right"}]}]}),[E,j,p,v,x,b,c,g,f,m,n,S,t,y,a,h,O,o,e,i])})({filterOptions:f,confirmDeletion:P,showBulkActionConfirmation:q,showBulkDuplicateConfirmation:H,completeBulkEditForm:Y,executeBulkActionsDryRun:te}),ne=Object(r.useMemo)((()=>({pageIndex:S.page-1,pageSize:S.perPage,totalItemCount:S.total,pageSizeOptions:fP.b})),[S.page,S.perPage,S.total]),ie=Object(r.useCallback)((({page:e,sort:t})=>{var a,n;M({field:null!==(a=null==t?void 0:t.field)&&void 0!==a?a:"enabled",order:null!==(n=null==t?void 0:t.direction)&&void 0!==n?n:"desc"}),T(e.index+1),I(e.size)}),[T,I,M]),{loading:re,jobs:se,startMlJobs:oe}=KD(),le=(({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:n,showExceptionsDuplicateConfirmation:i,confirmDeletion:o})=>{const c=sv({showExceptionsDuplicateConfirmation:i,confirmDeletion:o}),u=av(),[d]=Object(h.o)(l.xc),p=ev({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:n}),m=nv({sortable:!0,width:"16%",isLoadingJobs:t,mlJobs:a}),f=Object(r.useMemo)((()=>({field:"snooze",name:Oo.ob,render:(e,t)=>s.a.createElement($y.a,{ruleId:t.id}),width:"100px",sortable:!1})),[]);return Object(r.useMemo)((()=>[u,...d?[rv]:[],iv,{field:"risk_score",name:Oo.lb,render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"severity",name:Oo.nb,render:e=>s.a.createElement(kh.a,{value:e}),sortable:!0,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:Oo.gb,render:e=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"ruleLastRun"},null==e?Object(Jc.d)():s.a.createElement(Yc.b,{tooltipFieldName:Oo.gb,relativeThresholdInHrs:l.R,value:e,tooltipAnchorClassName:"eui-textTruncate"})),sortable:!0,truncateText:!0,width:"16%"},m,{field:"updated_at",name:Oo.ib,render:e=>null==e?Object(Jc.d)():s.a.createElement(Yc.b,{tooltipFieldName:Oo.ib,relativeThresholdInHrs:l.R,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!0,width:"18%",truncateText:!0},f,p,...e?[c]:[]]),[c,p,m,f,e,u,d])})({hasCRUDPermissions:i,isLoadingJobs:re,mlJobs:se,startMlJobs:oe,showExceptionsDuplicateConfirmation:H,confirmDeletion:P}),ce=(({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:n,showExceptionsDuplicateConfirmation:i,confirmDeletion:o})=>{const c=Object(h.i)().services.docLinks,u=sv({showExceptionsDuplicateConfirmation:i,confirmDeletion:o}),d=av(),[p]=Object(h.o)(l.xc),m=ev({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:n}),f=nv({sortable:!0,width:"12%",isLoadingJobs:t,mlJobs:a});return Object(r.useMemo)((()=>[{...d,width:"28%"},...p?[rv]:[],iv,{field:"execution_summary.last_execution.metrics.total_indexing_duration_ms",name:s.a.createElement(Mh,{title:Oo.eb,tooltipContent:Oo.fb}),render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"total_indexing_duration_ms",size:"s"},null!=e?e.toFixed():Object(Jc.d)()),sortable:!0,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.metrics.total_search_duration_ms",name:s.a.createElement(Mh,{title:Oo.jb,tooltipContent:Oo.kb}),render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"total_search_duration_ms",size:"s"},null!=e?e.toFixed():Object(Jc.d)()),sortable:!0,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.metrics.execution_gap_duration_s",name:s.a.createElement(Mh,{title:Oo.cb,customTooltip:s.a.createElement("div",{style:{maxWidth:"20px"}},s.a.createElement(Ih,{columnName:Oo.cb},s.a.createElement(ee.EuiText,{style:{width:300}},s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{defaultMessage:"Duration of most recent gap in Rule execution. Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltip",values:{seeDocs:s.a.createElement(ee.EuiLink,{href:`${c.links.siem.troubleshootGaps}`,target:"_blank"},Oo.db)}})))))}),render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"gap",size:"s"},null!=e?ec.a.duration(e,"seconds").humanize():Object(Jc.d)()),sortable:!0,truncateText:!0,width:"14%"},f,{field:"execution_summary.last_execution.date",name:Oo.gb,render:e=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"ruleLastRun"},null==e?Object(Jc.d)():s.a.createElement(Yc.b,{tooltipFieldName:Oo.gb,relativeThresholdInHrs:l.R,value:e,tooltipAnchorClassName:"eui-textTruncate"})),sortable:!0,truncateText:!0,width:"16%"},m,...e?[u]:[]]),[u,c.links.siem.troubleshootGaps,m,f,e,d,p])})({hasCRUDPermissions:i,isLoadingJobs:re,mlJobs:se,startMlJobs:oe,showExceptionsDuplicateConfirmation:H,confirmDeletion:P}),ue=Object(r.useRef)(!1);((e,t)=>{const a=Object(r.useRef)(t);Object(r.useEffect)((()=>{JSON.stringify(a.current)!==JSON.stringify(t)&&(a.current=t,e(t))}),[e,t])})((e=>{null!=c.current&&c.current.setSelection(m.filter((t=>e.includes(t.id))))}),O);const de=i&&(e===zD.management||e===zD.monitoring),pe=Object(r.useMemo)((()=>({selectable:e=>!x.includes(e.id),onSelectionChange:e=>{ue.current?(ue.current=!1,0===e.length&&(w(!1),C([]))):(C(e.map((({id:e})=>e))),w(!1))}})),[x,w,C]),me=Object(r.useCallback)((()=>{ue.current=!0,w(!g),C(g?[]:m.map((({id:e})=>e)))}),[m,g,w,C]),fe=0===(null==p?void 0:p.rules_summary.custom_count)&&0===(null==p?void 0:p.rules_summary.prebuilt_installed_count),be=!v&&!fe;let ge;switch(e){case zD.management:ge={"data-test-subj":"rules-management-table",columns:le};break;case zD.monitoring:ge={"data-test-subj":"rules-monitoring-table",columns:ce};break;default:ge={"data-test-subj":"rules-management-table",columns:le}}const ye=y&&E||o,he=!y&&E||b,ve=Math.max(g?S.total:null!==(t=null==O?void 0:O.length)&&void 0!==t?t:0,1);return s.a.createElement(s.a.Fragment,null,ye&&s.a.createElement(ee.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),he&&s.a.createElement(eu.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),fe&&s.a.createElement(vP,null),_&&s.a.createElement(ee.EuiConfirmModal,{title:1===R?Oo.Vc:Oo.x,onCancel:N,onConfirm:D,confirmButtonText:Oo.wb,cancelButtonText:Oo.vb,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"deleteRulesConfirmationModal"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationModalBody",defaultMessage:'This action will delete {rulesToDeleteCount, plural, one {the chosen rule} other {{rulesToDeleteCountStrong} rules}}. Click "Delete" to continue.',values:{rulesToDeleteCount:R,rulesToDeleteCountStrong:s.a.createElement("strong",null,R)}})),z&&B&&s.a.createElement(TP,{bulkAction:B,result:L,onCancel:$,onConfirm:V}),U&&s.a.createElement(ZD,{onCancel:Q,onConfirm:G,rulesCount:ve}),Z&&void 0!==W&&s.a.createElement(vD,{rulesCount:null!==(a=null==L?void 0:L.succeededRulesCount)&&void 0!==a?a:0,editAction:W,onClose:J,onConfirm:K}),be&&s.a.createElement(s.a.Fragment,null,s.a.createElement(RD,null),s.a.createElement(QD,{canBulkEdit:i,onGetBulkItemsPopoverContent:ae,onToggleSelectAll:me,isBulkActionInProgress:X||null!=j}),s.a.createElement(ee.EuiBasicTable,bo()({itemId:"id",items:m,isSelectable:de,noItemsMessage:YD,onChange:ie,pagination:ne,ref:c,selection:de?pe:void 0,sorting:{sort:{field:k.field,direction:k.order}}},ge))))}));XD.displayName="RulesTables";const eN=s.a.memo((()=>{const{docLinks:e}=Object(h.i)().services;return s.a.createElement(ee.EuiLink,{href:e.links.siem.ruleChangeLog,target:"_blank",external:!0,"data-test-subj":"rules-changelog-link"},Oo.Kc)}));eN.displayName="RulesChangelogLink";const tN=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.upgradeAll",{defaultMessage:"Update all"}),aN=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.searchBarPlaceholder",{defaultMessage:"Search by rule name"}),nN=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.updateButtonLabel",{defaultMessage:"Update"});var iN=a(735),rN=a(326),sN=a(474);const oN=["POST","ALL_RULES",rN.c],lN=["POST","SPECIFIC_RULES",rN.c],cN=Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.ruleInstallationFailed",{defaultMessage:"Rule installation failed"}),uN=Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.ruleUpgradeFailed",{defaultMessage:"Rule update failed"}),dN=e=>{const t=[],{summary:{succeeded:a,skipped:n,failed:i}}=e;return a>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.upgradeRuleSuccess",{defaultMessage:"{succeeded, plural, one {# rule} other {# rules}} updated successfully.",values:{succeeded:e}}))(a)),n>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.upgradeRuleSkipped",{defaultMessage:"{skipped, plural, one {# rule was} other {# rules were}} skipped during update.",values:{skipped:e}}))(n)),i>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.upgradeRuleFailed",{defaultMessage:"{failed, plural, one {# rule} other {# rules}} failed to update.",values:{failed:e}}))(i)),t.join(" ")},pN=e=>{const[t,a]=s.a.useState(null);return{openRulePreview:Object(r.useCallback)((t=>{const n=e.find((e=>e.id===t));Object(iN.a)(n,`Rule with id ${t} not found`),a(n)}),[e,a]),closeRulePreview:Object(r.useCallback)((()=>{a(null)}),[]),previewedRule:t}};var mN=a(179),fN=a(1071),bN=a(1073),gN=a(1072),yN=a(390);const hN=({setup:e})=>s.a.createElement("div",null,s.a.createElement(yN.b,{textSize:"s"},e));var vN=a(570),EN=a(537);const xN={about:!0,definition:!0,schedule:!0,setup:!0},jN=({title:e,isOpen:t,toggle:a,children:n})=>{const i=Object(ee.useGeneratedHtmlId)({prefix:"accordion"});return s.a.createElement(ee.EuiAccordion,{forceState:t?"open":"closed",onToggle:a,paddingSize:"none",id:i,buttonContent:s.a.createElement(ee.EuiTitle,{size:"s"},s.a.createElement("h3",null,e)),initialIsOpen:!0},s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"column"},n))},SN=({rule:e,columnWidths:t=vN.a,expandedOverviewSections:a,toggleOverviewSection:n})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(jN,{title:EN.a,isOpen:a.about,toggle:n.about},e.description&&s.a.createElement(fN.a,{description:e.description}),s.a.createElement(fN.b,{rule:e,columnWidths:t,hideDescription:!0,hideName:!0})),s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(jN,{title:EN.i,isOpen:a.definition,toggle:n.definition},s.a.createElement(bN.a,{rule:e,columnWidths:t})),s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(jN,{title:EN.E,isOpen:a.schedule,toggle:n.schedule},s.a.createElement(gN.a,{rule:e,columnWidths:t})),e.setup&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(jN,{title:EN.F,isOpen:a.setup,toggle:n.setup},s.a.createElement(hN,{setup:e.setup})))),ON=({note:e})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(yN.b,{textSize:"s"},e)),kN=ae()(ee.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1wpvwzo-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeL} 0`)),wN=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-1wpvwzo-1"})(["height:100%;"]),TN=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1wpvwzo-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),IN=ae()(ee.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-1wpvwzo-3"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),CN=e=>s.a.createElement(wN,{direction:"column",gutterSize:"none"},s.a.createElement(TN,{grow:!0},s.a.createElement(IN,e))),MN=mN.css`
  padding: 0 ${jo.euiThemeVars.euiSizeM} ${jo.euiThemeVars.euiSizeXL} ${jo.euiThemeVars.euiSizeM};
`,_N=({children:e})=>s.a.createElement("div",{className:MN},e),AN=({rule:e,ruleActions:t,size:a="m",extraTabs:n=[],dataTestSubj:i,closeFlyout:o})=>{var l;const{expandedOverviewSections:c,toggleOverviewSection:u}=(()=>{const[e,t]=Object(r.useState)(xN),a=Object(r.useCallback)((e=>{t((t=>({...t,[e]:!t[e]})))}),[]);return{expandedOverviewSections:e,toggleOverviewSection:Object(r.useMemo)((()=>({about:()=>a("about"),definition:()=>a("definition"),schedule:()=>a("schedule"),setup:()=>a("setup")})),[a])}})(),d=Object(r.useMemo)((()=>({id:"overview",name:EN.w,content:s.a.createElement(_N,null,s.a.createElement(SN,{rule:e,columnWidths:"l"===a?vN.b:vN.a,expandedOverviewSections:c,toggleOverviewSection:u}))})),[e,a,c,u]),p=Object(r.useMemo)((()=>{var t;return{id:"investigationGuide",name:EN.r,content:s.a.createElement(_N,null,s.a.createElement(ON,{note:null!==(t=e.note)&&void 0!==t?t:""}))}}),[e.note]),m=Object(r.useMemo)((()=>e.note?[...n,d,p]:[...n,d]),[d,p,e.note,n]),[f,b]=Object(r.useState)(m[0].id),g=null!==(l=m.find((e=>e.id===f)))&&void 0!==l?l:m[0];return Object(r.useEffect)((()=>{m.find((e=>e.id===f))||b(m[0].id)}),[m,f]),s.a.createElement(ee.EuiFlyout,{size:a,onClose:o,ownFocus:!1,key:"prebuilt-rules-flyout",paddingSize:"l","data-test-subj":i},s.a.createElement(ee.EuiFlyoutHeader,null,s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",null,e.name)),s.a.createElement(ee.EuiSpacer,{size:"l"})),s.a.createElement(kN,null,s.a.createElement(CN,{tabs:m,selectedTab:g,onTabClick:e=>{b(e.id)}})),s.a.createElement(ee.EuiFlyoutFooter,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{onClick:o,flush:"left"},EN.k)),s.a.createElement(ee.EuiFlexItem,{grow:!1},t))))};var FN=a(1665),PN=a.n(FN),DN=a(471),NN=a(59),RN=a.n(NN),LN=a(1408),BN=(a(1669),a(1671)),zN=a.n(BN);const qN=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.baseVersionLabel",{defaultMessage:"Base version"}),$N=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.baseVersionDescriptionLabel",{defaultMessage:"Shows currently installed rule"}),VN=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.updatedVersionLabel",{defaultMessage:"Update"}),UN=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.updatedVersionDescriptionLabel",{defaultMessage:"Shows rule that will be installed"}),HN=({start:e,end:t,onExpand:a,...n})=>{const i=Object(r.useCallback)((()=>a(e,t)),[a,e,t]),o=t-e;return s.a.createElement(LN.Decoration,n,s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"none"},e>1&&s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center"},s.a.createElement(ee.EuiLink,{onClick:i},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"center",alignItems:"center",gutterSize:"s"},s.a.createElement(ee.EuiIcon,{type:"sortable"}),s.a.createElement(ee.EuiText,{size:"s"},(e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.expandHiddenDiffLinesLabel",{values:{linesCount:e},defaultMessage:"Expand {linesCount} unchanged {linesCount, plural, one {line} other {lines}}"}))(o))))),s.a.createElement(ee.EuiSpacer,{size:"m"})))},QN=({previousHunk:e,currentHunk:t,linesCount:a,onExpand:n})=>{if(!t){const t=e.oldStart+e.oldLines;return a-t+1<=0?null:s.a.createElement(HN,{start:t,end:a+1,onExpand:n})}const i=Object(LN.getCollapsedLinesCountBetween)(e,t);if(!e)return i?s.a.createElement(HN,{start:1,end:t.oldStart,onExpand:n}):null;const r=e.oldStart+e.oldLines,o=t.oldStart;return s.a.createElement(HN,{start:r,end:o,onExpand:n})},GN=({hunks:e,oldSource:t,expandRange:a})=>{const n=t.split("\n").length,i=e.reduce(((i,r,o)=>{const l=i[i.length-1];return i.push(s.a.createElement(QN,{key:`decoration-${r.content}`,previousHunk:l&&l.props.hunk,currentHunk:r,linesCount:n,onExpand:a})),i.push(s.a.createElement(LN.Hunk,{key:`hunk-${r.content}`,hunk:r})),o===e.length-1&&t&&i.push(s.a.createElement(QN,{key:"decoration-tail",previousHunk:r,linesCount:n,onExpand:a})),i}),[]);return s.a.createElement(s.a.Fragment,null,i)};var WN,ZN=a(1516);!function(e){e[e.DELETE=-1]="DELETE",e[e.EQUAL=0]="EQUAL",e[e.INSERT=1]="INSERT"}(WN||(WN={}));const KN=ZN;let JN;function YN(e){const t=Object(I.findIndex)(e,(e=>!Object(LN.isNormal)(e)));if(-1===t)return[];const a=Object(I.findIndex)(e,(e=>!!Object(LN.isNormal)(e)),t);return-1===a?[e.slice(t)]:[e.slice(t,a),...YN(e.slice(a))]}function XN(e){return e.reduce(((e,[t,a])=>{const n=a.split("\n"),[i,...r]=n.map((e=>[t,e]));return[...e.slice(0,-1),[...e[e.length-1],i],...r.map((e=>[e]))]}),[[]])}function eR(e,t){return Object(I.flatMap)(e,((e,a)=>function(e,t){const a=e.reduce(((e,a)=>{const[n,i]=e,[r,s]=a;if(r!==WN.EQUAL){const e={type:"edit",lineNumber:t,start:i,length:s.length};n.push(e)}return[n,i+s.length]}),[[],0]);return a[0]}(e,t+a)))}!function(e){e.CHARS="diffChars",e.WORDS="diffWords",e.WORDS_WITH_SPACE="diffWordsWithSpace",e.LINES="diffLines",e.TRIMMED_LINES="diffTrimmedLines",e.SENTENCES="diffSentences",e.CSS="diffCss"}(JN||(JN={}));const tR=e=>{if(e&&!Object(LN.isNormal)(e))return e.lineNumber};function aR(e,t){const a=Object(I.flatMap)(e.map((e=>e.changes)),YN),[n,i]=a.map((e=>function(e,t){const[a,n]=e.reduce((([e,t],a)=>Object(LN.isDelete)(a)?[e+(e?"\n":"")+a.content,t]:[e,t+(t?"\n":"")+a.content]),["",""]),[i,r]=function(e,t,a){const n=KN[e](t,a),i=ZN.convertChangesToDMP(n);return i.length<=1?[[],[]]:function(e){return e.reduce((([e,t],a)=>{const[n]=a;switch(n){case WN.INSERT:t.push(a);break;case WN.DELETE:e.push(a);break;default:e.push(a),t.push(a)}return[e,t]}),[[],[]])}(i)}(t,a,n);if(0===i.length&&0===r.length)return[[],[]];const s=tR(e.find(LN.isDelete)),o=tR(e.find(LN.isInsert));if(void 0===s||void 0===o)throw new Error("Could not find start line number for edit");return[eR(XN(i),s),eR(XN(r),o)]}(e,t))).reduce((([e,t],[a,n])=>[e.concat(a),t.concat(n)]),[[],[]]);return Object(LN.pickRanges)(Object(I.flatten)(n),Object(I.flatten)(i))}const nR="rule-update-diff-table",iR="rule-update-diff-code",rR="rule-update-diff-gutter",sR="rule-update-diff-dark-theme",oR={deletion:"rgb(255, 215, 213)",insertion:"rgb(204, 255, 216)"},lR={deletion:"rgb(255, 235, 233)",insertion:"rgb(230, 255, 236)"},cR={deletion:"rgba(255, 129, 130, 0.4)",insertion:"rgb(171, 242, 188)"},uR={deletion:"rgba(248, 81, 73, 0.3)",insertion:"rgba(63, 185, 80, 0.3)"},dR={deletion:"rgba(248, 81, 73, 0.1)",insertion:"rgba(46, 160, 67, 0.15)"},pR={deletion:"rgba(248, 81, 73, 0.4)",insertion:"rgba(46, 160, 67, 0.4)"},mR=({change:e})=>"insert"===e.type?s.a.createElement("span",null,"+"):"delete"===e.type?s.a.createElement("span",null,"-"):null,fR=({children:e})=>{const{euiTheme:t}=Object(ee.useEuiTheme)(),a=Ws.css`
    .${iR}.diff-code {
      padding: 0 ${t.size.l} 0 ${t.size.m};
    }

    .${nR} .diff-gutter-col {
      width: ${t.size.xl};
    }

    /* Vertical line separating two sides of the diff view */
    .${rR}:nth-child(3) {
      border-left: 1px solid ${t.colors.mediumShade};
    }

    /* Gutter of a line with deletions */
    .${rR}.diff-gutter-delete {
      font-weight: bold;
      background: ${oR.deletion};
    }
    .${sR} .${rR}.diff-gutter-delete {
      background: ${uR.deletion};
    }

    /* Gutter of a line with insertions */
    .${rR}.diff-gutter-insert {
      font-weight: bold;
      background: ${oR.insertion};
    }
    .${sR} .${rR}.diff-gutter-insert {
      background: ${uR.insertion};
    }

    /* Background of a line with deletions */
    .${iR}.diff-code-delete {
      background: ${lR.deletion};
    }
    .${sR} .${iR}.diff-code-delete {
      background: ${dR.deletion};
    }

    /* Background of a line with insertions */
    .${iR}.diff-code-insert {
      background: ${lR.insertion};
    }
    .${sR} .${iR}.diff-code-insert {
      background: ${dR.insertion};
    }

    /* Accented background of removed characters / words */
    .${iR}.diff-code-delete .diff-code-edit {
      font-weight: 700;
      background: ${cR.deletion};
    }
    .${sR} .${iR}.diff-code-delete .diff-code-edit {
      background: ${pR.deletion};
    }

    /* Accented background of inserted characters / words */
    .${iR}.diff-code-insert .diff-code-edit {
      font-weight: 700;
      background: ${cR.insertion};
    }
    .${sR} .${iR}.diff-code-insert .diff-code-edit {
      background: ${pR.insertion};
    }
  `;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ws.Global,{styles:a}),e)},bR=({oldSource:e,newSource:t,diffMethod:a=JN.WORDS})=>{const n=Object(r.useMemo)((()=>((e,t)=>{const a=zN.a.diffLines(e,t),n=zN.a.formatLines(a,{context:3}),[i]=Object(LN.parseDiff)(n,{nearbySequences:"zip"});return i})(e,t)),[e,t]),{expandRange:i,hunks:o}=((e,t)=>{const[a,n]=Object(LN.useSourceExpansion)(e,t);return{expandRange:n,hunks:Object(LN.useMinCollapsedLines)(0,a,t)}})(n.hunks,e),l=((e,t,a)=>{if(!e)return;const n={oldSource:a,highlight:!1,enhancers:[aR(e,t)]};try{return Object(LN.tokenize)(e,n)}catch(e){return}})(o,a,e),{colorMode:c}=Object(ee.useEuiTheme)(),u=RN()(nR,{[sR]:c===ee.COLOR_MODES_STANDARD.dark});return s.a.createElement(fR,null,s.a.createElement(LN.Diff,{diffType:n.type,hunks:o,renderGutter:mR,tokens:l,className:u,gutterClassName:rR,codeClassName:iR},(t=>s.a.createElement(GN,{hunks:t,oldSource:e,expandRange:i}))))},gR=["actions","exceptions_list","enabled","revision","updated_at"],yR=e=>PN()(e,{space:2}),hR=e=>{var t;const a={...e};if(a.from=Object(DN.e)({interval:a.interval,from:Object(Jh.f)(a.from,a.interval),to:a.to}).from,a.note=null!==(t=a.note)&&void 0!==t?t:"",a.threat=Object(DN.a)(a.threat),"machine_learning_job_id"in a&&(a.machine_learning_job_id=Object(Zh.i)(a.machine_learning_job_id)),"threat_match"===a.type&&Array.isArray(a.threat_filters)){const e=a.threat_filters.map((e=>e.meta.alias?e:{...e,meta:{...e.meta,alias:null}}));a.threat_filters=e}return a},vR=({oldRule:e,newRule:t})=>{const[a,n]=Object(r.useMemo)((()=>{const a=Object(I.omit)(hR(t),...gR),n=Object(I.omit)(Object(I.pick)(hR(e),Object.keys(a)));return[yR(n),yR(a)]}),[e,t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiPanel,{color:"transparent",hasBorder:!0},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},s.a.createElement(ee.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs"},s.a.createElement(ee.EuiIconTip,{color:"subdued",content:$N,type:"iInCircle",size:"m",display:"block"}),s.a.createElement(ee.EuiTitle,{size:"xxxs"},s.a.createElement("h6",null,qN))),s.a.createElement(ee.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs"},s.a.createElement(ee.EuiIconTip,{color:"subdued",content:UN,type:"iInCircle",size:"m"}),s.a.createElement(ee.EuiTitle,{size:"xxxs"},s.a.createElement("h6",null,VN)))),s.a.createElement(ee.EuiHorizontalRule,{margin:"s",size:"full"}),s.a.createElement(bR,{oldSource:a,newSource:n})))},ER=Y.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageTitle",{defaultMessage:"ML rule updates may override your existing rules"}),xR=Y.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.cancelTitle",{defaultMessage:"Cancel"}),jR=Y.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.confirmTitle",{defaultMessage:"Load rules"}),SR=Y.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.affectedJobsTitle",{defaultMessage:"Affected jobs:"}),OR=()=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody",defaultMessage:"{summary} Documentation: {docs}",values:{summary:s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody.summary",defaultMessage:"New V3 machine learning jobs have been released, and the latest corresponding prebuilt detection rules now use these new ML jobs. You're currently running one or more V1/V2 jobs, which only work with legacy prebuilt rules. To ensure continued coverage using V1/V2 jobs, you may need to duplicate or create new rules before updating your Elastic prebuilt detection rules. Check the documentation below for instructions on how to keep using the V1/V2 jobs, and how to start using the new V3 jobs."})),docs:s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(Os,null)))}}),kR=ae.a.ul.withConfig({displayName:"JobsUL",componentId:"sc-pal3mu-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(yc.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),wR=({jobs:e,onCancel:t,onConfirm:a})=>s.a.createElement(ee.EuiConfirmModal,{title:ER,onCancel:t,onConfirm:a,cancelButtonText:xR,confirmButtonText:jR,buttonColor:"danger",defaultFocusedButton:"confirm"},s.a.createElement(OR,null),SR,s.a.createElement(kR,null,e.map((e=>s.a.createElement("li",{key:e.id},e.id))))),TR=Object(r.memo)(wR),IR=Object(r.createContext)(null),CR=({children:e})=>{const[t,a]=Object(r.useState)([]),[n,i]=Object(r.useState)([]),[o,l]=Object(r.useState)({filter:"",tags:[]}),c=Object(ve.a)("jsonPrebuiltRulesDiffingEnabled"),u=Object(JD.a)(),{data:{rules:d,stats:{tags:p}}={rules:[],stats:{tags:[]}},refetch:m,dataUpdatedAt:f,isFetched:b,isLoading:g,isRefetching:y}=(e=>{const{addError:t}=Object(Pt.a)();return Object(ch.a)({onError:e=>t(e,{title:IF.b}),refetchInterval:!1,keepPreviousData:!0})})(),{mutateAsync:h}=(()=>{const{addError:e,addSuccess:t}=Object(Pt.a)();return(e=>{const t=Object(rh.b)(),a=Object(sN.b)(),n=Object(oh.b)(),i=Object(ch.b)(),r=Object(lh.b)(),s=Object(dh.b)();return Object(ih.useMutation)((()=>Object(xc.t)()),{...e,mutationKey:oN,onSettled:(...o)=>{t(),a(),n(),i(),r(),s(),null!=e&&e.onSettled&&e.onSettled(...o)}})})({onError:t=>{e(t,{title:uN})},onSuccess:e=>{t(dN(e))}})})(),{mutateAsync:v}=(()=>{const{addError:e,addSuccess:t}=Object(Pt.a)();return(e=>{const t=Object(rh.b)(),a=Object(sN.b)(),n=Object(lh.b)(),i=Object(oh.b)(),r=Object(ch.b)(),s=Object(lh.b)(),o=Object(dh.b)();return Object(ih.useMutation)((e=>Object(xc.u)(e)),{...e,mutationKey:lN,onSettled:(...l)=>{n(),t(),a(),i(),r(),s(),o(),null!=e&&e.onSettled&&e.onSettled(...l)}})})({onError:t=>{e(t,{title:uN})},onSuccess:e=>{t(dN(e))}})})(),E=(({rules:e,filterOptions:t})=>Object(r.useMemo)((()=>{const{filter:a,tags:n}=t;return e.filter((e=>!(a&&!e.current_rule.name.toLowerCase().includes(a.toLowerCase()))&&(!(n&&n.length>0)||n.every((t=>e.current_rule.tags.includes(t))))))}),[t,e]))({filterOptions:o,rules:d}),{openRulePreview:x,closeRulePreview:j,previewedRule:S}=pN(E.map((e=>e.target_rule))),O=Boolean((null==S?void 0:S.rule_id)&&t.includes(S.rule_id)||y||u),[k,w,T]=Object(Wh.a)(!1),{loading:I,jobs:C}=Object(Nd.b)(),M=C.filter((e=>rF.includes(e.id))),[_,A,F]=SD({onInit:w,onFinish:T}),P=M.length>0,D=Object(r.useCallback)((async e=>{const t=d.find((t=>t.rule_id===e));Object(iN.a)(t,`Rule with id ${e} not found`),a((t=>[...t,e]));try{var n,i;if(P&&!await _())return;await v([{rule_id:e,version:null!==(n=null===(i=t.diff.fields.version)||void 0===i?void 0:i.target_version)&&void 0!==n?n:t.current_rule.version,revision:t.revision}])}finally{a((t=>t.filter((t=>t!==e))))}}),[_,d,P,v]),N=Object(r.useCallback)((async()=>{const e=n.map((e=>{var t,a;return{rule_id:e.rule_id,version:null!==(t=null===(a=e.diff.fields.version)||void 0===a?void 0:a.target_version)&&void 0!==t?t:e.current_rule.version,revision:e.revision}}));a((t=>[...t,...e.map((e=>e.rule_id))]));try{if(P&&!await _())return;await v(e)}finally{a((t=>t.filter((t=>!e.some((e=>e.rule_id===t)))))),i([])}}),[_,n,P,v]),R=Object(r.useCallback)((async()=>{a((e=>[...e,...d.map((e=>e.rule_id))]));try{if(P&&!await _())return;await h()}finally{a([]),i([])}}),[_,d,P,h]),L=Object(r.useMemo)((()=>({reFetchRules:m,upgradeOneRule:D,upgradeSelectedRules:N,upgradeAllRules:R,setFilterOptions:l,selectRules:i,openRulePreview:x})),[m,D,N,R,x]),B=Object(r.useMemo)((()=>({state:{rules:d,filteredRules:E,filterOptions:o,tags:p,isFetched:b,isLoading:g&&I,isRefetching:y,isUpgradingSecurityPackages:u,selectedRules:n,loadingRules:t,lastUpdated:f},actions:L})),[d,E,o,p,b,g,I,y,u,n,t,f,L]),z=Object(r.useMemo)((()=>{const e=c&&S&&E.find((({id:e})=>e===S.id));return e?[{id:"updates",name:EN.U,content:s.a.createElement(_N,null,s.a.createElement(vR,{oldRule:e.current_rule,newRule:e.target_rule}))}]:[]}),[S,E,c]);return s.a.createElement(IR.Provider,{value:B},s.a.createElement(s.a.Fragment,null,k&&s.a.createElement(TR,{jobs:M,onCancel:F,onConfirm:A}),e,S&&s.a.createElement(AN,{rule:S,size:c?"l":"m",dataTestSubj:"updatePrebuiltRulePreview",closeFlyout:j,ruleActions:s.a.createElement(ee.EuiButton,{disabled:O,onClick:()=>{var e;D(null!==(e=S.rule_id)&&void 0!==e?e:""),j()},fill:!0,"data-test-subj":"updatePrebuiltRuleFromFlyoutButton"},nN),extraTabs:z})))},MR=()=>{const e=Object(r.useContext)(IR);return Object(iN.a)(e,"useUpgradePrebuiltRulesTableContext should be used inside UpgradePrebuiltRulesTableContextProvider"),e},_R=()=>{var e;const{state:{rules:t,selectedRules:a,loadingRules:n,isRefetching:i,isUpgradingSecurityPackages:r},actions:{upgradeAllRules:o,upgradeSelectedRules:l}}=MR(),[{loading:c,canUserCRUD:u}]=Object(kt.b)(),d=u&&!c,p=t.length>0,m=null!==(e=a.length)&&void 0!==e?e:0,f=m>0,b=n.length>0,g=b||i||r;return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},f?s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{onClick:l,disabled:!d||g,"data-test-subj":"upgradeSelectedRulesButton"},s.a.createElement(s.a.Fragment,null,(e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.upgradeSelected",{defaultMessage:"Update {numberOfSelectedRules} selected rule(s)",values:{numberOfSelectedRules:e}}))(m),b?s.a.createElement(ee.EuiLoadingSpinner,{size:"s"}):void 0))):null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:o,disabled:!d||!p||g,"data-test-subj":"upgradeAllRulesButton"},tN,b?s.a.createElement(ee.EuiLoadingSpinner,{size:"s"}):void 0)))},AR=ae()(ee.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-1l3u1j4-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM)),FR=()=>{const{state:{filterOptions:e,tags:t},actions:{setFilterOptions:a}}=MR(),{tags:n}=e,i=Object(r.useCallback)((e=>{a((t=>({...t,filter:e.trim()})))}),[a]),o=Object(r.useCallback)((e=>{Object(A.isEqual)(e,n)||a((t=>({...t,tags:e})))}),[n,a]);return s.a.createElement(AR,{gutterSize:"m",justifyContent:"flexEnd",wrap:!0},s.a.createElement(PD,{initialValue:e.filter,onSearch:i,placeholder:aN}),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(wD,{onSelectedTagsChanged:o,selectedTags:n,tags:t,"data-test-subj":"upgradeRulesTagPopover"}))))};FR.displayName="UpgradePrebuiltRulesTableFiltersComponent";const PR=s.a.memo(FR);PR.displayName="UpgradePrebuiltRulesTableFilters";const DR=({name:e,ruleId:t})=>{const{actions:{openRulePreview:a}}=MR();return s.a.createElement(ee.EuiLink,{onClick:()=>{a(t)},"data-test-subj":"ruleName"},e)},NR={field:"current_rule.name",name:Oo.mb,render:(e,t)=>s.a.createElement(DR,{name:e,ruleId:t.id}),sortable:!0,truncateText:!0,width:"60%",align:"left"},RR={field:"current_rule.tags",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(So.a,{items:e,popoverTitle:Oo.pb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>s.a.createElement(ee.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},LR={field:"current_rule.related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(Xy,{relatedIntegrations:e}),width:"143px",truncateText:!0},BR=(e,t,a)=>({field:"rule_id",name:"",render:n=>{const i=t.includes(n),r=i||a;return s.a.createElement(ee.EuiButtonEmpty,{size:"s",disabled:r,onClick:()=>e(n),"data-test-subj":`upgradeSinglePrebuiltRuleButton-${n}`},i?s.a.createElement(ee.EuiLoadingSpinner,{size:"s","data-test-subj":`upgradeSinglePrebuiltRuleButton-loadingSpinner-${n}`}):Oo.Yc)},width:"10%",align:"center"}),zR=s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,Oo.Vb),titleSize:"s",body:Oo.Wb,"data-test-subj":"noPrebuiltRulesAvailableForUpgrade"}),qR=s.a.memo((()=>{const e=MR(),{state:{rules:t,filteredRules:a,isFetched:n,isLoading:i,selectedRules:o,isRefetching:c,isUpgradingSecurityPackages:u},actions:{selectRules:d}}=e,p=(()=>{const[{canUserCRUD:e}]=Object(kt.b)(),t=Object(Vy.c)(e),[a]=Object(h.o)(l.xc),{state:{loadingRules:n,isRefetching:i,isUpgradingSecurityPackages:o},actions:{upgradeOneRule:c}}=MR(),u=i||o;return Object(r.useMemo)((()=>[NR,...a?[LR]:[],RR,{field:"current_rule.risk_score",name:Oo.lb,render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"current_rule.severity",name:Oo.nb,render:e=>s.a.createElement(kh.a,{value:e}),sortable:({current_rule:{severity:e}})=>wc(e),truncateText:!0,width:"12%"},...t?[BR(c,n,u)]:[]]),[t,n,u,a,c])})(),m=n&&0===t.length,f=u||c;return s.a.createElement(s.a.Fragment,null,f&&s.a.createElement(ee.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(ee.EuiSkeletonLoading,{isLoading:i,loadingContent:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSkeletonTitle,null),s.a.createElement(ee.EuiSkeletonText,null)),loadedContent:m?zR:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(eN,null)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s",responsive:!1,wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(PR,null)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(_R,null))))),s.a.createElement(ee.EuiInMemoryTable,{items:a,sorting:!0,pagination:{initialPageSize:fP.a,pageSizeOptions:fP.b},isSelectable:!0,selection:{selectable:()=>!0,onSelectionChange:d,initialSelected:o},itemId:"rule_id","data-test-subj":"rules-upgrades-table",columns:p}))}))}));qR.displayName="UpgradePrebuiltRulesTable";const $R=s.a.memo((()=>{!function(){const{state:e}=Object(nh.b)(),{services:{sessionStorage:t}}=Object(h.i)(),a=Object(mb.g)();Object(r.useEffect)((()=>{const n={},i={};if(e.filterOptions.filter.length>0&&(n.searchTerm=e.filterOptions.filter,i.searchTerm=e.filterOptions.filter),e.filterOptions.showElasticRules||e.filterOptions.showCustomRules){const t=e.filterOptions.showCustomRules?bP.a.Custom:bP.a.Prebuilt;n.source=t,i.source=t}e.filterOptions.tags.length>0&&(n.tags=e.filterOptions.tags,i.tags=e.filterOptions.tags),void 0!==e.filterOptions.enabled&&(n.enabled=e.filterOptions.enabled,i.enabled=e.filterOptions.enabled),e.sortingOptions.field!==gP.d.field&&(n.field=e.sortingOptions.field,i.field=e.sortingOptions.field),e.sortingOptions.order!==gP.d.order&&(n.order=e.sortingOptions.order,i.order=e.sortingOptions.order),e.pagination.page!==gP.b&&(n.page=e.pagination.page),e.pagination.perPage!==gP.c&&(n.perPage=e.pagination.perPage,i.perPage=e.pagination.perPage),void 0!==e.filterOptions.ruleExecutionStatus&&(n.ruleExecutionStatus=e.filterOptions.ruleExecutionStatus,i.ruleExecutionStatus=e.filterOptions.ruleExecutionStatus);const r=Object.keys(n).length>0,s=Object.keys(i).length>0;r||a({[bt.a.rulesTable]:null}),s||t.remove(fP.c),(r||s)&&(a({[bt.a.rulesTable]:n}),t.set(fP.c,i))}),[a,t,e])}();const[{tabName:e}]=Object(C.a)();return e!==zD.updates?s.a.createElement(s.a.Fragment,null,s.a.createElement(OF,null),s.a.createElement(qD,null),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(XD,{selectedTab:e})):s.a.createElement(s.a.Fragment,null,s.a.createElement(CR,null,s.a.createElement(qD,null),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(qR,null)))}));$R.displayName="AllRules";const VR=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.tour.createRuleTourTitle",{defaultMessage:"New security rule features are available"}),UR=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.tour.createRuleTourContent.eql",{defaultMessage:"Use the Elasticsearch Query Language (ES|QL) rule to find events and aggregate search results."}),HR=({children:e})=>{var t,a;const n={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300},{storage:i,guidedOnboarding:o}=Object(h.i)().services,c=dF()(null!==(t=null==o||null===(a=o.guidedOnboardingApi)||void 0===a?void 0:a.isGuideStepActive$(pF.a,"rules"))&&void 0!==t?t:Object(Ie.of)(!1),!0),[u,d]=Object(r.useState)((()=>{const e=i.get(l.Qb.RULE_MANAGEMENT_PAGE);return null!=e?e:n})),p=[{step:1,title:VR,content:s.a.createElement(ee.EuiText,null,UR)}],m=Object(r.useCallback)((()=>{d({...u,isTourActive:!1})}),[u]);return Object(r.useEffect)((()=>{i.set(l.Qb.RULE_MANAGEMENT_PAGE,u)}),[u,i]),s.a.createElement(ee.EuiTourStep,{content:p[0].content,isStepOpen:1===u.currentTourStep&&u.isTourActive&&!c,minWidth:u.tourPopoverWidth,onFinish:m,step:1,stepsTotal:p.length,subtitle:u.tourSubtitle,title:p[0].title,anchorPosition:"rightUp"},e)},QR=()=>{const e=Object(h.i)().services.configSettings.ESQLEnabled,t=!Object(ve.a)("esqlRulesDisabled");return e&&t},GR=()=>{const[e,t,a]=Object(Wh.a)(),[n,i,o]=Object(Wh.a)(),c=Object(h.i)().services,{navigateToApp:u}=c.application,d=Object(rh.b)(),p=Object(dh.b)(),m=Object(oh.b)(),f=Object(r.useCallback)((()=>{d(),m(),p()}),[d,m,p]),[{loading:b,isSignalIndexExists:g,isAuthenticated:y,hasEncryptionKey:v,canUserCRUD:E}]=Object(kt.b)(),{loading:x,canWriteIndex:j,canCreateIndex:O,needsConfiguration:k,needsIndex:w}=zt(),T=b||x,I=QR();if(Object(Jh.i)(g,y,v,k))return u(l.l,{deepLinkId:P.a.alerts,path:Object(we.a)()}),null;const C=s.a.createElement($t.l,{"data-test-subj":"create-new-rule",fill:!0,iconType:"plusInCircle",isDisabled:!Object(Vy.c)(E)||T,deepLinkId:P.a.rulesCreate},Oo.d),M=w&&!O,A=M||!j||!E||T;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Is,null),s.a.createElement(Qs,null),s.a.createElement(cF,null),s.a.createElement(pP,{showFlyout:n,onClose:o}),s.a.createElement(iF.a,{checkBoxLabel:Oo.ac,closeModal:a,description:Oo.Tc,errorMessage:Oo.Jb,failedDetailed:Oo.Kb,importComplete:f,importData:mP.c,successMessage:Oo.Wc,showModal:e,submitBtnText:Oo.Mb,subtitle:Oo.Ob,title:Oo.Lb,showExceptionsCheckBox:!0,showCheckBox:!0,showActionConnectorsCheckBox:!0}),s.a.createElement(nh.a,null,s.a.createElement(S.a,null,s.a.createElement(oo,{title:Oo.bc},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(MF,{isDisabled:!E||T})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiToolTip,{position:"top",content:M?Oo.Zc:Oo.ad},s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:A,onClick:i},Oo.Nb))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":"rules-import-modal-button",iconType:"importAction",isDisabled:!Object(Vy.c)(E)||T,onClick:t},Oo.Lb)),s.a.createElement(ee.EuiFlexItem,{grow:!1},I?s.a.createElement(HR,null,C):C))),s.a.createElement(nF,{kibanaServices:c,categories:[HA.security.id]}),s.a.createElement($R,{"data-test-subj":"all-rules"}))),s.a.createElement(_,{pageName:P.a.rules}))},WR=s.a.memo(GR),ZR=ae.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-19scuzy-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),KR=({name:e,type:t})=>{const a=(()=>{const[e]=Object(h.o)(l.C);return e?jo.euiDarkVars:jo.euiLightVars})(),n="passive"===t?a.euiColorLightestShade:a.euiColorPrimary;return s.a.createElement(ZR,null,s.a.createElement(ee.EuiAvatar,{color:n,name:"valid"===t?"":e,size:"l","aria-label":e}),"valid"===t?s.a.createElement(ee.EuiIcon,{type:"check",color:a.euiColorEmptyShade,size:"l"}):null)},JR=Object(r.memo)(KR),YR=({name:e,title:t,type:a})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(JR,{name:e,type:a})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiTitle,{size:"s"},s.a.createElement("h6",null,t)))),XR=s.a.memo(YR);var eL=a(235),tL=a.n(eL),aL=a(711),nL=a(307),iL=a(1502),rL=a(1113),sL=a(1079);const oL=({actions:e})=>e.length?s.a.createElement("ul",null,e.map(((e,t)=>s.a.createElement("li",{key:t},lL(e.actionTypeId))))):null,lL=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(A.startCase)(t):""},cL=[{value:l.Ub,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],uL=[{value:l.Tb,text:"Perform no actions"},...cL],dL=uL[0],pL=(e=dL.value,t)=>{const a=Object(A.find)(["value",e],uL);return{title:t,description:a?a.text:e}},mL=ae()(ee.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-157un4q-0"})(["max-width:600px;.euiDescriptionList__description{overflow-wrap:anywhere;}"]),fL=["50%","50%"],bL=({data:e,columns:t="multi",indexPatterns:a,schema:n})=>{const i=Object(h.i)(),o=Object(be.b)(),[l]=Object(r.useState)(new Ho.FilterManager(i.services.uiSettings)),c=Object.keys(n).reduce(((t,i)=>{return"machineLearningJobId"===i?[...t,(r=Object(A.get)(i,e),c=Object(A.get)(i,n).label,{title:c,description:s.a.createElement(sL.a,{jobIds:r})})]:"throttle"===i?[...t,pL(Object(A.get)(i,e),Object(A.get)([i,"label"],n))]:"actions"===i?[...t,(u=Object(A.get)(i,e),d=Object(A.get)([i,"label"],n),{title:u.length?d:"",description:s.a.createElement(oL,{actions:u})})]:[...t,...yL(e,Object(A.pick)(i,n),l,o,a)];var r,c,u,d}),[]);return"multi"===t?s.a.createElement(ee.EuiFlexGroup,null,Object(A.chunk)(Math.ceil(c.length/2),c).map(((e,t)=>s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},s.a.createElement(ee.EuiDescriptionList,{listItems:e}))))):s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?s.a.createElement(ee.EuiDescriptionList,{listItems:c}):s.a.createElement(mL,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",columnWidths:fL,rowGutterSize:"m",listItems:c})))},gL=Object(r.memo)(bL),yL=(e,t,a,n,i)=>Object.keys(t).reduce(((r,s)=>[...r,...vL(s,Object(A.get)([s,"label"],t),e,a,n,i)]),[]),hL=e=>e.map((e=>null==e.$state?{$state:{store:za.FilterStateStore.APP_STATE},...e}:e)),vL=(e,t,a,n,i,r)=>{if("queryBar"===e){var s;const t=hL(null!==(s=Object(A.get)("queryBar.filters",a))&&void 0!==s?s:[]),i=Object(A.get)("queryBar.query.query",a),o=Object(A.get)("queryBar.saved_id",a),l=Object(A.get)("queryBar.title",a);return Object(iL.g)({field:e,filters:t,filterManager:n,query:i,savedId:o,savedQueryName:l,indexPatterns:r})}if("responseActions"===e)return[];if("groupByFields"===e){const n=Object(A.get)("ruleType",a);if(!Object(Zh.f)(n))return[];const i=Object(A.get)(e,a);return Object(iL.a)(t,i)}if("groupByRadioSelection"===e)return[];if("groupByDuration"===e){const n=Object(A.get)("ruleType",a);if(!Object(Zh.f)(n)&&!Object(Zh.h)(n))return[];if(Object(Zh.h)(n)?!0===Object(A.get)("enableThresholdSuppression",a):Object(A.get)("groupByFields",a).length>0){const n=Object(A.get)(e,a);return Object(iL.c)(t,n,Object(A.get)("groupByRadioSelection",a))}return[]}if("suppressionMissingFields"===e){const n=Object(A.get)("ruleType",a);if(!Object(Zh.f)(n))return[];if(Object(A.get)("groupByFields",a).length>0){const n=Object(A.get)(e,a);return Object(iL.b)(t,n)}return[]}if("eqlOptions"===e){const t=Object(A.get)(e,a);return Object(iL.d)(t)}if("threat"===e){const n=Object(A.get)(e,a);return Object(iL.m)({label:t,threat:Object(DN.a)(n)})}if("threshold"===e){const n=Object(A.get)(e,a);return Object(iL.o)(t,n)}if("references"===e){const n=Object(A.get)(e,a);return Object(iL.q)(t,n)}if("falsePositives"===e){const n=Object(A.get)(e,a);return Object(iL.p)(t,e,n)}if("investigationFields"===e){const n=Object(A.get)(e,a);return Object(iL.e)(t,n)}if("riskScore"===e){const t=Object(A.get)(e,a);return Object(iL.i)(t)}if("severity"===e){const t=Object(A.get)(e,a);return Object(iL.k)(t)}if("requiredFields"===e){const n=Object(A.get)(e,a);return Object(iL.h)(t,n)}if("relatedIntegrations"===e){const n=Object(A.get)(e,a);return Object(Uy.c)(t,n)}var o;if("timeline"===e)return[{title:t,description:null!==(o=Object(A.get)(e,a).title)&&void 0!==o?o:VP.b}];if("note"===e){const n=Object(A.get)(e,a);return Object(iL.f)(t,n)}if("ruleType"===e){const n=Object(A.get)(e,a);return Object(iL.j)(t,n)}if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var l;const t=hL(null!==(l=Object(A.get)("threatQueryBar.filters",a))&&void 0!==l?l:[]),i=Object(A.get)("threatQueryBar.query.query",a),s=Object(A.get)("threatQueryBar.saved_id",a);return Object(iL.g)({field:e,filters:t,filterManager:n,query:i,savedId:s,indexPatterns:r,queryLabel:rL.v})}if("threatMapping"===e){const n=Object(A.get)(e,a);return Object(iL.n)(t,n)}if(Array.isArray(Object(A.get)(e,a))&&"threatMapping"!==e){const n=Object(A.get)(e,a);return Object(iL.l)(t,e,n)}if("index"===e){if(Object(A.get)("dataViewId",a))return[]}else if("isBuildingBlock"===e)return Object(A.get)("isBuildingBlock",a)?[{title:rL.e,description:rL.d}]:[];const c=Object(A.get)(e,a);return Object(A.isNumber)(c)||!Object(A.isEmpty)(c)?[{title:t,description:c}]:[]};var EL=a(467),xL=a(757),jL=a(560);const SL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),OL=["duplicate","createFrom"],kL=e=>{var t;return{filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id,title:e.attributes.title}},wL=({defaultSavedQuery:e,browserFields:t,dataTestSubj:a,field:n,idAria:i,indexPattern:o,isLoading:l=!1,onCloseTimelineSearch:c,openTimelineSearch:u=!1,resizeParentContainer:d,onValidityChange:p,isDisabled:m,resetToSavedQuery:f,onOpenTimeline:b,onSavedQueryError:g})=>{const{value:y,setValue:v}=n,[E,x]=Object(r.useState)(-1),[j,S]=Object(r.useState)(!1),[O,k]=Object(r.useState)(e),[w,I]=Object(r.useState)(!1),{isInvalid:C,errorMessage:M}=Object(IP.i)(n),{uiSettings:_}=Object(h.i)().services,[A]=Object(r.useState)(new Ho.FilterManager(_)),F=Object(jL.a)();Object(r.useEffect)((()=>{null!=p&&p(!C)}),[C,p]),Object(r.useEffect)((()=>{let e=!0;const t=new Ie.Subscription;return A.setFilters([]),t.add(A.getUpdates$().subscribe({next:()=>{if(e){const e=A.getFilters(),{filters:t}=y;T()(t,e)||v({...y,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[y,A,v]),Object(r.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:a}=y;if(T()(t,A.getFilters())||A.setFilters(t),null!=a&&null!=O&&a!==O.id||null!=a&&null==O)try{const t=await F.getSavedQuery(a);e&&null!=t&&k(t),I(!1)}catch{k(void 0),I(!0)}else null==a&&null!=O&&k(void 0)}(),()=>{e=!1}}),[y,A,O,F,I,v]),Object(r.useEffect)((()=>{w&&(null==g||g())}),[g,w]),Object(r.useEffect)((()=>{if(f&&O){const e=kL(O);v(e)}}),[f,O,v]);const P=Object(r.useCallback)((e=>{const{query:t}=y;T()(t,e)||v({...y,query:e})}),[y,v]),D=Object(r.useCallback)((e=>{const{query:t}=y;if(!T()(t,e)){const t=w?null:y.saved_id;v({...y,query:e,saved_id:t})}}),[y,v,w]),N=Object(r.useCallback)((e=>{if(null!=e){const{saved_id:t}=y;if(I(!1),k(e),e.id!==t){const t=kL(e);v(t)}else v({filters:[],query:{query:"",language:"kuery"},saved_id:null})}}),[y,v,I]),R=Object(r.useCallback)((()=>{S(!0),c()}),[c]),L=Object(r.useCallback)((e=>{S(!1),null==b||b(e)}),[b]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFormRow,{label:n.label,labelAppend:n.labelAppend,helpText:n.helpText,error:M,isInvalid:C,fullWidth:!0,"data-test-subj":a,describedByIds:i?[i]:void 0},s.a.createElement(ee.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=d){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),a=document.getElementById("define-rule");if(null!=a){const e=a.getBoundingClientRect();(-1===E||e.height<E+t.height)&&d(E+t.height-100),-1===E&&x(e.height)}}else d(-1)}}},(e=>s.a.createElement("div",{ref:e},s.a.createElement(xL.a,{indexPattern:o,isLoading:l||j,isRefreshPaused:!1,filterQuery:y.query,filterManager:A,filters:A.getFilters()||[],onChangedQuery:D,onSubmitQuery:P,savedQuery:O,onSavedQuery:N,hideSavedQuery:!1,displayStyle:"inPage",isDisabled:m}))))),u?s.a.createElement(EL.a,{hideActions:OL,modalTitle:SL,onClose:R,onOpen:L}):null)},TL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),IL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),CL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.esqlTypeTitle",{defaultMessage:"ES|QL"}),ML=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.esqlTypeDescription",{defaultMessage:"Use Elasticsearch Query Language (ES|QL) to find events and aggregate search results."}),_L=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),AL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),FL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),PL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),DL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),NL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),RL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),LL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),BL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsTitle",{defaultMessage:"New Terms"}),zL=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsDescription",{defaultMessage:"Find documents with values appearing for the first time."}),qL=ae.a.span.withConfig({displayName:"SmallText",componentId:"sc-1i47q47-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),$L=({hasValidLicense:e=!1})=>s.a.createElement(qL,null,e?PL:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:s.a.createElement(ee.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));$L.displayName="MlCardDescriptionComponent";const VL=s.a.memo($L);VL.displayName="MlCardDescription";var UL=a(1138);const HL=Object(r.memo)((({describedByIds:e=[],field:t,isUpdateView:a,hasValidLicense:n,isMlAdmin:i})=>{const o=t.value,l=Object(r.useCallback)((e=>{t.setValue(e)}),[t]),c=Object(r.useCallback)((()=>l("eql")),[l]),u=Object(r.useCallback)((()=>l("machine_learning")),[l]),d=Object(r.useCallback)((()=>l("query")),[l]),p=Object(r.useCallback)((()=>l("threshold")),[l]),m=Object(r.useCallback)((()=>l("threat_match")),[l]),f=Object(r.useCallback)((()=>l("new_terms")),[l]),b=Object(r.useCallback)((()=>l("esql")),[l]),g=QR(),y=Object(r.useMemo)((()=>({onClick:c,isSelected:Object(Zh.b)(o)})),[o,c]),h=Object(r.useMemo)((()=>({onClick:d,isSelected:Object(Zh.f)(o)})),[o,d]),v=Object(r.useMemo)((()=>({isDisabled:!n||!i,onClick:u,isSelected:Object(qy.d)(o)})),[o,u,n,i]),E=Object(r.useMemo)((()=>({onClick:p,isSelected:Object(Zh.h)(o)})),[o,p]),x=Object(r.useMemo)((()=>({onClick:m,isSelected:Object(Zh.g)(o)})),[o,m]),j=Object(r.useMemo)((()=>({onClick:f,isSelected:Object(Zh.e)(o)})),[o,f]),S=Object(r.useMemo)((()=>({onClick:b,isSelected:Object(Zh.c)(o)})),[o,b]);return s.a.createElement(ee.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},s.a.createElement(ee.EuiFlexGrid,{columns:3},(!a||h.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"customRuleType",title:_L,titleSize:"xs",description:AL,icon:s.a.createElement(ee.EuiIcon,{size:"xl",type:"search"}),selectable:h,layout:"horizontal"})),(!a||v.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"machineLearningRuleType",title:FL,titleSize:"xs",description:s.a.createElement(VL,{hasValidLicense:n}),icon:s.a.createElement(ee.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:v.isDisabled&&!v.isSelected,selectable:v,layout:"horizontal"})),(!a||E.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"thresholdRuleType",title:DL,titleSize:"xs",description:NL,icon:s.a.createElement(ee.EuiIcon,{size:"l",type:"indexFlush"}),selectable:E,layout:"horizontal"})),(!a||y.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"eqlRuleType",title:TL,titleSize:"xs",description:IL,icon:s.a.createElement(ee.EuiIcon,{size:"l",type:"eql"}),selectable:y,layout:"horizontal"})),(!a||x.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"threatMatchRuleType",title:RL,titleSize:"xs",description:LL,icon:s.a.createElement(ee.EuiIcon,{size:"l",type:"list"}),selectable:x,layout:"horizontal"})),(!a||j.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"newTermsRuleType",title:BL,titleSize:"xs",description:zL,icon:s.a.createElement(ee.EuiIcon,{size:"l",type:"magnifyWithPlus"}),selectable:j,layout:"horizontal"})),g&&(!a||S.isSelected)&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiCard,{"data-test-subj":"esqlRuleType",title:s.a.createElement(UL.a,{label:CL}),titleSize:"xs",description:ML,icon:s.a.createElement(ee.EuiIcon,{type:"logoElasticsearch",size:"l"}),selectable:S,layout:"horizontal"}))))}));HL.displayName="SelectRuleType";const QL=({describedByIds:e=[],field:t})=>{const a=t.value,n=Object(r.useCallback)((e=>{const a=Number(e.currentTarget.value);t.setValue(a)}),[t]);return s.a.createElement(ee.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiRange,{value:a,onChange:n,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25,min:0,max:100}))))};var GL=a(683);const WL=ae.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-1r7zcmv-0"})(["margin-top:10px;"]),ZL=({href:e,notRunningJobIds:t})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:s.a.createElement(ee.EuiLink,{href:e,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&s.a.createElement(WL,{"data-test-subj":"ml-warning-not-running-jobs"},s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement("span",null,1===t.length?s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. We will start {jobName} when you enable this rule.",values:{jobName:t[0]}}):s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. We will start all of these jobs when you enable this rule.",values:{jobNames:t.reduce(((e,t,a,n)=>e+(a<n.length-1?", ":", and ")+t))}}))))),KL=s.a.memo(ZL),JL=Y.i18n.translate("xpack.securitySolution.detectionEngine.mlSelectJob.createCustomJobButtonTitle",{defaultMessage:"Create custom job"}),YL=ae.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-jfjxl-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),XL=ae()(ee.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-jfjxl-1"})(["margin-bottom:5px;"]),eB=ae()(ee.EuiButton).withConfig({displayName:"MlJobEuiButton",componentId:"sc-jfjxl-2"})(["margin-top:20px;"]),tB=({description:e,name:t,id:a})=>s.a.createElement(YL,null,s.a.createElement("strong",null,null!=t?t:a),s.a.createElement(ee.EuiToolTip,{content:e},s.a.createElement(ee.EuiText,{size:"xs",color:"subdued"},s.a.createElement("p",null,e)))),aB=e=>{var t;return s.a.createElement(tB,{id:e.value.id,description:e.value.description,name:null===(t=e.value)||void 0===t?void 0:t.name})},nB=({describedByIds:e=[],field:t})=>{const a=t.value,{isInvalid:n,errorMessage:i}=Object(IP.i)(t),{loading:o,jobs:l}=Object(pA.a)(),{getUrlForApp:c,navigateToApp:u}=Object(h.i)().services.application,d=c("ml"),p=Object(r.useCallback)((e=>{const a=e.map((e=>e.value.id));t.setValue(a)}),[t]),m=l.map((e=>{var t,a;return{value:{id:e.id,description:e.description,name:null===(t=e.customSettings)||void 0===t?void 0:t.security_app_display_name},label:`${null===(a=e.customSettings)||void 0===a?void 0:a.security_app_display_name} ${e.id}`}})),f=m.filter((e=>a.includes(e.value.id))).map((e=>{var t;return{...e,label:null!==(t=e.value.name)&&void 0!==t?t:e.value.id}})),b=Object(r.useMemo)((()=>l.filter((({id:e})=>a.includes(e))).reduce(((e,t)=>(Object(qy.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[l,a]);return s.a.createElement(XL,{justifyContent:"flexStart"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFormRow,{label:t.label,helpText:s.a.createElement(KL,{href:d,notRunningJobIds:b}),isInvalid:n,error:i,"data-test-subj":"mlJobSelect",describedByIds:e},s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiComboBox,{isLoading:o,onChange:p,options:m,placeholder:GL.n,renderOption:aB,rowHeight:50,selectedOptions:f}))))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(eB,{iconType:"popout",iconSide:"right",onClick:()=>u("ml",{openInNewTab:!0})},JL)))};var iB=a(944);const rB=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),sB=ae()(ee.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-1raxjfh-0"})(["align-self:center;"]),oB=["detectionEngineStepDefineRuleThresholdField"],lB=["detectionEngineStepDefineRuleThresholdValue"],cB=["detectionEngineStepDefineRuleThresholdCardinalityField"],uB=["detectionEngineStepDefineRuleThresholdCardinalityValue"],dB=({thresholdField:e,thresholdValue:t,browserFields:a,thresholdCardinalityField:n,thresholdCardinalityValue:i})=>{const o=Object(r.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:rB,onCreateOption:void 0,style:{width:"410px"}})),[a]),l=Object(r.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:rB,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[a]);return s.a.createElement(ee.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(IP.b,{field:e,idAria:oB[0],"data-test-subj":oB[0],describedByIds:oB,type:e.type,euiFieldProps:o})),s.a.createElement(sB,{grow:!1},">="),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(IP.b,{field:t,idAria:lB[0],"data-test-subj":lB[0],describedByIds:lB,type:t.type}))),s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(IP.b,{field:n,idAria:cB[0],"data-test-subj":cB[0],describedByIds:cB,type:n.type,euiFieldProps:l})),s.a.createElement(sB,{grow:!1},">="),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(IP.b,{field:i,idAria:uB[0],"data-test-subj":uB[0],describedByIds:uB,type:i.type}))))},pB=s.a.memo(dB),mB=()=>{const[e,t]=Object(r.useState)(!1),{docLinks:a}=Object(h.i)().services,n=s.a.createElement(ee.EuiButtonIcon,{iconType:"questionInCircle",onClick:()=>t(!e),"aria-label":"Open help popover"});return s.a.createElement(ee.EuiPopover,{button:n,isOpen:e,closePopover:()=>t(!1)},s.a.createElement(ee.EuiText,{style:{width:320},size:"s"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsTooltipContent",defaultMessage:"Choose how to handle events with missing {suppressBy} fields. Either group events with missing fields together, or create a separate alert for each event. {learnMoreLink}",values:{suppressBy:s.a.createElement("strong",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsTooltipSuppressByDescription",defaultMessage:"Suppress alerts by"})),learnMoreLink:s.a.createElement(ee.EuiLink,{href:a.links.siem.configureAlertSuppression,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsTooltipLink",defaultMessage:"Learn more"}))}})))},fB=s.a.memo(mB);fB.displayName="SuppressionInfoIcon";const bB=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlInfoAriaLabel",{defaultMessage:"Open help popover"}),gB=()=>{const{docLinks:e}=Object(h.i)().services,[t,,a,n]=Object(Wh.a)(),i=s.a.createElement(ee.EuiButtonIcon,{iconType:"iInCircle",onClick:n,"aria-label":bB});return s.a.createElement(ee.EuiPopover,{button:i,isOpen:t,closePopover:a},s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlInfoTooltipContent",defaultMessage:"Check out our {createEsqlRuleTypeLink} to get started using ES|QL rules.",values:{createEsqlRuleTypeLink:s.a.createElement(ee.EuiLink,{href:e.links.securitySolution.createEsqlRuleType,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlInfoTooltipLink",defaultMessage:"documentation"}))}})))},yB=s.a.memo(gB);yB.displayName="EsqlInfoIcon";var hB=a(1086),vB=a(1118),EB=a(1423);const xB=Y.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.pickDataView",{defaultMessage:"Select a Data View"}),jB=Y.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundLabel",{defaultMessage:"Selected data view not found"}),SB=Y.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexLabel",{defaultMessage:"Default Security data view"}),OB=Y.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexDescription",{defaultMessage:"The default Security data view includes the alerts index. This could result in redundant alerts being generated from existing alerts."}),kB=({kibanaDataViews:e,field:t})=>{let a,n,i;if(null!=t){const e=Object(IP.i)(t);a=e.isInvalid,n=e.errorMessage,i=t.value}const o=Object(r.useMemo)((()=>null!=e&&Object.keys(e).length>0),[e]),l=Object(r.useMemo)((()=>null!=i&&""!==i&&o&&!Object.hasOwn(e,i)),[o,i,e]),[c,u]=Object(r.useState)(l||null==i||""===i?[]:[{id:e[i].id,label:e[i].title}]),[d,p]=Object(r.useState)(!1);Object(r.useEffect)((()=>{if(!l&&i){const t=e[i].title,a=e[i].id;p("security-solution-default"===a),u([{id:a,label:t}])}else u([])}),[i,t,e,l,p]);const m=Object(r.useMemo)((()=>o?Object.values(e).map((e=>({label:e.title,id:e.id}))):[]),[o,e]);return s.a.createElement(s.a.Fragment,null,l&&null!=i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{title:jB,color:"warning",iconType:"help"},s.a.createElement("p",null,(f=i,Y.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundDescription",{values:{dataView:f},defaultMessage:'Your data view of "id": "{dataView}" was not found. It could be that it has since been deleted.'})))),s.a.createElement(ee.EuiSpacer,{size:"s"})),d&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{title:SB,color:"warning",iconType:"help","data-test-subj":"defaultSecurityDataViewWarning"},s.a.createElement("p",null,OB)),s.a.createElement(ee.EuiSpacer,{size:"s"})),s.a.createElement(ee.EuiFormRow,{label:null==t?void 0:t.label,helpText:null==t?void 0:t.helpText,error:n,isInvalid:a,"data-test-subj":"pick-rule-data-source"},s.a.createElement(ee.EuiComboBox,{isClearable:!0,singleSelection:{asPlainText:!0},onChange:e=>{const a=e;if(u(null!=a?a:[]),null!=a&&a.length>0&&null!=a[0].id){const e=a[0].id;null==t||t.setValue(e)}else null==t||t.setValue(void 0)},options:m,selectedOptions:c,"aria-label":xB,placeholder:xB,"data-test-subj":"detectionsDataViewSelectorDropdown"})));var f};var wB=a(883),TB=a(1128),IB=a(1112);const CB=ae()(ee.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-17p8w56-0"})(["padding-top:20px;text-align:center;"]),MB=ae()(ee.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-17p8w56-1"})(["text-align:center;"]),_B=({entry:e,indexPattern:t,threatIndexPatterns:a,showLabel:n,onChange:i})=>{const o=Object(r.useCallback)((([t])=>{const{updatedEntry:a,index:n}=Object(wB.e)(e,t);i(a,n)}),[i,e]),l=Object(r.useCallback)((([t])=>{const{updatedEntry:a,index:n}=Object(wB.f)(e,t);i(a,n)}),[i,e]),c=Object(r.useMemo)((()=>{const a=s.a.createElement(TB.b,{placeholder:IB.c,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:o,"data-test-subj":"entryField",fieldInputWidth:360});return n?s.a.createElement(ee.EuiFormRow,{label:IB.b,"data-test-subj":"entryItemFieldInputFormRow"},a):s.a.createElement(ee.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},a)}),[o,t,e,n]),u=Object(r.useMemo)((()=>{const t=s.a.createElement(TB.b,{placeholder:IB.c,indexPattern:a,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==a,onChange:l,"data-test-subj":"threatEntryField",fieldInputWidth:360});return n?s.a.createElement(ee.EuiFormRow,{label:IB.f,"data-test-subj":"threatFieldInputFormRow"},t):s.a.createElement(ee.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[l,a,e,n]);return s.a.createElement(ee.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},s.a.createElement(ee.EuiFlexItem,{grow:!1},c),s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},n?s.a.createElement(CB,{grow:!0},IB.d):s.a.createElement(MB,{grow:!0},IB.d))),s.a.createElement(ee.EuiFlexItem,{grow:!1},u))};_B.displayName="EntryItem";const AB=ae()(ee.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-12uv1nj-0"})(["padding-top:20px;"]),FB=s.a.memo((({entries:e,isOnlyItem:t,entryIndex:a,itemIndex:n,onDelete:i})=>{const o=t&&1===e.length&&0===n&&(null==e[0].field||""===e[0].field),l=Object(r.useCallback)((()=>{i(a)}),[i,a]),c=s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:l,isDisabled:o,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===a&&0===n?s.a.createElement(AB,{grow:!1,"data-test-subj":"firstRowDeleteButton"},c):s.a.createElement(ee.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},c)}));FB.displayName="EntryDeleteButton";var PB=a(1084);const DB=ae()(ee.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-80qzis-0"})(["visibility:hidden;"]),NB=ae()(ee.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-80qzis-1"})(["padding-top:20px;"]),RB=s.a.memo((({entriesLength:e,entryItemIndex:t})=>{const a=s.a.createElement(PB.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?s.a.createElement(NB,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},a):e<=1?s.a.createElement(DB,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},a):s.a.createElement(ee.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},a)}));RB.displayName="AndBadge";const LB=ae()(ee.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-1omlazu-0"})(["overflow:hidden;width:100%;"]),BB=s.a.memo((({listItem:e,listItemIndex:t,indexPattern:a,threatIndexPatterns:n,isOnlyItem:i,andLogicIncluded:o,onDeleteEntryItem:l,onChangeEntryItem:c})=>{const u=Object(r.useCallback)(((a,n)=>{const i=[...e.entries.slice(0,n),{...a},...e.entries.slice(n+1)],r={...e,entries:i};c(r,t)}),[c,e,t]),d=Object(r.useCallback)((a=>{const n=Object(wB.i)(e,a);l(n,t)}),[e,l,t]),p=Object(r.useMemo)((()=>null!=a&&e.entries.length>0?Object(wB.g)(a,n,e.entries):[]),[e.entries,a,n]);return s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},o&&s.a.createElement(RB,{entriesLength:e.entries.length,entryItemIndex:t}),s.a.createElement(LB,{grow:6},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",direction:"column"},p.map(((r,o)=>s.a.createElement(ee.EuiFlexItem,{key:r.id,grow:1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},s.a.createElement(LB,{grow:1},s.a.createElement(_B,{entry:r,threatIndexPatterns:n,indexPattern:a,showLabel:0===t&&0===o,onChange:u})),s.a.createElement(FB,{entries:e.entries,isOnlyItem:i,entryIndex:r.entryIndex,itemIndex:t,onDelete:d})))))))))}));BB.displayName="ListItem";const zB=ae()(ee.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-gfoihj-0"})(["min-width:95px;"]),qB=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:a,onOrClicked:n})=>s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zB,{fill:!0,size:"s",iconType:"plusInCircle",onClick:a,"data-test-subj":"andButton",isDisabled:t},IB.a)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(zB,{fill:!0,size:"s",iconType:"plusInCircle",onClick:n,isDisabled:e,"data-test-subj":"orButton"},IB.e))),$B=ae()(ee.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-a20478-0"})(["visibility:hidden;"]),VB=ae()(PB.a).withConfig({displayName:"MyAndBadge",componentId:"sc-a20478-1"})(["& > .euiFlexItem{margin:0;}"]),UB=ae()(ee.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-a20478-2"})(["margin:16px 0;"]),HB={andLogicIncluded:!1,entries:[],entriesToDelete:[]},QB=({listItems:e,indexPatterns:t,threatIndexPatterns:a,onChange:n})=>{const[{entries:i,entriesToDelete:o,andLogicIncluded:l},c]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const a=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:a,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[Object(wB.d)()]}]};default:return e}}),{...HB}),u=Object(r.useCallback)((e=>{c({type:"setEntries",entries:e})}),[c]),d=Object(r.useCallback)((e=>{c({type:"setDefault",initialState:HB,lastEntry:e})}),[c]),p=Object(r.useCallback)(((e,t)=>{const a=[...i.slice(0,t),{...e},...i.slice(t+1)];u(a)}),[u,i]),m=Object(r.useCallback)(((e,t)=>{0===e.entries.length?0===[...i.slice(0,t),...i.slice(t+1)].length?d(e):u([...i.slice(0,t),...i.slice(t+1)]):p(e,t)}),[p,u,i,d]),f=Object(r.useCallback)((()=>{const e=i[i.length-1],{entries:t}=e,a={...e,entries:[...t,Object(wB.d)()]};u([...i.slice(0,i.length-1),{...a}])}),[u,i]),b=Object(r.useCallback)((()=>{const e=Object(wB.h)();u([...i,{...e}])}),[u,i]),g=Object(r.useCallback)((()=>{f()}),[f]);return Object(r.useEffect)((()=>{n({entryItems:Object(wB.c)(i),entriesToDelete:o})}),[n,o,i]),Object(r.useEffect)((()=>{(0===i.length||1===i.length&&null!=i[0].entries&&0===i[0].entries.length)&&b()}),[i,b]),Object(r.useEffect)((()=>{e.length>0&&u(e)}),[]),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",direction:"column"},i.map(((e,n)=>{var r;const o=null!==(r=e.id)&&void 0!==r?r:`${n}`;return s.a.createElement(ee.EuiFlexItem,{grow:1,key:o},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==n&&(l?s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"row"},s.a.createElement($B,{grow:!1},s.a.createElement(VB,{includeAntennas:!0,type:"and"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(VB,{type:"or"})))):s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(VB,{type:"or"}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(BB,{key:o,listItem:e,indexPattern:t,threatIndexPatterns:a,listItemIndex:n,andLogicIncluded:l,isOnlyItem:1===i.length,onDeleteEntryItem:m,onChangeEntryItem:p}))))})),s.a.createElement(UB,{"data-test-subj":"andOrOperatorButtons"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},l&&s.a.createElement($B,{grow:!1},s.a.createElement(PB.a,{includeAntennas:!0,type:"and"})),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(qB,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:b,onAndClicked:g})))))};QB.displayName="ThreatMatch";const GB=Object(IP.j)({component:IP.b}),WB=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:a,indexPatterns:n,threatIndexPatterns:i,threatIndexPatternsLoading:o,threatBrowserFields:l,onValidityChange:c})=>{const{setValue:u,value:d}=a,{isInvalid:p,errorMessage:m}=Object(IP.i)(a),[f,b]=Object(r.useState)(!1);Object(r.useEffect)((()=>{c&&c(!p&&f)}),[f,p,c]);const g=Object(r.useCallback)((({entryItems:e})=>{u(e)}),[u]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(GB,{path:"threatIndex",config:{...hB.a.threatIndex,labelAppend:e?s.a.createElement(Ez,{onClick:t,iconType:"refresh"},GL.p):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(IP.e,{path:"threatQueryBar",config:{...hB.a.threatQueryBar,labelAppend:null},component:wL,componentProps:{browserFields:l,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:i,isDisabled:!1,isLoading:o,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1,onValidityChange:b}}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:m,isInvalid:p,fullWidth:!0},s.a.createElement(QB,{listItems:d,indexPatterns:n,threatIndexPatterns:i,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:g})),s.a.createElement(ee.EuiSpacer,{size:"m"}))},ZB=s.a.memo(WB),KB=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsField.placeholderText",{defaultMessage:"Select a field"}),JB=({browserFields:e,field:t})=>{const a=Object(r.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:KB,onCreateOption:void 0,style:{width:"410px"}})),[e]);return s.a.createElement(IP.b,{field:t,idAria:"detectionEngineStepDefineRuleNewTermsField",euiFieldProps:a})},YB=s.a.memo(JB);var XB=a(27);const ez=[nL.c.defineRule,nL.c.aboutRule,nL.c.scheduleRule,nL.c.ruleActions],tz={anomalyThreshold:50,index:[],indexPattern:{fields:[],title:""},machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:null},threatQueryBar:{query:{query:l.V,language:"kuery"},filters:[],saved_id:null},requiredFields:[],relatedIntegrations:[],threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:VP.b},eqlOptions:{},dataSourceType:nL.a.IndexPatterns,newTermsFields:[],historyWindowSize:"7d",shouldLoadQueryDynamically:!1,groupByFields:[],groupByRadioSelection:nL.b.PerRuleExecution,groupByDuration:{value:5,unit:"m"},suppressionMissingFields:XB.a,enableThresholdSuppression:!1},az={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:Object(Jh.c)([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},investigationFields:[],references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],note:"",threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0},nz={interval:"5m",from:"1m"},iz={interval:"1h",from:"5m"},rz={...tz.queryBar,query:{...tz.queryBar.query,query:"*:*"}},sz={forNormalRules:tz.queryBar,forThreatMatchRules:rz,forEsqlRules:{query:{query:"",language:"esql"},filters:[],saved_id:null}},oz=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.multiSelectFields.placeholderText",{defaultMessage:"Select a field"}),lz=({browserFields:e,disabledText:t,isDisabled:a,field:n,fullWidth:i=!1,dataTestSubj:o})=>{const l=Object(r.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:oz,onCreateOption:void 0,...i?{}:{style:{width:"410px"}},isDisabled:a})),[e,a,i]),c=s.a.createElement(IP.b,{field:n,idAria:"detectionEngineMultiSelectAutocompleteField",euiFieldProps:l,"data-test-subj":o});return a?s.a.createElement(ee.EuiToolTip,{position:"right",content:t},c):c},cz=s.a.memo(lz);var uz=a(247);const dz=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"}),pz=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"}),mz=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"}),fz=(Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.daysOptionDescription",{defaultMessage:"Days"}),ae()(ee.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-tpunic-0"})(["max-width:none;.euiFormControlLayout{max-width:235px;width:auto;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;width:100%;}.euiFormControlLayout__childrenWrapper > select{background-color:",";color:",";}.euiFormControlLayout--group .euiFormControlLayout{min-width:100px;}.euiFormControlLayoutIcons{color:",";}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>Object(ee.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorLightShade))),bz=ae()(ee.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-tpunic-1"})(["width:auto;"]),gz=({durationValueField:e,durationUnitField:t,minimumValue:a=0,isDisabled:n,durationUnitOptions:i=[{value:"s",text:dz},{value:"m",text:pz},{value:"h",text:mz}],...o})=>{const{isInvalid:l,errorMessage:c}=Object(IP.i)(e),{value:u,setValue:d}=e,{value:p,setValue:m}=t,f=Object(r.useCallback)((e=>{m(e.target.value)}),[m]),b=Object(r.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.max(t,Math.min(a,Number.MAX_SAFE_INTEGER))})(e.target.value,a);d(t)}),[a,d]),g={disabled:n,...o};return s.a.createElement(fz,{error:c,isInvalid:l},s.a.createElement(ee.EuiFormControlLayout,{append:s.a.createElement(bz,bo()({fullWidth:!1,options:i,onChange:f,value:p,"data-test-subj":"timeType"},g))},s.a.createElement(ee.EuiFieldNumber,bo()({fullWidth:!1,min:a,max:Number.MAX_SAFE_INTEGER,onChange:b,value:u,"data-test-subj":"interval"},g))))},yz=s.a.memo(gz),hz=Object(IP.j)({component:IP.b}),vz=ae.a.div.withConfig({displayName:"StyledVisibleContainer",componentId:"sc-1pj0rui-0"})(["display:",";"],(e=>e.isVisible?"block":"none")),Ez=ae()(ee.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-1pj0rui-1"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);Ez.defaultProps={flush:"right"};const xz=ae()(ee.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-1pj0rui-2"})([""]),jz=ae()(xz).withConfig({displayName:"IntendedRuleTypeEuiFormRow",componentId:"sc-1pj0rui-3"})(["",""],(({theme:e})=>`padding-left: ${e.eui.euiSizeXL};`)),Sz=({isLoading:e,isUpdateView:t=!1,kibanaDataViews:a,indicesConfig:n,threatIndicesConfig:i,defaultSavedQuery:o,form:l,optionsSelected:c,setOptionsSelected:u,indexPattern:d,isIndexPatternLoading:p,browserFields:m,isQueryBarValid:f,setIsQueryBarValid:b,setIsThreatQueryBarValid:g,ruleType:y,index:h,threatIndex:v,groupByFields:E,dataSourceType:x,shouldLoadQueryDynamically:j,queryBarTitle:S,queryBarSavedId:O,thresholdFields:k,enableThresholdSuppression:w})=>{const T=Object(ju.a)(),[C,M]=Object(r.useState)(!1),[_,A]=Object(r.useState)(!1),[F,P]=Object(r.useState)(!1),D=Object(be.b)(),N=Object(r.useRef)(void 0),R=D.isAtLeast(XB.c),L=Object(Zh.h)(y),B=Object(ge.b)("alert_suppression_rule_form"),{getFields:z,reset:q,setFieldValue:$}=l,V=(({field:e,setFieldValue:t,value:a})=>{const n=Object(r.useRef)(!1),i=Object(r.useRef)(),[s,o]=Object(r.useState)((()=>null));return Object(r.useEffect)((()=>{n.current&&a===i.current&&(n.current=!1,i.current=void 0,s())}),[a,s]),Object(r.useCallback)(((a,r)=>{t(e,a),o((()=>r)),i.current=a,n.current=!0}),[e,t])})({field:"ruleType",value:y,setFieldValue:$}),U=Object(r.useCallback)((({index:e,queryBar:t,eqlOptions:a})=>{const n=()=>{$("index",e),$("queryBar",t)};"eql"===t.query.language?(V("eql",n),u((e=>({...e,...null!=a?a:{}})))):n()}),[$,V,u]),{onOpenTimeline:H,loading:Q}=Object(aL.c)(U),G=tL()(y),W=Object(r.useCallback)((e=>{l.setFieldValue("dataSourceType",e),l.getFields().index.reset({resetValue:!1}),l.getFields().dataViewId.reset({resetValue:!1})}),[l]),[Z,K]=Object(r.useState)([]);Object(r.useEffect)((()=>{const{fields:e}=d;K(function(e){return e.filter((e=>!0===e.aggregatable))}(e))}),[d]);const J=Object(r.useMemo)((()=>Object(vB.b)(Z)),[Z]),[X,{browserFields:te,indexPatterns:ae}]=Object(NT.b)(v);Object(r.useEffect)((()=>{q({resetValues:!1})}),[q,y]),Object(r.useEffect)((()=>{A(!Object(I.isEqual)(h,n))}),[h,n]),Object(r.useEffect)((()=>{P(!Object(I.isEqual)(v,i))}),[v,i]),Object(r.useEffect)((()=>{const{queryBar:e}=z();null!=e&&(Object(Zh.g)(y)&&!Object(Zh.g)(G)&&Object(I.isEqual)(e.value,sz.forNormalRules)?e.reset({defaultValue:sz.forThreatMatchRules}):!Object(Zh.g)(y)&&Object(Zh.g)(G)&&Object(I.isEqual)(e.value,sz.forThreatMatchRules)&&e.reset({defaultValue:sz.forNormalRules}))}),[y,G,z]),Object(r.useEffect)((()=>{const{queryBar:e}=z();if(null==e)return;const t=e.value;var a;if(Object(Zh.c)(y))G&&!Object(Zh.c)(G)&&e.reset({defaultValue:null!==(a=N.current)&&void 0!==a?a:sz.forEsqlRules});else if(Object(Zh.c)(G)){var n;"esql"===(null==t||null===(n=t.query)||void 0===n?void 0:n.language)&&(N.current=t);const a=Object(Zh.g)(y)?sz.forThreatMatchRules:sz.forNormalRules;e.reset({defaultValue:a})}}),[y,G,z]),Object(r.useEffect)((()=>{L&&l.setFieldValue("groupByRadioSelection",nL.b.PerTimePeriod)}),[L,l]);const ne=Object(r.useCallback)((()=>{f||l.setFieldValue("shouldLoadQueryDynamically",!1)}),[f,l]),ie=Object(r.useCallback)((()=>{z().index.setValue(n)}),[z,n]),re=Object(r.useCallback)((()=>{z().threatIndex.setValue(i)}),[z,i]),se=Object(r.useCallback)((()=>{M(!0)}),[]),oe=Object(r.useCallback)((()=>{M(!1)}),[]),le=Object(r.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})=>s.a.createElement(pB,{browserFields:Z,thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})),[Z]),ce=Object(r.useCallback)((({threatMapping:e})=>s.a.createElement(ZB,{handleResetThreatIndices:re,indexPatterns:d,threatBrowserFields:te,threatIndexModified:F,threatIndexPatterns:ae,threatIndexPatternsLoading:X,threatMapping:e,onValidityChange:g})),[re,d,g,te,F,ae,X]),ue=!(!R||L||null!=E&&E.length),de=!R||L,pe=!R||L&&!w,me=!R||!w&&0===(null==E?void 0:E.length),fe=Object(r.useCallback)((({groupByRadioSelection:e,groupByDurationUnit:t,groupByDurationValue:a})=>s.a.createElement(ee.EuiRadioGroup,{disabled:ue,idSelected:e.value,options:[{id:nL.b.PerRuleExecution,label:s.a.createElement(ee.EuiToolTip,{content:L?GL.v:null},s.a.createElement(s.a.Fragment,null," ",GL.d)),disabled:de},{id:nL.b.PerTimePeriod,disabled:pe,label:s.a.createElement(s.a.Fragment,null,GL.e,s.a.createElement(yz,{"data-test-subj":"alertSuppressionDurationInput",durationValueField:a,durationUnitField:t,isDisabled:me||e.value!==nL.b.PerTimePeriod,minimumValue:1}))}],onChange:t=>{e.setValue(t)},"data-test-subj":"groupByDurationOptions"})),[L,me,pe,de,ue]),ye=Object(r.useCallback)((({suppressionMissingFields:e})=>s.a.createElement(ee.EuiRadioGroup,{disabled:!R||!E.length,idSelected:e.value,options:[{id:uz.a.suppress,label:GL.c},{id:uz.a.doNotSuppress,label:GL.a}],onChange:t=>{e.setValue(t)},"data-test-subj":"suppressionMissingFieldsOptions"})),[R,E]),he=Object(r.useMemo)((()=>[{id:nL.a.IndexPatterns,label:Y.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.indexPattern",{defaultMessage:"Index Patterns"}),iconType:x===nL.a.IndexPatterns?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${nL.a.IndexPatterns}`},{id:nL.a.DataView,label:Y.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.dataView",{defaultMessage:"Data View"}),iconType:x===nL.a.DataView?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${nL.a.DataView}`}]),[x]),ve=Object(r.useMemo)((()=>null==a||0===Object.keys(a).length?s.a.createElement(ee.EuiLoadingSpinner,{size:"l"}):s.a.createElement(IP.e,{key:"DataViewSelector",path:"dataViewId",component:kB,componentProps:{kibanaDataViews:a}})),[a]),Ee=Object(r.useMemo)((()=>s.a.createElement(xz,{label:GL.r,$isVisible:!0,fullWidth:!0},s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":"dataViewIndexPatternButtonGroupFlexGroup"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText1",defaultMessage:"Use Kibana "}),s.a.createElement(xs,{guidePath:"kibana",docPath:"data-views.html",linkText:"Data Views"}),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText2",defaultMessage:" or specify individual "}),s.a.createElement(xs,{guidePath:"kibana",docPath:"index-patterns-api-create.html",linkText:"index patterns"}),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText3",defaultMessage:" as your rule's data source to be searched."}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(xz,{$isVisible:!0},s.a.createElement(ee.EuiButtonGroup,{isFullWidth:!0,legend:"Rule index pattern or data view selector","data-test-subj":"dataViewIndexPatternButtonGroup",idSelected:x,onChange:W,options:he,color:"primary"}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(vz,{isVisible:x===nL.a.DataView},ve),s.a.createElement(vz,{isVisible:x===nL.a.IndexPatterns},s.a.createElement(hz,{path:"index",config:{...Object(I.omit)(hB.a.index,"label"),labelAppend:_?s.a.createElement(Ez,{onClick:ie,iconType:"refresh"},GL.p):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:"",isDisabled:Q,isLoading:Q}}})))))),[Q,x,W,he,ve,_,ie]),xe=Object(r.useMemo)((()=>({idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:d,isDisabled:e,isLoading:e,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",onValidityChange:b})),[d,e,b]),je=Object(r.useMemo)((()=>({...hB.a.queryBar,label:GL.i,labelAppend:s.a.createElement(yB,null)})),[]),Se=Object(r.useMemo)((()=>s.a.createElement(IP.e,{key:"QueryBarDefineRule",path:"queryBar",config:je,component:wL,componentProps:{...xe,dataTestSubj:"detectionEngineStepDefineRuleEsqlQueryBar",idAria:"detectionEngineStepDefineRuleEsqlQueryBar"}})),[xe,je]),Oe=Object(r.useMemo)((()=>s.a.createElement(IP.e,{key:"QueryBarDefineRule",path:"queryBar",config:{...hB.a.queryBar,label:GL.o,labelAppend:s.a.createElement(Ez,{"data-test-subj":"importQueryFromSavedTimeline",onClick:se,disabled:j},GL.k)},component:wL,componentProps:{browserFields:m,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:d,isDisabled:e||j||Q,resetToSavedQuery:j,isLoading:p||Q,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:C,onValidityChange:b,onCloseTimelineSearch:oe,onSavedQueryError:ne,defaultSavedQuery:o,onOpenTimeline:H}})),[se,j,m,d,e,Q,p,C,b,oe,ne,o,H]),ke=Object(r.useCallback)(((e,t)=>{u((a=>({...a,[e]:t})))}),[u]),we=Object(r.useMemo)((()=>Object(I.isEmpty)(d.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:d.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:d.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:d.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[d]),Te=Object(r.useMemo)((()=>({describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:t,hasValidLicense:Object(Fh.a)(T),isMlAdmin:Object(Ah.a)(T)})),[t,T]),Ie=Object(Zh.f)(y)||L;return s.a.createElement(s.a.Fragment,null,s.a.createElement(iB.a,{addPadding:!t},s.a.createElement(IP.c,{form:l,"data-test-subj":"stepDefineRule"},s.a.createElement(vz,{isVisible:!1},s.a.createElement(IP.e,{path:"dataSourceType",componentProps:{euiFieldProps:{fullWidth:!0,placeholder:""}}})),s.a.createElement(IP.e,{path:"ruleType",component:HL,componentProps:Te}),s.a.createElement(xz,{$isVisible:!Object(qy.d)(y),fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(vz,{isVisible:!Object(Zh.c)(y)},s.a.createElement(ee.EuiSpacer,{size:"s"}),Ee),s.a.createElement(ee.EuiSpacer,{size:"s"}),Object(Zh.b)(y)?s.a.createElement(IP.e,{key:"EqlQueryBar",path:"queryBar",component:EB.a,componentProps:{optionsData:we,optionsSelected:c,isSizeOptionDisabled:!0,onOptionsChange:ke,onValidityChange:b,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:e,isLoading:p,indexPattern:d,showFilterBar:!0,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...hB.a.queryBar,label:GL.g}}):Object(Zh.c)(y)?Se:Oe)),Object(Zh.f)(y)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(xz,{label:GL.q,$isVisible:Boolean(O),fullWidth:!0},s.a.createElement(hz,{path:"shouldLoadQueryDynamically",componentProps:{idAria:"detectionEngineStepDefineRuleShouldLoadQueryDynamically","data-test-subj":"detectionEngineStepDefineRuleShouldLoadQueryDynamically",euiFieldProps:{disabled:e,label:S?GL.x(S):GL.y()}}}))),s.a.createElement(xz,{$isVisible:Object(qy.d)(y),fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(IP.e,{path:"machineLearningJobId",component:nB,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),s.a.createElement(IP.e,{path:"anomalyThreshold",component:QL,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),s.a.createElement(xz,{$isVisible:L,"data-test-subj":"thresholdInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(IP.f,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},le))),s.a.createElement(xz,{$isVisible:Object(Zh.g)(y),"data-test-subj":"threatMatchInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(IP.f,{fields:{threatMapping:{path:"threatMapping"}}},ce))),s.a.createElement(xz,{$isVisible:Object(Zh.e)(y),"data-test-subj":"newTermsInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(IP.e,{path:"newTermsFields",component:YB,componentProps:{browserFields:J}}),s.a.createElement(IP.e,{path:"historyWindowSize",component:fD,componentProps:{idAria:"detectionEngineStepDefineRuleHistoryWindowSize",dataTestSubj:"detectionEngineStepDefineRuleHistoryWindowSize",timeTypes:["m","h","d"]}}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(xz,{$isVisible:Ie&&L,fullWidth:!0},s.a.createElement(ee.EuiToolTip,{content:B,position:"right"},s.a.createElement(hz,{path:"enableThresholdSuppression",componentProps:{idAria:"detectionEngineStepDefineRuleThresholdEnableSuppression","data-test-subj":"detectionEngineStepDefineRuleThresholdEnableSuppression",euiFieldProps:{label:GL.w(k),disabled:!R}}}))),s.a.createElement(xz,{$isVisible:Ie&&Object(Zh.f)(y),"data-test-subj":"alertSuppressionInput"},s.a.createElement(IP.e,{path:"groupByFields",component:cz,componentProps:{browserFields:J,disabledText:B,isDisabled:!R}})),s.a.createElement(jz,{$isVisible:Ie,"data-test-subj":"alertSuppressionDuration"},s.a.createElement(IP.f,{fields:{groupByRadioSelection:{path:"groupByRadioSelection"},groupByDurationValue:{path:"groupByDuration.value"},groupByDurationUnit:{path:"groupByDuration.unit"}}},fe)),s.a.createElement(jz,{$isVisible:Ie&&Object(Zh.f)(y),"data-test-subj":"alertSuppressionMissingFields",label:s.a.createElement("span",null,GL.b," ",s.a.createElement(fB,null)),fullWidth:!0},s.a.createElement(IP.f,{fields:{suppressionMissingFields:{path:"suppressionMissingFields"}}},ye)),s.a.createElement(IP.e,{path:"timeline",component:WP,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:e,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}}))))},Oz=Object(r.memo)(Sz),kz=({addPadding:e,defaultValues:t,descriptionColumns:a,indexPattern:n})=>{const i=Object(DN.f)(t);return s.a.createElement(iB.a,{"data-test-subj":"definitionRule",addPadding:e},s.a.createElement(gL,{columns:a,schema:Object(DN.b)(hB.a,t.ruleType),data:Object(DN.b)(i,t.ruleType),indexPatterns:n}))},wz=Object(r.memo)(kz),Tz=ae()(ee.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-7izzbw-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),Iz=ae()(ee.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-7izzbw-1"})(["margin:4px 0px;font-size:12px;.euiIcon{width:12px;height:12px;}"]);Iz.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const Cz=({addText:e,dataTestSubj:t,field:a,idAria:n,isDisabled:i,validate:o})=>{const[l,c]=Object(r.useState)(!1),{isInvalid:u,errorMessage:d}=Object(IP.i)(a),[p,m]=Object(r.useState)(-1),f=Object(r.useRef)([]),b=Object(r.useCallback)((e=>{const t=a.value,n=[...t.slice(0,e),...t.slice(e+1)];a.setValue(0===n.length?[""]:n),f.current=[...f.current.slice(0,e),...f.current.slice(e+1)],f.current=f.current.map(((t,a)=>(a>=e&&null!=f.current[e]&&(t.value="re-render"),t)))}),[a]),g=Object(r.useCallback)((()=>{const e=a.value;a.setValue([...e,""])}),[a]),y=Object(r.useCallback)(((e,t)=>{const n=a.value,i=e.target.value;a.setValue([...n.slice(0,t),i,...n.slice(t+1)])}),[a]),h=Object(r.useCallback)(((e,t)=>{null!=t&&(f.current=[...f.current.slice(0,e),t,...f.current.slice(e+1)])}),[f]);Object(r.useEffect)((()=>{-1===p||Object(A.isEmpty)(f.current)||null==f.current[p]||(f.current[p].focus(),m(-1))}),[p,f.current]);const v=a.value;return s.a.createElement(Tz,{label:a.label,labelAppend:a.labelAppend,error:l?d:null,isInvalid:l&&u,fullWidth:!0,"data-test-subj":t,describedByIds:n?[n]:void 0},s.a.createElement(s.a.Fragment,null,v.map(((e,t)=>{const a={disabled:i,...t===v.length-1?{inputRef:h.bind(null,t)}:{},value:e,isInvalid:null!=o&&l&&o(e)};return s.a.createElement("div",{key:t},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiFieldText,bo()({onBlur:()=>c(!0),onChange:e=>y(e,t),fullWidth:!0},a))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:i||Object(A.isEmpty)(e)&&1===v.length,onClick:()=>b(t),"aria-label":Oo.ub}))),v.length-1!==t&&s.a.createElement(ee.EuiSpacer,{size:"s"}))})),s.a.createElement(Iz,{onClick:g,isDisabled:i},e)))},Mz=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],_z=(Object(Jh.c)([]),Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"})),Az=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),Fz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),Pz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),Dz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),Nz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),Rz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),Lz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),Bz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),zz=Y.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),qz=ae.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1wna1kp-0"})(["margin-left:48px;"]),$z=({field:e,idAria:t,isDisabled:n,threatIndex:i,techniqueIndex:o,onFieldChange:l})=>{const c=e.value,[u,d]=Object(r.useState)([]);Object(r.useEffect)((()=>{!async function(){const e=await a.e(20).then(a.bind(null,1695));d(e.subtechniques)}()}),[]);const p=Object(r.useMemo)((()=>{var e;return[...null!==(e=c[i].technique)&&void 0!==e?e:[]]}),[c,i]),m=Object(r.useCallback)((t=>{var a;const n=[...e.value],r=null!==(a=p[o].subtechnique)&&void 0!==a?a:[];null!=r&&(r.splice(t,1),p[o]={...p[o],subtechnique:r},n[i].technique=p,l(n))}),[e,l,o,p,i]),f=Object(r.useCallback)((()=>{const t=[...e.value],a=p[o].subtechnique;p[o]=null!=a?{...p[o],subtechnique:[...a,{id:"none",name:"none",reference:"none"}]}:{...p[o],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[i].technique=p,l(t)}),[e,l,o,p,i]),b=Object(r.useCallback)(((t,a)=>{var n;const r=[...e.value],{id:s,reference:c,name:d}=null!==(n=u.find((e=>e.id===a)))&&void 0!==n?n:{id:"",name:"",reference:""},m=p[o].subtechnique;null!=m&&l([...r.slice(0,i),{...r[i],technique:[...p.slice(0,o),{...p[o],subtechnique:[...m.slice(0,t),{id:s,reference:c,name:d},...m.slice(t+1)]},...p.slice(o+1)]},...r.slice(i+1)])}),[e.value,u,p,o,l,i]),g=Object(r.useCallback)(((t,a,n)=>{const i=u.filter((e=>e.techniqueId===p[o].id));return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===n.name?[{inputDisplay:s.a.createElement(s.a.Fragment,null,zz),value:"none",disabled:a}]:[],...i.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.label),value:e.id,disabled:a})))],prepend:`${e.label} ${Pz}`,"aria-label":"",onChange:b.bind(null,t),fullWidth:!0,valueOfSelected:n.id,"data-test-subj":"mitreAttackSubtechnique",disabled:a,placeholder:zz}))}),[u,e.label,b,p,o]),y=Object(r.useMemo)((()=>p[o].subtechnique),[p,o]);return s.a.createElement(qz,null,null!=y&&y.map(((e,a)=>s.a.createElement("div",{key:a},s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${Pz}`]:void 0},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!0},g(a,n,e)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:n,onClick:()=>m(a),"aria-label":Oo.ub}))))))),s.a.createElement(Iz,{"data-test-subj":"addMitreAttackSubtechnique",onClick:f,isDisabled:n},Rz))},Vz=(e,t)=>e.some((e=>e.techniqueId===t.id)),Uz=ae.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1e8h3t0-0"})(["",""],(({theme:e})=>Object(te.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),Hz=({field:e,idAria:t,isDisabled:n,threatIndex:i,onFieldChange:o})=>{var l;const c=e.value,[u,d]=Object(r.useState)([]),[p,m]=Object(r.useState)([]);Object(r.useEffect)((()=>{!async function(){const e=await a.e(20).then(a.bind(null,1695));d(e.techniques),m(e.subtechniques)}()}),[]);const f=Object(r.useCallback)((t=>{var a;const n=[...e.value],r=null!==(a=n[i].technique)&&void 0!==a?a:[];r.splice(t,1),n[i]={...n[i],technique:r},o(n)}),[e,i,o]),b=Object(r.useCallback)((()=>{var t;const a=[...e.value];a[i]={...a[i],technique:[...null!==(t=a[i].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},o(a)}),[e,i,o]),g=Object(r.useCallback)(((t,a)=>{var n,r;const s=[...e.value],{id:l,reference:c,name:d}=null!==(n=u.find((e=>e.id===a)))&&void 0!==n?n:{id:"",name:"",reference:""},p=null!==(r=s[i].technique)&&void 0!==r?r:[];o([...s.slice(0,i),{...s[i],technique:[...p.slice(0,t),{id:l,reference:c,name:d,subtechnique:[]},...p.slice(t+1)]},...s.slice(i+1)])}),[e.value,u,i,o]),y=Object(r.useCallback)(((t,a,n,i)=>{const r=u.filter((e=>e.tactics.includes(Object(A.kebabCase)(t))));return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===i.name?[{inputDisplay:s.a.createElement(s.a.Fragment,null,Bz),value:"none",disabled:n}]:[],...r.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.label),value:e.id,disabled:n})))],prepend:`${e.label} ${Fz}`,"aria-label":"",onChange:g.bind(null,a),fullWidth:!0,valueOfSelected:i.id,"data-test-subj":"mitreAttackTechnique",disabled:n,placeholder:Bz}))}),[e.label,u,g]),h=null!==(l=c[i].technique)&&void 0!==l?l:[];return s.a.createElement(Uz,null,h.map(((a,r)=>s.a.createElement("div",{key:r},s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${Fz}`]:void 0},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!0},y(c[i].tactic.name,r,n,a)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:n,onClick:()=>f(r),"aria-label":Oo.ub})))),s.a.createElement($z,{field:e,idAria:t,isDisabled:n||"none"===a.name||!1===Vz(p,a),threatIndex:i,techniqueIndex:r,onFieldChange:o})))),s.a.createElement(Iz,{"data-test-subj":"addMitreAttackTechnique",onClick:b,isDisabled:n},Nz))},Qz=ae.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-17z3rkk-0"})(["margin-top:16px;"]),Gz=ae()(ee.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-17z3rkk-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),Wz=Object(r.memo)((({field:e,idAria:t,isDisabled:n})=>{const i=Object(r.useCallback)((t=>{const a=[...e.value];a.splice(t,1),Object(A.isEmpty)(a)?e.setValue(Mz):e.setValue(a)}),[e]),o=Object(r.useCallback)((()=>{const t=[...e.value];Object(A.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),[l,c]=Object(r.useState)([]);Object(r.useEffect)((()=>{!async function(){const e=await a.e(20).then(a.bind(null,1695));c(e.tactics)}()}),[]);const u=Object(r.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:r,name:s}=l.find((e=>e.value===a))||{id:"",name:"",reference:""};n.splice(t,1,{...n[t],tactic:{id:i,reference:r,name:s},technique:[]}),e.setValue([...n])}),[e,l]),d=Object(r.useMemo)((()=>[...e.value]),[e]),p=Object(r.useCallback)(((t,a,r)=>{const o=t.tactic.name;return s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===o?[{inputDisplay:s.a.createElement(s.a.Fragment,null,Lz),value:"none",disabled:r}]:[],...l.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.label),value:e.value,disabled:r})))],prepend:`${e.label} ${Az}`,"aria-label":"",onChange:u.bind(null,a),fullWidth:!0,valueOfSelected:Object(A.camelCase)(o),"data-test-subj":"mitreAttackTactic",placeholder:Lz})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:n||Object(I.isEqual)(d,Mz),onClick:()=>i(a),"aria-label":Oo.ub})))}),[e.label,n,i,l,u,d]),m=Object(r.useCallback)((t=>{e.setValue(t)}),[e]);return s.a.createElement(Qz,null,d.map(((a,i)=>s.a.createElement("div",{key:i},0===i?s.a.createElement(Gz,{fullWidth:!0,label:`${e.label} ${_z}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${Az}`]:void 0},s.a.createElement(s.a.Fragment,null,p(a,i,n))):s.a.createElement(ee.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${Az}`]:void 0},p(a,i,n)),s.a.createElement(Hz,{field:e,threatIndex:i,isDisabled:n||"none"===a.tactic.name,idAria:t,onFieldChange:m})))),s.a.createElement(Iz,{"data-test-subj":"addMitreAttackTactic",onClick:o,isDisabled:n},Dz))}));var Zz=a(1139),Kz=a(1157),Jz=a(463),Yz=a(1503);const Xz=ae.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1dv52ek-0"})(["margin-left:24px;"]),eq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1dv52ek-1"})(["max-width:376px;"]),tq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1dv52ek-2"})(["width:20px;"]),aq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1dv52ek-3"})(["width:80px;"]),nq=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:i,options:o,setRiskScore:l})=>{const{services:c}=Object(h.i)(),{value:u,isMappingChecked:d,mapping:p}=t.value,{setValue:m}=t,f=Object(r.useCallback)(((e,t)=>{m({value:u,isMappingChecked:d,mapping:[...p.slice(0,t),...e,...p.slice(t+1)]})}),[u,d,p,m]),b=Object(r.useCallback)(((e,t,[a])=>{var n;const i=[{...p[e],field:null!==(n=null==a?void 0:a.name)&&void 0!==n?n:"",value:null!=a?p[e].value:"",operator:"equals",severity:t}];f(i,e)}),[p,f]),g=Object(r.useCallback)((e=>{m({value:e,isMappingChecked:d,mapping:p}),l(e)}),[d,p,m,l]),y=Object(r.useCallback)(((e,t,a)=>{const n=[{...p[e],field:p[e].field,value:null!=p[e].field&&""!==p[e].field?a:"",operator:"equals",severity:t}];f(n,e)}),[p,f]),v=Object(r.useCallback)((()=>{m({value:u,mapping:[...p],isMappingChecked:!d})}),[d,p,u,m]),E=Object(r.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,Yz.b)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(ee.EuiText,{size:"xs"},Yz.c))),[]),x=Object(r.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:i?A.noop:v},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiCheckbox,{id:"severity-mapping-override",checked:d,disabled:i,onChange:v})),s.a.createElement(ee.EuiFlexItem,null,Yz.d)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(Xz,null,s.a.createElement(ee.EuiText,{size:"xs"},Yz.e)))),[v,i,d]);return s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},s.a.createElement(ee.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:u,onChange:g,options:o,"data-test-subj":"select"}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFormRow,{label:x,labelAppend:t.labelAppend,helpText:d?s.a.createElement(Xz,null,Yz.f):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:a?[a]:void 0},s.a.createElement(Xz,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),d&&s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(eq,null,s.a.createElement(ee.EuiFormLabel,null,Yz.g)),s.a.createElement(eq,null,s.a.createElement(ee.EuiFormLabel,null,Yz.h)),s.a.createElement(tq,{grow:!1}),s.a.createElement(aq,{grow:!1},s.a.createElement(ee.EuiFormLabel,null,Yz.a)))),p.map(((e,t)=>{var a;return s.a.createElement(ee.EuiFlexItem,{key:`${e.severity}-${t}`},s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},s.a.createElement(eq,null,s.a.createElement(TB.b,{placeholder:"",selectedField:iq(e,n),isLoading:!1,isDisabled:i,isClearable:!1,indexPattern:n,onChange:b.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),s.a.createElement(eq,null,s.a.createElement(TB.a,{autocompleteService:c.unifiedSearch.autocomplete,placeholder:"",selectedField:iq(e,n),selectedValue:e.value,isClearable:!1,isDisabled:i,isLoading:!1,indexPattern:n,onChange:y.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),s.a.createElement(tq,{grow:!1},s.a.createElement(ee.EuiIcon,{type:"sortRight"})),s.a.createElement(aq,{grow:!1},null===(a=o.find((t=>t.value===e.severity)))||void 0===a?void 0:a.inputDisplay)))})))))))},iq=(e,t)=>{const{field:a}=e,[n]=t.fields.filter((({name:e})=>a===e));return null!=n?n:{name:a,type:"string"}};var rq=a(1504);const sq=ae.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1udkauk-0"})(["margin-left:24px;"]),oq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1udkauk-1"})(["max-width:376px;"]),lq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1udkauk-2"})(["width:20px;"]),cq=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1udkauk-3"})(["width:160px;"]),uq=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:i,isActive:o,placeholder:l})=>{const{value:c,isMappingChecked:u,mapping:d}=t.value,{setValue:p}=t,m=Object(r.useMemo)((()=>["number"]),[]),f=Object(r.useMemo)((()=>dq(d,n)),[d,n]),b=Object(r.useCallback)((e=>{const t=e.target.value;p({value:Number(t.trim()),isMappingChecked:u,mapping:d})}),[p,u,d]),g=Object(r.useCallback)((([e])=>{var t;p({value:c,isMappingChecked:u,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[p,c,u]),y=Object(r.useCallback)((()=>{p({value:c,isMappingChecked:!u,mapping:[...d]})}),[p,c,u,d]),h=Object(r.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,rq.a)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(ee.EuiText,{size:"xs"},rq.c))),[]),v=Object(r.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:i?A.noop:y},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiCheckbox,{id:"risk_score-mapping-override",checked:u,disabled:i,onChange:y})),s.a.createElement(ee.EuiFlexItem,null,rq.e)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(sq,null,s.a.createElement(ee.EuiText,{size:"xs"},rq.f)))),[u,y,i]);return s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,null,o&&s.a.createElement(ee.EuiFormRow,{label:h,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:a?[a]:void 0},s.a.createElement(ee.EuiRange,{value:c,onChange:b,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:u?s.a.createElement(sq,null,rq.g):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:a?[a]:void 0},s.a.createElement(sq,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),u&&s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(oq,null,s.a.createElement(ee.EuiFormLabel,null,rq.h)),s.a.createElement(lq,{grow:!1}),s.a.createElement(cq,{grow:!1},s.a.createElement(ee.EuiFormLabel,null,rq.a)))),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(oq,null,s.a.createElement(TB.b,{placeholder:null!=l?l:"",indexPattern:n,selectedField:f,fieldTypeFilter:m,isLoading:!1,isClearable:!1,isDisabled:i,onChange:g,"data-test-subj":e,"aria-label":a})),s.a.createElement(lq,{grow:!1},s.a.createElement(ee.EuiIcon,{type:"sortRight"})),s.a.createElement(cq,{grow:!1},s.a.createElement(ee.EuiText,{size:"s"},rq.d)))))))))},dq=(e,t)=>{var a,n;const i=null!==(a=null==e||null===(n=e[0])||void 0===n?void 0:n.field)&&void 0!==a?a:"",[r]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=r?r:{name:i,type:"number"}},pq=({dataTestSubj:e,field:t,idAria:a,indices:n,isDisabled:i,fieldType:o,placeholder:l})=>{const c=Object(r.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"")}),[t]),u=Object(r.useMemo)((()=>{var e;const a=null!==(e=t.value)&&void 0!==e?e:"",[i]=n.fields.filter((({name:e})=>null!=a&&a===e));return i}),[t.value,n]),d=Object(r.useMemo)((()=>[o]),[o]);return s.a.createElement(ee.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},s.a.createElement(TB.b,{placeholder:null!=l?l:"",indexPattern:n,selectedField:u,fieldTypeFilter:d,isLoading:!1,isDisabled:i,isClearable:!1,onChange:c,"data-test-subj":e,"aria-label":a,fieldInputWidth:500}))};var mq=a(1530),fq=a(1141);const bq={asPlainText:!0},gq=({dataTestSubj:e,field:t,idAria:a,isDisabled:n,fieldType:i,placeholder:o,esqlQuery:l})=>{const c=Object(r.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.label)&&void 0!==a?a:"")}),[t]),{options:u,isLoading:p}=((e,t)=>{const a=Object(d.useKibana)(),{expressions:n}=a.services,i=Object(fq.a)({esqlQuery:e,expressions:n}),{data:s,isLoading:o}=Object(ih.useQuery)(i);return{options:Object(r.useMemo)((()=>((e,t)=>{var a;return e&&"error"in e?[]:(null!==(a=null==e?void 0:e.columns)&&void 0!==a?a:[]).reduce(((e,{id:a,meta:n})=>(t&&t!==n.type||e.push({label:a}),e)),[])})(s,t)),[s,t]),isLoading:o}})(l,i),m=null==t?void 0:t.value,f="string"==typeof m&&m?[{label:m}]:[],b=!("string"!=typeof m||!m||u.some((e=>e.label===m)));return s.a.createElement(ee.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},s.a.createElement(ee.EuiComboBox,{placeholder:null!=o?o:"",options:u,selectedOptions:f,onChange:c,isLoading:p,isDisabled:n||p,isClearable:!1,singleSelection:bq,"data-test-subj":"esqlAutocompleteComboBox",style:{width:"500px"},fullWidth:!0,isInvalid:b}))};gq.displayName="EsqlAutocomplete";const yq=Object(IP.j)({component:IP.b});ae.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1uryycj-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const hq=ae.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1uryycj-1"})(["margin-top:16px;"]);hq.displayName="TagContainer";const vq=({ruleType:e,machineLearningJobId:t,index:a,dataViewId:n,timestampOverride:i,isActive:o=!1,isUpdateView:c=!1,isLoading:u,form:d,esqlQuery:p})=>{const{data:m}=Object(h.i)().services,f=Object(r.useMemo)((()=>Object(Zh.g)(e)),[e]),b=Object(r.useMemo)((()=>Object(Zh.c)(e)),[e]),{ruleIndices:g}=Object(mq.a)(t,a),[y,{indexPatterns:v}]=Object(NT.b)(g),[E,x]=Object(r.useState)(v);Object(r.useEffect)((()=>{null==a||""!==n&&null!=n||x(v)}),[n,a,v]),Object(r.useEffect)((()=>{(async()=>{if(null!=n&&""!==n){const e=await m.dataViews.get(n);x(e)}})()}),[m.dataViews,n,v,x]);const{getFields:j}=d,S=Object(r.useCallback)((e=>{const t=ui.h[e];if(null!=t){const e=j().riskScore;e.setValue({...e.value,value:t})}}),[j]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(iB.a,{addPadding:!c},s.a.createElement(IP.c,{form:d},s.a.createElement(yq,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:u}}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(yq,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:u,compressed:!0,fullWidth:!0}}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(IP.e,{path:"severity",component:nq,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:u||y,options:ui.i,indices:E,setRiskScore:S}})),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(yq,{path:"riskScore",component:uq,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:u||y,isActive:o,indices:E}})),s.a.createElement(hq,null,s.a.createElement(yq,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:u||y,placeholder:""}}})),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:Kz.d},s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(IP.e,{path:"references",component:Cz,componentProps:{addText:Kz.b,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:u,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:_g.c}}),s.a.createElement(IP.e,{path:"falsePositives",component:Cz,componentProps:{addText:Kz.a,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:u,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),s.a.createElement(IP.e,{path:"threat",component:Wz,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:u,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(IP.e,{path:"investigationFields",component:cz,componentProps:{browserFields:E.fields,isDisabled:u||y,fullWidth:!0,dataTestSubj:"detectionEngineStepAboutRuleInvestigationFields"}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(IP.e,{path:"note",component:Jz.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:u,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:Kz.c}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(yq,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:u,placeholder:""}}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(yq,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:u,placeholder:""}}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFormRow,{label:Kz.g,fullWidth:!0},s.a.createElement(yq,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:u}}})),s.a.createElement(ee.EuiFormRow,{label:Kz.e,fullWidth:!0},s.a.createElement(yq,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:u}}})),s.a.createElement(ee.EuiSpacer,{size:"l"}),f&&s.a.createElement(s.a.Fragment,null,s.a.createElement(yq,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:u,placeholder:l.J}}})),s.a.createElement(ee.EuiSpacer,{size:"l"}),b?s.a.createElement(IP.e,{path:"ruleNameOverride",component:gq,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverrideForEsqlRuleType",idAria:"detectionEngineStepAboutRuleRuleNameOverrideForEsqlRuleType",esqlQuery:p,fieldType:"string",isDisabled:u}}):s.a.createElement(IP.e,{path:"ruleNameOverride",component:pq,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:E,isDisabled:u||y,placeholder:""}}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(IP.e,{path:"timestampOverride",component:pq,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:E,isDisabled:u||y,placeholder:""}}),!!i&&"@timestamp"!==i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(yq,{path:"timestampOverrideFallbackDisabled",componentProps:{idAria:"detectionTimestampOverrideFallbackDisabled","data-test-subj":"detectionTimestampOverrideFallbackDisabled",euiFieldProps:{disabled:u}}}))))))},Eq=Object(r.memo)(vq),xq=({addPadding:e,defaultValues:t,descriptionColumns:a})=>s.a.createElement(iB.a,{"data-test-subj":"aboutStep",addPadding:e},s.a.createElement(gL,{columns:a,schema:Zz.a,data:t})),jq=Object(r.memo)(xq);var Sq=a(1119);const Oq=ae()(IP.c).withConfig({displayName:"StyledForm",componentId:"sc-tp8win-0"})(["max-width:235px !important;"]),kq=({isLoading:e,isUpdateView:t=!1,form:a})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(iB.a,{addPadding:!t},s.a.createElement(Oq,{form:a,"data-test-subj":"stepScheduleRule"},s.a.createElement(IP.e,{path:"interval",component:fD,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:e,dataTestSubj:"detectionEngineStepScheduleRuleInterval",minimumValue:1}}),s.a.createElement(IP.e,{path:"from",component:fD,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:e,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}})))),wq=Object(r.memo)(kq),Tq=({addPadding:e,defaultValues:t,descriptionColumns:a})=>s.a.createElement(iB.a,{addPadding:e},s.a.createElement(gL,{columns:a,schema:Sq.a,data:t})),Iq=Object(r.memo)(Tq);var Cq=a(686),Mq=a(169);const _q=(e,t,a)=>{const n=Object(r.useMemo)((()=>{if(!a)return"";const n="string"==typeof e&&Object(Zh.c)(t)?e:void 0;return Object(za.getIndexPatternFromESQLQuery)(n)}),[e,a,t]);return Object(r.useMemo)((()=>Object(Mq.g)(n)),[n])},Aq=({defineStepData:e,activeStep:t})=>Object(r.useMemo)((()=>{if(t===nL.c.aboutRule)return"string"==typeof e.queryBar.query.query&&Object(Zh.c)(e.ruleType)?e.queryBar.query.query:void 0}),[e.queryBar.query.query,e.ruleType,t]),Fq=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),Pq=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesButton",{defaultMessage:"Rules"}),Dq=(Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"})),Nq=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutEnablingTitle",{defaultMessage:"Create rule without enabling it"}),Rq=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithEnablingTitle",{defaultMessage:"Create & enable rule"});var Lq=a(65),Bq=a.n(Lq);Y.i18n.translate("xpack.securitySolution.stepDefineRule.lastHour",{defaultMessage:"Last hour"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.lastDay",{defaultMessage:"Last day"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.lastWeek",{defaultMessage:"Last week"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.lastMonth",{defaultMessage:"Last month"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.quickPreviewToggleButton",{defaultMessage:"Quick query preview"}),Y.i18n.translate("xpack.securitySolution.stepDefineRule.advancedPreviewToggleButton",{defaultMessage:"Advanced query preview"});const zq=Y.i18n.translate("xpack.securitySolution.stepDefineRule.previewTimeoutWarning",{defaultMessage:"Preview timed out after 60 seconds"}),qq=(Y.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.rulePreviewError",{defaultMessage:"Failed to preview rule"})),$q=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Select a preview timeframe"}),Vq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningTitle",{defaultMessage:"Rule preview timeframe might cause timeout"}),Uq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningMessage",{defaultMessage:"The timeframe and rule interval that you selected for previewing this rule might cause timeout or take long time to execute. Try to decrease the timeframe and/or increase the interval if preview has timed out (this won't affect the actual rule run)."}),Hq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),Qq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewTitle",{defaultMessage:"Rule Preview"}),Gq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."}),Wq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"}),Zq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.histogramDisclaimer",{defaultMessage:"Note: Alerts with multiple event.category values will be counted more than once."}),Kq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.mlHistogramDisclaimer",{defaultMessage:"Note: Alerts with multiple host.name values will be counted more than once."}),Jq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllErrors",{defaultMessage:"See all errors"}),Yq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllWarnings",{defaultMessage:"See all warnings"}),Xq=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.actions",{defaultMessage:"Actions"}),e$=Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsAriaLabel",{defaultMessage:"View details"}),t$=({ariaRowindex:e,columnValues:t})=>Y.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),a$=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),n$=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."});var i$=a(765);const r$=({timeframeOptions:e})=>{const t=1e3*(e.timeframeEnd.valueOf()/1e3-e.timeframeStart.valueOf()/1e3),{unit:a,value:n}=Object(DN.g)(e.interval),i=ec.a.duration(n,a),r=i.asMilliseconds(),s=Math.max(Math.ceil(t/r),1),o=e.interval,{unit:l,value:c}=Object(DN.g)(e.lookback);return i.add(c,l),{invocationCount:s,interval:o,from:`now-${i.asSeconds()}s`}},s$={previewId:void 0,logs:[],isAborted:!1},o$=({ruleType:e,isQueryBarValid:t,isThreatQueryBarValid:a,index:n,dataViewId:i,dataSourceType:r,threatIndex:s,threatMapping:o,machineLearningJobId:c,queryBar:u,newTermsFields:d})=>"esql"===e?(({isQueryBarValid:e,queryBar:t})=>!e||Object(I.isEmpty)(t.query.query))({isQueryBarValid:t,queryBar:u}):!t||r===nL.a.DataView&&!i||r===nL.a.IndexPatterns&&0===n.length||("threat_match"===e?(({isThreatQueryBarValid:e,threatIndex:t,threatMapping:a})=>{var n;return!(e&&t.length&&a&&a.length&&null!==(n=a[0].entries)&&void 0!==n&&n.length&&a[0].entries[0].field&&a[0].entries[0].value)})({threatIndex:s,threatMapping:o,isThreatQueryBarValid:a}):"machine_learning"===e?0===c.length:"eql"===e||"query"===e||"threshold"===e?Object(I.isEmpty)(u.query.query)&&Object(I.isEmpty)(u.filters):"new_terms"===e&&(e=>0===e.length||e.length>l.Mb)(d));var l$=a(759);const c$=e=>Object(Xo.a)({...e,asPlainText:!0});var u$=a(961);const d$=ae.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-15ofhu-0"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),p$=ae.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-15ofhu-1"})(["align-items:center;display:flex;"]),m$=({ariaRowindex:e,columnValues:t,onEventDetailsPanelOpened:a})=>s.a.createElement(p$,null,s.a.createElement("div",{key:"expand-event"},s.a.createElement(d$,{textAlign:"center",width:u$.b+10},s.a.createElement(ee.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:e$},s.a.createElement(ee.EuiButtonIcon,{"aria-label":t$({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:a,size:"s"})))));m$.displayName="PreviewActionsComponent";const f$=s.a.memo(m$),b$=Object(Ma.v4)(),g$=Object(Ma.v4)(),y$=(e="event.category",t)=>({title:"Rule preview",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!1,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:b$,accessors:["9c89324b-0c59-4403-9698-d989a09dc5a8"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"eba07b4d-766d-49d7-8435-d40367d3d055",splitAccessor:"e92c8920-0449-4564-81f4-8945517817a4"}],valuesInLegend:!0,yTitle:"",axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{disabled:!1,negate:!1,alias:null,index:g$,key:"kibana.alert.rule.uuid",field:"kibana.alert.rule.uuid",params:{query:null==t?void 0:t.ruleId},type:"phrase"},query:{match_phrase:{"kibana.alert.rule.uuid":null==t?void 0:t.ruleId}}}],datasourceStates:{formBased:{layers:{[b$]:{columns:{"9c89324b-0c59-4403-9698-d989a09dc5a8":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!0}},"eba07b4d-766d-49d7-8435-d40367d3d055":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0,dropPartials:!1}},"e92c8920-0449-4564-81f4-8945517817a4":{label:`Top 10 values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"9c89324b-0c59-4403-9698-d989a09dc5a8"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},include:[],exclude:[],includeIsRegex:!1,excludeIsRegex:!1}}},columnOrder:["e92c8920-0449-4564-81f4-8945517817a4","eba07b4d-766d-49d7-8435-d40367d3d055","9c89324b-0c59-4403-9698-d989a09dc5a8"],sampling:1,incompleteColumns:{}}}},textBased:{layers:{}}},internalReferences:[{type:"index-pattern",id:g$,name:`indexpattern-datasource-layer-${b$}`}],adHocDataViews:{[g$]:{id:g$,title:`.preview.alerts-security.alerts-${null==t?void 0:t.spaceId}`,timeFieldName:"@timestamp",sourceFilters:[],fieldFormats:{},runtimeFieldMap:{},fieldAttrs:{},allowNoIndex:!1,name:`.preview.alerts-security.alerts-${null==t?void 0:t.spaceId}`}}},references:[]}),h$=ae()(ee.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1klu8jb-0"})(["display:block;margin:0 auto;"]),v$=ae.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1klu8jb-1"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),E$=({previewId:e,addNoiseWarning:t,spaceId:a,ruleType:n,indexPattern:i,timeframeOptions:o})=>{const{uiSettings:c}=Object(h.i)().services,{setQuery:u,isInitializing:d}=Object(xe.a)(),p=Object(r.useMemo)((()=>o.timeframeStart.toISOString()),[o]),m=Object(r.useMemo)((()=>o.timeframeEnd.toISOString()),[o]),f=Object(r.useMemo)((()=>o.timeframeEnd.clone().add("1","s").toISOString()),[o]),b=Object(r.useMemo)((()=>"eql"===n),[n]),g=Object(r.useMemo)((()=>"machine_learning"===n),[n]),y=Object(ve.a)("alertsPreviewChartEmbeddablesEnabled"),v=Object(r.useMemo)((()=>({from:p,to:m})),[p,m]),j=Object(r.useMemo)((()=>({ruleId:e,spaceId:a})),[e,a]),[S,{data:O,inspect:k,totalCount:w,refetch:T}]=(({previewId:e,startDate:t,endDate:a,spaceId:n,ruleType:i,indexPattern:s,skip:o})=>{const{uiSettings:c}=Object(h.i)().services,[u,d]=Object(Lo.i)({config:Object(Ro.getEsQueryConfig)(c),indexPattern:s,queries:[{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"}],filters:[]}),p=Object(r.useMemo)((()=>"machine_learning"===i?"host.name":"event.category"),[i]),m=Object(r.useMemo)((()=>({endDate:a,errorMessage:Wq,filterQuery:u,histogramType:rt.k.preview,indexNames:[`${l.Q}-${n}`],stackByField:p,startDate:t,includeMissingData:!1,skip:o||null!=d})),[a,u,n,p,t,o,d]);return Object(l$.a)(m)})({previewId:e,startDate:p,endDate:m,spaceId:a,indexPattern:i,ruleType:n,skip:y}),I=Object(be.b)(),{browserFields:C,runtimeMappings:M}=Object(E.d)(x.SourcererScopeName.detections),{globalFullScreen:_}=Object(Vt.a)(),A=tL()(e),F=`previewHistogram-${e}`;Object(r.useEffect)((()=>{var a;A!==e&&w>0&&(a=o,w/Math.max((a.timeframeEnd.valueOf()-a.timeframeStart.valueOf())/36e5,1)>1&&t())}),[w,t,A,e,o]),Object(r.useEffect)((()=>{S||d||u({id:F,inspect:k,loading:S,refetch:T})}),[u,k,S,d,T,e,y,F]);const P=Object(r.useMemo)((()=>((e,t,a=!1)=>({series:{xScaleType:oi.ScaleType.Time,yScaleType:oi.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(Cb.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:Hq,settings:{legendPosition:oi.Position.Right,showLegend:a,showLegendExtra:a,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}))(m,p,!b)),[m,p,b]),D=Object(r.useMemo)((()=>[{key:"hits",value:O}]),[O]),N=Object(Ro.getEsQueryConfig)(c),R=Object(r.useMemo)((()=>[{...Object(za.buildEsQuery)(i,[{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"}],[],{nestedIgnoreUnmapped:!0,...N,dateFormatTZ:void 0}),meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"kibana.alert.rule.uuid",params:{query:e}}}]),[N,i,e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(su.a,{height:300,"data-test-subj":"preview-histogram-panel"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Li.a,{id:F,title:Qq,titleSize:"xs",showInspectButton:!y})),s.a.createElement(ee.EuiFlexItem,{grow:1},S?s.a.createElement(h$,{size:"l","data-test-subj":"preview-histogram-loading"}):y?s.a.createElement(Dr.a,{applyGlobalQueriesAndFilters:!1,extraOptions:j,getLensAttributes:y$,height:150,id:`${F}-embeddable`,inspectTitle:Qq,scopeId:x.SourcererScopeName.detections,stackByField:"machine_learning"===n?"host.name":"event.category",timerange:v,withActions:!1}):s.a.createElement(zb.a,{configs:P,barChart:D,"data-test-subj":"preview-histogram-bar-chart"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiText,{size:"s",color:"subdued"},s.a.createElement("p",null,g?Kq:Zq)))))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(v$,{$isFullScreen:_},s.a.createElement(rb,{pageFilters:R,defaultModel:Object(Qt.h)(I),end:f,tableId:W.e.rulePreview,leadingControlColumns:(1.5,[{headerCellRender:()=>s.a.createElement(s.a.Fragment,null,Xq),id:"default-timeline-control-column",rowCellRender:f$,width:Object(u$.c)(1.5)}]),renderCellValue:c$,rowRenderers:cb.b,start:p,sourcererScope:x.SourcererScopeName.detections,indexNames:[`${l.Q}-${a}`],bulkActions:!1})),s.a.createElement(L.a,{browserFields:C,isFlyoutView:!0,runtimeMappings:M,scopeId:W.e.rulePreview,isReadOnly:!0}))},x$=s.a.memo(E$);x$.displayName="PreviewHistogram";const j$=({message:e})=>s.a.createElement(ee.EuiCallOut,{color:"warning",iconType:"warning","data-test-subj":"preview-abort"},s.a.createElement(ee.EuiText,null,s.a.createElement("p",null,e))),S$=(e,t,a,n)=>t.length?[{startedAt:e,logs:t,duration:a},...n]:n,O$=({logs:e,hasNoiseWarning:t,isAborted:a})=>{const n=Object(r.useMemo)((()=>e.reduce((({errors:e,warnings:t},a)=>({errors:S$(a.startedAt,a.errors,a.duration,e),warnings:S$(a.startedAt,a.warnings,a.duration,t)})),{errors:[],warnings:[]})),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),null!=t?t:s.a.createElement(j$,{message:Gq}),s.a.createElement(w$,{logs:n.errors,isError:!0}),s.a.createElement(w$,{logs:n.warnings},a?s.a.createElement(j$,{message:zq}):null))},k$=s.a.memo(O$);k$.displayName="PreviewLogs";const w$=({logs:e,isError:t,children:a})=>{const n=e[0];if(!a&&!n)return null;const i=a?e:e.slice(1),r=null!=a?a:s.a.createElement(T$,{logs:n.logs,startedAt:n.startedAt,isError:t,duration:n.duration});return s.a.createElement(s.a.Fragment,null,r,i.length>0?s.a.createElement(ee.EuiAccordion,{id:t?"previewErrorAccordion":"previewWarningAccordion",buttonContent:t?Jq:Yq},i.map(((e,a)=>s.a.createElement(T$,{key:`accordion-log-${a}`,logs:e.logs,startedAt:e.startedAt,duration:e.duration,isError:t})))):null,s.a.createElement(ee.EuiSpacer,{size:"m"}))},T$=({logs:e,startedAt:t,isError:a,duration:n})=>e.length>0?s.a.createElement(s.a.Fragment,null,e.map(((e,i)=>s.a.createElement(r.Fragment,{key:i},s.a.createElement(ee.EuiCallOut,{color:a?"danger":"warning",iconType:"warning","data-test-subj":a?"preview-error":"preview-warning",title:`${t?`[${t}] `:""}[${n}ms]`},s.a.createElement(ee.EuiText,null,s.a.createElement("p",null,e))),s.a.createElement(ee.EuiSpacer,{size:"s"}))))):null,I$=ae()(ee.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-gvlal3-0"})(["display:block;margin:0 auto;"]),C$=()=>s.a.createElement(su.a,{height:300,"data-test-subj":"preview-histogram-panel"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(Li.a,{title:Qq,titleSize:"xs",subtitle:"loading"})),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(I$,{size:"l","data-test-subj":"preview-histogram-loading"})),s.a.createElement(ee.EuiSpacer,null))),M$=[{start:"now/d",end:"now",label:"Today"},{start:"now/w",end:"now",label:"This week"},{start:"now-15m",end:"now",label:"Last 15 minutes"},{start:"now-30m",end:"now",label:"Last 30 minutes"},{start:"now-1h",end:"now",label:"Last 1 hour"},{start:"now-24h",end:"now",label:"Last 24 hours"},{start:"now-7d",end:"now",label:"Last 7 days"},{start:"now-30d",end:"now",label:"Last 30 days"}],_$=(e,t)=>({start:Bq.a.parse(e)||ec()().subtract(1,"hour"),end:Bq.a.parse(t)||ec()()}),A$=({isDisabled:e,defineRuleData:t,aboutRuleData:a,scheduleRuleData:n,exceptionsList:i})=>{const{indexPattern:o,ruleType:l}=t,{spaces:c}=Object(h.i)().services,[u,d]=Object(r.useState)("");Object(r.useEffect)((()=>{c&&c.getActiveSpace().then((e=>d(e.id)))}),[c]);const[p,m]=Object(r.useState)("now-1h"),[f,b]=Object(r.useState)("now"),[g,y]=Object(r.useState)(ec()().subtract(1,"hour")),[v,E]=Object(r.useState)(ec()()),[x,j]=Object(r.useState)(!1);Object(r.useEffect)((()=>{const{start:e,end:t}=_$(p,f);y(e),E(t)}),[p,f]);const[S,O]=Object(r.useState)({timeframeOptions:{timeframeStart:g,timeframeEnd:v,interval:"5m",lookback:"1m"}}),{invocationCount:k}=r$({timeframeOptions:{timeframeStart:g,timeframeEnd:v,interval:n.interval,lookback:n.from}}),w=k>200,{addNoiseWarning:T,createPreview:C,isPreviewRequestInProgress:M,previewId:_,logs:A,hasNoiseWarning:F,isAborted:P}=(({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n,timeframeOptions:i})=>{var s,o;const[l,c]=Object(r.useState)(!1),{isLoading:u,response:d,rule:p,setRule:m}=(({timeframeOptions:e})=>{const[t,a]=Object(r.useState)(null),[n,i]=Object(r.useState)(s$),[s,o]=Object(r.useState)(!1),{addError:l}=Object(Pt.a)(),{invocationCount:c,interval:u,from:d}=r$({timeframeOptions:e}),p=Object(r.useMemo)((()=>e.timeframeEnd.toISOString()),[e]);return Object(r.useEffect)((()=>{t||(i(s$),o(!1))}),[t]),Object(r.useEffect)((()=>{let e=!0;const a=new AbortController;return i(s$),(async()=>{if(null!=t){try{o(!0);const n=await Object(xc.v)({rule:{...Object(i$.b)({...t,interval:u,from:d}),invocationCount:c,timeframeEnd:p},signal:a.signal});e&&i(n)}catch(t){e&&l(t,{title:qq})}e&&o(!1)}})(),()=>{e=!1,a.abort()}}),[t,l,c,d,u,p]),{isLoading:s,response:n,rule:t,setRule:a}})({timeframeOptions:i}),[f,b]=Object(r.useState)(null!==(s=d.logs)&&void 0!==s?s:[]),[g,y]=Object(r.useState)(!!d.isAborted),[h,v]=Object(r.useState)(!1);Object(r.useEffect)((()=>{var e;b(null!==(e=d.logs)&&void 0!==e?e:[]),y(!!d.isAborted)}),[d]);const E=Object(r.useCallback)((()=>{v(!0)}),[v]),x=Object(r.useCallback)((()=>{m(null),b([]),y(!1),c(!1),v(!1)}),[m]);return Object(r.useEffect)((()=>{x()}),[x,e,t,a]),Object(r.useEffect)((()=>{e&&t&&a&&l&&null===p&&m(Object(DN.c)({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n}))}),[l,p,m,e,t,a,n]),{hasNoiseWarning:h,addNoiseWarning:E,createPreview:()=>c(!0),clearPreview:x,isPreviewRequestInProgress:u,previewId:null!==(o=d.previewId)&&void 0!==o?o:"",logs:f,isAborted:g}})({defineRuleData:S.defineRuleData,aboutRuleData:S.aboutRuleData,scheduleRuleData:S.scheduleRuleData,exceptionsList:i,timeframeOptions:S.timeframeOptions}),{startTransaction:D}=Object(Mo.b)(),[N,R]=Object(r.useState)(!1);Object(r.useEffect)((()=>{N&&(C(),R(!1))}),[N,C]),Object(r.useEffect)((()=>{const{start:e,end:t}=_$(p,f);y(e),E(t)}),[f,p]);const L=Object(r.useCallback)((({start:e,end:t,isInvalid:a})=>{j(a),a||(m(e),b(t))}),[]),B=Object(r.useCallback)((()=>{D({name:ah.e.PREVIEW});const{start:e,end:i}=_$(p,f);y(e),E(i),O({defineRuleData:t,aboutRuleData:a,scheduleRuleData:n,timeframeOptions:{timeframeStart:e,timeframeEnd:i,interval:n.interval,lookback:n.from}}),R(!0)}),[a,t,f,n,p,D]),z=Object(r.useMemo)((()=>!(g.isSame(S.timeframeOptions.timeframeStart)&&v.isSame(S.timeframeOptions.timeframeEnd)&&Object(I.isEqual)(t,S.defineRuleData)&&Object(I.isEqual)(a,S.aboutRuleData)&&Object(I.isEqual)(n,S.scheduleRuleData))),[a,t,S.aboutRuleData,S.defineRuleData,S.scheduleRuleData,S.timeframeOptions.timeframeEnd,S.timeframeOptions.timeframeStart,n,v,g]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",null,a$)),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiText,{color:"subdued"},s.a.createElement("p",null,n$)),s.a.createElement(ee.EuiSpacer,{size:"s"}),w&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{color:"warning",title:Vq,"data-test-subj":"previewInvocationCountWarning"},Uq),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":"rule-preview"},s.a.createElement("h4",null,$q)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},s.a.createElement(ee.EuiSuperDatePicker,{start:p,end:f,isDisabled:e,onTimeChange:L,showUpdateButton:!1,commonlyUsedRanges:M$,onRefresh:B,"data-test-subj":"preview-time-frame"}),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiSuperUpdateButton,{isDisabled:x||e,iconType:z?"kqlFunction":"refresh",onClick:B,color:z?"success":"primary",fill:!0,"data-test-subj":"previewSubmitButton"}))),s.a.createElement(ee.EuiSpacer,{size:"l"}),M&&s.a.createElement(C$,null),!M&&_&&u&&s.a.createElement(x$,{ruleType:l,previewId:_,addNoiseWarning:T,spaceId:u,indexPattern:o,timeframeOptions:S.timeframeOptions}),s.a.createElement(k$,{logs:A,hasNoiseWarning:F,isAborted:P}))},F$=s.a.memo(A$),P$=s.a.memo((({onClick:e,isDisabled:t,dataTestSubj:a="nextStep-continue"})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":a},Oo.qb))))));P$.displayName="NextStep";var D$=a(1088);const N$=Y.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),R$=({backOptions:e,isLoading:t,title:a,togglePanel:n,isRulePreviewVisible:i,setIsRulePreviewVisible:r})=>s.a.createElement(oo,{backOptions:e,isLoading:t,title:a},s.a.createElement(ee.EuiButton,{"data-test-subj":"preview-container",isSelected:i,fill:i,iconType:"visBarVerticalStacked",onClick:()=>{null==n||n("preview",{direction:"left"}),r((e=>!e))}},N$)),L$=Object(r.memo)(R$),B$=ae()(ee.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"sc-1d21fri-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}.euiAccordion__childWrapper{transform:none;}"],(e=>e.zindex));B$.displayName="MyEuiPanel";const z$=()=>{const[{loading:e,isSignalIndexExists:t,isAuthenticated:a,hasEncryptionKey:n,canUserCRUD:i}]=Object(kt.b)(),{loading:o,needsConfiguration:c}=zt(),{addSuccess:u}=Object(Pt.a)(),{navigateToApp:d}=Object(h.i)().services.application,{application:p,data:{dataViews:m}}=Object(h.i)().services,f=e||o,[b,g]=Object(r.useState)(nL.c.defineRule),y=e=>ez[ez.indexOf(e)+1],v=Object(r.useRef)(null),E=Object(r.useRef)(null),x=Object(r.useRef)(null),j=Object(r.useRef)(null),[O]=Object(h.o)(l.I),[k]=Object(h.o)(l.U),w=Object(r.useMemo)((()=>({...tz,index:O,threatIndex:k})),[O,k]),T=Object(r.useMemo)((()=>p.getUrlForApp(`${l.l}`,{absolute:!0})),[p]),I=Object(r.useMemo)((()=>({...Cq.c,kibanaSiemAppUrl:T})),[T]),{defineStepForm:C,defineStepData:M,aboutStepForm:A,aboutStepData:F,scheduleStepForm:D,scheduleStepData:N,actionsStepForm:R,actionsStepData:L,eqlOptionsSelected:B,setEqlOptionsSelected:z}=Object(D$.a)({defineStepDefault:w,aboutStepDefault:az,scheduleStepDefault:nz,actionsStepDefault:I}),q=Object(r.useMemo)((()=>Object(Zh.g)(M.ruleType)),[M.ruleType]),$=Object(r.useMemo)((()=>Object(Zh.c)(M.ruleType)),[M.ruleType]),[V,U]=Object(r.useState)({[nL.c.defineRule]:!1,[nL.c.aboutRule]:!1,[nL.c.scheduleRule]:!1,[nL.c.ruleActions]:!1}),{mutateAsync:H,isLoading:Q}=Object(mP.e)(),G=M.ruleType,W=Object(r.useMemo)((()=>Object(Jh.d)(G)),[G]),[Z,K]=Object(r.useState)({}),[J,X]=Object(r.useState)(!0),te=Object(r.useRef)(),[ae,ne]=Object(r.useState)(),[ie,re]=Object(r.useState)(!1),[se,oe]=Object(r.useState)(!1),le=Aq({defineStepData:M,activeStep:b}),ce=_q(M.queryBar.query.query,G,C.isValid),ue=Object(r.useMemo)((()=>$?ce:M.index),[M.index,ce,$]),de=o$({ruleType:G,isQueryBarValid:ie,isThreatQueryBarValid:se,index:ue,dataViewId:M.dataViewId,dataSourceType:M.dataSourceType,threatIndex:M.threatIndex,threatMapping:M.threatMapping,machineLearningJobId:M.machineLearningJobId,queryBar:M.queryBar,newTermsFields:M.newTermsFields});Object(r.useEffect)((()=>{ae!==G&&(A.updateFieldValues({threatIndicatorPath:q?l.J:void 0}),D.updateFieldValues(q?iz:nz),ne(G))}),[A,D,q,ae,G]);const{starting:pe,startMlJobs:me}=KD();Object(r.useEffect)((()=>{(async()=>{const e=(await m.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});K(e)})()}),[m]);const{indexPattern:fe,isIndexPatternLoading:be,browserFields:ge}=Object(D$.b)({dataSourceType:M.dataSourceType,index:ue,dataViewId:M.dataViewId}),ye=Object(we.e)(),he=Object(r.useMemo)((()=>({path:ye,text:Pq,pageId:P.a.rules})),[ye]),ve=Object(r.useCallback)(((e,t)=>U((a=>({...a,[e]:t})))),[]),Ee=Object(r.useCallback)((e=>ve(nL.c.defineRule,e)),[ve]),xe=Object(r.useCallback)((e=>ve(nL.c.aboutRule,e)),[ve]),je=Object(r.useCallback)((e=>ve(nL.c.scheduleRule,e)),[ve]),Se=Object(r.useCallback)((e=>ve(nL.c.ruleActions,e)),[ve]),Oe=Object(r.useCallback)((e=>{ez.indexOf(e)>ez.indexOf(b)&&!V[e]&&ke(e),g(e)}),[b,V]),ke=e=>{var t;if(e===nL.c.defineRule)null===(t=v.current)||void 0===t||t.onToggle();else if(e===nL.c.aboutRule){var a;null===(a=E.current)||void 0===a||a.onToggle()}else if(e===nL.c.scheduleRule){var n;null===(n=x.current)||void 0===n||n.onToggle()}else if(e===nL.c.ruleActions){var i;null===(i=j.current)||void 0===i||i.onToggle()}},Te=Object(r.useCallback)((async e=>{switch(e){case nL.c.defineRule:return C.validate();case nL.c.aboutRule:return A.validate();case nL.c.scheduleRule:return D.validate();case nL.c.ruleActions:return R.validate()}}),[A,R,C,D]),Ie=Object(r.useCallback)((async e=>{await Te(b)&&Oe(e)}),[b,Te,Oe]),Ce=Object(r.useCallback)((async(e,t)=>{if(await Te(e)){const e={...C.getFormData(),eqlOptions:B},n=A.getFormData(),i=D.getFormData(),r=R.getFormData(),s=async()=>{Object(Zh.d)(G)&&t&&await me(e.machineLearningJobId)},[,o]=await Promise.all([s(),H(Object(DN.d)(e,n,i,{...r,enabled:t}))]);u((a=o.name,Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:a},defaultMessage:"{ruleName} was created"}))),d(l.l,{deepLinkId:P.a.rules,path:Object(we.d)(o.id)})}var a}),[Te,C,B,A,D,R,H,u,d,G,me]),Me=b===nL.c.defineRule?"active":C.isValid?"valid":"passive",_e=Object(r.useMemo)((()=>s.a.createElement(XR,{name:"1",title:Oo.sb,type:Me})),[Me]),Ae=Object(r.useCallback)((async()=>{if(await C.validate()){const e=y(nL.c.defineRule);e&&Oe(e)}}),[C,Oe]),Fe=b===nL.c.aboutRule?"active":A.isValid?"valid":"passive",Pe=Object(r.useMemo)((()=>s.a.createElement(XR,{name:"2",title:Oo.b,type:Fe})),[Fe]),De=Object(r.useCallback)((async()=>{if(await A.validate()){const e=y(nL.c.aboutRule);e&&Oe(e)}}),[A,Oe]),Ne=b===nL.c.scheduleRule?"active":D.isValid?"valid":"passive",Re=Object(r.useMemo)((()=>s.a.createElement(XR,{name:"3",title:Oo.Nc,type:Ne})),[Ne]),Le=Object(r.useCallback)((async()=>{if(await D.validate()){const e=y(nL.c.scheduleRule);e&&Oe(e)}}),[D,Oe]),Be=b===nL.c.ruleActions?"active":R.isValid?"valid":"passive",ze=Object(r.useMemo)((()=>s.a.createElement(XR,{name:"4",title:Oo.Gc,type:Be})),[Be]),qe=Object(r.useCallback)((()=>{Ce(nL.c.ruleActions,!1)}),[Ce]),$e=Object(r.useCallback)((()=>{Ce(nL.c.ruleActions,!0)}),[Ce]),Ve=Object(r.useMemo)((()=>b!==nL.c.defineRule&&s.a.createElement(wz,{addPadding:!0,defaultValues:M,descriptionColumns:"singleSplit",indexPattern:fe})),[b,M,fe]),Ue=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{display:b===nL.c.defineRule?void 0:"none"}},s.a.createElement(Oz,{isLoading:Q||f,kibanaDataViews:Z,indicesConfig:O,threatIndicesConfig:k,form:C,optionsSelected:B,setOptionsSelected:z,indexPattern:fe,isIndexPatternLoading:be,browserFields:ge,isQueryBarValid:ie,setIsQueryBarValid:re,setIsThreatQueryBarValid:oe,ruleType:M.ruleType,index:ue,threatIndex:M.threatIndex,groupByFields:M.groupByFields,dataSourceType:M.dataSourceType,shouldLoadQueryDynamically:M.shouldLoadQueryDynamically,queryBarTitle:M.queryBar.title,queryBarSavedId:M.queryBar.saved_id,thresholdFields:M.threshold.field,enableThresholdSuppression:M.enableThresholdSuppression}),s.a.createElement(P$,{dataTestSubj:"define-continue",onClick:Ae,isDisabled:Q})),Ve)),[b,ge,Z,Ae,M.dataSourceType,M.groupByFields,ue,M.queryBar.saved_id,M.queryBar.title,M.ruleType,M.shouldLoadQueryDynamically,M.threatIndex,C,B,fe,O,Q,be,ie,f,Ve,z,k,M.threshold.field,M.enableThresholdSuppression]),He=Object(r.useMemo)((()=>C.isValid&&s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>Ie(nL.c.defineRule)},Dq)),[C.isValid,Ie]),Qe=Object(r.useMemo)((()=>b!==nL.c.aboutRule&&s.a.createElement(jq,{addPadding:!0,defaultValues:F,descriptionColumns:"singleSplit"})),[F,b]),Ge=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{display:b===nL.c.aboutRule?void 0:"none"}},s.a.createElement(Eq,{ruleType:M.ruleType,machineLearningJobId:M.machineLearningJobId,index:ue,dataViewId:M.dataViewId,timestampOverride:F.timestampOverride,isLoading:Q||f,isActive:b===nL.c.aboutRule,form:A,esqlQuery:le}),s.a.createElement(P$,{dataTestSubj:"about-continue",onClick:De,isDisabled:Q})),Qe)),[De,F.timestampOverride,A,b,M.dataViewId,ue,M.machineLearningJobId,M.ruleType,Q,f,Qe,le]),We=Object(r.useMemo)((()=>A.isValid&&s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>Ie(nL.c.aboutRule)},Dq)),[A.isValid,Ie]),Ze=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{display:b===nL.c.scheduleRule?void 0:"none"}},s.a.createElement(wq,{isLoading:Q||f,form:D}),s.a.createElement(P$,{dataTestSubj:"schedule-continue",onClick:Le,isDisabled:Q})),s.a.createElement("div",{style:{display:b===nL.c.scheduleRule?"none":void 0}},s.a.createElement(Iq,{addPadding:!0,descriptionColumns:"singleSplit",defaultValues:N})))),[b,Q,f,Le,N,D]),Ke=Object(r.useMemo)((()=>D.isValid&&s.a.createElement(ee.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>Ie(nL.c.scheduleRule)},Dq)),[Ie,D.isValid]),Je=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{display:b===nL.c.ruleActions?void 0:"none"}},s.a.createElement(Cq.a,{isLoading:Q||f||pe,actionMessageParams:W,summaryActionMessageParams:W,ruleType:G,form:R}),s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!1,isDisabled:Q,isLoading:Q,onClick:qe,"data-test-subj":"create-enabled-false"},Nq)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,isDisabled:Q,isLoading:Q,onClick:$e,"data-test-subj":"create-enable"},Rq)))),s.a.createElement("div",{style:{display:b===nL.c.ruleActions?"none":void 0}},s.a.createElement(Cq.b,{addPadding:!0,defaultValues:L})))),[W,L,R,b,Q,pe,f,G,qe,$e]),Ye=Object(r.useMemo)((()=>R.isValid&&s.a.createElement(ee.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>Ie(nL.c.ruleActions)},Dq)),[R.isValid,Ie]),Xe=Object(r.useCallback)((()=>X((e=>!e))),[]);return Object(Jh.i)(t,a,n,c)?(d(l.l,{deepLinkId:P.a.alerts,path:Object(we.a)()}),null):Object(Vy.c)(i)?s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,null,s.a.createElement(ee.EuiResizableContainer,null,((e,t,{togglePanel:a})=>(te.current=()=>null==a?void 0:a("preview",{direction:"left"}),s.a.createElement(s.a.Fragment,null,s.a.createElement(e,{initialSize:70,minSize:"40%",mode:"main"},s.a.createElement(ee.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},s.a.createElement(Jh.a,null,s.a.createElement(L$,{backOptions:he,isLoading:Q||f,title:Fq,isRulePreviewVisible:J,setIsRulePreviewVisible:X,togglePanel:a}),s.a.createElement(B$,{zindex:4,hasBorder:!0},s.a.createElement($$,{initialIsOpen:!0,id:nL.c.defineRule,buttonContent:_e,paddingSize:"xs",ref:v,onToggle:Ee,extraAction:He},Ue)),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(B$,{hasBorder:!0,zindex:3},s.a.createElement($$,{initialIsOpen:!1,id:nL.c.aboutRule,buttonContent:Pe,paddingSize:"xs",ref:E,onToggle:xe,extraAction:We},Ge)),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(B$,{hasBorder:!0,zindex:2},s.a.createElement($$,{initialIsOpen:!1,id:nL.c.scheduleRule,buttonContent:Re,paddingSize:"xs",ref:x,onToggle:je,extraAction:Ke},Ze)),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(B$,{hasBorder:!0,zindex:1},s.a.createElement($$,{initialIsOpen:!1,id:nL.c.ruleActions,buttonContent:ze,paddingSize:"xs",ref:j,onToggle:Se,extraAction:Ye},Je))))),s.a.createElement(t,null),s.a.createElement(e,{id:"preview",mode:"collapsible",initialSize:30,minSize:"20%",onToggleCollapsed:Xe},s.a.createElement(F$,{isDisabled:de&&b===nL.c.defineRule,defineRuleData:M,aboutRuleData:F,scheduleRuleData:N}))))))),s.a.createElement(_,{pageName:P.a.rulesCreate})):(d(l.l,{deepLinkId:P.a.rules,path:Object(we.e)()}),null)},q$=s.a.memo(z$),$$=Object(r.memo)(ee.EuiAccordion);var V$=a(350);const U$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptTitle",{defaultMessage:"No results match your search criteria"}),H$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptBody",{defaultMessage:"Try modifying your search."}),Q$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addExceptionsEmptyPromptTitle",{defaultMessage:"Add exceptions to this rule"}),G$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptBody",{defaultMessage:"There are no exceptions for this rule. Create your first rule exception."}),W$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptBody",{defaultMessage:"There are no endpoint exceptions. Create your first endpoint exception."}),Z$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptButtonLabel",{defaultMessage:"Add rule exception"}),K$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptButtonLabel",{defaultMessage:"Add endpoint exception"}),J$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"}),Y$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),X$=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),eV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),tV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDeleteErrorTitle",{defaultMessage:"Error deleting exception item"}),aV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.paginationAriaLabel",{defaultMessage:"Exception item table pagination"}),nV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),iV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionEndpointDetailsDescription",{defaultMessage:"Endpoint exceptions are added to both the detection rule and the Elastic Endpoint agent on your hosts."}),rV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDetectionDetailsDescription",{defaultMessage:"Rule exceptions are added to the detection rule."}),sV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.searchPlaceholder",{defaultMessage:'Filter exceptions using simple query syntax, for example, name:"my list"'}),oV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),lV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),cV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.activeDetectionsLabel",{defaultMessage:"Active exceptions"}),uV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.expiredDetectionsLabel",{defaultMessage:"Expired exceptions"}),dV={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},pV=({canAddException:e,isEndpoint:t,isSearching:a,onSearch:n,onAddExceptionClick:i})=>{const o=Object(r.useCallback)((({queryText:e})=>{n({search:e})}),[n]),l=Object(r.useCallback)((()=>{i()}),[i]),c=Object(r.useMemo)((()=>t?oV:lV),[t]);return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(ee.EuiSearchBar,{box:{placeholder:sV,incremental:!0,schema:dV,"data-test-subj":"exceptionsViewerSearchBar"},filters:[],onChange:o})),!e&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:l,isDisabled:a,fill:!0},c)))};pV.displayName="ExceptionsViewerSearchBarComponent";const mV=s.a.memo(pV);mV.displayName="ExceptionsViewerSearchBar";const fV=({pagination:e,onPaginationChange:t})=>{var a;const n=Object(r.useCallback)((a=>{t({pagination:{page:e.pageIndex,perPage:a}})}),[t,e.pageIndex]),i=Object(r.useCallback)((a=>{t({pagination:{page:a,perPage:e.pageSize}})}),[t,e.pageSize]);return s.a.createElement(ee.EuiTablePagination,{"aria-label":aV,pageCount:null!==(a=Math.ceil(e.totalItemCount/e.pageSize))&&void 0!==a?a:0,activePage:e.pageIndex,onChangePage:i,itemsPerPage:e.pageSize,onChangeItemsPerPage:n,itemsPerPageOptions:e.pageSizeOptions,"data-test-subj":"allExceptionItemsPagination"})};fV.displayName="ExceptionsViewerPaginationComponent";const bV=s.a.memo(fV);bV.displayName="ExceptionsViewerPagination";const gV=ae.a.span.withConfig({displayName:"StyledText",componentId:"sc-1co6joy-0"})(["font-weight:bold;"]),yV=ae.a.div.withConfig({displayName:"MyUtilities",componentId:"sc-1co6joy-1"})(["height:50px;"]),hV=ae()(ee.EuiFlexGroup).withConfig({displayName:"StyledBarGroup",componentId:"sc-1co6joy-2"})(["align-items:center;"]),vV=ae()($D.e).withConfig({displayName:"PaginationUtilityBarText",componentId:"sc-1co6joy-3"})(["align-self:center;"]),EV=({pagination:e,lastUpdated:t,exceptionsToShow:a,onChangeExceptionsToShow:n,isEndpoint:i})=>s.a.createElement(yV,null,s.a.createElement($D.a,null,s.a.createElement($D.d,null,s.a.createElement($D.c,null,s.a.createElement(vV,{dataTestSubj:"exceptionsShowing"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:s.a.createElement(gV,null,`${0===e.totalItemCount?"0":"1"}-${Math.min(e.pageSize,e.totalItemCount)}`),partTwo:s.a.createElement(gV,null,`${e.totalItemCount}`)}})))),s.a.createElement($D.d,null,s.a.createElement(hV,null,s.a.createElement($D.e,{dataTestSubj:"lastUpdated"},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"exceptionsViewerLastUpdated"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:s.a.createElement(Yc.b,{value:t})}}))),!i&&s.a.createElement(ee.EuiButtonGroup,{legend:"Displayed exceptions button group",options:[{id:"active",label:cV},{id:"expired",label:uV}],idToSelectedMap:a,onChange:n,type:"multi"})))));EV.displayName="ExceptionsViewerUtilityComponent";const xV=s.a.memo(EV);xV.displayName="ExceptionsViewerUtility";var jV=a(1089);const SV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.editItemButton",{defaultMessage:"Edit rule exception"}),OV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.deleteItemButton",{defaultMessage:"Delete rule exception"}),kV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.editItemButton",{defaultMessage:"Edit endpoint exception"}),wV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.deleteItemButton",{defaultMessage:"Delete endpoint exception"}),TV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.createdLabel",{defaultMessage:"Created"}),IV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.updatedLabel",{defaultMessage:"Updated"}),CV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.expiresLabel",{defaultMessage:"Expires at"}),MV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.expiredLabel",{defaultMessage:"Expired at"}),_V=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.metaDetailsBy",{defaultMessage:"by"}),AV=e=>Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),FV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator",{defaultMessage:"IS"}),PV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),DV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),NV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),RV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.nestedOperator",{defaultMessage:"has"}),LV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator",{defaultMessage:"is one of"}),BV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),zV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator",{defaultMessage:"exists"}),qV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator.not",{defaultMessage:"does not exist"}),$V=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator",{defaultMessage:"included in"}),VV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator.not",{defaultMessage:"is not included in"}),UV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.and",{defaultMessage:"AND"}),HV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.os",{defaultMessage:"OS"}),QV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.windows",{defaultMessage:"Windows"}),GV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.linux",{defaultMessage:"Linux"}),WV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.macos",{defaultMessage:"Mac"}),ZV=Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedList",{defaultMessage:"Affects shared list"}),KV=Object(r.memo)((({item:e,actions:t,disableActions:a=!1,dataTestSubj:n})=>{const[i,o]=Object(r.useState)(!1),l=()=>o(!1),c=Object(r.useMemo)((()=>t.map((e=>s.a.createElement(ee.EuiContextMenuItem,{"data-test-subj":`${n}-actionItem-${e.key}`,key:e.key,icon:e.icon,onClick:()=>{l(),e.onClick()}},e.label)))),[n,t]);return s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":n,justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:9},s.a.createElement(ee.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${n}-title`},s.a.createElement("h3",null,e.name))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiPopover,{button:s.a.createElement(ee.EuiButtonIcon,{isDisabled:a,"aria-label":"Exception item actions menu",iconType:"boxesHorizontal",onClick:()=>o((e=>!e)),"data-test-subj":`${n}-actionButton`}),panelPaddingSize:"none",isOpen:i,closePopover:l,"data-test-subj":`${n}-items`},s.a.createElement(ee.EuiContextMenuPanel,{size:"s",items:c}))))}));KV.displayName="ExceptionItemCardHeader";const JV=ae.a.div.withConfig({displayName:"Container",componentId:"sc-14md3lb-0"})(["display:inline;margin-left:",";"],(({theme:e})=>`${e.eui.euiSizeXS}`)),YV=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:a})=>{const{showSpaceWarningIcon:n,warningText:i}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(TB.d):Object(TB.d)(e)),warningText:t||TB.c.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:a});return n&&e?s.a.createElement(JV,null,s.a.createElement(ee.EuiToolTip,{position:"top",content:i},s.a.createElement(ee.EuiIcon,{"data-test-subj":"value_with_space_warning_tooltip",type:t,color:"warning"}))):null},XV=Object.freeze({linux:GV,mac:WV,macos:WV,windows:QV}),eU=Object.freeze({[uc.d.NESTED]:RV,[uc.d.MATCH_ANY]:LV,[uc.d.MATCH]:FV,[uc.d.WILDCARD]:DV,[uc.d.EXISTS]:zV,[uc.d.LIST]:$V}),tU=Object.freeze({[uc.d.MATCH_ANY]:BV,[uc.d.MATCH]:PV,[uc.d.WILDCARD]:NV,[uc.d.EXISTS]:qV,[uc.d.LIST]:VV}),aU=ae()(ee.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-6hh4xv-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),nU=ae()(ee.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-6hh4xv-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),iU=ae()("span").withConfig({displayName:"StyledCondition",componentId:"sc-6hh4xv-2"})(["margin-right:6px;"]),rU=ae()(ee.EuiPanel).withConfig({displayName:"StyledConditionContent",componentId:"sc-6hh4xv-3"})(["border:1px;border-color:#d3dae6;border-style:solid;"]),sU=Object(r.memo)((({os:e,entries:t,dataTestSubj:a})=>{const n=Object(r.useMemo)((()=>null!=e&&e.length>0?e.map((e=>{var t;return null!==(t=XV[e])&&void 0!==t?t:e})).join(", "):null),[e]),i=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>s.a.createElement(ee.EuiBadge,{color:"hollow"},e))):null!=t?t:"",o=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=eU[e])&&void 0!==a?a:e:null!==(n=tU[e])&&void 0!==n?n:e},l=Object(r.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((e=>{const{field:t,type:n,operator:r}=e,l="value"in e?e.value:"";return s.a.createElement(aU,{"data-test-subj":`${a}-nestedCondition`,key:t+n+l,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},s.a.createElement(nU,{grow:!1},s.a.createElement(ee.EuiToken,{iconType:"tokenNested",size:"s"})),s.a.createElement(nU,{grow:!1},s.a.createElement(ee.EuiExpression,{description:"",value:t,color:"subdued"})),s.a.createElement(nU,{grow:!1},s.a.createElement(ee.EuiExpression,{description:o(n,r),value:i(n,l)})),s.a.createElement(YV,{value:l}))}))}),[a]),c=Object(r.useCallback)((e=>"list"===e.type?e.list.id:"value"in e?e.value:""),[]);return s.a.createElement(rU,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a},null!=n&&s.a.createElement("div",{"data-test-subj":`${a}-os`},s.a.createElement("strong",null,s.a.createElement(ee.EuiExpression,{description:"",value:HV}),s.a.createElement(ee.EuiExpression,{description:FV,value:n}))),t.map(((e,t)=>{const{field:n,type:r}=e,u=c(e),d="entries"in e?e.entries:[],p="operator"in e?e.operator:"";return s.a.createElement("div",{"data-test-subj":`${a}-condition`,key:n+r+u+t},s.a.createElement("div",{className:"eui-xScroll"},s.a.createElement(ee.EuiExpression,{description:0===t?"":s.a.createElement(iU,null,UV),value:n,color:0===t?"primary":"subdued"}),s.a.createElement(ee.EuiExpression,{description:o(r,p),value:i(r,u)}),s.a.createElement(YV,{value:u})),null!=d&&l(r,d))})))}));sU.displayName="ExceptionItemCardConditions";const oU=ae()(ee.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-1vvqq31-0"})(["border-right:1px solid #d3dae6;padding:4px 12px 4px 0;"]),lU=Object(r.memo)((({item:e,listAndReferences:t,dataTestSubj:a})=>{const[n,i]=Object(r.useState)(!1),[o,l]=Object(r.useState)(!1),c=()=>l((e=>!e)),u=()=>i((e=>!e)),d=()=>l(!1),p=()=>i(!1),m=Object(r.useMemo)((()=>!!e.expire_time&&new Date(e.expire_time)<=new Date),[e]),f=Object(r.useMemo)((()=>null==t?[]:t.referenced_rules.map((e=>s.a.createElement(ee.EuiContextMenuItem,{"data-test-subj":`${a}-rulesAffected-${e.id}`,key:e.id},s.a.createElement(ee.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},s.a.createElement(bc.f,{external:!0,referenceId:e.id,referenceName:e.name})))))),[t,a]),b=Object(r.useMemo)((()=>{var e,n;return null==t?s.a.createElement(s.a.Fragment,null):s.a.createElement(oU,{grow:!1},s.a.createElement(ee.EuiPopover,{button:s.a.createElement(ee.EuiButtonEmpty,{onClick:c,iconType:"list","data-test-subj":`${a}-affectedRulesButton`},(n=null!==(e=null==t?void 0:t.referenced_rules.length)&&void 0!==e?e:0,Y.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedRules",{values:{numRules:n},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"}))),panelPaddingSize:"none",isOpen:o,closePopover:d,"data-test-subj":`${a}-rulesPopover`,id:"rulesPopover"},s.a.createElement(ee.EuiContextMenuPanel,{size:"s",items:f})))}),[t,a,o,f]),g=Object(r.useMemo)((()=>null==t?s.a.createElement(s.a.Fragment,null):t.type!==uc.b.RULE_DEFAULT?s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiPopover,{button:s.a.createElement(ee.EuiButtonEmpty,{onClick:u,iconType:"list","data-test-subj":`${a}-affectedListsButton`},ZV),panelPaddingSize:"none",isOpen:n,closePopover:p,"data-test-subj":`${a}-listsPopover`,id:"listsPopover"},s.a.createElement(ee.EuiContextMenuPanel,{size:"s",items:[s.a.createElement(ee.EuiContextMenuItem,{"data-test-subj":`${a}-listsAffected-${t.id}`,key:t.id},s.a.createElement(ee.EuiToolTip,{content:t.name,anchorClassName:"eui-textTruncate"},s.a.createElement(bc.e,{dataTestSubj:"link-to-exception-list",linkTitle:t.name,listId:null==t?void 0:t.list_id,external:!0})))]}))):s.a.createElement(s.a.Fragment,null)),[t,a,n]);return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s","data-test-subj":a},s.a.createElement(oU,{grow:!1},s.a.createElement(cU,{fieldName:"created_by",label:TV,value1:s.a.createElement(Yc.a,{fieldName:"created_at",value:e.created_at}),value2:e.created_by,dataTestSubj:`${a}-createdBy`})),s.a.createElement(oU,{grow:!1},s.a.createElement(cU,{fieldName:"updated_by",label:IV,value1:s.a.createElement(Yc.a,{fieldName:"updated_at",value:e.updated_at}),value2:e.updated_by,dataTestSubj:`${a}-updatedBy`})),null!=e.expire_time&&s.a.createElement(s.a.Fragment,null,s.a.createElement(oU,{grow:!1},s.a.createElement(cU,{fieldName:"expire_time",label:m?MV:CV,value1:s.a.createElement(Yc.a,{fieldName:"expire_time",value:e.expire_time}),dataTestSubj:`${a}-expireTime`}))),null!=t&&s.a.createElement(s.a.Fragment,null,b,g))}));lU.displayName="ExceptionItemCardMetaInfo";const cU=Object(r.memo)((({label:e,value1:t,value2:a,dataTestSubj:n})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"xs",style:{fontFamily:"Inter"}},e)),s.a.createElement(ee.EuiFlexItem,{grow:!1,"data-test-subj":`${n}-value1`},s.a.createElement(ee.EuiBadge,{color:"default",style:{fontFamily:"Inter"}},t)),null!=a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"xs",style:{fontFamily:"Inter"}},_V)),s.a.createElement(ee.EuiFlexItem,{grow:!1,"data-test-subj":`${n}-value2`},s.a.createElement(ee.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center",wrap:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiBadge,{color:"hollow",style:{fontFamily:"Inter"}},a))))))));cU.displayName="MetaInfoDetails";const uU=Object(r.memo)((({comments:e})=>{const{euiTheme:t}=Object(ee.useEuiTheme)();return s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:s.a.createElement(ee.EuiText,{size:"s",style:{color:t.colors.primary}},AV(e.length)),arrowDisplay:"none","data-test-subj":"exceptionsViewerCommentAccordion"},s.a.createElement(ee.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"m"},s.a.createElement(ee.EuiCommentList,{comments:e}))))}));uU.displayName="ExceptionItemCardComments";const dU=({disableActions:e,exceptionItem:t,isEndpoint:a,listAndReferences:n,onDeleteException:i,onEditException:o,dataTestSubj:l})=>{const c=Object(r.useCallback)((()=>{i({id:t.id,name:t.name,namespaceType:t.namespace_type})}),[i,t.id,t.name,t.namespace_type]),u=Object(r.useCallback)((()=>{o(t)}),[o,t]),d=Object(r.useMemo)((()=>Object(jV.j)(t.comments)),[t.comments]);return s.a.createElement(ee.EuiPanel,{paddingSize:"l","data-test-subj":l,hasBorder:!0,hasShadow:!1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m",direction:"column"},s.a.createElement(ee.EuiFlexItem,{"data-test-subj":`${l}-header`},s.a.createElement(KV,{item:t,actions:[{key:"edit",icon:"controlsHorizontal",label:a?kV:SV,onClick:u},{key:"delete",icon:"trash",label:a?wV:OV,onClick:c}],disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),s.a.createElement(ee.EuiFlexItem,{"data-test-subj":`${l}-meta`},s.a.createElement(lU,{item:t,listAndReferences:n,dataTestSubj:"exceptionItemCardMetaInfo"})),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(sU,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions"})),d.length>0&&s.a.createElement(uU,{comments:d})))};dU.displayName="ExceptionItemCardComponent";const pU=s.a.memo(dU);pU.displayName="ExceptionItemCard";var mU=a(1676),fU=a.n(mU);const bU=({isReadOnly:e,isEndpoint:t,currentState:a,onCreateExceptionListItem:n})=>{const{euiTheme:i}=Object(ee.useEuiTheme)(),o=Object(r.useMemo)((()=>{switch(a){case"error":return s.a.createElement(ee.EuiEmptyPrompt,{color:"danger",iconType:"error",title:s.a.createElement("h2",null,J$),body:s.a.createElement("p",null,Y$),"data-test-subj":"exceptionItemViewerEmptyPrompts-error"});case"empty":return s.a.createElement(ee.EuiEmptyPrompt,{color:"subdued",iconType:"plusInCircle",iconColor:i.colors.darkestShade,title:s.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},Q$),body:s.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t?W$:G$),actions:[s.a.createElement(ee.EuiButton,{"data-test-subj":"exceptionsEmptyPromptButton",onClick:n,iconType:"plusInCircle",color:"primary",isDisabled:e,fill:!0},t?K$:Z$)],"data-test-subj":"exceptionItemViewerEmptyPrompts-empty"});case"empty_search":return s.a.createElement(ee.EuiEmptyPrompt,{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:s.a.createElement(ee.EuiImage,{size:"fullWidth",alt:"",url:fU.a}),title:s.a.createElement("h3",null,U$),body:s.a.createElement("p",null,H$),"data-test-subj":"exceptionItemViewerEmptyPrompts-emptySearch"});default:return s.a.createElement(ee.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"})}}),[a,i.colors.darkestShade,e,t,n]);return s.a.createElement(ee.EuiPanel,{hasShadow:!1,hasBorder:!1,color:"empty_search"===a?"subdued":"transparent",style:{margin:`${i.size.l} 0`,padding:`${i.size.l} 0`}},o)},gU=s.a.memo(bU);gU.displayName="ExeptionItemsViewerEmptyPrompts";const yU=ae()(ee.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-1rc5djy-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),hU=({isReadOnly:e,exceptions:t,isEndpoint:a,disableActions:n,ruleReferences:i,viewerState:r,onCreateExceptionListItem:o,onDeleteException:l,onEditExceptionItem:c})=>s.a.createElement(s.a.Fragment,null,null!=r&&"deleting"!==r?s.a.createElement(gU,{isReadOnly:e,isEndpoint:a,currentState:r,onCreateExceptionListItem:o}):s.a.createElement(ee.EuiFlexGroup,{direction:"column",className:"eui-yScrollWithShadows"},s.a.createElement(ee.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},t.map((e=>s.a.createElement(yU,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},s.a.createElement(pU,{disableActions:n,exceptionItem:e,isEndpoint:a,listAndReferences:null!=i?i[e.list_id]:null,onDeleteException:l,onEditException:c,dataTestSubj:"exceptionItemsViewerItem"}))))))));hU.displayName="ExceptionItemsViewerComponent";const vU=s.a.memo(hU);vU.displayName="ExceptionsViewerItems";var EU=a(1420),xU=a(1474);const jU=ae()(ee.EuiText).withConfig({displayName:"StyledText",componentId:"sc-h4xwnx-0"})(["font-style:italic;"]),SU=["error"],OU=["loading","empty_search","empty","error","searching"],kU={pagination:{pageIndex:0,pageSize:25,totalItemCount:0,pageSizeOptions:[5,10,25,50,100,200,300]},exceptions:[],exceptionToEdit:null,currenFlyout:null,viewerState:"loading",isReadOnly:!0,lastUpdated:Date.now(),exceptionsToShow:{active:!0}},wU=({rule:e,listTypes:t,isViewReadOnly:a,onRuleChange:n})=>{const{services:i}=Object(h.i)(),o=Object(h.m)(),[{canUserCRUD:l,hasIndexWrite:c}]=Object(kt.b)(),u=Object(r.useMemo)((()=>null!=e&&null!=e.exceptions_list?e.exceptions_list.filter((({type:e})=>t.includes(e))):[]),[t,e]),d=Object(r.useMemo)((()=>u.map((({id:e,list_id:t,namespace_type:a})=>({id:e,listId:t,namespaceType:a})))),[u]),p=Object(r.useMemo)((()=>1===t.length&&t[0]===uc.b.ENDPOINT),[t]),m=Object(Cc.a)("crudEndpointExceptions"),[{exceptions:f,pagination:b,currenFlyout:g,exceptionToEdit:y,viewerState:v,isReadOnly:E,lastUpdated:x,exceptionsToShow:j},S]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var a;const{exceptions:n,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(a=i.total)&&void 0!==a?a:0},exceptions:n}}case"updateExceptionToEdit":{const{exception:a}=t;return{...e,exceptionToEdit:a}}case"updateFlyoutOpen":return{...e,currenFlyout:t.flyoutType};case"setViewerState":return{...e,viewerState:t.state};case"setIsReadOnly":return{...e,isReadOnly:t.readOnly};case"setLastUpdateTime":return{...e,lastUpdated:t.lastUpdate};case"setExceptionsToShow":{const a={...e.exceptionsToShow,[t.optionId]:!e.exceptionsToShow[t.optionId]};return a.active||a.expired?{...e,exceptionsToShow:a}:{...e,exceptionsToShow:{active:!0}}}default:return e}}),{...kU}),O=Object(r.useCallback)((e=>{S({type:"setLastUpdateTime",lastUpdate:e})}),[S]),k=Object(r.useCallback)((({exceptions:e,pagination:t})=>{O(Date.now()),S({type:"setExceptions",exceptions:e,pagination:t})}),[S,O]),w=Object(r.useCallback)((e=>{S({type:"setViewerState",state:e})}),[S]),T=Object(r.useCallback)((e=>{S({type:"updateFlyoutOpen",flyoutType:e})}),[S]),I=Object(r.useCallback)((e=>{S({type:"setIsReadOnly",readOnly:e})}),[S]),C=Object(r.useCallback)((e=>{S({type:"setExceptionsToShow",optionId:e})}),[S]),[M,_,A,F]=Object(xU.a)();Object(r.useEffect)((()=>{null!=F&&d.length&&F(d)}),[d,F]),Object(r.useEffect)((()=>{_?w("error"):null==v&&M?w("loading"):"loading"!==v||M||w(null)}),[M,_,w,v]);const P=Object(r.useMemo)((()=>u.map((e=>e.namespace_type))),[u]),D=Object(r.useMemo)((()=>{if(p||j.active&&j.expired)return;const e=Object(V$.m)({namespaceType:P});return j.active?Object(V$.d)(e):j.expired?Object(V$.e)(e):void 0}),[j,P,p]),N=Object(r.useCallback)((async e=>{var t;const a=new AbortController,n=null!=(null==e?void 0:e.pagination)?{page:(null!==(t=e.pagination.page)&&void 0!==t?t:0)+1,perPage:e.pagination.perPage}:{page:b.pageIndex+1,perPage:b.pageSize};if(0===u.length)return{data:[],pageIndex:b.pageIndex,itemsPerPage:b.pageSize,total:0};const{page:r,per_page:s,total:o,data:l}=await Object(AF.m)({filter:D,http:i.http,listIds:u.map((e=>e.list_id)),namespaceTypes:P,search:null==e?void 0:e.search,pagination:n,signal:a.signal});return{data:l.map((e=>Object(_t.b)(e))),pageIndex:r,itemsPerPage:s,total:o}}),[b.pageIndex,b.pageSize,u,i.http,D,P]),R=Object(r.useCallback)((async()=>{const e=new AbortController;if(0===u.length)return 0;const{total:t}=await Object(AF.m)({filter:void 0,http:i.http,listIds:u.map((e=>e.list_id)),namespaceTypes:P,pagination:{},signal:e.signal});return t}),[u,P,i.http]),L=Object(r.useCallback)((async e=>{try{const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await N(e);w(n>0?null:"empty"),k({exceptions:i,pagination:{page:t,perPage:a,total:n}}),w(n>0?null:await R()>0?"empty_search":"empty")}catch(e){w("error"),o.addError(e,{title:J$,toastMessage:Y$})}}),[N,k,w,o,R]),B=Object(r.useCallback)((async e=>{try{w("searching");const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await N(e);w(n>0?null:"empty_search"),k({exceptions:i,pagination:{page:t,perPage:a,total:n}})}catch(e){o.addError(e,{title:X$,toastMessage:eV})}}),[N,k,w,o]),z=Object(r.useCallback)((e=>{C(e)}),[C]),q=Object(r.useCallback)((()=>{T("addException")}),[T]),$=Object(r.useCallback)((e=>{S({type:"updateExceptionToEdit",exception:e}),T("editException")}),[T]),V=Object(r.useCallback)((e=>{T(null),e&&null!=n&&n()}),[n,T]),U=Object(r.useCallback)((e=>{T(null),e&&null!=n&&n(),L()}),[T,L,n]),H=Object(r.useCallback)((async({id:e,name:t,namespaceType:a})=>{const n=new AbortController;try{w("deleting"),await Object(AF.e)({http:i.http,id:e,namespaceType:a,signal:n.signal}),o.addSuccess({title:nV,text:(r=t,Y.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessText",{values:{itemName:r},defaultMessage:'"{itemName}" deleted successfully.'}))}),await L()}catch(e){w("error"),o.addError(e,{title:tV})}var r}),[L,i.http,w,o]);Object(r.useEffect)((()=>{I(a||!l||!c)}),[I,a,l,c]),Object(r.useEffect)((()=>{u.length>0?L():w("empty")}),[u.length,L,w]);const Q=Object(r.useMemo)((()=>null!=A&&null!=y?A[y.list_id]:null),[A,y]);return s.a.createElement(s.a.Fragment,null,"editException"===g&&null!=Q&&null!=y&&null!=e&&s.a.createElement(EU.a,{rule:e,list:Q,itemToEdit:y,showAlertCloseOptions:!0,onCancel:V,onConfirm:U,"data-test-subj":"editExceptionItemFlyout"}),"addException"===g&&null!=e&&s.a.createElement(Ic.a,{rules:[e],isBulkAction:!1,isEndpointItem:p,onCancel:V,onConfirm:U,"data-test-subj":"addExceptionItemFlyout",showAlertCloseOptions:!0}),s.a.createElement(ee.EuiPanel,{hasBorder:!1,hasShadow:!1},s.a.createElement(s.a.Fragment,null,s.a.createElement(jU,{size:"s"},p?iV:rV),s.a.createElement(ee.EuiSpacer,{size:"l"}),!SU.includes(v)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(xV,{pagination:b,exceptionsToShow:j,onChangeExceptionsToShow:z,lastUpdated:x,isEndpoint:p}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(mV,{canAddException:E,isEndpoint:p,isSearching:"searching"===v,onSearch:B,onAddExceptionClick:q})),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(vU,{isReadOnly:E,disableActions:E||"deleting"===v||!m,exceptions:f,isEndpoint:p,ruleReferences:A,viewerState:v,onDeleteException:H,onEditExceptionItem:$,onCreateExceptionListItem:q}),!OU.includes(v)&&s.a.createElement(bV,{onPaginationChange:L,pagination:b}))))};wU.displayName="ExceptionsViewerComponent";const TU=s.a.memo(wU);TU.displayName="ExceptionsViewer";const IU=[uc.b.ENDPOINT],CU=Object(r.memo)((({isViewReadOnly:e,onRuleChange:t,rule:a,"data-test-subj":n})=>{const i=Object(ge.a)("ruleDetailsEndpointExceptions");return s.a.createElement(s.a.Fragment,null,i?s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(i,null))):s.a.createElement(TU,{rule:a,listTypes:IU,onRuleChange:t,isViewReadOnly:e,"data-test-subj":n}))}));CU.displayName="EndpointExceptionsViewer";const MU=Y.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),_U=Y.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),AU=Y.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),FU=Y.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.setupGuideLabel",{defaultMessage:"Setup guide"}),PU=Y.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"}),DU=mN.css`
  height: 100%;
`,NU={id:"details",label:MU,"data-test-subj":"stepAboutDetailsToggle-details"},RU={id:"notes",label:AU,"data-test-subj":"stepAboutDetailsToggle-notes"},LU={id:"setup",label:FU,"data-test-subj":"stepAboutDetailsToggle-setup"},BU=({stepData:e,stepDataDetails:t,loading:a,rule:n})=>{const[i,o]=Object(r.useState)("details"),[l,c]=Object(r.useState)(0),u=Object(r.useCallback)((e=>{c(e.height)}),[c]),d=Object(r.useMemo)((()=>{const e=!Object(I.isEmpty)(null==t?void 0:t.note)&&""!==(null==t?void 0:t.note.trim()),a=!Object(I.isEmpty)(null==t?void 0:t.setup)&&""!==(null==t?void 0:t.setup.trim());return[...e||a?[NU]:[],...e?[RU]:[],...a?[LU]:[]]}),[t]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0,className:mN.css`
        position: relative;
      `},a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),s.a.createElement(Li.a,{title:_U})),null!=e&&null!=t&&s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",direction:"column",className:DU},s.a.createElement(ee.EuiFlexItem,{grow:!1,key:"header"},s.a.createElement(Li.a,{title:_U},d.length>0&&s.a.createElement(ee.EuiButtonGroup,{options:d,idSelected:i,onChange:e=>{o(e)},"data-test-subj":"stepAboutDetailsToggle",legend:PU}))),s.a.createElement(ee.EuiFlexItem,{key:"details"},"details"===i&&s.a.createElement(ee.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:u},(e=>s.a.createElement("div",{ref:e,className:DU},s.a.createElement(qU,{maxHeight:120},s.a.createElement($U,{maxHeight:120},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(fN.b,{rule:n,hideName:!0,hideDescription:!0})))),"notes"===i&&s.a.createElement(qU,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:l},s.a.createElement($U,{maxHeight:l},s.a.createElement(yN.b,null,t.note))),"setup"===i&&s.a.createElement(qU,{"data-test-subj":"stepAboutDetailsSetupContent",maxHeight:l},s.a.createElement($U,{maxHeight:l},s.a.createElement(yN.b,null,t.setup))))))},zU=Object(r.memo)(BU);function qU({maxHeight:e,"data-test-subj":t,children:a}){return s.a.createElement("div",{className:mN.css`
        max-height: ${e}px;
        overflow-y: hidden;
        word-break: break-word;
      `,"data-test-subj":t},a)}function $U({maxHeight:e,children:t}){return s.a.createElement("div",{className:`eui-yScroll ${mN.css`
        max-height: ${e}px;
      `}`},t)}const VU=ae()(ee.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-j93jp7-0"})(["position:relative;"]);VU.displayName="MyPanel";const UU=({children:e,loading:t,title:a})=>s.a.createElement(VU,{hasBorder:!0},t&&s.a.createElement(ee.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"stepPanelProgress"}),a&&s.a.createElement(Li.a,{title:a}),e),HU=Object(r.memo)(UU);var QU=a(1136);const GU=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),WU=ae()(ee.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-1ut3lkn-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),ZU=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:a,showBulkDuplicateExceptionsConfirmation:n,confirmDeletion:i})=>{const[o,,c,u]=Object(Wh.a)(),{navigateToApp:d}=Object(h.i)().services.application,{startTransaction:p}=Object(Mo.b)(),{executeBulkAction:m}=xh({suppressSuccessToast:!0}),{bulkExport:f}=Lh(),b=qh(),g=Object(r.useCallback)((()=>{d(l.l,{deepLinkId:l.yc.rules,path:Object(we.e)()})}),[d]),y=Object(r.useMemo)((()=>null!=e?[s.a.createElement(ee.EuiContextMenuItem,{key:Oo.Ab,icon:"copy",disabled:!a||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{p({name:ah.e.DUPLICATE}),c();const t=await n();if(null===t)return;const a=await m({type:th.b.duplicate,ids:[e.id],duplicatePayload:{include_exceptions:t===Dh.withExceptions||t===Dh.withExceptionsExcludeExpiredExceptions,include_expired_exceptions:!(t===Dh.withExceptionsExcludeExpiredExceptions)}}),i=null==a?void 0:a.attributes.results.created;null!=i&&i.length&&Eh(i[0].id,d)}},s.a.createElement(ee.EuiToolTip,{position:"left",content:Object(Vy.a)(e,a)?void 0:Oo.Qb},s.a.createElement(s.a.Fragment,null,Oo.Ab))),s.a.createElement(ee.EuiContextMenuItem,{key:Oo.Hb,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{p({name:ah.e.EXPORT}),c();const t=await f({ids:[e.id]});t&&await b(t)}},Oo.Hb),s.a.createElement(ee.EuiContextMenuItem,{key:Oo.xb,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{c(),!1!==await i()&&(p({name:ah.e.DELETE}),await m({type:th.b.delete,ids:[e.id]}),g())}},Oo.xb)]:[]),[f,a,c,m,d,g,e,n,p,t,b,i]),v=Object(r.useMemo)((()=>s.a.createElement(ee.EuiToolTip,{position:"top",content:GU},s.a.createElement(WU,{iconType:"boxesHorizontal","aria-label":GU,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:u}))),[u,t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiPopover,{anchorPosition:"leftCenter",button:v,closePopover:c,id:"ruleActionsOverflow",isOpen:o,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},s.a.createElement(ee.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:y})))},KU=s.a.memo(ZU);KU.displayName="RuleActionsOverflow";var JU=a(1127);const YU=1e3;var XU=a(67);a(1677);var eH=a(579);const tH=Object(r.createContext)(null),aH=({children:e})=>{var t;const{storage:a}=Object(h.i)().services,[n,i]=Object(r.useState)([]),[o,c]=Object(r.useState)(1e3),[u,d]=Object(r.useState)(!0),[p,m]=Object(r.useState)("now-24h"),[f,b]=Object(r.useState)("now"),[g,y]=Object(r.useState)(""),[v,E]=Object(r.useState)([]),[x,j]=Object(r.useState)(null!==(t=a.get(l.qc))&&void 0!==t&&t),[S,O]=Object(r.useState)(1),[k,w]=Object(r.useState)(5),[T,I]=Object(r.useState)("timestamp"),[C,M]=Object(r.useState)("desc"),_=Object(r.useMemo)((()=>({[wh.b.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:n,refreshInterval:o,isPaused:u,start:p,end:f},queryText:g,statusFilters:v,showMetricColumns:x,pagination:{pageIndex:S,pageSize:k},sort:{sortField:T,sortDirection:C}},actions:{setEnd:b,setIsPaused:d,setPageIndex:O,setPageSize:w,setQueryText:y,setRecentlyUsedRanges:i,setRefreshInterval:c,setShowMetricColumns:j,setSortDirection:M,setSortField:I,setStart:m,setStatusFilters:E}}})),[f,u,S,k,g,n,o,x,C,T,p,v]);return s.a.createElement(tH.Provider,{value:_},e)};var nH=a(1477),iH=a(1476);const rH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableTitle",{defaultMessage:"Execution log"}),sH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableSubtitle",{defaultMessage:"A log of rule execution results"}),oH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchPlaceholder",{defaultMessage:"duration > 100 and gapDuration > 10"}),lH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.showMetricColumnsSwitchTitle",{defaultMessage:"Show metrics columns"}),cH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumn",{defaultMessage:"Status"}),uH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumnTooltip",{defaultMessage:"Overall status of execution."}),dH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumn",{defaultMessage:"Timestamp"}),pH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumnTooltip",{defaultMessage:"Datetime rule execution initiated."}),mH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumn",{defaultMessage:"Duration"}),fH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumnTooltip",{defaultMessage:"The length of time it took for the rule to run (hh:mm:ss:SSS)."}),bH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumn",{defaultMessage:"Message"}),gH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumnTooltip",{defaultMessage:"Relevant message from execution outcome."}),yH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumn",{defaultMessage:"Gap Duration"}),hH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),vH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumn",{defaultMessage:"Index Duration"}),EH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumnTooltip",{defaultMessage:"The length of time it took to index detected alerts (hh:mm:ss:SSS)."}),xH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumn",{defaultMessage:"Search Duration"}),jH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumnTooltip",{defaultMessage:"The length of time it took to search for alerts (hh:mm:ss:SSS)."}),SH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumn",{defaultMessage:"Scheduling Delay"}),OH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumnTooltip",{defaultMessage:"The length of time from rule scheduled till rule executed (hh:mm:ss:SSS)."}),kH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumn",{defaultMessage:"Actions"}),wH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumnTooltip",{defaultMessage:"Filter alerts by rule execution ID."}),TH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedTitle",{defaultMessage:"Global search filters have been updated"}),IH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedDescription",{defaultMessage:"Search filters have been updated to show alerts from selected rule execution"}),CH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedRestoreButtonTitle",{defaultMessage:"Restore previous filters"}),MH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorTitle",{defaultMessage:"Unable to filter alerts"}),_H=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorDescription",{defaultMessage:"Cannot find field 'kibana.alert.rule.execution.uuid' in alerts index."}),AH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationNotAvailableDescription",{defaultMessage:"N/A"}),FH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationGreaterThanYearDescription",{defaultMessage:"> 1 Year"}),PH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.fullMessage",{defaultMessage:"Full message"}),DH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.expandRow",{defaultMessage:"Expand rows"}),NH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.expand",{defaultMessage:"Expand"}),RH=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.collapse",{defaultMessage:"Collapse"}),LH=e=>{const{duration:t,isSeconds:a=!1,allowZero:n=!0}=e,i=Object(r.useMemo)((()=>n&&t>=0?(e=>{if(!e)return"00:00:00:000";const t=ec.a.duration(e),a=Math.floor(t.asDays()).toString().padStart(3,"0"),n=Math.floor(t.asHours()%24).toString().padStart(2,"0"),i=Math.floor(t.asMinutes()%60).toString().padStart(2,"0"),r=t.seconds().toString().padStart(2,"0"),s=t.milliseconds().toString().padStart(3,"0");return Math.floor(t.asDays())>0?Math.floor(t.asDays())>=365?FH:`${a}:${n}:${i}:${r}:${s}`:`${n}:${i}:${r}:${s}`})(a?1e3*t:t):AH),[n,t,a]);return s.a.createElement("span",{"data-test-subj":"rule-duration-format-value"},i)},BH=s.a.memo(LH);BH.displayName="RuleDurationFormat";const zH=[{name:s.a.createElement(Mh,{title:cH,tooltipContent:uH}),field:"security_status",render:e=>s.a.createElement(JU.c,{status:e,showTooltip:!0}),sortable:!1,truncateText:!1,width:"10%"},{field:"timestamp",name:s.a.createElement(Mh,{title:dH,tooltipContent:pH}),render:e=>s.a.createElement(Yc.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"15%"},{field:"duration_ms",name:s.a.createElement(Mh,{title:mH,tooltipContent:fH}),render:e=>s.a.createElement(s.a.Fragment,null,e?s.a.createElement(BH,{duration:e}):Object(Jc.e)()),sortable:!0,truncateText:!1,width:"10%"}],qH=e=>({field:"security_message",name:s.a.createElement(Mh,{title:bH,tooltipContent:gH}),render:(e,t)=>"succeeded"===t.security_status?e:s.a.createElement($H,null,e),sortable:!1,width:e});var $H=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-okzjc9-0"})(["display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"]);const VH={status:"kibana.alert.rule.execution.status",timestamp:"@timestamp",duration:"event.duration",message:"message",gapDuration:"kibana.alert.rule.execution.metrics.execution_gap_duration_s",indexDuration:"kibana.alert.rule.execution.metrics.total_indexing_duration_ms",searchDuration:"kibana.alert.rule.execution.metrics.total_search_duration_ms",totalActions:"kibana.alert.rule.execution.metrics.number_of_triggered_actions",schedulingDelay:"kibana.task.schedule_delay"},UH=[$h.g.succeeded,$h.g.failed,$h.g["partial failure"]],HH=s.a.memo((({onlyShowFilters:e,selectedStatuses:t,onStatusFilterChange:a,onSearch:n})=>{const i=Object(r.useCallback)((e=>{n((e=>Object.entries(VH).reduce(((e,[t,a])=>Object(I.replace)(e,t,a)),e))(e))}),[n]);return s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!0},!e&&s.a.createElement(ee.EuiFieldSearch,{"data-test-subj":"executionLogSearch","aria-label":oH,placeholder:oH,onSearch:i,isClearable:!0,fullWidth:!0})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(JU.b,{items:UH,selectedItems:t,onChange:a})))}));HH.displayName="ExecutionLogSearchBar";const QH="kibana.alert.rule.execution.uuid",GH=ae()(ee.EuiSwitch).withConfig({displayName:"UtilitySwitch",componentId:"sc-z5yvfc-0"})(["margin-left:17px;"]),WH=ae()(ee.EuiFlexItem).withConfig({displayName:"DatePickerEuiFlexItem",componentId:"sc-z5yvfc-1"})(["max-width:582px;"]),ZH=({ruleId:e,selectAlertsTab:t})=>{var a,n;const{docLinks:i,data:{query:{filterManager:o}},storage:u,timelines:d}=Object(h.i)().services,{[wh.b.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:p,refreshInterval:m,isPaused:f,start:b,end:g},queryText:y,statusFilters:v,showMetricColumns:j,pagination:{pageIndex:S,pageSize:O},sort:{sortField:k,sortDirection:w}},actions:{setEnd:T,setIsPaused:I,setPageIndex:C,setPageSize:M,setQueryText:_,setRecentlyUsedRanges:A,setRefreshInterval:P,setShowMetricColumns:D,setSortDirection:N,setSortField:R,setStart:L,setStatusFilters:B}}}=(()=>{const e=Object(r.useContext)(tH);return Object(iN.a)(e,"useRuleDetailsContext should be used inside RuleDetailsContextProvider"),e})(),{indexPattern:z}=Object(E.d)(x.SourcererScopeName.detections),{addError:q,addSuccess:$,remove:V}=Object(Pt.a)(),U=Object(c.useDispatch)(),H=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),Q=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),G=Object(F.a)(mt.d.globalTimeRangeSelector),W=Object(F.a)(Q),Z=Object(F.a)(H),K=Object(r.useRef)({filters:Z,query:W,timerange:G}),J=Object(r.useRef)(""),X=Object(r.useCallback)((()=>{Object(eH.a)(K.current.timerange)?U(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:K.current.timerange.from,to:K.current.timerange.to})):Object(eH.b)(K.current.timerange)&&U(Object(vt.setRelativeRangeDatePicker)({id:Ee.a.global,from:K.current.timerange.from,fromStr:K.current.timerange.fromStr,to:K.current.timerange.to,toStr:K.current.timerange.toStr})),U(Object(vt.setFilterQuery)({id:Ee.a.global,query:K.current.query.query,language:K.current.query.language})),o.removeAll(),o.addFilters(K.current.filters),V(J.current)}),[U,o,V]),{data:te,dataUpdatedAt:ae,isFetching:ne,isLoading:ie,refetch:re}=Object(JU.d)({ruleId:e,start:b,end:g,queryText:y,statusFilters:v,page:S,perPage:O,sortField:k,sortOrder:w}),se=null!==(a=null==te?void 0:te.events)&&void 0!==a?a:[],oe=null!==(n=null==te?void 0:te.total)&&void 0!==n?n:0,le=Object(r.useMemo)((()=>z.fields.find((e=>e.name===QH))),[z]),ce=Object(r.useCallback)((({page:e={},sort:t={}})=>{const{index:a,size:n}=e,{field:i,direction:r}=t;C(a+1),M(n),R(i),N(r)}),[C,M,N,R]),ue=Object(r.useCallback)((e=>{const t=p.filter((t=>!(t.start===e.start&&t.end===e.end)));t.unshift({start:e.start,end:e.end}),L(e.start),T(e.end),A(t.length>10?t.slice(0,9):t)}),[p,T,A,L]),de=Object(r.useCallback)((e=>{I(e.isPaused),P(e.refreshInterval>6e4?e.refreshInterval:6e4)}),[I,P]),pe=Object(r.useCallback)((e=>{re()}),[re]),me=Object(r.useCallback)((e=>{_(e)}),[_]),fe=Object(r.useCallback)((e=>{B(e)}),[B]),be=Object(r.useCallback)(((e,a)=>{if(null!=le){K.current={filters:Z,query:W,timerange:G};const i=Object(za.buildFilter)(z,le,za.FILTERS.PHRASE,!1,!1,e,null);U(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:ec()(a).subtract(1,"days").toISOString(),to:ec()(a).add(1,"days").toISOString()})),o.removeAll(),o.addFilters(i),U(Object(vt.setFilterQuery)({id:Ee.a.global,query:"",language:"kuery"})),t(),J.current=$({title:TH,text:(n=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,IH),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{size:"s",onClick:X},CH)))),e=>(Object(XU.render)(Object(Ws.jsx)(ms.I18nProvider,null,n),e),()=>Object(XU.unmountComponentAtNode)(e)))},{toastLifeTimeMs:6e5}).id}else q(_H,{title:MH});var n}),[q,$,U,o,Z,z,W,X,t,G,le]),ge=Object(r.useCallback)((e=>{u.set(l.qc,e),D(e)}),[D,u]),ye=Object(r.useMemo)((()=>({pageIndex:S-1,pageSize:O,totalItemCount:oe>YU?YU:oe,pageSizeOptions:[5,10,25,50]})),[oe,S,O]),he=Object(r.useMemo)((()=>({sort:{field:k,direction:w}})),[w,k]),ve=Object(r.useMemo)((()=>[{field:QH,name:kH,width:"64px",actions:[{name:"Edit",isPrimary:!0,field:"",description:wH,icon:"filter",type:"icon",onClick:e=>{null!=e&&e.execution_uuid&&be(e.execution_uuid,e.timestamp)},"data-test-subj":"action-filter-by-execution-id"}]}]),[be]),xe=Object(r.useCallback)((e=>`${e.execution_uuid}`),[]),je=Object(r.useCallback)((e=>s.a.createElement(ee.EuiDescriptionList,{className:"eui-fullWidth",listItems:[{title:PH,description:s.a.createElement(iH.a,{text:e.security_message})}]})),[]),Se=Object(nH.a)({getItemId:xe,renderItem:je}),Oe=Object(r.useMemo)((()=>{const e=[...zH];return j?e.push(qH("20%"),...(e=>[{field:"gap_duration_s",name:s.a.createElement(Mh,{title:yH,customTooltip:s.a.createElement("div",{style:{maxWidth:"20px"}},s.a.createElement(Ih,{columnName:yH},s.a.createElement(ee.EuiText,{size:"s",style:{width:350}},s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{defaultMessage:"Duration of gap in Rule execution (hh:mm:ss:SSS). Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumnTooltip",values:{seeDocs:s.a.createElement(ee.EuiLink,{href:`${e.links.siem.troubleshootGaps}`,target:"_blank"},hH)}})))))}),render:e=>s.a.createElement(s.a.Fragment,null,e?s.a.createElement(BH,{duration:e,isSeconds:!0}):Object(Jc.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"indexing_duration_ms",name:s.a.createElement(Mh,{title:vH,tooltipContent:EH}),render:e=>s.a.createElement(s.a.Fragment,null,e?s.a.createElement(BH,{duration:e}):Object(Jc.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"search_duration_ms",name:s.a.createElement(Mh,{title:xH,tooltipContent:jH}),render:e=>s.a.createElement(s.a.Fragment,null,e?s.a.createElement(BH,{duration:e}):Object(Jc.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"schedule_delay_ms",name:s.a.createElement(Mh,{title:SH,tooltipContent:OH}),render:e=>s.a.createElement(s.a.Fragment,null,e?s.a.createElement(BH,{duration:e}):Object(Jc.e)()),sortable:!0,truncateText:!1,width:"10%"}])(i)):e.push(qH("50%")),e.push(...ve,(({toggleRowExpanded:e,isRowExpanded:t})=>({align:ee.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:s.a.createElement(ee.EuiScreenReaderOnly,null,s.a.createElement("span",null,DH)),render:a=>"succeeded"===a.security_status?null:s.a.createElement(ee.EuiButtonIcon,{onClick:()=>e(a),"aria-label":t(a)?RH:NH,iconType:t(a)?"arrowUp":"arrowDown"})}))({toggleRowExpanded:Se.toggleRowExpanded,isRowExpanded:Se.isRowExpanded})),e}),[ve,i,j,Se.toggleRowExpanded,Se.isRowExpanded]);return s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(Li.a,{title:rH,subtitle:sH})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(HH,{onlyShowFilters:!0,selectedStatuses:v,onStatusFilterChange:fe,onSearch:me})),s.a.createElement(WH,null,s.a.createElement(ee.EuiSuperDatePicker,{start:b,end:g,onTimeChange:ue,onRefresh:pe,isPaused:f,isLoading:ne,refreshInterval:m,onRefreshChange:de,recentlyUsedRanges:p,width:"full"}))),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement($D.a,null,s.a.createElement($D.d,null,s.a.createElement($D.c,null,s.a.createElement($D.e,{dataTestSubj:"executionsShowing"},(ke=oe>YU?YU:oe,Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.totalExecutionsLabel",{values:{totalItems:ke},defaultMessage:"Showing {totalItems} {totalItems, plural, =1 {rule execution} other {rule executions}}"})))),oe>YU&&s.a.createElement($D.c,{grow:!0},s.a.createElement($D.e,{dataTestSubj:"exceptionsShowing",shouldWrap:!0},s.a.createElement(ee.EuiTextColor,{color:"danger"},((e,t)=>Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchLimitExceededLabel",{values:{totalItems:e,maxItems:1e3},defaultMessage:"More than {totalItems} rule executions match filters provided. Showing first {maxItems} by most recent '@timestamp'. Constrain filters further to view additional execution events."}))(oe))))),s.a.createElement($D.d,null,s.a.createElement($D.c,null,s.a.createElement($D.e,{dataTestSubj:"lastUpdated"},d.getLastUpdated({showUpdating:ie||ne,updatedAt:ae})),s.a.createElement(GH,{label:lH,checked:j,compressed:!0,onChange:e=>ge(e.target.checked)})))),s.a.createElement(ee.EuiBasicTable,{columns:Oe,items:se,loading:ne,sorting:he,pagination:ye,onChange:ce,itemId:xe,itemIdToExpandedRowMap:Se.itemIdToExpandedRowMap,isExpandable:!0}));var ke},KH=s.a.memo(ZH);KH.displayName="ExecutionLogTable";const JH=s.a.memo((({rule:e,spacesApi:t})=>{if(null!=(null==e?void 0:e.alias_target_id)&&t&&"conflict"===e.outcome){const a=e.alias_target_id,n=`rules/id/${a}${window.location.search}${window.location.hash}`;return s.a.createElement("div",{"data-test-subj":"legacyUrlConflictCallOut-wrapper"},s.a.createElement(ee.EuiSpacer,null),t.ui.components.getLegacyUrlConflict({objectNoun:Y.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:e.id,otherObjectId:a,otherObjectPath:n}))}return null}));JH.displayName="LegacyUrlConflictCallOut";var YH=a(1105),XH=a(428);function eQ({ruleId:e,disabled:t=!1,disabledReason:a}){const{application:{navigateToApp:n}}=Object(h.i)().services,i=Object(r.useCallback)((t=>{t.preventDefault(),n(l.l,{deepLinkId:P.a.rules,path:Object(we.b)(e)})}),[n,e]);return s.a.createElement(ee.EuiToolTip,{position:"top",content:a},s.a.createElement($t.l,{"data-test-subj":"editRuleSettingsLink",onClick:i,iconType:"controlsHorizontal",isDisabled:t,deepLinkId:P.a.rules,path:Object(we.b)(e)},Oo.Cb))}const tQ=[uc.b.DETECTION,uc.b.RULE_DEFAULT],aQ=ae.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-fdhtli-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),nQ=ae.a.div.withConfig({displayName:"StyledMinHeightTabContainer",componentId:"sc-fdhtli-1"})(["min-height:800px;"]),iQ=ae.a.div.withConfig({displayName:"RuleFieldsSectionWrapper",componentId:"sc-fdhtli-2"})(["overflow-wrap:anywhere;"]),rQ=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{var n,i,o,u,d,p;const{application:{navigateToApp:m,capabilities:{actions:f}},timelines:b,spaces:g}=Object(h.i)().services,y=Object(c.useDispatch)(),v=Object(r.useRef)(null),j=Object(r.useMemo)((()=>W.j.getTableByIdSelector()),[]),O=Object(F.b)((e=>{var t;return(null!==(t=j(e,W.e.alertsOnRuleDetailsPage))&&void 0!==t?t:W.q).graphEventId})),w=Object(F.b)((e=>{var t;return(null!==(t=j(e,W.e.alertsOnRuleDetailsPage))&&void 0!==t?t:W.q).updated})),T=Object(F.b)((e=>{var t;return(null!==(t=j(e,W.e.alertsOnRuleDetailsPage))&&void 0!==t?t:W.q).isLoading})),I=Object(r.useMemo)((()=>Me.d.globalFiltersQuerySelector()),[]),C=Object(r.useMemo)((()=>Me.d.globalQuerySelector()),[]),M=Object(F.a)(C),D=Object(F.a)(I),{to:N,from:R}=Object(xe.a)(),[{loading:L,isSignalIndexExists:B,isAuthenticated:z,hasEncryptionKey:q,canUserCRUD:$,hasIndexRead:V,signalIndexName:U,hasIndexWrite:H,hasIndexMaintenance:Q}]=Object(kt.b)(),{loading:G,needsConfiguration:Z}=zt(),{sourcererDataView:J,runtimeMappings:X,loading:te}=Object(E.d)(x.SourcererScopeName.detections),ae=L||G,{detailName:ie}=Object(k.useParams)(),{rule:re,refresh:se,loading:oe,isExistingRule:le}=Object(XH.a)(ie),{pollForSignalIndex:ce}=Object(Jr.a)(),[ue,de]=Object(r.useState)(null),pe=oe&&null==ue,{starting:me,startMlJobs:fe}=KD(),be=Object(r.useCallback)((async()=>{ue&&await fe(Object(Jh.g)(ue))}),[ue,fe]),ge=Object(wh.c)({rule:ue,ruleId:ie,isExistingRule:le,hasIndexRead:V}),[ye,ve,je]=Object(Wh.a)(),[Se,Oe,Te]=SD({onInit:ve,onFinish:je}),{aboutRuleData:Ie,modifiedAboutRuleDetailsData:Ce,ruleActionsData:_e}=null!=ue?Object(Jh.h)({rule:ue,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,ruleActionsData:null},{showBuildingBlockAlerts:Ae,setShowBuildingBlockAlerts:Fe,showOnlyThreatIndicatorAlerts:Pe}=Object(he.a)(W.e.alertsOnRuleDetailsPage),De=Object(ju.a)(),{globalFullScreen:Ne}=Object(Vt.a)(),[Re,Le]=Object(r.useState)(W.c),Be=Object(Fh.a)(De)&&Object(Ah.a)(De),ze=Object(r.useMemo)((()=>!(null!=(null==ue?void 0:ue.actions)&&(null==ue?void 0:ue.actions.length)>0&&Object(Vy.d)(f.show))||f.show),[f,null==ue?void 0:ue.actions]),qe=Object(r.useCallback)((()=>{m(l.l,{deepLinkId:P.a.rules,path:Object(we.c)(null!=ie?ie:"","alerts","")})}),[m,ie]);Object(r.useEffect)((()=>{null!=re&&de(re)}),[re]),(({rule:e,spacesApi:t})=>{Object(r.useEffect)((()=>{if(e){const a=e.outcome;if(t&&"aliasMatch"===a){const a=`rules/id/${e.id}${window.location.search}${window.location.hash}`;t.ui.redirectLegacyUrl({path:a,aliasPurpose:e.alias_purpose,objectNoun:Y.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"})})}}}),[e,t])})({rule:ue,spacesApi:g});const $e=Object(r.useMemo)((()=>te||T||ae),[te,T,ae]),Ve=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,null==ue?void 0:ue.name," ",oe&&s.a.createElement(ee.EuiLoadingSpinner,{size:"m"}))),[ue,oe]),Ue=Object(r.useMemo)((()=>oe||le?void 0:{text:YH.a,color:"default"}),[le,oe]),He=Object(r.useMemo)((()=>ue?[s.a.createElement(QU.a,{createdBy:null==ue?void 0:ue.created_by,createdAt:null==ue?void 0:ue.created_at}),null!=(null==ue?void 0:ue.updated_by)?s.a.createElement(QU.b,{updatedBy:null==ue?void 0:ue.updated_by,updatedAt:null==ue?void 0:ue.updated_at}):""]:oe?s.a.createElement(ee.EuiLoadingSpinner,{size:"m"}):null),[ue,oe]),Qe=Object(r.useCallback)((n=>{const i=W.e.alertsOnRuleDetailsPage;t({id:i}),e({id:i}),a({id:i}),Le(n)}),[t,e,a,Le]),Ge=null!=(null==ue?void 0:ue.building_block_type);Object(r.useEffect)((()=>{Fe(Ge)}),[Ge,Fe]);const We=null!==(n=null==ue?void 0:ue.rule_id)&&void 0!==n?n:"",Ze=Object(r.useMemo)((()=>[...Object(Qt.d)(null!=We?We:""),...Object(Qt.e)(Ae),...Object(Qt.b)(Re),...Object(Qt.f)(Pe)]),[We,Ae,Pe,Re]),Ke=Object(r.useMemo)((()=>[...Ze,...D]),[Ze,D]),Je=null==ue||null===(i=ue.execution_summary)||void 0===i?void 0:i.last_execution,Ye=null==Je?void 0:Je.status,Xe=null!==(o=null==Je?void 0:Je.date)&&void 0!==o?o:"",et=null!==(u=null==Je?void 0:Je.message)&&void 0!==u?u:"",tt=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,oe?s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):s.a.createElement(eh.a,{status:Ye,date:Xe},s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":"ruleLastExecutionStatusRefreshButton",color:"primary",onClick:se,iconType:"refresh","aria-label":Oo.dc,isDisabled:!le})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement($y.a,{ruleId:ie,showTooltipInline:!0})))),[ie,Ye,Xe,oe,le,se]);let at;null!=ue&&"index"in ue&&Array.isArray(ue.index)&&(at=ue.index);const nt=Object(r.useMemo)((()=>oe?s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):s.a.createElement(eh.c,{ruleName:null!=ue&&ue.immutable?null==ue?void 0:ue.name:void 0,dataSources:null!=ue&&ue.immutable?at:void 0,status:Ye,date:Xe,message:et})),[Ye,Xe,et,oe,null==ue?void 0:ue.immutable,null==ue?void 0:ue.name,at]),it=Object(r.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;y(Object(vt.setAbsoluteRangeDatePicker)({id:Ee.a.global,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[y]),rt=Object(r.useCallback)((e=>{de((t=>t?{...t,enabled:e}:t))}),[]),st=Object(r.useCallback)((()=>{Object(Ht.j)(v.current)}),[v]),ot=Object(r.useCallback)((()=>{Object(Ht.m)()}),[]),lt=Object(r.useCallback)((e=>{Object(ne.isTab)(e)&&Object(Ht.l)({containerElement:v.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:st,onSkipFocusAfterEventsTable:ot})}),[v,st,ot]),ct=Object(r.useMemo)((()=>[Re]),[Re]),ut=Object(r.useMemo)((()=>b.getLastUpdated({updatedAt:w||Date.now(),showUpdating:$e})),[w,$e,b]),dt=Object(r.useCallback)((e=>s.a.createElement(ol,{configId:l.e.RULE_DETAILS,inputFilters:[...Ke,...e],tableId:W.e.alertsOnRuleDetailsPage,onRuleChange:se})),[Ke,se]),{isBulkDuplicateConfirmationVisible:pt,showBulkDuplicateConfirmation:mt,cancelRuleDuplication:ft,confirmRuleDuplication:bt}=GD();if(Object(Jh.i)(B,z,q,Z))return m(l.l,{deepLinkId:P.a.alerts,path:Object(we.a)()}),null;const gt=null!=_e&&_e.actions.length>0,yt=null!=_e&&(_e.responseActions||[]).length>0,Et=gt||yt;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Is,null),s.a.createElement(Qs,null),pt&&s.a.createElement(ZD,{onCancel:ft,onConfirm:bt,rulesCount:1}),ye&&s.a.createElement(ee.EuiConfirmModal,{title:Oo.Vc,onCancel:Te,onConfirm:Oe,confirmButtonText:Oo.wb,cancelButtonText:Oo.vb,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"deleteRulesConfirmationModal"},YH.b),s.a.createElement(aQ,{onKeyDown:lt,ref:v},s.a.createElement(ee.EuiWindowEvent,{event:"resize",handler:A.noop}),s.a.createElement(ke,{show:Object(Ht.n)({globalFullScreen:Ne,graphEventId:O})},s.a.createElement(ht,{id:Ee.a.global,pollForSignalIndex:ce,sourcererDataView:J})),s.a.createElement(aH,null,s.a.createElement(S.a,{noPadding:Ne},s.a.createElement(Ut,{show:!Ne},s.a.createElement(oo,{border:!0,subtitle:He,subtitle2:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},s.a.createElement(ee.EuiFlexItem,{grow:!1},eh.d.STATUS,":"),tt)),title:Ve,badgeOptions:Ue},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiToolTip,{position:"top",content:Object(Vy.b)(ue,Be,ze,$)},s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(Oh,{id:null!==(d=null==ue?void 0:ue.id)&&void 0!==d?d:"-1",isDisabled:!ue||!le||!Object(Vy.a)(ue,ze)||!Object(Vy.c)($)||Object(qy.d)(null==ue?void 0:ue.type)&&!Be,enabled:le&&null!==(p=null==ue?void 0:ue.enabled)&&void 0!==p&&p,startMlJobsIfNeeded:be,onChange:rt}),s.a.createElement(ee.EuiFlexItem,null,YH.c)))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(eQ,{ruleId:ie,disabled:!le||!Object(Vy.c)($)||Object(qy.d)(null==ue?void 0:ue.type)&&!Be,disabledReason:Object(Vy.b)(ue,Be,ze,$)})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(KU,{rule:ue,userHasPermissions:le&&Object(Vy.c)($),canDuplicateRuleWithActions:Object(Vy.a)(ue,ze),showBulkDuplicateExceptionsConfirmation:mt,confirmDeletion:Se})))))),nt,s.a.createElement(JH,{rule:ue,spacesApi:g}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(iQ,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},null!==ue&&s.a.createElement(zU,{loading:pe,stepData:Ie,stepDataDetails:Ce,rule:ue})),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,{component:"section",grow:1,"data-test-subj":"defineRule"},s.a.createElement(HU,{loading:pe,title:Oo.tb},null!==ue&&!me&&s.a.createElement(bN.a,{rule:ue,isInteractive:!0,dataTestSubj:"definitionRule"}))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},s.a.createElement(HU,{loading:pe,title:Oo.Mc},null!=ue&&s.a.createElement(gN.a,{rule:ue}))),Et&&s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"actions",component:"section",grow:1},s.a.createElement(HU,{loading:pe,title:Oo.c},s.a.createElement(Cq.b,{addPadding:!1,defaultValues:_e}))))))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(Wc,{navTabs:ge}),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(nQ,null,s.a.createElement(K.c,null,s.a.createElement(K.a,{path:`/rules/id/:detailName/:tabName(${wh.b.alerts})`},s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(mo,{status:Re,onFilterGroupChanged:Qe})),s.a.createElement(ee.EuiFlexItem,{grow:!1},ut)),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(Ut,{show:!Ne},s.a.createElement(Ui.a,{filters:Ke,query:M,signalIndexName:U,defaultStackByOption:"event.category",updateDateRange:it,runtimeMappings:X}),s.a.createElement(ee.EuiSpacer,null)),null!=ie&&s.a.createElement(Uo,{currentAlertStatusFilterValue:ct,defaultFilters:Ke,from:R,globalFilters:D,globalQuery:M,hasIndexMaintenance:null!=Q&&Q,hasIndexWrite:null!=H&&H,loading:ae,renderChildComponent:dt,runtimeMappings:X,signalIndexName:U,tableId:W.e.alertsOnRuleDetailsPage,to:N}))),s.a.createElement(K.a,{path:`/rules/id/:detailName/:tabName(${wh.b.exceptions})`},s.a.createElement(TU,{rule:ue,listTypes:tQ,onRuleChange:se,isViewReadOnly:!le,"data-test-subj":"exceptionTab"})),s.a.createElement(K.a,{path:`/rules/id/:detailName/:tabName(${wh.b.endpointExceptions})`},s.a.createElement(CU,{rule:ue,onRuleChange:se,isViewReadOnly:!le,"data-test-subj":"endpointExceptionsTab"})),s.a.createElement(K.a,{path:`/rules/id/:detailName/:tabName(${wh.b.executionResults})`},s.a.createElement(KH,{ruleId:ie,selectAlertsTab:qe})),s.a.createElement(K.a,{path:`/rules/id/:detailName/:tabName(${wh.b.executionEvents})`},s.a.createElement(JU.a,{ruleId:ie}))))))),s.a.createElement(_,{pageName:P.a.rules,state:{ruleName:null==ue?void 0:ue.name,isExistingRule:le}}))},sQ=Object(c.connect)(null,(e=>({clearSelected:({id:t})=>e(W.h.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(W.h.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(W.h.clearEventsDeleted({id:t}))})));rQ.displayName="RuleDetailsPageComponent";const oQ=sQ(s.a.memo(rQ));oQ.displayName="RuleDetailsPage";const lQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),cQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),uQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),dQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),pQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"});var mQ=a(1117);const fQ=({rule:e})=>{const[,t]=Object(tu.f)(),[{loading:a,isSignalIndexExists:n,isAuthenticated:i,hasEncryptionKey:o,canUserCRUD:c}]=Object(kt.b)(),{loading:u,needsConfiguration:d}=zt(),{data:p,application:m}=Object(h.i)().services,{navigateToApp:f}=m,{detailName:b}=Object(k.useParams)(),[g,y]=Object(r.useState)(e.immutable?nL.c.ruleActions:nL.c.defineRule),{mutateAsync:v,isLoading:E}=Object(mP.g)(),[x,j]=Object(r.useState)({}),[O,w]=Object(r.useState)(!0),T=Object(r.useRef)(),[I,C]=Object(r.useState)(!1),[M,A]=Object(r.useState)(!1);Object(r.useEffect)((()=>{(async()=>{const e=(await p.dataViews.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});j(e)})()}),[p.dataViews]);const F=Object(r.useMemo)((()=>{var t;return{path:Object(we.d)(null!=b?b:""),text:`${pQ} ${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""}`,pageId:P.a.rules,dataTestSubj:"ruleEditBackToRuleDetails"}}),[null==e?void 0:e.name,b]),[D]=Object(h.o)(l.I),[N]=Object(h.o)(l.U),{aboutRuleData:R,defineRuleData:L,scheduleRuleData:B,ruleActionsData:z}=Object(Jh.h)({rule:e}),{defineStepForm:q,defineStepData:$,aboutStepForm:V,aboutStepData:U,scheduleStepForm:H,scheduleStepData:Q,actionsStepForm:G,actionsStepData:W,eqlOptionsSelected:Z,setEqlOptionsSelected:K}=Object(D$.a)({defineStepDefault:L,aboutStepDefault:R,scheduleStepDefault:B,actionsStepDefault:z}),J=Aq({defineStepData:$,activeStep:g}),X=_q($.queryBar.query.query,$.ruleType,q.isValid||g!==nL.c.defineRule),te=Object(r.useMemo)((()=>Object(Zh.c)($.ruleType)?X:$.index),[$.index,X,$.ruleType]),ae=o$({ruleType:$.ruleType,isQueryBarValid:I,isThreatQueryBarValid:M,index:te,dataViewId:$.dataViewId,dataSourceType:$.dataSourceType,threatIndex:$.threatIndex,threatMapping:$.threatMapping,machineLearningJobId:$.machineLearningJobId,queryBar:$.queryBar,newTermsFields:$.newTermsFields}),ne=a||u,{isSavedQueryLoading:ie,savedQuery:re}=Object(mQ.a)({savedQueryId:"saved_id"in e?e.saved_id:void 0,ruleType:null==e?void 0:e.type}),se=Object(r.useCallback)((e=>{var t,a,n,i;switch(e){case nL.c.defineRule:return null===(t=q.isValid)||void 0===t||t;case nL.c.aboutRule:return null===(a=V.isValid)||void 0===a||a;case nL.c.scheduleRule:return null===(n=H.isValid)||void 0===n||n;case nL.c.ruleActions:return null===(i=G.isValid)||void 0===i||i;default:return!0}}),[V.isValid,G.isValid,q.isValid,H.isValid]),oe=ez.filter((e=>!se(e))),le=Object(r.useMemo)((()=>Object(Jh.d)(null==e?void 0:e.type)),[null==e?void 0:e.type]),{indexPattern:ce,isIndexPatternLoading:ue,browserFields:de}=Object(D$.b)({dataSourceType:$.dataSourceType,index:te,dataViewId:$.dataViewId}),pe=Object(r.useMemo)((()=>[{"data-test-subj":"edit-rule-define-tab",id:nL.c.defineRule,name:Oo.tb,disabled:null==e?void 0:e.immutable,content:s.a.createElement("div",{style:{display:g===nL.c.defineRule?void 0:"none"}},s.a.createElement(ee.EuiSpacer,null),s.a.createElement(HU,{loading:ne||ie,title:Oo.tb},!ie&&s.a.createElement(Oz,{isLoading:ne||E||ie,isUpdateView:!0,kibanaDataViews:x,indicesConfig:D,threatIndicesConfig:N,defaultSavedQuery:re,form:q,optionsSelected:Z,setOptionsSelected:K,key:"defineStep",indexPattern:ce,isIndexPatternLoading:ue,browserFields:de,isQueryBarValid:I,setIsQueryBarValid:C,setIsThreatQueryBarValid:A,ruleType:$.ruleType,index:te,threatIndex:$.threatIndex,groupByFields:$.groupByFields,dataSourceType:$.dataSourceType,shouldLoadQueryDynamically:$.shouldLoadQueryDynamically,queryBarTitle:$.queryBar.title,queryBarSavedId:$.queryBar.saved_id,thresholdFields:$.threshold.field,enableThresholdSuppression:$.enableThresholdSuppression}),s.a.createElement(ee.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:nL.c.aboutRule,name:Oo.a,disabled:null==e?void 0:e.immutable,content:s.a.createElement("div",{style:{display:g===nL.c.aboutRule?void 0:"none"}},s.a.createElement(ee.EuiSpacer,null),s.a.createElement(HU,{loading:ne,title:Oo.a},null!=U&&null!=$&&s.a.createElement(Eq,{isLoading:E,isUpdateView:!0,isActive:g===nL.c.aboutRule,ruleType:$.ruleType,machineLearningJobId:$.machineLearningJobId,index:te,dataViewId:$.dataViewId,timestampOverride:U.timestampOverride,form:V,esqlQuery:J,key:"aboutStep"}),s.a.createElement(ee.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:nL.c.scheduleRule,name:Oo.Mc,disabled:null==e?void 0:e.immutable,content:s.a.createElement("div",{style:{display:g===nL.c.scheduleRule?void 0:"none"}},s.a.createElement(ee.EuiSpacer,null),s.a.createElement(HU,{loading:ne,title:Oo.Mc},null!=Q&&s.a.createElement(wq,{isLoading:E,isUpdateView:!0,form:H,key:"scheduleStep"}),s.a.createElement(ee.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:nL.c.ruleActions,name:Oo.c,content:s.a.createElement("div",{style:{display:g===nL.c.ruleActions?void 0:"none"}},s.a.createElement(ee.EuiSpacer,null),s.a.createElement(HU,{loading:ne},null!=W&&s.a.createElement(Cq.a,{ruleId:null==e?void 0:e.id,isLoading:E,isUpdateView:!0,actionMessageParams:le,summaryActionMessageParams:le,ruleType:null==e?void 0:e.type,form:G,key:"actionsStep"}),s.a.createElement(ee.EuiSpacer,null)))}]),[null==e?void 0:e.immutable,null==e?void 0:e.id,null==e?void 0:e.type,g,ne,ie,E,x,D,N,re,q,Z,K,ce,ue,de,I,$,U,V,Q,H,W,le,G,te,J]),{startTransaction:me}=Object(Mo.b)(),fe=Object(r.useCallback)((async()=>{const a=await q.validate(),n=await V.validate(),i=await H.validate(),r=await G.validate();var s,o;a&&n&&i&&r&&(me({name:ah.e.SAVE}),await v({...Object(DN.d)($,U,Q,W,null==e?void 0:e.exceptions_list),...b?{id:b}:{},...null!=e?{max_signals:e.max_signals}:{}}),Object(tu.d)((o=null!==(s=null==e?void 0:e.name)&&void 0!==s?s:"",Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:o},defaultMessage:"{ruleName} was saved"})),t),f(l.l,{deepLinkId:P.a.rules,path:Object(we.d)(null!=b?b:"")}))}),[q,V,H,G,me,v,$,U,Q,W,e,b,t,f]),be=Object(r.useCallback)((async e=>{const t=e.id;y(t)}),[]),ge=Object(r.useCallback)((e=>{e.preventDefault(),f(l.l,{deepLinkId:P.a.rules,path:Object(we.d)(null!=b?b:"")})}),[f,b]);return Object(Jh.i)(n,i,o,d)?(f(l.l,{deepLinkId:P.a.alerts,path:Object(we.a)()}),null):Object(Vy.c)(c)?s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,null,s.a.createElement(ee.EuiResizableContainer,null,((t,a,{togglePanel:n})=>(T.current=()=>null==n?void 0:n("preview",{direction:"left"}),s.a.createElement(s.a.Fragment,null,s.a.createElement(t,{initialSize:70,minSize:"40%",mode:"main"},s.a.createElement(ee.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},s.a.createElement(Jh.a,null,s.a.createElement(L$,{backOptions:F,isLoading:E,title:lQ,isRulePreviewVisible:O,setIsRulePreviewVisible:w,togglePanel:n}),oe.length>0&&s.a.createElement(ee.EuiCallOut,{title:dQ,color:"danger",iconType:"warning"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:oe.length,tabHasError:oe.map((e=>e===nL.c.aboutRule?Oo.a:e===nL.c.defineRule?Oo.tb:e===nL.c.scheduleRule?Oo.Mc:e===nL.c.ruleActions?Oo.Gc:e)).join(", ")}})),s.a.createElement(ee.EuiTabs,null,pe.map(((e,t)=>s.a.createElement(ee.EuiTab,{key:t,onClick:()=>be(e),isSelected:e.id===g,disabled:e.disabled,"data-test-subj":e["data-test-subj"]},e.name)))),pe.map((e=>e.content)),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{iconType:"cross",onClick:ge},cQ)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:fe,iconType:"save",isLoading:E,isDisabled:ne},uQ)))))),s.a.createElement(a,null),s.a.createElement(t,{id:"preview",mode:"collapsible",initialSize:30,minSize:"20%",onToggleCollapsed:()=>w((e=>!e))},s.a.createElement(F$,{isDisabled:ae,defineRuleData:$,aboutRuleData:U,scheduleRuleData:Q,exceptionsList:null==e?void 0:e.exceptions_list}))))))),s.a.createElement(_,{pageName:P.a.rules,state:{ruleName:null==e?void 0:e.name}})):(f(l.l,{deepLinkId:P.a.rules,path:Object(we.d)(null!=b?b:"")}),null)},bQ=()=>{const{detailName:e}=Object(k.useParams)(),{data:t}=Object(mP.f)(e,!0);return null!=t?s.a.createElement(fQ,{rule:t}):s.a.createElement(s.a.Fragment,null)},gQ=Object(r.memo)(bQ),yQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.pageTitle",{defaultMessage:"Add Elastic Rules"}),hQ=()=>{const e=Object($t.o)(),{onClick:t}=e({deepLinkId:uM.SecurityPageName.rules});return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,direction:"column",wrap:!0},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiEmptyPrompt,{title:s.a.createElement("h3",null,Oo.Tb),titleSize:"s",body:Oo.Ub,"data-test-subj":"noPrebuiltRulesAvailableForInstall"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,iconType:"arrowLeft",color:"primary",onClick:t,"data-test-subj":"addRulesGoBackToRulesTableBtn"},Oo.Ib)))},vQ=s.a.memo(hQ),EQ=["POST","ALL_RULES",rN.b],xQ=["POST","SPECIFIC_RULES",rN.b],jQ=e=>{const t=[],{summary:{succeeded:a,skipped:n,failed:i}}=e;return a>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.installRuleSuccess",{defaultMessage:"{succeeded, plural, one {# rule} other {# rules}} installed successfully.",values:{succeeded:e}}))(a)),n>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.installRuleSkipped",{defaultMessage:"{skipped, plural, one {# rule was} other {# rules were}} skipped during installation.",values:{skipped:e}}))(n)),i>0&&t.push((e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.prebuiltRules.toast.installRuleFailed",{defaultMessage:"{failed, plural, one {# rule} other {# rules}} failed to install.",values:{failed:e}}))(i)),t.join(" ")},SQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.installAllButtonTitle",{defaultMessage:"Install all"}),OQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.searchBarPlaceholder",{defaultMessage:"Search by rule name"}),kQ=Y.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.installButtonLabel",{defaultMessage:"Install"}),wQ=Object(r.createContext)(null),TQ=({children:e})=>{const[t,a]=Object(r.useState)([]),[n,i]=Object(r.useState)([]),[{loading:o,canUserCRUD:l}]=Object(kt.b)(),[c,u]=Object(r.useState)({filter:"",tags:[]}),{data:d}=Object(lh.a)(),p=Object(JD.a)(),{data:{rules:m,stats:{tags:f}}={rules:[],stats:{tags:[]}},refetch:b,dataUpdatedAt:g,isFetched:y,isLoading:h,isRefetching:v}=(e=>{const{addError:t}=Object(Pt.a)();return Object(uh.a)({onError:e=>t(e,{title:IF.b}),...e})})({refetchInterval:6e4,keepPreviousData:!0,enabled:Boolean(!p&&d&&d.num_prebuilt_rules_total_in_package>0)}),{mutateAsync:E}=(()=>{const{addError:e,addSuccess:t}=Object(Pt.a)();return(e=>{const t=Object(rh.b)(),a=Object(sN.b)(),n=Object(oh.b)(),i=Object(uh.b)(),r=Object(lh.b)(),s=Object(dh.b)();return Object(ih.useMutation)((()=>Object(xc.r)()),{...e,mutationKey:EQ,onSettled:(...o)=>{t(),a(),n(),i(),r(),s(),null!=e&&e.onSettled&&e.onSettled(...o)}})})({onError:t=>{e(t,{title:cN})},onSuccess:e=>{t(jQ(e))}})})(),{mutateAsync:x}=(()=>{const{addError:e,addSuccess:t}=Object(Pt.a)();return(e=>{const t=Object(rh.b)(),a=Object(sN.b)(),n=Object(lh.b)(),i=Object(oh.b)(),r=Object(uh.b)(),s=Object(lh.b)(),o=Object(dh.b)();return Object(ih.useMutation)((e=>Object(xc.s)(e)),{...e,mutationKey:xQ,onSettled:(...l)=>{n(),t(),a(),i(),r(),s(),o(),null!=e&&e.onSettled&&e.onSettled(...l)}})})({onError:t=>{e(t,{title:cN})},onSuccess:e=>{t(jQ(e))}})})(),j=(({rules:e,filterOptions:t})=>Object(r.useMemo)((()=>{const{filter:a,tags:n}=t;return e.filter((e=>!(a&&!e.name.toLowerCase().includes(a.toLowerCase()))&&(!(n&&n.length>0)||n.every((t=>e.tags.includes(t))))))}),[t,e]))({filterOptions:c,rules:m}),{openRulePreview:S,closeRulePreview:O,previewedRule:k}=pN(j),w=(null==k?void 0:k.rule_id)&&t.includes(k.rule_id),T=!o&&l&&!(w||v||p),I=Object(r.useCallback)((async e=>{const t=m.find((t=>t.rule_id===e));Object(iN.a)(t,`Rule with id ${e} not found`),a((t=>[...t,e]));try{await x([{rule_id:e,version:t.version}])}finally{a((t=>t.filter((t=>t!==e))))}}),[x,m]),C=Object(r.useCallback)((async()=>{const e=n.map((e=>({rule_id:e.rule_id,version:e.version})));a((t=>[...t,...e.map((e=>e.rule_id))]));try{await x(e)}finally{a((t=>t.filter((t=>!e.some((e=>e.rule_id===t)))))),i([])}}),[x,n]),M=Object(r.useCallback)((async()=>{a((e=>[...e,...m.map((e=>e.rule_id))]));try{await E()}finally{a([]),i([])}}),[E,m]),_=Object(r.useMemo)((()=>({setFilterOptions:u,installAllRules:M,installOneRule:I,installSelectedRules:C,reFetchRules:b,selectRules:i,openRulePreview:S})),[M,I,C,b,S]),A=Object(r.useMemo)((()=>({state:{rules:m,filteredRules:j,filterOptions:c,tags:f,isFetched:y,isLoading:h,loadingRules:t,isRefetching:v,isUpgradingSecurityPackages:p,selectedRules:n,lastUpdated:g},actions:_})),[m,j,c,f,y,h,t,v,p,n,g,_]);return s.a.createElement(wQ.Provider,{value:A},s.a.createElement(s.a.Fragment,null,e,k&&s.a.createElement(AN,{rule:k,dataTestSubj:"installPrebuiltRulePreview",closeFlyout:O,ruleActions:s.a.createElement(ee.EuiButton,{disabled:!T,onClick:()=>{var e;I(null!==(e=k.rule_id)&&void 0!==e?e:""),O()},fill:!0,"data-test-subj":"installPrebuiltRuleFromFlyoutButton"},kQ)})))},IQ=()=>{const e=Object(r.useContext)(wQ);return Object(iN.a)(e,"useAddPrebuiltRulesTableContext should be used inside AddPrebuiltRulesTableContextProvider"),e},CQ=ae()(ee.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-1188j36-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM)),MQ=()=>{const{state:{filterOptions:e,tags:t},actions:{setFilterOptions:a}}=IQ(),{tags:n}=e,i=Object(r.useCallback)((e=>{a((t=>({...t,filter:e.trim()})))}),[a]),o=Object(r.useCallback)((e=>{Object(A.isEqual)(e,n)||a((t=>({...t,tags:e})))}),[n,a]);return s.a.createElement(CQ,{gutterSize:"m",justifyContent:"flexEnd",wrap:!0},s.a.createElement(PD,{initialValue:e.filter,onSearch:i,placeholder:OQ}),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(wD,{onSelectedTagsChanged:o,selectedTags:n,tags:t,"data-test-subj":"allRulesTagPopover"}))))};MQ.displayName="AddPrebuiltRulesTableFiltersComponent";const _Q=s.a.memo(MQ);_Q.displayName="AddPrebuiltRulesTableFilters";const AQ=({name:e,ruleId:t})=>{const{actions:{openRulePreview:a}}=IQ();return s.a.createElement(ee.EuiLink,{onClick:()=>{a(t)},"data-test-subj":"ruleName"},e)},FQ={field:"name",name:Oo.mb,render:(e,t)=>s.a.createElement(AQ,{name:e,ruleId:t.id}),sortable:!0,truncateText:!0,width:"40%",align:"left"},PQ={field:"tags",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(So.a,{items:e,popoverTitle:Oo.pb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>s.a.createElement(ee.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},DQ={field:"related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:s.a.createElement(Xy,{relatedIntegrations:e}),width:"143px",truncateText:!0},NQ=(e,t,a)=>({field:"rule_id",name:"",render:n=>{const i=t.includes(n),r=i||a;return s.a.createElement(ee.EuiButtonEmpty,{size:"s",disabled:r,onClick:()=>e(n),"data-test-subj":`installSinglePrebuiltRuleButton-${n}`},i?s.a.createElement(ee.EuiLoadingSpinner,{size:"s","data-test-subj":`installSinglePrebuiltRuleButton-loadingSpinner-${n}`}):Oo.Pb)},width:"10%",align:"center"}),RQ=s.a.memo((()=>{const e=IQ(),{state:{rules:t,filteredRules:a,isFetched:n,isLoading:i,isRefetching:o,selectedRules:c,isUpgradingSecurityPackages:u},actions:{selectRules:d}}=e,p=(()=>{const[{canUserCRUD:e}]=Object(kt.b)(),t=Object(Vy.c)(e),[a]=Object(h.o)(l.xc),{state:{loadingRules:n,isRefetching:i,isUpgradingSecurityPackages:o},actions:{installOneRule:c}}=IQ(),u=i||o;return Object(r.useMemo)((()=>[FQ,...a?[DQ]:[],PQ,{field:"risk_score",name:Oo.lb,render:e=>s.a.createElement(ee.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"severity",name:Oo.nb,render:e=>s.a.createElement(kh.a,{value:e}),sortable:({severity:e})=>wc(e),truncateText:!0,width:"12%"},...t?[NQ(c,n,u)]:[]]),[t,c,n,u,a])})(),m=n&&0===t.length,f=u||o;return s.a.createElement(s.a.Fragment,null,f&&s.a.createElement(ee.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(ee.EuiSkeletonLoading,{isLoading:i,loadingContent:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSkeletonTitle,null),s.a.createElement(ee.EuiSkeletonText,null)),loadedContent:m?s.a.createElement(vQ,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlexGroup,{direction:"column"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(eN,null)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(_Q,null))),s.a.createElement(ee.EuiInMemoryTable,{items:a,sorting:!0,pagination:{initialPageSize:fP.a,pageSizeOptions:fP.b},isSelectable:!0,selection:{selectable:()=>!0,onSelectionChange:d,initialSelected:c},itemId:"rule_id","data-test-subj":"add-prebuilt-rules-table",columns:p}))}))}));RQ.displayName="AddPrebuiltRulesTable";const LQ=()=>{var e;const{state:{rules:t,selectedRules:a,loadingRules:n,isRefetching:i,isUpgradingSecurityPackages:r},actions:{installAllRules:o,installSelectedRules:l}}=IQ(),[{loading:c,canUserCRUD:u}]=Object(kt.b)(),d=u&&!c,p=t.length>0,m=null!==(e=a.length)&&void 0!==e?e:0,f=m>0,b=n.length>0,g=b||i||r;return s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},f?s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{onClick:l,disabled:!d||g,"data-test-subj":"installSelectedRulesButton"},(e=>Y.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.installSelectedRules",{defaultMessage:"Install {numberOfSelectedRules} selected rule(s)",values:{numberOfSelectedRules:e}}))(m),b?s.a.createElement(ee.EuiLoadingSpinner,{size:"s"}):void 0)):null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"installAllRulesButton",onClick:o,disabled:!d||!p||g},SQ,b?s.a.createElement(ee.EuiLoadingSpinner,{size:"s"}):void 0)))},BQ=()=>{const{navigateToApp:e}=Object(h.i)().services.application,[{isSignalIndexExists:t,isAuthenticated:a,hasEncryptionKey:n}]=Object(kt.b)(),{needsConfiguration:i}=zt();return Object(Jh.i)(t,a,n,i)?(e(uM.APP_UI_ID,{deepLinkId:P.a.alerts,path:Object(y.c)()}),null):s.a.createElement(s.a.Fragment,null,s.a.createElement(Is,null),s.a.createElement(Qs,null),s.a.createElement(TQ,null,s.a.createElement(S.a,null,s.a.createElement(oo,{title:yQ},s.a.createElement(LQ,null)),s.a.createElement(RQ,null))),s.a.createElement(_,{pageName:P.a.rulesAdd}))},zQ=s.a.memo(BQ);zQ.displayName="AddRulesPage";const qQ=Y.i18n.translate("xpack.securitySolution.rules.landing.pageTitle",{defaultMessage:"Rules"}),$Q="setShowExpandedCells",VQ="setRuleActivityFilter",UQ="setRuleSourceFilter",HQ="setRuleSearchFilter",QQ=Object(r.createContext)(null),GQ={showExpandedCells:!1,filter:{activity:[TD.b.Enabled],source:[TD.c.Prebuilt,TD.c.Custom]},data:void 0,isLoading:!1},WQ=({children:e})=>{const[t,a]=Object(r.useReducer)(((e,t)=>{switch(t.type){case $Q:{const{value:a}=t;return{...e,showExpandedCells:a}}case VQ:{const{value:a}=t,n={...e.filter,activity:0!==a.length?a:void 0};return{...e,filter:n}}case UQ:{const{value:a}=t,n={...e.filter,source:0!==a.length?a:void 0};return{...e,filter:n}}case HQ:{const{value:a}=t,n={...e.filter,search_term:0!==a.length?a:void 0};return{...e,filter:n}}default:return e}}),GQ),{data:n,isLoading:i,refetch:o}=Object(dh.a)(t.filter),{executeBulkAction:l}=xh();Object(r.useEffect)((()=>{o()}),[o,t.filter]);const c=Object(r.useCallback)((e=>{a({type:$Q,value:e})}),[a]),u=Object(r.useCallback)((e=>{a({type:VQ,value:e})}),[a]),d=Object(r.useCallback)((e=>{a({type:UQ,value:e})}),[a]),p=Object(r.useCallback)((e=>{a({type:HQ,value:e})}),[a]),m=Object(r.useCallback)((async e=>{await l({type:TD.a.enable,ids:e})}),[l]),f=Object(r.useMemo)((()=>({refetch:o,setShowExpandedCells:c,setRuleActivityFilter:u,setRuleSourceFilter:d,setRuleSearchFilter:p,enableAllDisabled:m})),[o,u,p,d,c,m]),b=Object(r.useMemo)((()=>({state:{...t,isLoading:i,data:n},actions:f})),[f,n,i,t]);return s.a.createElement(QQ.Provider,{value:b},e)},ZQ=()=>{const e=Object(r.useContext)(QQ);return Object(iN.a)(e,"useCoverageOverviewDashboardContext should be used inside CoverageOverviewDashboardContextProvider"),e};var KQ=a(473);const JQ=300,YQ=[{threshold:10,color:"#00BFB3"},{threshold:7,color:"#00BFB399"},{threshold:3,color:"#00BFB34D"},{threshold:1,color:"#00BFB326"}],XQ=[{label:TD.b.Enabled},{label:TD.b.Disabled}],eG={[TD.b.Enabled]:KQ.j,[TD.b.Disabled]:KQ.h},tG=[{label:TD.c.Prebuilt},{label:TD.c.Custom}],aG={[TD.c.Prebuilt]:KQ.i,[TD.c.Custom]:KQ.f},nG=mN.css`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,iG=({disabledRules:e,enabledRules:t})=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"coverageOverviewPanelRuleStats",direction:"column",gutterSize:"xs"},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{className:Object(mN.cx)(nG),size:"xs"},KQ.t)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiNotificationBadge,{"data-test-subj":"ruleStatsDisabledRulesCount",color:"subdued"},e))),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{className:Object(mN.cx)(nG),size:"xs"},KQ.v)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiNotificationBadge,{"data-test-subj":"ruleStatsEnabledRulesCount",color:"subdued"},t)))),rG=({tactic:e})=>{const t=Object(r.useMemo)((()=>(e=>e.techniques.filter((e=>0!==e.enabledRules.length)).length)(e)),[e]),a=Object(r.useMemo)((()=>s.a.createElement(ee.EuiText,{size:"xs",color:"success"},s.a.createElement("h5",null,KQ.e(t,e.techniques.length)))),[e.techniques,t]);return s.a.createElement(ee.EuiPanel,{"data-test-subj":"coverageOverviewTacticPanel",hasShadow:!1,hasBorder:!0,paddingSize:"s",className:mN.css`
        background: ${jo.euiThemeVars.euiColorLightestShade};
        border-color: ${jo.euiThemeVars.euiColorMediumShade};
        width: ${160}px;
      `},s.a.createElement(ee.EuiToolTip,{content:e.name},s.a.createElement(ee.EuiText,{className:mN.css`
            h4 {
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
            }
          `,"aria-label":e.name,title:e.name,grow:!1,size:"xs"},s.a.createElement("h4",null,e.name))),s.a.createElement(ee.EuiProgress,{color:"success",value:t,label:a,max:e.techniques.length}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(iG,{enabledRules:e.enabledRules.length,disabledRules:e.disabledRules.length}))},sG=Object(r.memo)(rG),oG=({listTitle:e,listLength:t})=>s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("h4",null,e))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiNotificationBadge,{size:"m",color:"subdued"},t))),lG=e=>e.filter((e=>"on"===e.checked)).map((e=>e.label)),cG=(e,t)=>e.map((e=>t.includes(e.label)?{...e,checked:"on"}:e)),uG=({technique:e,coveredSubtechniques:t,setIsPopoverOpen:a,isPopoverOpen:n,isExpanded:i})=>{const{state:{filter:o}}=ZQ(),l=((e,t)=>{if(!t)return e.enabledRules.length+e.disabledRules.length;let a=0;return t.includes(TD.b.Enabled)&&(a+=e.enabledRules.length),t.includes(TD.b.Disabled)&&(a+=e.disabledRules.length),a})(e,o.activity),c=Object(r.useMemo)((()=>(e=>{for(const{threshold:t,color:a}of YQ)if(e>=t)return a})(l)),[l]),u=Object(r.useCallback)((()=>a(!n)),[n,a]),d=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{className:mN.css`
            white-space: nowrap;
          `,grow:!1},s.a.createElement(ee.EuiText,{size:"xs"},KQ.y)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"xs"},`${t}/${e.subtechniques.length}`)))),[e.subtechniques,t]);return s.a.createElement(ee.EuiPanel,{"data-test-subj":"coverageOverviewTechniquePanel",className:mN.css`
        background: ${c};
        width: ${160}px;
      `,hasShadow:!1,hasBorder:!c,paddingSize:"s",onClick:u,element:"div"},s.a.createElement(pG,{direction:"column",justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{"data-test-subj":`coverageOverviewTechniqueTitle-${e.id}`,size:"xs"},s.a.createElement("h4",null,e.name)),d),i&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(iG,{enabledRules:e.enabledRules.length,disabledRules:e.disabledRules.length}))))},dG=Object(r.memo)(uG);var pG=ae()(ee.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1c69mn4-0"})({height:"100%"});const mG=({technique:e})=>{const[{loading:t,canUserCRUD:a}]=Object(kt.b)(),[n,i]=Object(r.useState)(!1),[o,l]=Object(r.useState)(!1),c=Object(r.useCallback)((()=>i(!1)),[]),u=Object(r.useMemo)((()=>!a||0===e.disabledRules.length),[a,e.disabledRules.length]),d=Object(r.useMemo)((()=>o||t),[o,t]),{state:{showExpandedCells:p,filter:{activity:m}},actions:{enableAllDisabled:f}}=ZQ(),b=Object(r.useMemo)((()=>((e,t)=>{const a=new Set;for(const n of e.subtechniques)t&&!t.includes(TD.b.Enabled)||!n.enabledRules.length||a.add(n.id),t&&!t.includes(TD.b.Disabled)||!n.disabledRules.length||a.add(n.id);return a.size})(e,m)),[m,e]),g=Object(r.useCallback)((async()=>{l(!0);const t=e.disabledRules.map((e=>e.id));await f(t),l(!1),c()}),[c,f,e.disabledRules]),y=s.a.createElement(dG,{setIsPopoverOpen:i,isPopoverOpen:n,technique:e,isExpanded:p,coveredSubtechniques:b}),h=Object(r.useMemo)((()=>s.a.createElement(ee.EuiText,{color:"success",size:"s"},s.a.createElement("h4",null,KQ.d(b,e.subtechniques.length)))),[b,e.subtechniques.length]),v=Object(r.useMemo)((()=>e.enabledRules.map((e=>({label:s.a.createElement(tv,{name:e.name,id:e.id}),color:"primary"})))),[e.enabledRules]),E=Object(r.useMemo)((()=>e.disabledRules.map((e=>({label:s.a.createElement(tv,{name:e.name,id:e.id}),color:"primary"})))),[e.disabledRules]),x=Object(r.useMemo)((()=>s.a.createElement(oG,{listTitle:KQ.u,listLength:e.enabledRules.length})),[e.enabledRules.length]),j=Object(r.useMemo)((()=>s.a.createElement(oG,{listTitle:KQ.s,listLength:e.disabledRules.length})),[e.disabledRules.length]);return s.a.createElement(ee.EuiPopover,{button:y,isOpen:n,closePopover:c,anchorPosition:"rightCenter","data-test-subj":"coverageOverviewPopover",ownFocus:!1},s.a.createElement(ee.EuiPopoverTitle,{className:mN.css`
          min-width: 30em;
        `},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexStart",direction:"column"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiButtonEmpty,{flush:"left",iconType:"popout",iconSide:"right",href:e.reference,target:"_blank"},s.a.createElement(ee.EuiText,null,s.a.createElement("h3",null,e.name)))),s.a.createElement(ee.EuiFlexItem,null,h))),s.a.createElement("div",{className:Object(mN.cx)(Object(mN.css)({maxHeight:"40em",padding:"5px 0px"}),"eui-yScrollWithShadows")},s.a.createElement(ee.EuiAccordion,{id:"enabledRulesListAccordion",initialIsOpen:e.enabledRules.length>0,buttonContent:x},s.a.createElement(ee.EuiListGroup,{"data-test-subj":"coverageOverviewEnabledRulesList",flush:!0,listItems:v,size:"s"})),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiAccordion,{id:"disabledRulesListAccordion",initialIsOpen:e.disabledRules.length>0,buttonContent:j},s.a.createElement(ee.EuiListGroup,{"data-test-subj":"coverageOverviewDisabledRulesList",flush:!0,listItems:E,size:"s"})),s.a.createElement(ee.EuiSpacer,{size:"s"})),s.a.createElement(ee.EuiPopoverFooter,null,s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiButton,{"data-test-subj":"enableAllDisabledButton",isLoading:d,disabled:u,onClick:g,size:"s",iconType:"checkInCircleFilled"},KQ.w)))))},fG=Object(r.memo)(mG),bG=({label:e,color:t})=>s.a.createElement(yG,{size:"xs",element:"span",icon:s.a.createElement(hG,{label:e,iconType:"empty",size:"s",$_css:t,$_css2:null!=t?"none":void 0})},e),gG=()=>{const e=Object(r.useMemo)((()=>YQ.map((({threshold:e,color:t},a,n)=>s.a.createElement(bG,{label:`${0===a?`>${e}`:`${e}-${n[a-1].threshold}`} ${KQ.m}`,key:a,color:t})))),[]);return s.a.createElement(vG,{hasBorder:!0,$_css3:"380px"},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("h4",null,KQ.o)),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("small",null,KQ.n))),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xs",wrap:!0},e,s.a.createElement(bG,{label:`0 ${KQ.m}`})))};var yG=ae()(ee.EuiFacetButton).withConfig({displayName:"_StyledEuiFacetButton",componentId:"sc-1tbv5az-0"})({padding:0}),hG=ae()(ee.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-1tbv5az-1"})((e=>({background:e.$_css,boxShadow:e.$_css2}))),vG=ae()(ee.EuiPanel).withConfig({displayName:"_StyledEuiPanel",componentId:"sc-1tbv5az-2"})((e=>({maxWidth:e.$_css3})));const EG=({selected:e,onChange:t,isLoading:a})=>{const[n,i]=Object(r.useState)(!1),o=Object(r.useCallback)((()=>{i(!n)}),[n]),l=Object(r.useMemo)((()=>e.length),[e]),c=cG(XQ,e),u=Object(r.useCallback)((e=>{const a=lG(e);t(a)}),[t]),d=Object(r.useCallback)((()=>{t([])}),[t]),p=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFilterButton,{"data-test-subj":"coverageOverviewRuleActivityFilterButton",isLoading:a,iconType:"arrowDown",onClick:o,isSelected:n,hasActiveFilters:l>0,numActiveFilters:l},KQ.p)),[n,l,o,a]);return s.a.createElement(jG,null,s.a.createElement(ee.EuiPopover,{id:"ruleActivityFilterPopover",button:p,isOpen:n,closePopover:()=>{i(!1)},panelPaddingSize:"none"},s.a.createElement(ee.EuiPopoverTitle,{paddingSize:"s"},KQ.l),s.a.createElement(ee.EuiSelectable,{"data-test-subj":"coverageOverviewFilterList",options:c,onChange:u,renderOption:e=>eG[e.label]},(e=>s.a.createElement(SG,null,e))),s.a.createElement(ee.EuiPopoverFooter,{paddingSize:"xs"},s.a.createElement(OG,{iconType:"cross",color:"danger",size:"xs",isDisabled:0===l,onClick:d},KQ.k))))},xG=s.a.memo(EG);var jG=ae()(ee.EuiFilterGroup).withConfig({displayName:"_StyledEuiFilterGroup",componentId:"sc-1q2ahpl-0"})(["width:","px;"],JQ),SG=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1q2ahpl-1"})(["width:","px;"],JQ),OG=ae()(ee.EuiButtonEmpty).withConfig({displayName:"_StyledEuiButtonEmpty",componentId:"sc-1q2ahpl-2"})(["width:100%;"]);const kG=({selected:e,onChange:t,isLoading:a})=>{const[n,i]=Object(r.useState)(!1),o=Object(r.useCallback)((()=>{i(!n)}),[n]),l=Object(r.useMemo)((()=>e.length),[e]),c=cG(tG,e),u=Object(r.useCallback)((e=>{const a=lG(e);t(a)}),[t]),d=Object(r.useCallback)((()=>{t([])}),[t]),p=Object(r.useMemo)((()=>s.a.createElement(ee.EuiFilterButton,{"data-test-subj":"coverageOverviewRuleSourceFilterButton",isLoading:a,iconType:"arrowDown",onClick:o,isSelected:n,hasActiveFilters:l>0,numActiveFilters:l},KQ.q)),[n,l,o,a]);return s.a.createElement(TG,null,s.a.createElement(ee.EuiPopover,{id:"ruleSourceFilterPopover",button:p,isOpen:n,closePopover:()=>{i(!1)},panelPaddingSize:"none"},s.a.createElement(ee.EuiPopoverTitle,{paddingSize:"s"},KQ.l),s.a.createElement(ee.EuiSelectable,{"data-test-subj":"coverageOverviewFilterList",options:c,onChange:u,renderOption:e=>aG[e.label]},(e=>s.a.createElement(IG,null,e))),s.a.createElement(ee.EuiPopoverFooter,{paddingSize:"xs"},s.a.createElement(CG,{iconType:"cross",color:"danger",size:"xs",isDisabled:0===l,onClick:d},KQ.k))))},wG=s.a.memo(kG);var TG=ae()(ee.EuiFilterGroup).withConfig({displayName:"_StyledEuiFilterGroup",componentId:"sc-1mn2kfe-0"})(["width:","px;"],JQ),IG=ae()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1mn2kfe-1"})(["width:","px;"],JQ),CG=ae()(ee.EuiButtonEmpty).withConfig({displayName:"_StyledEuiButtonEmpty",componentId:"sc-1mn2kfe-2"})(["width:100%;"]);const MG=()=>{var e,t;const{state:{filter:a,isLoading:n,showExpandedCells:i},actions:{setShowExpandedCells:o,setRuleActivityFilter:l,setRuleSourceFilter:c,setRuleSearchFilter:u}}=ZQ(),d=Object(r.useCallback)((({queryText:e})=>{u(e)}),[u]);return s.a.createElement(ee.EuiPanel,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(AG,null,s.a.createElement(xG,{onChange:l,isLoading:n,selected:null!==(e=a.activity)&&void 0!==e?e:[]}),s.a.createElement(wG,{onChange:c,isLoading:n,selected:null!==(t=a.source)&&void 0!==t?t:[]})),s.a.createElement(ee.EuiFlexGroup,{alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiSearchBar,{box:{placeholder:KQ.r,"data-test-subj":"coverageOverviewFilterSearchBar"},onChange:d})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFilterGroup,null,s.a.createElement(ee.EuiFilterButton,{withNext:!0,hasActiveFilters:!i,onClick:()=>o(!1)},KQ.a),s.a.createElement(ee.EuiFilterButton,{hasActiveFilters:i,onClick:()=>o(!0)},KQ.x))))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(gG,null))))},_G=Object(r.memo)(MG);var AG=ae()(ee.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-6bjtg1-0"})(["flex-grow:0;"]);const FG=()=>s.a.createElement(oo,{title:KQ.b,subtitle:s.a.createElement(ee.EuiText,{color:"subdued",size:"s"},s.a.createElement("span",null,KQ.g)," ",s.a.createElement(ks,null))}),PG=s.a.memo(FG),DG=()=>{const{state:{data:e}}=ZQ();return s.a.createElement(s.a.Fragment,null,s.a.createElement(PG,null),s.a.createElement(_G,null),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m",className:"eui-xScroll"},null==e?void 0:e.mitreTactics.map((e=>s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":`coverageOverviewTacticGroup-${e.id}`,direction:"column",key:e.id,gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(sG,{tactic:e})),e.techniques.map(((e,t)=>s.a.createElement(ee.EuiFlexItem,{grow:!1,key:`${e.id}-${t}`},s.a.createElement(fG,{technique:e})))))))))},NG=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(WQ,null,s.a.createElement(S.a,{"data-test-subj":"coverageOverviewPage"},s.a.createElement(DG,null))),s.a.createElement(_,{pageName:P.a.coverageOverview})),RG=[{path:"/rules/id/:detailName/edit",main:gQ,exact:!0},{path:`/rules/id/:detailName/:tabName(${wh.b.alerts}|${wh.b.exceptions}|${wh.b.endpointExceptions}|${wh.b.executionResults}|${wh.b.executionEvents})`,main:oQ,exact:!0},{path:"/rules/create",main:q$,exact:!0},{path:`/rules/:tabName(${zD.management}|${zD.monitoring}|${zD.updates})`,main:WR,exact:!0},{path:"/rules/add_rules",main:zQ,exact:!0}],LG=()=>(Yl(UA),s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.rules},s.a.createElement(K.c,null,s.a.createElement(K.a,{path:"/rules/id/:detailName",exact:!0,render:({match:{params:{detailName:e}},location:t})=>s.a.createElement(k.Redirect,{to:{...t,pathname:`/rules/id/${e}/${wh.b.alerts}`,search:t.search}})}),s.a.createElement(K.a,{path:"/rules",exact:!0},s.a.createElement(k.Redirect,{to:`/rules/${zD.management}`})),RG.map((e=>{var t;return s.a.createElement(K.a,{key:`rules-route-${e.path}`,path:e.path,exact:null!==(t=null==e?void 0:e.exact)&&void 0!==t&&t},s.a.createElement(e.main,null))})),s.a.createElement(K.a,{component:J.a}),s.a.createElement(_,{pageName:l.yc.rules}))))),BG=s.a.memo(LG),zG=[{path:l.nc,component:()=>{var e;const{links:t=[],categories:a=[]}=null!==(e=Object(vT.c)(uM.SecurityPageName.rulesLanding))&&void 0!==e?e:{},n=Object(ft.a)();return s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:uM.SecurityPageName.rulesLanding},s.a.createElement(S.a,null,s.a.createElement(to,{title:qQ}),s.a.createElement(ee.EuiSpacer,{size:"xl"}),s.a.createElement(gT,{links:t,categories:a,onLinkClick:jT,urlState:n}),s.a.createElement(_,{pageName:uM.SecurityPageName.rulesLanding}))))}},{path:l.oc,component:BG},{path:l.t,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.coverageOverview},s.a.createElement(NG,null)))}];var qG=a(739),$G=a(244),VG=a(466),UG=a(327),HG=a(585);const QG=ae.a.div.withConfig({displayName:"TimelinesContainer",componentId:"sc-7jial6-0"})(["width:100%;"]),GG=()=>{const{tabName:e}=Object(k.useParams)(),[t,a]=Object(r.useState)(!1),n=Object(r.useCallback)((()=>{a(!0)}),[a]),{indicesExist:i}=Object(E.d)(),o=!!Object(h.i)().services.application.capabilities.siem.crud;return s.a.createElement(s.a.Fragment,null,i?s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,null,s.a.createElement(oo,{title:HG.d},o&&s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiButton,{iconType:"indexOpen",onClick:n,"data-test-subj":"open-import-data-modal-btn"},HG.a)),e===Lf.l.default?s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(UG.c,{timelineId:g.c.active,outline:!0,"data-test-subj":"create-default-btn"})):s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(VG.a,{outline:!0,title:$G.g,"data-test-subj":"create-template-btn"})))),s.a.createElement(QG,{"data-test-subj":"timelines-container"},s.a.createElement(qG.a,{defaultPageSize:10,isModal:!1,importDataModalToggle:t&&o,setImportDataModalToggle:a,title:HG.b,"data-test-subj":"stateful-open-timeline"})))):s.a.createElement(co.a,null),s.a.createElement(_,{pageName:P.a.timelines}))},WG=s.a.memo(GG),ZG=`${l.Ac}/:tabName(${Lf.l.default}|${Lf.l.template})`,KG=`${l.Ac}/${Lf.l.default}`,JG=s.a.memo((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{exact:!0,path:ZG},s.a.createElement(WG,null)),s.a.createElement(K.a,{path:l.Ac,render:({location:{search:e=""}})=>s.a.createElement(k.Redirect,{to:`${KG}${Object(A_.a)(e)}`})}))));JG.displayName="Timelines";const YG=[{path:l.Ac,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.timelines},s.a.createElement(JG,null)))}];var XG=a(763);const eW={timelineById:{},showCallOutUnauthorizedMsg:!1,insertTimeline:null},tW=Object(nt.reducerWithInitialState)(eW).case(D.addTimeline,((e,{id:t,timeline:a,resolveTimelineConfig:n})=>({...e,timelineById:Object(XG.e)({id:t,timeline:a,resolveTimelineConfig:n,timelineById:e.timelineById})}))).case(D.createTimeline,((e,{id:t,timelineType:a=Lf.l.default,...n})=>({...e,timelineById:Object(XG.a)({id:t,timelineById:e.timelineById,timelineType:a,...n})}))).case(D.addNote,((e,{id:t,noteId:a})=>({...e,timelineById:Object(XG.b)({id:t,noteId:a,timelineById:e.timelineById})}))).case(D.addNoteToEvent,((e,{id:t,noteId:a,eventId:n})=>({...e,timelineById:Object(XG.c)({id:t,noteId:a,eventId:n,timelineById:e.timelineById})}))).case(D.addProvider,((e,{id:t,providers:a})=>({...e,timelineById:Object(XG.d)({id:t,providers:a,timelineById:e.timelineById})}))).case(D.applyKqlFilterQuery,((e,{id:t,filterQuery:a})=>({...e,timelineById:Object(XG.g)({id:t,filterQuery:a,timelineById:e.timelineById})}))).case(D.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(XG.I)({id:t,show:a,timelineById:e.timelineById})}))).case(D.updateGraphEventId,((e,{id:t,graphEventId:a})=>({...e,timelineById:Object(XG.w)({id:t,graphEventId:a,timelineById:e.timelineById})}))).case(D.updateSessionViewConfig,((e,{id:t,sessionViewConfig:a})=>({...e,timelineById:Object(XG.H)({id:t,sessionViewConfig:a,timelineById:e.timelineById})}))).case(D.pinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(XG.i)({id:t,eventId:a,timelineById:e.timelineById})}))).case(D.removeProvider,((e,{id:t,providerId:a,andProviderId:n})=>({...e,timelineById:Object(XG.k)({id:t,providerId:a,timelineById:e.timelineById,andProviderId:n})}))).case(D.startTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!0}}}))).case(D.endTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!1}}}))).case(D.setExcludedRowRendererIds,((e,{id:t,excludedRowRendererIds:a})=>({...e,timelineById:Object(XG.q)({id:t,excludedRowRendererIds:a,timelineById:e.timelineById})}))).case(D.updateTimeline,((e,{id:t,timeline:a})=>({...e,timelineById:{...e.timelineById,[t]:a}}))).case(D.unPinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(XG.p)({id:t,eventId:a,timelineById:e.timelineById})}))).case(D.updateIsFavorite,((e,{id:t,isFavorite:a})=>({...e,timelineById:Object(XG.x)({id:t,isFavorite:a,timelineById:e.timelineById})}))).case(D.updateKqlMode,((e,{id:t,kqlMode:a})=>({...e,timelineById:Object(XG.z)({id:t,kqlMode:a,timelineById:e.timelineById})}))).case(D.updateTitleAndDescription,((e,{id:t,title:a,description:n})=>({...e,timelineById:Object(XG.J)({id:t,title:a,description:n,timelineById:e.timelineById})}))).case(D.updateProviders,((e,{id:t,providers:a})=>({...e,timelineById:Object(XG.F)({id:t,providers:a,timelineById:e.timelineById})}))).case(D.updateRange,((e,{id:t,start:a,end:n})=>({...e,timelineById:Object(XG.G)({id:t,start:a,end:n,timelineById:e.timelineById})}))).case(D.updateDataProviderEnabled,((e,{id:t,enabled:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(XG.B)({id:t,enabled:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(D.updateDataProviderExcluded,((e,{id:t,excluded:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(XG.C)({id:t,excluded:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(D.dataProviderEdited,((e,{andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,value:o})=>({...e,timelineById:Object(XG.D)({andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,timelineById:e.timelineById,value:o})}))).case(D.updateDataProviderType,((e,{id:t,type:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(XG.E)({id:t,type:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(D.showCallOutUnauthorizedMsg,(e=>({...e,showCallOutUnauthorizedMsg:!0}))).case(D.setSavedQueryId,((e,{id:t,savedQueryId:a})=>({...e,timelineById:Object(XG.s)({id:t,savedQueryId:a,timelineById:e.timelineById})}))).case(D.setFilters,((e,{id:t,filters:a})=>({...e,timelineById:Object(XG.r)({id:t,filters:a,timelineById:e.timelineById})}))).case(D.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(D.updateDataView,((e,{id:t,dataViewId:a,indexNames:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],dataViewId:a,indexNames:n}}}))).case(D.setActiveTabTimeline,((e,{id:t,activeTab:a,scrollToTop:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],activeTab:a,prevActiveTab:e.timelineById[t].activeTab,scrollToTop:n?{timestamp:Math.floor(Date.now()/1e3)}:void 0}}}))).case(D.toggleModalSaveTimeline,((e,{id:t,showModalSaveTimeline:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],showSaveModal:a}}}))).case(D.updateEqlOptions,((e,{id:t,field:a,value:n})=>{var i;return{...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],eqlOptions:{...null!==(i=e.timelineById[t].eqlOptions)&&void 0!==i?i:{},[a]:n}}}}})).case(D.toggleDetailPanel,((e,t)=>({...e,timelineById:{...e.timelineById,[t.id]:{...e.timelineById[t.id],expandedDetail:{...e.timelineById[t.id].expandedDetail,...Object(XG.v)(t)}}}}))).case(D.setEventsLoading,((e,{id:t,eventIds:a,isLoading:n})=>({...e,timelineById:Object(XG.n)({id:t,eventIds:a,timelineById:e.timelineById,isLoading:n})}))).case(D.removeColumn,((e,{id:t,columnId:a})=>({...e,timelineById:Object(XG.j)({id:t,columnId:a,timelineById:e.timelineById})}))).case(D.upsertColumn,((e,{column:t,id:a,index:n})=>({...e,timelineById:Object(XG.K)({column:t,id:a,index:n,timelineById:e.timelineById})}))).case(D.updateColumns,((e,{id:t,columns:a})=>({...e,timelineById:Object(XG.t)({id:t,columns:a,timelineById:e.timelineById})}))).case(D.updateIsLoading,((e,{id:t,isLoading:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isLoading:a}}}))).case(D.updateSort,((e,{id:t,sort:a})=>({...e,timelineById:Object(XG.u)({id:t,sort:a,timelineById:e.timelineById})}))).case(D.setSelected,((e,{id:t,eventIds:a,isSelected:n,isSelectAllChecked:i})=>({...e,timelineById:Object(XG.o)({id:t,eventIds:a,timelineById:e.timelineById,isSelected:n,isSelectAllChecked:i})}))).case(D.clearSelected,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],selectedEventIds:{},isSelectAllChecked:!1}}}))).case(D.setEventsDeleted,((e,{id:t,eventIds:a,isDeleted:n})=>({...e,timelineById:Object(XG.l)({id:t,eventIds:a,timelineById:e.timelineById,isDeleted:n})}))).case(D.initializeTimelineSettings,((e,{id:t,...a})=>({...e,timelineById:Object(XG.m)({id:t,timelineById:e.timelineById,timelineSettingsProps:a})}))).case(D.updateItemsPerPage,((e,{id:t,itemsPerPage:a})=>({...e,timelineById:Object(XG.y)({id:t,itemsPerPage:a,timelineById:e.timelineById})}))).case(D.updateItemsPerPageOptions,((e,{id:t,itemsPerPageOptions:a})=>({...e,timelineById:Object(XG.A)({id:t,itemsPerPageOptions:a,timelineById:e.timelineById})}))).case(D.applyDeltaToColumnWidth,((e,{id:t,columnId:a,delta:n})=>({...e,timelineById:Object(XG.f)({id:t,columnId:a,delta:n,timelineById:e.timelineById})}))).case(D.clearEventsDeleted,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],deletedEventIds:[]}}}))).case(D.clearEventsLoading,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],loadingEventIds:[]}}}))).case(D.updateSavedSearchId,((e,{id:t,savedSearchId:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],savedSearchId:a}}}))).case(D.initializeSavedSearch,((e,{id:t,savedSearch:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],savedSearch:a}}}))).case(D.updateSavedSearch,((e,{id:t,savedSearch:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],savedSearch:a}}}))).case(D.setIsDiscoverSavedSearchLoaded,((e,{id:t,isDiscoverSavedSearchLoaded:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isDiscoverSavedSearchLoaded:a}}}))).case(D.setDataProviderVisibility,((e,{id:t,isDataProviderVisible:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isDataProviderVisible:a}}}))).case(D.setChanged,((e,{id:t,changed:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],changed:a}}}))).build();var aW=a(178),nW=a(200),iW=a(1295);const rW=Object(r.memo)((({hasNoPolicyData:e,metadataTransformStats:t})=>{const[a,n]=Object(r.useState)(!1),[i,o]=Object(r.useState)(!0),{services:u}=Object(h.i)(),d=Object(c.useDispatch)();Object(r.useEffect)((()=>{i&&!e&&(d({type:"loadMetadataTransformStats"}),o(!1))}),[d,e,i]),Object(r.useEffect)((()=>{const e=t.some((e=>l.Nc.has(null==e?void 0:e.state)));n(e)}),[t]);const p=Object(r.useCallback)((()=>{n(!1)}),[]),m=Object(r.useMemo)((()=>t.reduce(((e,t)=>(l.Nc.has(t.state)&&e.push(t.id),e)),[]).join(", ")),[t]),f=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.message",defaultMessage:"A required transform, {transformId}, is currently failing. Most of the time this can be fixed by {transformsPage}. For additional help, please visit the {docsPage}",values:{transformId:m||nW.D,transformsPage:s.a.createElement(iW.a,{"data-test-subj":"failed-transform-restart-link",appId:"management",appPath:"/data/transform"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.restartLink",defaultMessage:"restarting the transform"})),docsPage:s.a.createElement(ee.EuiLink,{"data-test-subj":"failed-transform-docs-link",href:u.docLinks.links.endpoints.troubleshooting,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.docsLink",defaultMessage:"troubleshooting documentation"}))}}),s.a.createElement(ee.EuiSpacer,{size:"s"}))),[m,u.docLinks.links.endpoints.troubleshooting]);return a?s.a.createElement(s.a.Fragment,null,s.a.createElement(ns,{message:{id:"endpoints-list-transform-failed",type:"warning",title:Y.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.title",{defaultMessage:"Required transform failed"}),description:f},dismissButtonText:Y.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.dismiss",{defaultMessage:"Dismiss"}),onDismiss:p,showDismissButton:!0}),s.a.createElement(ee.EuiSpacer,{size:"m"})):s.a.createElement(s.a.Fragment,null)}));rW.displayName="TransformFailedCallout";var sW=a(887);const oW=Object(r.memo)((({name:e,href:t,route:a,dataTestSubj:n})=>{const i=Object(sW.a)(a);return s.a.createElement(ee.EuiLink,{"data-test-subj":n,className:"eui-displayInline eui-textTruncate",href:t,onClick:i},e)}));oW.displayName="EndpointListNavLink";var lW=a(895),cW=a(691),uW=a(436),dW=a(744),pW=a(1419),mW=a(1421);const fW=Y.i18n.translate("xpack.securitySolution.endpointDetails.overview",{defaultMessage:"Overview"}),bW={tabTitle:Y.i18n.translate("xpack.securitySolution.endpointDetails.responseActionsHistory",{defaultMessage:"Response actions history"}),LogEntry:{endOfLog:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.endOfLog",{defaultMessage:"Nothing more to show"}),dateRangeMessage:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.dateRangeMessage.title",{defaultMessage:"Nothing to show for selected date range, please select another and try again."}),emptyState:{title:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.title",{defaultMessage:"No logged actions"}),body:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.body",{defaultMessage:"No actions have been logged for this endpoint."})},action:{isolatedAction:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.isolated",{defaultMessage:"submitted request: Isolate host"}),unisolatedAction:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.unisolated",{defaultMessage:"submitted request: Release host"}),failedEndpointReleaseAction:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointReleaseAction",{defaultMessage:"failed to submit request: Release host"}),failedEndpointIsolateAction:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointIsolateAction",{defaultMessage:"failed to submit request: Isolate host"})},response:{isolationCompletedAndSuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndSuccessful",{defaultMessage:"Host isolation request completed by Endpoint"}),isolationCompletedAndUnsuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndUnsuccessful",{defaultMessage:"Host isolation request completed by Endpoint with errors"}),unisolationCompletedAndSuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndSuccessful",{defaultMessage:"Release request completed by Endpoint"}),unisolationCompletedAndUnsuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndUnsuccessful",{defaultMessage:"Release request completed by Endpoint with errors"}),isolationSuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationSuccessful",{defaultMessage:"Host isolation request received by Endpoint"}),isolationFailed:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationFailed",{defaultMessage:"Host isolation request received by Endpoint with errors"}),unisolationSuccessful:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationSuccessful",{defaultMessage:"Release host request received by Endpoint"}),unisolationFailed:Y.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationFailed",{defaultMessage:"Release host request received by Endpoint with errors"})}}};var gW=a(1163);const yW=Object(r.memo)((({hostMetadata:e})=>{const t=Object(cW.a)(e),[a,n]=Object(r.useState)(!1),i=Object(r.useCallback)((()=>{n(!1)}),[]),o=Object(r.useMemo)((()=>t.map((e=>s.a.createElement(gW.a,bo()({},e,{onClick:t=>{i(),e.onClick&&e.onClick(t)}}))))),[i,t]),l=Object(r.useMemo)((()=>s.a.createElement(ee.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"endpointDetailsActionsButton",onClick:()=>{n(!a)}},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.detailsActions.buttonLabel",defaultMessage:"Take action"}))),[a]);return s.a.createElement(ee.EuiPopover,{id:"endpointDetailsActionsPanel",button:l,isOpen:a,closePopover:i,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"endpointDetailsActionsPopover"},s.a.createElement(ee.EuiContextMenuPanel,{size:"s",items:o}))}));yW.displayName="ActionMenu";var hW=a(1317),vW=a(892);const EW=Object(r.memo)((({hostMeta:e})=>{const t=Object(k.useHistory)(),a=Object(c.useDispatch)(),{show:n,...i}=Object(cW.b)(uW.uiQueryParams),o=Object(_g.b)(e),l=Object(cW.b)(uW.getIsIsolationRequestPending),u=Object(cW.b)(uW.getWasIsolationRequestSuccessful),d=Object(cW.b)(uW.getIsolationRequestError),[p,m]=Object(r.useState)({comment:""}),f=o?vW.d:vW.b,b=Object(r.useCallback)((()=>{t.push(Object(O.d)({name:"endpointDetails",...i,selected_endpoint:e.agent.id}))}),[t,e.agent.id,i]),g=Object(r.useCallback)((()=>{a({type:"endpointIsolationRequest",payload:{type:o?"unisolate":"isolate",data:{endpoint_ids:[e.agent.id],comment:p.comment}}})}),[a,p.comment,e.agent.id,o]),y=Object(r.useCallback)((e=>{m((t=>({...t,...e})))}),[]);return s.a.createElement(s.a.Fragment,null,u&&s.a.createElement(vW.c,{hostName:e.host.name,isolateAction:o?"unisolateHost":"isolateHost"}),s.a.createElement(ee.EuiFlyoutBody,null,u?s.a.createElement(vW.a,{onClick:b,buttonText:Y.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.successProceedButton",{defaultMessage:"Return to endpoint details"})}):s.a.createElement(ee.EuiForm,{isInvalid:!!d,error:null==d?void 0:d.message,"data-test-subj":"endpointIsolationForm"},s.a.createElement(f,{comment:p.comment,isLoading:l,hostName:e.host.name,onCancel:b,onConfirm:g,onChange:y}))))}));EW.displayName="EndpointIsolateFlyoutPanel";var xW=a(1334);const jW=(e,t)=>!(!t||!e.id||e.id===t.endpoint.id&&t.agent.configured.id===t.agent.applied.id&&e.version>=t.agent.applied.revision&&e.version>=t.agent.configured.revision&&e.endpoint_policy_version>=t.endpoint.revision);var SW=a(1149);const OW=Object(r.memo)((({policyId:e,backLink:t,children:a,missingPolicies:n={},...i})=>{const{getAppUrl:o}=Object(cE.a)(),{toRoutePath:l,toRouteUrl:c}=Object(r.useMemo)((()=>{const a=e?Object(O.j)(e):"";return{toRoutePath:t?{pathname:a,state:{backLink:t}}:a,toRouteUrl:o({path:a})}}),[e,o,t]),u=Object(sW.a)(l);return!e||n[e]?s.a.createElement("span",{className:i.className,"data-test-subj":i["data-test-subj"]},a,s.a.createElement(ee.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},s.a.createElement(ee.EuiIcon,{size:"m",type:"warning",color:"warning"}),"Â ",s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyNotFound",defaultMessage:"Policy not found!"}))):s.a.createElement(ee.EuiLink,bo()({href:c,onClick:u},i),a)}));OW.displayName="EndpointPolicyLink";const kW=s.a.memo((({style:e,...t})=>s.a.createElement(ee.EuiText,bo()({color:"subdued",size:"xs",className:"eui-textNoWrap eui-displayInlineBlock",style:e},t),s.a.createElement(ee.EuiIcon,{className:"eui-alignTop",size:"m",type:"warning",color:"warning"}),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.outOfDateLabel",defaultMessage:"Out-of-date"}))));kW.displayName="OutOfDate";const wW=ae.a.div.withConfig({displayName:"EndpointDetailsContentStyled",componentId:"sc-16oisg3-0"})([".policyLineText{padding-right:5px;}"]),TW=({children:e})=>s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("h5",null,e)),IW=Object(r.memo)((({hostInfo:e,policyInfo:t})=>{const a=Object(cW.b)(uW.uiQueryParams),n=Object(r.useMemo)((()=>e.metadata.Endpoint.policy.applied.status),[e]),i=Object(cW.b)(uW.getEndpointPendingActionsCallback),o=Object(cW.b)(uW.nonExistingPolicies),l=Object(r.useMemo)((()=>{const{selected_endpoint:t,show:n,...i}=a;return Object(O.d)({name:"endpointPolicyResponse",...i,selected_endpoint:e.metadata.agent.id})}),[e.metadata.agent.id,a]),c=Object(sW.a)(l),u=Object(r.useMemo)((()=>[{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.os",defaultMessage:"OS"})),description:s.a.createElement(ee.EuiText,{size:"xs"},e.metadata.host.os.full)},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.agentStatus",defaultMessage:"Agent Status"})),description:s.a.createElement(lW.a,{pendingActions:i(e.metadata.agent.id),endpointHostInfo:e})},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.lastSeen",defaultMessage:"Last Seen"})),description:s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement(Yc.a,{value:e.last_checkin||e.metadata["@timestamp"],fieldName:""}))},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy",defaultMessage:"Policy"})),description:s.a.createElement(ee.EuiText,{size:"xs",className:"eui-textBreakWord"},s.a.createElement(OW,{policyId:e.metadata.Endpoint.policy.applied.id,"data-test-subj":"policyDetailsValue",className:"policyLineText",missingPolicies:o},e.metadata.Endpoint.policy.applied.name),e.metadata.Endpoint.policy.applied.endpoint_policy_version&&s.a.createElement(ee.EuiText,{color:"subdued",size:"xs",className:"eui-displayInlineBlock eui-textNoWrap policyLineText","data-test-subj":"policyDetailsRevNo"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.metadata.Endpoint.policy.applied.endpoint_policy_version}})),jW(e.metadata.Endpoint.policy.applied,t)&&s.a.createElement(kW,null))},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatus",defaultMessage:"Policy Status"})),description:s.a.createElement(ee.EuiHealth,{"data-test-subj":`policyStatusValue-${n}`,color:SW.b[n]||"default"},s.a.createElement(ee.EuiLink,{onClick:c,"data-test-subj":"policyStatusValue"},s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatusValue",defaultMessage:"{policyStatus, select, success {Success} warning {Warning} failure {Failed} other {Unknown}}",values:{policyStatus:n}}))))},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.endpointVersion",defaultMessage:"Endpoint Version"})),description:s.a.createElement(ee.EuiText,{size:"xs"},e.metadata.agent.version)},{title:s.a.createElement(TW,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.ipAddress",defaultMessage:"IP Address"})),description:s.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"s"},e.metadata.host.ip.map(((e,t)=>s.a.createElement(ee.EuiFlexItem,{key:t},s.a.createElement(ee.EuiText,{size:"xs"},e)))))}]),[e,i,o,t,n,c]);return s.a.createElement(wW,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiDescriptionList,{columnWidths:[1,3],compressed:!0,rowGutterSize:"m",type:"column",listItems:u,"data-test-subj":"endpointDetailsList"}))}));IW.displayName="EndpointDetailsContent";const CW=Object(r.memo)((()=>{var e,t,a,n;const i=Object(h.m)(),o=Object(cW.b)(uW.uiQueryParams),{data:l,error:c,isFetching:u}=Object(dW.c)(null!==(e=o.selected_endpoint)&&void 0!==e?e:""),d=Object(cW.b)(uW.showView),{canAccessEndpointActionsLogManagement:p}=Object(Dt.a)().endpointPrivileges,m=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSkeletonText,{lines:3}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiSkeletonText,{lines:3}))),[]),f=Object(r.useCallback)((e=>{const t=[{id:hW.b.overview,name:fW,route:Object(O.d)({...o,name:"endpointDetails",selected_endpoint:e}),content:void 0===l?m:s.a.createElement(IW,{hostInfo:l,policyInfo:l.policy_info})}];return p&&t.push({id:hW.b.activityLog,name:bW.tabTitle,route:Object(O.d)({...o,name:"endpointActivityLog",selected_endpoint:e}),content:s.a.createElement(pW.a,{agentIds:e})}),t}),[p,m,l,o]),b="details"===d||"policy_response"===d||"activity_log"===d;return Object(r.useEffect)((()=>{null!==c&&i.addDanger({title:Y.i18n.translate("xpack.securitySolution.endpoint.details.errorTitle",{defaultMessage:"Could not find host"}),text:Y.i18n.translate("xpack.securitySolution.endpoint.details.errorBody",{defaultMessage:"Please exit the flyout and select an available host."})})}),[c,d,i]),s.a.createElement(s.a.Fragment,null,("policy_response"===d||"isolate"===d||"unisolate"===d)&&s.a.createElement(xW.a,{endpointId:null==l||null===(t=l.metadata)||void 0===t?void 0:t.agent.id,hasBorder:!0,hostname:null==l||null===(a=l.metadata)||void 0===a||null===(n=a.host)||void 0===n?void 0:n.hostname,isHostInfoLoading:u}),void 0===l?s.a.createElement(ee.EuiFlyoutBody,null,s.a.createElement(ee.EuiSkeletonText,{lines:3})," ",s.a.createElement(ee.EuiSpacer,{size:"l"})," ",s.a.createElement(ee.EuiSkeletonText,{lines:3})):s.a.createElement(s.a.Fragment,null,("details"===d||"activity_log"===d)&&s.a.createElement(hW.a,{hostname:l.metadata.host.hostname,isHostInfoLoading:u,show:p?d:"details",tabs:f(l.metadata.agent.id)}),"policy_response"===d&&s.a.createElement(MW,{hostMeta:l.metadata}),("isolate"===d||"unisolate"===d)&&s.a.createElement(EW,{hostMeta:l.metadata}),b&&s.a.createElement(ee.EuiFlyoutFooter,{className:"eui-textRight","data-test-subj":"endpointDetailsFlyoutFooter"},s.a.createElement(yW,{hostMetadata:l.metadata}))))}));CW.displayName="EndpointDetails";const MW=Object(r.memo)((({hostMeta:e})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiFlyoutBody,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutBody",className:"endpointDetailsPolicyResponseFlyoutBody"},s.a.createElement(mW.a,{endpointId:e.agent.id})))));MW.displayName="PolicyResponseFlyoutPanel";const _W=Object(r.memo)((()=>{const e=Object(k.useHistory)(),t=Object(cW.b)(uW.uiQueryParams),{selected_endpoint:a,...n}=t,i=Object(r.useCallback)((()=>{const{show:t,...a}=n;e.push(Object(O.e)({name:"endpointList",...a}))}),[e,n]);return s.a.createElement(ee.EuiFlyout,{onClose:i,"data-test-subj":"endpointDetailsFlyout",size:"m",paddingSize:"l",ownFocus:!1},s.a.createElement(CW,null))}));_W.displayName="EndpointDetailsFlyout";var AW=a(186),FW=a(1682),PW=a.n(FW);const DW=Object.freeze({textAlign:"center"}),NW=Object.freeze({maxWidth:550,maxHeight:420}),RW=s.a.memo((()=>{const{services:e}=Object(h.i)();return s.a.createElement(ee.EuiText,{size:"s",color:"subdued","data-test-subj":"noFleetAccess"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.onboarding.enableFleetAccess",defaultMessage:"Deploying Agents for the first time requires Fleet access. For more information, "}),s.a.createElement(ee.EuiLink,{external:!0,href:`${e.docLinks.links.securitySolution.privileges}`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.onboarding.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"})))}));RW.displayName="MissingFleetAccessInfo";const LW=s.a.memo((({loading:e,onActionClick:t,actionDisabled:a,policyEntryPoint:n=!1})=>{const i=Object(h.i)().services.docLinks,{canAccessFleet:r,loading:o}=Object(Dt.a)().endpointPrivileges;return s.a.createElement("div",{"data-test-subj":"emptyPolicyTable"},e?s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):s.a.createElement(ee.EuiFlexGroup,{"data-test-subj":"policyOnboardingInstructions",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiText,null,s.a.createElement("h1",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingTitle",defaultMessage:"Get started with Elastic Defend"}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiText,{size:"s",color:"subdued"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionOne",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiText,{size:"s",color:"subdued"},n?s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromPolicyPage",defaultMessage:"From this page, youâ€™ll be able to view and manage the Elastic Defend Integration policies in your environment running Elastic Defend."}):s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromEndpointPage",defaultMessage:"From this page, youâ€™ll be able to view and manage the hosts in your environment running Elastic Defend."})),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiText,{size:"s",color:"subdued"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionThree",defaultMessage:"To get started, add the Elastic Defend integration to your Agents. For more information, "}),s.a.createElement(ee.EuiLink,{external:!0,href:`${i.links.siem.guide}`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),o&&s.a.createElement(ee.EuiSkeletonText,{lines:1}),!o&&r&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiFlexGroup,null,s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.actionButtonText",defaultMessage:"Add Elastic Defend"}))))),!o&&!r&&s.a.createElement(RW,null)),s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(ee.EuiIcon,{type:PW.a,size:"original",style:NW}))))})),BW=s.a.memo((({loading:e,onActionClick:t,actionDisabled:a,handleSelectableOnChange:n,selectionOptions:i})=>{const o=Object(r.useMemo)((()=>[{title:Y.i18n.translate("xpack.securitySolution.endpoint.list.stepOneTitle",{defaultMessage:"Select the integration you want to use"}),children:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiText,{color:"subdued",size:"m",grow:!1},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepOne",defaultMessage:"Select from existing integrations. This can be changed later."})),s.a.createElement(ee.EuiSpacer,{size:"xxl"}),s.a.createElement(ee.EuiSelectable,{options:i,singleSelection:"always",isLoading:e,height:100,listProps:{bordered:!0,singleSelection:!0},onChange:n,"data-test-subj":"onboardingPolicySelect"},(t=>e?s.a.createElement(ee.EuiSelectableMessage,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.loadingPolicies",defaultMessage:"Loading integrations"})):i.length?t:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noPolicies",defaultMessage:"There are no integrations."}))))},{title:Y.i18n.translate("xpack.securitySolution.endpoint.list.stepTwoTitle",{defaultMessage:"Enroll your agents enabled with Elastic Defend through Fleet"}),status:a?"disabled":"",children:s.a.createElement(ee.EuiFlexGroup,{alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiText,{color:"subdued",size:"m",grow:!1},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepTwo",defaultMessage:"Youâ€™ll be provided with the necessary commands to get started."}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.emptyCreateNewButton",defaultMessage:"Enroll Agent"}))))}]),[i,n,e,a,t]);return s.a.createElement(zW,{loading:e,dataTestSubj:"emptyHostsTable",steps:o,headerComponent:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsPrompt",defaultMessage:"Next step: Enroll an Agent with Elastic Defend"}),bodyComponent:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsInstructions",defaultMessage:"Youâ€™ve added the Elastic Defend integration. Now enroll your agents using the steps below."})})})),zW=s.a.memo((({loading:e,dataTestSubj:t,steps:a,headerComponent:n,bodyComponent:i})=>s.a.createElement("div",{"data-test-subj":t},e?s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"xxl"}),s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",{style:DW},n)),s.a.createElement(ee.EuiSpacer,{size:"xxl"}),s.a.createElement(ee.EuiText,{textAlign:"center",color:"subdued",size:"m"},i),s.a.createElement(ee.EuiSpacer,{size:"xxl"}),a&&s.a.createElement(ee.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiSteps,{steps:a,"data-test-subj":"onboardingSteps"})))))));LW.displayName="PolicyEmptyState",BW.displayName="HostsEmptyState",zW.displayName="ManagementEmptyState";var qW=a(79),$W=a(734),VW=a.n($W);const UW=Object(r.memo)((()=>{const e=Object(k.useHistory)(),{admin_query:t,...a}=Object(cW.b)(uW.uiQueryParams),n=Object(cW.b)(uW.patterns),i=Object(cW.b)(uW.searchBarQuery),o=Object(r.useMemo)((()=>n.map((e=>{return t=e,Object(Pd.all)([t]);var t}))),[n]),l=Object(r.useCallback)((t=>{var n,r;e.push(function(e){return{search:VW.a.stringify(e)}}({...a,page_index:(null===(n=t.query)||void 0===n?void 0:n.query)===i.query?a.page_index:"0",...null!==(r=t.query)&&void 0!==r&&r.query.trim()?{admin_query:Object(tc.encode)(t.query)}:{}}))}),[e,a,i.query]),c=Object(r.useMemo)((()=>new Ho.TimeHistory(new vl.Storage(localStorage))),[]);return s.a.createElement("div",null,n&&n.length>0&&s.a.createElement("div",null,s.a.createElement(qW.SearchBar,{dataTestSubj:"adminSearchBar",query:i,indexPatterns:o,timeHistory:c,onQuerySubmit:l,fillSubmitButton:!0,isLoading:!1,iconType:"search",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0})))}));UW.displayName="AdminSearchBar";var HW=a(1162);const QW=Object(r.memo)((({endpointMetadata:e})=>{const[t,a]=Object(r.useState)(!1),n=Object(cW.a)(e,{isEndpointList:!0}),i=Object(r.useCallback)((()=>a(!1)),[a]),o=Object(r.useCallback)((()=>a(!t)),[t]),l=Object(r.useMemo)((()=>n.map((e=>s.a.createElement(gW.a,bo()({},e,{onClick:t=>{i(),e.onClick&&e.onClick(t)}}))))),[i,n]),c=Object(r.useMemo)((()=>({"data-test-subj":"tableRowActionsMenuPanel"})),[]);return s.a.createElement(ee.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:c,button:s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":"endpointTableRowActions",iconType:"boxesHorizontal",onClick:o,"aria-label":Y.i18n.translate("xpack.securitySolution.endpoint.list.actionmenu",{defaultMessage:"Open"})}),isOpen:t,closePopover:i},s.a.createElement(ee.EuiContextMenuPanel,{items:l}))}));QW.displayName="EndpointTableRowActions";var GW=a(1098),WW=a(1294);const ZW=Object(r.memo)((({backLink:e})=>{const{getAppUrl:t}=Object(h.c)(),a=Object(r.useMemo)((()=>{if(e){const{navigateTo:t,label:a,href:n}=e;return{onBackButtonNavigateTo:t,backButtonLabel:a,backButtonUrl:n}}const a=Object(O.h)();return{backButtonLabel:Y.i18n.translate("xpack.securitySolution.endpoint.list.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:t({path:a}),onBackButtonNavigateTo:[uM.APP_UI_ID,{path:a}]}}),[t,e]);return e?s.a.createElement(WW.a,bo()({},a,{"data-test-subj":"endpointListBackLink"})):null}));ZW.displayName="BackToPolicyListButton";const KW=ae.a.div.withConfig({displayName:"StyledDatePicker",componentId:"sc-iwyqb6-0"})([".euiFormControlLayout--group{background-color:rgba(0,119,204,0.2);}"]),JW={[AW.a.HOSTNAME]:"18%",[AW.a.HOST_STATUS]:"15%",[AW.a.POLICY_NAME]:"20%",[AW.a.POLICY_STATUS]:"150px",[AW.a.HOST_OS_NAME]:"90px",[AW.a.HOST_IP]:"22%",[AW.a.AGENT_VERSION]:"10%",[AW.a.LAST_SEEN]:"15%",actions:"65px"},YW=Object(Ae.createStructuredSelector)(uW),XW={onDoneNavigateTo:[l.l,{path:Object(O.e)({name:"endpointList"})}]},eZ=()=>{const e=Object(k.useHistory)(),{listData:t,pageIndex:a,pageSize:n,sortField:i,sortDirection:o,totalHits:u,listLoading:d,listError:p,uiQueryParams:m,hasSelectedEndpoint:f,policyItems:b,selectedPolicyId:g,policyItemsLoading:h,endpointPackageVersion:v,endpointsExist:E,autoRefreshInterval:x,isAutoRefreshEnabled:j,patternsError:S,metadataTransformStats:w}=Object(cW.b)(YW),T=Object(cW.b)(uW.getEndpointPendingActionsCallback),{canReadEndpointList:I,canAccessFleet:C,canReadPolicyManagement:M,loading:_}=Object(Dt.a)().endpointPrivileges,{search:A}=Object(y.l)(P.a.administration),{search:F}=Object(k.useLocation)(),{state:D={}}=Object(k.useLocation)(),{getAppUrl:N}=Object(cE.a)(),R=Object(c.useDispatch)(),L=u>9999?9999:u,B=Object(r.useMemo)((()=>b&&b.length>0),[b]),z=Object(r.useMemo)((()=>t&&t.length>0),[t]),q=Object(r.useMemo)((()=>({display:E?"flex":"none",maxWidth:200})),[E]),$=Object(r.useMemo)((()=>!(!E||!f&&j)),[E,f,j]),V=Object(r.useMemo)((()=>E?x:aW.a),[E,x]),U=Object(r.useMemo)((()=>E&&!S),[E,S]),H=Object(r.useMemo)((()=>({pageIndex:a,pageSize:n,totalItemCount:L,pageSizeOptions:[...aW.f],showPerPageOptions:!0})),[a,n,L]),Q=Object(r.useCallback)((({page:t,sort:a})=>{const{index:n,size:i}=t;e.push(Object(O.e)({name:"endpointList",...m,page_index:JSON.stringify(n),page_size:JSON.stringify(i),sort_direction:null==a?void 0:a.direction,sort_field:null==a?void 0:a.field}))}),[e,m]),G=Object(r.useMemo)((()=>({onCancelNavigateTo:[l.l,{path:Object(O.e)({name:"endpointList"})}],onCancelUrl:N({path:Object(O.e)({name:"endpointList"})}),onSaveNavigateTo:[l.l,{path:Object(O.e)({name:"endpointList"})}]})),[N]),W=Object(mC.a)("fleet",{path:`/integrations/${v?`/endpoint-${v}`:""}/add-integration`,state:G}),Z=Object(r.useMemo)((()=>{const e=Object(O.e)({name:"endpointList"},F);return{navigateTo:[l.l,{path:e}],label:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.backToListTitle",{defaultMessage:"View all endpoints"}),href:N({path:e})}}),[N,F]),K=Object(r.useCallback)((()=>{R({type:"appRequestedEndpointList"})}),[R]),J=Object(r.useCallback)((e=>{R({type:"userUpdatedEndpointListRefreshOptions",payload:{isAutoRefreshEnabled:!e.isPaused,autoRefreshInterval:e.refreshInterval}})}),[R]),X=Object(r.useCallback)((()=>{}),[]),te=Object(mC.a)("fleet",{path:`/policies/${g}?openEnrollmentFlyout=true`,state:XW}),ae=Object(r.useCallback)((e=>e.some((e=>"checked"in e&&"on"===e.checked&&(R({type:"userSelectedEndpointPolicy",payload:{selectedPolicyId:e.key}}),!0)))),[R]),ne=Object(r.useCallback)((e=>({"data-endpoint-id":e.metadata.agent.id})),[]),ie=Object(r.useMemo)((()=>(({canReadPolicyManagement:e,backToEndpointList:t,getHostPendingActions:a,queryParams:n,search:i,getAppUrl:r})=>{const o=Y.i18n.translate("xpack.securitySolution.endpoint.list.lastActive",{defaultMessage:"Last active"}),l={paddingLeft:"6px"};return[{field:AW.a.HOSTNAME,width:JW[AW.a.HOSTNAME],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.hostname",{defaultMessage:"Endpoint"}),sortable:!0,render:(e,t)=>{const a=Object(O.d)({...n,name:"endpointDetails",selected_endpoint:t.metadata.agent.id},i),o=r({path:a});return s.a.createElement(ee.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},s.a.createElement(oW,{name:e,href:o,route:a,dataTestSubj:"hostnameCellLink"}))}},{field:AW.a.HOST_STATUS,width:JW[AW.a.HOST_STATUS],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.hostStatus",{defaultMessage:"Agent status"}),sortable:!0,render:(e,t)=>s.a.createElement(lW.a,{endpointHostInfo:t,pendingActions:a(t.metadata.agent.id),"data-test-subj":"rowHostStatus"})},{field:AW.a.POLICY_NAME,width:JW[AW.a.POLICY_NAME],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.policy",{defaultMessage:"Policy"}),sortable:!0,truncateText:!0,render:(a,n)=>{const i=n.metadata.Endpoint.policy.applied;return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},e?s.a.createElement(OW,{policyId:i.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:t},a):s.a.createElement(s.a.Fragment,null,a)),i.endpoint_policy_version&&s.a.createElement(ee.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",...l},className:"eui-textTruncate","data-test-subj":"policyListRevNo"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:i.endpoint_policy_version}})),jW(i,n.policy_info)&&s.a.createElement(kW,{style:l,"data-test-subj":"rowPolicyOutOfDate"}))}},{field:AW.a.POLICY_STATUS,width:JW[AW.a.POLICY_STATUS],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.policyStatus",{defaultMessage:"Policy status"}),sortable:!0,render:(e,t)=>{const a=Object(O.d)({name:"endpointPolicyResponse",...n,selected_endpoint:t.metadata.agent.id}),i=r({path:a});return s.a.createElement(ee.EuiToolTip,{content:SW.d[e],anchorClassName:"eui-textTruncate"},s.a.createElement(ee.EuiHealth,{color:SW.c[e],className:"eui-textTruncate eui-fullWidth","data-test-subj":"rowPolicyStatus"},s.a.createElement(oW,{name:SW.d[e],href:i,route:a,dataTestSubj:"policyStatusCellLink"})))}},{field:AW.a.HOST_OS_NAME,width:JW[AW.a.HOST_OS_NAME],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.os",{defaultMessage:"OS"}),sortable:!0,render:e=>s.a.createElement(ee.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},s.a.createElement(ee.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},s.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:AW.a.HOST_IP,width:JW[AW.a.HOST_IP],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.ip",{defaultMessage:"IP address"}),sortable:!0,render:e=>s.a.createElement(ee.EuiToolTip,{content:e.toString().replace(",",", "),anchorClassName:"eui-textTruncate"},s.a.createElement(ee.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},s.a.createElement("p",{className:"eui-displayInline eui-textTruncate"},e.toString().replace(",",", "))))},{field:AW.a.AGENT_VERSION,width:JW[AW.a.AGENT_VERSION],name:Y.i18n.translate("xpack.securitySolution.endpoint.list.endpointVersion",{defaultMessage:"Version"}),sortable:!0,render:e=>s.a.createElement(ee.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},s.a.createElement(ee.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},s.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:AW.a.LAST_SEEN,width:JW[AW.a.LAST_SEEN],name:o,sortable:!0,render:e=>s.a.createElement(Yc.a,{fieldName:o,value:e,className:"eui-textTruncate"})},{field:"",width:JW.actions,name:Y.i18n.translate("xpack.securitySolution.endpoint.list.actions",{defaultMessage:"Actions"}),actions:[{render:e=>s.a.createElement(QW,{endpointMetadata:e.metadata})}]}]})({canReadPolicyManagement:M,backToEndpointList:Z,getAppUrl:N,getHostPendingActions:T,queryParams:m,search:A})),[Z,M,N,T,m,A]),re=Object(r.useMemo)((()=>({sort:{field:i,direction:o}})),[o,i]),se=Object(r.useMemo)((()=>[...t]),[t]),oe=Object(r.useMemo)((()=>{if(E)return s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"endpointListTable",items:se,columns:ie,error:null==p?void 0:p.message,pagination:H,onChange:Q,loading:d,rowProps:ne,sorting:re});if(I&&!C)return s.a.createElement(GW.a,null,s.a.createElement(LW,{loading:_}));if(!h&&B){const e=b.map((e=>({key:e.policy_id,label:e.name,checked:g===e.policy_id?"on":void 0})));return s.a.createElement(BW,{loading:d,onActionClick:te,actionDisabled:!g,handleSelectableOnChange:ae,selectionOptions:e})}return s.a.createElement(GW.a,null,s.a.createElement(LW,{loading:h,onActionClick:W}))}),[C,I,ie,E,_,W,te,ae,B,null==p?void 0:p.message,d,se,Q,H,h,b,g,ne,re]);return s.a.createElement(HW.a,{"data-test-subj":"endpointPage",hideHeader:!E,title:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageTitle",defaultMessage:"Endpoints"}),subtitle:s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageSubTitle",defaultMessage:"Hosts running Elastic Defend"}),headerBackComponent:s.a.createElement(ZW,{backLink:D.backLink})},f&&s.a.createElement(_W,null),s.a.createElement(s.a.Fragment,null,s.a.createElement(rW,{metadataTransformStats:w,hasNoPolicyData:!B}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},U&&s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(UW,null)),s.a.createElement(ee.EuiFlexItem,{grow:!1,style:q},s.a.createElement(KW,null,s.a.createElement(ee.EuiSuperDatePicker,{className:"endpointListDatePicker",onTimeChange:X,isDisabled:f,onRefresh:K,isPaused:$,refreshInterval:V,onRefreshChange:J,isAutoRefreshOnly:!0})))),s.a.createElement(ee.EuiSpacer,{size:"m"})),z&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},u>1e4?s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount.limited",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:u,limit:1e4}}):s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:u}})),s.a.createElement(ee.EuiHorizontalRule,{margin:"xs"})),oe)},tZ=Object(r.memo)((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.h,exact:!0,component:eZ}),s.a.createElement(K.a,{path:"*",component:J.a}))));tZ.displayName="EndpointsContainer";var aZ=a(88),nZ=a(876),iZ=a(1164);const rZ=Object(r.memo)((({policyId:e,nonLinkCondition:t,"data-test-subj":a,children:n,...i})=>{const o=`(language:kuery,query:'united.endpoint.Endpoint.policy.applied.id : "${e}"')`,{search:c}=Object(k.useLocation)(),{getAppUrl:u}=Object(h.c)(),{toRoutePathWithBackOptions:d,toRouteUrl:p}=Object(r.useMemo)((()=>{const e=Object(O.e)({name:"endpointList",admin_query:o}),t=Object(O.h)(c),a={navigateTo:[l.l,{path:t}],label:Y.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:u({path:t})};return{toRoutePathWithBackOptions:{pathname:Object(O.e)({name:"endpointList"}),search:`?admin_query=${o}`,state:{backLink:a}},toRouteUrl:u({path:e})}}),[u,o,c]),m=Object(sW.a)(d);return t?s.a.createElement(ee.EuiText,{size:"s","data-test-subj":`${a}_nonLink`},n):s.a.createElement(ee.EuiLink,bo()({href:p,"data-test-subj":a,onClick:m},i),n)}));rZ.displayName="PolicyEndpointCount";const sZ=Y.i18n.translate("xpack.securitySolution.policy.list.errorMessage",{defaultMessage:"Error while retrieving list of policies"}),oZ=Y.i18n.translate("xpack.securitySolution.policy.list.errorMessage.toast.title",{defaultMessage:"Failed to retrieve policy list"}),lZ=Y.i18n.translate("xpack.securitySolution.policyList.packageVersionError",{defaultMessage:"Error retrieving the endpoint package version"}),cZ=Object(r.memo)((()=>{const{canReadEndpointList:e,loading:t}=Object(Dt.a)().endpointPrivileges,a=Object(ve.a)("protectionUpdatesEnabled"),{pagination:n,pageSizeOptions:i,setPagination:o}=Object(nZ.b)(),{search:c}=Object(k.useLocation)(),{getAppUrl:u}=Object(h.c)(),d=Object(h.m)(),{euiTheme:p}=Object(ee.useEuiTheme)(),{data:m,isFetching:f,error:b}=Object(iZ.c)({page:n.page,perPage:n.pageSize,onError:e=>{d.addDanger({title:oZ,text:e.message})}}),{data:g,isLoading:y}=Object(iZ.a)(a),{data:v,isFetching:E}=Object(iZ.b)({customQueryOptions:{onError:e=>{d.addDanger({title:lZ,text:e.message})}}}),x=Object(r.useMemo)((()=>{var e;return null!==(e=null==m?void 0:m.total)&&void 0!==e?e:0}),[m]),j=Object(r.useMemo)((()=>!f&&0===x&&!b),[f,x,b]),S=Object(r.useMemo)((()=>Object(O.h)(c)),[c]),w=Object(r.useMemo)((()=>({navigateTo:[l.l,{path:S}],label:Y.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:u({path:S})})),[u,S]),T=Object(mC.a)("fleet",{path:aZ.pagePathGetters.add_integration_to_policy({pkgkey:v?`/endpoint-${null==v?void 0:v.version}`:""})[1],state:{onCancelNavigateTo:[l.l,{path:S}],onCancelUrl:u({path:Object(O.h)()}),onSaveNavigateTo:[l.l,{path:S}]}}),I=Object(r.useMemo)((()=>a&&!y&&g&&0!==g.outdatedManifestsCount?s.a.createElement(ee.EuiCallOut,{color:"warning",size:"m","data-test-subj":"policy-list-outdated-manifests-call-out",title:Y.i18n.translate("xpack.securitySolution.policy.list.outdatedManifestsCallOut",{defaultMessage:"Updates available for {outdatedManifestsCount} {outdatedManifestsCount, plural, one {policy} other {policies}}",values:{outdatedManifestsCount:g.outdatedManifestsCount}})}):null),[y,a,g]),C=Object(r.useMemo)((()=>{const n=Y.i18n.translate("xpack.securitySolution.policy.list.updatedAt",{defaultMessage:"Last Updated"}),i=Y.i18n.translate("xpack.securitySolution.policy.list.createdAt",{defaultMessage:"Date Created"});return[{field:"",name:Y.i18n.translate("xpack.securitySolution.policy.list.name",{defaultMessage:"Name"}),truncateText:!0,render:e=>s.a.createElement(ee.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},s.a.createElement(OW,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:w},e.name))},...a?[{field:"",name:Y.i18n.translate("xpack.securitySolution.policy.list.deployedVersion",{defaultMessage:"Deployed Version"}),truncateText:!0,render:e=>{var t,a;const[n,i,r]=(e=>{if(!e)return[];if("latest"===e)return["success",Y.i18n.translate("xpack.securitySolution.policy.list.manifestLatest",{defaultMessage:"latest"})];const t=ec.a.utc(e,"YYYY-MM-DD");return t<ec.a.utc().subtract(18,"months")?["danger",t.format("MMMM DD, YYYY"),Y.i18n.translate("xpack.securitySolution.policy.list.manifestOver18MonthsOld",{defaultMessage:"Manifest is over 18 months old and rollback is not supported"})]:t>ec.a.utc().subtract(1,"month")?["success",t.format("MMMM DD, YYYY")]:[p.colors.warning,t.format("MMMM DD, YYYY"),Y.i18n.translate("xpack.securitySolution.policy.list.manifestOver1MonthOld",{defaultMessage:"Manifest is over a month old"})]})(null===(t=e.inputs[0])||void 0===t||null===(a=t.config)||void 0===a?void 0:a.policy.value.global_manifest_version);return s.a.createElement(ee.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiIconTip,{type:"dot",color:n,content:r})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"policyDeployedVersion"},i)))}}]:[],{field:"created_by",name:Y.i18n.translate("xpack.securitySolution.policy.list.createdBy",{defaultMessage:"Created by"}),truncateText:!0,render:e=>s.a.createElement(ee.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiAvatar,{name:e,"data-test-subj":"created-by-avatar",size:"s"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"created-by-name"},e)))},{field:"created_at",name:i,truncateText:!0,render:e=>s.a.createElement(Yc.a,{fieldName:i,value:e,className:"eui-textTruncate"})},{field:"updated_by",name:Y.i18n.translate("xpack.securitySolution.policy.list.lastUpdatedBy",{defaultMessage:"Last updated by"}),truncateText:!0,render:e=>s.a.createElement(ee.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiAvatar,{name:e,"data-test-subj":"updated-by-avatar",size:"s"})),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiText,{size:"s","data-test-subj":"updated-by-name"},e)))},{field:"updated_at",name:n,truncateText:!0,render:e=>s.a.createElement(Yc.a,{fieldName:n,value:e,className:"eui-textTruncate"})},{field:"",name:Y.i18n.translate("xpack.securitySolution.policy.list.endpoints",{defaultMessage:"Endpoints"}),width:"8%",render:a=>{var n;const i=null!==(n=a.agents)&&void 0!==n?n:0;return s.a.createElement(rZ,{className:"eui-textTruncate","data-test-subj":"policyEndpointCountLink",policyId:a.id,nonLinkCondition:t||!e||0===i},i)}}]}),[a,p.colors.warning,w,t,e]),M=Object(r.useCallback)((({page:e})=>{o({page:e.index+1,pageSize:e.size})}),[o]),_=Object(r.useMemo)((()=>({pageIndex:n.page-1,pageSize:n.pageSize,totalItemCount:x,pageSizeOptions:i})),[x,i,n.page,n.pageSize]);return s.a.createElement(HW.a,{"data-test-subj":"policyListPage",hideHeader:j,title:Y.i18n.translate("xpack.securitySolution.policy.list.title",{defaultMessage:"Policies"}),subtitle:Y.i18n.translate("xpack.securitySolution.policy.list.subtitle",{defaultMessage:"Use policies to customize endpoint and cloud workload protections and other configurations"})},j?s.a.createElement(GW.a,null,s.a.createElement(LW,{loading:E,onActionClick:T,policyEntryPoint:!0})):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.policy.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# policy} other {# policies}}",values:{totalItemCount:x}})),s.a.createElement(ee.EuiHorizontalRule,{margin:"xs"}),I,s.a.createElement(ee.EuiBasicTable,{"data-test-subj":"policyListTable",items:(null==m?void 0:m.items)||[],columns:C,pagination:_,onChange:M,loading:f,error:null!==b?sZ:""})))}));cZ.displayName="PolicyList";var uZ=a(1075),dZ=a(1263);const pZ=Object(r.memo)((e=>{const t=Object(r.useMemo)((()=>[{key:"total",title:Y.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.totalTitle",{defaultMessage:"Total agents"}),health:""},{key:"online",title:Y.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.onlineTitle",{defaultMessage:"Healthy"}),health:"success"},{key:"error",title:Y.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.errorTitle",{defaultMessage:"Unhealthy"}),health:"warning"},{key:"offline",title:Y.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.offlineTitle",{defaultMessage:"Offline"}),health:"subdued"}]),[]),a=Object(r.useContext)(te.ThemeContext);return s.a.createElement(ee.EuiFlexGroup,{gutterSize:"l",responsive:!1,"data-test-subj":"policyAgentsSummary"},t.map((({key:t,title:n,health:i})=>s.a.createElement(ee.EuiFlexItem,{grow:!1,key:t,style:{marginRight:"total"===t?a.eui.euiSizeXXL:void 0}},s.a.createElement(ee.EuiDescriptionList,{textStyle:"reverse",style:{textAlign:"right"},listItems:[{title:n,description:s.a.createElement(s.a.Fragment,null,i&&s.a.createElement(ee.EuiHealth,{color:"warning"===i?a.eui.euiColorWarning:i,className:"eui-alignMiddle"}),s.a.createElement(ee.EuiI18nNumber,{value:e[t]}))}]})))))}));pZ.displayName="AgentsSummary";const mZ=s.a.memo((({isUpdating:e,onSave:t,saveButtonDisabled:a})=>{const{state:n}=Object(k.useLocation)(),[i,o]=Object(r.useState)(),l=null==i?void 0:i.onCancelNavigateTo;Object(r.useEffect)((()=>{!i&&n&&o(n)}),[n,i]);const c=Object(r.useMemo)((()=>l||[uM.APP_UI_ID,{path:Object(O.h)()}]),[l]),u=Object(mC.a)(...c);return s.a.createElement(ee.EuiPageTemplate.BottomBar,{paddingSize:"s"},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{color:"text",onClick:u,"data-test-subj":"protectionUpdatesCancelButton",disabled:e},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.cancel",defaultMessage:"Cancel"}))),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,disabled:a,iconType:"save","data-test-subj":"protectionUpdatesSaveButton",onClick:t,isLoading:e},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.save",defaultMessage:"Save"})))))}));mZ.displayName="ProtectionUpdatesBottomBar";var fZ=a(488);const bZ=e=>`protection-updates-note-${e}`;var gZ=a(70),yZ=a(966);const hZ=e=>{const t=Object(h.h)();return Object(ih.useMutation)((({policy:e})=>{const a=Object(yZ.a)(e);return t.put(gZ.packagePolicyRouteService.getUpdatePath(e.id),{body:JSON.stringify(a),version:gZ.API_VERSIONS.public.v1})}),e)},vZ=()=>s.a.createElement(ee.EuiCallOut,{title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.warningPanel.title",{defaultMessage:"Attention"}),iconType:"alert","data-test-subj":"protection-updates-warning-callout"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.warningPanel.content",defaultMessage:"Elastic provides periodic updates to protections artifacts such as the global exception list, malware models, and rule packages to ensure your environment is up to date with latest protections. By default, these artifacts are updated automatically. Disable the automatic updates toggle to manually manage updates to the protections artifacts."}),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.warningPanel.content.note",defaultMessage:"{note} It is strongly advised to keep automatic updates enabled to ensure the highest level of security for your environment. Proceed with caution if you decide to disable automatic updates.",values:{note:s.a.createElement("strong",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.warningPanel.content.note.bold",{defaultMessage:"Note:"}))}})),EZ=Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.useAutomaticUpdates",{defaultMessage:"Automatic updates enabled"}),xZ=Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.useAutomaticUpdatesOff",{defaultMessage:"Automatic updates disabled."}),jZ=s.a.memo((({policy:e})=>{const t=Object(h.m)(),a=Object(c.useDispatch)(),{isLoading:n,mutateAsync:i}=hZ(),{canWritePolicyManagement:o}=Object(Dt.a)().endpointPrivileges,{docLinks:l}=Object(h.i)().services,u=Object(r.useContext)(te.ThemeContext).eui.euiPanelPaddingModifiers.paddingMedium,d=e,p=d.inputs[0].config.policy.value.global_manifest_version,[m,f]=Object(r.useState)(p),b=ec.a.utc(),g=b.clone().subtract(1,"days"),[y,v]=Object(r.useState)(g),{data:E,isLoading:x}=(({packagePolicyId:e})=>{const{http:t}=Object(h.i)().services;return Object(ih.useQuery)([bZ(e)],(()=>t.get(Object(fZ.a)(nW.w,{package_policy_id:e}),{version:"2023-10-31"})),{keepPreviousData:!0,enabled:!!e,retry:!1})})({packagePolicyId:e.id}),{isLoading:j,mutate:S}=(({packagePolicyId:e})=>{const{http:t}=Object(h.i)().services,a=Object(ih.useQueryClient)();return Object(ih.useMutation)((a=>t.post(Object(fZ.a)(nW.w,{package_policy_id:e}),{version:"2023-10-31",body:JSON.stringify(a)})),{onSuccess:()=>{a.invalidateQueries([bZ(e)])}})})({packagePolicyId:e.id}),[O,k]=Object(r.useState)("");Object(r.useEffect)((()=>{E&&!x&&k(E.note)}),[E,x]);const w="latest"===m,T="YYYY-MM-DD",C="MMMM DD, YYYY",M=ec.a.utc(p,T).format(C),_=function(e=ec()("2023-10-01T00:00:00Z").utc()){const t=ec.a.utc().subtract(18,"months").add(1,"day");return ec()(e).isAfter(t)?e:t}(),A=w?EZ:xZ,F=(E?O!==E.note:""!==O)||m!==p,P=Object(r.useCallback)((()=>{const e=Object(I.cloneDeep)(d);e.inputs[0].config.policy.value.global_manifest_version=m,i({policy:e}).then((({item:e})=>{t.addSuccess({"data-test-subj":"protectionUpdatesSuccessfulMessage",title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.updateSuccessTitle",{defaultMessage:"Success!"}),text:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.updateSuccessMessage",{defaultMessage:"Manifest updates successfully saved"})}),a({type:"serverReturnedPolicyDetailsData",payload:{policyItem:e}})})).catch((e=>{t.addDanger({"data-test-subj":"protectionUpdatesFailureMessage",title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.updateErrorTitle",{defaultMessage:"Failed!"}),text:e.message})})),(!E&&""!==O||E&&O!==E.note)&&S({note:O},{onError:e=>{t.addDanger({"data-test-subj":"protectionUpdatesNoteUpdateFailureMessage",title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.noteUpdateErrorTitle",{defaultMessage:"Note update failed!"}),text:e.body.message})}})}),[d,m,i,E,O,t,a,S]),D=Object(r.useCallback)((e=>{const{checked:t}=e.target;t&&!w?(f("latest"),y!==g&&v(g)):f(y.format(T))}),[w,y,g]),N=Object(r.useCallback)((e=>{null!=e&&e.isAfter(_)&&null!=e&&e.isSameOrBefore(g)&&(v(e||g),f((null==e?void 0:e.format(T))||"latest"))}),[_,g]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiPanel,{"data-test-subject":"protection-updates-layout",hasBorder:!0,hasShadow:!1,paddingSize:"none"},s.a.createElement(ee.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center",style:{padding:`${u} ${u} 0 ${u}`}},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiTitle,{size:"xxs","data-test-subj":"protection-updates-manifest-name-title"},s.a.createElement("h5",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.title",{defaultMessage:"Manage protection updates"})))),s.a.createElement(ee.EuiShowFor,{sizes:["l","xl","m"]},o?s.a.createElement(ee.EuiSwitch,{disabled:n||j||x,label:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.enableAutomaticUpdates",{defaultMessage:"Enable automatic updates"}),labelProps:{"data-test-subj":"protection-updates-manifest-switch-label"},checked:w,onChange:D,"data-test-subj":"protection-updates-manifest-switch"}):s.a.createElement(ee.EuiText,{"data-test-subj":"protection-updates-state-view-mode"},A))),s.a.createElement(ee.EuiHorizontalRule,{margin:"m"}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement("div",{style:{padding:`0 ${u} ${u} ${u}`}},s.a.createElement(vZ,null),s.a.createElement(ee.EuiSpacer,{size:"m"}),(()=>{if(w||"latest"===p)return null;const e=ec.a.utc(p).format(T);return b.diff(e,"days")<30?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{color:"warning",iconType:"alert",size:"m","data-test-subj":"protection-updates-manifest-outdated",title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.manifestOutdated.title",{defaultMessage:"Manifest outdated"})},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.manifestOutdated",defaultMessage:"Your protection artifacts have not been updated in over 30 days. We strongly recommend keeping these up to date to ensure the highest level of security for your environment.{break}Note: After 18 months, protection artifacts will expire and cannot be rolled back. {learnMore}",values:{learnMore:s.a.createElement(ee.EuiLink,{href:l.links.securitySolution.artifactControl,target:"_blank",external:!0},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.manifestOutdated.learnMore",defaultMessage:"Learn more"})),break:s.a.createElement(ee.EuiSpacer,{size:"m"})}})),s.a.createElement(ee.EuiSpacer,{size:"m"}))})(),w?s.a.createElement(ee.EuiCallOut,{color:"primary",iconType:"iInCircle",size:"m","data-test-subj":"protection-updates-automatic-updates-enabled",title:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.automaticUpdates.enabledTitle",{defaultMessage:"Automatic updates enabled"})},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.automaticUpdates.enabled",defaultMessage:"Protection updates will always be updated to the latest available version. If you want to control updates manually, disable the {toggleName} toggle.",values:{toggleName:s.a.createElement("strong",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.automaticUpdates.enabled.toggleName",{defaultMessage:"Enable automatic updates"}))}})):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,{size:"xxs","data-test-subj":"protection-updates-manifest-name-deployed-version-title"},s.a.createElement("h5",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.deployedVersion.label",{defaultMessage:"Currently deployed version"}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiText,{size:"m","data-test-subj":"protection-updates-deployed-version"},"latest"===p?"latest":M),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,{size:"xxs","data-test-subj":"protection-updates-manifest-name-version-to-deploy-title"},s.a.createElement("h5",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.versionToDeploy.label",{defaultMessage:"Version to deploy"}))),s.a.createElement(ee.EuiSpacer,{size:"m"}),o?s.a.createElement("div",{"data-test-subj":"protection-updates-version-to-deploy-picker"},s.a.createElement(ee.EuiDatePicker,{popoverPlacement:"downCenter",dateFormat:C,selected:y,maxDate:g,minDate:_,onChange:N})):s.a.createElement(ee.EuiText,{size:"m","data-test-subj":"protection-updates-version-to-deploy-view-mode"},y.format(C))),(o||O)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(ee.EuiTitle,{size:"xxs","data-test-subj":"protection-updates-manifest-name-note-title"},s.a.createElement("h5",null,Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.note.label",{defaultMessage:"Note"}))),s.a.createElement(ee.EuiIconTip,{position:"right",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.protectionUpdates.note.tooltip",defaultMessage:"You can add an optional note to explain the reason for selecting a particular policy version."}))})),s.a.createElement(ee.EuiSpacer,{size:"m"}),o?s.a.createElement(ee.EuiTextArea,{value:O,disabled:x||j,onChange:e=>k(e.target.value),fullWidth:!0,rows:3,placeholder:Y.i18n.translate("xpack.securitySolution.endpoint.protectionUpdates.note.placeholder",{defaultMessage:"Add relevant information about update here"}),"data-test-subj":"protection-updates-manifest-note"}):s.a.createElement(ee.EuiText,{"data-test-subj":"protection-updates-manifest-note-view-mode"},O))))),s.a.createElement(mZ,{isUpdating:n,saveButtonDisabled:!o||!F,onSave:P}))}));jZ.displayName="ProtectionUpdatesLayout";var SZ=a(1415),OZ=a(1416);const kZ=s.a.memo((({endpointCount:e,onCancel:t,onConfirm:a})=>s.a.createElement(ee.EuiConfirmModal,{"data-test-subj":"policyDetailsConfirmModal",title:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.title",{defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:a,confirmButtonText:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.confirmButtonTitle",{defaultMessage:"Save and deploy changes"}),cancelButtonText:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.cancelButtonTitle",{defaultMessage:"Cancel"})},e>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{"data-test-subj":"policyDetailsWarningCallout",title:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.warningTitle",{defaultMessage:"This action will update {endpointCount, plural, one {# endpoint} other {# endpoints}}",values:{endpointCount:e}})},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.warningMessage",defaultMessage:"Saving these changes will apply updates to all endpoints assigned to this agent policy."})),s.a.createElement(ee.EuiSpacer,{size:"xl"})),s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.message",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))));kZ.displayName="ConfirmUpdate";const wZ=Object(r.memo)((({policy:e})=>{var t;const a=e,{services:{application:{navigateToApp:n}}}=Object(h.i)(),i=Object(h.m)(),o=Object(c.useDispatch)(),{state:l}=Object(k.useLocation)(),{canWritePolicyManagement:u}=Object(Dt.a)().endpointPrivileges,{isLoading:d,mutateAsync:p}=hZ(),{data:m}=((e,t={})=>{const a=Object(h.h)();return Object(ih.useQuery)({queryKey:["get-policy-agent-summary",e],...t,queryFn:async()=>(await a.get(gZ.agentRouteService.getStatusPath(),{query:{policyId:e},version:gZ.API_VERSIONS.public.v1})).results})})(a.policy_id),[f,b]=Object(r.useState)(Object(I.cloneDeep)(a.inputs[0].config.policy.value)),[g,y]=Object(r.useState)(!1),[v,E]=Object(r.useState)(),x=u,j=null!==(t=null==a?void 0:a.name)&&void 0!==t?t:"",S=null==v?void 0:v.onCancelNavigateTo,w=Object(r.useMemo)((()=>S||[uM.APP_UI_ID,{path:Object(O.h)()}]),[S]),T=Object(r.useCallback)((e=>{b(e.updatedPolicy)}),[]),C=Object(mC.a)(...w),M=Object(r.useCallback)((()=>{y(!0)}),[]),_=Object(r.useCallback)((()=>{y(!1)}),[]),A=Object(r.useCallback)((()=>{const e=Object(I.cloneDeep)(a);e.inputs[0].config.policy.value=f,p({policy:e}).then((({item:e})=>{i.addSuccess({"data-test-subj":"policyDetailsSuccessMessage",title:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessTitle",{defaultMessage:"Success!"}),text:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessMessage",{defaultMessage:"Integration {name} has been updated.",values:{name:j}})}),v&&v.onSaveNavigateTo?n(...v.onSaveNavigateTo):o({type:"serverReturnedPolicyDetailsData",payload:{policyItem:e}})})).catch((e=>{i.addDanger({"data-test-subj":"policyDetailsFailureMessage",title:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateErrorTitle",{defaultMessage:"Failed!"}),text:e.message})})),_()}),[o,_,n,a,j,f,v,p,i]);return Object(r.useEffect)((()=>{!v&&l&&E(l)}),[l,v]),s.a.createElement(s.a.Fragment,null,g&&s.a.createElement(kZ,{endpointCount:m?m.all:0,onCancel:_,onConfirm:A}),s.a.createElement(OZ.a,{policy:f,onChange:T,mode:x?"edit":"view","data-test-subj":"endpointPolicyForm"}),s.a.createElement(ee.EuiSpacer,{size:"xxl"}),s.a.createElement(SZ.a.BottomBar,{paddingSize:"s"},s.a.createElement(ee.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{color:"text",onClick:C,"data-test-subj":"policyDetailsCancelButton",disabled:d},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cancel",defaultMessage:"Cancel"}))),x&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{fill:!0,iconType:"save","data-test-subj":"policyDetailsSaveButton",onClick:M,isLoading:d},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.save",defaultMessage:"Save"}))))))}));wZ.displayName="PolicySettingsLayout";var TZ=a(1150),IZ=a(530),CZ=a(746);const MZ=(e,t,a,n,i)=>{const{getAppUrl:s}=Object(cE.a)(),{toRoutePath:o,toRouteUrl:c}=Object(r.useMemo)((()=>{const e=n(i);return{toRoutePath:e,toRouteUrl:s({path:e})}}),[s,n,i]),u=a(e),d=Object(r.useMemo)((()=>({backButtonLabel:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.backButtonLabel",{defaultMessage:"Back to {policyName} policy",values:{policyName:t}}),onBackButtonNavigateTo:[l.l,{path:u}],backButtonUrl:s({appId:l.l,path:u})})),[s,t,u]);return{onClickHandler:Object(mC.a)(l.l,{state:d,path:o}),toRouteUrl:c,state:d}},_Z=Object(r.memo)((({policyId:e,policyName:t,listId:a,labels:n,canWriteArtifact:i=!1,getPolicyArtifactsPath:o,getArtifactPath:l})=>{const{canCreateArtifactsByPolicy:c}=Object(Dt.a)().endpointPrivileges,{onClickHandler:u,toRouteUrl:d}=MZ(e,t,o,l),p=Object(uZ.b)(a),m=Object(r.useCallback)((()=>p({show:"list"})),[p]);return s.a.createElement(ee.EuiPageTemplate.EmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unassigned",color:"subdued",title:s.a.createElement("h2",null,n.emptyUnassignedTitle),body:i?n.emptyUnassignedMessage(t):n.emptyUnassignedNoPrivilegesMessage(t),actions:[...c&&i?[s.a.createElement(ee.EuiButton,{color:"primary",fill:!0,onClick:m,"data-test-subj":"unassigned-assign-artifacts-button"},n.emptyUnassignedPrimaryActionButtonTitle)]:[],i?s.a.createElement(ee.EuiLink,{onClick:u,href:d,"data-test-subj":"unassigned-manage-artifacts-button"},n.emptyUnassignedSecondaryActionButtonTitle):null]})}));_Z.displayName="PolicyArtifactsEmptyUnassigned";const AZ=Object(r.memo)((({policyId:e,policyName:t,labels:a,canWriteArtifact:n=!1,getPolicyArtifactsPath:i,getArtifactPath:r})=>{const{onClickHandler:o,toRouteUrl:l}=MZ(e,t,i,r,{show:"create"});return s.a.createElement(ee.EuiPageTemplate.EmptyPrompt,{color:"subdued",iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unexisting",title:s.a.createElement("h2",null,a.emptyUnexistingTitle),body:a.emptyUnexistingMessage,actions:n?s.a.createElement(ee.EuiButton,{color:"primary",fill:!0,onClick:o,href:l,"data-test-subj":"unexisting-manage-artifacts-button"},a.emptyUnexistingPrimaryActionButtonTitle):null})}));AZ.displayName="PolicyArtifactsEmptyUnexisting";const FZ=Object.freeze({emptyUnassignedTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.title",{defaultMessage:"No assigned artifacts"}),emptyUnassignedMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.content",{defaultMessage:"There are currently no artifacts assigned to {policyName}. Assign artifacts now or add and manage them on the artifacts page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.primaryAction",{defaultMessage:"Assign artifacts"}),emptyUnassignedSecondaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.secondaryAction",{defaultMessage:"Manage artifacts"}),emptyUnassignedNoPrivilegesMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.noPrivileges.content",{defaultMessage:"There are currently no artifacts assigned to {policyName}.",values:{policyName:e}})}),PZ=Object.freeze({emptyUnexistingTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.title",{defaultMessage:"No artifacts exist"}),emptyUnexistingMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.content",{defaultMessage:"There are currently no artifacts applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.action",{defaultMessage:"Add artifacts"})});var DZ=a(1427),NZ=a(1382),RZ=a(1271),LZ=a(1554),BZ=a(115);const zZ=ae()(RZ.e).withConfig({displayName:"GridHeaderContainer",componentId:"sc-cbi88a-0"})(["padding-top:0;padding-bottom:",";"],(({theme:e})=>e.eui.euiSizeS)),qZ=Object(r.memo)((({"data-test-subj":e,expandAllIconType:t,onExpandCollapseAll:a})=>{const n=Object(BZ.a)(e),i=Object(r.useMemo)((()=>s.a.createElement(ee.EuiButtonIcon,{"data-test-subj":n("expandCollapseAllButton"),"aria-label":Y.i18n.translate("xpack.securitySolution.artifactCardGrid.expandCollapseLabel",{defaultMessage:"{action} all cards",values:{action:"Expand"}}),iconType:t,onClick:()=>a(),style:{marginLeft:"-5px"}})),[n,t,a]);return s.a.createElement(zZ,{"data-test-subj":e},s.a.createElement(RZ.d,{expanded:!1,expandToggle:i,"data-test-subj":n("layout"),flushTop:!0,name:s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":n("name")},s.a.createElement("strong",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.nameColumn",defaultMessage:"Name"}))),description:s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":n("description")},s.a.createElement("strong",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.DescriptionColumn",defaultMessage:"Description"}))),effectScope:s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":n("assignment")},s.a.createElement("strong",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.assignmentColumn",defaultMessage:"Assignment"}))),actionMenu:!0}))}));qZ.displayName="GridHeader";const $Z=LZ.a,VZ=Object(r.memo)((({items:e,cardComponentProps:t,onPageChange:a,onExpandCollapse:n,"data-test-subj":i,...o})=>{const l=Object(BZ.a)(i),c=e,u=Object(r.useMemo)((()=>{const e=new Map;for(const a of c)e.set(a,t?t(a):{});return e}),[t,c]),d=Object(r.useCallback)((e=>{const t=[],a=[];for(const[n,i]of u){const r=Boolean(i.expanded);(n===e?!r:r)?t.push(n):a.push(n)}n({expanded:t,collapsed:a})}),[u,n]),p=Object(r.useMemo)((()=>{for(const[e,t]of u)if(!Boolean(t.expanded))return!1;return!0}),[u]),m=Object(r.useCallback)((()=>{let e=[],t=[];p?t=Array.from(u.keys()):e=Array.from(u.keys()),n({expanded:e,collapsed:t})}),[u,n,p]),f=Object(r.useMemo)((()=>{const e=new Map;for(const[a,n]of u){var t;e.set(a,{...n,item:a,onExpandCollapse:()=>d(a),"data-test-subj":null!==(t=n["data-test-subj"])&&void 0!==t?t:l("card")})}return e}),[u,l,d]),b=Object(r.useCallback)((e=>f.get(e)),[f]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(qZ,{expandAllIconType:p?"fold":"unfold",onExpandCollapseAll:m,"data-test-subj":l("header")}),s.a.createElement($Z,bo()({},o,{"data-test-subj":i,items:c,ItemComponent:RZ.c,itemComponentProps:b,onChange:a})))}));VZ.displayName="ArtifactCardGrid";var UZ=a(1165);const HZ=s.a.memo((({policy:e,apiClient:t,searchableFields:a,getArtifactPath:n,getPolicyArtifactsPath:i,labels:o,onDeleteActionCallback:c,canWriteArtifact:u=!1})=>{var d;(()=>{const e=Object(k.useHistory)(),{urlParams:t}=Object(IZ.a)();Object(r.useEffect)((()=>{(t.page_index&&!t.page||t.page_size&&!t.pageSize)&&e.replace(`${e.location.pathname}${e.location.search.replaceAll("page_size","pageSize").replaceAll(`page_index=${t.page_index}`,`page=${Number(t.page_index)+1}`)}`)}),[e,t.page,t.pageSize,t.page_index,t.page_size])})();const{getAppUrl:p}=Object(h.c)(),{canCreateArtifactsByPolicy:m}=Object(Dt.a)().endpointPrivileges,f=Object(iZ.c)({perPage:1e3}),b=Object(uZ.b)(t.listId),{urlParams:g}=Object(IZ.a)(),[y,v]=Object(r.useState)(new Map),{state:E}=MZ(e.id,e.name,i,n),{pageSizeOptions:x,pagination:j,setPagination:S}=Object(nZ.b)(),{data:O,isLoading:w,isRefetching:T}=Object(CZ.e)(t,{page:j.page,perPage:j.pageSize,filter:g.filter,policies:[e.id,"all"]},a),I=Object(r.useMemo)((()=>({pageSize:j.pageSize,pageIndex:j.page-1,pageSizeOptions:x,totalItemCount:(null==O?void 0:O.total)||0})),[null==O?void 0:O.total,x,j.page,j.pageSize]),C=Object(r.useCallback)((e=>{b({filter:e})}),[b]),M=Object(r.useCallback)((({expanded:e,collapsed:t})=>{const a=new Map(y);for(const t of e)a.set(t.id,!0);for(const e of t)a.set(e.id,!1);v(a)}),[y]),_=Object(r.useCallback)((({pageIndex:e,pageSize:t})=>{null!=O&&O.total&&S({page:e+1,pageSize:t})}),[null==O?void 0:O.total,S]),A=Object(r.useMemo)((()=>o.listTotalItemCountMessage((null==O?void 0:O.data.length)||0)),[null==O?void 0:O.data.length,o]),F=Object(NZ.a)(null===(d=f.data)||void 0===d?void 0:d.items),P=Object(r.useCallback)((e=>{const t=n({filter:e.item_id}),a={icon:"controlsHorizontal",children:o.listFullDetailsActionTitle,href:p({appId:l.l,path:t}),navigateAppId:l.l,navigateOptions:{path:t,state:E},"data-test-subj":"view-full-details-action"},i=e,r=Object(UZ.d)(i.tags),s={icon:"trash",children:o.listRemoveActionTitle,onClick:()=>{c(i)},disabled:r,toolTipContent:r?o.listRemoveActionNotAllowedMessage:void 0,toolTipPosition:"top","data-test-subj":"remove-from-policy-action"};return{expanded:y.get(i.id)||!1,actions:m&&u?[a,s]:[a],policies:F}}),[F,m,y,u,p,n,o.listFullDetailsActionTitle,o.listRemoveActionNotAllowedMessage,o.listRemoveActionTitle,c,E]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(DZ.a,{placeholder:o.listSearchPlaceholderMessage,defaultValue:g.filter,hideRefreshButton:!0,onSearch:C}),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiText,{color:"subdued",size:"xs","data-test-subj":"policyDetailsArtifactsSearchCount"},A),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(VZ,{items:(null==O?void 0:O.data)||[],onPageChange:_,onExpandCollapse:M,cardComponentProps:P,pagination:O?I:void 0,loading:w||T,"data-test-subj":"artifacts-collapsed-list"}))}));HZ.displayName="PolicyArtifactsList";const QZ=Object.freeze({listTotalItemCountMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# artifact} other {# artifacts}}",values:{totalItemsCount:e}}),listFullDetailsActionTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.fullDetailsAction",{defaultMessage:"View full details"}),listRemoveActionTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeAction",{defaultMessage:"Remove from policy"}),listRemoveActionNotAllowedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeActionNotAllowed",{defaultMessage:"Globally applied artifact cannot be removed from policy."}),listSearchPlaceholderMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"})}),GZ=s.a.memo((({artifacts:e,isListLoading:t,selectedArtifactIds:a,selectedArtifactsUpdated:n})=>{const i=Object(r.useMemo)((()=>a.reduce(((e,t)=>({...e,[t]:!0})),{})),[a]),o=Object(r.useMemo)((()=>{if(!e||!e.data.length)return null;const t=e.data;return s.a.createElement("div",{"data-test-subj":"artifactsList"},t.map((e=>s.a.createElement(RZ.b,{key:e.id,item:e,isSelected:i[e.id]||!1,onToggleSelectedArtifact:t=>n(e.id,t)}))))}),[e,i,n]);return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(ee.EuiProgress,{size:"xs",color:"primary","data-test-subj":"artifactsAssignableListLoader"}),s.a.createElement("div",null,o))}));GZ.displayName="PolicyArtifactsAssignableList";const WZ=s.a.memo((({policyItem:e,apiClient:t,searchableFields:a,onClose:n,labels:i})=>{const o=Object(h.m)(),l=Object(ih.useQueryClient)(),[c,u]=Object(r.useState)([]),[d,p]=Object(r.useState)(""),m=Object(CZ.a)(t,{onSuccess:e=>{o.addSuccess({title:i.flyoutSuccessMessageTitle,text:i.flyoutSuccessMessageText(e)}),l.invalidateQueries(["list",t]),n()},onError:()=>{o.addDanger(i.flyoutErrorMessage)}}),{data:f,isLoading:b,isRefetching:g}=Object(CZ.e)(t,{perPage:100,filter:d,excludedPolicies:[e.id,"all"]},a),{data:y,isLoading:v}=Object(CZ.e)(t,{excludedPolicies:[e.id,"all"]},a),E=Object(r.useCallback)((e=>{u([]),p(e)}),[]),x=Object(r.useCallback)((()=>{if(!f)return;const t=[];c.forEach((a=>{const n=f.data.find((e=>e.id===a));n&&(n.tags=[...n.tags,`policy:${e.id}`],t.push(n))})),m.mutate(t)}),[m,f,e.id,c]),j=Object(r.useMemo)((()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiCallOut,{"data-test-subj":"artifacts-too-many-results",color:"warning",size:"s",heading:"h4",title:i.flyoutWarningCalloutTitle},i.flyoutWarningCalloutMessage(100)),s.a.createElement(ee.EuiSpacer,{size:"m"}))),[i]),S=Object(r.useMemo)((()=>0!==(null==y?void 0:y.total)&&(0!==(null==f?void 0:f.total)||""!==d)),[null==y?void 0:y.total,null==f?void 0:f.total,d]),O=Object(r.useMemo)((()=>b||g||v),[v,b,g]),k=Object(r.useMemo)((()=>O?null:S?0===(null==f?void 0:f.total)?s.a.createElement(ee.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-items-found",body:s.a.createElement("p",null,i.flyoutNoSearchResultsMessage)}):void 0:s.a.createElement(ee.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-assignable-items",body:s.a.createElement("p",null,i.flyoutNoArtifactsToBeAssignedMessage)})),[O,S,null==f?void 0:f.total,i.flyoutNoArtifactsToBeAssignedMessage,i.flyoutNoSearchResultsMessage]);return s.a.createElement(ee.EuiFlyout,{onClose:n,"data-test-subj":"artifacts-assign-flyout"},s.a.createElement(ee.EuiFlyoutHeader,{hasBorder:!0},s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",null,i.flyoutTitle)),s.a.createElement(ee.EuiSpacer,{size:"m"}),i.flyoutSubtitle(e.name)),s.a.createElement(ee.EuiFlyoutBody,null,((null==f?void 0:f.total)||0)>100?j:null,!v&&S&&s.a.createElement(DZ.a,{onSearch:E,placeholder:i.flyoutSearchPlaceholder,hideRefreshButton:!0}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(GZ,{"data-test-subj":"artifacts-assignable-list",artifacts:f,selectedArtifactIds:c,isListLoading:b||g,selectedArtifactsUpdated:(e,t)=>{u((a=>t?[...a,e]:Object(A.without)([e],a)))}}),k),s.a.createElement(ee.EuiFlyoutFooter,null,s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButtonEmpty,{"data-test-subj":"artifacts-assign-cancel-button",onClick:n},i.flyoutCancelButtonTitle)),s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiButton,{className:"eui-textTruncate",style:{maxWidth:"300px"},"data-test-subj":"artifacts-assign-confirm-button",fill:!0,onClick:x,isLoading:m.isLoading||b||g,disabled:Object(A.isEmpty)(c),title:e.name},i.flyoutSubmitButtonTitle(e.name))))))}));WZ.displayName="PolicyArtifactsFlyout";const ZZ=Object.freeze({flyoutWarningCalloutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.title",{defaultMessage:"Limited search results"}),flyoutWarningCalloutMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} artifacts are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noAssignable",{defaultMessage:"There are no artifacts that can be assigned to this policy."}),flyoutNoSearchResultsMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noResults",{defaultMessage:"No items found"}),flyoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.title",{defaultMessage:"Assign artifacts"}),flyoutSubtitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.subtitle",{defaultMessage:"Select artifacts to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.search.label",{defaultMessage:"Search artifacts"}),flyoutCancelButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.cancel",{defaultMessage:"Cancel"}),flyoutSubmitButtonTitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.confirm",{defaultMessage:"Assign to {policyName}",values:{policyName:e}}),flyoutErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating artifacts"}),flyoutSuccessMessageTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.title",{defaultMessage:"Success"}),flyoutSuccessMessageText:e=>e.length>1?Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} artifacts have been added to your list.",values:{count:e.length}}):Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your artifacts list.',values:{name:e[0].name}})});var KZ=a(1106);const JZ=s.a.memo((({policyId:e,policyName:t,apiClient:a,exception:n,onClose:i,labels:o})=>{const l=Object(h.m)(),c=Object(ih.useQueryClient)(),{mutate:u,isLoading:d}=Object(CZ.a)(a,{onSuccess:()=>{l.addSuccess({title:o.deleteModalSuccessMessageTitle,text:o.deleteModalSuccessMessageText(n,t)}),c.invalidateQueries(["list",a]),i()},onError:e=>{l.addError(e,{title:o.deleteModalErrorMessage})}}),p=Object(r.useCallback)((()=>{const t={...n,tags:n.tags.filter((t=>t!==`${KZ.a}${e}`))};u([t])}),[n,e,u]),m=Object(r.useCallback)((()=>{d||i()}),[d,i]);return s.a.createElement(ee.EuiConfirmModal,{onCancel:m,onConfirm:p,title:o.deleteModalTitle,cancelButtonText:o.deleteModalCancelButtonTitle,confirmButtonText:o.deleteModalSubmitButtonTitle,isLoading:d,"data-test-subj":"remove-from-policy-dialog"},s.a.createElement(ee.EuiCallOut,{color:"warning",iconType:"help"},s.a.createElement("p",null,o.deleteModalImpactInfo)),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("p",null,o.deleteModalConfirmInfo)))})),YZ=Object.freeze({deleteModalTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.title",{defaultMessage:"Remove artifact from policy"}),deleteModalImpactInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.messageCallout",{defaultMessage:"This artifact will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalConfirmInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.message",{defaultMessage:"Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.confirmLabel",{defaultMessage:"Remove from policy"}),deleteModalCancelButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.cancelLabel",{defaultMessage:"Cancel"}),deleteModalSuccessMessageTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastTitle",{defaultMessage:"Successfully removed"}),deleteModalSuccessMessageText:(e,t)=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastText",{defaultMessage:'"{artifactName}" has been removed from {policyName} policy',values:{artifactName:e.name,policyName:t}}),deleteModalErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove artifact"})}),XZ=Object.freeze({layoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.title",{defaultMessage:"Assigned artifacts"}),layoutAssignButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.assignToPolicy",{defaultMessage:"Assign artifact to policy"}),layoutViewAllLinkMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about.viewAllLinkLabel",{defaultMessage:"view all artifacts"}),layoutAboutMessage:(e,t)=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about",{defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {artifact} other {artifacts}} associated with this policy. Click here to view all artifacts",values:{count:e}})}),eK=Object.freeze({...XZ,...YZ,...ZZ,...FZ,...PZ,...QZ}),tK=s.a.memo((({policyItem:e,labels:t={},getExceptionsListApiClient:a,searchableFields:n,getArtifactPath:i,getPolicyArtifactsPath:o,canWriteArtifact:c=!1})=>{const u=Object(r.useMemo)((()=>a()),[a]),{getAppUrl:d}=Object(h.c)(),p=Object(uZ.b)(u.listId),{canCreateArtifactsByPolicy:m}=Object(Dt.a)().endpointPrivileges,{urlParams:f}=Object(IZ.a)(),[b,g]=Object(r.useState)(),y=Object(r.useMemo)((()=>({...eK,...t})),[t]),{data:v,isLoading:E}=Object(CZ.e)(u,{policies:e?[e.id,"all"]:[]},n),{data:x,isLoading:j,isRefetching:S}=Object(CZ.e)(u,{},n,{},["allExisting"]),O=Object(r.useCallback)((()=>{p({show:"list"})}),[p]),k=Object(r.useCallback)((()=>{p({show:void 0})}),[p]),w=Object(r.useCallback)((()=>{g(void 0)}),[g]),T=Object(r.useCallback)((e=>{g(e)}),[g]),I=Object(r.useMemo)((()=>s.a.createElement(ee.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"artifacts-assign-button",onClick:O},y.layoutAssignButtonTitle)),[O,y.layoutAssignButtonTitle]),C=Object(r.useMemo)((()=>{const e=s.a.createElement(ee.EuiLink,{href:d({appId:l.l,path:i()}),target:"_blank"},y.layoutViewAllLinkMessage);return y.layoutAboutMessage((null==v?void 0:v.total)||0,e)}),[d,i,y,null==v?void 0:v.total]),M=Object(r.useMemo)((()=>E||j||S),[E,j,S]),_=Object(r.useMemo)((()=>v&&0===v.total),[v]);return!e||M?s.a.createElement(TZ.a,{"data-test-subj":"policy-artifacts-loading-spinner"}):_?s.a.createElement(s.a.Fragment,null,m&&"list"===f.show&&s.a.createElement(WZ,{policyItem:e,apiClient:u,searchableFields:[...n],onClose:k,labels:y}),x&&0!==x.total?s.a.createElement(_Z,{policyId:e.id,policyName:e.name,listId:u.listId,labels:y,canWriteArtifact:c,getPolicyArtifactsPath:o,getArtifactPath:i}):s.a.createElement(AZ,{policyId:e.id,policyName:e.name,labels:y,canWriteArtifact:c,getPolicyArtifactsPath:o,getArtifactPath:i})):s.a.createElement("div",null,s.a.createElement(ee.EuiPageHeader,{alignItems:"center"},s.a.createElement(ee.EuiPageHeaderSection,{"data-test-subj":"policy-artifacts-header-section"},s.a.createElement(ee.EuiTitle,{size:"m"},s.a.createElement("h2",null,y.layoutTitle)),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiText,{size:"xs","data-test-subj":"policy-artifacts-layout-about"},s.a.createElement("p",null,C))),s.a.createElement(ee.EuiPageHeaderSection,null,m&&c&&I)),m&&c&&"list"===f.show&&s.a.createElement(WZ,{policyItem:e,apiClient:u,searchableFields:[...n],onClose:k,labels:y}),b&&s.a.createElement(JZ,{policyId:e.id,policyName:e.name,apiClient:u,exception:b,onClose:w,labels:y}),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiPageSection,{paddingSize:"none",color:"transparent"},s.a.createElement(HZ,{policy:e,apiClient:u,searchableFields:[...n],labels:y,onDeleteActionCallback:T,canWriteArtifact:c,getPolicyArtifactsPath:o,getArtifactPath:i})))}));tK.displayName="PolicyArtifactsLayout";const aK=Object.freeze({deleteModalTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.title",{defaultMessage:"Remove event filter from policy"}),deleteModalImpactInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.messageCallout",{defaultMessage:"This event filter will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove event filter"}),flyoutWarningCalloutMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} event filters are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.noAssignable",{defaultMessage:"There are no event filters that can be assigned to this policy."}),flyoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.title",{defaultMessage:"Assign event filters"}),flyoutSubtitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.subtitle",{defaultMessage:"Select event filters to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.search.label",{defaultMessage:"Search event filters"}),flyoutErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating event filters"}),flyoutSuccessMessageText:e=>e.length>1?Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} event filters have been added to your list.",values:{count:e.length}}):Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your event filter list.',values:{name:e[0].name}}),emptyUnassignedTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.title",{defaultMessage:"No assigned event filters"}),emptyUnassignedMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.content",{defaultMessage:"There are currently no event filters assigned to {policyName}. Assign event filters now or add and manage them on the event filters page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.primaryAction",{defaultMessage:"Assign event filters"}),emptyUnassignedSecondaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.secondaryAction",{defaultMessage:"Manage event filters"}),emptyUnassignedNoPrivilegesMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.noPrivileges.content",{defaultMessage:"There are currently no event filters assigned to {policyName}",values:{policyName:e}}),emptyUnexistingTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.title",{defaultMessage:"No event filters exist"}),emptyUnexistingMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.content",{defaultMessage:"There are currently no event filters applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.action",{defaultMessage:"Add event filters"}),listTotalItemCountMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# event filter} other {# event filters}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeActionNotAllowed",{defaultMessage:"Globally applied event filter cannot be removed from policy."}),listSearchPlaceholderMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, comments, value"}),layoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.title",{defaultMessage:"Assigned event filters"}),layoutAssignButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.assignToPolicy",{defaultMessage:"Assign event filters to policy"}),layoutViewAllLinkMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.about.viewAllLinkLabel",{defaultMessage:"view all event filters"})}),nK=Object.freeze({deleteModalTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.title",{defaultMessage:"Remove trusted application from policy"}),deleteModalImpactInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.messageCallout",{defaultMessage:"This trusted application will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove trusted app"}),flyoutWarningCalloutMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} trusted applications are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noAssignable",{defaultMessage:"There are no trusted applications that can be assigned to this policy."}),flyoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.title",{defaultMessage:"Assign trusted applications"}),flyoutSubtitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.subtitle",{defaultMessage:"Select trusted applications to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.search.label",{defaultMessage:"Search trusted applications"}),flyoutErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating trusted applications"}),flyoutSuccessMessageText:e=>e.length>1?Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} trusted applications have been added to your list.",values:{count:e.length}}):Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your trusted application list.',values:{name:e[0].name}}),emptyUnassignedTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.title",{defaultMessage:"No assigned trusted applications"}),emptyUnassignedMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.content",{defaultMessage:"There are currently no trusted applications assigned to {policyName}. Assign trusted applications now or add and manage them on the trusted applications page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.primaryAction",{defaultMessage:"Assign trusted applications"}),emptyUnassignedSecondaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.secondaryAction",{defaultMessage:"Manage trusted applications"}),emptyUnassignedNoPrivilegesMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.noPrivileges.content",{defaultMessage:"There are currently no trusted applications assigned to {policyName}.",values:{policyName:e}}),emptyUnexistingTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.title",{defaultMessage:"No trusted applications exist"}),emptyUnexistingMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.content",{defaultMessage:"There are currently no trusted applications applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.action",{defaultMessage:"Add trusted applications"}),listTotalItemCountMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted app} other {# trusted applications}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeActionNotAllowed",{defaultMessage:"Globally applied trusted application cannot be removed from policy."}),listSearchPlaceholderMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.title",{defaultMessage:"Assigned trusted applications"}),layoutAssignButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.assignToPolicy",{defaultMessage:"Assign trusted applications to policy"}),layoutViewAllLinkMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.about.viewAllLinkLabel",{defaultMessage:"view all trusted applications"})}),iK=Object.freeze({deleteModalTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.title",{defaultMessage:"Remove host isolation exception from policy"}),deleteModalImpactInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.messageCallout",{defaultMessage:"This host isolation exception will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove host isolation exception"}),flyoutWarningCalloutMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} host isolation exceptions are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.noAssignable",{defaultMessage:"There are no host isolation exceptions that can be assigned to this policy."}),flyoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.title",{defaultMessage:"Assign host isolation exceptions"}),flyoutSubtitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.subtitle",{defaultMessage:"Select host isolation exceptions to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.search.label",{defaultMessage:"Search host isolation exceptions"}),flyoutErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating host isolation exceptions"}),flyoutSuccessMessageText:e=>e.length>1?Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} host isolation exceptions have been added to your list.",values:{count:e.length}}):Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e[0].name}}),emptyUnassignedTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.title",{defaultMessage:"No assigned host isolation exceptions"}),emptyUnassignedMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.content",{defaultMessage:"There are currently no host isolation exceptions assigned to {policyName}. Assign host isolation exceptions now or add and manage them on the host isolation exceptions page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.primaryAction",{defaultMessage:"Assign host isolation exceptions"}),emptyUnassignedSecondaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.secondaryAction",{defaultMessage:"Manage host isolation exceptions"}),emptyUnassignedNoPrivilegesMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.noPrivileges.content",{defaultMessage:"There are currently no host isolation exceptions assigned to {policyName}.",values:{policyName:e}}),emptyUnexistingTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.title",{defaultMessage:"No host isolation exceptions exist"}),emptyUnexistingMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.content",{defaultMessage:"There are currently no host isolation exceptions applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.action",{defaultMessage:"Add host isolation exceptions"}),listTotalItemCountMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# host isolation exception} other {# host isolation exceptions}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeActionNotAllowed",{defaultMessage:"Globally applied host isolation exception cannot be removed from policy."}),listSearchPlaceholderMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, IP"}),layoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.title",{defaultMessage:"Assigned host isolation exceptions"}),layoutAssignButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.assignToPolicy",{defaultMessage:"Assign host isolation exceptions to policy"}),layoutViewAllLinkMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.about.viewAllLinkLabel",{defaultMessage:"view all host isolation exceptions"})}),rK=Object.freeze({deleteModalTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.title",{defaultMessage:"Remove blocklist entry from policy"}),deleteModalImpactInfo:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.messageCallout",{defaultMessage:"This blocklist entry will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove blocklist entry"}),flyoutWarningCalloutMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} blocklist entries are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.noAssignable",{defaultMessage:"There are no blocklist entries that can be assigned to this policy."}),flyoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.title",{defaultMessage:"Assign blocklist entries"}),flyoutSubtitle:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.subtitle",{defaultMessage:"Select blocklist entries to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.search.label",{defaultMessage:"Search blocklist entries"}),flyoutErrorMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating blocklist entry"}),flyoutSuccessMessageText:e=>e.length>1?Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} blocklist entries have been added to your list.",values:{count:e.length}}):Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" blocklist has been added to your list.',values:{name:e[0].name}}),emptyUnassignedTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.title",{defaultMessage:"No assigned blocklist entries"}),emptyUnassignedMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.content",{defaultMessage:"There are currently no blocklist entries assigned to {policyName}. Assign blocklist entries now or add and manage them on the blocklist page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.primaryAction",{defaultMessage:"Assign blocklist entry"}),emptyUnassignedSecondaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.secondaryAction",{defaultMessage:"Manage blocklist entries"}),emptyUnassignedNoPrivilegesMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.noPrivileges.content",{defaultMessage:"There are currently no blocklist entries assigned to {policyName}.",values:{policyName:e}}),emptyUnexistingTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.title",{defaultMessage:"No blocklists entries exist"}),emptyUnexistingMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.content",{defaultMessage:"There are currently no blocklist entries applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.action",{defaultMessage:"Add blocklist entry"}),listTotalItemCountMessage:e=>Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklists.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# blocklist entry} other {# blocklist entries}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeActionNotAllowed",{defaultMessage:"Globally applied blocklist cannot be removed from policy."}),listSearchPlaceholderMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.title",{defaultMessage:"Assigned blocklist entries"}),layoutAssignButtonTitle:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.assignToPolicy",{defaultMessage:"Assign blocklist entry to policy"}),layoutViewAllLinkMessage:Y.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.about.viewAllLinkLabel",{defaultMessage:"view all blocklist entries"})});var sK,oK=a(952),lK=a(1107),cK=a(888),uK=a(954),dK=a(953),pK=a(1108),mK=a(737),fK=a(1077);!function(e){e.SETTINGS="settings",e.TRUSTED_APPS="trustedApps",e.EVENT_FILTERS="eventFilters",e.HOST_ISOLATION_EXCEPTIONS="hostIsolationExceptions",e.BLOCKLISTS="blocklists",e.PROTECTION_UPDATES="protectionUpdates"}(sK||(sK={}));const bK=s.a.memo((()=>{const e=Object(k.useHistory)(),t=Object(h.h)(),a=Object(h.m)(),n=Object(uZ.c)(dZ.g),i=Object(uZ.c)(dZ.h),o=Object(uZ.c)(dZ.f),l=Object(uZ.c)(dZ.e),c=Object(uZ.c)(dZ.d),u=Object(uZ.c)(dZ.i),d=Object(uZ.c)(dZ.k),p=Object(uZ.c)(dZ.j),{canReadTrustedApplications:m,canWriteTrustedApplications:f,canReadEventFilters:b,canWriteEventFilters:g,canReadHostIsolationExceptions:y,canWriteHostIsolationExceptions:v,canReadBlocklist:E,canWriteBlocklist:x,loading:j}=Object(Dt.a)().endpointPrivileges,{state:S={}}=Object(k.useLocation)(),w=Object(ve.a)("protectionUpdatesEnabled"),T=Object(be.b)().isEnterprise()&&w;Object(r.useEffect)((()=>{(i&&!m||o&&!b||l&&!y||c&&!E)&&(e.replace(Object(O.j)(d)),a.addDanger(Y.i18n.translate("xpack.securitySolution.policyDetails.missingArtifactAccess",{defaultMessage:"You do not have the required Kibana permissions to use the given artifact."})))}),[E,b,y,m,e,c,o,l,u,i,d,a]);const I=Object(r.useCallback)((()=>oK.a.getInstance(t)),[t]),C=Object(r.useCallback)((()=>lK.a.getInstance(t)),[t]),M=Object(r.useCallback)((()=>uK.a.getInstance(t)),[t]),_=Object(r.useCallback)((()=>cK.a.getInstance(t)),[t]),A=Object(r.useMemo)((()=>{const e={...nK,layoutAboutMessage:(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} trusted {count, plural, =1 {application} other {applications}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},t={...aK,layoutAboutMessage:(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.eventFilters.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} event {count, plural, =1 {filter} other {filters}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},a={...iK,layoutAboutMessage:(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.hostIsolationExceptions.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} host isolation {count, plural, =1 {exception} other {exceptions}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},n={...rK,layoutAboutMessage:(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.blocklist.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {blocklist} other {blocklist entries}} associated with this policy. Click here to {link}",values:{count:e,link:t}})};return{[sK.SETTINGS]:{id:sK.SETTINGS,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.policyForm",{defaultMessage:"Policy settings"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(wZ,{policy:p}))},[sK.TRUSTED_APPS]:m?{id:sK.TRUSTED_APPS,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.trustedApps",{defaultMessage:"Trusted applications"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(tK,{policyItem:p,labels:e,getExceptionsListApiClient:I,searchableFields:dK.a,getArtifactPath:O.p,getPolicyArtifactsPath:O.k,canWriteArtifact:f}))}:void 0,[sK.EVENT_FILTERS]:b?{id:sK.EVENT_FILTERS,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.eventFilters",{defaultMessage:"Event filters"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(tK,{policyItem:p,labels:t,getExceptionsListApiClient:C,searchableFields:pK.d,getArtifactPath:O.f,getPolicyArtifactsPath:O.l,canWriteArtifact:g}))}:void 0,[sK.HOST_ISOLATION_EXCEPTIONS]:y?{id:sK.HOST_ISOLATION_EXCEPTIONS,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.isInHostIsolationExceptions",{defaultMessage:"Host isolation exceptions"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(tK,{policyItem:p,labels:a,getExceptionsListApiClient:M,searchableFields:mK.b,getArtifactPath:O.g,getPolicyArtifactsPath:O.m,canWriteArtifact:v}))}:void 0,[sK.BLOCKLISTS]:E?{id:sK.BLOCKLISTS,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.blocklists",{defaultMessage:"Blocklist"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(tK,{policyItem:p,labels:n,getExceptionsListApiClient:_,searchableFields:fK.b,getArtifactPath:O.c,getPolicyArtifactsPath:O.i,canWriteArtifact:x}))}:void 0,[sK.PROTECTION_UPDATES]:T?{id:sK.PROTECTION_UPDATES,name:Y.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.protectionUpdates",{defaultMessage:"Protection updates"}),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,null),s.a.createElement(jZ,{policy:p}))}:void 0}}),[p,m,I,f,b,C,g,y,M,v,E,_,x,T]),F=Object(r.useMemo)((()=>Object.values(A).filter((e=>void 0!==e))),[A]),P=Object(r.useMemo)((()=>{const e=A[sK.SETTINGS];let t;return n?t=A[sK.SETTINGS]:i?t=A[sK.TRUSTED_APPS]:o?t=A[sK.EVENT_FILTERS]:l?t=A[sK.HOST_ISOLATION_EXCEPTIONS]:c?t=A[sK.BLOCKLISTS]:u&&(t=A[sK.PROTECTION_UPDATES]),t||e}),[A,n,i,o,l,c,u]),D=Object(r.useCallback)((t=>{let a="";switch(t.id){case sK.SETTINGS:a=Object(O.j)(d);break;case sK.TRUSTED_APPS:a=Object(O.o)(d);break;case sK.EVENT_FILTERS:a=Object(O.l)(d);break;case sK.HOST_ISOLATION_EXCEPTIONS:a=Object(O.m)(d);break;case sK.BLOCKLISTS:a=Object(O.i)(d);break;case sK.PROTECTION_UPDATES:a=Object(O.n)(d)}e.push(a,null!=S&&S.backLink?{backLink:S.backLink}:null)}),[e,d,S]);return j?s.a.createElement(TZ.a,{"data-test-subj":"privilegesLoading"}):s.a.createElement(ee.EuiTabbedContent,{tabs:F,selectedTab:P,size:"l",onTabClick:D})}));bK.displayName="PolicyTabs";const gK=s.a.memo((()=>{var e,t,a,n,i,o;const{state:c={}}=Object(k.useLocation)(),{getAppUrl:u}=Object(h.c)(),d=Object(uZ.c)(dZ.b),p=Object(uZ.c)(dZ.j),m=Object(uZ.c)(dZ.a),f=null!==(e=null==p?void 0:p.name)&&void 0!==e?e:"",b=null!==(t=null==p?void 0:p.description)&&void 0!==t?t:void 0,g=Object(r.useMemo)((()=>{if(null!=c&&c.backLink)return{onBackButtonNavigateTo:c.backLink.navigateTo,backButtonLabel:c.backLink.label,backButtonUrl:c.backLink.href};const e=Object(O.h)();return{backButtonLabel:Y.i18n.translate("xpack.securitySolution.policyDetails.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:u({path:e}),onBackButtonNavigateTo:[l.l,{path:e}]}}),[u,null==c?void 0:c.backLink]),y=s.a.createElement(pZ,{total:null!==(a=null==m?void 0:m.total)&&void 0!==a?a:0,online:null!==(n=null==m?void 0:m.online)&&void 0!==n?n:0,offline:null!==(i=null==m?void 0:m.offline)&&void 0!==i?i:0,error:null!==(o=null==m?void 0:m.error)&&void 0!==o?o:0}),v=s.a.createElement(WW.a,bo()({},g,{"data-test-subj":"policyDetailsBackLink"})),E=Object(r.useMemo)((()=>d?s.a.createElement(ee.EuiPageTemplate.Section,{grow:!1,alignment:"center"},s.a.createElement(ee.EuiCallOut,{color:"danger",title:null==d?void 0:d.error},s.a.createElement("span",{"data-test-subj":"policyDetailsIdNotFoundMessage"},null==d?void 0:d.message))):p?s.a.createElement(bK,null):s.a.createElement(ee.EuiPageTemplate.Section,{grow:!1,alignment:"center"},s.a.createElement(ee.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":"policyDetailsLoading"}))),[d,p]);return s.a.createElement(HW.a,{"data-test-subj":"policyDetailsPage",title:f,subtitle:b,headerBackComponent:v,actions:d?void 0:y,restrictWidth:!0,hasBottomBorder:!1},E)}));gK.displayName="PolicyDetails";const yK=Object(r.memo)((()=>{const e=Object(ve.a)("protectionUpdatesEnabled"),t=Object(be.b)().isEnterprise()&&e;return s.a.createElement(K.c,null,s.a.createElement(K.a,{path:[aW.n,aW.r,aW.m,aW.o,aW.l,...t?[aW.q]:[]],exact:!0,component:gK}),s.a.createElement(K.a,{path:aW.p,exact:!0,render:e=>s.a.createElement(k.Redirect,{to:Object(O.j)(e.match.params.policyId)})}),s.a.createElement(K.a,{path:aW.k,exact:!0,component:cZ}),s.a.createElement(K.a,{path:"*",component:J.a}))}));yK.displayName="PolicyContainer";var hK=a(1320),vK=a(1409);const EK=[32,40,64],xK=/[^0-9a-f]/i,jK=e=>EK.includes(e.length)&&!xK.test(e),SK=e=>e.field!==Mq.a.SIGNER,OK=Y.i18n.translate("xpack.securitySolution.trustedApps.name.label",{defaultMessage:"Name"}),kK=Y.i18n.translate("xpack.securitySolution.trustedApps.details.header",{defaultMessage:"Details"}),wK=Y.i18n.translate("xpack.securitySolution.trustedApps.details.header.description",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),TK=Y.i18n.translate("xpack.securitySolution.trustedapps.create.description",{defaultMessage:"Description"}),IK=Y.i18n.translate("xpack.securitySolution.trustedApps.conditions.header",{defaultMessage:"Conditions"}),CK=Y.i18n.translate("xpack.securitySolution.trustedApps.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),MK=Y.i18n.translate("xpack.securitySolution.trustedApps.os.label",{defaultMessage:"Select operating system"}),_K={[Mq.a.HASH]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.hash",{defaultMessage:"Hash"}),[Mq.a.PATH]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.path",{defaultMessage:"Path"}),[Mq.a.SIGNER]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.signature",{defaultMessage:"Signature"})},AK={[Mq.a.HASH]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),[Mq.a.PATH]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.path",{defaultMessage:"The full path of the application"}),[Mq.a.SIGNER]:Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.signature",{defaultMessage:"The signer of the application"})},FK={is:Y.i18n.translate("xpack.securitySolution.trustedapps.card.operator.is",{defaultMessage:"is"}),matches:Y.i18n.translate("xpack.securitySolution.trustedapps.card.operator.matches",{defaultMessage:"matches"})},PK={field:Y.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.field",{defaultMessage:"Field"}),operator:Y.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.operator",{defaultMessage:"Operator"}),value:Y.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.value",{defaultMessage:"Value"})},DK=Y.i18n.translate("xpack.securitySolution.trustedApps.assignmentSectionDescription",{defaultMessage:"Assign this trusted application globally across all policies, or assign it to specific policies."}),NK={name:Y.i18n.translate("xpack.securitySolution.trustedapps.create.nameRequiredMsg",{defaultMessage:"Name is required"}),os:Y.i18n.translate("xpack.securitySolution.trustedapps.create.osRequiredMsg",{defaultMessage:"Operating System is required"}),field:Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionRequiredMsg",{defaultMessage:"At least one Field definition is required"}),noDuplicateField:e=>Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDuplicatedMsg",{defaultMessage:"{field} cannot be added more than once",values:{field:_K[e]}}),mustHaveValue:e=>Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldValueRequiredMsg",{defaultMessage:"[{row}] Field entry must have a value",values:{row:e+1}}),invalidHash:e=>Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidHashMsg",{defaultMessage:"[{row}] Invalid hash value",values:{row:e+1}}),pathWarning:e=>Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidPathMsg",{defaultMessage:"[{row}] Path may be formed incorrectly; verify value",values:{row:e+1}}),wildcardPathWarning:e=>Y.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDegradedPerformanceMsg",{defaultMessage:"[{row}] A wildcard in the filename will affect the endpoint's performance",values:{row:e+1}})};var RK=a(880);const LK=({os:e,field:t,type:a})=>{if(t===Mq.a.PATH)return e===Mq.c.WINDOWS?"wildcard"===a?"C:\\sample\\*\\path.exe":"C:\\sample\\path.exe":"wildcard"===a?"/opt/*/app":"/opt/bin"},BK=Object(r.memo)((({showLabel:e,label:t="",children:a})=>e?s.a.createElement(ee.EuiFormRow,{label:t,fullWidth:!0},a):s.a.createElement(s.a.Fragment,null,a)));BK.displayName="ConditionEntryCell";const zK=ae.a.div.withConfig({displayName:"InputGroup",componentId:"sc-1uhidgu-0"})(["display:grid;grid-template-columns:25% 25% 45% 5%;grid-template-areas:'field operator value remove';"]),qK=ae.a.div.withConfig({displayName:"InputItem",componentId:"sc-1uhidgu-1"})(["grid-area:",";align-self:center;margin:4px;vertical-align:baseline;"],(({gridArea:e})=>e)),$K=Object.keys(AW.d).map((e=>({dropdownDisplay:FK[e],inputDisplay:FK[e],value:"matches"===e?"wildcard":"match"}))),VK=Object(r.memo)((({os:e,entry:t,showLabels:a=!1,onRemove:n,onChange:i,isRemoveDisabled:o=!1,onVisited:l,"data-test-subj":c})=>{const u=Object(BZ.a)(c),[d,p]=Object(r.useState)(!1),m=Object(r.useCallback)((()=>{null==l||l(t),d||p(!0)}),[t,d,l]),f=Object(r.useMemo)((()=>{const t=e=>s.a.createElement(s.a.Fragment,null,_K[e],s.a.createElement(ee.EuiText,{size:"xs",color:"subdued"},AK[e]));return[{dropdownDisplay:t(Mq.a.HASH),inputDisplay:_K[Mq.a.HASH],value:Mq.a.HASH,"data-test-subj":u(`field-type-${_K[Mq.a.HASH]}`)},{dropdownDisplay:t(Mq.a.PATH),inputDisplay:_K[Mq.a.PATH],value:Mq.a.PATH,"data-test-subj":u(`field-type-${_K[Mq.a.PATH]}`)},...e===Mq.c.WINDOWS?[{dropdownDisplay:t(Mq.a.SIGNER),inputDisplay:_K[Mq.a.SIGNER],value:Mq.a.SIGNER,"data-test-subj":u(`field-type-${_K[Mq.a.SIGNER]}`)}]:[]]}),[u,e]),b=Object(r.useCallback)((e=>i({...t,value:e.target.value},t)),[t,i]),g=Object(r.useCallback)((e=>{i({...t,field:e},t),t.value&&m()}),[m,t,i]),y=Object(r.useCallback)((e=>i({...t,type:e},t)),[t,i]),h=Object(r.useCallback)((()=>n(t)),[t,n]),v=Object(r.useCallback)((()=>{m()}),[m]);return s.a.createElement(zK,{"data-test-subj":c},s.a.createElement(qK,{gridArea:"field"},s.a.createElement(BK,{showLabel:a,label:PK.field},s.a.createElement(ee.EuiSuperSelect,{options:f,valueOfSelected:t.field,onChange:g,"data-test-subj":u("field")}))),s.a.createElement(qK,{gridArea:"operator"},s.a.createElement(BK,{showLabel:a,label:PK.operator},t.field===Mq.a.PATH?s.a.createElement(ee.EuiSuperSelect,{options:$K,onChange:y,valueOfSelected:t.type,"data-test-subj":u("operator")}):s.a.createElement(ee.EuiFieldText,{name:"operator",value:FK.is,"data-test-subj":u("operator"),readOnly:!0}))),s.a.createElement(qK,{gridArea:"value"},s.a.createElement(BK,{showLabel:a,label:PK.value},s.a.createElement(ee.EuiFieldText,{name:"value",value:t.value,placeholder:LK({os:e,field:t.field,type:t.type}),fullWidth:!0,required:d,onChange:b,onBlur:v,"data-test-subj":u("value")}))),s.a.createElement(qK,{gridArea:"remove"},s.a.createElement(BK,{showLabel:a,label:"Â "},s.a.createElement(ee.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:h,isDisabled:o,"aria-label":Y.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.removeLabel",{defaultMessage:"Remove Entry"}),"data-test-subj":u("remove")}))))}));VK.displayName="ConditionEntryInput";const UK=ae()(ee.EuiFlexGroup).withConfig({displayName:"ConditionGroupFlexGroup",componentId:"sc-1w3ghq9-0"})([".and-badge{padding-top:20px;padding-bottom:",";}.group-entries{margin-bottom:",";& > *{margin-bottom:",";&:last-child{margin-bottom:0;}}}.and-button{min-width:95px;}"],(({theme:e})=>`calc(${e.eui.euiButtonHeightSmall} + (${e.eui.euiSizeS} * 2) + 3px);`),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),HK=Object(r.memo)((({os:e,entries:t,onEntryRemove:a,onEntryChange:n,onAndClicked:i,isAndDisabled:r,onVisited:o,"data-test-subj":l})=>{const c=Object(BZ.a)(l);return s.a.createElement(UK,{gutterSize:"xs","data-test-subj":l},t.length>1&&s.a.createElement(ee.EuiHideFor,{sizes:["xs","s"]},s.a.createElement(ee.EuiFlexItem,{grow:!1,"data-test-subj":c("andConnector"),className:"and-badge"},s.a.createElement(PB.a,{type:"and",includeAntennas:!0}))),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement("div",{"data-test-subj":c("entries"),className:"group-entries"},t.map(((i,r)=>s.a.createElement(VK,{key:r,os:e,entry:i,showLabels:0===r,isRemoveDisabled:0===r&&t.length<=1,onRemove:a,onChange:n,onVisited:o,"data-test-subj":c(`entry${r}`)})))),s.a.createElement("div",null,s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiButton,{size:"s",iconType:"plusInCircle",onClick:i,"data-test-subj":c("AndButton"),isDisabled:r,className:"and-button"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.group.andOperator",defaultMessage:"AND"})))))}));HK.displayName="ConditionGroup";const QK=Object(r.memo)((({entries:e,os:t,className:a,isAndDisabled:n=!1,onAndClicked:i,onEntryRemove:r,onEntryChange:o,onVisited:l,"data-test-subj":c})=>{const u=Object(BZ.a)(c);return s.a.createElement("div",{"data-test-subj":c,className:a},s.a.createElement("div",null,0===e.length?s.a.createElement(GK,null):s.a.createElement(HK,{os:t,entries:e,onEntryRemove:r,onEntryChange:o,onAndClicked:i,isAndDisabled:n,onVisited:l,"data-test-subj":u("group1")})))}));QK.displayName="LogicalConditionBuilder";const GK=Object(r.memo)((()=>s.a.createElement(ee.EuiPanel,{paddingSize:"l"},s.a.createElement(ee.EuiText,{textAlign:"center",size:"s",color:"subdued"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.noEntries",defaultMessage:"No conditions defined"})))));GK.displayName="NoEntries";var WK=a(1331);const ZK=Object(r.memo)((()=>{const{docLinks:{links:{securitySolution:e}}}=Object(h.i)().services;return s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoStart",defaultMessage:"Have too many alerts? Add an "}),s.a.createElement(ee.EuiLink,{target:"_blank",href:`${e.endpointArtifacts}`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkText",defaultMessage:"endpoint alert exception"})),s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoEnd",defaultMessage:" instead."}))}));ZK.displayName="TrustedAppsArtifactsDocsLink";const KK=(e,t,a,n)=>{e.result[t]||(e.result[t]={isInvalid:!1,errors:[],warnings:[]});const i="warnings"===a?s.a.createElement("div",null,n):n;e.result[t][a].push(i),e.result[t].isInvalid=!0},JK=e=>{var t,a;let n=!0;const i={isValid:n,result:{}};e.name.trim()||(n=!1,KK(i,"name","errors",NK.name)),e.os_types||(n=!1,KK(i,"os","errors",NK.os));const r=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Mq.c.WINDOWS;if(e.entries.length){const t=(e=>{const t=new Map;return e.forEach((e=>{const a=e.field.startsWith("process.hash")?Mq.a.HASH:e.field;t.set(a,[...t.get(a)||[],e])})),[...t.entries()].filter((e=>e[1].length>1)).map((e=>e[0]))})(e.entries);t.length&&(n=!1,t.forEach((e=>{KK(i,"entries","errors",NK.noDuplicateField(e))}))),e.entries.forEach(((e,t)=>{const a=Object(Mq.i)({os:r,field:e.field,type:e.type,value:e.value});e.field&&e.value.trim()?e.field!==Mq.a.HASH||jK(e.value)?a?a&&!Object(Mq.h)({os:r,value:e.value,type:e.type})&&KK(i,"entries","warnings",NK.wildcardPathWarning(t)):KK(i,"entries","warnings",NK.pathWarning(t)):(n=!1,KK(i,"entries","errors",NK.invalidHash(t))):(n=!1,KK(i,"entries","errors",NK.mustHaveValue(t)))}))}else n=!1,KK(i,"entries","errors",NK.field);return i.isValid=n,i},YK=()=>({field:Mq.a.HASH,operator:"included",type:"match",value:""}),XK=Object(r.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:n,mode:i})=>{var o,l,c,u,d,p,m;const f=Object(BZ.a)("trustedApps-form"),[b,g]=Object(r.useState)({}),[y,h]=Object(r.useState)([]),v=Object(be.b)().isPlatinumPlus(),E=Object(r.useMemo)((()=>Object(KZ.e)(e)),[e]),[x,j]=Object(r.useState)(!Object(UZ.d)(e.tags)),[S,O]=Object(r.useState)(!1);Object(r.useEffect)((()=>{!S&&e.tags&&j(!Object(UZ.d)(e.tags))}),[e.tags,S]),Object(r.useEffect)((()=>{if(S)return;const a=e.tags?Object(KZ.c)({tags:e.tags}):[];if(!a.length)return;const n=t.filter((e=>a.includes(e.id)));h(n)}),[S,e,t]);const k=Object(r.useMemo)((()=>v||"edit"===i&&(!E||x&&E&&S)),[i,E,S,v,x]),[w,T]=Object(r.useState)((()=>JK(e))),I=Object(r.useCallback)((e=>{const t=JK(e);T(t),n({item:e,isValid:t.isValid})}),[n]),C=Object(r.useCallback)((t=>{const a=t.isGlobal?[Tc.d]:t.selected.map((e=>`${Tc.b}${e.id}`)),n={...e,tags:a};t.isGlobal||h(t.selected),I(n),O(!0)}),[e,I]),M=Object(r.useCallback)((t=>{const a={...e,[t.target.name]:t.target.value};I(a),O(!0)}),[e,I]),_=Object(r.useCallback)((({target:{name:t}})=>{I(e),g((e=>({...e,[t]:!0})))}),[e,I]),A=Object(r.useMemo)((()=>[Mq.c.LINUX,Mq.c.MAC,Mq.c.WINDOWS].map((e=>({value:e,inputDisplay:RK.a[e]})))),[]),F=Object(r.useCallback)((t=>{g((e=>({...e,os:!0})));const a={...e,os_types:[t],entries:[]};if(t!==Mq.c.WINDOWS){const t=e.entries.filter((e=>SK(e)));a.entries.push(...t),0===e.entries.length&&a.entries.push(YK())}else a.entries.push(...e.entries);I(a),O(!0)}),[e,I]),P=Object(r.useCallback)((()=>{g((e=>({...e,entries:!0})))}),[]),D=Object(r.useCallback)(((t,a)=>{const n={...e,entries:e.entries.map((e=>e===a?t:e))};I(n),O(!0)}),[e,I]),N=Object(r.useCallback)((t=>{const a={...e,entries:e.entries.filter((e=>e!==t))};I(a),O(!0)}),[e,I]),R=Object(r.useCallback)((()=>{var t,a;const n={...e,entries:[]};(null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Mq.c.WINDOWS)===Mq.c.WINDOWS?n.entries=[...e.entries,YK()].filter((e=>e.field===Mq.a.SIGNER||!0)):n.entries=[...e.entries.filter((e=>SK(e))),YK()],I(n),O(!0)}),[e,I]),L=Object(r.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:Mq.c.WINDOWS}),[null==e?void 0:e.os_types]),B=Object(r.useMemo)((()=>{const t=e;return t.entries=e.entries.length?e.entries:[YK()],t}),[e]);return s.a.createElement(ee.EuiForm,{component:"div","data-test-subj":f("")},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h3",null,kK)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),"create"===i&&s.a.createElement(ee.EuiText,{size:"s","data-test-subj":f("about")},s.a.createElement("p",null,wK,s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ZK,null)))),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{label:OK,fullWidth:!0,"data-test-subj":f("nameRow"),isInvalid:b.name&&(null===(o=w.result.name)||void 0===o?void 0:o.isInvalid),error:null===(l=w.result.name)||void 0===l?void 0:l.errors},s.a.createElement(ee.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:_,fullWidth:!0,required:b.name,maxLength:256,"data-test-subj":f("nameTextField")})),s.a.createElement(ee.EuiFormRow,{label:TK,fullWidth:!0,"data-test-subj":f("descriptionRow")},s.a.createElement(ee.EuiTextArea,{name:"description",value:e.description,onChange:M,fullWidth:!0,compressed:!0,maxLength:256,"data-test-subj":f("descriptionField")})),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiText,{size:"xs"},s.a.createElement("h3",null,IK)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(ee.EuiText,{size:"s"},CK),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{label:MK,fullWidth:!0,"data-test-subj":f("OsRow"),isInvalid:(null==b?void 0:b.os)&&(null===(c=w.result.os)||void 0===c?void 0:c.isInvalid),error:null===(u=w.result.os)||void 0===u?void 0:u.errors},s.a.createElement(ee.EuiSuperSelect,{name:"os",options:A,valueOfSelected:L,onChange:F,fullWidth:!0,"data-test-subj":f("osSelectField")})),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,"data-test-subj":f("conditionsRow"),isInvalid:b.entries&&(null===(d=w.result.entries)||void 0===d?void 0:d.isInvalid),error:null===(p=w.result.entries)||void 0===p?void 0:p.errors,helpText:null===(m=w.result.entries)||void 0===m?void 0:m.warnings},s.a.createElement(QK,{entries:B.entries,os:L,onAndClicked:R,onEntryRemove:N,onEntryChange:D,onVisited:P,"data-test-subj":f("conditionsBuilder")})),k?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,"data-test-subj":f("policySelection")},s.a.createElement(WK.a,{isGlobal:E,isPlatinumPlus:v,selected:y,options:t,onChange:C,isLoading:a,description:DK,"data-test-subj":f("effectedPolicies")}))):null)}));XK.displayName="TrustedAppsForm";const eJ={pageTitle:Y.i18n.translate("xpack.securitySolution.trustedApps.pageTitle",{defaultMessage:"Trusted applications"}),pageAboutInfo:Y.i18n.translate("xpack.securitySolution.trustedApps.pageAboutInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),pageAddButtonTitle:Y.i18n.translate("xpack.securitySolution.trustedApps.pageAddButtonTitle",{defaultMessage:"Add trusted application"}),getShowingCountLabel:e=>Y.i18n.translate("xpack.securitySolution.trustedApps.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {trusted application} other {trusted applications}}",values:{total:e}}),cardActionEditLabel:Y.i18n.translate("xpack.securitySolution.trustedApps.cardActionEditLabel",{defaultMessage:"Edit trusted application"}),cardActionDeleteLabel:Y.i18n.translate("xpack.securitySolution.trustedApps.cardActionDeleteLabel",{defaultMessage:"Delete trusted application"}),flyoutCreateTitle:Y.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateTitle",{defaultMessage:"Add trusted application"}),flyoutEditTitle:Y.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditTitle",{defaultMessage:"Edit trusted application"}),flyoutCreateSubmitButtonLabel:Y.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add trusted application"}),flyoutCreateSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your trusted applications.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),s.a.createElement(ee.EuiLink,{target:"_blank",href:`${e.trustedApps}`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsLink",defaultMessage:"Trusted applications documentation"}))),deleteActionSuccess:e=>Y.i18n.translate("xpack.securitySolution.trustedApps.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from trusted applications.',values:{itemName:e}}),emptyStateTitleNoEntries:Y.i18n.translate("xpack.securitySolution.trustedApps.emptyStateTitleNoEntries",{defaultMessage:"There are no trusted applications to display."}),emptyStateTitle:Y.i18n.translate("xpack.securitySolution.trustedApps.emptyStateTitle",{defaultMessage:"Add your first trusted application"}),emptyStateInfo:Y.i18n.translate("xpack.securitySolution.trustedApps.emptyStateInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),emptyStatePrimaryButtonLabel:Y.i18n.translate("xpack.securitySolution.trustedApps.emptyStatePrimaryButtonLabel",{defaultMessage:"Add trusted application"}),searchPlaceholderInfo:Y.i18n.translate("xpack.securitySolution.trustedApps.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},tJ=Object(r.memo)((()=>{const{canWriteTrustedApplications:e}=Object(Dt.a)().endpointPrivileges,t=Object(h.h)(),a=vK.a.getInstance(t);return s.a.createElement(hK.a,{apiClient:a,ArtifactFormComponent:XK,labels:eJ,"data-test-subj":"trustedAppsListPage",searchableFields:dK.a,secondaryPageInfo:s.a.createElement(ZK,null),allowCardDeleteAction:e,allowCardEditAction:e,allowCardCreateAction:e})}));tJ.displayName="TrustedAppsList";const aJ=Object(r.memo)((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.t,exact:!0,component:tJ}),s.a.createElement(K.a,{path:"*",component:J.a}))));aJ.displayName="TrustedAppsContainer";var nJ=a(1480);const iJ=()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.i,exact:!0,component:nJ.c}),s.a.createElement(K.a,{path:"*",component:J.a}));var rJ=a(10),sJ=a(1683),oJ=a.n(sJ);const lJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.placeholder",{defaultMessage:"Host isolation exception name"}),cJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.label",{defaultMessage:"Name your host isolation exceptions"}),uJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.error",{defaultMessage:"The name can't be empty"}),dJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.placeholder",{defaultMessage:"Describe your host isolation exception"}),pJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.label",{defaultMessage:"Description"}),mJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.placeholder",{defaultMessage:"Ex 0.0.0.0/24"}),fJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.label",{defaultMessage:"Enter IP Address"}),bJ=Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.error",{defaultMessage:"The IP is invalid. Only IPv4 with optional CIDR is supported"});var gJ=a(1327);const yJ=Object(r.memo)((({item:e,onChange:t,policies:a,disabled:n,mode:i,error:o})=>{var l;const c=Object(r.useMemo)((()=>e.entries[0]||{field:"destination.ip",operator:"included",type:"match",value:""}),[e.entries]),[u,d]=Object(r.useState)(!1),[p,m]=Object(r.useState)(!1),[f,b]=Object(r.useState)(!e.name),[g,y]=Object(r.useState)(!c.value),h=Object(BZ.a)("hostIsolationExceptions-form"),[v,E]=Object(r.useState)({isGlobal:Object(UZ.d)(e.tags),selected:[]}),x=Object(r.useMemo)((()=>!f&&!g),[g,f]),j=Object(r.useCallback)((a=>{t({item:a?{...e,...a}:e,isValid:x})}),[e,x,t]),S=Object(r.useCallback)((e=>{const t=e.target.value;t.trim()?b(!1):b(!0),j({name:t})}),[j]),O=Object(r.useCallback)((e=>{const t=e.target.value;!function(e){if(/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e))try{return oJ.a.IPv4.parseCIDR(e),!0}catch(t){return oJ.a.IPv4.isValid(e)}return!1}(t)?y(!0):y(!1),j({entries:[{...c,value:t}]})}),[c,j]),k=Object(r.useCallback)((t=>{t.isGlobal?E({isGlobal:!0,selected:t.selected}):E(t),j({tags:Object(UZ.a)(t,Object(UZ.b)(e.tags))})}),[e.tags,j]),w=Object(r.useCallback)((e=>{j({description:e.target.value})}),[j]),T=Object(r.useMemo)((()=>{var t;return s.a.createElement(ee.EuiFormRow,{label:cJ,fullWidth:!0,isInvalid:f&&u,error:uJ,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-name-input-formRow"},s.a.createElement(ee.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:lJ,defaultValue:null!==(t=e.name)&&void 0!==t?t:"",onChange:S,fullWidth:!0,"aria-label":lJ,required:u,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-name-input",onBlur:()=>!u&&d(!0),disabled:n}))}),[n,e.name,S,u,f]),I=Object(r.useMemo)((()=>{var t,a,i;return s.a.createElement(ee.EuiFormRow,{label:fJ,fullWidth:!0,isInvalid:g&&p,error:bJ,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-ip-input-formRow"},s.a.createElement(ee.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:mJ,defaultValue:null!==(t=null===(a=e.entries)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.value)&&void 0!==t?t:"",onChange:O,fullWidth:!0,"aria-label":mJ,required:p,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-ip-input",onBlur:()=>!p&&m(!0),disabled:n}))}),[n,e.entries,O,p,g]),C=Object(r.useMemo)((()=>{var t;return s.a.createElement(ee.EuiFormRow,{label:pJ,fullWidth:!0,isDisabled:n,"data-test-subj":"hostIsolationExceptions-form-description-input-formRow"},s.a.createElement(ee.EuiTextArea,{id:"eventFiltersFormInputName",placeholder:dJ,defaultValue:null!==(t=e.description)&&void 0!==t?t:"",onChange:w,fullWidth:!0,"data-test-subj":"hostIsolationExceptions-form-description-input","aria-label":dJ,maxLength:256,disabled:n}))}),[n,e.description,w]);return Object(r.useEffect)((()=>{0===v.selected.length&&e.tags&&E(Object(UZ.c)(e.tags,a))}),[e.tags,a,v.selected.length]),Object(r.useEffect)((()=>{j()}),[j]),Object(r.useEffect)((()=>{var t,a;"create"===i&&3!==(null!==(t=null===(a=e.os_types)||void 0===a?void 0:a.length)&&void 0!==t?t:0)&&j({os_types:["windows","linux","macos"]})}),[null===(l=e.os_types)||void 0===l?void 0:l.length,i,j]),s.a.createElement(ee.EuiForm,{component:"div",error:o&&s.a.createElement(gJ.a,{error:o}),isInvalid:!!o,"data-test-subj":"hostIsolationExceptions-form"},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h2",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.title",defaultMessage:"Details"}))),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.description",defaultMessage:"Allows isolated hosts to connect to these IP addresses. Only accepts IPv4 with optional CIDR."})),s.a.createElement(ee.EuiSpacer,{size:"m"}),T,C,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h2",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.title",defaultMessage:"Conditions"}))),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.subtitle",defaultMessage:"Host Isolation exceptions will apply to all operating systems."})),s.a.createElement(ee.EuiSpacer,{size:"m"}),I,s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,"data-test-subj":"effectedPolicies-container",isDisabled:n},s.a.createElement(WK.a,{isGlobal:v.isGlobal,isPlatinumPlus:!0,selected:v.selected,options:a,onChange:k,"data-test-subj":h("effectedPolicies"),disabled:n})))}));yJ.displayName="HostIsolationExceptionsForm";const hJ=Object.freeze({pageTitle:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageTitle",{defaultMessage:"Host isolation exceptions"}),pageAboutInfo:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAboutInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),pageAddButtonTitle:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAddButtonTitle",{defaultMessage:"Add host isolation exception"}),getShowingCountLabel:e=>Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {host isolation exception} other {host isolation exceptions}}",values:{total:e}}),cardActionEditLabel:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionEditLabel",{defaultMessage:"Edit exception"}),cardActionDeleteLabel:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionDeleteLabel",{defaultMessage:"Delete exception"}),flyoutCreateTitle:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateTitle",{defaultMessage:"Add host isolation exception"}),flyoutEditTitle:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditTitle",{defaultMessage:"Edit host isolation exception"}),flyoutCreateSubmitButtonLabel:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add host isolation exception"}),flyoutCreateSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:()=>null,deleteModalTitle:()=>Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteModtalTitle",{defaultMessage:"Delete host isolation exception"}),deleteActionSuccess:e=>Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from host isolation exception list.',values:{itemName:e}}),emptyStateTitleNoEntries:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateTitleNoEntries",{defaultMessage:"There are no host isolation exceptions to display."}),emptyStateTitle:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateTitle",{defaultMessage:"Add your first host isolation exception"}),emptyStateInfo:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),emptyStatePrimaryButtonLabel:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStatePrimaryButtonLabel",{defaultMessage:"Add host isolation exception"}),searchPlaceholderInfo:Y.i18n.translate("xpack.securitySolution.hostIsolationExceptions.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, IP"})}),vJ=Object(r.memo)((()=>{const e=Object(h.h)(),t=uK.a.getInstance(e),{canWriteHostIsolationExceptions:a,canDeleteHostIsolationExceptions:n}=Object(Dt.a)().endpointPrivileges;return s.a.createElement(hK.a,{apiClient:t,ArtifactFormComponent:yJ,labels:hJ,"data-test-subj":"hostIsolationExceptionsListPage",searchableFields:mK.b,allowCardCreateAction:a,allowCardEditAction:a,allowCardDeleteAction:n})}));vJ.displayName="HostIsolationExceptionsList";const EJ=Object(r.memo)((()=>Object(rJ.h)(l.yc.hostIsolationExceptions)?s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.j,exact:!0,component:vJ}),s.a.createElement(K.a,{path:"*",component:J.a})):s.a.createElement(Gs.b,{docLinkSelector:({securitySolution:e})=>e.privileges})));EJ.displayName="HostIsolationExceptionsContainer";var xJ=a(1126);const jJ=Y.i18n.translate("xpack.securitySolution.blocklist.details.header",{defaultMessage:"Details"}),SJ=Y.i18n.translate("xpack.securitySolution.blocklist.details.header.description",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),OJ=Y.i18n.translate("xpack.securitySolution.blocklist.name.label",{defaultMessage:"Name"}),kJ=Y.i18n.translate("xpack.securitySolution.blocklist.description.label",{defaultMessage:"Description"}),wJ=Y.i18n.translate("xpack.securitySolution.blocklist.conditions.header",{defaultMessage:"Conditions"}),TJ=Y.i18n.translate("xpack.securitySolution.blocklist.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),IJ=Y.i18n.translate("xpack.securitySolution.blocklist.os.label",{defaultMessage:"Select operating system"}),CJ=Y.i18n.translate("xpack.securitySolution.blocklist.field.label",{defaultMessage:"Field"}),MJ=Y.i18n.translate("xpack.securitySolution.blocklist.operator.label",{defaultMessage:"Operator"}),_J=Y.i18n.translate("xpack.securitySolution.blocklist.value.label",{defaultMessage:"Value"}),AJ=Y.i18n.translate("xpack.securitySolution.blocklist.value.label.helper",{defaultMessage:"Type or copy & paste one or multiple comma delimited values"}),FJ={"file.hash.*":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.hash",{defaultMessage:"Hash"}),"file.path":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.path",{defaultMessage:"Path"}),"file.path.caseless":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.path.caseless",{defaultMessage:"Path"}),"file.Ext.code_signature":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.signature",{defaultMessage:"Signature"})},PJ={"file.hash.*":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),"file.path":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.path",{defaultMessage:"The full path of the application"}),"file.path.caseless":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.path.caseless",{defaultMessage:"The full path of the application (case insenstive)"}),"file.Ext.code_signature":Y.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.signature",{defaultMessage:"The signer of the application"})},DJ=Y.i18n.translate("xpack.securitySolution.blocklist.policyAssignmentSectionDescription",{defaultMessage:"Assign this blocklist globally across all policies, or assign it to specific policies."}),NJ={NAME_REQUIRED:Y.i18n.translate("xpack.securitySolution.blocklist.errors.name.required",{defaultMessage:"Name is required"}),VALUE_REQUIRED:Y.i18n.translate("xpack.securitySolution.blocklist.errors.values.required",{defaultMessage:"Field entry must have a value"}),INVALID_HASH:Y.i18n.translate("xpack.securitySolution.blocklist.errors.values.invalidHash",{defaultMessage:"Invalid hash value"}),INVALID_PATH:Y.i18n.translate("xpack.securitySolution.blocklist.warnings.values.invalidPath",{defaultMessage:"Path may be formed incorrectly; verify value"}),WILDCARD_PRESENT:Y.i18n.translate("xpack.securitySolution.blocklist.warnings.values.wildcardPresent",{defaultMessage:"A wildcard in the filename will affect the endpoint's performance"}),DUPLICATE_VALUE:Y.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValue",{defaultMessage:"This value already exists"}),DUPLICATE_VALUES:Y.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValues",{defaultMessage:"One or more duplicate values removed"})};function RJ(e){return s.a.createElement("div",null,e)}function LJ(e){return s.a.createElement(s.a.Fragment,null,FJ[e],s.a.createElement(ee.EuiText,{size:"xs",color:"subdued"},PJ[e]))}function BJ(e){return!Object.values(e).some((e=>Object.keys(e).length))}const zJ=Object(r.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:n,mode:i})=>{const[o,l]=Object(r.useState)({name:!1,value:!1}),c=Object(r.useRef)({name:{},value:{}}),u=Object(r.useRef)({name:{},value:{}}),[d,p]=Object(r.useState)([]),m=Object(be.b)().isPlatinumPlus(),f=Object(r.useMemo)((()=>Object(KZ.e)(e)),[e]),[b,g]=Object(r.useState)(!Object(UZ.d)(e.tags)),[y,h]=Object(r.useState)(!1),v=Object(r.useMemo)((()=>m||"edit"===i&&(!f||b&&f&&y)),[i,f,y,m,b]);Object(r.useEffect)((()=>{!y&&e.tags&&g(!Object(UZ.d)(e.tags))}),[e.tags,y]),Object(r.useEffect)((()=>{var a,n;if(y)return;const i=null!==(a=null===(n=e.tags)||void 0===n?void 0:n.map((e=>e.split(":")[1])))&&void 0!==a?a:[];if(!i.length)return;const r=t.filter((e=>i.includes(e.id)));p(r)}),[y,e.tags,t]);const E=Object(BZ.a)("blocklist-form"),x=Object(r.useMemo)((()=>e.entries.length?e.entries[0]:{field:"file.hash.*",operator:"included",type:"match_any",value:[]}),[e.entries]),j=Object(r.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:Mq.c.WINDOWS}),[null==e?void 0:e.os_types]),S=Object(r.useMemo)((()=>x.value.map((e=>({label:e,"data-test-subj":E(`values-input-${e}`)})))),[x.value,E]),O=Object(r.useMemo)((()=>[Mq.c.LINUX,Mq.c.MAC,Mq.c.WINDOWS].map((e=>({value:e,inputDisplay:RK.a[e]})))),[]),k=Object(r.useMemo)((()=>{const e=[];return e.push({value:"file.hash.*",inputDisplay:FJ["file.hash.*"],dropdownDisplay:LJ("file.hash.*"),"data-test-subj":E("file.hash.*")}),j===Mq.c.LINUX?e.push({value:"file.path",inputDisplay:FJ["file.path"],dropdownDisplay:LJ("file.path"),"data-test-subj":E("file.path")}):e.push({value:"file.path.caseless",inputDisplay:FJ["file.path.caseless"],dropdownDisplay:LJ("file.path.caseless"),"data-test-subj":E("file.path.caseless")}),j===Mq.c.WINDOWS&&e.push({value:"file.Ext.code_signature",inputDisplay:FJ["file.Ext.code_signature"],dropdownDisplay:LJ("file.Ext.code_signature"),"data-test-subj":E("file.Ext.code_signature")}),e}),[j,E]),w=Object(r.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(ee.EuiToolTip,{content:AJ},s.a.createElement(s.a.Fragment,null,_J," ",s.a.createElement(ee.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))))),[]),T=Object(r.useCallback)((e=>{var t,a,n;const i=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Mq.c.WINDOWS,{field:r="file.hash.*",type:s="match_any",value:o=[]}=null!==(n=e.entries[0])&&void 0!==n?n:{},l={},d={},p={};e.name.trim()||(d.NAME_REQUIRED=RJ(NJ.NAME_REQUIRED)),o.length||(p.VALUE_REQUIRED=RJ(NJ.VALUE_REQUIRED)),"file.hash.*"===r&&o.some((e=>!jK(e)))&&(p.INVALID_HASH=RJ(NJ.INVALID_HASH));const m=o.some((e=>!Object(Mq.i)({os:i,field:r,type:s,value:e})));"file.hash.*"!==r&&m&&(l.INVALID_PATH=RJ(NJ.INVALID_PATH)),o.length!==Object(I.uniq)(o).length&&(l.DUPLICATE_VALUES=RJ(NJ.DUPLICATE_VALUES)),c.current={...c.current,value:l},u.current={name:d,value:p}}),[]),C=Object(r.useCallback)((()=>{T(e),l((e=>({...e,name:!0})))}),[e,T]),M=Object(r.useCallback)((()=>{T(e),l((e=>({...e,value:!0})))}),[e,T]),_=Object(r.useCallback)((t=>{const a={...e,name:t.target.value};T(a),n({isValid:BJ(u.current),item:a}),h(!0)}),[T,n,e]),A=Object(r.useCallback)((t=>{const a={...e,description:t.target.value};T(a),n({isValid:BJ(u.current),item:a}),h(!0)}),[n,e,T]),F=Object(r.useCallback)((t=>{const a={...e,os_types:[t],entries:[{...x,field:t!==Mq.c.WINDOWS&&"file.Ext.code_signature"===x.field?"file.hash.*":x.field}]};T(a),n({isValid:BJ(u.current),item:a}),h(!0)}),[T,x,n,e]),P=Object(r.useCallback)((t=>{const a={...e,entries:[{...x,field:t}]};T(a),n({isValid:BJ(u.current),item:a}),h(!0)}),[T,n,e,x]),D=Object(r.useCallback)((e=>{const t={...c.current.value};x.value.includes(e)?t.DUPLICATE_VALUE=RJ(NJ.DUPLICATE_VALUE):delete t.DUPLICATE_VALUE,c.current={...c.current,value:t},l((e=>({...e})))}),[x]),N=Object(r.useCallback)((t=>{const a=t.map((e=>e.label)),i={...e,entries:[{...x,value:a}]};T(i),n({isValid:BJ(u.current),item:i}),h(!0)}),[T,n,e,x]),R=Object(r.useCallback)((t=>{const a=t.split(",").filter((e=>e.trim())),i=[...x.value,...a],r={...e,entries:[{...x,value:i}]};T(r),r.entries[0].value=Object(I.uniq)(r.entries[0].value),l((e=>({...e,value:!0}))),n({isValid:BJ(u.current),item:r}),h(!0)}),[T,n,e,x]),L=Object(r.useCallback)((t=>{const a=t.isGlobal?[Tc.d]:t.selected.map((e=>`${Tc.b}${e.id}`)),i={...e,tags:a};t.isGlobal||p(t.selected),T(i),n({isValid:BJ(u.current),item:i}),h(!0)}),[T,n,e]);return s.a.createElement(ee.EuiForm,{component:"div"},s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h3",null,jJ)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),"create"===i&&s.a.createElement(ee.EuiText,{size:"s","data-test-subj":E("header-description")},s.a.createElement("p",null,SJ)),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{label:OJ,isInvalid:o.name&&!!Object.keys(u.current.name).length,error:Object.values(u.current.name),fullWidth:!0},s.a.createElement(ee.EuiFieldText,{name:"name",value:e.name,onChange:_,onBlur:C,required:o.name,maxLength:256,"data-test-subj":E("name-input"),fullWidth:!0})),s.a.createElement(ee.EuiFormRow,{label:kJ,fullWidth:!0},s.a.createElement(ee.EuiTextArea,{name:"description",value:e.description,onChange:A,"data-test-subj":E("description-input"),fullWidth:!0,compressed:!0,maxLength:256})),s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiTitle,{size:"xs"},s.a.createElement("h3",null,wJ)),s.a.createElement(ee.EuiSpacer,{size:"xs"}),s.a.createElement(ee.EuiText,{size:"s"},s.a.createElement("p",null,TJ)),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{label:IJ,fullWidth:!0},s.a.createElement(ee.EuiSuperSelect,{name:"os",options:O,valueOfSelected:j,onChange:F,"data-test-subj":E("os-select"),fullWidth:!0})),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiFormRow,{label:CJ,fullWidth:!0},s.a.createElement(ee.EuiSuperSelect,{name:"field",options:k,valueOfSelected:x.field,onChange:P,"data-test-subj":E("field-select"),fullWidth:!0}))),s.a.createElement(ee.EuiFlexItem,{grow:1},s.a.createElement(ee.EuiFormRow,{label:MJ,fullWidth:!0},s.a.createElement(ee.EuiFieldText,{name:"operator",value:V$.p.message,readOnly:!0}))),s.a.createElement(ee.EuiFlexItem,{grow:2}))),s.a.createElement(ee.EuiFormRow,{label:w,isInvalid:o.value&&!!Object.keys(u.current.value).length,helpText:Object.values(c.current.value),error:Object.values(u.current.value),fullWidth:!0},s.a.createElement(ee.EuiComboBox,{selectedOptions:S,onBlur:M,onSearchChange:D,onChange:N,onCreateOption:R,"data-test-subj":E("values-input"),fullWidth:!0,noSuggestions:!0})),v&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiHorizontalRule,null),s.a.createElement(ee.EuiFormRow,{fullWidth:!0},s.a.createElement(WK.a,{isGlobal:f,isPlatinumPlus:m,selected:d,options:t,onChange:L,isLoading:a,description:DJ,"data-test-subj":E("effectedPolicies")}))))})),qJ={pageTitle:Y.i18n.translate("xpack.securitySolution.blocklist.pageTitle",{defaultMessage:"Blocklist"}),pageAboutInfo:Y.i18n.translate("xpack.securitySolution.blocklist.pageAboutInfo",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),pageAddButtonTitle:Y.i18n.translate("xpack.securitySolution.blocklist.pageAddButtonTitle",{defaultMessage:"Add blocklist entry"}),getShowingCountLabel:e=>Y.i18n.translate("xpack.securitySolution.blocklist.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {blocklist entry} other {blocklist entries}}",values:{total:e}}),cardActionEditLabel:Y.i18n.translate("xpack.securitySolution.blocklist.cardActionEditLabel",{defaultMessage:"Edit blocklist"}),cardActionDeleteLabel:Y.i18n.translate("xpack.securitySolution.blocklist.cardActionDeleteLabel",{defaultMessage:"Delete blocklist"}),flyoutCreateTitle:Y.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateTitle",{defaultMessage:"Add blocklist"}),flyoutEditTitle:Y.i18n.translate("xpack.securitySolution.blocklist.flyoutEditTitle",{defaultMessage:"Edit blocklist"}),flyoutCreateSubmitButtonLabel:Y.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add blocklist"}),flyoutCreateSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your blocklist.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>Y.i18n.translate("xpack.securitySolution.blocklist.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),s.a.createElement(ee.EuiLink,{target:"_blank",href:`${e.blocklist}`},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsLink",defaultMessage:"blocklist documentation."}))),deleteActionSuccess:e=>Y.i18n.translate("xpack.securitySolution.blocklist.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from blocklist.',values:{itemName:e}}),emptyStateTitleNoEntries:Y.i18n.translate("xpack.securitySolution.blocklist.emptyStateTitleNoEntries",{defaultMessage:"There are no blocklist entries to display."}),emptyStateTitle:Y.i18n.translate("xpack.securitySolution.blocklist.emptyStateTitle",{defaultMessage:"Add your first blocklist entry"}),emptyStateInfo:Y.i18n.translate("xpack.securitySolution.blocklist.emptyStateInfo",{defaultMessage:"The blocklist prevents specified applications from running on your hosts, extending the list of processes that Endpoint Security considers malicious."}),emptyStatePrimaryButtonLabel:Y.i18n.translate("xpack.securitySolution.blocklist.emptyStatePrimaryButtonLabel",{defaultMessage:"Add blocklist entry"}),searchPlaceholderInfo:Y.i18n.translate("xpack.securitySolution.blocklist.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},$J=Object(r.memo)((()=>{const{canWriteBlocklist:e}=Object(Dt.a)().endpointPrivileges,t=Object(h.h)(),a=xJ.a.getInstance(t);return s.a.createElement(hK.a,{apiClient:a,ArtifactFormComponent:zJ,labels:qJ,"data-test-subj":"blocklistPage",flyoutSize:"l",allowCardCreateAction:e,allowCardEditAction:e,allowCardDeleteAction:e})}));$J.displayName="Blocklist";const VJ=Object(r.memo)((()=>s.a.createElement(o.TrackApplicationView,{viewId:P.a.blocklist},s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.g,exact:!0,component:$J}),s.a.createElement(K.a,{path:"*",component:J.a})),s.a.createElement(_,{pageName:P.a.blocklist}))));VJ.displayName="BlocklistContainer";var UJ=a(669);const HJ=()=>{const[e,t]=Object(r.useState)(!0),a=Object(r.useCallback)((e=>{t(!e)}),[]);return s.a.createElement(HW.a,{"data-test-subj":"responseActionsPage",title:sA.w,subtitle:UJ.g.pageSubTitle,hideHeader:e},s.a.createElement(pW.a,{showHostNames:!0,isFlyout:!1,setIsDataInResponse:a}))};HJ.displayName="ResponseActionsListPage";const QJ=Object(r.memo)((()=>s.a.createElement(K.c,null,s.a.createElement(K.a,{path:aW.s,exact:!0,component:HJ}),s.a.createElement(K.a,{path:"*",component:J.a}))));QJ.displayName="ResponseActionsContainer";const GJ=Object(r.memo)((({component:e,hasPrivilege:t,path:a})=>{const n=Object(r.useCallback)((e=>e.securitySolution.privileges),[]),i=Object(r.useMemo)((()=>t?e:()=>s.a.createElement(Gs.b,{docLinkSelector:n})),[e,n,t]);return s.a.createElement(K.a,{path:a,component:i})}));GJ.displayName="PrivilegedRoute";const WJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.endpoints},s.a.createElement(tZ,null),s.a.createElement(_,{pageName:l.yc.endpoints})),ZJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.policies},s.a.createElement(yK,null),s.a.createElement(_,{pageName:l.yc.policies})),KJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.trustedApps},s.a.createElement(aJ,null),s.a.createElement(_,{pageName:l.yc.trustedApps})),JJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.eventFilters},s.a.createElement(iJ,null),s.a.createElement(_,{pageName:l.yc.eventFilters})),YJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.hostIsolationExceptions},s.a.createElement(EJ,null),s.a.createElement(_,{pageName:l.yc.hostIsolationExceptions})),XJ=()=>s.a.createElement(o.TrackApplicationView,{viewId:l.yc.responseActionsHistory},s.a.createElement(QJ,null),s.a.createElement(_,{pageName:l.yc.responseActionsHistory})),eY=Object(r.memo)((()=>{const{loading:e,canReadPolicyManagement:t,canReadBlocklist:a,canReadTrustedApplications:n,canReadEventFilters:i,canReadActionsLogManagement:r,canReadEndpointList:o,canReadHostIsolationExceptions:c}=Object(Dt.a)().endpointPrivileges;return e?s.a.createElement(ee.EuiLoadingSpinner,null):s.a.createElement(K.c,null,s.a.createElement(GJ,{path:aW.h,component:WJ,hasPrivilege:o}),s.a.createElement(GJ,{path:aW.k,component:ZJ,hasPrivilege:t}),s.a.createElement(GJ,{path:aW.t,component:KJ,hasPrivilege:n}),s.a.createElement(GJ,{path:aW.i,component:JJ,hasPrivilege:i}),s.a.createElement(GJ,{path:aW.j,component:YJ,hasPrivilege:c}),s.a.createElement(GJ,{path:aW.g,component:VJ,hasPrivilege:a}),s.a.createElement(GJ,{path:aW.s,component:XJ,hasPrivilege:r}),o&&s.a.createElement(K.a,{path:l.Jb,exact:!0},s.a.createElement(k.Redirect,{to:Object(O.e)({name:"endpointList"})})),s.a.createElement(K.a,{path:"*",component:J.a}))}));eY.displayName="ManagementContainer";var tY=a(1410);const aY=Y.i18n.translate("xpack.securitySolution.management.landing.title",{defaultMessage:"Manage"}),nY=()=>{var e;const{links:t=[],categories:a=[]}=null!==(e=Object(vT.c)(P.a.administration))&&void 0!==e?e:{},n=Object(ft.a)();return s.a.createElement(S.a,null,s.a.createElement(oo,{title:aY}),s.a.createElement(gT,{links:t,categories:a,onLinkClick:jT,urlState:n}),s.a.createElement(_,{pageName:P.a.administration}))},iY=()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:P.a.administration},s.a.createElement(nY,null))),rY=()=>s.a.createElement(Q,null,s.a.createElement(tY.a,null,s.a.createElement(eY,null))),sY=[{path:l.Kb,component:s.a.memo(iY)},{path:l.Jb,component:s.a.memo(rY)}];var oY=a(1429),lY=a(1433),cY=a(96);const uY=({pageName:e,...t})=>s.a.createElement(_,bo()({pageName:e},t)),dY={getFiltersGlobalComponent:()=>ke,getSpyRouteComponent:()=>uY},pY=()=>{const{cloudDefend:e}=Object(h.i)().services,t=e.getCloudDefendRouter();return s.a.createElement(Q,null,s.a.createElement(S.a,{noPadding:!0,noTimeline:!0},s.a.createElement(t,{securitySolutionContext:dY})))};pY.displayName="CloudDefend";const mY=[{path:cY.CLOUD_DEFEND_BASE_PATH,component:pY}];var fY=a(97);const bY=({pageName:e,...t})=>s.a.createElement(_,bo()({pageName:e},t)),gY={getFiltersGlobalComponent:()=>ke,getSpyRouteComponent:()=>bY},yY=()=>{const{cloudSecurityPosture:e}=Object(h.i)().services,t=e.getCloudSecurityPostureRouter();return s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:"cloud_security_posture"},s.a.createElement(S.a,{noPadding:!0,noTimeline:!0},s.a.createElement(t,{securitySolutionContext:gY}))))};yY.displayName="CloudSecurityPosture";const hY=[{path:fY.CLOUD_SECURITY_POSTURE_BASE_PATH,component:yY}];var vY=a(98),EY=a(1385);const xY=({dataProviders:e,from:t,to:a})=>{const{data:{query:n}}=Object(h.i)().services,i=Object(c.useDispatch)(),{startTransaction:s}=Object(Mo.b)(),o=Object(r.useMemo)((()=>n.filterManager),[n.filterManager]),u=Object(r.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),{filterManager:d}=Object(F.a)((e=>{var t;return u(e,null!==(t=g.c.active)&&void 0!==t?t:"")})),p=Object(r.useMemo)((()=>null!=d?d:o),[d,o]),m=Object(r.useCallback)((e=>i(v.a.updateIsLoading(e))),[i]),f=Object(Vg.a)({timelineId:g.c.active,timelineType:Lf.l.default}),b=Object(r.useCallback)((({from:e,timeline:t,to:a,ruleNote:n})=>{var r;f(),m({id:g.c.active,isLoading:!1}),Object(AI.b)(i)({duplicate:!0,from:e,id:g.c.active,notes:[],timeline:{...t,filterManager:p,indexNames:null!==(r=t.indexNames)&&void 0!==r?r:[],show:!0},to:a,ruleNote:n})()}),[i,p,m,f]);return Object(r.useCallback)((async()=>{s({name:`${l.l} threat indicator investigateInTimeline`}),await b({from:t,notes:null,timeline:{...Ov.b,dataProviders:e,id:g.c.active,indexNames:[],dateRange:{start:t,end:a},eventType:"all",filters:[],kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:a,ruleNote:""})}),[s,b,e,t,a])};var jY=a(1434);const SY=Object(r.memo)((()=>{const{threatIntelligence:e,http:t}=Object(h.i)().services,a=e.getComponent(),n=Object(E.d)(),i=Object(mt.c)(),r={securitySolutionStore:i,getFiltersGlobalComponent:()=>ke,getPageWrapper:()=>S.a,licenseService:be.a,sourcererDataView:n,getUseInvestigateInTimeline:xY,blockList:{canWriteBlocklist:Object(Dt.a)().endpointPrivileges.canWriteBlocklist,exceptionListApiClient:xJ.a.getInstance(t),useSetUrlParams:EY.a,getFlyoutComponent:()=>jY.b,getFormComponent:()=>zJ},useQuery:()=>Object(c.useSelector)(mt.d.globalQuerySelector()),useFilters:()=>Object(c.useSelector)(mt.d.globalFiltersQuerySelector()),useGlobalTime:xe.a,registerQuery:e=>i.dispatch(Object(vt.setQuery)({inputId:Ee.a.global,id:e.id,refetch:e.refetch,inspect:null,loading:e.loading})),deregisterQuery:e=>i.dispatch(Object(vt.deleteOneQuery)({inputId:Ee.a.global,id:e.id})),SiemSearchBar:ht};return s.a.createElement(Lc,{pageName:P.a.threatIntelligence},s.a.createElement(a,{securitySolutionContext:r}),s.a.createElement(_,{pageName:P.a.threatIntelligence}))}));SY.displayName="ThreatIntelligence";const OY=[{path:vY.THREAT_INTELLIGENCE_BASE_PATH,render:()=>s.a.createElement(SY,null)}];var kY=a(92),wY=a(1312),TY=a(284);const IY=Y.i18n.translate("xpack.securitySolution.dashboards.landing.createButton",{defaultMessage:"Create Dashboard"}),CY=Y.i18n.translate("xpack.securitySolution.dashboards.landing.section.default",{defaultMessage:"DEFAULT"}),MY=Y.i18n.translate("xpack.securitySolution.dashboards.landing.section.custom",{defaultMessage:"CUSTOM"});var _Y=a(1400);const AY=s.a.createContext({securityTags:null}),FY=({children:e})=>{const{tags:t,isLoading:a}=(()=>{const{http:e,savedObjectsTagging:t}=Object(h.i)().services,a=Object(r.useRef)(!1),{data:n,isLoading:i,error:s}=Object(Np.b)(Np.a.SECURITY_TAGS,CC,{initialParameters:{http:e,tagName:l.uc}}),{fetch:o,data:c,isLoading:u,error:d}=Object(Np.b)(Np.a.SECURITY_CREATE_TAG,MC);return Object(r.useEffect)((()=>{!t||i||s||!n||0!==n.length||a.current||(a.current=!0,o({savedObjectsTaggingClient:t.client,tag:{name:l.uc,description:l.tc,color:`#${String(Math.floor(16777215*Math.random()).toString(16)).padStart(6,"0")}`}}))}),[s,o,t,i,n]),{tags:Object(r.useMemo)((()=>null!=n&&n.length?n.map((e=>({id:e.id,type:"tag",...e.attributes}))):c?[{type:"tag",...c}]:void 0),[n,c]),isLoading:i||u,error:s||d}})(),n=a||!t?null:t;return s.a.createElement(AY.Provider,{value:{securityTags:n}},e)},PY=()=>(()=>{const e=s.a.useContext(AY);if(!e)throw new Error("useDashboardContext must be used within a DashboardContextProvider");return e})().securityTags,DY=({canCreateDashboard:e})=>{const{isLoading:t,url:a}=(()=>{const e=Object(y.m)(),t=PY(),a=e({deepLinkId:uM.SecurityPageName.dashboards,path:"create"});return Object(r.useMemo)((()=>{var e;return(null==t||null===(e=t[0])||void 0===e?void 0:e.id)?{isLoading:!1,url:a}:{isLoading:!0,url:a}}),[t,a])})(),{navigateTo:n}=Object(h.j)();return s.a.createElement(ee.EuiFlexGroup,{gutterSize:"none",direction:"row"},s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(to,{title:_Y.b})),e&&s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(TY.d,{isDisabled:t,color:"primary",fill:!0,iconType:"plusInCircle",href:a,onClick:e=>{e.preventDefault(),Object(Do.h)(Do.a.CLICK,`${Do.c.CREATE_DASHBOARD}`),n({url:a})},"data-test-subj":"createDashboardButton"},IY)))},NY=()=>{var e;const{DashboardsLandingCallout:t}=Object(wY.a)(),{links:a=[]}=null!==(e=Object(vT.c)(l.yc.dashboards))&&void 0!==e?e:{},n=Object(ft.a)(),{show:i,createNew:o}=Object(h.e)(kY.LEGACY_DASHBOARD_APP_ID),{navigateTo:c}=Object(h.j)(),u=Object(y.m)(),d=Object(r.useCallback)((e=>`${u({deepLinkId:l.yc.dashboards,path:e})}`),[u]),p=Object(r.useCallback)((e=>{Object(Do.h)(Do.a.CLICK,Do.c.DASHBOARD),c({url:u({deepLinkId:l.yc.dashboards,path:null!=e?e:"create"})})}),[u,c]),m=PY(),f=m&&(null==m?void 0:m.length)>0,b=Object(r.useMemo)((()=>(e=>{if(e)return`tag:(${[...null==e?void 0:e.reduce(((e,{name:t})=>{const a=`"${t}"`;return t&&!e.has(a)&&e.add(a),e}),new Set)].join(" or")})`})(m)),[m]);return s.a.createElement(S.a,null,s.a.createElement(DY,{canCreateDashboard:o}),s.a.createElement(ee.EuiSpacer,{size:"xl"}),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(t,null),s.a.createElement(ee.EuiSpacer,{size:"xl"})),s.a.createElement(ee.EuiTitle,{size:"xxxs"},s.a.createElement("h2",null,CY)),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}),s.a.createElement(hT,{items:a,urlState:n,onLinkClick:jT}),s.a.createElement(ee.EuiSpacer,{size:"m"}),i&&f&&b&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiTitle,{size:"xxxs"},s.a.createElement("h2",null,MY)),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(kY.DashboardListingTable,{disableCreateDashboardButton:!o,getDashboardUrl:d,goToDashboard:p,initialFilter:b,urlStateEnabled:!1,showCreateDashboardButton:!1})),i&&!f&&s.a.createElement(ee.EuiEmptyPrompt,{icon:s.a.createElement(ee.EuiLoadingSpinner,{size:"l","data-test-subj":"dashboardLoadingIcon"})}),s.a.createElement(_,{pageName:l.yc.dashboards}))},RY=Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.viewPorpmpt.noReadPermission.title",{defaultMessage:"You have no permission to read the dashboard"}),LY=Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.viewPorpmpt.noReadPermission.description",{defaultMessage:"Contact your administrator for help."}),BY=(Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.viewPorpmpt.indicesNotFound.title",{defaultMessage:"Indices not found"}),Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.notFound.title",{defaultMessage:"Not found"}),Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.editDashboardButtonTitle",{defaultMessage:"Edit"}),Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.editDashboardTitle",{defaultMessage:"Editing new dashboard"}));let zY;Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.viewDashboardButtonTitle",{defaultMessage:"Switch to view mode"}),Y.i18n.translate("xpack.securitySolution.dashboards.dashboard.saveDashboardButtonTitle",{defaultMessage:"Save"}),function(e){e.NoReadPermission="NoReadPermission"}(zY||(zY={}));const qY={[zY.NoReadPermission]:{color:"danger",iconType:"error",title:s.a.createElement("h2",null,RY),body:s.a.createElement("p",null,LY)}},$Y=new Ie.BehaviorSubject({}),VY=({canReadDashboard:e,dashboardContainer:t,filters:a,id:n,inputId:i=Ee.a.global,onDashboardContainerLoaded:o,query:u,savedObjectId:d,timeRange:p,viewMode:m=pl.ViewMode.VIEW})=>{var f;const{embeddable:b}=Object(h.i)().services,g=Object(c.useDispatch)(),v=PY(),{navigateTo:E}=Object(h.j)(),x=Object(y.m)(),j=null==v||null===(f=v[0])||void 0===f?void 0:f.id,S=!d,O=Object(r.useCallback)((({dashboardId:e})=>x({deepLinkId:l.yc.dashboards,path:e})),[x]),k=Object(r.useCallback)((async e=>{E({url:O(e)})}),[O,E]),w=Object(r.useMemo)((()=>({navigate:k,getRedirectUrl:O})),[k,O]),T=Object(r.useCallback)((()=>Promise.resolve({useSessionStorageIntegration:!0,useControlGroupIntegration:!0,getInitialInput:()=>$Y.value,getIncomingEmbeddable:()=>b.getStateTransfer().getIncomingEmbeddablePackage(uM.APP_UI_ID,!0),getEmbeddableAppContext:e=>({getCurrentPath:()=>e?`${l.u}/${e}/edit`:`${l.u}/create`,currentAppId:uM.APP_UI_ID})})),[b]),I=Object(r.useCallback)((()=>{null==t||t.forceRefresh()}),[t]);Object(r.useEffect)((()=>(g(Me.b.setQuery({inputId:i,id:n,refetch:I,loading:!1,inspect:null})),()=>{g(Me.b.deleteOneQuery({inputId:i,id:n}))})),[g,n,i,I]),Object(r.useEffect)((()=>{null==t||t.updateInput({timeRange:p,query:u,filters:a})}),[t,a,u,p]),Object(r.useEffect)((()=>{S&&j&&(null==t||t.updateInput({tags:[j]}))}),[t,j,S]),Object(r.useEffect)((()=>{$Y.next({timeRange:p,viewMode:m,query:u,filters:a})}),[p,m,u,a]);const[C,M]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>(M(s.a.createElement(kY.DashboardRenderer,{locator:w,ref:o,savedObjectId:d,getCreationOptions:T})),()=>{M(void 0)})),[T,o,I,d,w]),e?s.a.createElement(s.a.Fragment,null,C):null};VY.displayName="DashboardRendererComponent";const UY=s.a.memo(VY),HY=({currentState:e})=>{const t=(e=>e?qY[e]:null)(e);return t&&e?s.a.createElement(ee.EuiPageTemplate,{"data-test-subj":`dashboardViewEmpty${e}`},s.a.createElement(ee.EuiPageTemplate.EmptyPrompt,t)):null};HY.displayName="StatusPromptComponent";const QY=s.a.memo(HY),GY=({dashboardContainer:e,onLoad:t})=>{var a;const{setHeaderActionMenu:n}=Object(h.i)().services,i=null!==(a=null==e?void 0:e.select((e=>e.explicitInput.viewMode)))&&void 0!==a?a:pl.ViewMode.VIEW,{navigateTo:o,getAppUrl:c}=Object(h.k)(),u=Object(r.useCallback)((({destination:e,id:t})=>{"listing"===e&&o({deepLinkId:uM.SecurityPageName.dashboards}),"dashboard"===e&&o({deepLinkId:uM.SecurityPageName.dashboards,path:t?`${t}/edit`:"/create"})}),[o]),d=Object(r.useMemo)((()=>[{text:l.j,href:c({deepLinkId:uM.SecurityPageName.landing})}]),[c]);Object(r.useEffect)((()=>{null==t||t(i)}),[t,i]);const p=Object(r.useMemo)((()=>({forceHideFilterBar:!0,forceShowTopNavMenu:!0,forceShowQueryInput:!1,forceShowDatePicker:!1})),[]),{showWriteControls:m}=Object(h.e)(kY.LEGACY_DASHBOARD_APP_ID);return m?s.a.createElement(kY.DashboardTopNav,{customLeadingBreadCrumbs:d,dashboardContainer:e,forceHideUnifiedSearch:!0,embedSettings:p,redirectTo:u,showBorderBottom:!1,setCustomHeaderActionMenu:n,showResetChange:!1}):null},WY=s.a.memo(GY),ZY=({dashboardContainer:e,onTitleLoaded:t})=>{const a=e.select((e=>e.explicitInput.title)).trim(),n=a&&0!==a.length?a:BY;return Object(r.useEffect)((()=>{t(n)}),[e,n,t]),null!=a?s.a.createElement("span",null,n):s.a.createElement(ee.EuiLoadingSpinner,{size:"m"})},KY=s.a.memo(ZY),JY={minHeight:"calc(100vh - 140px)"},YY=({initialViewMode:e})=>{const{fromStr:t,toStr:a,from:n,to:i}=Object(F.a)((e=>Object(A.pick)(["fromStr","toStr","from","to"],mt.d.globalTimeRangeSelector(e)))),o=Object(r.useMemo)((()=>({from:n,to:i,fromStr:t,toStr:a})),[n,t,i,a]),c=Object(r.useMemo)((()=>mt.d.globalQuerySelector()),[]),u=Object(r.useMemo)((()=>mt.d.globalFiltersQuerySelector()),[]),d=Object(F.a)(c),p=Object(F.a)(u),{sourcererDataView:m}=Object(E.d)(),{show:f}=Object(h.e)(kY.LEGACY_DASHBOARD_APP_ID),b=Object(r.useMemo)((()=>f?null:zY.NoReadPermission),[f]),[g,y]=Object(r.useState)(e),{detailName:v}=Object(k.useParams)(),[x,j]=Object(r.useState)(),{dashboardContainer:O,handleDashboardLoaded:w}=(()=>{const[e,t]=Object(r.useState)(),a=Object(r.useCallback)((e=>{t(e)}),[]);return Object(r.useMemo)((()=>({dashboardContainer:e,handleDashboardLoaded:a})),[e,a])})(),T=Object(r.useCallback)((e=>{y(e)}),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,null,s.a.createElement(ht,{id:Ee.a.global,sourcererDataView:m})),s.a.createElement(S.a,null,s.a.createElement(ee.EuiFlexGroup,{direction:"column",style:JY,gutterSize:"none","data-test-subj":"dashboard-view-wrapper"},s.a.createElement(ee.EuiFlexItem,{grow:!1},O&&s.a.createElement(oo,{border:!0,title:s.a.createElement(KY,{dashboardContainer:O,onTitleLoaded:j}),subtitle:s.a.createElement(WY,{dashboardContainer:O,onLoad:T})})),!b&&s.a.createElement(ee.EuiFlexItem,{grow:!0},s.a.createElement(UY,{query:d,filters:p,canReadDashboard:f,dashboardContainer:O,id:`dashboard-view-${v}`,onDashboardContainerLoaded:w,savedObjectId:v,timeRange:o,viewMode:g})),b&&s.a.createElement(ee.EuiFlexItem,{"data-test-subj":"dashboard-view-error-prompt-wrapper",grow:!0},s.a.createElement(QY,{currentState:b})),s.a.createElement(_,{pageName:l.yc.dashboards,state:{dashboardName:x}}))))};YY.displayName="DashboardViewComponent";const XY=s.a.memo(YY),eX=()=>s.a.createElement(FY,null,s.a.createElement(K.c,null,s.a.createElement(K.a,{strict:!0,path:`${l.u}/create`},s.a.createElement(XY,{initialViewMode:pl.ViewMode.EDIT})),s.a.createElement(K.a,{strict:!0,path:`${l.u}/:detailName/edit`},s.a.createElement(XY,{initialViewMode:pl.ViewMode.EDIT})),s.a.createElement(K.a,{strict:!0,path:`${l.u}/:detailName`},s.a.createElement(XY,{initialViewMode:pl.ViewMode.VIEW})),s.a.createElement(K.a,{path:`${l.u}`},s.a.createElement(NY,null)))),tX=s.a.memo(eX),aX=[{path:l.u,component:()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.dashboards},s.a.createElement(tX,null)))}],nX=({items:e,type:t})=>{const a=[{field:"id_value",name:"Name",render:e=>t===dv.e.host?s.a.createElement($t.d,{hostName:e}):s.a.createElement($t.m,{userName:e})},{field:"calculated_level",name:"Level",render:e=>null!=e?s.a.createElement(xu.a,{severity:e}):""},{field:"calculated_score_norm",name:"Score norm",render:e=>null!=e?Math.round(100*e)/100:""}];return s.a.createElement(ee.EuiInMemoryTable,{"data-test-subj":t===dv.e.host?"host-risk-preview-table":"user-risk-preview-table",responsive:!1,items:e,columns:a,loading:!1})};var iX=a(1096);const rX=(e=[],t)=>{var a,n;return(null==e||null===(a=e.filter((e=>(null==e?void 0:e.id_field)===t)))||void 0===a||null===(n=a.sort(((e,t)=>(null==t?void 0:t.calculated_score_norm)-(null==e?void 0:e.calculated_score_norm))))||void 0===n?void 0:n.slice(0,5))||[]},sX=({items:e,showMessage:t,hideMessage:a,isLoading:n,type:i})=>{const[o,l]=Object(r.useState)("open");return s.a.createElement(ee.EuiPanel,{hasBorder:!0},s.a.createElement(ee.EuiAccordion,{initialIsOpen:!0,isLoading:n,id:"host-table",buttonContent:"closed"===o?t:a,forceState:o,onToggle:e=>{l(e?"open":"closed")},extraAction:s.a.createElement(ee.EuiIcon,{type:i===dv.e.host?"storage":"user"})},s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(nX,{items:e,type:i}))))},oX=()=>{const[e,t]=Object(r.useState)({from:"now-24h",to:"now"}),[a,n]=Object(r.useState)({bool:{must:[],filter:[],should:[],must_not:[]}}),{unifiedSearch:{ui:{SearchBar:i}}}=Object(h.i)().services,{addError:o}=Object(Pt.a)(),{indexPattern:l}=Object(E.d)(x.SourcererScopeName.detections),{data:c,isLoading:u,refetch:d,isError:p}=(({data_view_id:e,range:t,filter:a})=>Object(ih.useQuery)(["POST","FETCH_PREVIEW_RISK_SCORE",t,a],(async({signal:n})=>{const i={data_view_id:e};if(t){var r,s;const e=null===(r=Bq.a.parse(t.start))||void 0===r?void 0:r.utc().toISOString(),a=null===(s=Bq.a.parse(t.end,{roundUp:!0}))||void 0===s?void 0:s.utc().toISOString();e&&a&&(i.range={start:e,end:a})}return a&&(i.filter=a),await Object(iX.e)({signal:n,params:i})})))({data_view_id:l.title,filter:a,range:{start:e.from,end:e.to}}),m=rX(null==c?void 0:c.scores.host,"host.name"),f=rX(null==c?void 0:c.scores.user,"user.name"),b=Object(r.useCallback)((e=>{t({from:e.dateRange.from,to:e.dateRange.to});try{var a;const t=Object(za.buildEsQuery)(void 0,null!==(a=e.query)&&void 0!==a?a:{query:"",language:"kuery"},[]);n(t)}catch(e){o(e,{title:bf})}}),[o,t,n]);return p?s.a.createElement(ee.EuiCallOut,{"data-test-subj":"risk-preview-error",title:pf,color:"danger",iconType:"error"},s.a.createElement("p",null,mf),s.a.createElement(ee.EuiButton,{"data-test-subj":"risk-preview-error-button",color:"danger",onClick:()=>d()},ff)):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,null,s.a.createElement("h2",null,uf)),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement(ee.EuiText,null,df),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(ee.EuiFormRow,{fullWidth:!0,"data-test-subj":"risk-score-preview-search-bar"},l&&s.a.createElement(i,{appName:"siem",isLoading:u,indexPatterns:[l],dateRangeFrom:e.from,dateRangeTo:e.to,onQuerySubmit:b,showFilterBar:!1,showDatePicker:!0,displayStyle:"inPage",submitButtonStyle:"iconOnly"})),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(sX,{items:m,showMessage:Ym,hideMessage:Xm,isLoading:u,type:dv.e.host}),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(sX,{items:f,showMessage:ef,hideMessage:tf,isLoading:u,type:dv.e.user}))};var lX=a(462),cX=a(28);const uX=["POST","INIT_RISK_ENGINE"],dX=["POST","ENABLE_RISK_ENGINE"],pX=["POST","DISABLE_RISK_ENGINE"],mX=({errors:e})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiCallOut,{title:wf,color:"danger",iconType:"error","data-test-subj":"risk-score-error-panel"},s.a.createElement("p",null,Tf),s.a.createElement(ee.EuiAccordion,{id:"risk-engine-erros",buttonContent:If},s.a.createElement(s.a.Fragment,null,e.map((e=>s.a.createElement("div",{key:e},s.a.createElement(ee.EuiText,{size:"s"},e),s.a.createElement(ee.EuiSpacer,{size:"s"})))))),s.a.createElement(ee.EuiAccordion,{id:"risk-engine-privileges",buttonContent:Ff},s.a.createElement("p",null,Pf,s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.errors.privileges.requiredPrivilege",defaultMessage:"{required_privilege} privileges for {index} index",values:{required_privilege:s.a.createElement("b",null,"all"),index:s.a.createElement("b",null,"risk-score.risk-score-*")}})),s.a.createElement("li",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.errors.privileges.securityPrivilege",defaultMessage:"{security_privileges} security privileges",values:{security_privileges:s.a.createElement("span",null,s.a.createElement("b",null,"manage_index_templates"),","," ",s.a.createElement("b",null,"manage_transform"))}})),s.a.createElement("li",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskScore.errors.privileges.kibanaPrivilege",defaultMessage:"{kibana_privilege} Kibana privilege",values:{kibana_privilege:s.a.createElement("b",null,"Saved Objects Management")}}))))))),fX=({closeModal:e,isLoading:t,onConfirm:a,isVisible:n})=>n?s.a.createElement(ee.EuiModal,{onClose:e},t?s.a.createElement(ee.EuiModalHeader,null,s.a.createElement(ee.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},s.a.createElement(ee.EuiLoadingSpinner,{size:"m"}),s.a.createElement(ee.EuiModalHeaderTitle,null,hf))):s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiModalHeader,null,s.a.createElement(ee.EuiModalHeaderTitle,null,vf)),s.a.createElement(ee.EuiModalBody,null,s.a.createElement(ee.EuiText,null,s.a.createElement("p",null,s.a.createElement("b",null,Ef),xf),s.a.createElement(ee.EuiSpacer,{size:"s"}),s.a.createElement("p",null,s.a.createElement("b",null,jf),Sf)),s.a.createElement(ee.EuiSpacer,null)),s.a.createElement(ee.EuiModalFooter,null,s.a.createElement(ee.EuiButtonEmpty,{color:"primary","data-test-subj":"risk-score-update-cancel",onClick:e},Of),s.a.createElement(ee.EuiButton,{color:"primary","data-test-subj":"risk-score-update-confirm",onClick:a,fill:!0},kf)))):null,bX=()=>{const[e,t]=Object(r.useState)(!1),{data:a,isFetching:n}=Object(Lu.c)(),i=(e=>{const t=Object(Lu.a)();return Object(ih.useMutation)((()=>Object(iX.f)()),{...e,mutationKey:uX,onSettled:(...a)=>{t(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onSettled:()=>{t(!1)}}),o=(e=>{const t=Object(Lu.a)();return Object(ih.useMutation)((()=>Object(iX.b)()),{...e,mutationKey:dX,onSettled:(...e)=>{t()}})})(),l=(e=>{const t=Object(Lu.a)();return Object(ih.useMutation)((()=>Object(iX.a)()),{...e,mutationKey:pX,onSettled:(...e)=>{t()}})})(),c=null==a?void 0:a.risk_engine_status,[u,d,p]=Object(Am.b)(),m=i.isLoading||o.isLoading||l.isLoading||n,f=null==a?void 0:a.isUpdateAvailable,b=!c||m;let g=[];if(i.isError){var y;const e=i.error.body;var h;g=null!=e&&null!==(y=e.full_error)&&void 0!==y&&y.errors?null===(h=e.full_error)||void 0===h?void 0:h.errors:[e.message]}return c!==dv.d.ENABLED&&null!=a&&a.is_max_amount_of_risk_engines_reached?s.a.createElement(ee.EuiCallOut,{title:(v=dv.a,Y.i18n.translate("xpack.securitySolution.riskScore.maxSpacePanel.title",{defaultMessage:"You cannot enable entity risk scoring in more than {maxSpaces, plural, =1 {# Kibana space} other {# Kibana spaces}}.",values:{maxSpaces:v}})),color:"warning",iconType:"error","data-test-subj":"risk-score-warning-panel"},s.a.createElement("p",null,Af)):s.a.createElement(s.a.Fragment,null,s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,null,s.a.createElement("h2",null,af)),i.isError&&s.a.createElement(mX,{errors:g}),l.isError&&s.a.createElement(mX,{errors:[l.error.body.message]}),o.isError&&s.a.createElement(mX,{errors:[o.error.body.message]}),s.a.createElement(ee.EuiSpacer,{size:"m"}),s.a.createElement(ee.EuiFlexItem,{grow:0},s.a.createElement(fX,{isVisible:e,onConfirm:()=>i.mutate(),isLoading:i.isLoading,closeModal:()=>t(!1)}),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}),s.a.createElement(ee.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline"},sf,f&&s.a.createElement(ee.EuiBadge,{color:"success"},gf))),s.a.createElement(ee.EuiFlexItem,{grow:!1},f&&s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,i.isLoading&&!e&&s.a.createElement(ee.EuiLoadingSpinner,{size:"m"})),s.a.createElement(ee.EuiButtonEmpty,{disabled:i.isLoading,color:"primary",onClick:()=>t(!0),"data-test-subj":"risk-score-update-button"},yf)),!f&&s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(ee.EuiFlexItem,null,m&&s.a.createElement(ee.EuiLoadingSpinner,{"data-test-subj":"risk-score-status-loading",size:"m"})),s.a.createElement(gX,{"data-test-subj":"risk-score-status",$_css:"50px"},c===dv.d.ENABLED?s.a.createElement(ee.EuiHealth,{color:"success"},nf):s.a.createElement(ee.EuiHealth,{color:"subdued"},rf)),s.a.createElement(ee.EuiFlexItem,null,s.a.createElement(ee.EuiSwitch,{label:"","data-test-subj":"risk-score-switch",checked:c===dv.d.ENABLED,onChange:()=>{b||(c===dv.d.NOT_INSTALLED?i.mutate():c===dv.d.ENABLED?l.mutate():c===dv.d.DISABLED&&o.mutate())},compressed:!0,disabled:b,"aria-describedby":"switchRiskModule"}))))),s.a.createElement(ee.EuiHorizontalRule,{margin:"s"}))),s.a.createElement(ee.EuiSpacer,null),s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.EuiTitle,null,s.a.createElement("h2",null,of)),s.a.createElement(ee.EuiSpacer,null),s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(lX.a,{id:cX.c.entityAnalytics},lf),s.a.createElement(ee.EuiSpacer,{size:"s"})),s.a.createElement("li",null,s.a.createElement(ee.EuiLink,{onClick:d,"data-test-subj":"open-risk-information-flyout-trigger"},cf),u&&s.a.createElement(qm,{handleOnClose:p}),s.a.createElement(ee.EuiSpacer,{size:"s"})))));var v};var gX=ae()(ee.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-zswf7b-0"})((e=>({minWidth:e.$_css})));const yX=Y.i18n.translate("xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),hX=({indexPrivileges:e,clusterPrivileges:t})=>{const{docLinks:a}=Object(h.i)().services;return s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {clusterPrivileges} ",values:{essence:s.a.createElement("p",null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance. Read more about {docs}.",values:{docs:s.a.createElement(ee.EuiLink,{href:a.links.securitySolution.entityAnalytics.riskScorePrerequisites,target:"_blank"},s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.riskEngineRequirementsDocLink",defaultMessage:"Risk Scoring prerequisites"}))}})),indexPrivileges:e.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),s.a.createElement("ul",null,e.map((([e,t])=>s.a.createElement("li",{key:e},vX(e,t)))))):null,clusterPrivileges:t.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageBody.clusterPrivilegesTitle",defaultMessage:"Missing Elasticsearch cluster privileges:"}),s.a.createElement("ul",null,t.map((e=>s.a.createElement("li",{key:e},e))))):null}})},vX=(e,t)=>s.a.createElement(ms.FormattedMessage,{id:"xpack.securitySolution.riskEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index.",values:{privileges:s.a.createElement(_s,{values:t}),index:s.a.createElement(ee.EuiCode,null,e)}}),EX=()=>{const e=(()=>{const{data:e,isLoading:t}=Object(ih.useQuery)(["GET","FETCH_RISK_ENGINE_PRIVILEGES"],iX.c);return Object(r.useMemo)((()=>{if(t||!e)return{isLoading:!0};if(e.has_all_required)return{isLoading:!1,hasAllRequiredPrivileges:!0};const{privileges:a}=e,n=(e=>{const t=[];if(!e)return t;for(const[a,n]of Object.entries(dv.c)){const i=n.filter((t=>!e[a][t]));i.length&&t.push([a,i])}return t})(a.elasticsearch.index);return{isLoading:!1,hasAllRequiredPrivileges:!1,missingPrivileges:{indexPrivileges:n,clusterPrivileges:dv.b.filter((e=>{var t;return!(null!==(t=a.elasticsearch.cluster)&&void 0!==t&&t[e])}))}}}),[t,e])})();if(e.isLoading||e.hasAllRequiredPrivileges)return null;const t={type:"primary",id:"missing-risk-engine-privileges",title:yX,description:s.a.createElement(hX,e.missingPrivileges)};return t&&s.a.createElement(us,{namespace:"entity_analytics",condition:!0,message:t})},xX=()=>{const e=Object(ve.a)("riskEnginePrivilegesRouteEnabled");return s.a.createElement(s.a.Fragment,null,e&&s.a.createElement(EX,null),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline"},s.a.createElement(ee.EuiFlexItem,{grow:!1},s.a.createElement(ee.EuiPageHeader,{"data-test-subj":"entityAnalyticsManagementPageTitle",pageTitle:sA.k})),s.a.createElement(ee.EuiFlexItem,{grow:!1}),s.a.createElement(ee.EuiBetaBadge,{label:Po.a,size:"s"})),s.a.createElement(ee.EuiSpacer,{size:"l"}),s.a.createElement(ee.EuiFlexGroup,{gutterSize:"xl"},s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(bX,null)),s.a.createElement(ee.EuiFlexItem,{grow:2},s.a.createElement(oX,null))))};xX.displayName="EntityAnalyticsManagementPage";const jX=()=>s.a.createElement(Q,null,s.a.createElement(o.TrackApplicationView,{viewId:l.yc.entityAnalyticsManagement},s.a.createElement(xX,null),s.a.createElement(_,{pageName:l.yc.entityAnalyticsManagement}))),SX=()=>s.a.createElement(k.Switch,null,s.a.createElement(K.a,{path:l.sb,exact:!0,component:jX}),s.a.createElement(K.a,{component:J.a})),OX=s.a.memo(SX),kX=[{path:l.sb,render:()=>s.a.createElement(OX,null)}],wX={Detections:class detections_Detections{setup(){}start(e){return{storageDataTables:{tableById:Object(Z.b)(e,lc)},routes:oc}}},Cases:class cases_Cases{setup(){}start(){return{routes:G}}},Exceptions:class exceptions_Exceptions{setup(){}start(e){return{storageDataTables:{tableById:Object(Z.b)(e,lc)},routes:Vc}}},Explore:class explore_Explore{setup(){}start(e){return{routes:kT,exploreDataTables:{network:{tableById:Object(Z.b)(e,[W.e.networkPageEvents])},hosts:{tableById:Object(Z.b)(e,[W.e.hostsPageEvents,W.e.hostsPageSessions])},users:{tableById:Object(Z.b)(e,[W.e.usersPageEvents])}},store:{initialState:{network:pt.a,users:Object(Ne.a)(e),hosts:ut},reducer:{network:pt.d,users:Object(Ne.b)(e),hosts:dt}}}}},Kubernetes:class kubernetes_Kubernetes{setup(){}start(){return{routes:DT}}},Overview:class overview_Overview{setup(){}start(){return{routes:VA}}},Rules:class rules_Rules{setup(){}start(e){return{storageDataTables:{tableById:Object(Z.b)(e,lc)},routes:zG}}},Timelines:class timelines_Timelines{setup(){}start(){return{routes:YG,store:{initialState:{timeline:eW},reducer:{timeline:tW}}}}},Management:class management_Management{setup(){}start(e,t){return{routes:sY,store:{initialState:{management:{}},reducer:{management:oY.a},middleware:Object(lY.a)(e,t)}}}},Dashboards:class dashboards_Dashboards{setup(){}start(){return{routes:aX}}},CloudDefend:class cloud_defend_CloudDefend{setup(){}start(){return{routes:mY}}},CloudSecurityPosture:class cloud_security_posture_CloudSecurityPosture{setup(){}start(){return{routes:hY}}},ThreatIntelligence:class threat_intelligence_ThreatIntelligence{setup(){}start(){return{routes:OY}}},EntityAnalytics:class entity_analytics_EntityAnalytics{setup(){}start(e=!1){return{routes:e?kX:[]}}}}}])]);