/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[15],{1269:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return d}));var a=n(2),o=n.n(a),l=n(283);const s=Object(a.createContext)(0),i=()=>Object(a.useContext)(s),d=o.a.memo((({children:e})=>{const{ref:t,width:n}=Object(l.b)();return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.Provider,{value:null!=n?n:0},e),o.a.createElement("div",{ref:t}))}));d.displayName="EventDetailsWidthProvider"},1418:function(e,t,n){"use strict";n.d(t,"a",(function(){return ee}));var a=n(45),o=n(2),l=n.n(o),s=n(48),i=n(66),d=n(961),r=n(204),c=n(113),u=n(134),m=n(118),b=n(1390),v=n(468);const p=()=>l.a.createElement(l.a.Fragment,null);p.displayName="PlainRowRenderer";const h={id:c.d.plain,isInstance:e=>!0,renderRow:p};var E=n(243),w=n(1078),g=n(9),C=n(17),I=n(124),j=n(112),y=n(122),O=n(145),x=n(44),N=n.n(x),f=n(1442),R=n(697),S=n(459);const k=N.a.div.withConfig({displayName:"AddNoteContainer",componentId:"sc-1cqe11a-0"})([""]);k.displayName="AddNoteContainer",N.a.div.withConfig({displayName:"NoteContainer",componentId:"sc-1cqe11a-1"})(["margin-top:5px;"]).displayName="NoteContainer";const T=N()(C.EuiPanel).withConfig({displayName:"NoteCardsCompContainer",componentId:"sc-1cqe11a-2"})(["border:none;background-color:transparent;box-shadow:none;&.euiPanel--plain{background-color:transparent;}"]);T.displayName="NoteCardsCompContainer";const D=N()(C.EuiFlexGroup).withConfig({displayName:"NotesContainer",componentId:"sc-1cqe11a-3"})(["margin-bottom:5px;"]);D.displayName="NotesContainer";const P=l.a.memo((({ariaRowindex:e,associateNote:t,notes:n,showAddNote:a,toggleShowAddNote:s})=>{const[d,r]=Object(o.useState)(""),c=Object(o.useCallback)((e=>{t(e),s()}),[t,s]);return l.a.createElement(T,{"data-test-subj":"note-cards",hasShadow:!1,paddingSize:"none"},n.length?l.a.createElement(R.b,{"data-test-subj":"note-previews-container"},l.a.createElement(D,{className:Object(i.getNotesContainerClassName)(e),"data-test-subj":"notes",direction:"column",gutterSize:"none"},l.a.createElement(C.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},l.a.createElement("p",null,S.h(e))),l.a.createElement(R.a,{notes:n}))):null,a?l.a.createElement(k,{"data-test-subj":"add-note-container"},l.a.createElement(f.a,{associateNote:c,newNote:d,onCancelAddNote:s,updateNewNote:r})):null)}));P.displayName="NoteCards";var A=n(1269),F=n(751);const M=l.a.memo((({id:e,actionsColumnWidth:t,ariaRowindex:n,columnHeaders:a,data:s,ecsData:i,eventIdToNoteIds:d,isEventPinned:r=!1,isEventViewer:c=!1,loadingEventIds:u,notesCount:m,onEventDetailsPanelOpened:b,onRowSelected:v,refetch:p,hasRowRenderers:h,onRuleChange:w,renderCellValue:g,selectedEventIds:C,showCheckboxes:I,showNotes:j,tabType:y,timelineId:O,toggleShowNotes:x,leadingControlColumns:N,trailingControlColumns:f,setEventsLoading:R,setEventsDeleted:S})=>{const k=Object(o.useMemo)((()=>a.map((e=>{var t;return null!==(t=Object(F.b)({data:s,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[a,s]),T=Object(o.useMemo)((()=>N?N.map((e=>e.rowCellRender)):[]),[N]),D=Object(o.useMemo)((()=>T.map(((a,o)=>{const m=N[o].width?N[o].width:t;return l.a.createElement(E.m,{width:m,"data-test-subj":"event-actions-container",tabIndex:0,key:o},a&&l.a.createElement(a,{width:m,rowIndex:n,ariaRowindex:n,checked:Object.keys(C).includes(e),columnId:N[o].id||"",columnValues:k,onRowSelected:v,"data-test-subj":"actions",eventId:e,data:s,index:o,ecsData:i,loadingEventIds:u,onEventDetailsPanelOpened:b,showCheckboxes:I,eventIdToNoteIds:d,isEventPinned:r,isEventViewer:c,onRuleChange:w,refetch:p,showNotes:j,tabType:y,timelineId:O,toggleShowNotes:x,setEventsLoading:R,setEventsDeleted:S}))}))),[t,n,k,s,i,d,e,r,c,T,N,u,b,v,w,p,C,I,j,y,O,x,R,S]);return l.a.createElement(E.t,{"data-test-subj":"event-column-view"},D,l.a.createElement(F.a,{id:e,actionsColumnWidth:t,ariaRowindex:n,columnHeaders:a,data:s,ecsData:i,hasRowRenderers:h,notesCount:m,renderCellValue:g,tabType:y,timelineId:O,trailingControlColumns:f,leadingControlColumns:N,checked:Object.keys(C).includes(e),columnValues:k,onRowSelected:v,"data-test-subj":"actions",loadingEventIds:u,onEventDetailsPanelOpened:b,showCheckboxes:I,eventIdToNoteIds:d,isEventPinned:r,isEventViewer:c,refetch:p,onRuleChange:w,selectedEventIds:C,showNotes:j,toggleShowNotes:x,setEventsLoading:R,setEventsDeleted:S}))}));M.displayName="EventColumnView";var _=n(128),V=n(282),L=n(960);var $=n(5);const B=({ariaRowindex:e,containerRef:t,event:n,lastFocusedAriaColindex:s,rowRenderers:d,timelineId:r})=>{const{focusOwnership:c,onFocus:u,onKeyDown:m,onOutsideClick:b}=(({ariaRowindex:e,colindexAttribute:t,containerRef:n,lastFocusedAriaColindex:a,onColumnFocused:l,rowindexAttribute:s})=>{const[d,r]=Object(o.useState)("not-owned"),c=Object(o.useCallback)((()=>{r((e=>"owned"!==e?"owned":e))}),[]),u=Object(o.useCallback)((()=>{r("not-owned")}),[]),m=Object(o.useCallback)((o=>{if(Object(i.isArrowDownOrArrowUp)(o)||Object(i.isEscape)(o)){o.preventDefault(),o.stopPropagation(),r("not-owned");const d=Object(i.isEscape)(o)?e:(({ariaRowindex:e,event:t})=>Object(i.isArrowUp)(t)?e:e+1)({ariaRowindex:e,event:o});setTimeout((()=>{l(Object(i.focusColumn)({ariaColindex:a,ariaRowindex:d,colindexAttribute:t,containerElement:n.current,rowindexAttribute:s}))}),0)}}),[e,t,n,a,l,s]);return Object(o.useMemo)((()=>({focusOwnership:d,onFocus:c,onOutsideClick:u,onKeyDown:m})),[d,c,m,u])})({ariaRowindex:e,colindexAttribute:i.ARIA_COLINDEX_ATTRIBUTE,containerRef:t,lastFocusedAriaColindex:s,onColumnFocused:a.noop,rowindexAttribute:i.ARIA_ROWINDEX_ATTRIBUTE}),v=Object(o.useMemo)((()=>Object(L.a)({data:n.ecs,rowRenderers:d})),[n.ecs,d]);return Object(o.useMemo)((()=>{return v&&l.a.createElement("div",{className:Object(i.getRowRendererClassName)(e),role:"dialog",onFocus:u},l.a.createElement(C.EuiOutsideClickDetector,{onOutsideClick:b},l.a.createElement(C.EuiFocusTrap,{clickOutsideDisables:!0,disabled:"owned"!==c},l.a.createElement(C.EuiScreenReaderOnly,{"data-test-subj":"eventRendererScreenReaderOnly"},l.a.createElement("p",null,(t=e,$.i18n.translate("xpack.securitySolution.timeline.youAreInAnEventRendererScreenReaderOnly",{values:{row:t},defaultMessage:"You are in an event renderer for row: {row}. Press the up arrow key to exit and return to the current row, or the down arrow key to exit and advance to the next row."})))),l.a.createElement("div",{onKeyDown:m},v.renderRow({data:n.ecs,isDraggable:!0,scopeId:r})))));var t}),[e,n.ecs,c,u,m,b,v,r])};var W=n(327),q=n(1066);const K=[],z=l.a.memo((({children:e})=>{const t=Object(A.b)();return l.a.createElement(E.x,{width:t},e)}));z.displayName="EventsTrSupplementContainerWrapper";const H=({actionsColumnWidth:e,containerRef:t,columnHeaders:n,event:a,eventIdToNoteIds:i,isEventViewer:d=!1,isEventPinned:r=!1,lastFocusedAriaColindex:c,loadingEventIds:b,onRowSelected:p,refetch:h,renderCellValue:w,rowRenderers:g,onRuleChange:x,ariaRowindex:N,selectedEventIds:f,showCheckboxes:R,tabType:S,timelineId:k,leadingControlColumns:T,trailingControlColumns:D})=>{var A,$,H,U;const G=Object(o.useRef)(null),X=Object(s.useDispatch)(),[Y]=Object(o.useState)({timelineID:k,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0,tabType:S}),[J,Q]=Object(o.useState)({}),Z=Object(o.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),ee=Object(j.a)((e=>{var t,n;return null!==(t=(null!==(n=Z(e,k))&&void 0!==n?n:u.b).expandedDetail)&&void 0!==t?t:{}})),te=Object(F.c)({data:null==a?void 0:a.data,fieldName:"host.name"}),ne=Object(o.useMemo)((()=>te&&te.length>0?te[0]:null),[te]),ae=Object(F.c)({data:null==a?void 0:a.data,fieldName:"host.ip"}),oe=Object(F.c)({data:null==a?void 0:a.data,fieldName:"source.ip"}),le=Object(F.c)({data:null==a?void 0:a.data,fieldName:"destination.ip"}),se=Object(o.useMemo)((()=>new Set([...null!=ae?ae:[],...null!=oe?oe:[],...null!=le?le:[]])),[le,oe,ae]),ie=ee[null!=S?S:y.d.query],de="eventDetail"===(null==ie?void 0:ie.panelView)&&(null==ie||null===(A=ie.params)||void 0===A?void 0:A.eventId)===a._id||"hostDetail"===(null==ie?void 0:ie.panelView)&&(null==ie||null===($=ie.params)||void 0===$?void 0:$.hostName)===ne||"networkDetail"===(null==ie?void 0:ie.panelView)&&(null==ie||null===(H=ie.params)||void 0===H?void 0:H.ip)&&(null==se?void 0:se.has(null==ie||null===(U=ie.params)||void 0===U?void 0:U.ip))||!1,re=Object(o.useMemo)((()=>_.a.notesByIdsSelector()),[]),ce=Object(j.a)(re),ue=i[a._id]||K,me=Object(o.useMemo)((()=>_.a.getNotes(ce,ue).map((e=>{var t;return{savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}}))),[ce,ue]),be=Object(o.useMemo)((()=>null!=Object(L.a)({data:a.ecs,rowRenderers:g})),[a.ecs,g]),ve=Object(o.useCallback)((()=>{const e=a._id;Q((t=>(t[e]&&setTimeout((()=>{var e;const t=null===(e=G.current)||void 0===e?void 0:e.querySelector(`.${W.b}`);null==t||t.focus()}),0),{...t,[e]:!t[e]})))}),[a]),pe=Object(o.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:a._id,indexName:a._index,refetch:h}};X(m.a.toggleDetailPanel({...e,tabType:S,id:k})),k===y.c.active&&S===y.d.query&&V.a.toggleExpandedDetail({...e})}),[X,a._id,a._index,h,S,k]),he=Object(o.useCallback)((e=>{X(m.a.addNoteToEvent({eventId:a._id,id:k,noteId:e})),r||X(m.a.pinEvent({id:k,eventId:a._id}))}),[X,a,r,k]),Ee=Object(o.useCallback)((({eventIds:e,isLoading:t})=>{X(m.a.setEventsLoading({id:k,eventIds:e,isLoading:t}))}),[X,k]),we=Object(o.useCallback)((({eventIds:e,isDeleted:t})=>{X(m.a.setEventsDeleted({id:k,eventIds:e,isDeleted:t}))}),[X,k]);return l.a.createElement(q.a.Provider,{value:Y},l.a.createElement(E.u,{$ariaRowindex:N,className:O.f,"data-test-subj":"event",eventType:Object(v.e)(a.ecs),isBuildingBlockType:Object(I.p)(a.ecs),isEvenEqlSequence:Object(v.h)(a.ecs),isExpanded:de,ref:G,showLeftBorder:!d},l.a.createElement(M,{id:a._id,actionsColumnWidth:e,ariaRowindex:N,columnHeaders:n,data:a.data,ecsData:a.ecs,eventIdToNoteIds:i,hasRowRenderers:be,isEventPinned:r,isEventViewer:d,loadingEventIds:b,notesCount:me.length,onEventDetailsPanelOpened:pe,onRowSelected:p,refetch:h,renderCellValue:w,onRuleChange:x,selectedEventIds:f,showCheckboxes:R,showNotes:!!J[a._id],tabType:S,timelineId:k,toggleShowNotes:ve,leadingControlColumns:T,trailingControlColumns:D,setEventsLoading:Ee,setEventsDeleted:we}),l.a.createElement(z,null,l.a.createElement(E.w,{className:"siemEventsTable__trSupplement--notes","data-test-subj":"event-notes-flex-item",$display:"block"},l.a.createElement(P,{ariaRowindex:N,associateNote:he,"data-test-subj":"note-cards",notes:me,showAddNote:!!J[a._id],toggleShowAddNote:ve})),l.a.createElement(C.EuiFlexGroup,{gutterSize:"none",justifyContent:"center"},l.a.createElement(C.EuiFlexItem,{grow:!1},l.a.createElement(E.w,null,l.a.createElement(B,{ariaRowindex:N,containerRef:t,event:a,lastFocusedAriaColindex:c,rowRenderers:g,timelineId:k})))))))},U=l.a.memo(H),G=({actionsColumnWidth:e,columnHeaders:t,containerRef:n,data:a,eventIdToNoteIds:o,id:s,isEventViewer:i=!1,lastFocusedAriaColindex:d,loadingEventIds:r,onRowSelected:c,pinnedEventIds:u,refetch:m,onRuleChange:b,renderCellValue:p,rowRenderers:h,selectedEventIds:w,showCheckboxes:C,tabType:I,leadingControlColumns:j,trailingControlColumns:y})=>l.a.createElement(E.j,{"data-test-subj":"events"},a.map(((a,E)=>{var O,x;return l.a.createElement(U,{actionsColumnWidth:e,ariaRowindex:E+2,columnHeaders:t,containerRef:n,event:a,eventIdToNoteIds:o,isEventPinned:Object(v.c)({eventId:a._id,pinnedEventIds:u}),isEventViewer:i,key:`${s}_${I}_${a._id}_${a._index}_${Object(g.isEmpty)(null===(O=a.ecs.eql)||void 0===O?void 0:O.sequenceNumber)?"":null===(x=a.ecs.eql)||void 0===x?void 0:x.sequenceNumber}`,lastFocusedAriaColindex:d,loadingEventIds:r,onRowSelected:c,renderCellValue:p,refetch:m,rowRenderers:h,onRuleChange:b,selectedEventIds:w,showCheckboxes:C,tabType:I,timelineId:s,leadingControlColumns:j,trailingControlColumns:y})}))),X=l.a.memo(G);var Y=n(57),J=n(353);const Q=Object(Y.createSelector)(Object(J.getTimelineByIdSelector)(),(e=>({timeline:e})));var Z=n(18);const ee=l.a.memo((({activePage:e,browserFields:t,data:n,id:p,isEventViewer:g=!1,onRuleChange:C,refetch:I,renderCellValue:j,rowRenderers:y,sort:O,tabType:x,totalPages:N,leadingControlColumns:f=[],trailingControlColumns:R=[]})=>{const S=Object(s.useDispatch)(),k=Object(o.useRef)(null),{timeline:{columns:T,eventIdToNoteIds:D,excludedRowRendererIds:P,isSelectAllChecked:A,loadingEventIds:F,pinnedEventIds:M,selectedEventIds:_,show:V,queryFields:L,selectAll:$}=u.b}=Object(s.useSelector)((e=>Q(e,p))),B=Object(o.useMemo)((()=>Object(b.b)(T,t)),[t,T]),W=Object(Z.b)().isEnterprise()?6:5,q=Object(o.useCallback)((({eventIds:e,isSelected:t})=>{S(m.a.setSelected({id:p,eventIds:Object(v.d)(n,e,L),isSelected:t,isSelectAllChecked:t&&Object.keys(_).length+1===n.length}))}),[n,S,p,L,_]),K=Object(o.useCallback)((({isSelected:e})=>S(e?m.a.setSelected({id:p,eventIds:Object(v.d)(n,n.map((e=>e._id)),L),isSelected:e,isSelectAllChecked:e}):m.a.clearSelected({id:p}))),[n,S,p,L]);Object(o.useEffect)((()=>{$&&!A&&K({isSelected:!0})}),[A,K,$]);const z=Object(o.useMemo)((()=>P&&P.length===Object.keys(c.d).length?[h]:P?y.filter((e=>!P.includes(e.id))):y),[P,y]),H=Object(o.useMemo)((()=>Object(d.c)(W)),[W]),U=Object(o.useMemo)((()=>B.reduce(((e,t)=>{var n;return e+(null!==(n=t.initialWidth)&&void 0!==n?n:r.a)}),0)),[B]),G=Object(o.useMemo)((()=>f?f.reduce(((e,t)=>t.width?e+t.width:e+H),0):0),[H,f]),Y=Object(o.useMemo)((()=>R?R.reduce(((e,t)=>t.width?e+t.width:e+H),0):0),[H,R]),J=Object(o.useMemo)((()=>U+G+Y),[U,G,Y]),[ee]=Object(o.useState)(i.FIRST_ARIA_INDEX),te=Object(o.useMemo)((()=>B.length+R.length+f.length),[B,R,f]),ne=Object(o.useCallback)((e=>{Object(i.onKeyDownFocusHandler)({colindexAttribute:i.ARIA_COLINDEX_ATTRIBUTE,containerElement:k.current,event:e,maxAriaColindex:B.length+1,maxAriaRowindex:n.length+1,onColumnFocused:a.noop,rowindexAttribute:i.ARIA_ROWINDEX_ATTRIBUTE})}),[B.length,k,n.length]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(E.z,{"data-test-subj":"timeline-body",ref:k},l.a.createElement(E.i,{$activePage:e,$columnCount:te,"data-test-subj":`${x}-events-table`,columnWidths:J,onKeyDown:ne,$rowCount:n.length,$totalPages:N},l.a.createElement(w.a,{actionsColumnWidth:H,browserFields:t,columnHeaders:B,isEventViewer:g,isSelectAllChecked:A,onSelectAll:K,show:V,showEventsSelect:!1,showSelectAllCheckbox:!1,sort:O,tabType:x,timelineId:p,leadingControlColumns:f,trailingControlColumns:R}),l.a.createElement(X,{containerRef:k,actionsColumnWidth:H,columnHeaders:B,data:n,eventIdToNoteIds:D,id:p,isEventViewer:g,lastFocusedAriaColindex:ee,loadingEventIds:F,onRowSelected:q,pinnedEventIds:M,refetch:I,renderCellValue:j,rowRenderers:z,onRuleChange:C,selectedEventIds:_,showCheckboxes:!1,leadingControlColumns:f,trailingControlColumns:R,tabType:x}))),l.a.createElement(E.A,null))}));ee.displayName="StatefulBody"},1442:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(17),o=n(2),l=n.n(o),s=n(44),i=n.n(s),d=n(48),r=n(167),c=n(110),u=n(590),m=n(459),b=n(390);const v=i()(a.EuiFlexItem).withConfig({displayName:"NewNoteTabs",componentId:"sc-uq31qy-0"})(["width:100%;"]);v.displayName="NewNoteTabs";const p=l.a.memo((({note:e,noteInputHeight:t,updateNewNote:n,autoFocusDisabled:a=!1,setIsMarkdownInvalid:o})=>l.a.createElement(v,{"data-test-subj":"new-note-tabs"},l.a.createElement(b.a,{ariaLabel:m.d,onChange:n,value:e,dataTestSubj:"add-a-note",height:t,autoFocusDisabled:a,setIsMarkdownInvalid:o}))));p.displayName="NewNote";const h=i.a.div.withConfig({displayName:"AddNotesContainer",componentId:"sc-1065h8-0"})(["margin-bottom:5px;user-select:none;"]);h.displayName="AddNotesContainer";const E=i()(a.EuiFlexGroup).withConfig({displayName:"ButtonsContainer",componentId:"sc-1065h8-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeS));E.displayName="ButtonsContainer";const w=l.a.memo((({onCancelAddNote:e})=>l.a.createElement(a.EuiButtonEmpty,{"data-test-subj":"cancel",onClick:e},m.b)));w.displayName="CancelButton";const g=l.a.memo((({associateNote:e,newNote:t,onCancelAddNote:n,updateNewNote:s,autoFocusDisabled:i=!1})=>{const b=Object(d.useDispatch)(),v=Object(c.f)(),[g,C]=Object(o.useState)(!1),I=Object(o.useCallback)((e=>b(r.a.updateNote({note:e}))),[b]),j=Object(o.useCallback)((()=>{const n=null==v?void 0:v.username;n&&Object(u.b)({associateNote:e,newNote:t,updateNewNote:s,updateNote:I,user:n})}),[e,t,s,I,v]),y=Object(o.useCallback)((e=>{e.stopPropagation(),"Escape"===e.key&&null!=n&&n()}),[n]),O=Object(o.useMemo)((()=>0===t.trim().length||g),[t,g]);return l.a.createElement(h,{onKeyDown:y,role:"dialog"},l.a.createElement("div",{style:{width:"100%"}},l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},l.a.createElement("p",null,m.g)),l.a.createElement(p,{note:t,noteInputHeight:200,updateNewNote:s,autoFocusDisabled:i,setIsMarkdownInvalid:C}),l.a.createElement(E,{gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(w,{onCancelAddNote:n})):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(a.EuiButton,{"data-test-subj":"add-note",isDisabled:O,fill:!0,onClick:j},m.a)))))}));g.displayName="AddNote"},1443:function(e,t,n){"use strict";n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return F}));var a=n(17),o=n(47),l=n(2),s=n.n(l),i=n(44),d=n.n(i),r=n(48),c=n(145),u=n(5);u.i18n.translate("xpack.securitySolution.footer.events",{defaultMessage:"Events"});const m=u.i18n.translate("xpack.securitySolution.footer.of",{defaultMessage:"of"}),b=u.i18n.translate("xpack.securitySolution.footer.rows",{defaultMessage:"rows"}),v=u.i18n.translate("xpack.securitySolution.footer.loadingLabel",{defaultMessage:"Loading"}),p=u.i18n.translate("xpack.securitySolution.footer.totalCountOfEvents",{defaultMessage:"events"}),h=u.i18n.translate("xpack.securitySolution.footer.autoRefreshActiveDescription",{defaultMessage:"Auto-Refresh Active"}),E=u.i18n.translate("xpack.securitySolution.footer.loadingEventsDataLabel",{defaultMessage:"Loading Events"});var w=n(1269),g=n(118),C=n(112),I=n(110);const j=s.a.memo((({updatedAt:e})=>{const{timelines:t}=Object(I.i)().services,n=Object(w.b)(),a=Object(l.useMemo)((()=>(e=>e<600)(n)),[n]);return e>0?s.a.createElement(y,{"data-test-subj":"fixed-width-last-updated",compact:a},t.getLastUpdated({updatedAt:e,compact:a})):null}));j.displayName="FixedWidthLastUpdatedContainer";const y=d.a.div.withConfig({displayName:"FixedWidthLastUpdated",componentId:"sc-4whhh0-0"})(["width:","px;overflow:hidden;text-align:end;"],(({compact:e})=>e?25:200));y.displayName="FixedWidthLastUpdated";const O=d()(a.EuiFlexGroup).attrs((({height:e})=>({style:{height:`${e}px`}}))).withConfig({displayName:"FooterContainer",componentId:"sc-4whhh0-1"})(["flex:0 0 auto;"]);O.displayName="FooterContainer";const x=d()(a.EuiFlexGroup).withConfig({displayName:"FooterFlexGroup",componentId:"sc-4whhh0-2"})(["height:35px;width:100%;"]);x.displayName="FooterFlexGroup";const N=d.a.div.withConfig({displayName:"LoadingPanelContainer",componentId:"sc-4whhh0-3"})(["padding-top:3px;"]);N.displayName="LoadingPanelContainer";const f=d.a.div.withConfig({displayName:"ServerSideEventCount",componentId:"sc-4whhh0-4"})(["margin:0 5px 0 5px;"]);f.displayName="ServerSideEventCount";const R=40,S=({closePopover:e,documentType:t,footerText:n,isOpen:o,items:i,itemsCount:d,onClick:r,serverSideEventCount:u})=>{const b=Object(l.useMemo)((()=>u>0?u:0),[u]);return s.a.createElement("h5",null,s.a.createElement(a.EuiPopover,{className:"footer-popover",id:"customizablePagination","data-test-subj":"timelineSizeRowPopover",button:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiBadge,{"data-test-subj":"local-events-count",color:"hollow"},d,s.a.createElement(a.EuiButtonEmpty,{className:c.d,flush:"both",size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:r,"data-test-subj":"local-events-count-button"})),` ${m} `),isOpen:o,closePopover:e,panelPaddingSize:"none"},s.a.createElement(a.EuiContextMenuPanel,{items:i,"data-test-subj":"timelinePickSizeRow"})),s.a.createElement(a.EuiToolTip,{content:s.a.createElement(s.a.Fragment,null,b," ",n)},s.a.createElement(f,null,s.a.createElement(a.EuiBadge,{color:"hollow","data-test-subj":"server-side-event-count"},b)," ",t)))};S.displayName="EventsCountComponent";const k=s.a.memo(S);k.displayName="EventsCount";const T=d.a.div.withConfig({displayName:"TimelinePaginationContainer",componentId:"sc-4whhh0-5"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}"],(({hideLastPage:e})=>e?"display:none":"")),D=({activePage:e,isLoading:t,onPageClick:n,totalCount:o,totalPages:l})=>t?s.a.createElement(s.a.Fragment,null,`${v}...`):l?s.a.createElement(T,{hideLastPage:o>9999},s.a.createElement(a.EuiPagination,{"data-test-subj":"timeline-pagination",pageCount:l,activePage:e,onPageClick:n})):null;D.displayName="PagingControlComponent";const P=s.a.memo(D);P.displayName="PagingControl";const A=({activePage:e,updatedAt:t,height:n,id:i,isLive:d,isLoading:c,itemsCount:u,itemsPerPage:m,itemsPerPageOptions:v,onChangePage:w,totalCount:y})=>{const f=Object(r.useDispatch)(),{timelines:R}=Object(I.i)().services,[S,T]=Object(l.useState)(!1),[D,A]=Object(l.useState)(!1),F=Object(l.useMemo)((()=>g.b.getTimelineByIdSelector()),[]),{documentType:M=p,loadingText:_=E,footerText:V=p}=Object(C.a)((e=>F(e,i))),L=Object(l.useCallback)((e=>{A(!0),w(e)}),[w]),$=Object(l.useCallback)((()=>T(!S)),[S,T]),B=Object(l.useCallback)((()=>T(!1)),[T]),W=Object(l.useCallback)((e=>f(g.a.updateItemsPerPage({id:i,itemsPerPage:e}))),[f,i]),q=Object(l.useMemo)((()=>v&&v.map((e=>s.a.createElement(a.EuiContextMenuItem,{key:e,icon:m===e?"check":"empty","data-test-subj":`items-per-page-option-${e}`,onClick:()=>{B(),W(e)}},`${e} ${b}`)))),[B,m,v,W]),K=Object(l.useMemo)((()=>Math.ceil(y/m)),[m,y]);return Object(l.useEffect)((()=>{D&&!c&&A(!1)}),[c,D]),c&&!D?s.a.createElement(N,null,R.getLoadingPanel({dataTestSubj:"LoadingPanelTimeline",height:"35px",showBorder:!1,text:_,width:"100%"})):s.a.createElement(O,{"data-test-subj":"timeline-footer",direction:"column",gutterSize:"none",height:n,justifyContent:"spaceAround"},s.a.createElement(x,{alignItems:"center","data-test-subj":"footer-flex-group",direction:"row",gutterSize:"none",justifyContent:"spaceBetween"},s.a.createElement(a.EuiFlexItem,{"data-test-subj":"event-count-container",grow:!1},s.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"events-count",direction:"row",gutterSize:"none"},s.a.createElement(k,{closePopover:B,documentType:M,footerText:V,isOpen:S,items:q,itemsCount:u,onClick:$,serverSideEventCount:y}))),s.a.createElement(a.EuiFlexItem,{"data-test-subj":"last-updated-container",grow:!1},s.a.createElement(j,{updatedAt:t})),s.a.createElement(a.EuiFlexItem,{"data-test-subj":"paging-control-container",grow:!1},d?s.a.createElement(a.EuiText,{size:"s","data-test-subj":"is-live-on-message"},s.a.createElement("b",null,h," ",s.a.createElement(a.EuiIconTip,{color:"text",content:s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.footer.autoRefreshActiveTooltip",defaultMessage:"While auto-refresh is enabled, timeline will show you the latest {numberOfItems} events that match your query.",values:{numberOfItems:u}}),type:"iInCircle"}))):s.a.createElement(P,{"data-test-subj":"paging-control",totalCount:y,totalPages:K,activePage:e,onPageClick:L,isLoading:c}))))};A.displayName="FooterComponent";const F=s.a.memo(A);F.displayName="Footer"},751:function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return y}));var a=n(17),o=n(2),l=n.n(o),s=n(45),i=n(114),d=n(145),r=n(243),c=n(23),u=n.n(c);const m=({rowIndex:e,colIndex:t,data:n,header:a,eventId:s,linkValues:i,renderCellValue:d,tabType:r,timelineId:c})=>{const[m,b]=Object(o.useState)({});return l.a.createElement("div",u()({"data-test-subj":"statefulCell"},m),d({columnId:a.id,eventId:s,data:n,header:a,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:i,rowIndex:e,colIndex:t,setCellProps:b,scopeId:c,key:null!=r?`${c}-${r}`:c}))};m.displayName="StatefulCellComponent";const b=l.a.memo(m);var v=n(5);const p=({column:e,row:t})=>v.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),h=e=>v.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),E=({notesCount:e,row:t})=>v.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),w=e=>{var t;const{altKey:n,ctrlKey:a,key:o,metaKey:l,shiftKey:s,target:d,type:c}=e,u=d;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(o)&&null!==(t=u.className)&&void 0!==t&&t.includes(r.b)){const t=u.querySelector(`.${i.a}`),d=new KeyboardEvent(c,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:o,metaKey:l,shiftKey:s});" "===o&&e.preventDefault(),null==t||t.dispatchEvent(d)}},g=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:o,columnId:s,columnValues:i,data:c,ecsData:u,eventIdToNoteIds:m,index:b,isEventPinned:v,isEventViewer:g,eventId:C,loadingEventIds:I,notesCount:j,onEventDetailsPanelOpened:y,onRowSelected:O,refetch:x,rowIndex:N,hasRowRenderers:f,onRuleChange:R,selectedEventIds:S,showCheckboxes:k,showNotes:T,tabType:D,timelineId:P,toggleShowNotes:A,setEventsLoading:F,setEventsDeleted:M})=>{const _=t||n;return l.a.createElement(r.m,{width:_,"data-test-subj":"event-actions-container",tabIndex:0},l.a.createElement(r.k,{$ariaColumnIndex:b+d.c,key:null!=D?`${C}_${D}`:`${C}`,onKeyDown:w,role:"button",tabIndex:0,width:t},l.a.createElement(r.l,{"data-test-subj":"cell-container"},l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},l.a.createElement("p",null,p({row:o,column:b+2}))),e&&l.a.createElement(e,{ariaRowindex:o,width:t,checked:Object.keys(S).includes(C),columnId:s,columnValues:i,eventId:C,data:c,ecsData:u,eventIdToNoteIds:m,index:b,isEventPinned:v,isEventViewer:g,loadingEventIds:I,onEventDetailsPanelOpened:y,onRowSelected:O,refetch:x,rowIndex:N,onRuleChange:R,showCheckboxes:k,showNotes:T,timelineId:P,toggleShowNotes:A,setEventsLoading:F,setEventsDeleted:M}))),f?l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},l.a.createElement("p",null,h(o))):null,j?l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},l.a.createElement("p",null,E({row:o,notesCount:j}))):null))},C=({_id:e,ariaRowindex:t,index:n,header:o,data:i,ecsData:c,hasRowRenderers:u,notesCount:m,renderCellValue:v,tabType:g,timelineId:C})=>{var I;const j=n+d.c;return l.a.createElement(r.k,{$ariaColumnIndex:j,key:null!=g?`${o.id}_${g}`:`${o.id}`,onKeyDown:w,role:"button",tabIndex:0,width:o.initialWidth},l.a.createElement(r.l,{"data-test-subj":"cell-container"},l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},l.a.createElement("p",null,p({row:t,column:j}))),l.a.createElement(b,{rowIndex:t-1,colIndex:j-1,data:i,header:o,eventId:e,linkValues:Object(s.getOr)([],null!==(I=o.linkField)&&void 0!==I?I:"",c),renderCellValue:v,tabType:g,timelineId:C}))),u?l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},l.a.createElement("p",null,h(t))):null,m?l.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},l.a.createElement("p",null,E({row:t,notesCount:m}))):null)},I=l.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:a,data:s,ecsData:i,eventIdToNoteIds:d,isEventPinned:c,isEventViewer:u,id:m,loadingEventIds:b,notesCount:v,onEventDetailsPanelOpened:p,onRowSelected:h,refetch:E,hasRowRenderers:w,onRuleChange:I,renderCellValue:j,selectedEventIds:y,showCheckboxes:O,showNotes:x,tabType:N,timelineId:f,toggleShowNotes:R,trailingControlColumns:S,leadingControlColumns:k,setEventsLoading:T,setEventsDeleted:D})=>{const P=Object(o.useMemo)((()=>S?S.map((e=>e.rowCellRender)):[]),[S]),A=Object(o.useMemo)((()=>k.length+n.length),[k,n]),F=Object(o.useMemo)((()=>P.map(((n,o)=>n&&l.a.createElement(g,{action:n,width:S[o].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(y).includes(m),columnId:S[o].id||"",columnValues:a,onRowSelected:h,"data-test-subj":"actions",eventId:m,data:s,key:o,index:A+o,rowIndex:e,ecsData:i,loadingEventIds:b,onEventDetailsPanelOpened:p,showCheckboxes:O,eventIdToNoteIds:d,isEventPinned:c,isEventViewer:u,notesCount:v,refetch:E,hasRowRenderers:w,onRuleChange:I,selectedEventIds:y,showNotes:x,tabType:N,timelineId:f,toggleShowNotes:R,setEventsLoading:T,setEventsDeleted:D})))),[S,m,s,i,h,c,u,t,e,a,d,w,A,b,v,p,I,E,y,O,x,N,f,R,P,T,D]),M=Object(o.useMemo)((()=>n.map(((t,n)=>l.a.createElement(C,{_id:m,index:n,header:t,key:null!=N?`${t.id}_${N}`:`${t.id}`,ariaRowindex:e,data:s,ecsData:i,hasRowRenderers:w,notesCount:v,renderCellValue:j,tabType:N,timelineId:f})))),[m,e,n,s,i,w,v,j,N,f]);return l.a.createElement(r.n,{"data-test-subj":"data-driven-columns"},M,F)}));I.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const n=e.find((e=>e.field===t));return null!=n&&null!=n.value?n.value:void 0},y=({data:e,fieldName:t})=>Object(o.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},951:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),o=n.n(a),l=n(961),s=n(594);const i=e=>[{headerCellRender:()=>o.a.createElement(o.a.Fragment,null,s.a),id:"default-timeline-control-column",rowCellRender:l.a,width:Object(l.c)(e)}]}}]);