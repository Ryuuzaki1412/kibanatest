/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[12],{126:function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return g})),a.d(t,"f",(function(){return f}));var n=a(45),o=a(2),r=a.n(o),i=a(44),s=a.n(i);const l=a(5).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),u=s.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));u.displayName="EmptyWrapper";const c=()=>"â€”",d=()=>`(${l})`,m=()=>r.a.createElement(u,null,c()),p=()=>r.a.createElement(u,null,d()),g=e=>null==e?m():Object(n.isString)(e)&&""===e?p():r.a.createElement(r.a.Fragment,null,e),f=e=>null==e?m():""===e?p():r.a.createElement(r.a.Fragment,null,e)},130:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(48),o=a(16);const r=Object(o.b)(),i=e=>{const t=s();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},s=()=>Object(n.useSelector)((({app:{enableExperimental:e}})=>e))},137:function(e,t,a){"use strict";a.d(t,"g",(function(){return C.d})),a.d(t,"f",(function(){return C.c})),a.d(t,"o",(function(){return k})),a.d(t,"m",(function(){return I})),a.d(t,"d",(function(){return N})),a.d(t,"h",(function(){return D})),a.d(t,"a",(function(){return z})),a.d(t,"c",(function(){return B})),a.d(t,"i",(function(){return H})),a.d(t,"e",(function(){return $})),a.d(t,"b",(function(){return R})),a.d(t,"j",(function(){return W})),a.d(t,"n",(function(){return q})),a.d(t,"l",(function(){return K})),a.d(t,"k",(function(){return X}));var n=a(17),o=a(2),r=a.n(o),i=a(45),s=a(470),l=a(266),u=a(526),c=a(4),d=a(563),m=a(164),p=a(245),g=a(110),f=a(226),b=a(5),h=a(397);const y=e=>b.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var E=a(129),v=a(527),C=a(284),O=a(23),j=a.n(O),S=a(462),x=a(486);const k=()=>{const e=Object(S.b)(),t=Object(x.a)();return Object(o.useCallback)((({deepLinkId:a,path:n,onClick:o})=>{const r=t(a);return e({id:a,path:n,urlState:r,onClick:o})}),[e,t])},w=e=>(e=>r.a.memo((function({deepLinkId:t,...a}){const n=Object(x.a)()(t);return r.a.createElement(e,j()({id:t,urlState:n},a))})))(Object(S.d)(e)),T=({children:e,Component:t,userName:a,isButton:n,onClick:i,title:s,userTab:l})=>{const u=encodeURIComponent(a),{formatUrl:d,search:p}=Object(m.l)(E.a.users),{application:{navigateToApp:f},telemetry:b}=Object(g.i)().services,h=Object(o.useCallback)((e=>{e.preventDefault(),f(c.l,{deepLinkId:E.a.users,path:l?Object(v.a)(u,l,p):Object(v.c)(u,p)})}),[u,f,p,l]),y=Object(o.useMemo)((()=>d(l?Object(v.a)(u,l):Object(v.c)(u))),[d,u,l]),O=Object(o.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"user"}),(null!=i?i:h)(e)}),[h,i,b]);return n?r.a.createElement(C.b,{Component:t,dataTestSubj:"data-grid-user-details",href:y,onClick:O,title:null!=s?s:a},e||a):r.a.createElement(C.c,{"data-test-subj":"users-link-anchor",onClick:O,href:y},e||a)},I=r.a.memo(T),M=({children:e,Component:t,hostName:a,isButton:n,onClick:i,title:s,hostTab:l})=>{const{formatUrl:u,search:d}=Object(m.l)(E.a.hosts),{application:{navigateToApp:p},telemetry:f}=Object(g.i)().services,b=encodeURIComponent(a),h=Object(o.useCallback)((e=>{e.preventDefault(),p(c.l,{deepLinkId:E.a.hosts,path:l?Object(m.i)(b,l,d):Object(m.d)(b,d)})}),[b,p,d,l]),y=Object(o.useMemo)((()=>u(l?Object(m.i)(b,l):Object(m.d)(b))),[u,b,l]),v=Object(o.useCallback)((e=>{f.reportEntityDetailsClicked({entity:"host"}),(null!=i?i:h)(e)}),[h,i,f]);return n?r.a.createElement(C.b,{Component:t,dataTestSubj:"data-grid-host-details",href:y,iconType:"expand",onClick:v,title:null!=s?s:a},e):r.a.createElement(C.c,{onClick:v,href:y,"data-test-subj":"host-details-button"},e||a)},N=r.a.memo(M),F=["http://","https://"],A=r.a.memo((({url:e,children:t,idx:a,overflowIndexStart:o=5,allItemsLimit:s=5})=>{const l=o-1,u=s-1,c=Math.max(0,Math.min(l,u)),d=F.some((t=>0===e.indexOf(t)));return e&&d&&!Object(f.c)(e)&&t?r.a.createElement(n.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(i.isNil)(a)&&a<c&&r.a.createElement(C.a,{"data-test-subj":"externalLinkComma"}))):null}));A.displayName="ExternalLink";const P=({Component:e,children:t,ip:a,flowTarget:n=p.a.source,isButton:s,onClick:l,title:u})=>{const c=k(),g=Object(o.useCallback)(((a,o)=>{const{onClick:i,href:p}=c({deepLinkId:E.a.network,path:Object(m.f)(encodeURIComponent(Object(d.c)(a)),n)}),g=null!=l?l:e=>i(e);return s?r.a.createElement(C.b,{Component:e,key:`${a}-${o}`,dataTestSubj:"data-grid-network-details",onClick:g,href:p,title:null!=u?u:a},t):r.a.createElement(C.c,{key:`${a}-${o}`,onClick:g,href:p,"data-test-subj":"network-details"},t||a)}),[t,e,n,c,l,s,u]);return Object(i.isArray)(a)?r.a.createElement(r.a.Fragment,null,a.map(g)):g(a,0)},D=r.a.memo(P),L=({index:e,children:t,detailName:a,title:n})=>{const{formatUrl:i,search:d}=Object(m.l)(E.a.case),{navigateToApp:p}=Object(g.i)().services.application,{activeStep:f,isTourShown:b}=Object(u.b)(),h=Object(o.useMemo)((()=>f===l.a.viewCase&&b(l.b.alertsCases)&&0===e),[f,e,b]),v=Object(o.useCallback)((async e=>(e&&e.preventDefault(),p(c.l,{deepLinkId:E.a.case,path:Object(m.a)({id:a,search:d})}))),[a,p,d]);return Object(o.useEffect)((()=>{var e;h&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[h]),r.a.createElement(s.a,{onClick:v,isTourAnchor:h,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(C.c,{onClick:v,href:i(Object(m.a)({id:a})),"data-test-subj":"case-details-link","aria-label":y(null!=n?n:a)},t||a))},z=r.a.memo(L);z.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:a}=Object(m.l)(E.a.case),{navigateToApp:n}=Object(g.i)().services.application,i=Object(o.useCallback)((async e=>(e.preventDefault(),n(c.l,{deepLinkId:E.a.case,path:Object(m.b)(a)}))),[n,a]);return r.a.createElement(C.c,{onClick:i,href:t(Object(m.b)())},e)})).displayName="CreateCaseLink";const B=r.a.memo((({children:e,link:t})=>{const a=Object(o.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(A,{url:a},e||t)}));B.displayName="GoogleLink";const H=r.a.memo((({Component:e,title:t,children:a,portOrServiceName:i})=>{var s;const l=Object(o.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(i))}`),[i]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(s=null!=t?t:a)&&void 0!==s?s:i):r.a.createElement(C.e,null,r.a.createElement(n.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},a||i))}));H.displayName="PortOrServiceNameLink";const $=r.a.memo((({children:e,ja3Fingerprint:t})=>{const a=Object(o.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(n.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:a,target:"_blank"},e||t)}));$.displayName="Ja3FingerprintLink";const R=r.a.memo((({children:e,certificateFingerprint:t})=>{const a=Object(o.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(n.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:a,target:"_blank"},e||t)}));var U;function _(e){return e===U["virustotal.com"]||e===U["talosIntelligence.com"]}R.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}(U||(U={}));const V={[U["virustotal.com"]]:h.m,[U["talosIntelligence.com"]]:h.l},G=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:a=!1,domain:s,direction:l="row"})=>{const[u]=Object(g.o)(c.Gb),d=Object(o.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(i.isNil)(e)&&!Object(i.isNil)(t)&&!Object(f.c)(e))).map((({name:e,url_template:t})=>({name:_(e)?V[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(s))})))),[u,s,V,t]),m=Object(o.useCallback)((a=>{var n;return(e=>void 0!==e.url_template&&void 0!==e.name)(a)&&r.a.createElement(A,{url:a.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(n=a.name)&&void 0!==n?n:s))}),[t,s,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(n.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:n},o)=>r.a.createElement(A,{allItemsLimit:d.length,idx:o,overflowIndexStart:e,url:n,"data-test-subj":"externalLinkComponent",key:`reputationLink-${o}`},r.a.createElement(r.a.Fragment,null,a?s:null!=t?t:s))))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(C.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};G.displayName="ReputationLinkComponent";const W=r.a.memo(G),q=r.a.memo((({children:e,domain:t})=>{const a=Object(o.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(A,{url:a},e||t)}));q.displayName="WhoIsLink";const K=w(C.d),X=w(C.c)},155:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(78),o=a.n(n),r=a(2),i=a.n(r),s=a(47),l=a(110),u=a(126),c=a(715),d=a(586);const m=i.a.memo((({value:e,dateFormat:t=Object(l.g)()})=>i.a.createElement(i.a.Fragment,null,o.a.tz(e,Object(l.l)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(u.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(u.f)(e);const a=t.toDate();return i.a.createElement(m,{value:a})};p.displayName="PreferenceFormattedDateFromPrimitive";const g=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,f=i.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),a=Array.isArray(t)?t.find(g):null,n=Array.isArray(a)&&2===a.length?a[1]:"YYYY-MM-DD";return i.a.createElement(m,{dateFormat:n,value:e})}));f.displayName="PreferenceFormattedP1DTDate";const b=i.a.memo((({value:e,fieldName:t,className:a="",dateFormat:n})=>{if(null==e)return Object(u.f)(e);const o=Object(d.a)(e);return o.isValid()?i.a.createElement(c.a,{date:o.toDate(),fieldName:t,className:a},i.a.createElement(m,{value:o.toDate(),dateFormat:n})):Object(u.f)(e)}));b.displayName="FormattedDate";const h=i.a.memo((({value:e,dateFormat:t,tooltipFieldName:a,tooltipAnchorClassName:n,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(u.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(u.f)(e);const p=l.toDate(),g=o()(p).add(r,"hours").isBefore(new Date);return i.a.createElement(c.a,{date:p,fieldName:a,className:n},g?i.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):i.a.createElement(s.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));h.displayName="FormattedRelativePreferenceDate"},157:function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"d",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"c",(function(){return h}));var n=a(2),o=a(45),r=a(48),i=a(235),s=a.n(i),l=a(60),u=a(203),c=a(112),d=a(610),m=a(202),p=a(20);const g=(e,t)=>{const a=Object(r.useDispatch)(),o=Object(u.f)(e);Object(n.useEffect)((()=>{const n=o();return a(d.a.registerUrlParam({key:e,initialValue:n})),t(n),()=>{a(d.a.deregisterUrlParam({key:e}))}}),[])},f=e=>{const t=Object(r.useDispatch)();return Object(n.useCallback)((a=>{t(d.a.updateUrlParam({key:e,value:a}))}),[t,e])},b=()=>{const e=Object(c.b)(d.c.selectGlobalUrlParam);return Object(n.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((a=>{const n=e[a];if(n&&("object"!=typeof n||!Object(o.isEmpty)(n)))try{t[a]=Object(l.encode)(n)}catch{}})),Object(u.b)(Object(o.pickBy)((e=>!Object(o.isEmpty)(e)),t))):""}),[e])},h=()=>{const[{pageName:e}]=Object(m.a)(),t=Object(c.b)(d.c.selectGlobalUrlParam),a=s()(t),r=Object(u.g)();Object(n.useEffect)((()=>{var n;const i=null!==(n=Object(p.b)(e))&&void 0!==n?n:{skipUrlState:!0},s={...t};i.skipUrlState&&Object.keys(s).forEach((e=>{s[e]=null})),Object(o.difference)(Object.keys(null!=a?a:{}),Object.keys(t)).forEach((e=>{s[e]=null})),Object.keys(s).length>0&&r(s)}),[a,t,e,r])}},164:function(e,t,a){"use strict";a.d(t,"c",(function(){return l.a})),a.d(t,"h",(function(){return l.d})),a.d(t,"d",(function(){return u.a})),a.d(t,"i",(function(){return u.b})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return m.b})),a.d(t,"f",(function(){return m.a})),a.d(t,"j",(function(){return p})),a.d(t,"k",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"l",(function(){return h})),a.d(t,"m",(function(){return y}));var n=a(45),o=a(2),r=a(462),i=a(486),s=a(352),l=a(237),u=a(229),c=(a(4),a(185));const d=(e,t)=>`/${e}${Object(c.a)(t)}`;var m=a(346);const p=(e,t)=>`/${e}${Object(c.a)(t)}`,g=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(n.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,f=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(c.a)(null!=t?t:void 0)}`,b=e=>`/create${Object(c.a)(null!=e?e:void 0)}`,h=e=>{const{getAppUrl:t}=Object(s.a)(),a=Object(i.b)(e);return{formatUrl:Object(o.useCallback)(((o,{absolute:r=!1,skipSearch:i=!1}={})=>{const s=function(e,t,a){const[o,r]=e.split("?");return`${o}${a?Object(n.isEmpty)(r)?"":`?${r}`:Object(n.isEmpty)(r)?t:`?${r}${Object(n.isEmpty)(t)?"":`&${t}`}`}`}(o,a,i);return t({deepLinkId:e,path:s,absolute:r})}),[t,e,a]),search:a}},y=()=>{const e=Object(r.c)(),t=Object(i.a)();return Object(o.useCallback)((({deepLinkId:a,path:n="",absolute:o=!1,skipSearch:r=!1})=>{const i=r?"":t(a);return e({id:a,path:n,urlState:i,absolute:o})}),[e,t])}},199:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),o=a.n(n),r=a(17),i=a(44);const s=a.n(i)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-s548fn-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),l=Object(n.memo)((({children:e,inline:t=!1,textColor:a="default",bold:n=!1})=>o.a.createElement(s,{size:"relative",color:a,className:t?"eui-displayInline":""},n?o.a.createElement("strong",null,e):e)));l.displayName="ConsoleCodeBlock"},202:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),o=a(698);const r=()=>Object(n.useContext)(o.a)},203:function(e,t,a){"use strict";a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"f",(function(){return m})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return g})),a.d(t,"a",(function(){return f}));var n=a(60),o=a(310),r=a(15),i=a(49),s=a(2),l=a(129);const u=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,c=e=>e.substring(1),d=(e,t)=>{const a=Object(o.parse)(e,{sort:!1})[t];return Array.isArray(a)?a[0]:a},m=e=>Object(s.useCallback)((()=>{const t=d(c(window.location.search),e);return Object(n.safeDecode)(null!=t?t:"")}),[e]),p=e=>Object(o.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),g=()=>{const e=Object(i.useHistory)();return Object(s.useCallback)((t=>{const a=window.location.search,r=Object(o.parse)(a,{sort:!1});Object.keys(t).forEach((e=>{const a=t[e];if(null!=a&&""!==a)try{r[e]=Object(n.encode)(a)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const i=p(r);c(a)!==i&&e.replace({search:i})}),[e])},f=()=>{window.history.pushState({},"",window.location.href)}},226:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(45);const o=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],i=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function s(e){return Object(n.isNumber)(e)||!Object(n.isEmpty)(e)}},229:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a(4);var n=a(185);const o=(e,t)=>`/${e}${Object(n.a)(t)}`,r=(e,t)=>`/name/${e}${Object(n.a)(t)}`,i=(e,t,a)=>`/name/${e}/${t}${Object(n.a)(a)}`},235:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e){var t=n.useRef();return n.useEffect((function(){t.current=e})),t.current}},237:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(185);const o=e=>`${Object(n.a)(e)}`,r=e=>`${Object(n.a)(e)}`,i=(e,t)=>`/id/${e}${Object(n.a)(t)}`,s=(e,t,a)=>`/id/${e}/${t}${Object(n.a)(a)}`,l=(e,t)=>`/id/${e}/edit${Object(n.a)(t)}`},260:function(e,t,a){"use strict";a.d(t,"a",(function(){return z})),a.d(t,"b",(function(){return B})),a.d(t,"c",(function(){return H})),a.d(t,"d",(function(){return $}));var n=a(23),o=a.n(n),r=a(2),i=a.n(r),s=a(5),l=a(17),u=a(47),c=a(44),d=a.n(c),m=a(59),p=a.n(m),g=a(115);const f=d()(l.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-n74boe-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),b=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:a,actions:n,headerHasBottomBorder:o,restrictWidth:s,paddingSize:u="l",scrollableBody:c=!1,headerBackComponent:d,children:m,"data-test-subj":b})=>{const h=!(e||t||n||d),y=Object(g.a)(b),E=Object(r.useMemo)((()=>Array.isArray(n)?n:n?[n]:void 0),[n]),v=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),C=Object(r.useMemo)((()=>p()({"is-scrollable":c,"is-not-scrollable":!c,"full-height":!0})),[c]),O=Object(r.useMemo)((()=>h?null:i.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},d&&i.a.createElement(l.EuiFlexItem,{grow:!1},d),i.a.createElement(l.EuiSpacer,{size:"m"}),i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":y("titleHolder")},e))))),[y,d,h,e]);return i.a.createElement(f,{hasShadow:!1,paddingSize:u,"data-test-subj":b,className:"full-height",color:"transparent"},i.a.createElement(l.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":y("root")},!h&&i.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":y("headerContainer")},i.a.createElement(l.EuiPageHeader,{pageTitle:O,description:t,bottomBorder:o,rightSideItems:E,rightSideGroupProps:v,restrictWidth:s,alignItems:"bottom","data-test-subj":y("header")}),i.a.createElement(l.EuiSpacer,{size:"l"})),i.a.createElement(l.EuiFlexItem,{grow:!1},a),i.a.createElement(l.EuiFlexItem,{grow:!0,className:C,"data-test-subj":y("consoleBody")},i.a.createElement("div",{role:"main",className:"full-height"},m))))}));b.displayName="PageLayout";var h=a(49),y=a(152),E=a(189),v=a(214);const C=d.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-vostrz-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:var(--euiFixedHeadersOffset,0);bottom:0;right:0;height:calc(100% - var(--euiFixedHeadersOffset,0));width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiZFlyout),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),O="securitySolution-pageOverlay",j=`${O}-isVisible`,S=`${O}-lock`,x=`${O}-fullScreen`,k=`${O}-overSecuritySolutionPageWrapper`,w=Object(c.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}"],S,x,v.e),T=()=>{document.body.classList.remove(j)},I=()=>{document.body.classList.remove(S)},M=()=>{document.body.classList.remove(x)},N=()=>{document.body.classList.remove(k)},F=Object(r.memo)((({children:e,onHide:t,isHidden:a=!1,enableScrolling:n=!0,hideOnUrlPathnameChange:o=!0,lockDocumentBody:s=!0,appendAsBodyLastNode:u=!0,paddingSize:c,zIndex:d,"data-test-subj":m})=>{const{pathname:g}=Object(h.useLocation)(),f=Object(y.b)(),b=Object(E.b)(),[v,F]=Object(r.useState)(null),A=Object(r.useRef)(),P=Object(r.useCallback)((e=>{A.current=e}),[]),D=Object(r.useMemo)((()=>{const e={};return d&&(e.zIndex=d),e}),[d]),L=Object(r.useMemo)((()=>p()({[O]:!0,scrolling:n,hidden:a,fullScreen:b,"eui-scrollBar":n,"padding-xs":"xs"===c,"padding-s":"s"===c,"padding-m":"m"===c,"padding-l":"l"===c,"padding-xl":"xl"===c})),[n,a,c,b]);return Object(r.useEffect)((()=>{f()&&F((e=>a?null:e||(u&&A.current&&document.body.appendChild(A.current),g)))}),[u,a,f,g]),Object(r.useEffect)((()=>{f()&&o&&!a&&v&&v!==g&&t()}),[o,a,f,t,v,g]),Object(r.useEffect)((()=>{if(f()){const e=Boolean(document.querySelector(".securitySolutionWrapper"));a?(T(),I(),M(),N()):(document.body.classList.add(j),s&&document.body.classList.add(S),b&&document.body.classList.add(x),e&&document.body.classList.add(k))}return()=>{I(),T(),M(),N()}}),[a,f,s,b]),i.a.createElement(l.EuiPortal,{portalRef:P},i.a.createElement(C,{"data-test-subj":m,className:L,style:D},i.a.createElement(l.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),i.a.createElement(w,null))}));F.displayName="PageOverlay";const A=s.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),P=Object(r.memo)((({console:e,onHide:t,isHidden:a,body:n,actions:o,pageTitle:s="",showCloseButton:c=!1})=>{const d=Object(g.a)("consolePageOverlay"),m=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),p=Object(r.useMemo)((()=>a?{}:{pageTitle:s,pageBody:n,headerHasBottomBorder:!1,"data-test-subj":d("layout"),headerBackComponent:i.a.createElement(l.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:m,"data-test-subj":d("header-back-link")},A),actions:c?[i.a.createElement(l.EuiButton,{fill:!0,onClick:m,minWidth:"auto","data-test-subj":d("doneButton")},i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=o?o:[]]:[...null!=o?o:[]]}),[o,n,d,m,a,s,c]);return i.a.createElement(F,{isHidden:a,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},i.a.createElement(b,p,e))}));P.displayName="ConsolePageOverlay";var D=a(685);const L=i.a.createContext(void 0),z=Object(r.memo)((({storage:e={},children:t})=>{const[a,n]=Object(r.useState)(e),[s]=Object(r.useState)(new Map),l=Object(r.useRef)();l.current=a;const u=Object(r.useCallback)((e=>{var t;if(null===(t=l.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return Object.entries(a).forEach((([e,t])=>{t.isOpen&&(a[e]={...t,isOpen:!1})})),a[e]={...a[e],isOpen:!0},a}))}),[u]),d=Object(r.useCallback)((e=>{u(e),n((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[u]),m=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return delete a[e],a}))}),[u]),p=Object(r.useCallback)((e=>{var t;if(null!==(t=l.current)&&void 0!==t&&t[e])return l.current[e].client}),[]),g=Object(r.useCallback)((()=>Object.values(a).map((e=>e.client))),[a]),f=Object(r.useCallback)((e=>{var t;return!(null===(t=l.current)||void 0===t||!t[e])&&l.current[e].isOpen}),[]),b=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...s})=>{if(a[e])throw new Error(`Console with id ${e} already registered`);const l=Symbol(e),u=c.bind(null,e),p=d.bind(null,e),g=m.bind(null,e),b=f.bind(null,e),h={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...s,client:{id:e,meta:t,show:()=>{setTimeout(u,0)},hide:()=>{setTimeout(p,0)},terminate:()=>{setTimeout(g,0)},isVisible:()=>b()},consoleProps:r,console:i.a.createElement(D.a,o()({},r,{managedKey:l,key:e})),isOpen:!1,key:l};return n((t=>({...t,[e]:h}))),h.client}),[a,d,f,c,m]),h=Object(r.useMemo)((()=>({register:b,show:c,hide:d,terminate:m,getOne:p,getList:g})),[g,p,d,b,c,m]),y=Object(r.useMemo)((()=>({client:h,internal:{getManagedConsole:e=>Object.values(a).find((t=>t.key===e)),getManagedConsoleState:e=>s.get(e),storeManagedConsoleState(e,t){s.set(e,t)}}})),[h,s,a]),E=Object(r.useMemo)((()=>Object.values(a).find((e=>e.isOpen))),[a]),v=Object(r.useMemo)((()=>{var e;return null!==(e=null==E?void 0:E.client.meta)&&void 0!==e?e:{}}),[null==E?void 0:E.client.meta]),C=Object(r.useCallback)((()=>{E&&h.hide(E.client.id)}),[h,E]);return i.a.createElement(L.Provider,{value:y},t,E&&i.a.createElement(P,{onHide:C,console:i.a.createElement(D.a,o()({},E.consoleProps,{managedKey:E.key,key:E.client.id})),isHidden:!E,pageTitle:E.PageTitleComponent&&i.a.createElement(E.PageTitleComponent,{meta:v}),body:E.PageBodyComponent&&i.a.createElement(E.PageBodyComponent,{meta:v}),actions:E.ActionComponents&&E.ActionComponents.map((e=>i.a.createElement(e,{meta:v}))),showCloseButton:E.showCloseButton}))}));z.displayName="ConsoleManager";const B=()=>{const e=Object(r.useContext)(L);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},H=e=>{const t=Object(r.useContext)(L);if(e&&t)return t.internal.getManagedConsole(e)},$=e=>{const t=Object(r.useContext)(L);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),a=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,a)}]:[void 0,void 0]),[t,e])}},266:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return c}));var n=a(5);let o,r;!function(e){e.rules="rules",e.alertsCases="alertsCases"}(o||(o={})),function(e){e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase"}(r||(r={}));const i={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},s=(e,t)=>`tourStepAnchor-${t}-${e}`,l=[{...i,step:r.pointToAlertName,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:s(r.pointToAlertName,o.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...i,step:r.expandEvent,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:s(r.expandEvent,o.alertsCases)},{...i,step:r.reviewAlertDetailsFlyout,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${s(r.reviewAlertDetailsFlyout,o.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:s(r.reviewAlertDetailsFlyout,o.alertsCases)},{...i,step:r.addAlertToCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:s(r.addAlertToCase,o.alertsCases)},{...i,step:r.createCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:s(r.createCase,o.alertsCases),offset:20,repositionOnScroll:!1},{...i,step:r.submitCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:s(r.submitCase,o.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...i,step:r.viewCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:s(r.viewCase,o.alertsCases)}],u={title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},c={[o.rules]:[],[o.alertsCases]:l}},284:function(e,t,a){"use strict";a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(2),o=a.n(n),r=a(17),i=a(44),s=a.n(i),l=a(47),u=a(126);const c=({children:e,...t})=>o.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>o.a.createElement(r.EuiLink,t,e),m=s()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:a,href:n,onClick:r,title:i,iconType:s="expand"})=>t?o.a.createElement(t,{"data-test-subj":a,href:n,iconType:s,onClick:r,title:i},null!=i?i:e):o.a.createElement(c,{"data-test-subj":a,href:n,onClick:r},null!=i?i:e),g=o.a.memo(p),f=s.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),b=o.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:a,rowItems:i})=>{const[s,u]=Object(n.useState)(!1),c=Object(n.useCallback)((()=>u((e=>!e))),[]),d=Object(n.useMemo)((()=>o.a.createElement(o.a.Fragment,null," ,",o.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:c},`+${i.length-t} `,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[c,t,i.length]);return o.a.createElement(r.EuiFlexItem,{grow:!1},i.length>t&&o.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:s,closePopover:c,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},o.a.createElement(h,{render:a,rowItems:i,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const h=o.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:a,rowItems:i})=>{const s=Object(n.useMemo)((()=>i.slice(t).map(((e,t)=>{var n;return o.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(n=a&&a(e))&&void 0!==n?n:Object(u.a)(e))}))),[t,a,i]);return o.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},o.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},s))}));h.displayName="MoreReputationLinksContainer"},305:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(2),o=a.n(n),r=a(11),i=a.n(r),s=a(3),l=a(49),u=a(692),c=a(127),d=a(110),m=a(266);const p={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{}},g=Object(n.createContext)(p),f=({children:e})=>{var t,a,r,l;const{guidedOnboarding:c}=Object(d.i)().services,p=i()(null!==(t=null==c||null===(a=c.guidedOnboardingApi)||void 0===a?void 0:a.isGuideStepActive$(u.a,m.b.rules).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==t?t:Object(s.of)(!1),!1),f=i()(null!==(r=null==c||null===(l=c.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(u.a,m.b.alertsCases).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==r?r:Object(s.of)(!1),!1),b=Object(n.useMemo)((()=>({[m.b.rules]:p,[m.b.alertsCases]:f})),[p,f]),h=Object(n.useCallback)((e=>b[e]),[b]),[y,E]=Object(n.useState)(1),v=Object(n.useCallback)((e=>{E((t=>(t>=m.e[e].length?0:t)+1))}),[]),C=Object(n.useCallback)(((e,t)=>{t<=m.e[e].length&&E(t)}),[]),[O,j]=Object(n.useState)(null);Object(n.useEffect)((()=>{if(!O||null==c||!c.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==c||null===(t=c.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(u.a,O)),e||(j(null),E(1))})(),()=>{e=!0}}),[O,c]);const S=Object(n.useCallback)((e=>{j(e)}),[]),x=Object(n.useMemo)((()=>({activeStep:y,endTourStep:S,incrementStep:v,isTourShown:h,setStep:C})),[y,S,v,h,C]);return o.a.createElement(g.Provider,{value:x},e)},b=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),a=Object(n.useMemo)((()=>Object(c.isTourPath)(t)?f:g.Provider),[t]);return o.a.createElement(a,{value:p},e)},h=()=>{const e=Object(n.useContext)(g);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},338:function(e,t,a){"use strict";let n,o,r;a.r(t),a.d(t,"NetworkType",(function(){return n})),a.d(t,"NetworkTableType",(function(){return o})),a.d(t,"NetworkDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(o||(o={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(r||(r={}))},346:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(245),o=a(558),r=a(185);const i=e=>`${Object(r.a)(e)}`,s=(e,t,a,i=o.a.flows)=>`/ip/${e}/${t||n.a.source}/${i}${Object(r.a)(a)}`},397:function(e,t,a){"use strict";a.d(t,"i",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"j",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return c})),a.d(t,"o",(function(){return d})),a.d(t,"n",(function(){return m})),a.d(t,"k",(function(){return p})),a.d(t,"m",(function(){return g})),a.d(t,"l",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h})),a.d(t,"g",(function(){return y}));var n=a(5);const o=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),i=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),s=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),u=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),c=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),g=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),f=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),h=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),y=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},462:function(e,t,a){"use strict";var n=a(25);a.d(t,"c",(function(){return n.e})),a.d(t,"b",(function(){return n.d})),a.d(t,"d",(function(){return n.f})),a.d(t,"a",(function(){return n.a}))},470:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(23),o=a.n(n),r=a(2),i=a.n(r),s=a(17),l=a(47),u=a(44),c=a.n(u),d=a(112),m=a(151),p=a(134),g=a(118),f=a(305),b=a(266);const h=(e,t)=>(t===b.a.createCase||t===b.a.submitCase)&&e===b.b.alertsCases,y=c()(s.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>h(t,e)?"9000 !important":"1000 !important")),E=({children:e,onClick:t,step:a,tourId:n})=>{const{activeStep:u,incrementStep:c,isTourShown:E}=Object(f.b)(),v=Object(r.useMemo)((()=>b.e[n].find((e=>e.step===a))),[a,n]),C=Object(r.useMemo)((()=>g.b.getTimelineByIdSelector()),[]),O=Object(d.b)((e=>{var t;return(null!==(t=C(e,m.f.active))&&void 0!==t?t:p.b).show})),j=Object(r.useCallback)((()=>t?t():c(n)),[c,t,n]),S=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),x=h(n,a);if(null==v||(a!==u||!E(n))&&!x||O)return e||null;const{anchor:k,content:w,imageConfig:T,dataTestSubj:I,hideNextButton:M=!1,...N}=v,F=M?i.a.createElement(i.a.Fragment,null):i.a.createElement(s.EuiButtonEmpty,{onClick:j,onKeyDown:S,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),A={...N,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"s"},i.a.createElement("p",null,w)),T&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiImage,{alt:T.altText,src:T.src,size:"fullWidth"}))),footerAction:F,isStepOpen:!0,onFinish:()=>null,stepsTotal:b.e[n].length,panelProps:{"data-test-subj":I}};return null!=k?i.a.createElement(i.a.Fragment,null,i.a.createElement(y,o()({tourId:n},A,{anchor:k})),i.a.createElement(i.a.Fragment,null,e)):null!=e?i.a.createElement(y,o()({tourId:n},A),e):null},v=({children:e,isTourAnchor:t=!0,...a})=>t?i.a.createElement(E,a,e):i.a.createElement(i.a.Fragment,null,e)},486:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(2),o=a(157),r=a(20);const i=e=>{const t=s();return Object(n.useMemo)((()=>t(e)),[t,e])},s=()=>{const e=Object(o.a)();return Object(n.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},526:function(e,t,a){"use strict";var n=a(305);a.d(t,"b",(function(){return n.b})),a.d(t,"a",(function(){return n.a}))},527:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(185);const o=(e,t)=>`/name/${e}${Object(n.a)(t)}`,r=(e,t,a)=>`/name/${e}/${t}${Object(n.a)(a)}`,i=(e,t)=>`/${e}${Object(n.a)(t)}`},558:function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),a(338).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(n||(n={}))},563:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(45);const o=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),i=e=>Object(n.isUndefined)(e)?void 0:Object(n.castArray)(e)},685:function(e,t,a){"use strict";a.d(t,"a",(function(){return gt}));var n=a(2),o=a.n(n),r=a(17),i=a(44),s=a.n(i),l=a(110);const u="commandInputHistory";var c=a(260),d=a(0),m=a.n(d);class parsed_command_input_ParsedCommand{constructor(e){m()(this,"name",void 0),m()(this,"args",void 0),m()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),a={name:g(t),args:{}};if(!t)return a;const n=t.indexOf(" "),o=-1===n?[]:t.substring(n).trim().split(/--/);for(const e of o){const t=e.trim();if(t){const e=/[ =]/.exec(t),n=(e?t.substring(0,e.index).trim():t).trim();if(n)if(a.args[n]||(a.args[n]=[]),n!==t&&e){let o=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===o.charAt(0)&&(o=o.substring(1)),'"'===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),a.args[n].push(o)}else a.args[n].push(!0)}}return a})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const p=e=>new parsed_command_input_ParsedCommand(e),g=e=>{const t=e.trimStart();if(!t)return"";const a=e.indexOf(" ");return-1===a?t:t.substring(0,a)},f=e=>{let t="",a="";const n=[];if(e.args)for(const[o,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${o}`):r.exclusiveOr?n.push(`--${o}`):(a.length&&(a+=" "),a+=`--${o}`);const o=({required:e,exclusive:t,optional:a})=>`${e||""}${t?` ${t}`:""} ${a&&a.length>0?`[${a}]`:""}`.trim();return n.length>0?n.map((e=>o({required:t,exclusive:e,optional:a}))):t||a?[o({required:t,optional:a})]:[]};var b=a(5),h=a(51);const y=b.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),E=(e,t)=>{if(t&&t.argsWithValueSelectors)for(const n of Object.keys(t.argsWithValueSelectors))if(e.hasArg(n)){var a;const o=null!==(a=t.argState[n])&&void 0!==a?a:[];e.args[n]=o.map((e=>e.value))}},v=(e,{type:t,payload:a})=>{var n;switch(t){case"updateInputPopoverState":if(e.input.showPopover!==a.show)return{...e,input:{...e.input,showPopover:a.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(h.v4)(),input:a.command,display:null!==(n=a.display)&&void 0!==n?n:a.command},...e.input.history.slice(0,99)]}};case"clearInputHistoryState":return{...e,input:{...e.input,history:[]}};case"updateInputTextEnteredState":const{leftOfCursorText:t,rightOfCursorText:s="",argState:l}="function"==typeof a?a(e.input):a;if(e.input.leftOfCursorText!==t||e.input.rightOfCursorText!==s){var o;const a=p(t+s);let n=e.input.enteredCommand;if(n&&l&&(null===(o=n)||void 0===o?void 0:o.argState)!==l&&(n={...n,argState:l}),a.name&&(!n||a.name!==n.commandDefinition.name)||!a.name&&n){n=void 0;const t=e.commands.find((e=>e.name===a.name));if(t){let e;for(const[a,n]of Object.entries(null!==(r=t.args)&&void 0!==r?r:{})){var r;n.SelectorComponent&&(e||(e={}),e[a]=n)}n={argState:{},commandDefinition:t,argsWithValueSelectors:e}}}return E(a,n),{...e,input:{...e.input,leftOfCursorText:t,rightOfCursorText:s,parsedInput:a,enteredCommand:n}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==a.placeholder)return{...e,input:{...e.input,placeholder:a.placeholder||y}};break;case"setInputState":if(e.input.visibleState!==a.value)return{...e,input:{...e.input,visibleState:a.value}};break;case"updateInputCommandArgState":if(e.input.enteredCommand){var i;const{name:t,instance:n,state:o}=a,r=[...null!==(i=e.input.enteredCommand.argState[t])&&void 0!==i?i:[]];r[n]=o;const s={...e.input.enteredCommand,argState:{...e.input.enteredCommand.argState,[t]:r}},l=p(e.input.leftOfCursorText+e.input.rightOfCursorText);return E(l,s),{...e,input:{...e.input,parsedInput:l,enteredCommand:s}}}}return e};var C=a(47),O=a(199);const j=Object.freeze({mustHaveValue:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveValue",{defaultMessage:"Argument --{argName} must have a value",values:{argName:e}}),mustBeNumber:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeNumber",{defaultMessage:"Argument --${argName} value must be a number",values:{argName:e}}),mustBeGreaterThanZero:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeGreaterThanZero",{defaultMessage:"Argument --{argName} value must be greater than zero",values:{argName:e}}),NO_ARGUMENTS_SUPPORTED:b.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"}),missingRequiredArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: --{argName}",values:{argName:e}}),unsupportedArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: --{argName}",values:{argName:e}}),noMultiplesAllowed:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: --{argName}",values:{argName:e}}),argValueValidatorError:(e,t)=>b.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: --{argName}. {error}",values:{argName:e,error:t}}),missingArguments:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {missingArgs}",values:{missingArgs:e}}),MUST_HAVE_AT_LEAST_ONE_ARG:b.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}),onlyOneFromExclusiveOr:e=>o.a.createElement(O.a,null,o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:o.a.createElement(O.a,{bold:!0,inline:!0},e)}})),unknownArgument:(e,t,a)=>o.a.createElement(O.a,null,o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:e,command:o.a.createElement(O.a,{bold:!0,inline:!0},t),unknownArgs:o.a.createElement(O.a,{bold:!0,inline:!0},a)}}))});var S=a(115);const x=(e="")=>{const t=se().state.dataTestSubj;return t?t+(e?`-${e}`:""):""},k=b.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),w=Object(n.memo)((({children:e,header:t=k,"data-test-subj":a})=>o.a.createElement("div",{"data-test-subj":a},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(r.EuiTextColor,{color:"danger"},t)),o.a.createElement(r.EuiSpacer,{size:"s"}),e)));w.displayName="UnsupportedMessageCallout";const T={className:"euiTruncateText"},I=Object(n.memo)((({commandDef:e})=>{const t=Object(n.useMemo)((()=>f(e).map(((t,a)=>o.a.createElement(o.a.Fragment,{key:`helpUsage-${a}`},a>0&&o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(O.a,null,`${e.name} ${t}`))))),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:T,titleProps:T}),o.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:o.a.createElement(O.a,null,e.exampleUsage)}],descriptionProps:T,titleProps:T}))}));I.displayName="CommandInputUsage";const M=Object(n.memo)((({commandDef:e,errorMessage:t})=>{const a=Object(S.a)(x()),i=Object(n.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),s=Object(n.useMemo)((()=>i&&e.args?Object.entries(e.args).reduce(((e,t)=>{const a={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(a):t[1].exclusiveOr?e.exclusiveOr.push(a):e.optional.push(a),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,i]),l=(t,n)=>{const i=n.map((e=>o.a.createElement("div",null,o.a.createElement(O.a,{bold:!0,inline:!0},e.title),o.a.createElement(O.a,{inline:!0}," - ",e.description))));return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,t),description:i}],descriptionProps:T,titleProps:T,"data-test-subj":a("commandUsage-options")}))},u=Object(n.useCallback)((()=>t?o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":a("validationError")},o.a.createElement("div",{"data-test-subj":a("badArgument-message")},t),o.a.createElement(r.EuiSpacer,{size:"s"})):null),[t,a]);return o.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":a("commandUsage")},u(),o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:o.a.createElement(O.a,null,e.about)}],descriptionProps:T,titleProps:T,"data-test-subj":a("commandUsage-options")}),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(I,{commandDef:e}),s.required&&s.required.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),s.required),s.exclusiveOr&&s.exclusiveOr.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),s.exclusiveOr),s.optional&&s.optional.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),s.optional))}));M.displayName="CommandUsage";const N=Object(n.memo)((({title:e,children:t})=>{const a=Object(S.a)(x());return o.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":a("helpOutput")},t)}));N.displayName="HelpOutput";const F=Object(n.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(n.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?o.a.createElement(t,e):o.a.createElement(N,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},o.a.createElement(M,{commandDef:e.command.commandDefinition,errorMessage:e.store.errorMessage}))}));F.displayName="HelpCommandArgument";const A=Object(n.memo)((({command:e,setStatus:t})=>{const a=Object(S.a)(x()),i=Object(n.useMemo)((()=>o.a.createElement(O.a,null,o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:o.a.createElement(O.a,{bold:!0,inline:!0},e.input),helpIcon:o.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},"help"),boldHelp:o.a.createElement("strong",null,o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":a("unknownCommandError")},i)}));A.displayName="UnknownCommand";const P=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const i=Object(S.a)(x());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":i("badArgument")},o.a.createElement("div",{"data-test-subj":i("badArgument-message")},a.errorMessage),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(I,{commandDef:e.commandDefinition}),o.a.createElement(O.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));P.displayName="BadArgument";const D=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const i=Object(S.a)(x());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"error"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":i("validationError")},o.a.createElement("div",{"data-test-subj":i("validationError-message")},a.errorMessage),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(I,{commandDef:e.commandDefinition}),o.a.createElement(O.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));D.displayName="ValidationError";const L=e=>`--${e}`,z=(e,t)=>{const a=v(e,{type:"updateInputHistoryState",payload:{command:t.command.input,display:t.command.inputDisplay}});return a.commandHistory=[...e.commandHistory,t],a},B={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},H=(e={})=>({status:"pending",store:e}),$=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),R=(e,t=H(),a=!0)=>({id:Object(h.v4)(),isValid:a,enteredAt:(new Date).toISOString(),command:e,state:t}),U=()=>se().dispatch,_=Object(n.memo)((({status:e,setStatus:t})=>{const a=U();return Object(n.useEffect)((()=>{"pending"===e&&a({type:"clear"}),t("success")}),[e,t,a]),null}));_.displayName="ClearCommand";var V=a(9);const G=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const a=Object.entries(e.args).reduce(((e,[a,n])=>n.required?(e[a]=n,e):n.exclusiveOr&&!t?(t=!0,e[a]=n,e):e),{});return`${e.name} --${Object.keys(a).join(" --")}`},W=b.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),q=e=>e.replace(/[^A-Za-z0-9]/g,""),K=s()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10x4uz4-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),X=s()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-10x4uz4-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),Y=s()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-10x4uz4-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),Z=s()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-10x4uz4-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),J=s()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-10x4uz4-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),Q=Object(n.memo)((({commands:e,display:t="default"})=>{const a=Object(S.a)(x("commandList")),i=U(),{docLinks:s}=Object(l.i)().services,u=Object(n.useMemo)((()=>{var e;return o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(J,null,o.a.createElement(O.a,{inline:!0,bold:!0},null===(e=ne.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),c=Object(n.useCallback)((e=>()=>{i({type:"updateInputTextEnteredState",payload:()=>({leftOfCursorText:e,rightOfCursorText:""})}),i({type:"addFocusToKeyCapture"})}),[i]),d=Object(n.useMemo)((()=>{const t=new Map,a=e.filter((e=>!0!==e.helpHidden));for(const e of a){const{helpGroupLabel:a=W,helpGroupPosition:n=1/0}=e,o=t.get(a);o?(o.list.push(e),o.position===1/0&&void 0!==n&&n!==o.position&&(o.position=n)):t.set(e.helpGroupLabel,{label:a,position:n,list:[e]})}return Object(V.sortBy)(Array.from(t.values()),"position").map((e=>{const t=e.list.map((e=>void 0===e.helpCommandPosition?{...e,helpCommandPosition:1/0}:e));return Object(V.sortBy)(t,"helpCommandPosition")}))}),[e]),m=Object(n.useCallback)((e=>e[0].helpGroupLabel===ae.supporting.label?[...ne,...e].map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:W]:t}})):e.map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:W]:t}}))),[]),p=Object(n.useCallback)((e=>{var t,n;const i=null!==(t=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==t?t:W,s=q(i);return[{field:i,name:o.a.createElement("div",{"data-test-subj":a("group")},i),render:e=>{const t=G(e);return o.a.createElement(Y,{alignItems:"center","data-test-subj":a(`${s}-${e.name}`)},o.a.createElement(r.EuiFlexItem,{grow:1},o.a.createElement(r.EuiDescriptionList,{"data-test-subj":a("command"),listItems:[{title:o.a.createElement(r.EuiBadge,{"data-test-subj":a("commandName")},t),description:o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}]})),e.helpGroupLabel!==ae.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?b.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):b.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},o.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:c(`${t} `),isDisabled:!0===e.helpDisabled,"data-test-subj":a(`${s}-${e.name}-addToInput`)}))))}}]}),[a,c]),g=Object(n.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions â€” no need to wait for previous actions to complete."}),o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:o.a.createElement(r.EuiLink,{href:s.links.securitySolution.responseActions,target:"_blank","data-test-subj":a("helpfulHintDocLink")},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=o.a.createElement(X,{title:o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"}),"data-test-subj":a("helpfulTips")},o.a.createElement("ul",null,e.map(((e,t)=>o.a.createElement("li",{key:t},o.a.createElement(r.EuiText,{size:"s"},e))))));return o.a.createElement("div",{"data-test-subj":a()},d.map(((e,t)=>{var n;return o.a.createElement(K,{"data-test-subj":a(q(null!==(n=e[0].helpGroupLabel)&&void 0!==n?n:W)),key:`styledEuiBasicTable-${t}`,items:m(e),columns:p(e)})})),t)}return o.a.createElement("div",{"data-test-subj":a()},o.a.createElement(r.EuiSpacer,{size:"s"}),d.map((e=>{const t=e[0].helpGroupLabel,n=g(e);return 0===n.length?null:o.a.createElement(Z,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},n.map((e=>{const t=G(e);return o.a.createElement(r.EuiFlexItem,{key:e.name},o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(r.EuiToolTip,{content:t},o.a.createElement(J,null,o.a.createElement(O.a,{inline:!0,bold:!0},t))),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":a("command")}))})))})),o.a.createElement(r.EuiSpacer,{size:"xl"}),u)}));Q.displayName="CommandList";const ee=()=>se().state.commands,te=Object(n.memo)((e=>{const t=ee(),a=se().state.HelpComponent;return Object(n.useEffect)((()=>{a||e.setStatus("success")}),[a,e]),a?o.a.createElement(a,e):o.a.createElement(N,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},o.a.createElement(Q,{commands:t}))}));te.displayName="HelpCommand";const ae=Object.freeze({supporting:{label:b.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),ne=Object.freeze([{name:"--comment",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),oe=(e,t)=>{var a,n,r,i;let s=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(a=e.keyCapture)||void 0===a||null===(n=a.current)||void 0===n||n.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(i=r.current)||void 0===i||i.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(s={...e,footerContent:t.payload.value});break;case"executeCommand":s=((e,t)=>{const{parsedInput:a,enteredCommand:n,input:r}=t.payload;if(""===a.name)return e;const i=null==n?void 0:n.commandDefinition;if(!i)return z(e,R({input:a.input,inputDisplay:r,args:a,commandDefinition:{...B,RenderComponent:A}},void 0,!1));const s={input:a.input,inputDisplay:r,args:a,commandDefinition:i},l=(u=i.args)?Object.entries(u).filter((([e,t])=>t.required)).map((([e])=>e)):[];var u;const c=(e=>e?Object.entries(e).reduce(((e,[t,a])=>(a.exclusiveOr&&e.push(t),e)),[]):[])(i.args),d=j.onlyOneFromExclusiveOr(c.map(L).join(", "));if(a.hasArgs){if(a.hasArg("help")){if(Object.keys(a.args).length>1||a.args.help.length>1||!0!==a.args.help[0])return z(e,R($(s,P),void 0,!1));if(null!=i&&i.validate){const t=i.validate(s);if(!0!==t)return z(e,R($(s,F),H({errorMessage:t}),!1))}return z(e,R($(s,F),void 0,!1))}if(!i.args||0===Object.keys(i.args).length)return z(e,R($(s,P),H({errorMessage:j.NO_ARGUMENTS_SUPPORTED}),!1));const t=((e,t)=>{const a=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||a.push(e)})),a})(a.args,i.args);if(t.length)return z(e,R($(s,P),H({errorMessage:j.unknownArgument(t.length,a.name,t.map(L).join(", "))}),!1));for(const t of l)if(!a.args[t])return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.missingRequiredArg(t))}),!1));if(c.filter((e=>a.args[e])).length>1)return z(e,R($(s,P),H({errorMessage:d}),!1));for(const t of Object.keys(a.args)){var m;const n=null===(m=i.args)||void 0===m?void 0:m[t],r=a.args[t];if(!n)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.unsupportedArg(t))}),!1));if(!n.allowMultiples&&Array.isArray(r)&&r.length>1)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.noMultiplesAllowed(t))}),!1));if(void 0!==n.mustHaveValue&&!1!==n.mustHaveValue){let a="";if(0===r.length?a=j.mustHaveValue(t):r.some(((e,o)=>{switch(n.mustHaveValue){case!0:case"non-empty-string":("boolean"==typeof e||"non-empty-string"===n.mustHaveValue&&0===e.trim().length)&&(a=j.mustHaveValue(t));break;case"truthy":e||(a=j.mustHaveValue(t));break;case"number":case"number-greater-than-zero":{const i=Number(e);Number.isSafeInteger(i)?"number-greater-than-zero"===n.mustHaveValue&&i<=0&&(a=j.mustBeGreaterThanZero(t)):a=j.mustBeNumber(t),a||(r[o]=i)}}return!!a})),a)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,a)}),!1))}if(n.validate){const a=n.validate(r);if(!0!==a)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.argValueValidatorError(t,a))}),!1))}}}else{if(l.length>0)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.missingArguments(l.map((e=>L(e))).join(", ")))}),!1));if(c.length>0)return z(e,R($(s,P),H({errorMessage:d}),!1));if(i.mustHaveArgs)return z(e,R($(s,P),H({errorMessage:o.a.createElement(O.a,null,j.MUST_HAVE_AT_LEAST_ONE_ARG)}),!1))}if(i.validate){const t=i.validate(s);if(!0!==t)return z(e,R($(s,D),H({errorMessage:t}),!1))}return z(e,R(s))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":s=((e,{type:t,payload:{id:a,value:n}})=>{let o=!1;const r=e.commandHistory.map((e=>{if(o||e.id!==a)return e;o=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=n(r.state.store);break;case"updateCommandStatusState":if(r.state.status===n)return o=!1,e;r.state.status=n}return r}));return o?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":s=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"clearInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":case"updateInputCommandArgState":s=v(e,t);break;case"clear":s={...e,commandHistory:[]}}return s},re=Object(n.createContext)(null),ie=Object(n.memo)((({commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:i,storagePrefix:s,managedKey:d,children:m})=>{const[g,f]=Object(c.d)(d),h=(e=>{const{storage:t}=Object(l.i)().services;return Object(n.useMemo)((()=>{if(e){var a;const n=null!==(a=t.get(`${e}.${u}`))&&void 0!==a?a:{version:2,data:[]};return 2!==n.version&&(e=>{const{data:t,version:a}=e;for(const e of t)a<2&&(e.display=e.input);e.version=2})(n),n.data}return[]}),[t,e])})(s),E=(e=>{const{storage:t}=Object(l.i)().services;return Object(n.useCallback)((a=>{if(e){const n={version:2,data:a};t.set(`${e}.${u}`,n)}}),[t,e])})(s),v=Object(n.useCallback)((e=>{const t=(({commands:e,...t},a)=>{const n=[{name:"help",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:te,helpGroupLabel:ae.supporting.label,helpCommandPosition:1},{name:"clear",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:_,helpGroupLabel:ae.supporting.label,helpCommandPosition:0}].concat(e),o=null!=a?a:{commands:n,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{leftOfCursorText:"",rightOfCursorText:"",parsedInput:p(""),enteredCommand:void 0,placeholder:y,showPopover:void 0,history:[],visibleState:void 0}};return a&&Object.assign(o,{commands:n,...t}),o})(e,g?g():void 0);return t.input.history=h,t}),[g,h]),[C,O]=Object(n.useReducer)(oe,{commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:i,storagePrefix:s},v);return Object(n.useEffect)((()=>{f&&f(C)}),[C,f]),Object(n.useEffect)((()=>{s&&C.input.history&&E(C.input.history)}),[E,C.input.history,s]),o.a.createElement(re.Provider,{value:{state:C,dispatch:O}},m)}));ie.displayName="ConsoleStateProvider";const se=()=>{const e=Object(n.useContext)(re);if(!e)throw new Error("ConsoleStateContext not defined");return e},le=()=>se().state.input.visibleState,ue=Object(n.memo)((()=>{const e=se().state.footerContent,t=Object(S.a)(x()),a=le(),i=Object(n.useMemo)((()=>"error"===a?"danger":"subdued"),[a]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},o.a.createElement(r.EuiText,{size:"xs",color:i,className:"font-style-italic"},e||o.a.createElement(o.a.Fragment,null,"Â ")))}));ue.displayName="ConsoleFooter";const ce=()=>se().state.sidePanel,de=(b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonTitle",{defaultMessage:"Help"}),b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"})),me=s()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-lvlnbi-0"})(["margin-left:auto;height:inherit;"]),pe=Object(n.memo)((({TitleComponent:e})=>{const t=U(),a=ce().show,i=Object(S.a)(x("header")),s="help"===a,l=Object(n.useCallback)((()=>{t({type:"showSidePanel",payload:{show:s?null:"help"}})}),[t,s]);return o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},o.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate noThemeOverrides","data-test-subj":i("titleComponentContainer")},e?o.a.createElement(e,null):""),!s&&o.a.createElement(r.EuiFlexItem,{grow:1},o.a.createElement(me,{style:{marginLeft:"auto"},onClick:l,iconType:"help",title:de,"aria-label":de,isSelected:s,"data-test-subj":i("helpButton")},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));pe.displayName="ConsoleHeader";var ge=a(23),fe=a.n(ge),be=a(59),he=a.n(be);const ye=()=>{const{leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:o}=se().state.input;return Object(n.useMemo)((()=>({leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:o,fullTextEntered:e+t})),[o,e,a,t])},Ee=s.a.div.withConfig({displayName:"InputDisplayContainer",componentId:"sc-cduvts-0"})(["overflow:hidden !important;.inputDisplay{& > *{flex-direction:row;align-items:center;}}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}"],(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor)),ve=Object(n.memo)((({leftOfCursor:e,rightOfCursor:t})=>{const a=Object(S.a)(x()),i=U(),{leftOfCursorText:s,fullTextEntered:l}=ye(),u=Object(n.useRef)(null),c=Object(n.useRef)(null),d=Object(n.useRef)(null),m=s.length,p=Object(n.useCallback)((e=>{const t=e.target;if(l.length&&t.classList&&t.classList.contains("chr")){const a=Array.from(e.currentTarget.querySelectorAll("span.chr")).indexOf(t),n=l.substring(0,a+1),o=l.substring(a+1);i({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n,rightOfCursorText:o}})}}),[i,l]);return Object(n.useEffect)((()=>{if(c.current){const e=e=>{if(c.current){const t=e[0];if(t&&t.rootBounds){const e=c.current.scrollLeft,a=t.rootBounds.right,n=t.rootBounds.left,o=t.boundingClientRect.right;if(o>a-20){const a=e+(o-t.rootBounds.width)+20;c.current.scrollLeft=a}else if(o<n+20){const t=o-20<0?0:e-20;c.current.scrollLeft=t}}}};return u.current=new IntersectionObserver(e,{root:c.current,rootMargin:"0px -10px",threshold:0}),()=>{var e;null===(e=u.current)||void 0===e||e.disconnect(),u.current=null}}}),[]),Object(n.useEffect)((()=>{if(u.current&&d.current){const e=u.current,t=d.current;return e.observe(t),()=>{e.unobserve(t)}}}),[m]),o.a.createElement(Ee,{ref:c},o.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",className:"inputDisplay",onClick:p},o.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":a("cmdInput-leftOfCursor"),className:"noMinWidth"},e),o.a.createElement(r.EuiFlexItem,{grow:!1,className:"noMinWidth"},o.a.createElement("span",{className:"cursor essentialAnimation",ref:d})),o.a.createElement(r.EuiFlexItem,{className:"noMinWidth","data-test-subj":a("cmdInput-rightOfCursor")},t)))}));ve.displayName="InputDisplay";const Ce=()=>se().state.input.showPopover,Oe=s.a.span.withConfig({displayName:"ArgumentSelectorWrapperContainer",componentId:"sc-jnz75k-0"})(["border:",";border-radius:",";overflow:hidden;user-select:none;.flexGroup{align-items:stretch;}.selectorContainer{padding:0 ",";max-width:25vw;display:flex;align-items:center;height:100%;}.argNameContainer{background-color:",";}.argName{padding-left:",";height:100%;display:flex;align-items:center;white-space:nowrap;}"],(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormInputGroupLabelBackground),(({theme:{eui:e}})=>e.euiSizeXS)),je=Object(n.memo)((({argName:e,argIndex:t,argDefinition:{SelectorComponent:a}})=>{const i=U(),{valueText:s,value:l,store:u}=((e,t)=>{const a=se().state.input.enteredCommand;return Object(n.useMemo)((()=>{var n;const o=null==a||null===(n=a.argState[e])||void 0===n?void 0:n.at(t);return null!=o?o:{value:void 0,valueText:""}}),[e,a,t])})(e,t),c=Object(n.useCallback)((a=>{i({type:"updateInputCommandArgState",payload:{name:e,instance:t,state:a}})}),[t,e,i]);return o.a.createElement(Oe,{className:"eui-displayInlineBlock"},o.a.createElement(r.EuiFlexGroup,{className:"flexGroup",responsive:!1,alignItems:"center",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1,className:"argNameContainer"},o.a.createElement("div",{className:"argName"},o.a.createElement("span",null,`--${e}=`))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("div",{className:"selectorContainer noThemeOverrides eui-textTruncate"},o.a.createElement(a,{value:l,valueText:null!=s?s:"",argName:e,argIndex:t,store:u,onChange:c})))))}));je.displayName="ArgumentSelectorWrapper";const Se=[""," ","="],xe=(e={})=>({value:"",renderValue:null,isArgSelector:!1,argName:"",argIndex:0,argState:void 0,...e}),ke=e=>e.split("").map((e=>xe({value:e,renderValue:e}))),we=(e,t,a)=>{var n;return o.a.createElement("span",{className:"chr",key:`${e}.${a}.${null!==(n=t.value)&&void 0!==n?n:"$"}`},t.renderValue)},Te=(e,t)=>{let a=t.value;var n,o;return e&&t.isArgSelector&&(a+=`="${null!==(n=null===(o=t.argState)||void 0===o?void 0:o.valueText)&&void 0!==n?n:""}"`),a};class entered_input_EnteredInput{constructor(e,t,a,n){if(m()(this,"leftOfCursorContent",void 0),m()(this,"rightOfCursorContent",void 0),m()(this,"canHaveArgValueSelectors",void 0),m()(this,"argState",void 0),this.leftOfCursorContent=ke(e),this.rightOfCursorContent=ke(t),this.canHaveArgValueSelectors=Boolean(null==n?void 0:n.argsWithValueSelectors),a.hasArgs&&n&&n.argsWithValueSelectors){this.argState=n.argState;const i=[{input:e,items:this.leftOfCursorContent,side:"left"},{input:t,items:this.rightOfCursorContent,side:"right"}];for(const[e,s]of Object.entries(n.argsWithValueSelectors))if(a.hasArg(e)){let a=0;for(const{input:l,items:u,side:c}of i){const i=`--${e}`;let d=l.indexOf(i);for(;d>-1;){const m=i.length,p=d+m,g=l.charAt(p),f="left"===c&&""===g&&Se.includes(t.charAt(0));if(Se.includes(g)&&(f||"left"===c&&""!==g||"right"===c)){var r;const t=Array.from({length:m},xe),l=null===(r=n.argState[e])||void 0===r?void 0:r.at(a);t[0]=xe({value:i,renderValue:o.a.createElement(je,{argName:e,argIndex:a,argDefinition:s}),isArgSelector:!0,argName:e,argIndex:a++,argState:l}),u.splice(d,m,...t)}d=l.indexOf(i,p)}}}this.leftOfCursorContent=this.leftOfCursorContent.filter((({value:e})=>e.length>0)),this.rightOfCursorContent=this.rightOfCursorContent.filter((({value:e})=>e.length>0))}}replaceSelection(e,t){const a=this.getFullText(),n=t?xe({value:t}):void 0;let o=a.indexOf(e);const r=[...this.leftOfCursorContent,...this.rightOfCursorContent];this.canHaveArgValueSelectors&&r.forEach(((e,t)=>{e.isArgSelector&&t<o&&(o-=e.value.length-1)}));const i=r.splice(o,e.length);n&&(r.splice(o,0,n),o++),this.leftOfCursorContent=r.splice(0,o),this.rightOfCursorContent=r,this.removeArgState(i)}removeArgState(e){if(this.argState){let a=!1;const n={...this.argState};for(const{argName:o,argIndex:r,isArgSelector:i}of e){var t;i&&null!==(t=n[o])&&void 0!==t&&t.at(r)&&(n[o]=n[o].filter(((e,t)=>t!==r)),a=!0)}a&&(this.argState=n)}}getLeftOfCursorText(e=!1){return this.leftOfCursorContent.map(Te.bind(null,e)).join("")}getRightOfCursorText(e=!1){return this.rightOfCursorContent.map(Te.bind(null,e)).join("")}getFullText(e=!1){return this.getLeftOfCursorText(e)+this.getRightOfCursorText(e)}getLeftOfCursorRenderingContent(){return o.a.createElement(o.a.Fragment,null,this.leftOfCursorContent.map(we.bind(null,"left")))}getRightOfCursorRenderingContent(){return o.a.createElement(o.a.Fragment,null,this.rightOfCursorContent.map(we.bind(null,"right")))}getArgState(){return this.argState}moveCursorTo(e){switch(e){case"end":this.leftOfCursorContent.push(...this.rightOfCursorContent.splice(0));break;case"home":this.rightOfCursorContent.unshift(...this.leftOfCursorContent.splice(0));break;case"left":if(this.leftOfCursorContent.length){const e=this.leftOfCursorContent.pop();e&&this.rightOfCursorContent.unshift(e)}break;case"right":if(this.rightOfCursorContent.length){const e=this.rightOfCursorContent.shift();e&&this.leftOfCursorContent.push(e)}}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):e&&this.leftOfCursorContent.push(xe({value:e}))}deleteChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.rightOfCursorContent.shift();null!=e&&e.isArgSelector&&this.removeArgState([e])}}backspaceChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.leftOfCursorContent.pop();null!=e&&e.isArgSelector&&this.removeArgState([e])}}clear(){this.leftOfCursorContent=[],this.rightOfCursorContent=[],this.argState=void 0}}const Ie=b.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),Me=()=>{const e=getSelection();e&&e.removeAllRanges()},Ne=s.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-19dx6ae-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),Fe=Object(n.memo)((({onCapture:e,focusRef:t,onChangeFocus:a,children:r})=>{const i=Object(S.a)(x()),s=Object(n.useRef)(null),l=Object(n.useRef)(null),u=Object(n.useRef)(null),c=Object(n.useCallback)((()=>{if(s.current){var e,t,a;const n=document.getSelection(),o=(null!==(e=null==n?void 0:n.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!s.current||!n)&&(null===(t=s.current)||void 0===t?void 0:t.contains(n.focusNode))&&(null===(a=s.current)||void 0===a?void 0:a.contains(n.anchorNode));return n&&0!==o.length&&r?o:""}return""}),[]),d=Object(n.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&l.current){const t=document.createRange();t.selectNodeContents(l.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const a=/^[\w\d]{2}/.test(t.key)?"":t.key,n=c(),o=Object(V.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:a,selection:n,eventDetails:o}),n&&Me()}),[c,e]),m=Object(n.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const a=t.clipboardData.getData("text").replace(/[\r\n]/g,""),n=c();e({value:a,selection:n,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),n&&Me()}),[c,e]),p=Object(n.useCallback)((()=>{a&&a(!0)}),[a]),g=Object(n.useCallback)((()=>{a&&a(!1)}),[a]),f=Object(n.useMemo)((()=>({focus:(e=!1)=>{var t,a,n;!e&&(null!==(t=null===(a=window.getSelection())||void 0===a?void 0:a.toString())&&void 0!==t?t:"").length>0||document.activeElement===u.current||null===(n=u.current)||void 0===n||n.focus()},blur:()=>{var e;u.current&&document.activeElement===u.current&&(null===(e=u.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=f),o.a.createElement(Ne,{"data-test-subj":i("inputCapture"),onKeyDown:d,onPaste:m},o.a.createElement("div",{role:"textbox","aria-placeholder":Ie,tabIndex:0,ref:s,className:"focus-container","data-test-subj":i("keyCapture-input"),onBlur:g,onFocus:p},o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("div",{ref:l,className:"text-container"},r),o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("input",{ref:u,type:"text",value:"",tabIndex:-1,onPaste:m,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));Fe.displayName="InputCapture";const Ae=b.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),Pe=b.i18n.translate("xpack.securitySolution.useInputHints.viewInputHistory",{defaultMessage:"Press the up arrow key to access previously entered commands"}),De=s()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-6afwlc-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";user-select:none;"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Le=Object(n.memo)((()=>{const{fullTextEntered:e}=ye(),t=se().state.input.placeholder,a=Object(S.a)(x());return e.length>0?null:o.a.createElement(De,{size:"s",className:"eui-textTruncate","data-test-subj":a("inputPlaceholder")},o.a.createElement("div",{className:"eui-textTruncate"},t))}));Le.displayName="InputPlaceholder";const ze=s()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-qp7srp-0"})(["padding-left:0;"]),Be=Object(n.memo)((({input:e,isValid:t=!0})=>{const a=Object(S.a)(x()),i=Object(n.useMemo)((()=>t?e:o.a.createElement(r.EuiTextColor,null,e)),[e,t]);return o.a.createElement(ze,{transparentBackground:!0,"data-test-subj":a("userCommandText")},i)}));Be.displayName="UserCommandInput";const He=Object(n.memo)((()=>{const[e,t]=Object(n.useState)(!1),a=U(),i=Object(S.a)(x()),s=Object(n.useCallback)((()=>{t(!0)}),[]),l=Object(n.useCallback)((()=>{t(!1)}),[]),u=Object(n.useCallback)((()=>{a({type:"clearInputHistoryState"}),t(!1)}),[a]);return o.a.createElement(o.a.Fragment,null,e&&o.a.createElement(r.EuiConfirmModal,{title:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmTitle",{defaultMessage:"Clear input history"}),cancelButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmSubmitButton",{defaultMessage:"Clear"}),buttonColor:"danger",onCancel:l,onConfirm:u},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.confirmMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})),o.a.createElement(r.EuiFlexGroup,{responsive:!1,justifyContent:"flexEnd",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonEmpty,{size:"xs",tabIndex:-1,onClick:s,disabled:e,"data-test-subj":i("clearInputHistoryButton")},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.clearHistoryButtonLabel",defaultMessage:"Clear input history"})))))}));He.displayName="CommandInputClearHistory";const $e=b.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),Re=b.i18n.translate("xpack.securitySolution.commandInputHistory.filterPlaceholder",{defaultMessage:"Filter previously entered actions"}),Ue=b.i18n.translate("xpack.securitySolution.commandInputHistory.noFilteredMatchesFoundMessage",{defaultMessage:"No entries found matching the filter entered"}),_e=Object(n.memo)((()=>{const e=U(),t=se().state.input.history,[a]=Object(n.useState)(ye()),i=Object(n.useRef)(!1),s=Object(S.a)(x()),l=Object(n.useMemo)((()=>t.map(((e,t)=>({label:e.display,key:e.id,data:e})))),[t]),u=Object(n.useMemo)((()=>({showIcons:!1,bordered:!0})),[]),c=Object(n.useMemo)((()=>({placeholder:Re,compressed:!0,fullWidth:!0})),[]),d=Object(n.useCallback)(((e,a)=>o.a.createElement(o.a.Fragment,null,e,o.a.createElement(r.EuiSpacer,{size:"s"}),t.length>0?a:o.a.createElement("div",{tabIndex:-1}))),[t.length]),m=Object(n.useCallback)((t=>{i.current=!0;const a=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),a&&e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.data.input,rightOfCursorText:""}}),e({type:"addFocusToKeyCapture"})}),[e]),p=Object(n.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),g=Object(n.useCallback)((e=>o.a.createElement(Be,{input:e.label})),[]);return Object(n.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}),()=>{i.current||(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.leftOfCursorText,rightOfCursorText:a.rightOfCursorText}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,i,a]),o.a.createElement("div",null,t.length>0&&o.a.createElement(He,null),o.a.createElement(r.EuiSelectable,{options:l,onChange:m,onActiveOptionChange:p,renderOption:g,listProps:u,singleSelection:!0,searchable:!0,searchProps:c,emptyMessage:$e,noMatchesMessage:Ue,"data-test-subj":s("inputHistorySelector"),"data-console-input-history":!0},d))}));_e.displayName="CommandInputHistory";const Ve=Object(n.memo)((({children:e,width:t="92vw"})=>{const a=Object(S.a)(x()),i=Ce(),s=void 0!==i,l=U(),u=Object(n.useMemo)((()=>({width:t,borderBottomLeftRadius:0,borderBottomRightRadius:0})),[t]),c=Object(n.useMemo)((()=>({clickOutsideDisables:!0})),[]),d=Object(n.useCallback)((()=>{l({type:"updateInputPopoverState",payload:{show:void 0}}),l({type:"addFocusToKeyCapture"})}),[l]);return Object(n.useEffect)((()=>{i||l({type:"addFocusToKeyCapture"})}),[l,i]),o.a.createElement(r.EuiPopover,{button:e,closePopover:d,isOpen:s,panelStyle:u,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:c,ownFocus:!1,"data-test-subj":a("inputPopover")},i&&o.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===i&&o.a.createElement(_e,null)))}));Ve.displayName="InputAreaPopover";const Ge=s.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-ujnhrt-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}&.withPopover{border-top-left-radius:0;border-top-right-radius:0;}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiTextColor)),We=Object(n.memo)((({prompt:e="",focusRef:t,...a})=>{(()=>{const e=U(),t=Boolean(Ce()),a=(()=>{const e=se().state.input.parsedInput;return-1!==e.input.trimStart().indexOf(" ")?e.name:""})(),o=ee(),{leftOfCursorText:r}=ye(),i=Object(n.useMemo)((()=>{if(a)return o.find((e=>e.name===a))}),[a,o]);Object(n.useEffect)((()=>{if(a&&!t)if(i&&!0!==i.helpHidden){var n,o;const t=null!==(n=null==i?void 0:i.exampleInstruction)&&void 0!==n?n:"",a=null!==(o=null==i?void 0:i.exampleUsage)&&void 0!==o?o:"";let r=null!=t?t:"";if(a&&(r+=t?` ${b.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:a}})}`:a),!r||!a){const e=f(i);e.length>0?r+=`${i.name} ${e}`:r+=Ae}e({type:"updateFooterContent",payload:{value:r}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(s=a,b.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:s}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:r||t?"":Pe}}),e({type:"setInputState",payload:{value:void 0}});var s}),[a,i,e,t,r])})();const i=Object(S.a)(x()),s=U(),{rightOfCursorText:l,leftOfCursorText:u,fullTextEntered:c,enteredCommand:d,parsedInput:m}=ye(),p=le(),g=!!Ce(),[h,y]=Object(n.useState)(!1),[E,v]=Object(n.useState)(void 0),[C,O]=Object(n.useState)("94vw"),j=Object(n.useRef)(null),k=t||j,w=Object(n.useMemo)((()=>he()({cmdInput:!0,hasFocus:h,error:"error"===p,withPopover:g})),[h,g,p]),T=Object(n.useMemo)((()=>0===c.trim().length),[c]),I=Object(n.useMemo)((()=>new entered_input_EnteredInput(u,l,m,d)),[d,u,m,l]),M=Object(n.useCallback)((({width:e})=>{e>0&&O(`${e}px`)}),[]),N=Object(n.useCallback)((()=>{v({input:I.getFullText(!0),enteredCommand:d,parsedInput:m})}),[d,m,I]),F=Object(n.useCallback)((e=>{y(e)}),[]),A=Object(n.useCallback)((e=>{k.current&&k.current.focus(),g&&s({type:"updateInputPopoverState",payload:{show:void 0}})}),[s,g,k]),P=Object(n.useCallback)((({value:e,selection:t,eventDetails:a})=>{const n=a.keyCode;if(38===n)return s({type:"removeFocusFromKeyCapture"}),void s({type:"updateInputPopoverState",payload:{show:"input-history"}});s({type:"updateInputTextEnteredState",payload:({leftOfCursorText:a,rightOfCursorText:o,enteredCommand:r,parsedInput:i})=>{const s=new entered_input_EnteredInput(a,o,i,r);switch(s.addValue(null!=e?e:"",t),n){case 8:s.backspaceChar(t);break;case 46:s.deleteChar(t);break;case 13:v({input:s.getFullText(!0),enteredCommand:r,parsedInput:i}),s.clear();break;case 37:s.moveCursorTo("left");break;case 39:s.moveCursorTo("right");break;case 36:s.moveCursorTo("home");break;case 35:s.moveCursorTo("end")}return{leftOfCursorText:s.getLeftOfCursorText(),rightOfCursorText:s.getRightOfCursorText(),argState:s.getArgState()}}})}),[s]);return Object(n.useEffect)((()=>{E&&(s({type:"executeCommand",payload:E}),v(void 0),s({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}))}),[E,s]),o.a.createElement(Ve,{width:C},o.a.createElement(r.EuiResizeObserver,{onResize:M},(n=>o.a.createElement(Ge,fe()({},a,{className:w,onClick:A,ref:n,"data-test-subj":i("cmdInput-container")}),o.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},e&&o.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":i("cmdInput-prompt")},o.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),o.a.createElement(r.EuiFlexItem,{className:"textEntered"},o.a.createElement(Fe,{onCapture:P,onChangeFocus:F,focusRef:t},o.a.createElement(ve,{leftOfCursor:I.getLeftOfCursorRenderingContent(),rightOfCursor:I.getRightOfCursorRenderingContent()})),o.a.createElement(Le,null)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"data-test-subj":i("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",color:"primary",isDisabled:T,onClick:N})))))))}));We.displayName="CommandInput";var qe=a(56),Ke=a.n(qe);const Xe=Object(n.memo)((({size:e="s",color:t,children:a,"data-test-subj":n,className:i})=>{const{euiTheme:s}=Object(r.useEuiTheme)();return o.a.createElement(r.EuiText,{size:e,"data-test-subj":n,className:`font-family-code ${null!=i?i:""}`},o.a.createElement(r.EuiTextColor,{color:null!=t?t:s.colors.text},a))}));Xe.displayName="ConsoleText";const Ye=Object(n.memo)((()=>{const e=Object(S.a)(x());return o.a.createElement(Xe,{"data-test-subj":e("longRunningCommandHint")},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ye.displayName="LongRunningCommandHint";const Ze=b.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Je=b.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),Qe=b.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),et=Object(n.memo)((({showAs:e="success",title:t,showTitle:a=!0,"data-test-subj":i,className:s,children:l})=>{const u=x(),c=Object(S.a)(null!=i?i:u),d=Object(n.useMemo)((()=>he()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[s||"_"]:Boolean(s)})),[s,e]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":i||c("commandExecutionResult")},"pending"===e?o.a.createElement(Xe,null,null!=l?l:Qe):o.a.createElement(o.a.Fragment,null,a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Xe,{color:"success"===e?"success":"danger"},t||("success"===e?Ze:Je)),o.a.createElement(r.EuiSpacer,{size:"s"})),l))}));et.displayName="CommandExecutionResult";const tt=s.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-1wmcd6l-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),at=Object(n.memo)((({item:{command:e,state:t,id:a,enteredAt:i,isValid:s}})=>{const l=U(),u=e.commandDefinition.RenderComponent,[c,d]=Object(n.useState)(!1),m=Object(n.useMemo)((()=>"pending"===t.status),[t.status]),p=Object(n.useCallback)((e=>{l({type:"updateCommandStatusState",payload:{id:a,value:e}})}),[l,a]),g=Object(n.useCallback)((e=>{l({type:"updateCommandStoreState",payload:{id:a,value:e}})}),[l,a]);return Object(n.useEffect)((()=>{let e;if(m&&!c){const t=Ke()().diff(Ke()(i),"seconds");if(t>=15)return void d(!0);e=setTimeout((()=>{d(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[i,c,m]),o.a.createElement(tt,null,o.a.createElement("div",null,o.a.createElement(Be,{input:e.inputDisplay,isValid:s})),o.a.createElement("div",{className:"noThemeOverrides"},o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(u,{command:e,store:t.store,status:t.status,setStore:g,setStatus:p,ResultComponent:et}),m&&o.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),m&&c&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(Ye,null))))}));at.displayName="CommandExecutionOutput";const nt=a(69).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,ot=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-1249lql-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),nt,nt),rt=Object(n.memo)((({children:e})=>{const t=Object(S.a)(x());return o.a.createElement(ot,{grow:!0,"data-test-subj":t("historyItem")},e)}));rt.displayName="HistoryItem";const it=Object(n.memo)((e=>{const t=se().state.commandHistory,a=U(),i=Object(S.a)(x()),s=Object(n.useMemo)((()=>t.map((e=>o.a.createElement(rt,{key:e.id},o.a.createElement(at,{item:e}))))),[t]);return Object(n.useEffect)((()=>{a({type:"scrollDown"})}),[a,t.length]),o.a.createElement(r.EuiFlexGroup,fe()({"data-test-subj":i("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),s)}));it.displayName="HistoryOutput";const st=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-ojfnk7-0"})(["padding:0 !important;"]),lt=Object(n.memo)((({headerContent:e,children:t})=>{const a=Object(S.a)(x("sidePanel"));return o.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none","data-test-subj":a()},e&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container","data-test-subj":a("header")},e),o.a.createElement(r.EuiHorizontalRule,{margin:"none"})),o.a.createElement(st,{className:"eui-scrollBar eui-yScroll layout-container"},o.a.createElement("div",{"data-test-subj":a("body")},t)))}));lt.displayName="SidePanelContentLayout";const ut=s()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-u9ickv-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),ct=Object(n.memo)((()=>{const e=U(),t=ee(),a=Object(S.a)(x("sidePanel")),i=ce().show,s=Object(n.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),l=Object(n.useMemo)((()=>"help"===i?o.a.createElement(o.a.Fragment,null,o.a.createElement(ut,null,o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiTitle,{size:"s","data-test-subj":a("headerTitle")},o.a.createElement("h3",null,o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:s,"data-test-subj":a("headerCloseButton")}))),o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(C.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:o.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[i,a,s]),u=Object(n.useMemo)((()=>"help"===i?o.a.createElement("div",{"data-test-subj":a("helpContent")},o.a.createElement(Q,{commands:t,display:"table"})):null),[t,a,i]);return i?o.a.createElement(lt,{headerContent:l},u):null}));ct.displayName="RightPanelContentManager";const dt=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-hd3kv7-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),mt=Object(n.memo)((e=>Boolean(ce().show)?o.a.createElement(dt,{grow:!1,className:"layout-rightPanel"},o.a.createElement(ct,null)):null));mt.displayName="SidePanelFlexItem";const pt=s.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-d15gh7-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;width:100%;min-height:300px;min-width:300px;overflow:hidden;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;white-space:pre-wrap;}.euiFlexItem:not(.noMinWidth):not(.noThemeOverrides .euiFlexItem){min-width:0;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily)),gt=Object(n.memo)((({prompt:e,commands:t,HelpComponent:a,TitleComponent:i,storagePrefix:s,managedKey:l,...u})=>{const d=Object(n.useRef)(null),m=Object(n.useRef)(null),p=Object(S.a)(u["data-test-subj"]),g=Object(c.c)(l),f=Object(n.useCallback)((()=>{setTimeout((()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)}),1)}),[]),b=Object(n.useCallback)((()=>{m.current&&m.current.focus()}),[]);return Object(n.useEffect)((()=>{g&&!g.isOpen||setTimeout(b,2)}),[b,g]),o.a.createElement(ie,{commands:t,scrollToBottom:f,keyCapture:m,managedKey:l,HelpComponent:a,dataTestSubj:u["data-test-subj"],storagePrefix:s},o.a.createElement(pt,u,o.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":p("mainPanel")},o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},o.a.createElement(pe,{TitleComponent:i})),o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},o.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:d},o.a.createElement(it,null))),o.a.createElement(r.EuiFlexItem,{onClick:b,grow:!1,className:"layout-container layout-commandInput","data-test-subj":p("mainPanel-inputArea")},o.a.createElement(We,{prompt:e,focusRef:m})),o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},o.a.createElement(ue,null)))))))),o.a.createElement(mt,null))))}));gt.displayName="Console"},692:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(5);n.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),n.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),n.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),n.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),n.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),n.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const o="siem"},698:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(45),o=a(2);const r={pageName:a(129).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},i=Object(o.createContext)([r,()=>n.noop])},715:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(17),o=a(47),r=a(56),i=a.n(r),s=a(2),l=a.n(s);const u=l.a.memo((({children:e,date:t,fieldName:a,className:r=""})=>l.a.createElement(n.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:r,content:l.a.createElement(n.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=a?l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},a)):null,l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(o.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:i.a.utc(t).toDate()})),l.a.createElement(n.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},i.a.utc(t).local().format("llll")),l.a.createElement(n.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},i()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));u.displayName="LocalizedDateTooltip"},908:function(e,t,a){"use strict";var n=a(260);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b}))}}]);