"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.AuditdGenericLine = exports.AuditdGenericDetails = void 0;
var _eui = require("@elastic/eui");
var _fp = require("lodash/fp");
var _react = _interopRequireDefault(require("react"));
var _draggables = require("../../../../../../common/components/draggables");
var i18n = _interopRequireWildcard(require("./translations"));
var _netflow = require("../netflow");
var _helpers = require("../helpers");
var _process_draggable = require("../process_draggable");
var _args = require("../args");
var _session_user_host_working_dir = require("./session_user_host_working_dir");
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

const AuditdGenericLine = /*#__PURE__*/_react.default.memo(({
  id,
  contextId,
  hostName,
  userName,
  primary,
  processName,
  processPid,
  processExecutable,
  processTitle,
  secondary,
  workingDirectory,
  args,
  result,
  session,
  text,
  isDraggable
}) => /*#__PURE__*/_react.default.createElement(_eui.EuiFlexGroup, {
  alignItems: "center",
  justifyContent: "center",
  gutterSize: "none",
  wrap: true
}, /*#__PURE__*/_react.default.createElement(_session_user_host_working_dir.SessionUserHostWorkingDir, {
  eventId: id,
  contextId: contextId,
  hostName: hostName,
  userName: userName,
  primary: primary,
  secondary: secondary,
  workingDirectory: workingDirectory,
  session: session,
  isDraggable: isDraggable
}), processExecutable != null && /*#__PURE__*/_react.default.createElement(_helpers.TokensFlexItem, {
  grow: false,
  component: "span"
}, text), /*#__PURE__*/_react.default.createElement(_helpers.TokensFlexItem, {
  grow: false,
  component: "span"
}, /*#__PURE__*/_react.default.createElement(_process_draggable.ProcessDraggable, {
  contextId: contextId,
  endgamePid: undefined,
  endgameProcessName: undefined,
  eventId: id,
  processPid: processPid,
  processName: processName,
  processExecutable: processExecutable,
  isDraggable: isDraggable
})), /*#__PURE__*/_react.default.createElement(_args.Args, {
  eventId: id,
  args: args,
  contextId: contextId,
  isDraggable: isDraggable,
  processTitle: processTitle
}), result != null && /*#__PURE__*/_react.default.createElement(_helpers.TokensFlexItem, {
  grow: false,
  component: "span"
}, i18n.WITH_RESULT), /*#__PURE__*/_react.default.createElement(_helpers.TokensFlexItem, {
  grow: false,
  component: "span"
}, /*#__PURE__*/_react.default.createElement(_draggables.DraggableBadge, {
  contextId: contextId,
  eventId: id,
  field: "auditd.result",
  isDraggable: isDraggable,
  queryValue: result,
  value: result,
  isAggregatable: true,
  fieldType: "keyword"
}))));
exports.AuditdGenericLine = AuditdGenericLine;
AuditdGenericLine.displayName = 'AuditdGenericLine';
const AuditdGenericDetails = /*#__PURE__*/_react.default.memo(({
  data,
  contextId,
  isDraggable,
  text,
  timelineId
}) => {
  const id = data._id;
  const session = (0, _fp.get)('auditd.session[0]', data);
  const hostName = (0, _fp.get)('host.name[0]', data);
  const userName = (0, _fp.get)('user.name[0]', data);
  const result = (0, _fp.get)('auditd.result[0]', data);
  const processPid = (0, _fp.get)('process.pid[0]', data);
  const processName = (0, _fp.get)('process.name[0]', data);
  const processExecutable = (0, _fp.get)('process.executable[0]', data);
  const processTitle = (0, _fp.get)('process.title[0]', data);
  const workingDirectory = (0, _fp.get)('process.working_directory[0]', data);
  const primary = (0, _fp.get)('auditd.summary.actor.primary[0]', data);
  const secondary = (0, _fp.get)('auditd.summary.actor.secondary[0]', data);
  const args = (0, _fp.get)('process.args', data);
  if (data.process != null) {
    return /*#__PURE__*/_react.default.createElement(_helpers.Details, null, /*#__PURE__*/_react.default.createElement(AuditdGenericLine, {
      id: id,
      contextId: contextId,
      text: text,
      hostName: hostName,
      userName: userName,
      processName: processName,
      processPid: processPid,
      processExecutable: processExecutable,
      processTitle: processTitle,
      workingDirectory: workingDirectory,
      args: args,
      session: session,
      primary: primary,
      result: result,
      secondary: secondary,
      isDraggable: isDraggable
    }), /*#__PURE__*/_react.default.createElement(_eui.EuiSpacer, {
      size: "s"
    }), /*#__PURE__*/_react.default.createElement(_netflow.NetflowRenderer, {
      data: data,
      isDraggable: isDraggable,
      timelineId: timelineId
    }));
  } else {
    return null;
  }
});
exports.AuditdGenericDetails = AuditdGenericDetails;
AuditdGenericDetails.displayName = 'AuditdGenericDetails';