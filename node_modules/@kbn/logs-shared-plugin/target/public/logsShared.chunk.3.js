/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.logsShared_bundle_jsonpfunction=window.logsShared_bundle_jsonpfunction||[]).push([[3],{121:function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var o,n,s;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(n=o;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=o;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,s[n]))return!1;for(n=o;0!=n--;){var i=s[n];if(!e(t[i],r[i]))return!1}return!0}return t!=t&&r!=r}},122:function(e,t,r){"use strict";r.r(t),r.d(t,"LogStream",(function(){return v})),r.d(t,"LogStreamContent",(function(){return L}));var o=r(106),n=r(1),s=r.n(n),i=r(13),a=r(32),l=r(8),u=r(59),c=r.n(u),d=r(4),g=r(53),h=r(44),m=r(74),b=r(107);r(111),r(109),r(52),r(113),r(114),r(115),r(116),r(117);var f=r(118),p=r(5),E=r(19),O=r(33),j=r.n(O),y=r(121),S=r.n(y);class resettable_error_boundary_ResettableErrorBoundary extends s.a.Component{constructor(...e){super(...e),j()(this,"state",{latestError:void 0}),j()(this,"resetError",(()=>{this.setState((e=>({...e,latestError:void 0})))}))}componentDidUpdate({resetOnChange:e}){const{resetOnChange:t}=this.props,{latestError:r}=this.state;null==r||S()(t,e)||this.resetError()}static getDerivedStateFromError(e){return{latestError:e}}render(){const{children:e,renderError:t}=this.props,{latestError:r}=this.state;return null!=r?t({latestError:r,resetError:this.resetError}):e}}var _=r(2);const w=({children:e,resetOnChange:t=null})=>Object(_.jsx)(resettable_error_boundary_ResettableErrorBoundary,{renderError:T,resetOnChange:t},e),x=({error:e})=>e instanceof o.KQLSyntaxError?Object(_.jsx)(p.EuiEmptyPrompt,{title:Object(_.jsx)(E.FormattedMessage,{id:"xpack.logsShared.logStream.kqlErrorTitle",defaultMessage:"Invalid KQL expression",tagName:"h2"}),body:Object(_.jsx)(p.EuiCodeBlock,{className:"eui-textLeft"},e.message)}):Object(_.jsx)(p.EuiEmptyPrompt,{title:Object(_.jsx)(E.FormattedMessage,{id:"xpack.logsShared.logStream.unknownErrorTitle",defaultMessage:"An error occurred",tagName:"h2"}),body:Object(_.jsx)(p.EuiCodeBlock,{className:"eui-textLeft"},e.message)}),T=({latestError:e})=>Object(_.jsx)(x,{error:e});var I=r(43);const v=({height:e=400,...t})=>Object(_.jsx)(M,{style:{height:e}},Object(_.jsx)(w,{resetOnChange:[t.query]},Object(_.jsx)(L,t))),L=({logView:e,startTimestamp:t,endTimestamp:r,query:s,filters:i,center:u,highlight:p,columns:E,startDateExpression:O="",endDateExpression:j="",showFlyoutAction:y=!1,isStreaming:S=!1})=>{const w=Object(n.useMemo)((()=>E?function(e){return e.map((e=>{switch(e.type){case"timestamp":{const{width:t,header:r,render:o}=e;return{timestampColumn:{id:"___#timestamp",width:t,header:r,render:o}}}case"message":{const{width:t,header:r,render:o}=e;return{messageColumn:{id:"___#message",width:t,header:r,render:o}}}case"field":{const{width:t,header:r,render:o}=e;return{fieldColumn:{id:`___#${e.field}`,field:e.field,width:t,header:r,render:o}}}}}))}(E):void 0),[E]),{services:{http:x,data:T}}=Object(a.useKibana)();if(null==x||null==T)throw new Error("<LogStream /> cannot access kibana core services.\n\nEnsure the component is mounted within kibana-react's <KibanaContextProvider> hierarchy.\nRead more at https://github.com/elastic/kibana/blob/main/src/plugins/kibana_react/README.md\"\n");const{openLogEntryFlyout:v}=Object(I.b)(e),L=(()=>{const[e]=Object(a.useUiSetting$)(b.UI_SETTINGS.QUERY_ALLOW_LEADING_WILDCARDS),[t]=Object(a.useUiSetting$)(b.UI_SETTINGS.QUERY_STRING_OPTIONS),[r]=Object(a.useUiSetting$)(b.UI_SETTINGS.DATEFORMAT_TZ),[o]=Object(a.useUiSetting$)(b.UI_SETTINGS.COURIER_IGNORE_FILTER_IF_FIELD_NOT_IN_INDEX);return Object(n.useMemo)((()=>({allowLeadingWildcards:e,queryStringOptions:t,dateFormatTZ:r,ignoreFilterIfFieldNotInIndex:o})),[e,r,o,t])})(),M=Object(n.useMemo)((()=>new m.a(T.dataViews,x,T.search.search,d.h)),[T.dataViews,T.search.search,x]),{derivedDataView:N,isLoading:k,load:D,resolvedLogView:A}=Object(h.b)({initialLogViewReference:e,logViews:M}),F=Object(n.useMemo)((()=>"object"==typeof s&&"bool"in s?R(s,Object(o.buildEsQuery)(N,[],null!=i?i:[],L)):Object(o.buildEsQuery)(N,C(s),null!=i?i:[],L)),[N,i,L,s]),{entries:U,fetchEntries:V,fetchNewestEntries:q,fetchNextEntries:B,fetchPreviousEntries:G,hasMoreAfter:P,hasMoreBefore:Q,lastLoadedTime:$,isLoadingMore:K,isReloading:W}=Object(g.b)({logViewReference:e,startTimestamp:t,endTimestamp:r,query:F,center:u,columns:w}),Y=Object(n.useMemo)((()=>k||W),[W,k]),Z=Object(n.useMemo)((()=>A?null!=w?w:A.columns:[]),[A,w]),H=Object(n.useMemo)((()=>Y?[]:U.map((e=>({kind:"logEntry",logEntry:e,highlights:[]})))),[U,Y]),X=c()(t),z=c()(r),J=c()(F);Object(n.useEffect)((()=>{D()}),[D]),Object(n.useEffect)((()=>{const e=X!==t||z!==r;(!X||!z||F!==J)&&V(),e&&(S?q():V())}),[r,V,q,S,F,z,J,X,t]);const ee=Object(n.useCallback)((({fromScroll:e,pagesBeforeStart:t,pagesAfterEnd:r})=>{e&&(K||(t<2?G():r<2&&B()))}),[K,G,B]);return Object(_.jsx)(f.ScrollableLogTextStreamView,{target:u||(U.length?U[U.length-1].cursor:null),columnConfigurations:Z,items:H,scale:"medium",wrap:!0,isReloading:Y,isLoadingMore:K,isStreaming:S,hasMoreBeforeStart:Q,hasMoreAfterEnd:P,lastLoadedTime:$,jumpToTarget:l.noop,reportVisibleInterval:ee,reloadItems:V,onOpenLogEntryFlyout:y?v:void 0,highlightedItem:null!=p?p:null,currentHighlightKey:null,startDateExpression:O,endDateExpression:j,updateDateRange:l.noop,startLiveStreaming:l.noop,hideScrollbar:!1})},M=i.euiStyled.div`
  display: flex;
  background-color: ${e=>e.theme.eui.euiColorEmptyShade};
`,R=(e,t)=>({bool:{must:[...e.bool.must,...t.bool.must],filter:[...e.bool.filter,...t.bool.filter],should:[...e.bool.should,...t.bool.should],must_not:[...e.bool.must_not,...t.bool.must_not]}}),C=e=>null==e?[]:"string"==typeof e?[{language:"kuery",query:e}]:"language"in e&&"query"in e?[e]:[];t.default=v}}]);